/*!
 *
 * Bryntum Gantt 5.5.0
 *
 * Copyright(c) 2023 Bryntum AB
 * https://bryntum.com/contact
 * https://bryntum.com/license
 *
 */
var no=Object.defineProperty;var lo=(u,e,t)=>e in u?no(u,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):u[e]=t;var R=(u,e,t)=>(lo(u,typeof e!="symbol"?e+"":e,t),t);var Qi;class B{static cacheFlags(e=navigator.platform,t=navigator.userAgent){const i=this;i._isLinux=!!e.match(/Linux/),i._isMac=!!e.match(/Mac/),i._isWindows=!!e.match(/Win32/),i._isMobile=!!(t.match(/Mobile|Opera Mini|Opera Mobi|Puffin/)||typeof globalThis.orientation=="number"),i._isWebkit=!!(t.match(/WebKit/)&&!t.match(/Edg/)),i._firefoxVersion=i.getVersion(t,/Firefox\/(\d+)\./),i._isFirefox=i._firefoxVersion>0,i._chromeVersion=i.getVersion(t,/Chrom(?:e|ium)\/(\d+)\./),i._isChrome=i._chromeVersion>0,i._isSafari=!!t.match(/Safari/)&&!i._isChrome,i._isMobileSafari=!!t.match(/Mobile.*Safari/),i._safariVersion=i.getVersion(t,/Version\/(.*).Safari/),i._isAndroid=!!t.match(/Android/g)}static get supportsOverflowClip(){if(this._supportsOverflowClip==null){const e=document.createElement("div");e.style.overflow="clip",e.style.display="none",document.documentElement.appendChild(e),this._supportsOverflowClip=e.ownerDocument.defaultView.getComputedStyle(e).getPropertyValue("overflow")==="clip",e.remove()}return this._supportsOverflowClip}static get supportsSticky(){return!0}static getVersion(e,t){const i=e.match(t);return i?parseFloat(i[1]):0}static get isTouchDevice(){return this._isTouchDevice===void 0&&(this._isTouchDevice=globalThis.matchMedia("(pointer:coarse)").matches),this._isTouchDevice}static get isHoverableDevice(){return this._isHoverableDevice===void 0&&(this._isHoverableDevice=globalThis.matchMedia("(any-hover: hover)").matches),this._isHoverableDevice}static get isBrowserEnv(){return typeof window!="undefined"}static get isMac(){return this._isMac}static get isWindows(){return this._isWindows}static get isLinux(){return this._isLinux}static get isAndroid(){return this._isAndroid}static get isWebkit(){return this._isWebkit}static get isChrome(){return this._isChrome}static get chromeVersion(){return this._chromeVersion}static get isFirefox(){return this._isFirefox}static get firefoxVersion(){return this._firefoxVersion}static get isSafari(){return this._isSafari}static get safariVersion(){return this._safariVersion}static get isMobileSafari(){return this._isMobileSafari}static get isMobile(){return this._isMobile}static get platform(){const e=this;return e._isLinux?"linux":e._isMac?"mac":e._isWindows?"windows":e._isAndroid?"android":e._isMobileSafari?"ios":null}static get supportsPassive(){return!0}static get supportsRandomUUID(){if(this._supportsRandomUUID===void 0)try{this._supportsRandomUUID=globalThis.crypto.randomUUID().length>0}catch(e){this._supportsRandomUUID=!1}return this._supportsRandomUUID}static get storageAvailable(){let e,t;try{return e=localStorage,t="__storage_test__",e.setItem(t,t),e.removeItem(t),!0}catch(i){return i instanceof DOMException&&(i.code===22||i.code===1014||i.name==="QuotaExceededError"||i.name==="NS_ERROR_DOM_QUOTA_REACHED")&&e.length!==0}}static setLocalStorageItem(e,t){this.storageAvailable&&localStorage.setItem(e,t)}static getLocalStorageItem(e){return this.storageAvailable&&localStorage.getItem(e)}static removeLocalStorageItem(e){this.storageAvailable&&localStorage.removeItem(e)}static searchParam(e,t=null,i=document.location.search){const r=new RegExp(`[?&]${e}=?([^&]*)`),s=i.match(r);return s&&s[1]||t}static getCookie(e){const t=encodeURIComponent(e)+"=",i=document.cookie.split(";");for(let r=0;r<i.length;r++){let s=i[r];for(;s.charAt(0)===" ";)s=s.substring(1,s.length);if(s.indexOf(t)===0)return decodeURIComponent(s.substring(t.length,s.length))}return""}static download(e,t){const i=document.createElement("a");i.download=e,i.href=t||e,i.style.cssText="display:none",document.body.appendChild(i),i.click(),document.body.removeChild(i)}static downloadBlob(e,t){const i=globalThis.URL.createObjectURL(e);this.download(t,i),globalThis.URL.revokeObjectURL(i)}static get queryString(){var e;const t=new URL(globalThis.location.href).searchParams;return(e=Object.fromEntries)===null||e===void 0?void 0:e.call(Object,t.entries())}static copyToClipboard(e){let t=!0;const i=document.createElement("textarea");i.value=e,i.style.height=i.style.width=0,document.body.appendChild(i),i.select();try{document.execCommand("copy")}catch(r){t=!1}return i.remove(),t}static isBryntumOnline(e){var t;return e=Array.isArray(e)?e:[e],!!(/^(www\.)?bryntum\.com/.test(globalThis.location.host)||!((t=e)===null||t===void 0)&&t.some(i=>this.queryString[i]!=null))}static get isCSP(){const{bryntum:e,document:t}=globalThis;return e.CSP==null&&(e.CSP=!!t.querySelector('meta[http-equiv="Content-Security-Policy"]')),e.CSP}}R(B,"supportsPointerEvents",!!(globalThis.PointerEvent||globalThis.MSPointerEvent)),R(B,"supportsPointerEventConstructor",typeof PointerEvent!="undefined"),R(B,"PointerEventConstructor",globalThis.PointerEvent||globalThis.CustomEvent),R(B,"isPhone",(Qi=globalThis.matchMedia)===null||Qi===void 0?void 0:Qi.call(globalThis,"(max-height:414px) or (max-width:414px)").matches),B.isBrowserEnv&&B.cacheFlags(),B._$name="BrowserHelper";let ps,ys,vs,bs;const Cs=/([a-z])([A-Z])/g,oo=/[\n\r]/g,ao=/[.*+?^${}()|[\]\\]/g,co=/[&<]/,uo=/(^[^a-z]+[^\w]+)/gi,fo=/\s+/,ho=/^[^a-z]+|[^\w:.-]+/gi,go=(u,e)=>ys[e.toLowerCase()]||String.fromCharCode(parseInt(e.substr(2),10)),mo=(u,e)=>ps[e],po=(u,e,t)=>`${e}-${t.toLowerCase()}`,yo=(u,e,t)=>`${e} ${t.toLowerCase()}`,vo=u=>u?`_x${[...u].map(e=>e.charCodeAt(0).toString(16)).join("")}`:"__blank__",ws={},Ss={},Ye=class{static capitalize(e){return e&&e[0].toUpperCase()+e.substr(1)}static uncapitalize(e){return e&&e[0].toLowerCase()+e.substr(1)}static hyphenate(e){const t=ws[e];return t||(ws[e]=e.replace(Cs,po))}static separate(e){const t=Ss[e];return t||(Ss[e]=this.capitalize(e.replace(Cs,yo)))}static createId(e){return String(e).replace(uo,vo)}static makeValidDomId(e,t=""){return e==null?null:String(e).replace(ho,t)}static escapeRegExp(e,t){let i=e.replace(ao,"\\$&");return t!==void 0&&(i=new RegExp(i,t)),i}static decodeHtml(e){return e&&String(e).replace(bs,go)}static encodeHtml(e=""){return e&&String(e).replace(vs,mo)}static encodeHtmlBR(e){var t;return(t=Ye.encodeHtml(e))===null||t===void 0?void 0:t.replace(oo,"<br>")}static isHtml(e){return typeof e=="string"&&co.test(e||"")}static initHtmlEntities(e){e=e||{"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#39;"};const t=Object.keys(e);ps=e,ys=t.reduce((i,r)=>(i[e[r]]=r,i),{}),vs=new RegExp(`([${t.map(i=>"[-]".includes(i)?"\\"+i:i).join("")}])`,"g"),bs=new RegExp(`(${Object.values(e).join("|")}|&#[0-9]+;)`,"ig")}static safeJsonParse(e){let t=null;try{t=JSON.parse(e)}catch(i){}return t}static safeJsonStringify(e,t=null,i=null){let r=null;try{r=JSON.stringify(e,t,i)}catch(s){}return r}static joinPaths(e,t="/"){return e.join(t).replace(new RegExp("\\"+t+"+","g"),t)}static split(e,t=fo){let i=e;return typeof i=="string"&&(i=e.trim(),i=i?i.split(t):[]),i}static xss(e,...t){const i=[];let r=t.length;for(i[r]=e[r];r-- >0;)i[r]=e[r]+Ye.encodeHtml(t[r]);return i.join("")}static xssBR(e,...t){const i=[];let r=t.length;for(i[r]=e[r];r-- >0;)i[r]=e[r]+Ye.encodeHtmlBR(t[r]);return i.join("")}static toJavaScriptValue(e,t){const i=F.typeOf(e);if(i==="boolean"||i==="string"||i==="number"||e===null)return Ye.safeJsonStringify(e);if(e===globalThis)return"window";if(i==="date")return`new Date(${e.getFullYear()}, ${e.getMonth()}, ${e.getDate()}, ${e.getHours()}, ${e.getMinutes()}, ${e.getSeconds()}, ${e.getMilliseconds()})`;if(i==="array")return`[${e.map(r=>Ye.toJavaScriptValue(r,t))}]`;if(i==="object"||i==="instance")return this.toJavaScriptString(e,t);if(i==="function"){let r=e.toString();return r.match(/^async (\w+?)\(/)?r=r.replace(/^async (\w+?)\(/,"async function("):!r.startsWith("async(")&&r.match(/^(\w+?)\(/)&&(r=r.replace(/^(\w+?)\(/,"function(")),r}if(i==="class")return e.toJavaScriptValue?e.toJavaScriptValue(t):Object.prototype.hasOwnProperty.call(e,"$name")?e.$name:e.name}static toJavaScriptString(e,t={}){var s;const i=(s=t.level)!=null?s:0,r=2;return`{
`+Object.keys(e).map(n=>" ".repeat((i+1)*r)+(n.match(/[- *]/)?`"${n}"`:n)+`: ${Ye.toJavaScriptValue(e[n],{...t,level:i+1})}`).join(`,
`)+`
`+" ".repeat(i*r)+"}"}static encodeAttributeSelector(e,t){return`[${e}="${String(t).replace(/["\\]/g,"\\$&")}"]`}static generateUUID(){var e;return B.supportsRandomUUID?globalThis.crypto.randomUUID():(e=globalThis.crypto)!==null&&e!==void 0&&e.getRandomValues?([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,t=>(t^globalThis.crypto.getRandomValues(new Uint8Array(1))[0]&15>>t/4).toString(16)):`${Date.now()}-${++Ye.fakeNodeUUIDIndex}`}};let k=Ye;R(k,"fakeNodeUUIDIndex",0),k.initHtmlEntities(),k._$name="StringHelper";const{hasOwnProperty:bo,toString:Co}=Object.prototype,{isFrozen:Es}=Object,wo=/\s*<\s*/,So=/\s*>\s*/,Ts={},xs={},Ds=Object.freeze({});class F{static assign(e,...t){for(let i,r,s=0;s<t.length;s++)if(i=t[s],i)for(r in i)e[r]=i[r];return e}static assignIf(e,...t){for(let i,r,s=0;s<t.length;s++)if(i=t[s],i)for(r in i)(!(r in e)||e[r]===void 0)&&(e[r]=i[r]);return e}static blend(e,t,i){i=i||Ts,e=e||{};const{clone:r=F.clone,merge:s=F.blend}=i;if(Array.isArray(t)){if(t.length>1)return t.forEach(n=>{e=F.blend(e,n,i)}),e;t=t[0]}if(t){let n,l,o;for(l in t)o=t[l],o&&F.isObject(o)&&(n=e[l],i.key=l,n&&F.isObject(n)?(Es(n)&&(e[l]=n=r(n,i)),o=s(n,o,i)):o=Es(o)?o:r(o,i)),e[l]=o}return e}static clone(e,t){let i=e,r;if(e&&typeof e=="object")if(t&&typeof t=="object"&&t&&(t=null),F.isObject(e))if(e.skipClone)i=e;else{i={};for(r in e)i[r]=F.clone(e[r])}else if(Array.isArray(e))for(i=[],r=e.length;r-- >0;)i[r]=F.clone(e[r]);else F.isDate(e)?i=new Date(e.getTime()):t&&(i=t(e));return i}static createTruthyKeys(e){const t=k.split(e),i=t&&{};if(t)for(const r of t)r&&(i[r]=!0);return i}static getPath(e,t){return t.split(".").reduce((i,r)=>(i||Ds)[r],e)}static getPathDefault(e,t,i){const r=Array.isArray(t)?t:typeof t=="string"?t.split("."):[t],s=r.length-1;return r.reduce((n,l,o)=>(i&&!(l in n)&&(n[l]=o===s?i:{}),(n||Ds)[l]),e)}static hasPath(e,t){return t.split(".").every(i=>e&&i in e?(e=e[i],!0):!1)}static getTruthyKeys(e){const t=[];for(const i in e)e[i]&&t.push(i);return t}static getTruthyValues(e){const t=[];for(const i in e)e[i]&&t.push(e[i]);return t}static isClass(e){var t;return typeof e=="function"&&((t=e.prototype)===null||t===void 0?void 0:t.constructor)===e}static isDate(e){return!!(e!=null&&e.getUTCDate)&&F.typeOf(e)==="date"}static isPromise(e){if(Promise&&Promise.resolve)return Promise.resolve(e)===e||typeof(e==null?void 0:e.then)=="function";throw new Error("Promise not supported in your environment")}static isEmpty(e){if(e&&typeof e=="object")for(const t in e)return!1;return!0}static isObject(e){const t=e==null?void 0:e.constructor;return!!(t?t===Object||t.getPrototypeOf&&t.prototype&&!Object.getPrototypeOf(t.prototype):e&&typeof e=="object")}static isInstantiated(e){return e?typeof e=="object"&&!F.isObject(e):!1}static merge(e,...t){return F.blend(e,t)}static mergeItems(e,t,i){i=i||Ts;let r,s,n,l,o,a,c;const{merge:d=F.blend}=i;if(e=e||{},Array.isArray(t))t.forEach(g=>{e=F.mergeItems(e,g,i)});else if(t)for(o in t)if(c=t[o],r=null,o.includes(">")?([o,r]=o.split(So),s=0):o.includes("<")&&([r,o]=o.split(wo),s=1),o in e)c&&e[o]&&d&&(i.key=o,c=d(e[o],c,i)),e[o]=c;else if(r){if(!l){l=new Map,n=0;for(const g in e)l.set(g,n++)}if(n=l.get(r),e[o]=c,n==null&&s)n=l.size;else{a=a||[],n=(n||0)+s;for(const g of l){const[h,p]=g;n<=p&&(a&&(a[l.size-p-1]=h),l.set(h,p+1))}if(a)for(;a.length;){const g=a.pop(),h=e[g];delete e[g],e[g]=h}}l.set(o,n)}else{var f;e[o]=c,(f=l)===null||f===void 0||f.set(o,l.size)}return e}static setPath(e,t,i){return t.split(".").reduce((r,s,n,l)=>n===l.length-1?r[s]=i:(r[s]instanceof Object||(r[s]={}),r[s]),e),e}static typeOf(e){let t,i;return e===null?i="null":e!==e?i="nan":(i=typeof e,i==="object"?e.isBase?i="instance":Array.isArray(e)?i="array":(i=xs[t=Co.call(e)])||(xs[t]=i=t.slice(8,-1).toLowerCase()):i==="function"&&e.isBase&&(i="class")),i}}Object.defineProperty(F,"hasOwn",{value:Object.hasOwn||((u,e)=>bo.call(u,e))}),F._$name="Objects";class ne{static setVersion(e,t){e=e.toLowerCase(),Me[e]={version:t,isNewerThan(s){return ne.semanticCompareVersion(s,t,"<")},isOlderThan(s){return ne.semanticCompareVersion(s,t,">")}};let i="";typeof productName!="undefined"&&(i=productName);const r=`${i}.${e}${t.replace(/\./g,"-")}`;if(B.isBrowserEnv&&!globalThis.bryntum.silenceBundleException)if(globalThis.bryntum[r]===!0)if(this.isTestEnv)globalThis.BUNDLE_EXCEPTION=!0;else{let s=i||e;s==="core"&&(s="grid");let n=k.capitalize(s);throw s==="schedulerpro"&&(n="SchedulerPro"),new Error(`The Bryntum ${n} bundle was loaded multiple times by the application.

Common reasons you are getting this error includes:

* Imports point to different types of the bundle (e.g. *.module.js and *.umd.js)
* Imports point to both sources and bundle
* Imports do not use the shortest relative path, JS treats them as different files
* Cache busters differ between imports, JS treats ${s}.module.js?1 and ${s}.module.js?2 as different files
* Imports missing file type, verify they all end in .js

See https://bryntum.com/products/${s}/docs/guide/${n}/gettingstarted/es6bundle#troubleshooting for more information

`)}else globalThis.bryntum[r]=!0}static getVersion(e){if(e=e.toLowerCase(),!Me[e])throw new Error("No version specified! Please check that you import VersionHelper correctly into the class from where you call `deprecate` function.");return Me[e].version}static semanticCompareVersion(e,t,i="="){e=e||"",t=t||"";const r=e.split(/[-.]/),s=t.split(/[-.]/),n=i.includes("<"),l=(a,c)=>{const d=["rc","beta","alpha"],f=a.map(g=>{if(d.includes(g))return-d.indexOf(g)-2;const h=Number.parseInt(g);return Number.isNaN(h)?-d.length:h});for(;f.length<c;)f.push(-1);return f},o=()=>{const a=Math.max(r.length,s.length),c=l(r,a),d=l(s,a);for(let f=0;f<a;f++)if(c[f]!==d[f])return n?c[f]<d[f]:c[f]>d[f];return!0};switch(i){case"=":return e===t;case"<=":case">=":return e===t||o();case"<":case">":return e!==t&&o()}return!1}static checkVersion(e,t,i){return ne.semanticCompareVersion(Me.getVersion(e),t,i)}static deprecate(e,t,i){if(Me.checkVersion(e,t,"<"))console.warn(`Deprecation warning: You are using a deprecated API which will change in v${t}. ${i}`);else throw new Error(`Deprecated API use. ${i}`)}static get isTestEnv(){var e;const t=!!(!((e=globalThis.bryntum)===null||e===void 0)&&e.isTestEnv);try{var i,r;return t||!!(!((i=globalThis.parent)===null||i===void 0||(r=i.bryntum)===null||r===void 0)&&r.isTestEnv)}catch(s){return t}}static get isDebug(){return!1}}const Me=ne;B.isBrowserEnv&&(Me.isTestEnv&&(B._isHoverableDevice=!0),globalThis.bryntum=Object.assign(globalThis.bryntum||{},{getVersion:Me.getVersion.bind(Me),checkVersion:Me.checkVersion.bind(Me),deprecate:Me.deprecate.bind(Me),license:"bf757ffb-df5b-11e9-9294-d094663d5c88"})),ne._$name="VersionHelper";const{defineProperty:yi,getOwnPropertyDescriptor:Ms}=Reflect,{hasOwnProperty:Is,toString:er}=Object.prototype,tr=Symbol("instanceProperties"),Os=Symbol("configuring"),St=Symbol("lazyConfigValues"),Ls=er.call(new Date),Eo=/\s+/,To=(u,e)=>(u[e]=1,u);class Q{static get(e,t){const{cache:i}=this,r=i[e]||(i[e]=new Q(e));let s=r,n;return t&&(n=Q.makeCacheKey(e,t),(s=n&&i[n])||(s=r.extend(t),n&&(i[n]=s))),s}constructor(e){const t=this,i=e[0].toUpperCase()+e.substr(1);t.base=t,t.name=e,t.field="_"+e,t.capName=i,t.changer="change"+i,t.initializing="initializing"+i,t.updater="update"+i}get descriptor(){let e=this._descriptor;return(!e||!Is.call(this,"_descriptor"))&&(this._descriptor=e=this.makeDescriptor()),e}get initDescriptor(){let e=this._initDescriptor;return(!e||!Is.call(this,"_initDescriptor"))&&(this._initDescriptor=e=this.makeInitter()),e}equal(e,t){return e===t}extend(e){const t=Object.assign(Object.create(this),e),{equal:i,merge:r}=e,{equalityMethods:s}=Q;return typeof i=="string"&&(i.endsWith("[]")?t.equal=Q.makeArrayEquals(s[i.substr(0,i.length-2)]):t.equal=s[i]),typeof r=="string"&&(t.merge=Q.mergeMethods[r]),t}define(e){const t=Ms(e,this.name);let i=this.descriptor;t&&t.get&&(i=Object.assign({},i),i.get=t.get),yi(e,this.name,i)}defineInitter(e,t){const{name:i}=this,r=e[tr];let s,n;!r[i]&&(n=Ms(e,i))&&!("value"in n)&&(r[i]=n),yi(e,i,this.initDescriptor),this.lazy&&(s=e[St]||(e[St]=new Map),s.set(i,t))}static makeArrayEquals(e){return(t,i)=>{let r,s=t&&i&&t.length===(r=i.length);if(s&&Array.isArray(t)&&Array.isArray(i))if(e)for(;s&&r-- >0;)s=e(t[r],i[r]);else for(;s&&r-- >0;)s=t[r]===i[r];else s=e?e(t,i):t===i;return s}}static makeCacheKey(e,t){const i=Object.keys(t).sort();for(let r,s,n,l=i.length;l-- >0;)if(n=t[r=i[l]],n==null&&n===!1)i.splice(l,1);else{if(s=typeof n,s==="function")return null;s==="string"?i[l]=`${r}:"${n}"`:s==="number"&&(i[l]=`${r}:${n}`)}return i.length?`${e}>${i.join("|")}`:e}makeDescriptor(){const e=this,{base:t,field:i,changer:r,updater:s,name:n}=e;return t!==e&&t.equal===e.equal?t.descriptor:{get(){var l;return(l=this.configObserver)===null||l===void 0||l.get(n,this),this[i]},set(l){const o=this;let a=o[i],c,d;if(typeof l=="string"){let h=l;if(l.startsWith("up.")){var f;h=(f=o.owner)===null||f===void 0?void 0:f.resolveProperty(l.substr(3))}else l.startsWith("this.")&&(h=o.resolveProperty(l.substr(5)));h!==void 0&&typeof h!="function"&&(l=h)}if(o[r]&&(c=(d=o[r](l,a))===void 0,c||(l=d,a=o[i])),!c&&!(e.equal===Fs?a===l:e.equal(a,l))){var g;o[i]=l,c=!0,(g=o[s])===null||g===void 0||g.call(o,l,a)}c&&!o.isDestroyed&&!o.onConfigChange.$nullFn&&o.onConfigChange({name:n,value:l,was:a,config:e})}}}makeInitter(){const e=this;return e!==e.base?e.lazy?e.makeLazyInitter():e.base.initDescriptor:e.makeBasicInitter()}makeBasicInitter(){const e=this,{initializing:t,name:i}=e;return{configurable:!0,get(){const r=this;return e.removeInitter(r),r[t]=!0,r[i]=r[Os][i],r[t]=!1,r.configDone[i]=!0,r[i]},set(r){e.removeInitter(this),this.configDone[i]=!0,this[i]=r}}}makeLazyInitter(){const e=this,{initializing:t,name:i}=e;return{configurable:!0,get(){const r=this,s=r[St].get(i);return e.removeInitter(r),r.isDestroying||(r[t]=!0,r[i]=s,r[t]=!1),r[i]},set(r){e.removeInitter(this),this[i]=r}}}removeInitter(e){const{name:t}=this,i=e[tr][t],r=e[St];i?yi(e,t,i):delete e[t],r!=null&&r.delete(t)&&!r.size&&delete e[St]}setDefault(e,t){yi(e.prototype,this.field,{configurable:!0,writable:!0,value:t})}merge(e,t){if(t&&e&&F.isObject(e)){if(t.isBase)return t.setConfig(e);F.isObject(t)&&(e=F.merge(F.clone(t),e))}return e}}const{prototype:Vt}=Q,{equal:Fs}=Vt;Q.symbols={configuring:Os,instanceProperties:tr,lazyConfigs:St},Q.cache=Object.create(null),Q.equalityMethods={array:Q.makeArrayEquals(),date(u,e){return u===e?!0:u&&e&&er.call(u)===Ls&&er.call(e)===Ls?u.getTime()===e.getTime():!1},strict:Q.equal=Fs},Q.mergeMethods={distinct(u,e){let t=e?e.slice():[];if(u!=null)if(F.isObject(u))if(e===void 0)t=u;else{let i,r;for(i in u)r=t.indexOf(i),u[i]?r<0&&t.push(i):r>-1&&t.splice(r,1)}else Array.isArray(u)?u.forEach(i=>!t.includes(i)&&t.push(i)):t.includes(u)||t.push(u);return t},merge:Q.merge=Vt.merge,classList(u,e){if(typeof u=="string"){if(!u.length)return e;u=u.split(Eo)}return Array.isArray(u)&&(u=u.reduce(To,{})),Q.merge(u,e)},objects(u,e){return u===!0?e||{}:Q.merge(u,e)},replace(u){return u},items(u,e,t,i){return i?F.mergeItems(e,u,{merge:(r,s)=>Vt.merge(s,r)}):Vt.merge(u,e)}},Object.assign(Vt,{_descriptor:null,_initDescriptor:null,lazy:!1,nullify:!1,render:!1}),Q._$name="Config";class xo{constructor(e){e&&Object.assign(this,e)}getInherited(e,t=!0){let i=this[e];if(!(e in this)){var r;i=(r=this.super)===null||r===void 0?void 0:r.getInherited(e,t),(i||t)&&(this[e]=i=Object.create(i||null))}return i}}const{getPrototypeOf:ks}=Object,{hasOwn:Re}=F,{defineProperty:$s}=Reflect,vi=Symbol("classMetaData"),Rs=Symbol("mixinTag"),ir=Symbol("originalConfig"),je=Q.symbols.configuring,Do=Q.symbols.instanceProperties,zt=Q.symbols.lazyConfigs,Mo={merge:"replace",simple:!0},bi=()=>{},Ps=u=>new xo(u),As={},Io=Object.freeze({}),_s=Object.freeze([]);class ${static get isBase(){return!0}get isBase(){return!0}static get declarable(){return["declarable","configurable","defaultConfig","properties","prototypeProperties"]}constructor(...e){const t=this,i=t.constructor;t.$meta.class!==i&&bi(i.$meta),t.construct(...e),t.afterConstruct(),t.isConstructing=!1}static new(...e){return e=e.filter(t=>t),new this(e.length>1?this.mergeConfigs(...e):e[0])}construct(...e){e[0]!==null&&this.configure(...e),this.afterConfigure()}static destroy(...e){const t=i=>{i!=null&&i.destroy?i.destroy():Array.isArray(i)&&i.forEach(t)};t(e)}destroy(){const e=this,{id:t}=e;e.isDestroying=!0,e.destroy=bi,e.doDestroy(),Object.setPrototypeOf(e,null);for(const i in e)i!=="destroy"&&i!=="isDestroying"&&delete e[i];delete e[ir],e.isDestroyed=!0,e.id=t}_thisIsAUsedExpression(e){}static get $$name(){return Re(this,"$name")&&this.$name||Re(this,"_$name")&&this._$name||this.name}get $$name(){return this.constructor.$$name}startConfigure(e){}finishConfigure(e){}afterConfigure(){}afterConstruct(){}callback(e,t,i=_s){const{handler:r,thisObj:s}=this.resolveCallback(e,t==="this"?this:t)||Io;return r==null?void 0:r.apply(s,i)}resolveProperty(e){let t=this;for(;t;){if(F.hasPath(t,e))return F.getPath(t,e);t=t.owner}}resolveCallback(e,t=this,i=!0){var r;if((r=e)!==null&&r!==void 0&&r.substring){if(e.endsWith("?")&&(i=!1,e=e.substring(0,e.length-1)),e.startsWith("up.")){for(e=e.substring(3),t=this.owner;t&&!t[e];t=t.owner);if(!t)return}else e.startsWith("this.")&&(e=e.substring(5),t=this);if(!t||!(t instanceof Object))return;e=t[e]}if(typeof e=="function")return{handler:e,thisObj:t};if(i)throw new Error(`No method named ${e} on ${t.$$name||"thisObj object"}`)}bindCallback(e,t=this){if(e){const{handler:i,thisObj:r}=this.resolveCallback(e,t);if(i)return i.bind(r)}}delay(e,t,i=e.name||e){return e=this.setTimeout?e:e.bind(this),(this.setTimeout?this:globalThis)[typeof t=="number"?"setTimeout":"requestAnimationFrame"](e,t,i)}doDestroy(){const e=this,{nullify:t}=e.$meta;if(t)for(let i=0;i<t.length;++i)e[t[i].field]!=null&&(e[t[i].name]=null)}destroyProperties(...e){const t=this;let i;for(i of e)if(i in t&&(!t[je]||!t[je][i])){var r,s,n;(r=t[i])===null||r===void 0||(s=(n=r).destroy)===null||s===void 0||s.call(n),delete t[i]}}configure(e={}){const t=this,i=t.$meta,{beforeConfigure:r}=e,s=i.configs,n=t.getDefaultConfiguration();let l,o,a;t.initialConfig=e,t.isConfiguring=!0,Object.assign(t,t.getProperties());for(o in e)a=e[o],l=s[o],n[o]=l?l.merge(a,n[o],null,i):a;r&&(delete n.beforeConfigure,r(t,n)),t.setConfig(t[ir]=n,!0),t.isConfiguring=!1}getConfig(e){return this[e]}setConfig(e,t){const i=this,r=i[je],s=r?i.configDone:i.configDone={},n=i.$meta.configs;let l,o;i[Do]={},i[je]=r?Object.setPrototypeOf(Object.assign({},e),r):e;for(o in e)e[o]!=null||Re(e,o)?(l=n[o]||Q.get(o),l.defineInitter(i,e[o]),t||(s[o]=!1)):s[o]=!0;t&&i.startConfigure(e);for(o in e){var a;!s[o]&&!((a=n[o])!==null&&a!==void 0&&a.lazy)&&(i[o]=e[o])}return r?i[je]=r:delete i[je],t&&i.finishConfigure(e),i}hasConfig(e){var t;const i=this,r=i[je];return!!(i["_"+e]!=null||((t=i[zt])===null||t===void 0?void 0:t.get(e))!=null||!i.configDone[e]&&r&&(r[e]!=null||Re(r,e)))}peekConfig(e){const t=this,i=t[zt],r=t[je];if(i!=null&&i.has(e))return i.get(e);if(r&&e in r){if(t.configDone[e])return t[e];if(r[e]!=null||Re(r,e))return r[e]}}triggerConfig(e){const t=this,{configDone:i}=t,r=t[zt],s=t[je],n=r!=null&&r.has(e)||s&&(s[e]!=null||Re(s,e))?!i[e]:null;return n&&t.getConfig(e),n}triggerConfigs(e){const t=this,i=t.$meta.configs,r=t[zt],s=r?[...r.keys()].filter(n=>i[n].lazy===e):_s;for(const n of s)t.triggerConfig(n);return s.length?s:null}onConfigChange(){}get config(){const e={},t=this[ir];for(const i in t)e[i]=t[i];return e}static processConfigValue(e,t){if(e===globalThis)return globalThis;if(Array.isArray(e))return e.map(i=>$.processConfigValue(i,t));if(e instanceof $)return t.visited.has(e)?void 0:e.getCurrentConfig(t);if(e instanceof HTMLElement||e instanceof DocumentFragment)return null;if(F.isObject(e)){const i={};for(const r in e)r!=="owner"&&(i[r]=$.processConfigValue(e[r],t));return i}return e}getConfigValue(e,t){var i;const r=this,s=r[zt];if(!((i=r.$meta.configs[e])!==null&&i!==void 0&&i.lazy))return $.processConfigValue(r[e],t);if(s!=null&&s.has(e))return $.processConfigValue(s.get(e),t)}preProcessCurrentConfigs(){}getCurrentConfig(e={}){const t=this,i=e.configs==="all"?t.config:F.clone(t.initialConfig),r=e.visited||(e.visited=new Set),s=e.depth||(e.depth=0),n={};if(!r.has(t)){r.add(t),this.preProcessCurrentConfigs(i);for(const l in i){const o=t.getConfigValue(l,{...e,depth:s+1});o!==void 0&&(n[l]=o)}return n}}getConfigString(e={}){return k.toJavaScriptString(this.getCurrentConfig(e))}getTestCase(e={}){const t=this.isGantt?"Gantt":this.isSchedulerPro?"SchedulerPro":this.isCalendar?"Calendar":this.isScheduler?"Scheduler":this.isGrid?"Grid":this.isTaskBoard?"TaskBoard":null;if(t){const i=t.toLowerCase(),r=`../../build/${i}.module.js`;let s,n;e.import==="static"?(s=`import * as module from "${r}";Object.assign(window, module);`,n=""):(s=`import("${r}").then(module => { Object.assign(window, module);
`,n="});");const l=ne.getVersion(i);return l&&(s+=`
console.log('${t} ${l}');
`),`${s}      
const ${i} = new ${t}(${this.getConfigString(e)});
${n}`}}downloadTestCase(e={}){e.output="return";const t=this.getTestCase(e);B.download("app.js","data:application/javascript;charset=utf-8,"+escape(t))}static initClass(){return this.$meta.class}static get $meta(){const e=this;let t=e[vi];return Re(e,vi)||(e[vi]=t=Ps(),t.class=e,e.setupClass(t)),t}static onClassMixedIn(){}static mergeConfigs(e,...t){const i=this.$meta.configs,r=F.clone(e)||{};let s,n,l,o;for(n=0;n<t.length;++n)if(s=t[n],s)for(l in s)o=s[l],i[l]?o=i[l].merge(o,r[l]):r[l]&&o&&(o=Q.merge(o,r[l])),r[l]=o;return r}static mixin(...e){let t=this,i;for(i=0;i<e.length;++i){const r=e[i],s=r[Rs]||(r[Rs]=Symbol("mixinTag"));t[s]||(t=r(t),t[s]=!0,Re(t,"onClassMixedIn")&&t.onClassMixedIn())}return t}static setupClass(e){var t;const i=e.class,r=ks(i).$meta,s=i.$$name,n=r.names,l=i.prototype;if($s(l,"$meta",{value:e}),Object.assign(e,{super:r,config:Object.create(r.config),configs:Object.create(r.configs),declarables:r.declarables,forkConfigs:r.forkConfigs,hierarchy:Object.freeze([...r.hierarchy,i]),names:n.includes(s)?n:Object.freeze([...n,s]),properties:r.properties,nullify:(t=r.nullify)===null||t===void 0?void 0:t.slice()}),n!==e.names){const o=`is${s}`,a=c=>{Re(c,o)||$s(c,o,{get(){return!0}})};a(l),a(i)}for(let o,a,c=0;c<e.declarables.length;++c)o=e.declarables[c],Re(i,o)&&(a=As[o]||(As[o]=`setup${k.capitalize(o)}`),i[a](i,e))}static setupConfigs(e,t,i){const r=e.config,s=e.configs,n=e.class,l=e.super;let{nullify:o}=e,a,c,d,f,g,h;for(const p in t)g=t[p],i?(a=s[p])?g=a.merge(g,r[p],e,l):a=Q.get(p,Mo):(c=d=f=void 0,g&&typeof g=="object"&&"$config"in g&&(d=g.$config,d&&!F.isObject(d)&&(d=F.createTruthyKeys(d)),f="default"in g,c=f?g.default:c,g=g.value),(a=s[p])?(h=a.nullify,d&&(a=a.extend(d)),g=a.merge(g,r[p],e,l)):(a=Q.get(p,d),a.define(n.prototype),f=!(a.field in n.prototype),h=!1),f&&a.setDefault(n,c),a.nullify&&!h&&(o||(o=e.nullify||(e.nullify=[]))).push(a)),g&&(F.isObject(g)||Array.isArray(g))&&!Object.isFrozen(g)&&(e.forkConfigs=!0),s[p]=a,r[p]=g}static setupConfigurable(e,t){e.setupConfigs(t,e.configurable,!1)}static setupDefaultConfig(e,t){e.setupConfigs(t,e.defaultConfig,!0)}static setupDeclarable(e,t){const i=e.declarable;let r=t.declarables,s,n;for(n=0;n<i.length;++n)r.includes(i[n])||(s||(t.declarables=s=r=r.slice()),r.push(i[n]))}static setupProperties(e,t){t.properties=t.super.properties.slice(),t.properties.push(e),Object.freeze(t.properties)}static setupPrototypeProperties(e){Object.assign(e.prototype,e.prototypeProperties)}getDefaultConfiguration(){return this.constructor.getDefaultConfiguration()}static getDefaultConfiguration(){const e=this.$meta,t=e.forkConfigs?$.fork(e.config):Object.create(e.config);if(ne.isTestEnv&&B.isBrowserEnv&&t.testConfig&&globalThis.__applyTestConfigs)for(const i in t.testConfig)t[i]=t.testConfig[i];return t}static fork(e){let t=e,i,r;if(e&&F.isObject(e)&&!Object.isFrozen(e)){t=Object.create(e);for(i in e)r=e[i],r&&(F.isObject(r)?t[i]=$.fork(r):Array.isArray(r)&&(t[i]=r.slice()))}return t}getProperties(){const e=this.$meta.properties,t={};for(let i=0;i<e.length;i++)Object.assign(t,e[i].properties);return t}static get superclass(){return ks(this)}classHierarchy(e){const t=this.$meta.hierarchy,i=e?t.indexOf(e):0;return i>0?t.slice(i):t}static isOfTypeName(e){return this.$meta.names.includes(e)}detachListeners(e){var t;let i=this.$detachers;if(i=(t=i)===null||t===void 0?void 0:t[e],i)for(;i.length;)i.pop()()}trackDetacher(e,t){const i=this.$detachers||(this.$detachers={});(i[e]||(i[e]=[])).push(t)}untrackDetachers(e){const t=this.$detachers;if(t)for(const i in t){const r=t[i];for(let s=r.length;s-- >0;)r[s].eventer===e&&r.splice(s,1)}}}const rr=$.prototype;rr.onConfigChange.$nullFn=bi.$nullFn=!0,$[vi]=rr.$meta=Ps({class:$,config:Object.freeze({}),configs:Object.create(null),declarables:$.declarable,forkConfigs:!1,hierarchy:Object.freeze([$]),names:Object.freeze(["Base"]),nullify:null,properties:Object.freeze([]),super:null}),Object.assign(rr,{$detachers:null,configObserver:null,isConstructing:!0,isDestroyed:!1,isDestroying:!1}),$.emptyFn=bi,ne.setVersion("core","5.5.0"),$._$name="Base";class j{static clean(e){return e.reduce((t,i)=>(i!=null&&!(Array.isArray(i)&&i.length===0)&&i!==""&&t.push(i),t),[])}static from(e,t,i){const r=[];if(e)for(const s of e)(!t||t(s))&&r.push(i?i(s):s);return r}static remove(e,...t){let i,r,s=!1;t=t[0]instanceof Set?[...t[0]]:t;for(let n=0;n<t.length;n++)r=t[n],(i=e.indexOf(r))!==-1&&(e.splice(i,1),s=!0);return s}static findInsertionIndex(e,t,i=this.lexicalCompare,r){const s=t.length;let n,l;return r<s&&(n=r>0?i(t[r-1],e):0,l=r<s-1?i(e,t[r]):0,n<1&&l<1)?r:this.binarySearch(t,e,i)}static findLast(e,t,i){for(let{length:r}=e,s=r-1;s>=0;s--)if(t.call(i,e[s],s,e))return e[s]}static binarySearch(e,t,i=0,r=e.length,s=this.lexicalCompare){const n=e.length;let l,o;for(i instanceof Function?(s=i,i=0):r instanceof Function&&(s=r,r=n),--r;i<=r;)l=i+r>>1,o=s(t,e[l]),o>=0?i=l+1:o<0&&(r=l-1);return i}magnitudeCompare(e,t){return e<t?-1:e>t?1:0}lexicalCompare(e,t){return e=String(e),t=String(t),e<t?-1:e>t?1:0}static fill(e,t={},i=null){const r=[],s=Array.isArray(t)?t:[t];for(let n=0;n<e;n++)for(const l of s){const o=Object.assign({},l);i&&i(o,n),r.push(o)}return r}static populate(e,t,i=!1){const r=[];for(let s=0;s<e;s++)r.push(t(s+(i?1:0)));return r}static include(e,...t){for(const i of t)e.includes(i)||e.push(i)}static unique(e){return[...new Set(e)]}static allowNegative(e){return new Proxy(e,{get(t,i,r){if(typeof i!="string")return Reflect.get(t,i,r);const s=Number(i);return Number.isNaN(s)?Reflect.get(t,i,r):t[s<0?t.length+s:s]},set(t,i,r,s){if(typeof i!="string")return Reflect.set(t,i,r,s);const n=Number(i);return Number.isNaN(n)?Reflect.set(t,i,r,s):(t[n<0?t.length+n:n]=r,!0)}})}static delta(e,t,i=!1){if(!t)return i?{toAdd:e,toRemove:[],toKeep:[]}:{onlyInA:e,onlyInB:[],inBoth:[]};const r=[],s=[],n=new Set,l=new Set(t);for(let o=0;o<e.length;o++){const a=e[o];l.has(a)?n.add(a):r.push(a)}for(let o=0;o<t.length;o++){const a=t[o];n.has(a)||s.push(a)}return i?{toAdd:r,toRemove:s,toKeep:n}:{onlyInA:r,onlyInB:s,inBoth:[...n]}}static asArray(e){return e==null?e:e instanceof Set?Array.from(e):Array.isArray(e)?e:[e]}static identity(e){return e}static keyBy(e,t,i=j.identity){const r=typeof t=="string"?n=>n==null?void 0:n[t]:t,s=typeof i=="string"?n=>n==null?void 0:n[i]:i;return e.reduce((n,l)=>(n[r(l)]=s(l),n),{})}static aggregate(e,t,i,r,s={}){const n=e.length,l=e[0].length,o=[];s.targetArray=o,s.arrays=e;for(let a=0;a<l;a++)s.entryIndex=a,o.push(r(a,s));for(let a=0;a<n;a++){const c=e[a];s.rowIndex=a;for(let d=0;d<l;d++){s.entryIndex=d;const f=t(c[d],s);o[d]=i(o[d],f,a,d,s)}}return o}static groupBy(e,t){const i=typeof t=="string"?r=>r==null?void 0:r[t]:t;return e.reduce((r,s)=>{const n=i(s);return(r[n]=r[n]||[]).push(s),r},{})}}j._$name="ArrayHelper";const Ns=/,\s*/,sr=Symbol("decompiled"),Oo=/^\s*(async\s+)?([a-z_]\w*)\s*=>([\s\S]+)$/i,Lo=/^\s*(async\s*)?\s*\(((?:[a-z_]\w*(?:, [a-z_]\w*)*)?)\)\s+=>([\s\S]+)$/i,Fo=/^(\s*async)?(?:\s*function)?(?:\s*([a-z_]\w*))?\s*\(((?:[a-z_]\w*(?:, [a-z_]\w*)*)?)\)([\s\S]+)$/i,{hasOwnProperty:ko}=Object.prototype;class ee{static after(e,t,i,r,s){const n=typeof i=="string",l=(s==null?void 0:s.return)!==!1,o=(...a)=>{const c=o.$nextHook.call(e,...a),d=r!=null&&r.isDestroyed?void 0:l?n?r[i](c,...a):i.call(r,c,...a):n?r[i](...a):i.call(r,...a);return d===void 0?c:d};return ee.hookMethod(e,t,o)}static before(e,t,i,r){const s=typeof i=="string",n=(...l)=>{const o=r!=null&&r.isDestroyed?0:s?r[i](...l):i.call(r,...l);return o===!1?o:n.$nextHook.call(e,...l)};return ee.hookMethod(e,t,n)}static curry(e){return function t(...i){return i.length>=e.length?e.apply(this,i):function(...r){return t.apply(this,i.concat(r))}}}static bindAll(e){for(const t in e)typeof e[t]=="function"&&(e[t]=e[t].bind(e))}static createInterceptor(e,t,i){return function(...r){const s=i||this;return t.call(s,...r)!==!1?e.call(s,...r):!1}}static createSequence(e,t,i){return(...r)=>{const s=e.call(i,...r),n=t.call(i,...r);return n===void 0?s:n}}static createThrottled(e,t,i,r,s){let n=-Number.MAX_VALUE,l,o;const a=()=>{o=0,n=performance.now(),l.push.apply(l,r),e.apply(i,l)},c=function(...d){const f=performance.now()-n;l=d,f>=t?(clearTimeout(o),a()):(o||(o=setTimeout(a,t-f)),s&&(l.push.apply(l,r),s.apply(i,l)))};return c.cancel=()=>clearTimeout(o),c}static createBuffered(e,t,i,r){let s,n;const l=()=>{n=0,o.isPending=!1,s.push.apply(s,r),e.apply(i,s)},o=function(...a){s=a,n&&clearTimeout(n),o.isPending=!0,n=setTimeout(l,t)};return o.cancel=()=>{o.isPending=!1,clearTimeout(n)},o}static decompile(e){if(!(sr in e)){var t,i;const r=e.toString();let s=Oo.exec(r),n,l,o,a,c;s?(n=[s[2]],l=s[3]):(s=Lo.exec(r))?(c=s[2].trim(),n=c?c.split(Ns):[],l=s[3]):(s=Fo.exec(r))&&(o=s[2],c=s[3].trim(),n=c?c.split(Ns):[],l=s[4]),l=(t=l)===null||t===void 0?void 0:t.trim(),e[sr]=a=s&&{args:n,async:!!s[1],body:(i=l)!==null&&i!==void 0&&i.startsWith("{")?l.substring(1,l.length-1).trim():l},o&&(a.name=o)}return e[sr]}static hookMethod(e,t,i){return i.$nextHook=e[t],e[t]=i,()=>{if(ko.call(e,t)){let n=e[t],l;if(n===i){var r;((r=Object.getPrototypeOf(e))===null||r===void 0?void 0:r[t])===i.$nextHook?delete e[t]:e[t]=i.$nextHook}else for(;l=(s=n)===null||s===void 0?void 0:s.$nextHook;n=l){var s;if(l===i){n.$nextHook=i.$nextHook;break}}}}}static noThrow(e,t,i){const r=e[t];e[t]=(...s)=>{try{return r.apply(e,s)}catch(n){return i==null?void 0:i(n)}}}static returnTrue(){return!0}static animate(e,t,i,r="linear"){let s=!1;const n=new Promise(l=>{const o=performance.now(),a=()=>{const c=Math.min((performance.now()-o)/e,1),d=i&&i.setTimeout?i:globalThis;s||t.call(i,this.easingFunctions[r](c))===!1&&l(),s||c===1?d.requestAnimationFrame(()=>l()):d.requestAnimationFrame(a)};a()});return n.cancel=()=>(s=!0,n.cancelled=!0,!1),n}}const Z=.5,Je=1.70158,Ie=7.5625,Ci=1.525,nr=2/2.75,lr=2.25/2.75,or=1/2.75,ar=1.5/2.75,cr=2.5/2.75,ur=2.625/2.75,dr=.75,fr=.9375,hr=.984375,$o=1.70158,Ro=1.70158;ee.easingFunctions={linear:u=>u,easeInQuad:u=>Math.pow(u,2),easeOutQuad:u=>-(Math.pow(u-1,2)-1),easeInOutQuad:u=>(u/=Z)<1?Z*Math.pow(u,2):-Z*((u-=2)*u-2),easeInCubic:u=>Math.pow(u,3),easeOutCubic:u=>Math.pow(u-1,3)+1,easeInOutCubic:u=>(u/=Z)<1?Z*Math.pow(u,3):Z*(Math.pow(u-2,3)+2),easeInQuart:u=>Math.pow(u,4),easeOutQuart:u=>-(Math.pow(u-1,4)-1),easeInOutQuart:u=>(u/=Z)<1?Z*Math.pow(u,4):-Z*((u-=2)*Math.pow(u,3)-2),easeInQuint:u=>Math.pow(u,5),easeOutQuint:u=>Math.pow(u-1,5)+1,easeInOutQuint:u=>(u/=Z)<1?Z*Math.pow(u,5):Z*(Math.pow(u-2,5)+2),easeInSine:u=>-Math.cos(u*(Math.PI/2))+1,easeOutSine:u=>Math.sin(u*(Math.PI/2)),easeInOutSine:u=>-Z*(Math.cos(Math.PI*u)-1),easeInExpo:u=>u===0?0:Math.pow(2,10*(u-1)),easeOutExpo:u=>u===1?1:-Math.pow(2,-10*u)+1,easeInOutExpo:u=>u===0?0:u===1?1:(u/=Z)<1?Z*Math.pow(2,10*(u-1)):Z*(-Math.pow(2,-10*--u)+2),easeInCirc:u=>-(Math.sqrt(1-u*u)-1),easeOutCirc:u=>Math.sqrt(1-Math.pow(u-1,2)),easeInOutCirc:u=>(u/=Z)<1?-Z*(Math.sqrt(1-u*u)-1):Z*(Math.sqrt(1-(u-=2)*u)+1),easeOutBounce:u=>u<or?Ie*u*u:u<nr?Ie*(u-=ar)*u+dr:u<cr?Ie*(u-=lr)*u+fr:Ie*(u-=ur)*u+hr,easeInBack:u=>u*u*((Je+1)*u-Je),easeOutBack:u=>(u=u-1)*u*((Je+1)*u+Je)+1,easeInOutBack:u=>{let e=$o;return(u/=Z)<1?Z*(u*u*(((e*=Ci)+1)*u-e)):Z*((u-=2)*u*(((e*=Ci)+1)*u+e)+2)},elastic:u=>-1*Math.pow(4,-8*u)*Math.sin((u*6-1)*(2*Math.PI)/2)+1,swingFromTo:u=>{let e=Ro;return(u/=Z)<1?Z*(u*u*(((e*=Ci)+1)*u-e)):Z*((u-=2)*u*(((e*=Ci)+1)*u+e)+2)},swingFrom:u=>u*u*((Je+1)*u-Je),swingTo:u=>(u-=1)*u*((Je+1)*u+Je)+1,bounce:u=>u<or?Ie*u*u:u<nr?Ie*(u-=ar)*u+dr:u<cr?Ie*(u-=lr)*u+fr:Ie*(u-=ur)*u+hr,bouncePast:u=>u<or?Ie*u*u:u<nr?2-(Ie*(u-=ar)*u+dr):u<cr?2-(Ie*(u-=lr)*u+fr):2-(Ie*(u-=ur)*u+hr),easeFromTo:u=>(u/=Z)<1?Z*Math.pow(u,4):-Z*((u-=2)*Math.pow(u,3)-2),easeFrom:u=>Math.pow(u,4),easeTo:u=>Math.pow(u,.25)},ee._$name="FunctionHelper";const{isArray:Vs}=Array,{hasOwnProperty:Po}=Object.prototype,zs={thisObj:1,detachable:1,once:1,detacher:1,prio:1,args:1,expires:1,buffer:1,throttle:1,name:1,$internal:1},Bs=(u,e)=>e.prio-u.prio;var Oe=u=>class gs extends(u||$){constructor(){super(...arguments);R(this,"eventsSuspended",null)}static get $name(){return"Events"}static get declarable(){return["deprecatedEvents"]}static setupDeprecatedEvents(i,r){const s=r.getInherited("deprecatedEvents"),n=i.deprecatedEvents;for(const l in n)s[l.toLowerCase()]=s[l]=n[l]}static get configurable(){return{listeners:{value:null,$config:{merge(i,r){if(i!==null){if(!i)return r;r&&(i=i?[i]:[],i.push[Vs(r)?"apply":"call"](i,r))}return i}}},internalListeners:null,bubbleEvents:null}}destroy(){this.trigger("beforeDestroy"),super.destroy()}construct(i,...r){var s;(this.configuredListeners=(s=i)===null||s===void 0?void 0:s.listeners)&&(i=F.assign({},i),delete i.listeners),super.construct(i,...r),this.processConfiguredListeners()}processConfiguredListeners(){if(this.configuredListeners){const i=this,{isConfiguring:r}=i;i.isConfiguring=!1,i.listeners=i.configuredListeners,i.configuredListeners=null,i.isConfiguring=r}}doDestroy(){this.trigger("destroy"),this.removeAllListeners(!1),super.doDestroy()}static setupClass(i){super.setupClass(i),gs.prototype.onListen.$nullFn=!0,gs.prototype.onUnlisten.$nullFn=!0}addListener(i,r,s){if(Vs(i)){for(let c=0,{length:d}=i;c<d;c++)this.addListener(i[c],r);return}const n=this,l=n.$meta.getInherited("deprecatedEvents");if(typeof i=="string")return n.addListener({[i]:r,detachable:r.detachable!==!1,thisObj:s});{r=i.thisObj=i.thisObj!==void 0?i.thisObj:r;for(const g in i)if(!zs[g]&&i[g]!=null){var o;const h=g.toLowerCase(),p=l==null?void 0:l[h],m=n.eventListeners||(n.eventListeners={}),y=i[g],b=y.expires||i.expires,C={fn:typeof y=="object"?y.fn:y,thisObj:y.thisObj!==void 0?y.thisObj:r,args:y.args||i.args,prio:y.prio!==void 0?y.prio:i.prio!==void 0?i.prio:0,once:y.once!==void 0?y.once:i.once!==void 0?i.once:!1,buffer:y.buffer||i.buffer,throttle:y.throttle||i.throttle,$internal:i.$internal,catchAll:g==="catchAll"};if(p){const{product:S,invalidAsOfVersion:x,message:L}=p;ne.deprecate(S,x,L)}if(b){const{alt:S}=b,x=S?b.delay:b,L=i.name||g,O=()=>{n.un(h,C),S&&!C.called&&n.callback(S,r)};n.isDelayable?n.setTimeout({fn:O,name:L,cancelOutstanding:!0,delay:x}):globalThis.setTimeout(O,x)}let E=m[h]||(m[h]=[]);E.$firing&&(m[h]=E=E.slice()),E.splice(j.findInsertionIndex(C,E,Bs,E.length),0,C),!n.onListen.$nullFn&&E.length<2&&n.onListen(h),(o=n.afterAddListener)===null||o===void 0||o.call(n,h,C)}i.relayAll&&n.relayAll(i.relayAll),r&&r!==n&&n.attachAutoDetacher(i,r);const c=i.detachable!==!1,d=i.name,f=i.expires||c||d?()=>{n.isDestroyed||n.removeListener(i,r)}:null;if(f){var a;if(f.eventer=n,f.listenerName=d,d&&(a=r)!==null&&a!==void 0&&a.trackDetacher&&r.trackDetacher(d,f),i.expires&&n.delay(f,isNaN(i.expires)?i.expires.delay:i.expires,d),c)return f}}}on(i,r,s){return this.addListener(i,r,s)}ion(i){return i.$internal=!0,this.on(i)}un(...i){this.removeListener(...i)}updateInternalListeners(i,r){r==null||r.detach(),i&&(i.detach=this.ion(i))}get listeners(){return this.eventListeners}changeListeners(i){if(this.isConfiguring)this.getConfig("internalListeners"),i&&this.on(i,this);else{if(Array.isArray(i))for(let r=0,s=i[0],{length:n}=i;r<n;s=i[++r])"thisObj"in s||(i[r]=F.assign({thisObj:this},s));else i&&!("thisObj"in i)&&(i=F.assign({thisObj:this},i));return i}}updateListeners(i,r){r&&this.un(r),i&&this.on(i)}removeListener(i,r=i.thisObj,s){const n=this;if(typeof i=="string")return n.removeListener({[i]:r},s);Object.entries(i).forEach(([l,o])=>{if(!zs[l]&&o!=null){l=l.toLowerCase();const{eventListeners:c}=n,d=n.findListener(l,o,r);if(d>=0){var a;let f=c[l];(a=n.afterRemoveListener)===null||a===void 0||a.call(n,l,f[d]),f.length>1?(f.$firing&&(c[l]=f=f.slice()),f.splice(d,1)):(delete c[l],n.onUnlisten.$nullFn||n.onUnlisten(l))}}}),i.thisObj&&!i.thisObj.isDestroyed&&n.detachAutoDetacher(i)}findListener(i,r,s){var n;const l=(n=this.eventListeners)===null||n===void 0?void 0:n[i],o=r.fn||r,a=r.thisObj||s;if(l){for(let c,d=0,{length:f}=l;d<f;d++)if(c=l[d],c.fn===o&&c.thisObj===a)return d}return-1}hasListener(i){var r;return!!(!((r=this.eventListeners)===null||r===void 0)&&r[i==null?void 0:i.toLowerCase()])}relayAll(i,r,s=!0){this.relayAllTargets||(this.relayAllTargets=[]);const{relayAllTargets:n}=this;i.ion({beforeDestroy:({source:l})=>{l===i&&n.filter(a=>a.through===i).forEach(a=>j.remove(n,a))}}),n.push({through:i,prefix:r,transformCase:s})}removeAllListeners(i=!0){const r=this.eventListeners;let s,n;for(const c in r){const d=r[c];for(s=d.length;s-- >0;){const f=d[s];if(!f.$internal||!i){var l,o,a;this.removeListener(c,f),n=f.thisObj,(l=n)===null||l===void 0||(o=(a=l).untrackDetachers)===null||o===void 0||o.call(a,this)}}}}relayEvents(i,r,s=""){const n={detachable:!0,thisObj:this};return r.forEach(l=>{n[l]=(o,...a)=>this.trigger(s+l,o,...a)}),i.on(n)}onListen(){}onUnlisten(){}destructorInterceptor(){const{autoDetachers:i,target:r,oldDestructor:s}=this;for(let n=0;n<i.length;n++){const{dispatcher:l,config:o}=i[n];l.isDestroyed||l.removeListener(o,r)}s.call(r)}attachAutoDetacher(i,r){const s=i.thisObj||r,n="doDestroy"in s?"doDestroy":"destroy";if(n in s){let{$autoDetachers:l}=s;l||(s.$autoDetachers=l=[]),s.$oldDestructor||(s.$oldDestructor=s[n],s[n]=this.destructorInterceptor.bind({autoDetachers:l,oldDestructor:s.$oldDestructor,target:s})),l.push({config:i,dispatcher:this})}else s[n]=()=>{this.removeListener(i)}}detachAutoDetacher(i){const r=i.thisObj;r.$oldDestructor&&!r.isDestroying&&(j.remove(r.$autoDetachers,r.$autoDetachers.find(s=>s.config===i&&s.dispatcher===this)),r.$autoDetachers.length||(r["doDestroy"in r?"doDestroy":"destroy"]=r.$oldDestructor,r.$oldDestructor=null))}await(i,r={checkLog:!0,resetLog:!0,args:null}){const s=this;r===!1&&(r={checkLog:!1});const{args:n}=r;return new Promise(l=>{var o;if(r.checkLog&&(o=s._triggered)!==null&&o!==void 0&&o[i]&&(l(),r.resetLog&&s.clearLog(i)),n){const a=s.on({[i]:(...c)=>{(typeof n=="function"?n(...c):Object.keys(n).every(f=>f in c[0]&&c[0][f]===n[f]))&&(l(...c),r.resetLog&&s.clearLog(i),a())},prio:-1e4})}else s.on({[i]:(...a)=>{l(...a),r.resetLog&&s.clearLog(i)},prio:-1e4,once:!0})})}clearLog(i){this._triggered&&(i?delete this._triggered[i]:this._triggered={})}trigger(i,r){var s,n,l,o,a;const c=this,d=i.toLowerCase(),{eventsSuspended:f,relayAllTargets:g,callOnFunctions:h}=c;let p=(s=c.eventListeners)===null||s===void 0?void 0:s[d],m;if(c._triggered||(c._triggered={}),c._triggered[i]=!0,f)return f.shouldQueue&&f.queue.push(arguments),!0;if((n=c.eventListeners)!==null&&n!==void 0&&n.catchall&&((p=p?p.slice():[]).push(...c.eventListeners.catchall),p.sort(Bs)),!p&&!g&&!h)return!0;if(r?"source"in r||(Object.isExtensible(r)?r.source=c:r=Object.setPrototypeOf({source:c},r)):r={source:c},r.type!==d&&(r.constructor!==Object?Reflect.defineProperty(r,"type",{get:()=>d}):r.type=d),r.eventName=i,!("bubbles"in r)&&(l=c.bubbleEvents)!==null&&l!==void 0&&l[i]&&(r.bubbles=c.bubbleEvents[i]),h){const C="on"+k.capitalize(i);if(C in c){var y;const E=c[C]?c.callback(c[C],c,[r]):!0;let S;if(F.isPromise(E)?(m||(m=[])).push(E):S=E===!1||S,!c.isDestroyed&&Po.call(c,C)&&!((y=c.pluginFunctionChain)!==null&&y!==void 0&&y[C])){const x=Object.getPrototypeOf(c);if(C in x){const L=x[C].call(c,r);if(F.isPromise(L)?(m||(m=[])).push(L):S=L===!1||S,c.isDestroyed)return}}if(S)return!1}}let b;if(p){let C=0,E=!1;for(p.$firing=!0,C;C<p.length&&!c.isDestroyed&&!E;C++){const S=p[C];if(b===!1&&!S.$internal)continue;let x,L=S.thisObj;if(!L||!L.isDestroyed){if(S.called=!0,S.once&&c.removeListener(d,S),typeof S.fn=="string"){if(L&&(x=L[S.fn]),!x){const P=c.resolveCallback(S.fn);x=P.handler,L=P.thisObj}}else x=S.fn;if(S.buffer){if(!S.bufferFn){const P=Number(S.buffer);if(typeof P!="number"||isNaN(P))throw new Error(`Incorrect type for buffer, got "${P}" (expected a Number)`);S.bufferFn=ee.createBuffered(x,P,L,S.args)}x=S.bufferFn}if(S.throttle){const P=Number(S.throttle);if(typeof P!="number"||isNaN(P))throw new Error(`Incorrect type for throttle, got "${P}" (expected a Number)`);S.throttledFn||(S.throttledFn=ee.createThrottled(x,P,L,S.args)),x=S.throttledFn}const O=x.call(L||c,...S.args||[],r);b!==!1&&(b=O),S.$internal&&O===!1&&(E=!0),F.isPromise(O)&&(O.$internal=S.$internal,(m||(m=[])).push(O))}}if(p.$firing=!1,E)return!1}return g==null||g.forEach(C=>{let E=i;if(C.transformCase&&(E=k.capitalize(E)),C.prefix&&(E=C.prefix+E),C.through.trigger(E,r)===!1)return!1}),r.bubbles&&c.owner&&!c.owner.isDestroyed?c.owner.trigger(i,r):(m=(o=m)===null||o===void 0?void 0:o.filter(C=>b!==!1||C.$internal),(a=m)!==null&&a!==void 0&&a.length?new Promise(C=>{Promise.all(m).then(E=>{const S=!E.some(x=>x===!1);C(S)})}):b!==!1)}suspendEvents(i=!1){const r=this.eventsSuspended||(this.eventsSuspended={shouldQueue:i,queue:[],count:0});r.count++}resumeEvents(){const i=this.eventsSuspended;if(i&&--i.count===0&&(this.eventsSuspended=null,i.shouldQueue))for(const r of i.queue)this.trigger(...r);return!this.eventsSuspended}};class gr{static animationFrame(){return new Promise(e=>{requestAnimationFrame(e)})}static sleep(e){return new Promise(t=>{setTimeout(()=>{t()},e)})}static yield(){return Promise.resolve()}}gr._$name="AsyncHelper";const Ao=/^(\w+)=(.*)$/,_o=function(u){const e={},t=u.split("&");for(const i of t){const[r,s,n]=Ao.exec(i),l=decodeURIComponent(s),o=decodeURIComponent(n);if(r){let a=e[l];a?(Array.isArray(a)||(a=e[l]=[a]),a.push(o)):e[l]=o}}return e},at=class{static get(e,t){return this.fetch(e,t)}static post(e,t,i={}){return!(t instanceof FormData)&&typeof t!="string"&&(t=JSON.stringify(t),i.headers=i.headers||{},i.headers["Content-Type"]=i.headers["Content-Type"]||"application/json"),this.fetch(e,Object.assign({method:"POST",body:t},i))}static fetch(e,t){let i;if(t=F.merge({},at.DEFAULT_FETCH_OPTIONS,t),typeof AbortController!="undefined"&&(i=t.abortController=new AbortController,t.signal=i.signal),"credentials"in t||(t.credentials="include"),t.queryParams){const s=Object.entries(t.queryParams);if(s.length){let n=!1;if(t.headers&&t.addQueryParamsToBody===!0){const l=new Headers(t.headers).get("Content-Type");let o;switch(l){case"application/x-www-form-urlencoded":o=URLSearchParams;break;case"multipart/form-data":o=FormData;break}if(o){const a=t.body||(t.body=new o);a instanceof o&&(s.forEach(([c,d])=>a.set(c,d)),n=!0)}}n||(e+=(e.includes("?")?"&":"?")+s.map(([l,o])=>`${l}=${encodeURIComponent(o)}`).join("&"))}}const r=new Promise((s,n)=>{fetch(e,t).then(l=>{t.parseJson?l.json().then(o=>{l.parsedJson=o,s(l)}).catch(o=>{l.parsedJson=null,l.error=o,n(l)}):s(l)}).catch(l=>{l.stack=r.stack,n(l)})});return r.stack=new Error().stack,r.abort=function(){var s;(s=i)===null||s===void 0||s.abort()},r}static mockUrl(e,t){const i=this;(i.mockAjaxMap||(i.mockAjaxMap={}))[e]=t,at.originalFetch||(at.originalFetch=at.fetch,at.fetch=i.mockAjaxFetch.bind(i))}static async mockAjaxFetch(e,t){const i=e.split("?");let r=this.mockAjaxMap[i[0]],s=null;if(r){typeof r=="function"&&(r=await r(i[0],i[1]&&_o(i[1]),t));try{s=(t==null?void 0:t.parseJson)&&JSON.parse(r.responseText)}catch(n){s=null,r.error=n}return r=Object.assign({status:200,ok:!0,headers:new Headers,statusText:"OK",url:e,parsedJson:s,text:()=>new Promise(n=>{n(r.responseText)}),json:()=>new Promise(n=>{n(s)})},r),new Promise(function(n,l){r.synchronous?n(r):setTimeout(function(){n(r)},"delay"in r?r.delay:100)})}else return at.originalFetch(e,t)}};let Pe=at;R(Pe,"DEFAULT_FETCH_OPTIONS",{}),Pe._$name="AjaxHelper";const _t=class{static mergeLocales(...e){const t={};return e.forEach(i=>{Object.keys(i).forEach(r=>{typeof i[r]=="object"?t[r]={...t[r],...i[r]}:t[r]=i[r]})}),t}static trimLocale(e,t){const i=(r,s)=>{e[r]&&(s?e[r][s]&&delete e[r][s]:delete e[r])};Object.keys(t).forEach(r=>{Object.keys(t[r]).length>0?Object.keys(t[r]).forEach(s=>i(r,s)):i(r)})}static normalizeLocale(e,t){if(!e)throw new Error('"nameOrConfig" parameter can not be empty');if(typeof e=="string"){if(!t)throw new Error('"config" parameter can not be empty');t.locale?t.name=e||t.name:t.localeName=e}else t=e;let i={};if(t.name||t.locale)i=Object.assign({localeName:t.name},t.locale),t.desc&&(i.localeDesc=t.desc),t.code&&(i.localeCode=t.code),t.path&&(i.localePath=t.path);else{if(!t.localeName)throw new Error(`"config" parameter doesn't have "localeName" property`);i=Object.assign({},t)}for(const r of["name","desc","code","path"])i[r]&&delete i[r];if(!i.localeName)throw new Error("Locale name can not be empty");return i}static get locales(){return globalThis.bryntum.locales||{}}static set locales(e){globalThis.bryntum.locales=e}static get localeName(){return globalThis.bryntum.locale||"En"}static set localeName(e){globalThis.bryntum.locale=e||_t.localeName}static get locale(){return _t.localeName&&this.locales[_t.localeName]||this.locales.En||Object.values(this.locales)[0]||{localeName:"",localeDesc:"",localeCoode:""}}static publishLocale(e,t){const{locales:i}=globalThis.bryntum,r=_t.normalizeLocale(e,t),{localeName:s}=r;return!i[s]||t===!0?i[s]=r:i[s]=this.mergeLocales(i[s]||{},r||{}),i[s]}};let we=_t;R(we,"skipLocaleIntegrityCheck",!1),globalThis.bryntum=globalThis.bryntum||{},globalThis.bryntum.locales=globalThis.bryntum.locales||{},we._$name="LocaleHelper";class No extends Oe($){static get defaultConfig(){return{throwOnMissingLocale:ne.isTestEnv}}construct(...e){const t=this;if(super.construct(...e),B.isBrowserEnv){var i;const r=document.querySelector("script[data-default-locale]");r?t.applyLocale(r.dataset.defaultLocale):(i=t.locale)!==null&&i!==void 0&&i.localeName&&t.applyLocale(t.locale.localeName)}}get locales(){return we.locales}set locales(e){we.locales=e}set locale(e){this.applyLocale(e)}get locale(){return we.locale}registerLocale(e,t){ne.deprecate("Core","6.0.0","LocaleManager.registerLocale deprecated, use LocaleHelper.publishLocale instead"),we.publishLocale(e,t)}extendLocale(e,t){ne.deprecate("Core","6.0.0","LocaleManager.extendLocale deprecated, use LocaleManager.applyLocale instead");const i=we.publishLocale(e,t);return this.applyLocale(i,!0)}applyLocale(e,t,i=!1){const r=this;let s;if(typeof e=="string")if(typeof t!="object"){if(s=r.locales[e],!s){if(i)return!0;throw new Error(`Locale "${e}" is not published. Publish with LocaleHelper.publishLocale() before applying.`)}}else s=we.publishLocale(e,t);else s=we.publishLocale(e);if(r.locale.localeName&&r.locale.localeName===s.localeName&&t!==!0)return r.locale;we.localeName=s.localeName;const n=()=>{r.trigger("locale",s)};return s.localePath?new Promise((l,o)=>{r.loadLocale(s.localePath).then(a=>{a.text().then(c=>{new Function(c)(),B.isBrowserEnv&&(s=r.locales[s.localeName],s&&delete s.localePath),n(),l(s)})}).catch(a=>o(a))}):(n(),s)}loadLocale(e){return Pe.get(e)}set throwOnMissingLocale(e){this._throwOnMissingLocale=e}get throwOnMissingLocale(){return this._throwOnMissingLocale}}const me=new No,Vo=Object.getPrototypeOf(Object),js=/L{.*?}/g,Hs=/L{(.*?)}/g,Ws=/((.*?)\.)?(.+)/g,zo=u=>u.replace(/{(\d+)}/gm,"[[$1]]"),Us=u=>u.replace(/\[\[(\d+)]]/gm,"{$1}"),Bo=Object.freeze(Object.create(null));var Bt=u=>class Ne extends(u||$){static get $name(){return"Localizable"}static get configurable(){return{localeClass:null,localizable:null,localizableProperties:{value:[],$config:{merge:"distinct"}}}}static clsName(t){var i,r;return typeof t=="string"?t:t===Vo?"Object":t.$$name||t.name||((i=t.prototype)===null||i===void 0?void 0:i.$$name)||((r=t.prototype)===null||r===void 0?void 0:r.name)}static parseLocaleString(t){var i;const r=[];let s;if((i=t)!==null&&i!==void 0&&i.includes("L{"))for(t=zo(t),Hs.lastIndex=0;(s=Hs.exec(t))!=null;){Ws.lastIndex=0;const n=Ws.exec(s[1]);r.push({match:Us(s[0]),localeKey:Us(n[3]),localeClass:n[2]})}return r.length>0?r:[{match:t,localeKey:t,localeClass:void 0}]}construct(t={},...i){super.construct(t,...i),me.ion({locale:"updateLocalization",thisObj:this}),this.updateLocalization()}get localeClass(){return this._localeClass||null}localizeProperty(t){var i,r,s;const n=this,l=F.getPath(n,t),o=((i=n.$meta.configs[t])===null||i===void 0?void 0:i.localeKey)||((r=n.fieldMap)===null||r===void 0||(s=r[t])===null||s===void 0?void 0:s.defaultValue);let a;return o?(a=Ne.localize(o,n,n.localeClass||n),a&&!(t in(n.initialConfig||Bo))&&F.setPath(n.isColumn?n.data:n,t,a)):typeof l=="string"&&(n.originalLocales=n.originalLocales||{},a=F.getPath(n.originalLocales,t),a===void 0&&(F.setPath(n.originalLocales,t,l),a=l),a&&F.setPath(n,t,a=n.optionalL(a,n))),a||l}updateLocalization(){if(this.localizable!==!1){var t,i;(t=this.localizableProperties)===null||t===void 0||t.forEach(this.localizeProperty,this),(i=this.trigger)===null||i===void 0||i.call(this,"localized")}}static getTranslation(t,i,r){const s=me.locale;let n=null,l,o;if(s)for(const{match:a,localeKey:c,localeClass:d}of this.parseLocaleString(t)){const f=h=>{var p;const m=(p=s[h])===null||p===void 0?void 0:p[c];return m&&(typeof m=="function"?n=i!=null?m(i):m:typeof m=="object"||t===a?n=m:n=(n||t).replace(a,m),typeof m=="string"&&m.includes("L{")&&(n=this.getTranslation(m,i,r))),m};let g=!1;for(o=r;o&&(l=Ne.clsName(o))&&!(g=f(l));o=Object.getPrototypeOf(o))if(typeof o=="string")break;!g&&d&&f(d)}return n}static localize(t,i=void 0,...r){var s;((s=r)===null||s===void 0?void 0:s.length)===0&&(r=[this]);let n=null;return r.some(l=>(n=Ne.getTranslation(t,i,l),n!=null)),n}static L(t,i=void 0,...r){var s;((s=r)===null||s===void 0?void 0:s.length)===0&&(r=[this]);const n=this.localize(t,i,...r);if(n==null&&me.throwOnMissingLocale&&t.includes("L{"))throw new Error(`Localization is not found for '${t}' in '${r.map(l=>Ne.clsName(l)).join(", ")}'. ${me.locale.localeName?`Locale : ${me.locale.localeName}`:""}`);return n!=null?n:t}L(t,i){const{localeClass:r,constructor:s}=this;return r&&Ne.clsName(r)!==Ne.clsName(s)?Ne.L(t,i,r,s):Ne.L(t,i,s)}static optionalL(t,i=void 0,...r){var s;const n=me.throwOnMissingLocale;me.throwOnMissingLocale=n&&js.test(t),((s=r)===null||s===void 0?void 0:s.length)===0&&(r=[this]);const l=Ne.L(t,i,...r);return me.throwOnMissingLocale=n,l}optionalL(t,i=this,r=!1){const s=me.throwOnMissingLocale;me.throwOnMissingLocale=s&&js.test(t)&&!r;const n=this.L(t,i);return me.throwOnMissingLocale=s,n}get localeManager(){return me}get localeHelper(){return we}};const jo={localeName:"En",localeDesc:"English (US)",localeCode:"en-US",Object:{Yes:"Yes",No:"No",Cancel:"Cancel",Ok:"OK",Week:"Week"},ColorPicker:{noColor:"No color"},Combo:{noResults:"No results",recordNotCommitted:"Record could not be added",addNewValue:u=>`Add ${u}`},FilePicker:{file:"File"},Field:{badInput:"Invalid field value",patternMismatch:"Value should match a specific pattern",rangeOverflow:u=>`Value must be less than or equal to ${u.max}`,rangeUnderflow:u=>`Value must be greater than or equal to ${u.min}`,stepMismatch:"Value should fit the step",tooLong:"Value should be shorter",tooShort:"Value should be longer",typeMismatch:"Value is required to be in a special format",valueMissing:"This field is required",invalidValue:"Invalid field value",minimumValueViolation:"Minimum value violation",maximumValueViolation:"Maximum value violation",fieldRequired:"This field is required",validateFilter:"Value must be selected from the list"},DateField:{invalidDate:"Invalid date input"},DatePicker:{gotoPrevYear:"Go to previous year",gotoPrevMonth:"Go to previous month",gotoNextMonth:"Go to next month",gotoNextYear:"Go to next year"},NumberFormat:{locale:"en-US",currency:"USD"},DurationField:{invalidUnit:"Invalid unit"},TimeField:{invalidTime:"Invalid time input"},TimePicker:{hour:"Hour",minute:"Minute",second:"Second"},List:{loading:"Loading...",selectAll:"Select All"},GridBase:{loadMask:"Loading...",syncMask:"Saving changes, please wait..."},PagingToolbar:{firstPage:"Go to first page",prevPage:"Go to previous page",page:"Page",nextPage:"Go to next page",lastPage:"Go to last page",reload:"Reload current page",noRecords:"No records to display",pageCountTemplate:u=>`of ${u.lastPage}`,summaryTemplate:u=>`Displaying records ${u.start} - ${u.end} of ${u.allCount}`},PanelCollapser:{Collapse:"Collapse",Expand:"Expand"},Popup:{close:"Close"},UndoRedo:{Undo:"Undo",Redo:"Redo",UndoLastAction:"Undo last action",RedoLastAction:"Redo last undone action",NoActions:"No items in the undo queue"},FieldFilterPicker:{equals:"equals",doesNotEqual:"does not equal",isEmpty:"empty",isNotEmpty:"not empty",contains:"contains",doesNotContain:"does not contain",startsWith:"starts with",endsWith:"ends with",isOneOf:"one of",isNotOneOf:"not one of",isGreaterThan:"greater than",isLessThan:"less than",isGreaterThanOrEqualTo:"greater than or equal to",isLessThanOrEqualTo:"less than or equal to",isBetween:"between",isNotBetween:"not between",isBefore:"before",isAfter:"after",isToday:"today",isTomorrow:"tomorrow",isYesterday:"yesterday",isThisWeek:"this week",isNextWeek:"next week",isLastWeek:"last week",isThisMonth:"this month",isNextMonth:"next month",isLastMonth:"last month",isThisYear:"this year",isNextYear:"next year",isLastYear:"last year",isYearToDate:"year to date",isTrue:"true",isFalse:"false",selectAProperty:"Select a property",selectAnOperator:"Select an operator",caseSensitive:"Case-sensitive",and:"and",dateFormat:"D/M/YY",selectOneOrMoreValues:"Select one or more values",enterAValue:"Enter a value",enterANumber:"Enter a number",selectADate:"Select a date"},FieldFilterPickerGroup:{addFilter:"Add filter"},DateHelper:{locale:"en-US",weekStartDay:0,nonWorkingDays:{0:!0,6:!0},weekends:{0:!0,6:!0},unitNames:[{single:"millisecond",plural:"ms",abbrev:"ms"},{single:"second",plural:"seconds",abbrev:"s"},{single:"minute",plural:"minutes",abbrev:"min"},{single:"hour",plural:"hours",abbrev:"h"},{single:"day",plural:"days",abbrev:"d"},{single:"week",plural:"weeks",abbrev:"w"},{single:"month",plural:"months",abbrev:"mon"},{single:"quarter",plural:"quarters",abbrev:"q"},{single:"year",plural:"years",abbrev:"yr"},{single:"decade",plural:"decades",abbrev:"dec"}],unitAbbreviations:[["mil"],["s","sec"],["m","min"],["h","hr"],["d"],["w","wk"],["mo","mon","mnt"],["q","quar","qrt"],["y","yr"],["dec"]],parsers:{L:"MM/DD/YYYY",LT:"HH:mm A",LTS:"HH:mm:ss A"},ordinalSuffix:u=>{const e=["11","12","13"].find(i=>u.endsWith(i));let t="th";if(!e){const i=u[u.length-1];t={1:"st",2:"nd",3:"rd"}[i]||"th"}return u+t}}};we.publishLocale(jo);const{toString:qs}=Object.prototype,Ho=qs.call(new Date),wi=new Date,mr=1e3*60*60,pr=(u,e)=>isNaN(u)||u==null?e:u,Wo=/([ES]){([^}]+)}/g,Ks=u=>{const e=["11","12","13"].find(i=>u.endsWith(i));let t="th";if(!e){const i=u[u.length-1];t={1:"st",2:"nd",3:"rd"}[i]||"th"}return u+t},ge=(u,e,t)=>(Qe[u]||(Qe[u]=new Intl.DateTimeFormat(Ze,e))).format(t),jt=(u,e,t,i=!1)=>{let r=ge(u,e,t);return/am|pm/i.test(r)&&(r=r.replace(/^0/,""),i&&(r=r.replace(/:00/,""))),r},Uo=(u,e)=>Math.floor((u.getTime()-e.getTime()-(u.getTimezoneOffset()-e.getTimezoneOffset())*Se.minute.millisecond)/Se.day.millisecond)+1,Ys=u=>u>=0?u:u+7,qo=/([^\w])(S+)/gm,Ko=(u,e)=>e+"SSS",Gs=/[:.\-/\s]/;let Ze="en-US",He=Ks,Si={},Ht={},Qe={},yr={};const Xs=u=>{const e=vr[u];if(!e)throw new Error("Only international formats should be used here");if(Ht[u]!==void 0)return Ht[u];const t=new Intl.DateTimeFormat(Ze,e),i=t.formatToParts(new Date(2001,1,2,3,4,5,6)).map(r=>{const s=r.type,n=e[s];if(s==="literal")return r.value.replace(/,/g,"");if(s==="day")return n==="numeric"?"D":"DD";if(s==="month")return n==="short"?"MMM":n==="long"?"MMMM":n==="numeric"?"M":"MM";if(s==="year")return n==="numeric"?"YYYY":"YY"}).join("");return Ht[u]=i},Js=2020,Zs=0,Qs=1,vr={l:{year:"numeric",month:"numeric",day:"numeric"},ll:{year:"numeric",month:"short",day:"numeric"}},ue={M:u=>u.getMonth()+1,Mo:u=>He(ue.M(u).toString()),MM:u=>(u.getMonth()+1).toString().padStart(2,"0"),MMM:u=>ge("MMM",{month:"short"},u),MMMM:u=>ge("MMMM",{month:"long"},u),Q:u=>Math.ceil((u.getMonth()+1)/3),Qo:u=>He(ue.Q(u).toString()),D:u=>u.getDate(),Do:u=>He(ue.D(u).toString()),DD:u=>u.getDate().toString().padStart(2,"0"),DDD:u=>Math.ceil((new Date(u.getFullYear(),u.getMonth(),u.getDate(),12,0,0)-new Date(u.getFullYear(),0,0,12,0,0))/Se.day.millisecond),DDDo:u=>He(ue.DDD(u).toString()),DDDD:u=>ue.DDD(u).toString().padStart(3,"0"),d:u=>u.getDay(),do:u=>He(u.getDay().toString()),d1:u=>ge("d1",{weekday:"narrow"},u).substr(0,1),dd:u=>ue.ddd(u).substring(0,2),ddd:u=>ge("ddd",{weekday:"short"},u),dddd:u=>ge("dddd",{weekday:"long"},u),u:u=>{const e=Qe.u||(Qe.u=new Intl.DateTimeFormat("en-GB",{timeZone:"UTC",year:"numeric",month:"2-digit",day:"2-digit"})),t=e.formatToParts(u);return`${t[4].value}${t[2].value}${t[0].value}Z`},uu:u=>{const e=Qe.uu||(Qe.uu=new Intl.DateTimeFormat("en-GB",{timeZone:"UTC",hour12:!1,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})),t=e.formatToParts(u);return`${t[4].value}${t[2].value}${t[0].value}T${t[6].value}${t[8].value}${t[10].value}Z`},e:u=>u.getDay(),E:u=>u.getDay()+1,W:u=>N.getWeekNumber(u)[1],Wo:u=>He(ue.W(u).toString()),WW:u=>ue.W(u).toString().padStart(2,"0"),Wp:u=>`${N.localize("L{Week}")} ${ue.W(u)}`,WWp:u=>`${N.localize("L{Week}")} ${ue.WW(u)}`,Wp0:u=>`${N.localize("L{Week}")[0]}${ue.W(u)}`,WWp0:u=>`${N.localize("L{Week}")[0]}${ue.WW(u)}`,Y:u=>u.getFullYear(),YY:u=>(u.getFullYear()%100).toString().padStart(2,"0"),YYYY:u=>u.getFullYear(),A:u=>u.getHours()<12?"AM":"PM",a:u=>u.getHours()<12?"am":"pm",H:u=>u.getHours(),HH:u=>u.getHours().toString().padStart(2,"0"),h:u=>u.getHours()%12||12,hh:u=>ue.h(u).toString().padStart(2,"0"),k:u=>u.getHours()||24,kk:u=>ue.k(u).toString().padStart(2,"0"),K:u=>jt("K",{hour:"numeric"},u),KK:u=>jt("KK",{hour:"2-digit"},u),m:u=>u.getMinutes(),mm:u=>ue.m(u).toString().padStart(2,"0"),s:u=>u.getSeconds(),ss:u=>ue.s(u).toString().padStart(2,"0"),S:u=>Math.floor(u.getMilliseconds()/100).toString(),SS:u=>Math.floor(u.getMilliseconds()/10).toString().padStart(2,"0"),SSS:u=>u.getMilliseconds().toString().padStart(3,"0"),z:u=>ge("z",{timeZoneName:"short"},u),zz:u=>ge("zz",{timeZoneName:"long"},u),Z:u=>T.getGMTOffset(u),LT:u=>jt("LT",{hour:"2-digit",minute:"2-digit"},u),LST:u=>jt("LST",{hour:"numeric",minute:"2-digit"},u,!0),LTS:u=>jt("LTS",{hour:"2-digit",minute:"2-digit",second:"2-digit"},u),L:u=>ge("L",{year:"numeric",month:"2-digit",day:"2-digit"},u),l:u=>ge("l",vr.l,u),LL:u=>ge("LL",{year:"numeric",month:"long",day:"numeric"},u),ll:u=>ge("ll",vr.ll,u),LLL:u=>ge("LLL",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit"},u),lll:u=>ge("lll",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit"},u),LLLL:u=>ge("LLLL",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit",weekday:"long"},u),llll:u=>ge("llll",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",weekday:"short"},u)},Yo=Object.keys(ue).sort((u,e)=>e.length-u.length),Go=`^(?:${Yo.join("|")})`,pe=()=>({}),Xo=u=>sa.test(u),br=u=>Xo(u)&&{milliseconds:parseInt(u.padEnd(3,"0").substring(0,3))},en={YYYY:u=>{const e=parseInt(u);return{year:e>=1e3&&e<=9999?e:NaN}},Y:u=>({year:parseInt(u)}),YY:u=>{const e=parseInt(u);return{year:e+(e>1968?1900:2e3)}},M:u=>({month:parseInt(u)-1}),MM:u=>({month:parseInt(u)-1}),Mo:u=>({month:parseInt(u)-1}),MMM:u=>{const e=(u||"").toLowerCase();for(const[t,i]of Object.entries(N._monthShortNamesIndex))if(e.startsWith(t))return{month:i.value}},MMMM:u=>{const e=(u||"").toLowerCase();for(const[t,i]of Object.entries(N._monthNamesIndex))if(e.startsWith(t))return{month:i.value}},DD:u=>({date:parseInt(u)}),D:u=>({date:parseInt(u)}),Do:u=>({date:parseInt(u)}),DDD:pe,DDDo:pe,DDDD:pe,d:pe,do:pe,d1:pe,dd:pe,ddd:pe,dddd:pe,Q:pe,Qo:pe,W:pe,Wo:pe,WW:pe,e:pe,E:pe,HH:u=>({hours:parseInt(u)}),hh:u=>({hours:parseInt(u)}),mm:u=>({minutes:parseInt(u)}),H:u=>({hours:parseInt(u)}),m:u=>({minutes:parseInt(u)}),ss:u=>({seconds:parseInt(u)}),s:u=>({seconds:parseInt(u)}),S:br,SS:br,SSS:br,A:u=>({amPm:u.toLowerCase()}),a:u=>({amPm:u.toLowerCase()}),L:"MM/DD/YYYY",LT:"HH:mm A",LTS:"HH:mm:ss A",l:{type:"dynamic",parser:()=>Xs("l")},ll:{type:"dynamic",parser:()=>Xs("ll")},Z:u=>{if(!u||!sn.test(u)&&u!=="Z")return null;let e=0;if(u!=="Z"){const t=sn.exec(u);if(t){const i=t[1]==="+"?1:-1,r=parseInt(t[2])||0,s=parseInt(t[3])||0;e=i*(r*60+s)}else e=-1*new Date().getTimezoneOffset()}return{timeZone:e}}},Jo=Object.keys(en).sort((u,e)=>e.length-u.length),tn=new RegExp(`(${Jo.join("|")})`),Zo=new RegExp("^(LL|LLL|lll|LLLL|llll)$"),Se={decade:{decade:1,year:10,quarter:40,month:120,week:520,day:3652,hour:24*3652,minute:1440*3652,second:86400*3652,millisecond:864e5*3652},year:{decade:.1,year:1,quarter:4,month:12,week:52,day:365,hour:24*365,minute:1440*365,second:86400*365,millisecond:864e5*365},quarter:{decade:1/40,year:1/4,quarter:1,month:3,week:4,day:91,hour:24*91,minute:1440*91,second:86400*91,millisecond:864e5*91},month:{decade:1/120,year:1/12,quarter:1/3,month:1,week:4,day:-30,hour:-24*30,minute:-1440*30,second:-86400*30,millisecond:-864e5*30},week:{decade:-1/520,year:-1/52,quarter:-1/13,month:-1/4,day:7,hour:168,minute:10080,second:604800,millisecond:6048e5},day:{decade:-1/3652,year:-1/365,quarter:-1/91,month:-1/30,week:1/7,hour:24,minute:1440,second:86400,millisecond:864e5},hour:{decade:-1/(3652*24),year:-1/(365*24),quarter:-1/(91*24),month:-1/(30*24),week:1/168,day:1/24,minute:60,second:3600,millisecond:36e5},minute:{decade:-1/(3652*1440),year:-1/(365*1440),quarter:-1/(91*1440),month:-1/(30*1440),week:1/10080,day:1/1440,hour:1/60,second:60,millisecond:6e4},second:{decade:-1/(3652*86400),year:-1/(365*86400),quarter:-1/(91*86400),month:-1/(30*86400),week:1/604800,day:1/86400,hour:1/3600,minute:1/60,millisecond:1e3},millisecond:{decade:-1/(3652*864e5),year:-1/(365*864e5),quarter:-1/(91*864e5),month:-1/(30*864e5),week:1/6048e5,day:1/864e5,hour:1/36e5,minute:1/6e4,second:1/1e3}},rn={ms:"millisecond",milliseconds:"millisecond",s:"second",seconds:"second",m:"minute",mi:"minute",min:"minute",minutes:"minute",h:"hour",hours:"hour",d:"day",days:"day",w:"week",weeks:"week",M:"month",mo:"month",mon:"month",months:"month",q:"quarter",quarters:"quarter",y:"year",years:"year",dec:"decade",decades:"decade"},Qo=/^\s*([-+]?\d+(?:[.,]\d*)?|[-+]?(?:[.,]\d+))\s*([^\s]+)?/i,ea=/^\s*([-+]?\d+)(?![.,])\s*([^\s]+)?/i,Et=["millisecond","second","minute","hour","day","week","month","quarter","year","decade"],ta=[["mil"],["s","sec"],["m","min"],["h","hr"],["d"],["w","wk"],["mo","mon","mnt"],["q","quar","qrt"],["y","yr"],["dec"]],Cr=["decade","year","month","week","day","hour","minute","second","millisecond"],ia=["milliseconds","seconds","minutes","hours","date","month","year"],ra=u=>{const e=parseFloat(u);return isNaN(e)?null:e},sa=/^[0-9]+$/,sn=/([+-])(\d\d):*(\d\d)*$/,We={millisecond:0,second:1,minute:2,hour:3,day:4,week:5,month:6,quarter:7,year:8,decade:9},na={round(u,e=1){return Math.round(u/e)*e},floor(u,e=1){return Math.floor(u/e)*e},ceil(u,e=1){return Math.ceil(u/e)*e}},nn={},ze=class extends Bt(){static get $name(){return"DateHelper"}static set defaultFormat(e){T._defaultFormat=e}static get defaultFormat(){return T._defaultFormat||"YYYY-MM-DDTHH:mm:ssZ"}static set defaultParseFormat(e){this._defaultParseFormat=e}static get defaultParseFormat(){return this._defaultParseFormat||this._defaultFormat||"YYYY-MM-DDTHH:mm:ss.SSSZ"}static buildParser(e){const t=e.split(tn),i=[];return t.length===1||Zo.test(e)?[]:(t.reduce((r,s,n,l)=>{if(n!==0||s!=="")if(tn.test(s)){const o=this.localize("L{parsers}")||{},a=o[s]||en[s];if(s==="Z"&&n<l.length-2)throw new Error(`Invalid format ${e} TimeZone (Z) must be last token`);const c=typeof a=="function"||typeof a=="string"?a:a.parser();if(typeof c=="string"){const d=T.buildParser(c),f=d.pop();delete f.last,i.push(...d),r=f}else r.pattern=s,r.fn=c}else r.splitter=s,i.push(r),r={};else Object.prototype.hasOwnProperty.call(r,"pattern")&&i.push(r);return r},{}),i[i.length-1].last=!0,i)}static makeKey(e){if(e.length===10)return e;e.getTime&&(e=e.getTime());const t=nn[Math.trunc(e/mr)];if(t)return t;wi.setTime(e);const i=wi.getMonth()+1,r=wi.getDate();return nn[Math.trunc(e/mr)]=`${wi.getFullYear()}-${i<10?"0"+i:i}-${r<10?"0"+r:r}`}static parseKey(e){return T.parse(e,"YYYY-MM-DD")}static parse(e,t=T.defaultParseFormat,i=!1){if(e instanceof Date)return e;if(typeof e!="string"||!e)return null;const r={year:null,month:null,date:null,hours:null,minutes:null,seconds:null,milliseconds:null};t=t.replace(qo,Ko);let s=yr[t],n;if(s||(s=yr[t]=T.buildParser(t)),e.includes("\u202F")&&(e=e.replace(/\s/g," ")),s.reduce((o,a)=>{if(a.last)Object.assign(r,a.fn(o));else{let d;if(a.splitter==="T"&&o.indexOf("T")===-1)d=o.indexOf(" ");else{var c;const h=o.indexOf("+");let{splitter:p}=a;!i&&Gs.test(p)&&(p=Gs),d=a.splitter!==""?o.search(typeof p=="string"?k.escapeRegExp(p):p):((c=a.pattern)===null||c===void 0?void 0:c.length)||-1,h>-1&&d>h&&(d=-1)}let f,g;if(d===-1||a.pattern==="SSS"&&o.match(/^\d+Z$/)){const h=o.split(/([Z\-+])/);h.length===1?(f=o,g=""):(f=h[0],g=`${h[1]}${h[2]}`)}else f=o.substring(0,d)||o,g=o.substring(d+a.splitter.length);if(a.fn){const h=a.fn(f);h?Object.assign(r,h):g=f+g}return g}},e),r.year&&!r.date&&(r.date=1),r.date>31||r.month>12)return null;const l=T.create(r,i);return l?n=l:i||(n=new Date(e)),n}static create(e,t=!1){const i={...e};let r=isNaN(i.year)||t&&(isNaN(i.month)||isNaN(i.date)),s=!1;if(!r){let l=!0;ia.forEach(o=>{(!(o in i)||isNaN(i[o]))&&(i[o]=0),l=l&&i[o]===null}),r=l}if(r||(i.amPm==="am"?i.hours=i.hours%12:i.amPm==="pm"&&(i.hours=i.hours%12+12),"timeZone"in i&&(s=!0,i.minutes-=i.timeZone),t&&(i.year==null||i.month==null||i.date==null)))return null;const n=[pr(i.year,Js),pr(i.month,Zs),pr(i.date,Qs),i.hours,i.minutes,i.seconds,i.milliseconds];return s?new Date(Date.UTC(...n)):new Date(...n)}static toUTC(e){return new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()))}static format(e,t=T.defaultFormat){if(!e||isNaN(e))return null;let i=Si[t],r="";if(!i){i=Si[t]=[];for(let s=0;s<t.length;s++){const n=t.slice(s).match(Go),l=n==null?void 0:n[0];if(l){const o=this.localize("L{formats}")||{},a=o[l]||ue[l];i.push(a),s+=l.length-1}else if(t[s]==="{"){const o=t.indexOf("}",s+1);o===-1?(i.push(t.substr(s+1)),s=t.length):(i.push(t.substring(s+1,o)),s=o)}else i.push(t[s])}}return i.forEach(s=>{typeof s=="string"?r+=s:r+=s(e)}),r}static formatRange(e,t){return t.replace(Wo,(i,r,s)=>ze.format(e[r==="S"?0:1],s))}static asMilliseconds(e,t=null){return typeof e=="string"&&(t=e,e=1),T.as("millisecond",e,t)}static asMonths(e){const t=T.as("ms",T.daysInMonth(e),"day"),i=(e.valueOf()-T.startOf(e,"month").valueOf())/t;return e.getYear()*12+e.getMonth()+i}static monthsToDate(e){const t=Math.floor(e),i=e-t,r=new Date(0,t),s=T.as("ms",T.daysInMonth(r),"days");return r.setTime(r.getTime()+i*s),r}static formatDelta(e,t){let i,r;typeof t=="boolean"?i=t:t&&(i=t.abbrev);const s=this.getDelta(e,t),n=[],l=(t==null?void 0:t.separator)||(i?"":" ");for(r in s)n.push(`${s[r]}${l}${r}`);return(t==null?void 0:t.asString)===!1?n:n.join(", ")}static getDelta(e,t){let i,r,s,n,l,o,a;typeof t=="boolean"?i=t:t&&(i=t.abbrev,n=T.normalizeUnit(t.precision),o=t.maxUnit,a=!i&&t.ignoreLocale);const c={},d=i?T.getShortNameOfUnit:T.getLocalizedNameOfUnit,f=o?Cr.slice(Cr.indexOf(o)):Cr;for(l of f)if(r=T.as(l,e),s=n===l,r=Math[s?"round":"floor"](r),(r||s&&!c.length)&&(c[a?l:d.call(T,l,r!==1)]=r,e-=T.as("ms",r,l)),s||!e)break;return c}static as(e,t,i="ms"){return typeof t=="string"&&(t=T.parseDuration(t)),typeof t=="object"&&(i=t.unit,t=t.magnitude),e===i||(e=T.normalizeUnit(e),i=T.normalizeUnit(i),e===i)?t:We[i]>We[e]?t*Math.abs(Se[i][e]):t/Math.abs(Se[e][i])}static formatContainsHourInfo(e){const t=/(\\.)/g;return/([HhKkmSsAa]|LT|L{3,}|l{3,})/.test(e.replace(t,""))}static is24HourFormat(e){return T.format(T.getTime(13,0,0),e).includes("13")}static add(e,t,i="ms",r=!0){let s;if(typeof e=="string"?s=T.parse(e):r?s=new Date(e.getTime()):s=e,typeof t=="string"){const n=ze.parseDuration(t);t=n.magnitude,i=n.unit}else t&&typeof t=="object"&&(i=t.unit,t=t.magnitude);if(!i||t===0)return s;switch(i=T.normalizeUnit(i),i){case"millisecond":s.setTime(s.getTime()+t);break;case"second":s.setTime(s.getTime()+t*1e3);break;case"minute":s.setTime(s.getTime()+t*6e4);break;case"hour":s.setTime(s.getTime()+t*36e5);break;case"day":t%1===0?(s.setDate(s.getDate()+t),s.getHours()===23&&e.getHours()===0&&s.setHours(s.getHours()+1)):s.setTime(s.getTime()+t*864e5);break;case"week":s.setDate(s.getDate()+t*7);break;case"month":{let n=s.getDate();n>28&&(n=Math.min(n,T.getLastDateOfMonth(T.add(T.getFirstDateOfMonth(s),t,"month")).getDate())),s.setDate(n),s.setMonth(s.getMonth()+t);break}case"quarter":T.add(s,t*3,"month",!1);break;case"year":s.setFullYear(s.getFullYear()+t);break;case"decade":s.setFullYear(s.getFullYear()+t*10);break}return s}static diff(e,t,i="ms",r=!0){if(i=T.normalizeUnit(i),!e||!t)return 0;let s;switch(i){case"year":s=T.diff(e,t,"month")/12;break;case"quarter":s=T.diff(e,t,"month")/3;break;case"month":s=(t.getFullYear()-e.getFullYear())*12+(t.getMonth()-e.getMonth()),s===0&&r&&(s=T.diff(e,t,"day",r)/T.daysInMonth(e));break;case"week":s=T.diff(e,t,"day")/7;break;case"day":{const n=e.getTimezoneOffset()-t.getTimezoneOffset();s=(t-e+n*60*1e3)/864e5;break}case"hour":s=(t-e)/36e5;break;case"minute":s=(t-e)/6e4;break;case"second":s=(t-e)/1e3;break;case"millisecond":s=t-e;break}return r?s:Math.round(s)}static startOf(e,t="day",i=!0,r=T.weekStartDay){if(!e)return null;switch(t=T.normalizeUnit(t),i&&(e=T.clone(e)),t){case"year":return e.setMonth(0,1),e.setHours(0,0,0,0),e;case"quarter":return e.setMonth((T.get(e,"quarter")-1)*3,1),e.setHours(0,0,0,0),e;case"month":return e.setDate(1),e.setHours(0,0,0,0),e;case"week":{const s=e.getDay()-r;return e.setDate(e.getDate()-s),e.setHours(0,0,0,0),e}case"day":return e.setHours(0,0,0,0),e;case"hour":e.getMinutes()>0&&e.setMinutes(0);case"minute":e.getSeconds()>0&&e.setSeconds(0);case"second":e.getMilliseconds()>0&&e.setMilliseconds(0);case"millisecond":return e}}static endOf(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+1)}static clone(e){return new Date(e.getTime())}static clearTime(e,t=!0){return e?(t&&(e=new Date(e.getTime())),e.setHours(0,0,0,0),e):null}static midnight(e,t){let i=T.clearTime(e);return t&&i<e&&(i=T.add(i,1,"d")),i}static getTimeOfDay(e,t="ms"){const i=e.getHours()*Se.hour.millisecond+e.getMinutes()*Se.minute.millisecond+e.getSeconds()*Se.second.millisecond+e.getMilliseconds();return t==="ms"?i:T.as(t,i,"ms")}static set(e,t,i){if(!t)return e;if(typeof t=="string")switch(T.normalizeUnit(t)){case"millisecond":(i!==0||e.getMilliseconds()>0)&&e.setMilliseconds(i);break;case"second":(i!==0||e.getSeconds()>0)&&e.setSeconds(i);break;case"minute":(i!==0||e.getMinutes()>0)&&e.setMinutes(i);break;case"hour":e.setHours(i);break;case"day":case"date":e.setDate(i);break;case"week":throw new Error("week not implemented");case"month":e.setMonth(i);break;case"quarter":e.setDate(1),e.setMonth((i-1)*3);break;case"year":e.setFullYear(i);break}else Object.entries(t).sort((r,s)=>We[r[0]]-We[s[0]]).forEach(([r,s])=>{T.set(e,r,s)});return e}static setDateToMidday(e,t=!0){return T.set(T.clearTime(e,t),"hour",12)}static constrain(e,t,i){return t!=null&&(e=T.max(e,t)),i==null?e:T.min(e,i)}static getTime(e,t=0,i=0,r=0){return e instanceof Date&&(r=e.getMilliseconds(),i=e.getSeconds(),t=e.getMinutes(),e=e.getHours()),new Date(Js,Zs,Qs,e,t,i,r)}static copyTimeValues(e,t){return e.setHours(t.getHours()),e.setMinutes(t.getMinutes()),e.setSeconds(t.getSeconds()),e.setMilliseconds(t.getMilliseconds()),e}static get isDSTEnabled(){const e=new Date().getFullYear(),t=new Date(e,0,1),i=new Date(e,6,1);return t.getTimezoneOffset()!==i.getTimezoneOffset()}static isDST(e){const t=e.getFullYear(),i=new Date(t,0,1),r=new Date(t,6,1);return e.getTimezoneOffset()<Math.max(i.getTimezoneOffset(),r.getTimezoneOffset())}static isBefore(e,t){return e<t}static isAfter(e,t){return e>t}static isEqual(e,t,i=null){return i===null?e&&t&&e.getTime()===t.getTime():T.startOf(e,i)-T.startOf(t,i)===0}static compare(e,t,i=null){return i&&(e=T.startOf(e,i),t=T.startOf(t,i)),e<t?-1:e>t?1:0}static clamp(e,t,i){if(!isNaN(e))return t!=null&&(e=Math.max(e,t)),i!=null&&(e=Math.min(e,i)),new Date(e)}static isSameDate(e,t){return T.compare(e,t,"d")===0}static isSameTime(e,t){return e.getHours()===t.getHours()&&e.getMinutes()===t.getMinutes()&&e.getSeconds()===t.getSeconds()&&e.getMilliseconds()===t.getMilliseconds()}static isStartOf(e,t){return T.isEqual(e,T.startOf(e,t))}static betweenLesser(e,t,i){return t.getTime()<=e.getTime()&&e.getTime()<i.getTime()}static betweenLesserEqual(e,t,i){return t.getTime()<=e.getTime()&&e.getTime()<=i.getTime()}static intersectSpans(e,t,i,r){return T.betweenLesser(e,i,r)||T.betweenLesser(i,e,t)}static compareUnits(e,t){return Math.sign(We[T.normalizeUnit(e)]-We[T.normalizeUnit(t)])}static timeSpanContains(e,t,i,r){return i-e>=0&&t-r>=0}static get weekStartDay(){return T._weekStartDay==null&&(T._weekStartDay=this.localize("L{weekStartDay}")||0),T._weekStartDay}static get nonWorkingDays(){return{...this.localize("L{nonWorkingDays}")}}static get nonWorkingDaysAsArray(){return Object.keys(this.nonWorkingDays).map(Number)}static get weekends(){return{...this.localize("L{weekends}")}}static get(e,t){switch(T.normalizeUnit(t)){case"millisecond":return e.getMilliseconds();case"second":return e.getSeconds();case"minute":return e.getMinutes();case"hour":return e.getHours();case"date":case"day":return e.getDate();case"week":return ue.W(e);case"month":return e.getMonth();case"quarter":return Math.floor(e.getMonth()/3)+1;case"year":return e.getFullYear()}return null}static daysInYear(e){const t=e.getFullYear(),i=new Date(t+1,0,1)-new Date(t,0,1);return this.as("day",i)}static daysInMonth(e){return 32-new Date(e.getFullYear(),e.getMonth(),32).getDate()}static hoursInDay(e){const t=e.getFullYear(),i=e.getMonth(),r=e.getDate(),s=new Date(t,i,r+1)-new Date(t,i,r);return this.as("hour",s)}static getNormalizedUnitDuration(e,t){let i;switch(t){case"month":i=T.asMilliseconds(T.daysInMonth(e),"day");break;case"year":i=T.asMilliseconds(T.daysInYear(e),"day");break;case"day":i=T.asMilliseconds(T.hoursInDay(e),"hour");break;default:i=T.asMilliseconds(t)}return i}static getFirstDateOfMonth(e){return new Date(e.getFullYear(),e.getMonth(),1)}static getLastDateOfMonth(e){return new Date(e.getFullYear(),e.getMonth()+1,0)}static min(e,t){return e.getTime()<t.getTime()?e:t}static max(e,t){return e.getTime()>t.getTime()?e:t}static getNext(e,t,i=1,r=T.weekStartDay){if(t==="week"){const s=T.clone(e),n=s.getDay();return T.startOf(s,"day",!1),T.add(s,r-n+7*(i-(r<=n?0:1)),"day",!1),s.getDay()!==r&&T.add(s,1,"hour"),s}return T.startOf(T.add(e,i,t),t,!1)}static isValidDate(e){return T.isDate(e)&&!isNaN(e)}static isDate(e){return e&&qs.call(e)===Ho}static getStartOfNextDay(e,t=!1,i=!1){let r=T.add(i?e:T.clearTime(e,t),1,"day");if(r.getDate()===e.getDate()){const s=T.add(T.clearTime(e,t),2,"day").getTimezoneOffset(),n=e.getTimezoneOffset();r=T.add(r,n-s,"minute")}return r}static getEndOfPreviousDay(e,t=!1){const i=t?e:T.clearTime(e,!0);return i-e?i:T.add(i,-1,"day")}static getWeekDescription(e,t=e){const i=e.getMonth()===t.getMonth()?ze.format(e,"MMMM"):`${ze.format(e,"MMM")} - ${ze.format(t,"MMM")}`,r=ze.getWeekNumber(e);return`${r[1]}, ${i} ${r[0]}`}static getWeekNumber(e,t=ze.weekStartDay){const i=new Date(e.getFullYear(),0,1),r=new Date(e.getFullYear(),11,31),s=Ys(i.getDay()-t),n=Ys(r.getDay()-t),l=Uo(e,i);let o;if(s<4?o=Math.floor((l+s-1)/7)+1:o=Math.floor((l+s-1)/7),o){let c=e.getFullYear();return o===53&&n<3&&(c++,o=1),[c,o]}const a=ze.getWeekNumber(new Date(e.getFullYear()-1,11,31))[1];return[e.getFullYear()-1,a]}static formatCount(e,t){return t=T.normalizeUnit(t),e!==1&&(t+="s"),e+" "+t}static getUnitToBaseUnitRatio(e,t,i=!1){return e=T.normalizeUnit(e),t=T.normalizeUnit(t),e===t?1:Se[e]&&Se[e][t]&&(i||Se[e][t]>0)?1/T.as(t,1,e):Se[t]&&Se[t][e]&&(i||Se[t][e]>0)?T.as(e,1,t):-1}static getShortNameOfUnit(e){return e=T.parseTimeUnit(e),T.unitLookup[e].abbrev}static getLocalizedNameOfUnit(e,t=!1){const i=e.charAt(0)===e.charAt(0).toUpperCase();return e=T.normalizeUnit(e),e=T.parseTimeUnit(e),e=T.unitLookup[e][t?"plural":"single"],i&&(e=k.capitalize(e)),e}static normalizeUnit(e){if(!e)return null;const t=e.toLowerCase();return t==="date"||Et.includes(t)?t:rn[e]||rn[t]}static getUnitByName(e){return T.normalizeUnit(e)||T.normalizeUnit(T.parseTimeUnit(e))}static getDurationInUnit(e,t,i,r){return T.diff(e,t,i,r)}static doesUnitsAlign(e,t){return!(e!==t&&t==="week")}static getSmallerUnit(e){return Et[We[T.normalizeUnit(e)]-1]||null}static getLargerUnit(e){return Et[We[T.normalizeUnit(e)]+1]||null}static round(e,t,i,r){return T.snap("round",e,t,i,r)}static floor(e,t,i,r){return T.snap("floor",e,t,i,r)}static ceil(e,t,i,r){return T.snap("ceil",e,t,i,r)}static snap(e,t,i,r,s=T.weekStartDay){const n=na[e];if(typeof i=="string"&&(i=T.parseDuration(i)),F.isObject(i)){const l=i.magnitude||i.increment;switch(i.unit){case"week":{const o=t.getDay();return r=T.add(T.clearTime(t),o>=s?s-o:-(o-s+7),"day"),T[e](t,`${l*7} days`,r)}case"month":{t=T.asMonths(t);let o;return r?(r=T.asMonths(r),o=t+n(t-r,l)):o=n(t,l),T.monthsToDate(o)}case"quarter":return T[e](t,`${l*3} months`,r);case"year":return T[e](t,`${l*12} months`,r);case"decade":return T[e](t,`${l*10} years`,r)}i=T.as("ms",l,i.unit)}if(r){const l=T.as("ms",r.getTimezoneOffset()-t.getTimezoneOffset(),"ms");return new Date(r.valueOf()+n(T.diff(r,t,"ms")+l,i))}else{const l=t.getTimezoneOffset()*60*1e3;return new Date(n(t.valueOf()-l,i)+l)}}static parseDuration(e,t=!0,i){var r;const s=t?Qo:ea,n=s.exec(e);if(e==null||!n)return null;const l=ra((r=n[1])===null||r===void 0?void 0:r.replace(",",".")),o=T.parseTimeUnit(n[2])||i;return o?{magnitude:l,unit:o}:null}static parseTimeUnit(e){const t=e==null?null:T.durationRegEx.exec(e.toLowerCase());if(!t)return null;for(let i=0;i<Et.length;i++)if(t[i+1])return Et[i]}static getGMTOffset(e=new Date){if(!e)return;const t=e.getTimezoneOffset();return t?(t>0?"-":"+")+Math.abs(Math.trunc(t/60)).toString().padStart(2,"0")+":"+Math.abs(t%60).toString().padStart(2,"0"):"Z"}static fillDayNames(){const e=new Date("2000-01-01T12:00:00"),t=T._dayNames||[],i=T._dayShortNames||[];t.length=0,i.length=0;for(let r=2;r<9;r++)e.setDate(r),t.push(T.format(e,"dddd")),i.push(T.format(e,"ddd"));T._dayNames=t,T._dayShortNames=i}static getDayNames(){return T._dayNames}static getDayName(e){return T._dayNames[e]}static getDayShortNames(){return T._dayShortNames}static getDayShortName(e){return T._dayShortNames[e]}static fillMonthNames(){const e=new Date("2000-01-15T12:00:00"),t=T._monthNames||[],i=T._monthShortNames||[],r={},s={};t.length=0,i.length=0;for(let n=0;n<12;n++){e.setMonth(n);const l=T.format(e,"MMMM");t.push(l);const o=T.format(e,"MMM");i.push(o),r[l.toLowerCase()]={name:l,value:n},s[o.toLowerCase()]={name:o,value:n}}T._monthNames=t,T._monthShortNames=i,T._monthNamesIndex=r,T._monthShortNamesIndex=s}static getMonthShortNames(){return T._monthShortNames}static getMonthShortName(e){return T._monthShortNames[e]}static getMonthNames(){return T._monthNames}static getMonthName(e){return T._monthNames[e]}static set locale(e){Ze=e,Qe={},Si={},Ht={}}static get locale(){return Ze}static setupDurationRegEx(e=[],t=[]){const i=this,r={};let s="";for(let n=0;n<t.length;n++){const l=t[n],o=e[n];o.canonicalUnitName=Et[n],r[o.single]=r[o.single.toUpperCase()]=r[o.canonicalUnitName]=r[o.canonicalUnitName.toUpperCase()]=o,s+=`${n?"|":""}(`;for(let a=0;a<l.length;a++)s+=`${l[a]}|`;if(Ze=i.localize("L{locale}")||"en-US",Ze!=="en-US"){const a=ta[n];for(let c=0;c<a.length;c++)s+=`${a[c]}|`}s+=`${o.single}|${o.plural}|${o.canonicalUnitName}|${o.canonicalUnitName}s)`}i.unitLookup=r,i.durationRegEx=new RegExp(`^(?:${s})$`)}static applyLocale(){const e=this,t=e.localize("L{unitAbbreviations}")||[],i=e.unitNames=e.localize("L{unitNames}");i!=="unitNames"&&(Ze=e.localize("L{locale}")||"en-US",Ze==="en-US"?He=Ks:He=e.localize("L{ordinalSuffix}")||He,Si={},Ht={},yr={},Qe={},T._weekStartDay=null,T.setupDurationRegEx(i,t),T.fillDayNames(),T.fillMonthNames())}};let N=ze;R(N,"MS_PER_DAY",mr*24);const T=N;T.useIntlFormat=ge,me.ion({locale:"applyLocale",prio:1e3,thisObj:T}),me.locale&&T.applyLocale(),N._$name="DateHelper";const{hasOwn:wr}=F,ln=1.005.toFixed(2)==="1.01"?null:function(u,e){const t=u.toString().split("."),i=+(t[1]?t.join(".")+"1":t[0]);return u.toFixed.call(i,e)};class w extends F{static transformArrayToNamedObject(e,t="ref"){const i={};return e.forEach((r,s)=>{const n=r[t]!=null&&r[t].toString().length?r[t]:s;i[n]=r}),i}static transformNamedObjectToArray(e,t="ref"){return Object.keys(e).filter(i=>e[i]).map(i=>{const r=e[i];return r[t]=i,r})}static isEqual(e,t,i=!1){if(e===null&&t!==null||e===void 0&&t!==void 0||t===null&&e!==null||t===void 0&&e!==void 0)return!1;if(e==null&&t==null||e===t)return!0;const r=typeof e;if(r===typeof t){switch(r){case"number":case"string":case"boolean":return e===t}switch(!0){case(e instanceof Date&&t instanceof Date):return e.getTime()===t.getTime();case(Array.isArray(e)&&Array.isArray(t)):return e.length===t.length?e.every((n,l)=>Te.isEqual(n,t[l],i)):!1;case(r==="object"&&e.constructor.prototype===t.constructor.prototype):return i?Te.isDeeplyEqual(e,t,i):k.safeJsonStringify(e)===k.safeJsonStringify(t)}}return String(e)===String(t)}static isDeeplyEqual(e,t,i={}){if(e===t)return!0;if(!e||!t)return!1;const r=Te.keys(e,i.ignore),s=Te.keys(t,i.ignore);if(r.length!==s.length)return!1;for(let n=0;n<r.length;n++){const l=r[n],o=s[n];if(l!==o)return!1;const a=e[l],c=t[o];if(!(i.shouldEvaluate&&i.shouldEvaluate(l,{value:a,object:e},{value:c,object:t})===!1)){if(i.evaluate){const d=i.evaluate(l,{value:a,object:e},{value:c,object:t});if(d===!1)return!1;if(d===!0)continue}if(!Te.isEqual(a,c,i))return!1}}return!0}static isPartial(e,t){return e=String(e).toLowerCase(),t=String(t).toLowerCase(),e.indexOf(t)!==-1}static isLessThan(e,t){return e instanceof Date&&t instanceof Date?N.isBefore(e,t):e<t}static isMoreThan(e,t){return e instanceof Date&&t instanceof Date?N.isAfter(e,t):e>t}static fork(e){let t,i,r;if(e&&e.constructor===Object){t=Object.setPrototypeOf({},e);for(i in e)r=e[i],r&&(r.constructor===Object?t[i]=Te.fork(r):r instanceof Array&&(t[i]=r.slice()))}else t=e;return t}static copyProperties(e,t,i){let r,s;for(s=0;s<i.length;s++)r=i[s],r in t&&(e[r]=t[r]);return e}static copyPropertiesIf(e,t,i){if(t)for(const r of i)!(r in e)&&r in t&&(e[r]=t[r]);return e}static entries(e,t){const i=[],r=typeof t=="function";if(e)for(const s in e)(r?!t(s,e[s]):!(t!=null&&t[s]))&&i.push([s,e[s]]);return i}static fromEntries(e,t){if(t=t||{},e)for(let i=0;i<e.length;++i)t[e[i][0]]=e[i][1];return t}static keys(e,t,i){const r=[],s=typeof t=="function";if(e){let n=0;for(const l in e)(s?!t(l,e[l]):!(t!=null&&t[l]))&&(r.push(i?i(l,n):l),++n)}return r}static values(e,t,i){const r=[],s=typeof t=="function";if(e){let n=0;for(const l in e)(s?!t(l,e[l]):!(t!=null&&t[l]))&&(r.push(i?i(e[l],n):e[l]),++n)}return r}static pathExists(e,t){return t.split(".").every(r=>!e||!(r in e)?!1:(e=e[r],!0))}static pathifyKeys(e,t){const i={};for(const r in e)if(wr(e,r)){const s=t==null?void 0:t[r],n=(s==null?void 0:s.type)==="object"||(s==null?void 0:s.complexMapping)||!t;if(n&&Array.isArray(e[r]))i[r]=e[r].slice();else if(n&&e[r]instanceof Object){const l=this.pathifyKeys(e[r]);for(const o in l)i[`${r}.${o}`]=l[o]}else i[r]=e[r]}return i}static deletePath(e,t){t.split(".").reduce((i,r,s,n)=>{if(i==null)return null;if(wr(i,r))if(s===n.length-1)delete i[r];else return i[r]},e)}static coerce(e,t){const i=F.typeOf(e),r=F.typeOf(t),s=typeof e=="string";if(i!==r)switch(r){case"string":return String(e);case"number":return Number(e);case"boolean":return s&&(!e||e==="false"||e==="0")?!1:!!e;case"null":return s&&(!e||e==="null")?null:!1;case"undefined":return s&&(!e||e==="undefined")?void 0:!1;case"date":return s&&isNaN(e)?N.parse(e):Date(Number(e))}return e}static wrapProperty(e,t,i,r,s=!0){const n={};let l=Object.getPrototypeOf(e),o=Object.getOwnPropertyDescriptor(l,t);for(;!o&&l&&s;)l=Object.getPrototypeOf(l),l&&(o=Object.getOwnPropertyDescriptor(l,t));o?(o.set?n.set=a=>{o.set.call(e,a),r&&r.call(e,o.get.call(e))}:n.set=r,o.get?n.get=()=>{let a=o.get.call(e);return i&&(a=i.call(e,a)),a}:n.get=i):(n.set=a=>{e[`_${t}`]=a,r&&r.call(e,a)},n.get=()=>{let a=e[`_${t}`];return i&&(a=i.call(e,a)),a}),Object.defineProperty(e,t,n)}static hookProperty(e,t,i){const r=w.getPropertyDescriptor(i.prototype,"value"),s=w.getPropertyDescriptor(e,t),n=`_${t}`,l=class{get value(){return s?s.get.call(this):this[n]}set value(a){s?s.set.call(this,a):this[n]=a}},o=w.getPropertyDescriptor(l.prototype,"value");return Object.setPrototypeOf(i.prototype,l.prototype),Object.defineProperty(e,t,{configurable:!0,get:r.get||o.get,set:r.set||o.set}),()=>delete e[t]}static getPropertyDescriptor(e,t){let i=null;for(let r=e;r&&!i&&!wr(r,"isBase");r=Object.getPrototypeOf(r))i=Object.getOwnPropertyDescriptor(r,t);return i}static cleanupProperties(e,t=!1){return Object.entries(e).forEach(([i,r])=>{t?r===void 0&&delete e[i]:r==null&&delete e[i]}),e}static removeAllProperties(e){return Object.keys(e).forEach(t=>delete e[t]),e}static assertType(e,t,i){const r=F.typeOf(e);if(e!=null&&r!==t)throw new Error(`Incorrect type "${r}" for ${i}, expected "${t}"`)}static assertObject(e,t){Te.assertType(e,"object",t)}static assertInstance(e,t){Te.assertType(e,"instance",t)}static assertClass(e,t){Te.assertType(e,"class",t)}static assertFunction(e,t){if(typeof e!="function"||e.isBase||e.$$name)throw new Error(`Incorrect type for ${t}, got "${e}" (expected a function)`)}static assertNumber(e,t){const i=Number(e);if(typeof e!="number"||isNaN(i))throw new Error(`Incorrect type for ${t}, got "${e}" (expected a Number)`)}static assertBoolean(e,t){Te.assertType(e,"boolean",t)}static assertString(e,t){Te.assertType(e,"string",t)}static assertArray(e,t){Te.assertType(e,"array",t)}static toFixed(e,t){return ln?ln(e,t):e.toFixed(t)}static roundTo(e,t=1){return Math.round(e/t)*t}static round(e,t){if(t==null)return e;const i=10**t;return Math.round(e*i)/i}static getMapPath(e,t,i){const r=Array.isArray(t)?t:typeof t=="string"?t.split("."):[t],s=r.length===1,n=r[0],l=e.has(n)?e.get(n):e.set(n,s?i:{}).get(n);return s?l:Te.getPathDefault(l,r.slice(1),i)}}const Te=w;w._$name="ObjectHelper";const on=["border-top-width","border-right-width","border-bottom-width","border-left-width"],la=["margin-top","margin-right","margin-bottom","margin-left"],oa=["padding-top","padding-right","padding-bottom","padding-left"],et={t:"border-top-width",r:"border-right-width",b:"border-bottom-width",l:"border-left-width"},Ei={t:"padding-top",r:"padding-right",b:"padding-bottom",l:"padding-left"},aa=Object.freeze({x:0,y:0}),ca=/^([trblc])(\d*)-([trblc])(\d*)$/i,ua=/^([trblc])(\d*)$/i,Ti=["top","right","bottom","left"],Wt={t:0,r:1,b:2,l:3},Sr=["b-t","l-r","t-b","r-l"],da={bt:1,tb:1,lr:2,rl:2},an=Object.freeze([0,0]),fa=["width","height"],xi=(u,e=u,t=u,i=e)=>Array.isArray(u)?xi.apply(null,u):[u,e,t,i];function cn(u,e){const t=ca.exec(u),i=t[1],r=t[3],s=parseInt(t[2]||50),n=parseInt(t[4]||50),l=e&&!(Wt[i]&1)?100-s:s,o=e&&!(Wt[r]&1)?100-n:n,a=da[i+r];return{myAlignmentPoint:i+l,myEdge:i,myOffset:l,targetAlignmentPoint:r+o,targetEdge:r,targetOffset:o,startZone:Wt[r],edgeAligned:a}}function ha(u){return`${Ti[(Wt[u.myEdge]+2)%4][0]}${u.myOffset}-${Ti[(Wt[u.targetEdge]+2)%4][0]}${u.targetOffset}`}function ga(u){return u==null?an:typeof u=="number"?[u,u]:u}class V{get isRectangle(){return!0}static from(e,t,i){var r,s;if(typeof e=="string"?e=document.querySelector(e):((r=e)===null||r===void 0?void 0:r.nodeType)===Node.DOCUMENT_FRAGMENT_NODE&&(e=e.host||e.ownerDocument),typeof t=="string"&&(t=document.querySelector(t)),e==null||e.isRectangle)return e;if(e=e.element||e,i===void 0&&typeof t=="boolean"&&(i=t,t=null),!((s=t)!==null&&s!==void 0&&s.isRectangle))if(t){let{scrollLeft:d,scrollTop:f}=t;B.isSafari&&t===document.body&&(d=f=0),t=V.from(t).translate(-d,-f)}else t=aa;const n=e===document||e===globalThis,l=e===document.body&&document.body.offsetHeight===0,o=l&&e.getBoundingClientRect(),a=l?new V(o.left,o.top,o.width,document.body.parentElement.scrollHeight):n?new V(0,0,globalThis.innerWidth,globalThis.innerHeight):e.getBoundingClientRect(),c=i||n?[0,0]:[globalThis.pageXOffset,globalThis.pageYOffset];return new V(a.left+c[0]-t.x,a.top+c[1]-t.y,a.width,a.height)}static fromScreen(e,t){return V.from(e,t,!0)}static inner(e,t,i=!1){const r=this.from(e,t,i);if(document.body.contains(e)){const s=v.getStyleValue(e,on);r.x+=parseFloat(s[et.l]),r.y+=parseFloat(s[et.t]),r.right-=parseFloat(s[et.r]),r.bottom-=parseFloat(s[et.b])}return r}static content(e,t,i=!1){const r=this.from(e,t,i);if(document.body.contains(e)){const s=v.getStyleValue(e,on),n=v.getStyleValue(e,oa);r.x+=parseFloat(s[et.l])+parseFloat(n[Ei.l]),r.y+=parseFloat(s[et.t])+parseFloat(n[Ei.t]),r.right-=parseFloat(s[et.r])+parseFloat(n[Ei.r]),r.bottom-=parseFloat(s[et.b])+parseFloat(n[Ei.b])}return r}static client(e,t,i=!1){const r=this.content(e,t,i),s=v.scrollBarWidth;let n;return s&&(e.scrollHeight>e.clientHeight&&v.getStyleValue(e,"overflow-y")!=="hidden"&&(n=parseFloat(v.getStyleValue(e,"padding-right")),r.right+=n-Math.max(n,s)),e.scrollWidth>e.clientWidth&&v.getStyleValue(e,"overflow-x")!=="hidden"&&(n=parseFloat(v.getStyleValue(e,"padding-bottom")),r.bottom+=n-Math.max(n,s))),r}static outer(e,t,i=!1){const r=this.from(e,t,i);if(document.body.contains(e)){const s=v.getStyleValue(e,la);r.x-=parseFloat(s["margin-left"]),r.y-=parseFloat(s["margin-top"]),r.right+=parseFloat(s["margin-right"]),r.bottom+=parseFloat(s["margin-bottom"])}return r}static union(...e){let{x:t,y:i,right:r,bottom:s}=e[0],n;if(e.length>1)for(let l=1;l<e.length;l++)n=e[l],n.x<t&&(t=n.x),n.y<i&&(i=n.y),n.right>r&&(r=n.right),n.bottom>s&&(s=n.bottom);return new V(t,i,r-t,s-i)}roundPx(e=globalThis.devicePixelRatio||1){const t=this;return t._x=v.roundPx(t._x,e),t._y=v.roundPx(t._y,e),t._width=v.roundPx(t._width,e),t._height=v.roundPx(t._height,e),t}static get $$name(){return hasOwnProperty.call(this,"$name")&&this.$name||hasOwnProperty.call(this,"_$name")&&this._$name||this.name}get $$name(){return this.constructor.$$name}constructor(e,t,i,r){w.assertNumber(e,"Rectangle.x"),w.assertNumber(t,"Rectangle.y"),w.assertNumber(i,"Rectangle.width"),w.assertNumber(r,"Rectangle.height");const s=this;i<0&&(e+=i,i=-i),r<0&&(t+=r,r=-r),s._x=e,s._y=t,s._width=i,s._height=r}clone(){const e=this,t=new V(e.x,e.y,e.width,e.height);return t.isAlignRectangle=e.isAlignRectangle,t.minHeight=e.minHeight,t.minWidth=e.minWidth,t}contains(e){const t=this;return e.isRectangle?e._x>=t._x&&e._y>=t._y&&e.right<=t.right&&e.bottom<=t.bottom:!1}intersect(e,t=!1,i=!1){const r=this,s=Math.max(r.y,e.y),n=Math.min(r.right,e.right),l=Math.min(r.bottom,e.bottom),o=Math.max(r.x,e.x);return(i?l>=s&&n>=o:l>s&&n>o)?t?!0:new V(o,s,n-o,l-s):!1}equals(e,t=!1){const i=t?r=>Math.round(r):r=>r;return e.isRectangle&&i(e.x)===i(this.x)&&i(e.y)===i(this.y)&&i(e.width)===i(this.width)&&i(e.height)===i(this.height)}translate(e,t){return this._x+=e||0,this._y+=t||0,this}moveTo(e,t){return e!=null&&(this._x=e),t!=null&&(this._y=t),this}getDelta(e){return[e.x-this.x,e.y-this.y]}get center(){return new V.Point(this.x+this.width/2,this.y+this.height/2)}set x(e){const t=e-this._x;this._x=e,this._width-=t}get x(){return this._x}get start(){return this.left}set left(e){this.x=e}get left(){return this.x}set top(e){this.y=e}get top(){return this.y}set y(e){const t=e-this._y;this._y=e,this._height-=t}get y(){return this._y}set width(e){this._width=e}get width(){return this._width}set height(e){this._height=e}get height(){return this._height}set right(e){this._width=e-this._x}get right(){return this._x+this._width}get end(){return this.right}set bottom(e){this._height=e-this._y}get bottom(){return this._y+this._height}getStart(e,t=!0){return t?e?this.right:this.left:this.top}getEnd(e,t=!0){return t?e?this.left:this.right:this.bottom}get area(){return this.width*this.height}set minWidth(e){const t=this;isNaN(e)?t._minWidth=null:(t._minWidth=Number(e),t.isAlignRectangle||(t.width=Math.max(t.width,t._minWidth)))}get minWidth(){return this._minWidth}set minHeight(e){const t=this;isNaN(e)?t._minHeight=null:(t._minHeight=Number(e),t.isAlignRectangle||(t.height=Math.max(t.height,t._minHeight)))}get minHeight(){return this._minHeight}adjust(e,t,i,r){const s=this;return s.x+=e,s.y+=t,s.width+=i,s.height+=r,s}inflate(e,t=e,i=e,r=t){return Array.isArray(e)&&([e,t,i,r]=xi(e)),this.adjust(-r,-e,t,i)}deflate(e,t=e,i=e,r=t){return Array.isArray(e)&&([e,t,i,r]=xi(e)),this.adjust(r,e,-t,-i)}constrainTo(e,t){const i=this,r=i.height,s=i.y,n=i.minWidth||i.width,l=i.minHeight||i.height;if(i.height>=e.height){if(t&&l>e.height)return!1;i._y=e.y,i.height=e.height}if(i.width>=e.width){if(t&&n>e.width)return i.y=s,i.height=r,!1;i._x=e.x,i.width=e.width}return i.translate.apply(i,i.constrainVector=[Math.min(e.right-i.right,0),Math.min(e.bottom-i.bottom,0)]),i.translate(Math.max(e.x-i.x,0),Math.max(e.y-i.y,0)),i}alignTo(e){let t=this.clone(),{target:i,constrainTo:r,constrainPadding:s}=e,n,l,o,a;if(i&&!i.isRectangle&&(i=V.from(i.element?i.element:i)),r){if(!r.isRectangle){a=r===globalThis||r===document;const P="ignorePageScroll"in e?e.ignorePageScroll:!a;r=V.from(r.element?r.element:r,null,P)}s&&(s=xi(s),s[0]=Math.min(s[0],i.top),s[1]=Math.min(s[1],r.right-i.right),s[2]=Math.min(s[0],r.bottom-i.bottom),s[3]=Math.min(s[0],i.left),r=r.deflate.apply(r.clone(),s))}const c=this,d=ga(e.offset),{align:f,axisLock:g,anchorSize:h,anchorPosition:p,matchSize:m,position:y,rtl:b}=e,C=cn(f,b),E=r&&r.clone(),S=[],x=[{zone:l=C.startZone,align:f}],L=m&&fa[C.startZone&1],O=c[L];if(L&&g?t[L]=i[L]:!C.edgeAligned&&m&&(t.width=i.width,t.height=i.height),r&&t.constrainTo(r),r&&C.startZone!=null)if(g)x.push({zone:l=(l+2)%4,align:ha(C)}),g==="flexible"&&(x.push({zone:l=(C.startZone+1)%4,align:Sr[l]}),x.push({zone:l=(l+2)%4,align:Sr[l]}));else for(let P=1;P<4;P++)x.push({zone:l=(l+1)%4,align:Sr[l]});if(p){const P=C.startZone&1?"y":"x";n={[P]:p[P],edge:Ti[(C.startZone+2)%4]}}if(E&&i&&(E.adjust(-i.width,-i.height,i.width,i.height),i.constrainTo(E)),t.minWidth=c.minWidth,t.minHeight=c.minHeight,y)t.moveTo(y.x,y.y),r&&t.constrainTo(r);else{const P=C.myEdge==="c"||C.targetEdge==="c",I=h&&!P?[h[1]+d[0],h[1]+d[1]]:d,G=i.getAlignmentPoint(C.targetAlignmentPoint,I),K=t.getAlignmentPoint(C.myAlignmentPoint);t.translate(G[0]-K[0],G[1]-K[1]);let H=t.intersect(i,!0);if(H)r&&t.constrainTo(r),o=C.startZone,t.translate(...I);else if(r&&!r.contains(t)){const J=t.clone(),_=[];let U,re;n=null,S[0]=U=r.clone(),U.bottom=i.y-I[1],S[1]=U=r.clone(),U.x=i.right+I[0],S[2]=U=r.clone(),U.y=i.bottom+I[1],S[3]=U=r.clone(),U.right=i.x-I[0];for(let Y=0;Y<x.length;Y++){if(L&&Y==2&&(t[L]=O),U=S[o=x[Y].zone],t=t.alignTo({target:i,offsets:I,align:x[Y].align}),t.constrainTo(U,!0)&&(_.push({result:t,zone:o}),!re||t.width<c.width||t.height<c.height)){t.align=x[Y].align;break}if(!re||U.area>re.area){const A=t.clone();switch(o){case 0:A.moveTo(null,U.bottom-A.height);break;case 1:A.moveTo(U.left);break;case 2:A.moveTo(null,U.top);break;case 3:A.moveTo(U.right-A.width);break}re={area:U.area,result:A,zone:o}}}_.length?(_.length>1&&!g&&_.sort((Y,A)=>{const q=Math.sqrt((J.x-Y.result.x)**2+(J.y-Y.result.y)**2),he=Math.sqrt((J.x-A.result.x)**2+(J.y-A.result.y)**2);return q-he}),t=_[0].result,o=_[0].zone):(t=re.result,o=re.zone,a&&t.constrainTo(r))}else o=C.startZone;if(t.zone=o,t.overlap=H=t.intersect(i,!0),h&&!H){if(!n){const J=o&1,_=J?"y":"x",U=J?"bottom":"right",re=Math.max(i[_],t[_]),Y=Math.min(i[U],t[U]);let A=re+(Y-re)/2-h[0]/2;const q=A+h[0];q>t[U]&&(A-=q-t[U]),A<t[_]&&(A+=t[_]-A),n={[_]:A-t[_],edge:Ti[(o+2)%4]}}t.anchor=n}}return t}getAlignmentPoint(e,t=an){const i=this,r=ua.exec(e),s=r[1].toLowerCase(),n=Math.min(Math.max(parseInt(r[2]||50),0),100)/100;switch(s){case"t":return[i.x+i.width*n,i.y-t[1]];case"r":return[i.right+t[0],i.y+i.height*n];case"b":return[i.x+i.width*n,i.bottom+t[1]];case"l":return[i.x-t[0],i.y+i.height*n];case"c":return[i.x+i.width/2,i.y+i.height/2]}}highlight(){const e=this,t=v.createElement({parent:document.body,style:`position:absolute;z-index:9999999;pointer-events:none;
                            left:${e.x}px;top:${e.y}px;width:${e.width}px;height:${e.height}px`});return v.highlight(t).then(()=>t.remove())}visualize(e,t){const i=this,r=w.merge({style:{left:`${i.x}px`,top:`${i.y}px`,width:`${i.width}px`,height:`${i.height}px`,pointerEvents:"none",...e.class?{}:{position:"absolute","z-index":9999999}}},e);return t?r:v.createElement(r)}toString(e=","){return[`${this.top}px`,`${this.right}px`,`${this.bottom}px`,`${this.left}px`].join(e)}}V._$name="Rectangle";const ft=Symbol("value"),un=Symbol("length");class W{static change(e,t,i,r="string"){i=W.normalize(i,"object");const s=W.normalize(e,"array").filter(n=>!i[n]);if(t){t=W.normalize(t,"array");for(let n=0;n<t.length;++n)s.includes(t[n])||s.push(t[n])}return W.normalize(s,r)}static from(e,t){return e&&(e.isDomClassList?t=t!=null?t:!0:(t=t!=null?t:F.isObject(e)&&!F.isEmpty(e),e=new W(e)),!e.value&&!t&&(e=null)),e||(t?new W:null)}static normalize(e,t="string"){e=e||"";const i=typeof e,r=t==="array",s=t==="object",n=!r&&!s;let l=i==="string",o,a,c;if(i==="object"){var d;e.nodeType===Element.ELEMENT_NODE&&typeof e.getAttribute=="function"?(e=e.getAttribute("class")||"",l=!0):(d=e)!==null&&d!==void 0&&d.isDomClassList?e=e.values:e instanceof DOMTokenList?e=Array.from(e):e instanceof Map?e=Array.from(e.keys()).filter(f=>e.get(f)):e instanceof Set?e=Array.from(e):Array.isArray(e)||(e=F.getTruthyKeys(e))}for(l&&(e=[...new Set(k.split(e))]),a=e.length;a-- >0;)o=e[a],o.length?o.includes(" ")&&e.splice(a,1,...k.split(o)):e.splice(a,1);if(r)c=e;else if(n)c=e.join(" ");else for(c=Object.create(null),a=0;a<e.length;++a)c[e[a]]=!0;return c}constructor(...e){this.process(1,e)}clear(){for(const e in this)this[e]=!1;return this}set(...e){return this.clear().process(1,e)}get isDomClassList(){return!0}clone(){return new W(this)}contains(e){return typeof e=="string"&&e?!!this[e]:!1}toString(){return this.length?`${this.value} `:""}toJSON(){return this.toString()}trim(){return this.value}isEqual(e){const t=W.normalize(e,"array"),i=t.length;if(this.length===i){for(let r=0;r<i;r++)if(!this[t[r]])return!1;return!0}return!1}get value(){let e=this[ft],t;return e==null&&(t=F.getTruthyKeys(this),this[un]=t.length,this[ft]=e=t.join(" ")),e}set value(e){const t=this,i=Object.keys(t),r=i.length;for(let s=0;s<r;s++)delete t[i[s]];e?t.process(1,[e]):delete t[ft]}get values(){return F.getTruthyKeys(this)}get length(){return this.value?this[un]:0}process(e,t){for(let i,r,s=0;s<t.length;s++)if(t[s])if(i=t[s],i.isDomClassList||F.isObject(i))for(r in i)this[r]=e?i[r]:!i[r];else for(i=W.normalize(t[s],"array"),r=0;r<i.length;++r)this[i[r]]=e;return delete this[ft],this}assign(e){for(const t in e)!this[t]!=!e[t]&&(this[t]=e[t],delete this[ft]);return this}assignTo(e){const t=e.nodeType===Element.ELEMENT_NODE?e.classList:e,i=W.from(t);i.add(this),t.value=i.value}add(...e){return this.process(1,e)}remove(...e){return this.process(0,e)}toggle(e,t=!this[e]){if(t=!!t,!!this[e]!==t)return this[e]=t,delete this[ft],!0}split(){return F.getTruthyKeys(this)}forEach(e){return F.getTruthyKeys(this).forEach(e)}}W.prototype[ft]=null,W._$name="DomClassList";class Ve extends V{static from(e){const t=e.changedTouches;return new Ve(t?t[0].screenX:e.screenX,t?t[0].screenY:e.pageY)}constructor(e,t){super(e,t,0,0)}constrain(e){return this.x=Math.min(Math.max(this.x,e.x),e.right-1),this.y=Math.min(Math.max(this.y,e.y),e.bottom-1),this}toArray(){return[this.x,this.y]}}Object.getPrototypeOf(Ve).Point=Ve,Ve._$name="Point";const ma=["clientX","clientY","pageX","pageY","screenX","screenY"],pa={element:1,thisObj:1,once:1,delegate:1,delay:1,capture:1,passive:1,throttled:1,autoDetach:1,expires:1,block:1},tt=!0,dn={configurable:tt,value:!0},ya={Spacebar:"Space",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown"},va={Control:"ctrl",Alt:"alt",Shift:"shift"},ba=/^(ctrl|shift|alt|meta)$/,Ca=["altKey","bubbles","button","buttons","cancelBubble","cancelable","clientX","clientY","ctrlKey","layerX","layerY","metaKey","pageX","pageY","returnValue","screenX","screenY","shiftKey"],ms=class{static normalizeEvent(e){return w.copyPropertiesIf(e,e.changedTouches[0]||e.touches[0],ma)}static copyEvent(e,t){return w.copyProperties(e,t,Ca)}static getXY(e){return e.touches&&(e=e.touches[0]),[e.clientX,e.clientY]}static getDistanceBetween(e,t){const i=oe.getXY(e),r=oe.getXY(t);return Math.sqrt(Math.pow(i[0]-r[0],2)+Math.pow(i[1]-r[1],2))}static getPagePoint(e){return new V.Point(e.pageX,e.pageY)}static getClientPoint(e){return new V.Point(e.clientX,e.clientY)}static addListener(e,t,i,r){return e.nodeType?typeof t=="string"?r=Object.assign({element:e,[t]:i},r):r=Object.assign({element:e},t):r=e,oe.on(r)}static on(e){const t=e.element,i=e.thisObj,r=[];for(const n in e)if(!pa[n]){let l=e[n];typeof l!="object"&&(l={handler:l});const o=l.element||t;r.push(oe.addElementListener(o,n,l,e))}const s=()=>{for(let n,l=0;l<r.length;l++)n=r[l],oe.removeEventListener(n[0],n[1],n[2]);r.length=0};return i&&e.autoDetach!==!1&&(i.doDestroy=ee.createInterceptor(i.doDestroy,s,i)),s}static addElementListener(e,t,i,r){const s=oe.createHandler(e,t,i,r),{spec:n}=s,l=i.expires||r.expires,o=n.capture!=null||n.passive!=null?{capture:n.capture,passive:n.passive}:void 0;if(e.addEventListener(t,s,o),l){const a=i.thisObj||r.thisObj,c=a!=null&&a.isDelayable?a:globalThis,{alt:d}=l,f=d?l.delay:l,{spec:g}=s;g.expires=l,g.timerId=c[typeof f=="number"?"setTimeout":"requestAnimationFrame"](()=>{g.timerId=null,oe.removeEventListener(e,t,s),d&&!s.called&&(typeof d=="string"?a[d]:d).call(a)},f,`listener-timer-${performance.now()}`)}return[e,t,s,o]}static getComposedPathTarget(e){return e.composedPath()[0]||e.path[0]}static fixEvent(e){var t,i,r;if(e.fixed)return e;const{type:s,target:n}=e;if((n!=null&&n.shadowRoot||n!=null&&(t=n.getRootNode)!==null&&t!==void 0&&(i=t.call(n))!==null&&i!==void 0&&i.host)&&e.composedPath){const l=this.getComposedPathTarget(e),o=n;Object.defineProperty(e,"target",{value:l,configurable:tt}),Object.defineProperty(e,"originalTarget",{value:o,configurable:tt})}if(Object.defineProperty(e,"fixed",dn),s.startsWith("key")){const l=ya[e.key];l&&Object.defineProperty(e,"key",{value:l,configurable:tt}),e.key===" "&&!e.code&&Object.defineProperty(e,"code",{value:"Space",configurable:tt})}if(e.metaKey&&!e.ctrlKey&&Object.defineProperty(e,"ctrlKey",dn),n&&"offsetX"in e&&(Object.getOwnPropertyDescriptor(e,"borderOffsetX")||Object.defineProperty(e,"borderOffsetX",{get:()=>e.offsetX+(B.isSafari?0:parseInt(n.ownerDocument.defaultView.getComputedStyle(n).getPropertyValue("border-left-width")))}),Object.getOwnPropertyDescriptor(e,"borderOffsetY")||Object.defineProperty(e,"borderOffsetY",{get:()=>e.offsetY+(B.isSafari?0:parseInt(n.ownerDocument.defaultView.getComputedStyle(n).getPropertyValue("border-top-width")))})),(n==null?void 0:n.nodeType)===Element.DOCUMENT_NODE&&"clientX"in e){const l=v.elementFromPoint(e.clientX,e.clientY);Object.defineProperty(e,"target",{value:l,configurable:tt})}if((n==null?void 0:n.nodeType)===Element.TEXT_NODE){const l=e.target.parentElement;Object.defineProperty(e,"target",{value:l,configurable:tt})}if(((r=e.relatedTarget)===null||r===void 0?void 0:r.nodeType)===Element.TEXT_NODE){const l=e.target.parentElement;Object.defineProperty(e,"relatedTarget",{value:l,configurable:tt})}return s.startsWith("touch")&&e.touches.length&&this.normalizeEvent(e),e}static createHandler(e,t,i,r){const s=i.delay||r.delay,n=i.throttled||r.throttled,l=i.block||r.block,o="once"in i?i.once:r.once,a="capture"in i?i.capture:r.capture,c="passive"in i?i.passive:r.passive,d="delegate"in i?i.delegate:r.delegate,f=i.handler,g=i.expires,h=i.thisObj||r.thisObj,{rtlSource:p=h}=h||{};let m=(y,...b)=>{oe.playingDemo&&y.isTrusted||h!=null&&h.isDestroyed||(y=oe.fixEvent(y,p==null?void 0:p.rtl),m.called=!0,(typeof f=="string"?h[f]:f).call(h,y,...b),delete y.target,delete y.relatedTarget,delete y.originalarget,delete y.key,delete y.code,delete y.ctrlKey,delete y.fixed)};if(l){const y=m;let b,C;m=(E,...S)=>{const x=performance.now();(!b||E.target!==C||x-b>l)&&(C=E.target,b=x,y(E,...S))}}if(s!=null){const y=m,b=h!=null&&h.setTimeout?h:globalThis;m=(...C)=>{b.setTimeout(()=>{y(...C)},s)}}if(n!=null){let y,b=n;n.buffer&&(y=C=>n.alt.call(oe,oe.fixEvent(C,p==null?void 0:p.rtl)),b=n.buffer),h!=null&&h.isDelayable?m=h.throttle(m,{delay:b,throttled:y}):m=ee.createThrottled(m,b,h,null,y)}if(o){const y=m;m=(...b)=>{oe.removeEventListener(e,t,m),y(...b)}}if(d){const y=m;m=(b,...C)=>{var E;b=oe.fixEvent(b,p==null?void 0:p.rtl);const S=((E=b.target.closest)===null||E===void 0?void 0:E.call)&&b.target.closest(d);S&&(Object.defineProperty(b,"currentTarget",{get:()=>S,configurable:!0}),y(b,...C))}}return i.thisObj&&i.autoDetach!==!1&&(h.doDestroy=ee.createInterceptor(h.doDestroy,()=>oe.removeEventListener(e,t,m),h)),m.spec={delay:s,throttled:n,block:l,once:o,thisObj:h,capture:a,expires:g,passive:c,delegate:d},m}static removeEventListener(e,t,i){const{expires:r,timerId:s,thisObj:n,capture:l}=i.spec;r!=null&&r.alt&&s&&(n!=null&&n.isDelayable?n:globalThis)[typeof r.delay=="number"?"clearTimeout":"cancelAnimationFrame"](s),e.removeEventListener(t,i,l)}static onTransitionEnd({element:e,animationName:t,property:i,handler:r,mode:s=t?"animation":"transition",duration:n=v[`get${s==="transition"?"Property":""}${k.capitalize(s)}Duration`](e,i),thisObj:l=globalThis,args:o=[],timerSource:a,runOnDestroy:c}){let d;a=a||(l.isDelayable?l:globalThis);const f=[e,i,...o],g=()=>{h(),l.isDestroyed||(l.callback?l.callback(r,l,f):r.apply(l,f))},h=oe.on({element:e,[`${s}end`]({animationName:p,propertyName:m,target:y}){if(y===e&&(m===i||p!=null&&p.match(t))){if(d){var b,C;(b=(C=a).clearTimeout)===null||b===void 0||b.call(C,d),d=null}g()}}});return n!=null&&(d=a.setTimeout(g,n+50,"onTransitionEnd",c)),h}static async waitForTransitionEnd(e){return new Promise(t=>{e.handler=t,ms.onTransitionEnd(e)})}static createDblClickWrapper(e,t,i){let r,s,n;return()=>{s||(s=oe.on({element:e,touchstart:l=>{r=l.changedTouches[0].identifier,l.preventDefault()},touchend:l=>{if(l.changedTouches[0].identifier===r){l.preventDefault(),clearTimeout(n),r=s=null;const o=V.from(l.changedTouches[0].target,null,!0),a=l.changedTouches[0].pageX-o.x,c=l.changedTouches[0].pageY-o.y,d=Object.assign({browserEvent:l},l),f=new MouseEvent("dblclick",d);Object.defineProperties(f,{target:{value:l.target},offsetX:{value:a},offsetY:{value:c}}),typeof t=="string"&&(t=i[t]),t.call(i,f)}},once:!0}),n=setTimeout(()=>{s(),r=s=null},oe.dblClickTime))}}static toSpecialKey(e,t=B.isMac?"metaKey":"ctrlKey"){let i=!1;return e===!0?i=t:typeof e=="string"&&(e=e.toLowerCase(),e.match(ba)&&(i=`${e}Key`)),i}static specialKeyFromEventKey(e){return va[e]||"no-special-key"}};let z=ms;R(z,"eventNameMap",{mousedown:"MouseDown",mouseup:"MouseUp",click:"Click",dblclick:"DblClick",contextmenu:"ContextMenu",mouseenter:"MouseEnter",mouseleave:"MouseLeave",mousemove:"MouseMove",mouseover:"MouseOver",mouseout:"MouseOut",keyup:"KeyUp",keydown:"KeyDown",keypress:"KeyPress"});const oe=z;oe.longPressTime=700,oe.dblClickTime=300,B.isTouchDevice&&oe.on({element:document,touchmove:u=>{u.target.closest(".b-dragging")&&u.preventDefault()},passive:!1,capture:!0}),z._$name="EventHelper";const wa=14,Sa={align:"t0-t0"},Ut=Node.ELEMENT_NODE,Di=Node.TEXT_NODE,{isObject:Ea}=w,fn=/[+-]?\d*\.?\d+[eE]?-?\d*/g,Ae=fn.source,Ta=new RegExp(`matrix\\((?:${Ae}),\\s?(?:${Ae}),\\s?(?:${Ae}),\\s?(?:${Ae}),\\s?(${Ae}),\\s?(${Ae})`),xa=new RegExp("matrix3d\\((?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(-?\\d*),\\s?(-?\\d*)"),Mi=new RegExp(`(?:${Ta.source})|(?:${xa.source})`),Da=new RegExp(`translate(3d|X)?\\((${Ae})px(?:,\\s?(${Ae})px)?`),Ma=new RegExp(`translate(3d|Y)?\\((${Ae})px(?:,\\s?(${Ae})px)?`),Ia=/\s+/,Oa=/\s*;\s*/,La=/\s*:\s*/,Fa=/^-?((\d+(\.\d*)?)|(\.?\d+))$/,ka="$bryntum",$a={elementData:"",for:"htmlFor",retainElement:""},Ra={tag:1,html:1,text:1,children:1,tooltip:1,style:1,dataset:1,parent:1,nextSibling:1,ns:1,reference:1,class:1,className:1,unmatched:1,onlyChildren:1,listeners:1,compareHtml:1,syncOptions:1,keepChildren:1},hn={length:1,parentRule:1,style:1},Pa={INPUT:1,TEXTAREA:1},Aa={BUTTON:1,IFRAME:1,EMBED:1,INPUT:1,OBJECT:1,SELECT:1,TEXTAREA:1,BODY:1},Ii=globalThis,de=document,_a=Object.freeze({}),Er=Array.prototype.slice,Na=Promise.resolve(),Va=["font-size","font-size-adjust","font-style","font-weight","font-family","font-kerning","font-stretch","line-height","text-transform","text-decoration","letter-spacing","word-break"],za=u=>u._hidden,Ba=u=>u.parentNode||u.host,ja=(u,e,t)=>t.key==="children"?w.mergeItems(u,e,t):w.blend(u,e,t),Tr=u=>{const e=u.ownerDocument.defaultView.getComputedStyle(u);return e.getPropertyValue("display")!=="none"&&e.getPropertyValue("visibility")!=="hidden"},it=u=>u&&(u===de.body||!!u.offsetParent||(u.ownerDocument.defaultView&&"offsetParent"in u&&v.getStyleValue(u,"position")!=="fixed"?u.offsetParent:it(u.parentNode))),gn=u=>u instanceof Node?u:typeof u=="string"?D.createElementFromTemplate(u):D.createElement(u),qt=Object.create(null),mn=(u,e)=>{const t=qt[u]||[k.hyphenate(u),e];return qt[u]||(qt[t[0]]=qt[u]=t),t},Ha=u=>u.ownerSVGElement?u.ownerSVGElement.parentNode:u.offsetParent,Wa=/b-slide-in-from-\w+/;["top","right","bottom","left","width","height","maxWidth","maxHeight","minWidth","minHeight","borderSpacing","borderWidth","borderTopWidth","borderRightWidth","borderBottomWidth","borderLeftWidth","marginTop","marginRight","marginBottom","marginLeft","paddingTop","paddingRight","paddingBottom","paddingLeft","fontSize","letterSpacing","lineHeight","outlineWidth","textIndent","wordSpacing"].forEach(u=>mn(u,!0));let Kt=null,Ua=0,ht=null,xr,pn,yn;class v{static async slideIn(e,t=1){const i=`b-slide-in-${t>0?"next":"previous"}`,{classList:r}=e,{style:s}=e.parentNode,{overflow:n,overflowX:l,overflowY:o}=s;s.overflow="hidden",r.add(i),await z.waitForTransitionEnd({element:e,animationName:Wa}),s.overflow=n,s.overflowX=l,s.overflowY=o,r.remove(i)}static isFocusable(e,t=!1){if(!t&&(!D.isVisible(e)||D.Widget.fromElement(e,za)))return!1;const i=e.nodeName;return Aa[i]||(i==="A"||i==="LINK")&&!!e.href||e.getAttribute("tabIndex")!=null||e.contentEditable==="true"}static isEditable(e){return e.isContentEditable||Pa[e.nodeName]}static isInView(e,t=!1,i){if(!it(e))return!1;const r=(i==null?void 0:i.positioned)&&v.getStyleValue(i.element,"position")!=="fixed",s=V.from(globalThis),n=t?"contains":"intersect",l=r&&i.element.offsetParent,o=r&&V.from(l);if(s.height=de.scrollingElement.scrollHeight,e===de.body)return s;const a=this.getViewportIntersection(e,s,n);return a&&r&&a.translate(de.scrollingElement.scrollLeft,de.scrollingElement.scrollTop),r&&a?a.translate(-o.x+l.scrollLeft,-o.y+l.scrollTop):a}static getViewportIntersection(e,t,i){const{parentNode:r}=e,{parentElement:s}=r.nodeType===Node.DOCUMENT_FRAGMENT_NODE?e.getRootNode().host:e,n=s.ownerDocument.defaultView.getComputedStyle(s),l=n.overflowX!=="visible"||n.overflowY!=="visible",o=Ha(e);let a=V.from(e,null,!0);for(let c=l?e.parentNode:o;a&&c!==de.documentElement;c=c.parentNode){c.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&c.host&&(c=c.host.parentNode);const d=c===de.body,f=c.ownerDocument.defaultView.getComputedStyle(c),g=d?t:V.inner(c,null,!0);(d||f.overflow!=="visible")&&(a=g[i](a,!1,!0))}return a}static isVisible(e){const t=e.ownerDocument;for(;e;e=Ba(e)){if(e===t)return!0;if(e.nodeType===e.ELEMENT_NODE&&!Tr(e))return!1}return!1}static isDOMEvent(e){return e instanceof Event}static merge(e,...t){return w.blend(e,t,{merge:ja})}static normalizeChildren(e,t,i){var r;let s=e==null?void 0:e.children,n,l,o,a,c;if(e!=null&&(r=e.syncOptions)!==null&&r!==void 0&&r.ignoreRefs&&(i=!0),s&&!(e instanceof Node))if(Array.isArray(s))for(l=0;l<s.length;++l)D.normalizeChildren(s[l],t,i);else{a=s,e.children=s=[];for(o in a){var d;n=a[o],(d=n)!==null&&d!==void 0&&d.isWidget&&(n=n.element),c=!o.startsWith("$")&&!D.isElement(n),c&&(t==null||t(o,!i)),n&&(n instanceof Node||(n.reference===!1?delete n.reference:c&&typeof n!="string"&&(n.reference=o),D.normalizeChildren(n,t,i)),s.push(n))}}return e}static roundPx(e,t=globalThis.devicePixelRatio||1){const i=1/t;return Math.round(e/i)*i}static floorPx(e,t=globalThis.devicePixelRatio||1){const i=1/t;return Math.floor(e*i)/i}static isCustomElement(e){return!!(e!=null&&e.shadowRoot)}static elementFromPoint(e,t){let i=document.elementFromPoint(e,t);return D.isCustomElement(i)&&(i=i.shadowRoot.elementFromPoint(e,t)||i),i}static childFromPoint(e,t,i,r=e){const s=i==null?t:new V(t,i,0,0);let n=null;return Array.from(e.children).reverse().some(l=>{if(V.from(l,r).contains(s))return n=l.children.length&&D.childFromPoint(l,s,null,r)||l,!0}),n}static unitize(e,t,i="px"){const[r,s]=mn(e);return t!=null&&(t=String(t),t=s&&Fa.test(t)?t+i:t),[r,t]}static get activeElement(){let e=document.activeElement;for(;e.shadowRoot;)e=e.shadowRoot.activeElement;return e}static getActiveElement(e){var t,i;(t=e)!==null&&t!==void 0&&t.isWidget&&(e=e.element);let r=(((i=e)===null||i===void 0?void 0:i.getRootNode())||document).activeElement;for(;(s=r)!==null&&s!==void 0&&s.shadowRoot;){var s;r=r.shadowRoot.activeElement}return r}static getRootElement(e){var t;const i=(t=e.getRootNode)===null||t===void 0?void 0:t.call(e),{nodeType:r}=i;return r===Node.DOCUMENT_NODE?i.body:r===Node.DOCUMENT_FRAGMENT_NODE?i:e.ownerDocument.contains(e)?e.ownerDocument.body:null}static getOutermostElement(e){var t,i;const r=(t=(i=e).getRootNode)===null||t===void 0?void 0:t.call(i);if(r!=null&&r.body)return r==null?void 0:r.body;for(;e.parentNode!==r&&e.parentNode;)e=e.parentNode;return e}static isValidFloatRootParent(e){return e===document.body||e.constructor.name==="ShadowRoot"}static getId(e){return e.id||(e.id="b-element-"+ ++Ua)}static getCommonAncestor(e,t){if(e===t)return e;for(;e&&!((i=(r=e)[e.isWidget?"owns":"contains"])!==null&&i!==void 0&&i.call(r,t)||e===t);){var i,r;e=e.owner||e.parentNode}return e}static getElement(e){return e instanceof Element?e:de.querySelector(e)}static setAttributes(e,t){const i=D.getElement(e);if(i&&t)for(const r in t)t[r]==null?i.removeAttribute(r):i.setAttribute(r,t[r])}static setLength(e,t,i){return arguments.length===1?i=typeof e=="number"?`${e}px`:e!=null?e:"":(e=D.getElement(e),i=e.style[t]=typeof i=="number"?`${i}px`:i!=null?i:""),i}static percentify(e,t=2){const i=Math.pow(10,t);return e==null||e===""||isNaN(e)?"":`${Math.round(e*i)/i}%`}static getChild(e,t){return e.querySelector(":scope>"+t)}static hasChild(e,t){return D.getChild(e,t)!=null}static children(e,t){return(t[0]===">"||t.startsWith("# "))&&(t[0]==="#"&&(t=t.substr(2)),t=":scope "+t),Array.from(e.querySelectorAll(t))}static getChildElementCount(e){return e.childElementCount}static down(e,t){return e?e.matches&&e.matches(t)?e:(t=":scope "+t,e.querySelector(t)):null}static isDescendant(e,t){const i=D.getRootElement(e),r=D.getRootElement(t);return r&&i!==r&&r.host?D.isDescendant(i,r.host):e.contains(t)}static getEventElement(e,t="target"){return!e||D.isElement(e)?e:e[t]}static isElement(e){return(e==null?void 0:e.nodeType)===document.ELEMENT_NODE&&D.isNode(e)}static isReactElement(e){return(e==null?void 0:e.$$typeof)===Symbol.for("react.element")}static isNode(e){return!!e&&typeof e.nodeType=="number"&&!Ea(e)}static forEachSelector(e,t,i){if(typeof e=="string")throw new Error("DomHelper.forEachSelector must provide a root element context (for shadow root scenario)");D.children(e,t).forEach(i)}static forEachChild(e,t){Array.from(e.children).forEach(t)}static removeEachSelector(e,t){D.forEachSelector(e,t,i=>i.remove())}static removeClsGlobally(e,...t){t.forEach(i=>D.forEachSelector(e,"."+i,r=>r.classList.remove(i)))}static up(e,t){return ne.deprecate("Core","6.0.0","DomHelper.up() deprecated, use native `element.closest()` instead"),e.closest(t)}static getAncestor(e,t,i=null){let r=!1,s,n=e;for(t=j.asArray(t);n=n.parentElement;){if(t.includes(n)){r=!0;break}if(i&&n===i)break;s=n}return r?s||e:null}static getParents(e){const t=[];for(;e.parentElement;)t.push(e.parentElement),e=e.parentElement;return t}static makeValidId(e,t=""){return k.makeValidDomId(e,t)}static createElement(e={},t){var i,r,s;let n=t,l,o,a,c,d,f,g,h,p,m,y;if(typeof n=="boolean")throw new Error("Clean up");t&&(d=t.ignoreRefs,p=t.refOwner,m=t.refs,n=t.returnAll,y=t.syncIdField,d&&(a=!0,d=d!=="children")),typeof e.parent=="string"&&(e.parent=document.getElementById(e.parent));const b=e.parent||e.nextSibling&&e.nextSibling.parentNode,{dataset:C,html:E,reference:S,syncOptions:x,text:L}=e;if(x&&(y=x.syncIdField||y,c=x.ignoreRefs,c&&(a=!0,d=c!=="children",t={...t,ignoreRefs:!0})),d&&(p=null),e.ns?l=de.createElementNS(e.ns,e.tag||"svg"):l=de.createElement(e.tag||"div"),L!=null?D.setInnerText(l,L):E!=null&&(E instanceof DocumentFragment?l.appendChild(E):l.innerHTML=E),e.tooltip&&D.Widget.attachTooltip(l,e.tooltip),e.style&&D.applyStyle(l,e.style),C)for(g in C)h=C[g],h!=null&&(l.dataset[g]=h);b&&this.addChild(b,l,e.nextSibling),p&&(l.$refOwnerId=p.id),S&&!d&&(p?(l.$reference=S,p.attachRef(S,l,e)):(m||(t=Object.assign({},t),t.refs=m={}),m[S]=l,l.setAttribute("data-reference",S)));const O=e.className||e.class,P=Object.keys(e);for(O&&l.setAttribute("class",W.normalize(O)),o=0;o<P.length;++o)g=P[o],h=e[g],(f=$a[g])!=null?l[f||g]=h:!Ra[g]&&g&&h!=null&&l.setAttribute(g,h);return!e["aria-hidden"]&&!e.role&&!e.tabIndex&&!v.isFocusable(l,!0)&&!l.htmlFor&&l.setAttribute("role","presentation"),(i=t)===null||i===void 0||(r=i.callback)===null||r===void 0||r.call(i,{action:"newElement",domConfig:e,targetElement:l,syncId:p?S:t.syncIdField&&((s=e.dataset)===null||s===void 0?void 0:s[t.syncIdField])}),n===!0?t.returnAll=n=[l]:Array.isArray(n)&&n.push(l),e.children&&(y&&(l.syncIdMap={}),e.children.forEach(I=>{var H;if(I)if(typeof I=="string"){const J=document.createTextNode(I);p&&(J.$refOwnerId=p.id),l.appendChild(J)}else if(isNaN(I.nodeType)){var G,K;I.parent=l,!I.ns&&e.ns&&(I.ns=e.ns);const J=D.createElement(I,{...t,ignoreRefs:(H=(G=e.syncOptions)===null||G===void 0?void 0:G.ignoreRef)!=null?H:a}),_=(K=I.dataset)===null||K===void 0?void 0:K[y];_!=null&&(l.syncIdMap[_]=J),delete I.parent}else l.appendChild(I)})),l.lastDomConfig=e,m||n||l}static createElementFromTemplate(e,t=_a){const{array:i,raw:r,fragment:s}=t;let n;if(D.supportsTemplate){if((xr||(xr=de.createElement("template"))).innerHTML=e,n=xr.content,s)return n.cloneNode(!0)}else if(n=(pn||(pn=new DOMParser)).parseFromString(e,"text/html").body,s){const l=n.childNodes;for(n=document.createDocumentFragment();l.length;)n.appendChild(l[0]);return n}return r?n=n.childNodes:n=n.children,n.length===1&&!i?n[0]:Er.call(n)}static triggerMouseEvent(e,t="contextmenu"){const i=this.isInView(e),r=i||V.from(e),s=r.center,n=new MouseEvent(t,{clientX:s.x,clientY:s.y,bubbles:!0});e.dispatchEvent(n)}static insertFirst(e,t){return t&&t.nodeType!==Ut&&t.tag&&(t=D.createElement(t)),e.insertBefore(t,e.firstElementChild)}static insertBefore(e,t,i){return t&&t.nodeType!==Ut&&t.tag&&(t=D.createElement(t)),i?e.insertBefore(t,i):D.insertFirst(e,t)}static insertAt(e,t,i){const r=Array.from(e.children);if(i>=r.length)return D.append(e,t);const s=r[i];return D.insertBefore(e,t,s)}static append(e,t){if(t.forEach){if(Array.isArray(t)&&(t=t.map(i=>gn(i))),e.append)e.append(...t);else{const i=document.createDocumentFragment();t.forEach(function(r){i.appendChild(r)}),e.appendChild(i)}return t}else return e.appendChild(gn(t))}static getTranslateX(e){const t=e.style.transform;let i=Da.exec(t);return i?parseFloat(i[2]):(i=Mi.exec(t)||Mi.exec(D.getStyleValue(e,"transform")),i?parseFloat(i[1]||i[3]):0)}static getTranslateY(e){const t=e.style.transform;let i=Ma.exec(t);if(i){const r=parseFloat(i[i[1]==="Y"?2:3]);return isNaN(r)?0:r}else return i=Mi.exec(t)||Mi.exec(D.getStyleValue(e,"transform")),i?parseFloat(i[2]||i[4]):0}static getTranslateXY(e){return[D.getTranslateX(e),D.getTranslateY(e)]}static getOffsetX(e,t=null){return t?e.getBoundingClientRect().left-t.getBoundingClientRect().left:e.offsetLeft}static getOffsetY(e,t=null){return t?e.getBoundingClientRect().top-t.getBoundingClientRect().top:e.offsetTop}static getOffsetXY(e,t=null){return[D.getOffsetX(e,t),D.getOffsetY(e,t)]}static focusWithoutScrolling(e){function t(r){r.forEach(({element:s,scrollLeft:n,scrollTop:l})=>{s.scrollLeft!==n&&(s.scrollLeft=n),s.scrollTop!==l&&(s.scrollTop=l)})}if(!B.isSafari)e.focus({preventScroll:!0});else{const r=D.getParents(e),s=r.map(n=>({element:n,scrollLeft:n.scrollLeft,scrollTop:n.scrollTop}));e.focus(),setTimeout(()=>t(s),0)}}static getPageX(e){return e.getBoundingClientRect().left+Ii.pageXOffset}static getPageY(e){return e.getBoundingClientRect().top+Ii.pageYOffset}static getExtremalSizePX(e,t){const i=k.hyphenate(t),r=i.split("-")[1];let s=D.getStyleValue(e,i);return/%/.test(s)?e.parentElement?s=parseInt(D.getStyleValue(e.parentElement,r),10):s=NaN:s=parseInt(s,10),s}static setScale(e,t,i=t){const r=D.getStyleValue(e,"transform").split(/,\s*/);r.length>1?(r[0].startsWith("matrix3d")?(r[0]=`matrix3d(${t}`,r[5]=i):(r[0]=`matrix(${t}`,r[3]=i),e.style.transform=r.join(",")):e.style.transform=`scale(${t}, ${i})`}static setTranslateX(e,t){const i=D.getStyleValue(e,"transform").split(/,\s*/);t=D.roundPx(t),i.length>1?(i[i[0].startsWith("matrix3d")?12:4]=t,e.style.transform=i.join(",")):e.style.transform=`translateX(${t}px)`}static setTranslateY(e,t){const i=D.getStyleValue(e,"transform").split(/,\s*/);t=D.roundPx(t),i.length>1?(i[i[0].startsWith("matrix3d")?13:5]=t,e.style.transform=i.join(",")+")"):e.style.transform=`translateY(${t}px)`}static setTop(e,t){D.setLength(e,"top",t)}static setLeft(e,t){D.setLength(e,"left",t)}static setTopLeft(e,t,i){D.setLength(e,"top",t),D.setLength(e,"left",i)}static setRect(e,{x:t,y:i,width:r,height:s}){D.setTopLeft(e,i,t),D.setLength(e,"width",r),D.setLength(e,"height",s)}static setTranslateXY(e,t,i){if(t==null)return D.setTranslateY(e,i);if(i==null)return D.setTranslateX(e,t);t=D.roundPx(t),i=D.roundPx(i);const r=D.getStyleValue(e,"transform").split(/,\s*/),s=r[0].startsWith("matrix3d");r.length>1?(r[s?12:4]=t,r[s?13:5]=i,e.style.transform=r.join(",")+")"):e.style.transform=`translate(${t}px, ${i}px)`}static addTranslateX(e,t){D.setTranslateX(e,D.getTranslateX(e)+t)}static addTranslateY(e,t){D.setTranslateY(e,D.getTranslateY(e)+t)}static addLeft(e,t){D.setLeft(e,D.getOffsetX(e)+t)}static addTop(e,t){D.setTop(e,D.getOffsetY(e)+t)}static alignTo(e,t,i=Sa,r){t=t instanceof V?t:V.from(t,!0);const s=D.getTranslateXY(e),n=V.from(e,!0);r&&(n.roundPx(),t.roundPx());const l=n.alignTo(Object.assign(i,{target:t}));D.setTranslateXY(e,s[0]+l.x-n.x,s[1]+l.y-n.y)}static getStyleValue(e,t,i,r){const s=i?e.style:e.ownerDocument.defaultView.getComputedStyle(e,r);if(Array.isArray(t)){const n={};for(const l of t)n[l]=s.getPropertyValue(k.hyphenate(l));return n}return s.getPropertyValue(k.hyphenate(t))}static getEdgeSize(e,t,i){const r=t==="border"?"-width":"",s={raw:{}};for(const n of["top","right","bottom","left"])(!i||i.includes(n[0]))&&(s[n]=parseFloat(s.raw[n]=D.getStyleValue(e,`${t}-${n}${r}`)));return s.width=(s.left||0)+(s.right||0),s.height=(s.top||0)+(s.bottom||0),s}static parseStyle(e){if(typeof e=="string"){const t=e.split(Oa);e={};for(let i=0,{length:r}=t;i<r;i++){const s=t[i].split(La);e[s[0]]=s[1]}}return e||{}}static applyStyle(e,t,i=!1){if(typeof t=="string")i?(t.length||e.style.cssText.length)&&(e.style.cssText=t):e.style.cssText+=t;else if(t){i&&(e.style.cssText=""),t.style&&typeof t.style!="string"&&(t=w.assign({},t,t.style));let r,s;for(r in t)hn[r]||([r,s]=D.unitize(r,t[r]),s==null?e.style.removeProperty(r):e.style.setProperty(r,s));typeof t.style=="string"&&(e.style.cssText+=t.style)}}static getCSSText(e){if(typeof e=="string")return e;let t="";for(const i in e)hn[i]||(t+=`${k.hyphenate(i)}:${e[i]};`);return t}static addClasses(e,t){ne.deprecate("Core","6.0.0","DomHelper.addClasses should be replaced by native classList.add"),e.classList.add(...t)}static removeClasses(e,t){ne.deprecate("Core","6.0.0","DomHelper.removeClasses should be replaced by native classList.remove"),e.classList.remove(...t)}static toggleClasses(e,t,i=null){t=j.asArray(t),i===!0?e.classList.add(...t):i===!1?e.classList.remove(...t):t.forEach(r=>e.classList.toggle(r))}static addTemporaryClass(e,t,i,r=globalThis){i>0&&(e.classList.add(t),r.setTimeout({fn:s=>e.classList.remove(s),delay:i,name:t,args:[t],cancelOutstanding:!0}))}static getPropertyTransitionDuration(e,t){const i=globalThis.getComputedStyle(e),r=i.transitionProperty.split(", "),s=i.transitionDuration.split(", "),n=r.indexOf(k.hyphenate(t));let l;return n!==-1&&(l=parseFloat(s[n])*1e3),l}static getAnimationDuration(e){return parseFloat(D.getStyleValue(e,"animation-duration"))*1e3}static highlight(e,t=globalThis){return e instanceof V?e.highlight():new Promise(i=>{t.setTimeout(()=>{e.classList.add("b-fx-highlight"),t.setTimeout(()=>{e.classList.remove("b-fx-highlight"),i()},1e3)},0)})}static get scrollBarWidth(){if(Kt===null){const e=yn||(yn=D.createElement({parent:de.documentElement,style:"position:absolute;top:-9999em;height:100px;overflow-y:scroll"}));e.parentNode!==de.documentElement&&de.documentElement.appendChild(e),Kt=e.offsetWidth}return Kt}static get scrollBarPadElement(){return{className:"b-yscroll-pad",children:[{className:"b-yscroll-pad-sizer"}]}}static resetScrollBarWidth(){Kt=null}static measureText(e,t,i=!1,r=void 0){const s=D.getMeasureElement(t,r);s[i?"innerHTML":"innerText"]=e;const n=s.clientWidth;return s.className="",n}static measureSize(e,t,i=!0){if(!e)return 0;if(typeof e=="number")return e;if(!e.length)return 0;if(/^\d+(px)?$/.test(e))return parseInt(e);if(t){const r=D.getMeasureElement(t);r.innerHTML="",r.style.width=D.setLength(e);const s=i?r.offsetWidth:r.getBoundingClientRect().width;return r.style.width=r.className="",s}return/^\d+em$/.test(e)?parseInt(e)*wa:isNaN(e)?0:parseInt(e)}static getMeasureElement(e,t=de.body){const i=Ii.getComputedStyle(e),r=t.offScreenDiv=t.offScreenDiv||D.createElement({parent:t,style:"position:fixed;top:-10000px;left:-10000px;visibility:hidden;contain:strict",className:"b-measure-element",children:[{style:"white-space:nowrap;display:inline-block;will-change:contents;width:auto;contain:none"}]},{returnAll:!0})[1];return Va.forEach(s=>{r.style[s]!==i[s]&&(r.style[s]=i[s])}),r.className=e.className,r.parentElement.parentElement!==t&&t.appendChild(r.parentElement),r}static stripTags(e){return(D.$domParser||(D.$domParser=new DOMParser)).parseFromString(e,"text/html").body.textContent}static sync(e,t){if(typeof e=="string")if(e===""){t.innerHTML="";return}else e=D.createElementFromTemplate(e);return D.performSync(e,t),t}static performSync(e,t){return e.outerHTML!==t.outerHTML?(D.syncAttributes(e,t),D.syncContent(e,t),D.syncChildren(e,t),!0):!1}static getSyncAttributes(e){const t={},i=[];for(let r=0;r<e.attributes.length;r++){const s=e.attributes[r];if(s.specified){const n=s.name.toLowerCase();t[n]=s.value,i.push(n)}}return{attributes:t,names:i}}static syncAttributes(e,t){const{attributes:i,names:r}=D.getSyncAttributes(e),{attributes:s,names:n}=D.getSyncAttributes(t),l=r.includes("dataset"),o=r.filter(d=>!n.includes(d)),a=n.filter(d=>!r.includes(d)&&(!l||!d.startsWith("data-"))),c=r.filter(d=>n.includes(d));if(o.length>0)for(let d=0;d<o.length;d++){const f=o[d];f==="style"?D.applyStyle(t,i.style,!0):f==="dataset"?Object.assign(t.dataset,i.dataset):t.setAttribute(f,i[f])}if(a.length>0)for(let d=0;d<a.length;d++)t.removeAttribute(a[d]);if(c.length>0)for(let d=0;d<c.length;d++){const f=c[d];if(f==="style")D.applyStyle(t,i.style,!0);else if(f==="dataset")Object.assign(t.dataset,i.dataset);else if(f==="class"&&(i.class.isDomClassList||typeof i.class=="object")){let g;i.class.isDomClassList?g=i.class:g=new W(i.class),g.isEqual(s.class)||t.setAttribute("class",g)}else s[f]!==i[f]&&t.setAttribute(f,i[f])}}static syncContent(e,t){D.getChildElementCount(e)===0&&(t.innerText=e.innerText)}static setInnerText(e,t){const{firstChild:i}=e;(i==null?void 0:i.nodeType)===Element.TEXT_NODE?i.data=t:e.textContent=t}static syncChildren(e,t){const i=this,r=Er.call(e.childNodes),s=Er.call(t.childNodes);for(;r.length;){const n=r.shift(),l=s.shift();if(n&&n.nodeType!==Di&&n.nodeType!==Ut)throw new Error(`Source node type ${n.nodeType} not supported by DomHelper.sync()`);if(l&&l.nodeType!==Di&&l.nodeType!==Ut)throw new Error(`Target node type ${l.nodeType} not supported by DomHelper.sync()`);if(!l)t.appendChild(n);else if(n.nodeType===l.nodeType)n.nodeType===Di?l.data=n.data:n.tagName===l.tagName?i.performSync(n,l):(t.insertBefore(n,l),l.remove());else if(n.nodeType===Di&&l.nodeType===Ut)t.innerText=n.data.trim();else{const o=n.parentElement||n;throw new Error(`Currently no support for transforming nodeType.
${o.outerHTML}`)}}s.forEach(n=>{n.remove()})}static syncClassList(e,t){const{classList:i}=e,r=typeof t=="string",s=r?t.split(Ia):W.normalize(t,"array"),n=s.length;let l=i.length!==n,o;for(o=0;!l&&o<n;o++)l=!i.contains(s[o]);return l&&(e.className=r?t:s.join(" ")),l}static updateClassList(e,t){const{classList:i}=e;let r,s,n=!1;for(r in t)s=!!t[r],i.contains(r)!==s&&(i[s?"add":"remove"](r),n=!0);return n}static setTheme(e,t){e=e.toLowerCase();const{head:i}=document,r=D.getThemeInfo(t).name.toLowerCase();let s=i.querySelectorAll("[data-bryntum-theme]:not([data-loading])"),n=0;if(r===e)return Na;D.removeEachSelector(i,"#bryntum-theme[data-loading],link[data-bryntum-theme][data-loading]");const l={theme:e,prev:r};function o(a,c,d){const f=v.createElement({tag:"link",rel:"stylesheet",dataset:{loading:!0,bryntumTheme:!0},href:a.href.replace(r,e),nextSibling:a});f.addEventListener("load",()=>{delete f.dataset.loading,ht=null,++n===s.length&&(s.forEach(g=>g.remove()),ae.trigger("theme",l),c(l))}),f.addEventListener("error",g=>{delete f.dataset.loading,d(g)})}if(s.length)return new Promise((a,c)=>{s.forEach((d,f)=>{o(d,a,c,f===s.length-1)})});{const a=i.querySelector("#bryntum-theme:not([data-loading])")||i.querySelector(`[href*="${r}.css"]:not([data-loading])`);if(!(a!=null&&a.href.includes(`${r}.css`)))throw new Error(`Theme link for ${r} not found`);return s=[a],new Promise((c,d)=>o(a,c,d))}}static get themeInfo(){return v.getThemeInfo()}static getThemeInfo(e){if(!ht){const t=D.createElement({parent:document.body,className:"b-theme-info"}),i=D.getStyleValue(t,"content",!1,":before");if(i)try{ht=JSON.parse(i.replace(/^["']|["']$|\\/g,""))}catch(r){ht=null}ht=ht||(e?{name:e}:null),t.remove()}return ht}static async transition({element:e,selector:t="[data-dom-transition]",duration:i,action:r,thisObj:s=this,addTransition:n={},removeTransition:l={}}){const o=new Set,a=Array.from(e.querySelectorAll(t)),c=new Map(a.map(h=>{let p=0,m=h.parentElement;for(;m&&m!==e;)p++,m=m.parentElement;h.$depth=p,h.scrollHeight>h.offsetHeight&&getComputedStyle(h).overflow==="auto"&&(h.$scrollTop=h.scrollTop,o.add(h));const{parentElement:y}=h,b=V.from(h,e),C=V.from(h,y),E=getComputedStyle(y),S=parseFloat(E.borderLeftWidth);return S&&(b.left-=S,C.left-=S),[h.id,{element:h,globalBounds:b,localBounds:C,depth:p,parentElement:y}]}));r.call(s);const d=Array.from(e.querySelectorAll(t)),f=new Map(d.map(h=>{const p=V.from(h,e),m=V.from(h,h.parentElement),y=globalThis.getComputedStyle(h.parentElement),b=parseFloat(y.borderLeftWidth);return b&&(p.left-=b,m.left-=b),[h.id,{element:h,globalBounds:p,localBounds:m}]})),g=["position","top","left","width","height","padding","margin","zIndex","minWidth","minHeight","opacity","overflow"];for(const[h,p]of c){const m=f.get(h);if(m){const{element:y}=m,{style:b,parentElement:C}=y,E=parseInt(D.getStyleValue(y,"zIndex")),{globalBounds:S,localBounds:x,depth:L,parentElement:O}=p,P=O!==C;w.copyProperties(y.$initial={parentElement:C},b,g);let I;P?(m.bounds=m.globalBounds,I=S,e.appendChild(y)):(m.bounds=m.localBounds,I=x,O.appendChild(y));let G="hidden";o.has(y)&&(y.$scrollPlaceholder=D.createElement({parent:y,style:{height:y.scrollHeight}}),G="auto");const K={position:"absolute",top:`${I.top}px`,left:`${I.left}px`,width:`${I.width}px`,height:`${I.height}px`,minWidth:0,minHeight:0,margin:0,zIndex:L+(E||0),overflow:G};y.dataset.domTransition!=="preserve-padding"&&(K.padding=0),Object.assign(b,K),m.processed=!0}else{const{element:y,localBounds:b,depth:C,parentElement:E}=p;y.$initial={removed:!0},Object.assign(y.style,{position:"absolute",top:`${b.top}px`,left:`${b.left}px`,width:`${b.width}px`,height:`${b.height}px`,minWidth:0,minHeight:0,padding:0,margin:0,zIndex:C,overflow:"hidden"}),E.appendChild(y),f.set(h,{element:y,bounds:b,removed:!0,processed:!0}),d.push(y)}}for(const[,h]of f)if(!h.processed){const{element:p}=h,{style:m,parentElement:y}=p,b=h.bounds=h.localBounds;p.classList.add("b-dom-transition-adding"),w.copyProperties(p.$initial={parentElement:y},m,g),Object.assign(m,{position:"absolute",top:n.top?0:`${b.top}px`,left:n.left?0:`${b.left}px`,width:n.width?0:`${b.width}px`,height:n.height?0:`${b.height}px`,opacity:n.opacity?0:null,zIndex:y.$depth+1,overflow:"hidden"})}for(const h of o)h.scrollTop=h.$scrollTop;e.classList.add("b-dom-transition"),e.firstElementChild.offsetWidth;for(const[,{element:h,bounds:p,removed:m}]of f)m?Object.assign(h.style,{top:l.top?0:`${p.top}px`,left:l.left?0:`${p.left}px`,width:l.width?0:`${p.width}px`,height:l.height?0:`${p.height}px`,opacity:l.opacity?0:h.$initial.opacity}):Object.assign(h.style,{top:`${p.top}px`,left:`${p.left}px`,width:`${p.width}px`,height:`${p.height}px`,opacity:h.$initial.opacity});await gr.sleep(i),e.classList.remove("b-dom-transition");for(const h of d)h.$initial&&(h.$initial.removed?h.remove():(w.copyProperties(h.style,h.$initial,g),h.$scrollPlaceholder&&(h.$scrollPlaceholder.remove(),delete h.$scrollPlaceholder),h.classList.remove("b-dom-transition-adding"),h.$initial.parentElement.appendChild(h)));for(const h of o)h.scrollTop=h.$scrollTop,delete h.$scrollTop}static async loadScript(e){return new Promise((t,i)=>{const r=document.createElement("script");r.src=e,r.onload=t,r.onerror=i,document.head.appendChild(r)})}static isNamedColor(e){return e&&!/^(#|hsl|rgb|hwb)/.test(e)}static get NodeFilter(){return NodeFilter}static addChild(e,t,i){e.insertBefore(t,i)}static cloneStylesIntoShadowRoot(e,t){return new Promise((i,r)=>{t&&e.querySelectorAll('style, link[rel="stylesheet"]').forEach(l=>l.remove());const s=document.querySelectorAll('link[rel="stylesheet"]');let n=0;s.forEach(l=>{const o=l.cloneNode();o.addEventListener("load",()=>{n+=1,n===s.length&&i()}),o.addEventListener("error",a=>{r(o.href)}),e.appendChild(o)}),document.querySelectorAll("style").forEach(l=>{e.appendChild(l.cloneNode())})})}}const D=v;let vn;const qa=()=>D.isTouchEvent=!1,bn=()=>{D.isTouchEvent=!0,clearTimeout(vn),vn=setTimeout(qa,400)};if(de.addEventListener("touchstart",bn,!0),de.addEventListener("touchend",bn,!0),D.canonicalStyles=qt,D.supportsTemplate="content"in de.createElement("template"),D.elementPropKey=ka,D.numberRe=fn,!("children"in Node.prototype)){const u=e=>e.nodeType===e.ELEMENT_NODE;Object.defineProperty(Node.prototype,"children",{get:function(){return Array.prototype.filter.call(this.childNodes,u)}})}Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(u){const e=(this.document||this.ownerDocument).querySelectorAll(u);let t=e.length;for(;--t>=0&&e.item(t)!==this;);return t>-1}),Ii.Element&&!Element.prototype.closest?Node.prototype.closest=Element.prototype.closest=function(u){let e=this;if(!de.documentElement.contains(e))return null;do{if(e.matches(u))return e;e=e.parentElement||e.parentNode}while(e!==null&&e.nodeType===e.ELEMENT_NODE);return null}:Node.prototype.closest=function(u){var e;return(e=this.parentNode)===null||e===void 0?void 0:e.closest(u)},function(u){u.forEach(function(e){Object.prototype.hasOwnProperty.call(e,"remove")||Object.defineProperty(e,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode&&this.parentNode.removeChild(this)}})})}([Element.prototype,CharacterData.prototype,DocumentType.prototype]),globalThis.addEventListener("resize",()=>Kt=null),v._$name="DomHelper";const Ka=5,Ya=u=>u.floating,Ga={touchend:1,pointerup:1},Xa={Meta:1,Control:1,Alt:1},ae=new class extends $.mixin(Oe){suspendFocusEvents(){Oi=!0}resumeFocusEvents(){Oi=!1}setupFocusListenersOnce(e,t){e&&!ae.observedElements.has(e)&&(ae.setupFocusListeners(e,t),ae.observedElements.add(e))}setupFocusListeners(e=document,t,i=!1){var r;const s={element:e,touchstart(n){if(!ke&&n.changedTouches.length===1){if(ke=n.changedTouches[0],!B.isAndroid){const l=({clientX:c,clientY:d,type:f})=>{(Ga[f]||Math.max(Math.abs(c-ke.clientX),Math.abs(d-ke.clientY))>Ka)&&(Dr=null,o(),clearTimeout(a))},o=t.on({element:document,touchmove:l,touchend:l,pointermove:l,pointerup:l,capture:!0}),a=setTimeout(()=>{Dr=ke.identifier,o(),n.target.dispatchEvent(new MouseEvent("contextmenu",t.copyEvent({},n)))},t.longPressTime)}}else ke=null},touchend:{handler:n=>{ke&&(n.changedTouches[0].identifier===Dr?(n.stopImmediatePropagation(),n.cancelable!==!1&&n.preventDefault()):n.changedTouches.length===1&&n.changedTouches[0].identifier===ke.identifier&&ae.trigger("globaltap",{event:n}),ke=null)},passive:!1},mousedown:{handler:n=>{Li="mouse",ke||ae.trigger("globaltap",{event:n}),Tt=n;const l=n.ctrlKey||n.altKey||n.shiftKey||n.metaKey;!ye&&l?ye=new KeyboardEvent("keydown",{key:n.ctrlKey?"Control":n.shiftKey?"Shift":n.altKey?"Alt":"Meta",ctrlKey:n.ctrlKey,altKey:n.altKey,shiftKey:n.shiftKey,metaKey:n.metaKey}):ye&&!l&&(ye=null)},passive:!1},mouseup(){Tt=null},pointerdown:{passive:!1,handler:n=>{var l;Fi=n,v.usingKeyboard=!1,(l=e.classList)===null||l===void 0||l.remove("b-using-keyboard"),e.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&v.removeClsGlobally(e,"b-using-keyboard")}},pointerup:{passive:!1,handler:n=>{var l;((l=Fi)===null||l===void 0?void 0:l.pointerId)===n.pointerId&&(Fi=null)}},keydown(n){if(Li="key",ye=n,!Xa[n.key])if(v.usingKeyboard=!0,e.nodeType===Node.DOCUMENT_FRAGMENT_NODE)for(const l of e.children)l.matches(".b-outer")&&l.classList.add("b-using-keyboard");else e.classList.add("b-using-keyboard")},keypress(){Li="key"},keyup(){ye=null},focusin(n){var l,o;const{Widget:a}=ae;if((l=n.target)!==null&&l!==void 0&&l.shadowRoot||(o=n.target)!==null&&o!==void 0&&o._shadowRoot||(a.resetFloatRootScroll(),Oi))return;const c=n.relatedTarget?n.relatedTarget instanceof HTMLElement?n.relatedTarget:document.body:null,d=n.target||document.body,f=a.fromElement(c),g=a.fromElement(d),h=v.getCommonAncestor(f,g),p=!!(c&&d.compareDocumentPosition(c)&4),m=a.query(Ja);let y=null;if(d&&d!==document.body?y=v.getActiveElement(d):y=v.getActiveElement(document),m&&!m._isRevertingFocus&&(!g||!m.owns(g)&&!(m.element.compareDocumentPosition(g.element)&4&&g.up(Ya))))return m.focus();let b=Mr("focusout",c,n.target,f,g,p);for(let x=f,L;x&&x!==h;x=L)if(L=x.owner,!x.isDestroying&&x.onFocusOut&&(x.onFocusOut(b),n.target&&y!==v.getActiveElement(n.target)))return;if(h&&n.target===h.element)!h.isDestroying&&v.getActiveElement(h)===d&&h.focusElement&&h.focusElement!==h.element&&(!h.element.contains(y)||h.focusDescendant)&&h.setTimeout(()=>{var x;return(x=h.focus)===null||x===void 0?void 0:x.call(h)},0);else{b=Mr("focusin",d,c,f,g,p);for(let x=g;x&&x!==h;x=x.owner)if(!x.isDestroying){var C,E;(C=(E=x).onFocusIn)===null||C===void 0||C.call(E,b)}}const S=v.getCommonAncestor((c==null?void 0:c.nodeType)===Element.ELEMENT_NODE?c:null,d)||d.parentNode;S&&(b=Mr("focusmove",d,c,f,g,p,{bubbles:!0}),S.dispatchEvent(b))},focusout(n){if(!Oi&&(!n.relatedTarget||!ae.Widget.fromElement(n.relatedTarget))){const l=n.relatedTarget&&n.relatedTarget instanceof HTMLElement?n.relatedTarget:null;s.focusin({target:l,relatedTarget:n.target}),ye=Tt=null}},blur:{element:globalThis,handler(n){n.target===globalThis&&(ye=null,Tt=null)}},capture:!0,passive:!0};i&&((r=Cn)===null||r===void 0||r()),Cn=this.detachEvents=t.on(s)}get lastInteractionType(){return Li}get shiftKeyDown(){var e;return(e=ye)===null||e===void 0?void 0:e.shiftKey}get ctrlKeyDown(){var e,t;return((e=ye)===null||e===void 0?void 0:e.ctrlKey)||((t=ye)===null||t===void 0?void 0:t.metaKey)}get altKeyDown(){var e;return(e=ye)===null||e===void 0?void 0:e.altKey}isKeyDown(e){var t;return e?((t=ye)===null||t===void 0?void 0:t.key)===e||ye[(e==null?void 0:e.toLowerCase())+"Key"]===!0:!!ye}isMouseDown(e=0){var t;return((t=Tt)===null||t===void 0?void 0:t.button)===e}get currentMouseDown(){return Tt}get currentPointerDown(){return Fi}get currentTouch(){return ke}get currentKeyDown(){return ye}},Ja=u=>u.isVisible&&u.isTopModal;ae.observedElements=new Set;let ke,Dr,Oi=!1,Li,ye,Tt,Fi,Cn;function Mr(u,e,t,i,r,s,n){const l=new CustomEvent(u,n);return Object.defineProperty(l,"_target",{get(){return e}}),Object.defineProperty(l,"relatedTarget",{get(){return t}}),l.fromWidget=i,l.toWidget=r,l.backwards=s,l}function Za(u,e){const t=w.getPropertyDescriptor(u,e);return t&&(t.get||t.set)?t:null}class xt extends $.mixin(Oe,Bt){static get configurable(){return{clientListeners:null,disabled:!1,client:null,keyMap:null}}updateClient(e){this.owner||(this.owner=e)}updateKeyMap(e){const{client:t}=this;t.keyMap=t.mergeKeyMaps(t.keyMap,e,k.uncapitalize(this.constructor.$name))}static initPlugins(e,...t){const i=e.plugins||(e.plugins={});for(const r of t)i[r.$$name]=new r(e)}get enabled(){return!this.disabled}getFocusRevertTarget(){var e;return(e=this.client)===null||e===void 0?void 0:e.getFocusRevertTarget()}construct(...e){const t=this;let[i,r]=e,s;e.length===1?w.isObject(i)&&(r=i,i=r.client):(r=w.assign({},r),delete r.client),t.client=i,super.construct(r),t.applyPluginConfig(i),s=t.clientListeners,s&&(s=w.assign({},s),s.thisObj=t,i.ion(s))}applyPluginConfig(e){const t=this,i=t.pluginConfig||t.constructor.pluginConfig;if(i){const{assign:r,chain:s,after:n,before:l,override:o}=i;r&&t.applyAssign(e,r),(s||n)&&t.applyChain(e,s||n),l&&t.applyChain(e,l,!1),o&&t.applyOverride(e,o)}}applyAssign(e,t){t.forEach(i=>this.assign(e,i))}applyChain(e,t,i=!0){if(Array.isArray(t))for(const r of t)this.chain(e,r,r,i);else for(const r in t)this.chain(e,r,t[r],i)}applyOverride(e,t){const i=this;i.overridden||(i.overridden={}),t.forEach(r=>{if(!i[r])throw new Error(`Trying to chain fn ${e.$$name}#${r}, but plugin fn ${i.$$name}#${r} does not exist`);typeof e[r]=="function"&&(i.overridden[r]=e[r].bind(e)),e[r]=i[r].bind(i)})}assign(e,t){const i=this,r=Za(i,t);r?Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get:r.get&&r.get.bind(i),set:r.set&&r.set.bind(i)}):e[t]=i[t].bind(i)}chain(e,t,i,r=!0){let s=0;typeof t=="object"&&(t=t.fn),typeof i=="object"&&(s=i.prio||0,i=i.fn);const n=this,l=e.pluginFunctionChain||(e.pluginFunctionChain={}),o=n[i]&&n[i].bind(n),a=n.functionChainRunner;if(!o)throw new Error(`Trying to chain fn ${e.$$name}#${i}, but plugin fn ${n.$$name}#${i} does not exist`);if(!l[t]){let c=e[t];c&&(c=c.bind(e),c.$this=e,c.$prio=0),l[t]=c?[c]:[],e[t]=(...d)=>a(l[t],d)}o.$this=n,o.$prio=s,l[t][r?"push":"unshift"](o),l[t].$sorted=!1}functionChainRunner(e,t){let i,r,s;for(e.$sorted||(e.sort((n,l)=>l.$prio-n.$prio),e.$sorted=!0),r=0;r<e.length&&(i=e[r],!(!i.$this.isDestroyed&&(s=i(...t),s===!1)));r++);return s}doDisable(e){const t=this,{constructor:i}=t,r="featureClass"in i?i.featureClass:`b-${i.$$name.toLowerCase()}`,s=k.uncapitalize(i.$$name);if(r){var n,l;(n=t.client)===null||n===void 0||(l=n._element)===null||l===void 0||l.classList[e?"remove":"add"](r)}if(!t.isConfiguring){var o,a;e?t.trigger("disable"):t.trigger("enable"),(o=(a=t.client).syncSplits)===null||o===void 0||o.call(a,c=>{const d=c.features[s];d&&(d.disabled=e)})}}updateDisabled(e){this.doDisable(e)}throwOverrideIsMissing(e){throw new Error(`Trying to override fn ${e.plugIntoName}#${e.fnName}, but plugin fn ${e.pluginName}#${e.fnName} does not exist`)}get rootElement(){return this.client.rootElement}}R(xt,"$name","InstancePlugin"),xt._$name="InstancePlugin";var wn=u=>class extends(u||$){static get $name(){return"Pluggable"}get plugins(){return this._plugins||(this._plugins={}),this._plugins}set plugins(t){t&&(Array.isArray(t)||(t=[t]),xt.initPlugins(this,...t)),this.initPlugins()}initPlugins(){}addPlugins(...t){xt.initPlugins(this,...t)}hasPlugin(t){return this.getPlugin(t)!=null}getPlugin(t){var i;return typeof t=="function"&&(t=t.$$name),(i=this.plugins)===null||i===void 0?void 0:i[t]}get widgetClass(){}};const{defineProperty:Ir}=Reflect;let ki;B.isBrowserEnv?ki=globalThis.performance:ki={now(){return new Date().getTime()}};let le=null;if(ne.isTestEnv){const u=globalThis.bryntum||(globalThis.bryntum={});le=u.globalDelays={timeouts:new Map,intervals:new Map,animationFrames:new Map,idleCallbacks:new Map,isEmpty(e=!1){return le.timeouts.size+le.animationFrames.size+le.idleCallbacks.size+(e?le.intervals.size:0)===0},getFiltered({ignoreTimeouts:e=[],maxDelay:t=5e3,includeIntervals:i=!1}){const r=[],s=["timeouts","animationFrames","idleCallbacks"];i&&s.push("intervals");for(const n of s){const l=le[n];for(const[,o]of l.entries())!e.includes(o.name)&&(!Number.isInteger(o.delay)||o.delay<t)&&r.push(o)}return r}}}const Yt=(u,e,t,i)=>{const r=typeof e=="string",s=(i==null?void 0:i.appendArgs)||[],n=()=>{t.timerId=null,t.lastCallTime=ki.now();const l=t.args;t.args=null,r?u[e](...l,...s):e.call(u,...l,...s),t.called=!0,++t.calls};return i&&(u=i.thisObj||u),t.lastCallTime=-9e9,t.calls=0,t.invoker=n,n.wrapFn=t,n},$i=(u,e,t="clearTimeout")=>(e.cancel=()=>{e.isPending&&(u[t](e.timerId),e.args=e.timerId=null)},e.flush=()=>{e.isPending&&(u[t](e.timerId),e.timerId=null,e.invoker())},e.now=(...i)=>{e.cancel(),e.args=i,e.invoker()},e.resume=i=>{const r=e.suspended;e.suspended=i||r<1?0:r-1},e.suspend=()=>{++e.suspended},e.immediate=!1,e.suspended=0,e.timerId=null,Ir(e,"isPending",{get(){return e.timerId!==null}}),e);var rt=u=>class extends(u||$){static get $name(){return"Delayable"}static get declarable(){return["delayable"]}doDestroy(){const t=this;super.doDestroy(),t.timeoutIds&&(t.timeoutIds.forEach((i,r)=>{var s;typeof i=="function"&&i(),clearTimeout(r),(s=le)===null||s===void 0||s.timeouts.delete(r)}),t.timeoutIds=null),t.timeoutMap&&(t.timeoutMap.forEach((i,r)=>clearTimeout(r)),t.timeoutMap=null),t.intervalIds&&(t.intervalIds.forEach(i=>{var r;clearInterval(i),(r=le)===null||r===void 0||r.intervals.delete(i)}),t.intervalIds=null),t.animationFrameIds&&(t.animationFrameIds.forEach(i=>{var r;cancelAnimationFrame(i),(r=le)===null||r===void 0||r.animationFrames.delete(i)}),t.animationFrameIds=null),t.idleCallbackIds&&(t.idleCallbackIds.forEach(i=>{var r;cancelIdleCallback(i),(r=le)===null||r===void 0||r.idleCallbacks.delete(i)}),t.idleCallbackIds=null)}hasTimeout(t){var i;return!!(!((i=this.timeoutMap)===null||i===void 0)&&i.has(t))}setTimeout({fn:t,delay:i,name:r,runOnDestroy:s,cancelOutstanding:n,args:l}){var o;(arguments.length>1||typeof arguments[0]=="function")&&([t,i,r,s]=arguments),typeof t=="string"?r=t:r||(r=t.name||t),n&&this.clearTimeout(r);const a=this,c=a.timeoutIds||(a.timeoutIds=new Map),d=a.timeoutMap||(a.timeoutMap=new Map),f=setTimeout(()=>{var g;typeof t=="string"&&(t=a[r]),c==null||c.delete(f),d==null||d.delete(r),(g=le)===null||g===void 0||g.timeouts.delete(f),t.apply(a,l)},i);return c.set(f,s?t:!0),(o=le)===null||o===void 0||o.timeouts.set(f,{fn:t,delay:i,name:r}),r&&d.set(r,f),f}clearTimeout(t){var i,r;let s=t;if(typeof s=="string")if(this.timeoutMap)s=this.timeoutMap.get(t),this.timeoutMap.delete(t);else return;clearTimeout(s),(i=this.timeoutIds)===null||i===void 0||i.delete(s),(r=le)===null||r===void 0||r.timeouts.delete(s)}clearInterval(t){var i,r;clearInterval(t),(i=this.intervalIds)===null||i===void 0||i.delete(t),(r=le)===null||r===void 0||r.intervals.delete(t)}setInterval(t,i,r){var s;const n=setInterval(t,i);return(this.intervalIds||(this.intervalIds=new Set)).add(n),(s=le)===null||s===void 0||s.intervals.set(n,{fn:t,delay:i,name:r}),n}requestAnimationFrame(t,i=[],r=this){var s;const n=this.animationFrameIds||(this.animationFrameIds=new Set),l=requestAnimationFrame(()=>{var o;(o=le)===null||o===void 0||o.animationFrames.delete(l),n.delete(l)&&t.apply(r,i)});return n.add(l),(s=le)===null||s===void 0||s.animationFrames.set(l,{fn:t,extraArgs:i,thisObj:r}),l}requestIdleCallback(t,i=[],r=this){var s;const n=this.idleCallbackIds||(this.idleCallbackIds=new Set),l=requestIdleCallback(()=>{var o;(o=le)===null||o===void 0||o.idleCallbacks.delete(l),n.delete(l)&&t.apply(r,i)});return n.add(l),(s=le)===null||s===void 0||s.idleCallbacks.set(l,{fn:t,extraArgs:i,thisObj:r}),l}createOnFrame(t,i=[],r=this,s){let n;const l=(...o)=>{n!=null&&s&&(this.cancelAnimationFrame(n),n=null),n==null&&(n=this.requestAnimationFrame(()=>{typeof t=="string"&&(t=r[t]),n=null,o.push(...i),t.apply(r,o)}))};return l.cancel=()=>this.cancelAnimationFrame(n),l}cancelAnimationFrame(t){var i,r;cancelAnimationFrame(t),(i=this.animationFrameIds)===null||i===void 0||i.delete(t),(r=le)===null||r===void 0||r.animationFrames.delete(t)}cancelIdleCallback(t){var i,r;cancelIdleCallback(t),(i=this.idleCallbackIds)===null||i===void 0||i.delete(t),(r=le)===null||r===void 0||r.idleCallbacks.delete(t)}async nextAnimationFrame(){return new Promise(t=>this.requestAnimationFrame(t))}buffer(t,i){let r=i;i&&typeof i!="number"?r=i.delay:i=null;const s=(...l)=>{if(s.suspended)return;const{delay:o}=s;s.cancel(),s.called=!1,s.args=l,s.immediate||!o?n():s.timerId=this.setTimeout(n,o)},n=Yt(this,t,s,i);return s.delay=r,$i(this,s)}raf(t,i){let r=i;i&&typeof i!="boolean"?r=i.cancelOutstanding:i=null;const s=(...l)=>{s.suspended||(s.cancelOutstanding&&s.cancel(),s.called=!1,s.args=l,s.immediate?n():s.isPending||(s.timerId=this.requestAnimationFrame(n)))},n=Yt(this,t,s,i);return s.cancelOutstanding=r,$i(this,s,"cancelAnimationFrame")}idle(t,i){let r=i;i&&typeof i!="boolean"?r=i.cancelOutstanding:i=null;const s=(...l)=>{s.suspended||(s.cancelOutstanding&&s.cancel(),s.called=!1,s.args=l,s.immediate?n():s.isPending||(s.timerId=this.requestIdleCallback(n)))},n=Yt(this,t,s,i);return s.cancelOutstanding=r,this.setTimeout(()=>this.idleCallbackIds.delete(s.timerId)&&s.now(),100),$i(this,s,"cancelIdleCallback")}throttle(t,i){let r=i,s;i&&typeof i!="number"?(r=i.delay,s=i.throttled):i=null;const n=this,l=(...a)=>{if(l.suspended)return;const{delay:c}=l,d=ki.now()-l.lastCallTime;l.args=a,l.immediate||d>=c?(n.clearTimeout(l.timerId),o()):(l.isPending||(l.timerId=n.setTimeout(o,c-d),l.called=!1),s&&(s.wrapFn.args=a,s()))},o=Yt(n,t,l,i);return l.delay=r,s&&(s=Yt(n,s,()=>{},i)),$i(n,l)}static setupDelayable(t){t.setupDelayableMethods(t.delayable)}static setupDelayableMethods(t,i=null){const r=this,s=t.static,n=i||r.prototype;s&&delete t.static;for(const l in t){let o=t[l];const a=l+"Now",c=typeof o;n[a]||(n[a]=n[l]),c==="number"?o={type:"buffer",delay:o}:c==="string"&&(o={type:o}),Ir(n,l,{get(){const d=this[o.type]((...f)=>{this[a](...f)},o);return Ir(this,l,{value:d}),d}})}}get widgetClass(){}};class Dt{get data(){return Object.create(null)}get keys(){return[]}clear(){}getItem(e){return null}removeItem(e){}setItem(e,t){}}Dt._$name="StateStorage";class Qa extends Dt{constructor(e){super(),this.prefix=e.prefix||""}get isLocal(){return!0}get data(){const e=Sn(),t=this.keys;for(const i of t)e[i]=this.getItem(i);return e}get keys(){return En(this.prefix,this.prefix.length)}clear(){const e=En(this.prefix);for(const t of e)localStorage.removeItem(t)}getItem(e){const t=localStorage.getItem(this.prefix+e);return t===null?t:JSON.parse(t)}removeItem(e){return localStorage.removeItem(this.prefix+e)}setItem(e,t){return localStorage.setItem(this.prefix+e,JSON.stringify(t))}}class ec extends Dt{constructor(){super(),this.clear()}get isMemory(){return!0}get data(){return w.clone(this._data)}get keys(){return Object.keys(this._data)}clear(){this._data=Sn()}getItem(e){return e in this._data?this._data[e]:null}removeItem(e){delete this._data[e]}setItem(e,t){this._data[e]=t}}const Sn=()=>Object.create(null),En=(u,e=0)=>{const t=[],i=localStorage.length;for(let r,s=0;s<i;++s)r=localStorage.key(s),r.startsWith(u)&&t.push(r.slice(e));return t},Tn=new Dt,Or={local:Qa,memory:ec};class wt extends $.mixin(rt,Oe){static get $name(){return"StateProvider"}static get configurable(){return{prefix:"bryntum-state:",storage:"local"}}static get delayable(){return{writeStatefuls:50}}static get instance(){return this._instance}static set instance(e){e==null?e=xn:((typeof e=="string"||w.isClass(e)||e instanceof Dt)&&(e={storage:e}),w.isObject(e)&&(e=new wt(e))),this._instance=e}static setup(e){return this.instance=e,this.instance}doDestroy(){self.writeStatefuls.flush(),super.doDestroy()}get data(){return this.storage.data}set data(e){if(!e)this.clear();else for(const t in e)this.setValue(t,e[t])}clear(){return this.storage.clear(),this}changeStorage(e){if(e==null)e=Tn;else{if(typeof e=="string"){if(!Or[e])throw new Error(`Invalid storage type "${e}" (expected one of: "${Object.keys(Or).join('", "')}")`);e=Or[e]}w.isClass(e)&&(e=new e(this))}return e}saveStateful(e,t){(this.pendingSaves||(this.pendingSaves=[])).push([e,t]),this.writeStatefuls()}writeStatefuls(){const e=this,{pendingSaves:t}=e,i=t==null?void 0:t.length,r=[],s=[];if(e.pendingSaves=null,i){for(let n,l,o,a=0;a<i;++a)[l,n]=t[a],!l.isDestroying&&l.isSaveStatePending&&(o=l.saveState({...n,immediate:!0}),o&&(r.push(o),s.push(l)));r.length&&e.trigger("save",{stateIds:r,saved:s})}}getValue(e){return this.writeStatefuls.flush(),this.storage.getItem(e)}setValue(e,t){const i=this,{storage:r}=i,s=i.getValue(e);return t!=null?(r.setItem(e,t),i.trigger("set",{key:e,value:t,was:s})):s!==null&&(r.removeItem(e),i.trigger("remove",{key:e,was:s})),i}}const xn=new wt({storage:Tn});wt._instance=xn,wt._$name="StateProvider";const tc=/boolean|number|string/;var Lr=u=>{var e;return e=class extends(u||$){afterConstruct(){super.afterConstruct(),this.loadState()}finalizeInit(){this.loadState(),super.finalizeInit()}get isStateful(){return!0}get isStatefulActive(){return!this.statefulSuspended&&!this.isResponsivePending&&!this.isResponsiveUpdating}get state(){return this._state=this.getState()}set state(i){this._state=i,i&&this.applyState(i)}updateStatefulEvents(i){const r=this,s={name:"statefulEvents",thisObj:r};if(r.detachListeners(s.name),i&&(typeof i=="string"?i=k.split(i):Array.isArray(i)||(i=w.getTruthyKeys(i)),i.length)){var n;for(const l of i)s[l]="onStatefulEvent";(n=r.ion)===null||n===void 0||n.call(r,s)}}get statefulId(){const i=this,{responsiveState:r}=i;let s=i.stateId;return s==null&&i.hasGeneratedId===!1&&i.stateful!==!1&&(s=i.id),s&&r&&(s=`${s}[${r}]`),s}get statefulness(){const{stateful:i}=this;return Array.isArray(i)?w.createTruthyKeys(i):i}get stateProvider(){return this._stateProvider||wt.instance}applyState(i){i=this.pruneState(i),i&&this.setConfig(i)}getState(){const i=this,{initialConfig:r,statefulness:s,isConstructing:n}=i,{configs:l}=i.$meta,o=n?Object.setPrototypeOf(r,i.$meta.config):i;let a=null,c,d;if(s){a={};for(c in s)if(s[c]){var f;if(d=o[c],(f=d)!==null&&f!==void 0&&f.isStateful)d=d.state;else if(!n&&(w.isDate(d)&&(d=N.format(d,"YYYY-MM-DDTHH:mm:ssZ")),l[c].equal(d,r==null?void 0:r[c])||!tc.test(typeof d)))continue;a[c]=d}}return a}loadState(i,r){typeof i=="boolean"&&(r=i,i=null);const s=this,{statefulLoaded:n}=s;if(s.isStatefulActive&&(r||!n)){const l=s.loadStatefulData(i||(i=s.statefulId));!n&&i&&(s.defaultState=s.state,s.statefulLoaded=!0),l&&(s.state=l)}}loadStatefulData(i){var r;return i=this.isStatefulActive?i||this.statefulId:null,i&&((r=this.stateProvider)===null||r===void 0?void 0:r.getValue(i))}resetDefaultState(){this.defaultState&&(this.state=this.defaultState)}resumeStateful(i=!1){this.statefulSuspended=i?0:Math.max(this.statefulSuspended-1,0)}saveState(i){typeof i=="string"?i={id:i}:i=i||{};const r=this,{stateProvider:s}=r,n=i.id||r.isStatefulActive&&r.statefulId;if(n&&s)return i.immediate?(r.isSaveStatePending=!1,s.setValue(n,r.state)):r.isSaveStatePending||(r.isSaveStatePending=!0,s.saveStateful(r,i)),n}suspendStateful(){++this.statefulSuspended}onConfigChange({name:i,value:r,was:s,config:n}){if(super.onConfigChange({name:i,value:r,was:s,config:n}),!this.isConstructing&&this.isStatefulActive&&this.statefulId){const{stateful:l}=this;(Array.isArray(l)?l.includes(i):l!=null&&l[i])&&this.saveState()}}onStatefulEvent(){this.isConstructing||this.saveState()}pruneState(i){const{statefulness:r}=this;if(r){const s={};for(const n in i)r[n]&&(s[n]=i[n]);i=s}return i}get widgetClass(){}},R(e,"$name","State"),R(e,"configurable",{stateful:{value:null,$config:{merge:"classList"}},statefulEvents:{$config:{merge:"classList"},value:["stateChange"]},stateId:null,stateProvider:null}),R(e,"prototypeProperties",{statefulLoaded:!1,statefulSuspended:0}),e};const Dn=w.getPathDefault(globalThis,"bryntum.idCounts",Object.create(null)),ic={string:1,number:1};var Gt=u=>class extends(u||$){static get $name(){return"Identifiable"}static get declarable(){return["identifiable"]}static get configurable(){return{id:""}}static setupIdentifiable(t,i){const{identifiable:r}=t;r.idMap=Object.create(null),Reflect.defineProperty(t,"identifiable",{get(){return r}})}doDestroy(){this.constructor.unregisterInstance(this),super.doDestroy()}changeId(t){return(this.hasGeneratedId=!t)?this.generateAutoId():t}updateId(t,i){const r=this,s=r.constructor;i&&s.unregisterInstance(r,i),(!r.hasGeneratedId||s.identifiable.registerGeneratedId!==!1)&&s.registerInstance(r,t)}generateAutoId(){return this.constructor.generateId(`b-${this.$$name.toLowerCase()}-`)}static get all(){return Object.values(this.identifiable.idMap)}static generateId(t="generatedId"){return t+(Dn[t]=(Dn[t]||0)+1)}static registerInstance(t,i=t.id){const{idMap:r}=this.identifiable;if(i in r&&!this.disableThrow)throw new Error("Id "+i+" already in use");r[i]=t}static unregisterInstance(t,i=t.id){const{idMap:r}=this.identifiable;ic[typeof t]?delete r[t]:r[i]===t&&delete r[i]}static getById(t){const i=this.identifiable.idMap;if(i)return i[t]}static get registeredInstances(){const t=this.identifiable.idMap;return t?Object.values(t):[]}};const Mn=Symbol("STM_PROP"),In={parentIndex:1};var On=u=>class extends(u||$){static get $name(){return"ModelStm"}static get defaultConfig(){return{stm:null}}joinStore(t){this.stm||(this.stm=t.stm)}unjoinStore(t,i=!1){var r;this.stm===t.stm&&(this.stm=null),(r=super.unjoinStore)===null||r===void 0||r.call(this,t,i)}get stm(){return this[Mn]}set stm(t){this[Mn]=t}beforeChronoFieldSet(t,i){var r;const s=this;return!s.inSetting&&(r=s.stm)!==null&&r!==void 0&&r.enabled&&!In[t]&&!s.constructor.nonPersistableFields[t]&&s.getFieldDefinition(t)?{[t]:{value:i,oldValue:s[t]}}:null}afterChronoFieldSet(t,i,r){r&&this.afterSet(t,i,!1,!1,r,!0)}shouldRecordFieldChange(t,i,r){const s=this.firstStore;return!(this.constructor.nonPersistableFields[t]||i==null&&r==null||i===r||i instanceof Date&&r instanceof Date&&i.getTime()===r.getTime()||t==="id"||t==="$PhantomId"||t==="parentId"&&s&&s.oldIdMap[i]===s.getById(r))}afterSet(t,i,r,s,n,l){const{stm:o}=this,a=this.constructor.nonPersistableFields;if(o!=null&&o.isBase&&o.enabled&&!In[t]&&!a[t]&&n){let c;const[d,f]=Object.keys(n).reduce((g,h)=>{const{value:p,oldValue:m}=n[h];return this.shouldRecordFieldChange(h,m,p)&&(c=!0,g[0][h]=p,g[1][h]=m),g},[{},{}]);c&&o.onModelUpdate(this,d,f,l)}}beforeInsertChild(t){var i;const r=((i=super.beforeInsertChild)===null||i===void 0?void 0:i.call(this,t))||[],{stm:s}=this;return s!=null&&s.enabled&&r.push(t.reduce((n,l)=>(l.root===this.root&&n.set(l,{parent:l.parent,index:l.parent?l.parentIndex:void 0}),n),new Map)),r}afterInsertChild(t,i,r,s){var n;const{stm:l}=this;if(l!=null&&l.enabled){const o=r.pop();s&&l.onModelInsertChild(this,t,s,o)}(n=super.afterInsertChild)===null||n===void 0||n.call(this,t,i,r,s)}beforeRemoveChild(t,i){const r=super.beforeRemoveChild?super.beforeRemoveChild(t,i):[],{stm:s}=this;return s!=null&&s.enabled&&!i&&r.push(t.reduce((n,l)=>(n.set(l,{parentIndex:l.parentIndex,orderedParentIndex:l.orderedParentIndex}),n),new Map)),r}afterRemoveChild(t,i,r){var s;const{stm:n}=this;if(n!=null&&n.enabled&&!r){const l=i.pop();t&&t.length&&n.onModelRemoveChild(this,t,l)}(s=super.afterRemoveChild)===null||s===void 0||s.call(this,t,i,r)}};const rc={includeFilteredOutRecords:!1},Fr=u=>(u=u||!1,typeof u=="boolean"&&(u={includeFilteredOutRecords:u}),u||rc);var Ln=u=>class extends(u||$){static get $name(){return"TreeNode"}static set convertEmptyParentToLeaf(t){t===!0?t={onLoad:!0,onRemove:!0}:t===!1&&(t={onLoad:!1,onRemove:!1}),this._convertEmptyParentToLeaf=t}constructor(...t){super(...t),this.children&&(this.orderedChildren=this.orderedChildren||[])}static get convertEmptyParentToLeaf(){return this._convertEmptyParentToLeaf||{onLoad:!1,onRemove:!1}}ingestChildren(t,i=this.stores){const{inProcessChildren:r,constructor:s}=this,n=i[0];if(t===!0)return r?!0:[];if(t){t=j.asArray(t);const l=t.length,o=[];for(let a=0,c;a<l;a++)c=t[a],c=c.isModel?c:n?n.createRecord(c,!1,!0):new s(c,null,null,!0),c=n?n.processRecord(c):c,o.push(c);if(this.children===!0&&n){const a=n.createSorterFn(n.sorters);o.sort(a)}return o}}processChildren(t=this.stores){const i=this,{meta:r}=i;i.inProcessChildren=!0;const s=i.ingestChildren(i.data[i.constructor.childrenField],t);if(s){const{convertEmptyParentToLeaf:n}=i.constructor;if(n===!0||n.onLoad?s.length:Array.isArray(s)){if(r.isLeaf=!1,i.children===!0)i.children=[];else if(s.length===0){i.children=s;return}i.insertChild(s)}else s===!0?(r.isLeaf=!1,i.children=!0):i.isRoot||(r.isLeaf=i.constructor.convertEmptyParentToLeaf.onLoad)}i.inProcessChildren=!1}ancestorsExpanded(t=this.firstStore){const{parent:i}=this;return!i||i.isExpanded(t)&&i.ancestorsExpanded(t)}isExpanded(t=this.firstStore){const i=this.instanceMeta(t.id);return Object.prototype.hasOwnProperty.call(i,"collapsed")||(i.collapsed=!this.expanded),!i.collapsed}get expanded(){return this.data.expanded}get childLevel(){let t=this,i=-1;for(;t&&!t.isRoot;)++i,t=t.parent;return i}get isLeaf(){return this.meta.isLeaf!==!1&&!this.isRoot}get isParent(){return!this.isLeaf}get isLoaded(){return this.isParent&&Array.isArray(this.children)}get descendantCount(){return this.getDescendantCount()}get visibleDescendantCount(){return this.getDescendantCount(!0)}getDescendantCount(t=!1,i=this.firstStore){const{children:r}=this;return!r||!Array.isArray(r)||t&&!this.isExpanded(i)?0:r.reduce((s,n)=>s+n.getDescendantCount(t),r.length)}get allChildren(){return this.getAllChildren(!1)}get allUnfilteredChildren(){return this.getAllChildren(!0)}getAllChildren(t=!1){const{[t?"unfilteredChildren":"children"]:i}=this;return!i||i===!0?[]:i.reduce((r,s)=>(r.push(s),r.push.apply(r,t?s.allUnfilteredChildren:s.allChildren),r),[])}get firstChild(){const{children:t}=this;return(t==null?void 0:t.length)&&t[0]||null}get lastChild(){const{children:t}=this;return(t==null?void 0:t.length)&&t[t.length-1]||null}get previousSiblingsTotalCount(){let t=this.previousSibling,i=this.parentIndex;for(;t;)i+=t.descendantCount,t=t.previousSibling;return i}get previousOrderedSibling(){var t;return(t=this.parent)===null||t===void 0?void 0:t.orderedChildren[this.orderedParentIndex-1]}get nextOrderedSibling(){var t;return(t=this.parent)===null||t===void 0?void 0:t.orderedChildren[this.orderedParentIndex+1]}get root(){var t;return((t=this.parent)===null||t===void 0?void 0:t.root)||this}get parentId(){return this.parent&&!this.parent.isAutoRoot?this.parent.id:null}set parentId(t){const i=this,{parent:r}=i,s=t===null?i.firstStore.rootNode:i.firstStore.getById(t);s===r||!r&&!s||(i.isBatchUpdating?i.meta.batchChanges.parentId=t:s?s.appendChild(i):i.parent.removeChild(i))}static set parentIdField(t){this._parentIdField=t,Object.defineProperty(this.prototype,t,{set:function(i){this.parentId=i},get:function(){return this.parentId}})}static get parentIdField(){return this._parentIdField||"parentId"}getChildren(t){let i;return t.includeFilteredOutRecords?i=this.unfilteredChildren||this.children:t.useOrderedTree?i=this.orderedChildren:i=this.children,i}traverse(t,i,r){r=Fr(r);const s=this,n=s.getChildren(r);i||t.call(s,s);for(let l=0,o=n==null?void 0:n.length;l<o;l++)n[l].traverse(t,!1,r)}traverseBefore(t,i,r){r=Fr(r);const s=this,n=s.getChildren(r);for(let l=0,o=n==null?void 0:n.length;l<o;l++)n[l].traverse(t,!1,r);i||t.call(s,s)}traverseWhile(t,i,r){r=Fr(r);const s=this;let n=i||t.call(s,s)!==!1;if(n){const l=s.getChildren(r);l!=null&&l.length&&(n=l.every(o=>o.traverseWhile(t,!1,r)))}return n}bubble(t,i=!1){let r=this;for(i||t.call(r,r);r.parent;)r=r.parent,t.call(r,r)}bubbleWhile(t,i=!1){let r=this,s=!0;for(i||(s=t.call(r,r));s&&r.parent;)r=r.parent,s=t.call(r,r);return s}contains(t,i=!1){return t&&typeof t=="object"&&(t=t.id),!this.traverseWhile(r=>r.id!=t,i)}getTopParent(t){let i;return t?(i=[],this.bubbleWhile(r=>(i.push(r),r.parent&&!r.parent.isRoot))):(i=null,this.bubbleWhile(r=>(i=r,r.parent&&!r.parent.isRoot))),i}appendChild(t,i=!1){return this.insertChild(t,null,i)}insertChild(t,i=null,r=!1,s={}){var m,y,b;var n,l,o,a;const c=this,d=Array.isArray(t);if(t=j.asArray(t),typeof i=="number"){var f;i=(m=(f=c.children)===null||f===void 0?void 0:f[i])!=null?m:null}if(!r&&!c.stores.every(C=>C.trigger("beforeAdd",{records:t,parent:c})!==!1))return null;t=c.ingestChildren(t);const g=(b=(y=(n=i)===null||n===void 0?void 0:n.parentIndex)!=null?y:(l=c.children)===null||l===void 0?void 0:l.length)!=null?b:0,h=(o=c.beforeInsertChild)===null||o===void 0?void 0:o.call(c,t),p=c.internalAppendInsert(t,i,r,s);return p.length&&c.convertToParent(r),(a=c.afterInsertChild)===null||a===void 0||a.call(c,g,t,h,p),d||!p?p:p[0]}convertToParent(t=!1){const i=this,r=i.isLeaf;i.meta.isLeaf=!1,i.children||(i.children=[]),r&&!i.root.isLoading&&!t&&i.signalNodeChanged({isLeaf:{value:!1,oldValue:!0}})}signalNodeChanged(t,i=this.stores){i.forEach(r=>{r.trigger("update",{record:this,records:[this],changes:t}),r.trigger("change",{action:"update",record:this,records:[this],changes:t})})}tryInsertChild(){return this.insertChild(...arguments)}internalAppendInsert(t,i,r,s){const n=this,{stores:l,root:o,children:a}=n,{firstStore:c}=o,{parentIdField:d}=n.constructor,f=n.id;let g,h,p,m,y,b;if(!o.isLoading&&c)for(b={},y=[],p=0;p<t.length;p++){const E=t[p];b[E.id]=E.root===o,y[p]=E.parentIndex}if(i&&i.parent!==n&&(i=null),a){const E=i?i.parentIndex:a.length;if(a[h=E]===t[0]||a[h=E-1]===t[0])for(g=!0,p=0;g&&p<t.length;p++)t[p]!==a[h+p]&&(g=!1)}if(g)return t;for(p=0;p<t.length;p++){var C;const E=t[p],S=E.parent;if(c&&!o.isLoading&&E.traverse(x=>{x.root===o&&(b[x.id]=!0)}),(S==null?void 0:S.removeChild(E,(C=b)===null||C===void 0?void 0:C[E.id],r,{isInserting:!0,...s}))===!1)m||(t=t.slice(),m=!0),t.splice(p--,1);else{E.parent=n,E.data[d]=f;const{meta:x}=E;x.modified[d]===f&&!S&&(x.oldParentId=f),S&&(x.oldParentId=S.id)}}if(t.length){Array.isArray(a)||(n.children=[]),Array.isArray(n.orderedChildren)||(n.orderedChildren=[]);const E=n.addToChildren(i,t,s);l.forEach(S=>{S.isChained||(t.forEach(x=>{x.joinStore(S)}),S.onNodeAddChild(n,t,E,b,r),t.forEach((x,L)=>{if(x.meta.oldParentId!=null&&!(n.inProcessChildren||n.isLoading)){const O={[d]:f,[n.getDataSource("parentIndex")]:x.parentIndex},P={},{modified:I,oldParentId:G}=x.meta,K=y[L];if(delete x.meta.oldParentId,n.id!==G&&(P[d]={value:f,oldValue:G}),x.parentIndex!==K&&(P.parentIndex={value:x.parentIndex,oldValue:K}),I[d]===n.id?Reflect.deleteProperty(I,d):d in I||(I[d]=G),b[x.id]){const H=S.getById(G);H.isLeaf&&!r&&H.signalNodeChanged({isLeaf:{value:!0,oldValue:!1}},[S])}x.afterChange(O,P)}x.traverse(O=>{!O.ignoreBag&&!O.isLinked&&S.updateModifiedBagForRecord(O)})}))})}return t}removeChild(t,i=!1,r=!1,s={}){var n,l;const o=this,a=[],c=o.isLeaf,{children:d,stores:f}=o;if(t=j.asArray(t),t=t.filter(h=>h.parent===o),!r){for(const h of f)if(!h.isChained&&h.trigger("beforeRemove",{parent:o,records:t,isMove:i})===!1)return!1}const g=(n=o.beforeRemoveChild)===null||n===void 0?void 0:n.call(o,t,i);for(const h of t){const{parentIdField:p}=h.constructor,{modified:m}=h.meta,y=h.parent?h.parent.id:null;!(p in m)&&!h.isLinked&&(m[p]=y);const b=o.removeFromChildren(h,s);f.forEach(C=>{if(!C.isChained){const{isRemoving:E}=C;C.isRemoving=!0,a.push(...C.onNodeRemoveChild(o,[h],b,{isMove:i,silent:r})),C.isRemoving=E}}),i||(h.parent=h.parentIndex=h.unfilteredIndex=h.nextSibling=h.previousSibling=null,h.data[p]=null)}return(o.unfilteredChildren||d).length===0&&o.constructor.convertEmptyParentToLeaf.onRemove&&!o.isRoot&&(o.meta.isLeaf=!0),o.isLeaf!==c&&!r&&!i&&o.signalNodeChanged({isLeaf:{value:!0,oldValue:!1}}),(l=o.afterRemoveChild)===null||l===void 0||l.call(o,t,g,i),a}clearParentId(){const t=this;Reflect.deleteProperty(t.data,t.parentIdField),Reflect.deleteProperty(t.originalData,t.parentIdField),t.meta.modified&&Reflect.deleteProperty(t.meta.modified,t.parentIdField)}replaceChildren(t){return this.clearChildren(),this.data[this.constructor.childrenField]=t,this.processChildren(),this.children}clearChildren(t=!1){const i=this,{stores:r}=i,s=i.unfilteredChildren||i.children;i.children=[],i.orderedChildren=[],s&&s!==!0&&(r.forEach(n=>{n.isChained||n.onNodeRemoveChild(i,s,0,{unfiltered:!0,silent:t})}),i.unfilteredChildren&&(i.unfilteredChildren=[]))}clear(){var t;const i=this,{stores:r}=i,s=(t=i.children)===null||t===void 0?void 0:t.slice();if(!(!i.isRoot||!s)){for(const n of r)if(!n.isChained&&n.trigger("beforeRemove",{parent:i,records:s,isMove:!1,removingAll:!0})===!1)return!1;i.children.length=0,i.unfilteredChildren&&(i.unfilteredChildren.length=0),r.forEach(n=>{s.forEach(l=>{l.stores.includes(n)&&l.unjoinStore(n),l.parent=l.parentIndex=l.nextSibling=l.previousSibling=null}),n.storage.suspendEvents(),n.storage.clear(),n.storage.resumeEvents(),n.added.clear(),n.modified.clear(),n.trigger("removeAll"),n.trigger("change",{action:"removeall"})})}}updateChildrenIndices(t,i,r=!1){let s=null;for(let n=0;n<t.length;n++){const l=t[n],o=l[i];i==="parentIndex"||i==="orderedParentIndex"?o===void 0||r?l.setData(i,n):o!==n&&l.set(i,n,!0):l[i]=n,i==="parentIndex"&&(l.previousSibling=s,s&&(s.nextSibling=l),n===t.length-1&&(l.nextSibling=null),s=l)}}addToChildren(t,i,r={}){var o;const s=this,n=[[s.children,"parentIndex",t],[s.unfilteredChildren,"unfilteredIndex",t],[s.orderedChildren,"orderedParentIndex",(o=r==null?void 0:r.orderedBeforeNode)!=null?o:(r==null?void 0:r.orderedParentIndex)!==void 0?s.orderedChildren[r==null?void 0:r.orderedParentIndex]:t]];for(const a of n){const[c,d,f]=a;if(c){var l;const g=f?d==="orderedParentIndex"?c.indexOf(f):f[d]:c.length;a.push(g),c.splice(g,0,...i),r!=null&&(l=r[d])!==null&&l!==void 0&&l.skip||s.updateChildrenIndices(c,d)}}return n[0][3]}removeFromChildren(t,i){const r=[[this.children,"parentIndex"],[this.unfilteredChildren,"unfilteredIndex"],[this.orderedChildren,"orderedParentIndex"]];for(const n of r){const[l,o]=n;if(l){const a=l.indexOf(t);if(n.push(a),a>-1){var s;l.splice(a,1),i!=null&&(s=i[o])!==null&&s!==void 0&&s.skip||this.updateChildrenIndices(l,o)}}}return r[0][2]}sortOrderedChildren(t=!0,i=!1){const r=[];return this.isLeaf||(this.orderedChildren.sort((s,n)=>{var l,o;if(i){const a=(l=s.meta.modified.orderedParentIndex)!=null?l:s.orderedParentIndex,c=(o=n.meta.modified.orderedParentIndex)!=null?o:n.orderedParentIndex,d=a-c;return d!==0&&(r.push(s),r.push(n)),d}else return s.orderedParentIndex-n.orderedParentIndex}),t&&this.orderedChildren.forEach(s=>{r.push(...s.sortOrderedChildren(t,i))}),this.updateChildrenIndices(this.orderedChildren,"orderedParentIndex",!0)),new Set(r)}unjoinStore(t,i=!1){var r;const s=this;s.unfilteredChildren&&(s.children=s.unfilteredChildren.slice(),s.unfilteredChildren=null),(r=super.unjoinStore)===null||r===void 0||r.call(this,t,i)}};const Fn={id:1,stores:1,parentIndex:1,parent:1,previousSibling:1,nextSibling:1,unfilteredIndex:1},sc={get(u,e){return e==="proxyMeta"?this.proxyMeta:e==="constructor"?u.constructor:e==="setData"?this.setDataOverride:e==="set"?this.setOverride:Fn[e]?this.proxyMeta.data[e]:Reflect.get(u,e,this.proxyRecord)},set(u,e,t){return Fn[e]?this.proxyMeta.data[e]=t:u[e]=t,!0},setDataOverride(u,e){u==="parentIndex"?this.proxyMeta.data.parentIndex=e:this.proxyMeta.originalRecord.setData(u,e)},setOverride(u,e,...t){u==="parentIndex"?this.proxyMeta.data.parentIndex=e:this.proxyMeta.originalRecord.set(u,e,...t)}};var kn=u=>{var e;return e=class extends(u||$){link(){if(this.isLinked)return this.$original.link();const i=this,r={...sc,proxyMeta:{originalRecord:i,data:{id:`${i.id}_link_${k.generateUUID()}`,stores:[]}}},s=new Proxy(i,r);return r.proxyRecord=s,(i.meta.linkedRecords||(i.meta.linkedRecords=[])).push(s),s}get isLinked(){var i;return!!(!((i=this.proxyMeta)===null||i===void 0)&&i.originalRecord)}get hasLinks(){return!!(!this.proxyMeta&&this.$links.length)}removeLink(i,r=null,s=!1){if(i.hasLinks)for(const n of i.$links.slice())r?j.include(r,n):n.remove(s);else i.isLinked&&j.remove(i.$original.$links,i)}beforeRemove(i){this.removeLink(this,i)}removeChild(i,r,s,n){if(!(n!=null&&n.isInserting)){i=j.asArray(i);for(const l of i)this.removeLink(l,null,s)}return super.removeChild(i,r,s,n)}get $originalId(){return this.$original.id}get $links(){var i;return(i=this.meta.linkedRecords)!=null?i:[]}},R(e,"$name","ModelLink"),e};const{defineProperty:$n}=Reflect,kr=Symbol("owner"),nc=/[\s,]+/;var Mt=u=>class extends(u||$){static get $name(){return"Factoryable"}static get declarable(){return["factoryable","alias","type"]}static register(t,i,r=globalThis.__BRYNTUM_EXAMPLE){const{factoryable:s}=this.initClass(),{caseless:n,registry:l}=s,o=k.split(t,nc);for(let a,c,d=0;d<o.length;++d){if(c=o[d],a=n?c.toLowerCase():c,!r&&a in l)throw new Error(`Type "${c}" already registered with ${s.class.name} factory`);l[c]=l[a]=i.initClass()}}static isA(t,i){return this.isType(t,i,!0)}static isType(t,i,r){const{factoryable:s}=this,{caseless:n,registry:l}=s,o=l[n?i.toLowerCase():i];return o?r?t instanceof o:t.constructor===o:!1}static setupAlias(t){t.register(t.alias,t)}static setupFactoryable(t,i){const r=i.super.class;let{factoryable:s}=t;s={caseless:!0,defaultType:null,extends:r.factoryable?[r]:null,typeKey:"type",...s},s.class=t,s.registry=Object.create(null),s.extends&&!Array.isArray(s.extends)&&(s.extends=[s.extends]),$n(t,"factoryable",{get(){return s}})}static setupType(t,i){const{type:r}=t;t.register(r,t,i.replaceType),$n(t.prototype,"type",{value:r})}static create(t,i){return this.reconfigure(null,t,i)}static reconfigure(t,i,r){const s=this,{factoryable:n}=s,{typeKey:l}=n;let o=r,a,c,d,f,g,h,p,m,y;if(r&&!w.isClass(r)&&(o=null,p=typeof r,p==="function"?h=r:p==="string"?o=r:w.isObject(r)?(a=r.cleanup,c=r.defaults,f=r.owner,h=r.setup,o=r.type,m=r.transform):f=r),m&&(i=typeof m=="string"?f[m](i):m(i)),y=i,typeof y=="string")i={};else if(i){if(i===!0&&(i={}),!w.isObject(i)){if(f&&i!==t&&(t==null?void 0:t[kr])===f){var b;typeof a=="string"?f[a](t):(b=a)===null||b===void 0||b(t),t.destroy()}return i}y=i[l]}if(y=y&&s.resolveType(y),t){if(i&&(!y||t.constructor===y))return l in i&&(i=w.assign({},i),delete i[l]),t.setConfig(i),t;if(f&&t[kr]===f){var C;typeof a=="string"?f[a](t):(C=a)===null||C===void 0||C(t),t.destroy()}}if(i){if(c){if(!(d=y)){if(!(d=c[l]||o||n.defaultType))throw new Error(`No default mergeType defined for ${n.class.name} factory`);d=s.resolveType(d)}d&&(i=d.mergeConfigs(c,i))}if(h){if(g=typeof h=="string"?f[h](i,y,c):h(i,y,c),g===null)return g;i=g||i}if(!y){if(!(y=i[l]||o||n.defaultType))throw new Error(`No default type defined for ${n.class.name} factory`);y=s.resolveType(y)}c&&!d&&(i=y.mergeConfigs(c,i)),l in i&&(i=w.assign({},i),delete i[l]),i=new y(i),f&&(i[kr]=f)}return i||null}static resolveType(t,i){if(typeof t!="string")return t;const{factoryable:r}=this,s=r.extends;let n=r.registry[r.caseless?t.toLowerCase():t],l;for(l=0;!n&&s&&l<s.length;++l)n=s[l].resolveType(t,!0);if(!n&&!i)throw new Error(`Invalid type name "${t}" passed to ${r.class.name} factory`);return n}};const{getOwnPropertyDescriptor:lc}=Reflect;class Le extends $.mixin(Mt){static get $name(){return"DataField"}static get type(){return"auto"}static get factoryable(){return{defaultType:"auto"}}static get prototypeProperties(){return{compare:null,compareItems:null,dataSource:null,alwaysWrite:!1,nullable:!0,nullText:null,nullValue:void 0,persist:!0,readOnly:!1,internal:!1,useProp:null}}construct(e){const t=this;e&&(t.name=e.name,Object.assign(t,e)),t.compare&&(t.compareItems=(i,r)=>t.compare(i==null?void 0:i[t.name],r==null?void 0:r[t.name]))}defineAccessor(e,t){const{name:i,dataSource:r}=this;!t&&i in e&&e.$meta.hierarchy.some(s=>{var n;return((n=lc(s.prototype,i))===null||n===void 0?void 0:n.enumerable)===!1})||Reflect.defineProperty(e,i,{configurable:!0,enumerable:!0,get:this.complexMapping?function(){return this.complexGet(i,r)}:function(){return this.batching&&i in this.meta.batchChanges?this.meta.batchChanges[i]:r in this.data?this.data[r]:this.data[i]},set(s){const n=this.$meta.fields.map[i];n&&n.readOnly||this.set(i,s)}})}isEqual(e,t){return w.isEqual(e,t)}print(e){return e==null?this.nullText:this.printValue(e)}printValue(e){return String(e)}}Le._$name="DataField";class Xt extends Le{isEqual(e,t){return e===t}getAt(e,t){return e.get(this.name)[t]}}R(Xt,"$name","ArrayDataField"),R(Xt,"type","array"),Xt.initClass(),Xt._$name="ArrayDataField";class $r extends Le{static get $name(){return"BooleanDataField"}static get type(){return"boolean"}static get alias(){return"bool"}static get prototypeProperties(){return{nullValue:!1}}isEqual(e,t){return e==null&&t==null?!0:super.isEqual(e,t)}convert(e){var t;return e==null?this.nullable?e:this.nullValue:((t=e.toLowerCase)===null||t===void 0?void 0:t.call(e))==="false"?!1:!!e}}$r.initClass(),$r._$name="BooleanDataField";class Rr extends Le{static get $name(){return"DateDataField"}static get type(){return"date"}static get prototypeProperties(){return{format:null}}convert(e){return e==null?this.nullable||(e=this.nullValue):e==="now"?e=new Date:e instanceof Date||(e=N.parse(e,this.format||N.defaultParseFormat),(!e||isNaN(e))&&(e=void 0)),e}serialize(e){return e instanceof Date&&(e=N.format(e,this.format||N.defaultFormat)),e}printValue(e){return N.format(e,this.format||N.defaultFormat)}}Rr.initClass(),Rr._$name="DateDataField";class Ri extends Le{static get $name(){return"StringDataField"}static get type(){return"string"}static get prototypeProperties(){return{nullValue:""}}convert(e){return e==null?this.nullable?e:this.nullValue:String(e)}}Ri.initClass(),Ri._$name="StringDataField";class Rn extends Ri{static get $name(){return"DurationUnitDataField"}static get type(){return"durationunit"}isEqual(e,t){return N.compareUnits(e,t)===0}}Rn.initClass(),Rn._$name="DurationUnitDataField";class Pr extends Le{static get $name(){return"IntegerDataField"}static get type(){return"integer"}static get alias(){return"int"}static get prototypeProperties(){return{nullValue:0,rounding:"round"}}convert(e){return e==null?this.nullable?e:this.nullValue:Math[this.rounding](Number(e))}}Pr.initClass(),Pr._$name="IntegerDataField";class Ar extends Le{static get $name(){return"ModelDataField"}static get type(){return"model"}static get prototypeProperties(){return{complexMapping:!0}}isEqual(e,t){return e&&t&&t instanceof e.constructor&&t.id==e.id}}Ar.initClass(),Ar._$name="ModelDataField";class _r extends Le{static get $name(){return"NumberDataField"}static get type(){return"number"}static get alias(){return"float"}static get prototypeProperties(){return{nullValue:0,precision:null}}isEqual(e,t){return isNaN(Number(e))&&isNaN(Number(t))||super.isEqual(e,t)}convert(e){if(e==null)return this.nullable?e:this.nullValue;if(e=Number(e),isNaN(e))return;let t=this.precision;return t?(t=10**t,e=Math.round(e*t)/t):t===0&&(e=Math.round(e)),e}}_r.initClass(),_r._$name="NumberDataField";class Nr extends Le{static get $name(){return"ObjectDataField"}static get type(){return"object"}static get prototypeProperties(){return{complexMapping:!0}}}Nr.initClass(),Nr._$name="ObjectDataField";class Jt extends Le{init(e,t){var i;const r=this,s=`${r.name}Store`,n={skipStack:!0,syncDataOnLoad:!0};if(r.store&&w.assign(n,r.store),r.modelClass&&(n.modelClass=r.modelClass),(i=t[`init${k.capitalize(s)}`])===null||i===void 0||i.call(t,n),!n.storeClass&&!r.storeClass)throw new Error(`Field '${r.name}' with type 'store' must have a storeClass configured`);const l=t.meta[s]=new(n.storeClass||r.storeClass)(n);r.complexMapping?w.setPath(e,r.dataSource,l):e[r.dataSource]=l,l.verifyNoGeneratedIds=!1,l.usesId=!l.count||!l.every(o=>o.hasGeneratedId),l.$currentValue=r.getValue(l),l.ion({change:({action:o})=>{const a=r.getValue(l);if(!l.$isSettingStoreFieldData){const c=l.$preserveCurrentDataset;l.$preserveCurrentDataset=r.subStore&&(o==="update"||o==="remove"||o==="add"),r.$isUpdatingRecord=!0,t.set(r.name,a),r.$isUpdatingRecord=!1,l.$preserveCurrentDataset=c}l.$currentValue=a}})}set(e,t,i){var o;var r;const s=this,n=`${s.name}Store`,{[n]:l}=i.meta;if(!l)return i.meta.initableValues.set(s,e),!1;l.$isSettingStoreFieldData||(l.$isSettingStoreFieldData=!0,e=(o=(r=i[`process${k.capitalize(n)}Data`])===null||r===void 0?void 0:r.call(i,e,i))!=null?o:e,l.$preserveCurrentDataset||(l.data=e),l.$isSettingStoreFieldData=!1,l.usesId=!l.count||!l.every(a=>a.hasGeneratedId))}serialize(e,t){const i=t.meta[`${this.name}Store`];return this.$isUpdatingRecord?this.getValue(i):i.$currentValue}getValue(e){return e.allRecords.map(t=>{const i=t.persistableData;return e.usesId||delete i.id,i})}isEqual(e,t){var i,r;return(i=e)!==null&&i!==void 0&&i.isStore&&(e=e.$currentValue),(r=t)!==null&&r!==void 0&&r.isStore&&(t=t.$currentValue),w.isDeeplyEqual(e,t)}getOldValue(e){const t=e.meta[`${this.name}Store`];return t?w.clone(t.$currentValue):null}getAt(e,t){const i=e.meta[`${this.name}Store`];return i==null?void 0:i.getAt(t)}}R(Jt,"$name","StoreDataField"),R(Jt,"type","store"),Jt.initClass(),Jt._$name="StoreDataField";const Pn=new RegExp(/^(.*?)\.(.*)/),An=/(.*)\[(.*)]\.?(.*)/,{defineProperty:oc}=Reflect,{hasOwn:Zt}=w,Ue=void 0,ac={children:1,data:1,meta:1},cc=["name","title","text","label","description"],uc={boolean:1,number:1,date:1,object:1},_n={parentId:1,$PhantomId:2,id:3},Zi=class extends $.mixin(On,Ln,kn){static get $name(){return"Model"}static get declarable(){return["fields"]}static get fields(){return[{name:"parentIndex",type:"number",persist:!1,internal:!0},{name:"orderedParentIndex",type:"number",persist:!1,internal:!0},{name:"readOnly",type:"boolean"},{name:"expanded",internal:!0}]}static set idField(e){this._assignedIdField=!0,this._idField=e}static get idField(){return this._idField}static set childrenField(e){this._childrenField=e}static get childrenField(){if(!this._childrenField){const e=this.fieldMap.children;this._childrenField=(e==null?void 0:e.dataSource)||"children"}return this._childrenField}get indexPath(){const e=[];let t=this,i=t.childLevel;for(t=this;t&&!t.isRoot;t=t.parent)e[i--]=t.parentIndex+1;return e}construct(e={},t=null,i=null,r=!1,s=!1,n=!1){var g;var l;const o=this,a=(g=j.asArray(t))!=null?g:[],{constructor:c,fieldMap:d}=o;let f=null;if(t=a[0],o.meta={modified:{},...c.metaConfig,...i},c.applyConfigs)for(const h in o.getDefaultConfiguration())f||(f={},(!o.useRawData||!o.useRawData.enabled)&&(e={...e})),h in e&&(e[h]!==void 0&&(f[h]=e[h]),delete e[h]);if(super.construct(f),r||c.exposeProperties(e,n),!Zt(c,"idFieldProcessed")){let h=o.meta.idField;h||(c._assignedIdField?h=c.idField:t&&(h=t.idField)),h&&h!==d.id.dataSource&&c.addField({name:"id",dataSource:h,internal:!0}),c._idField=d.id.dataSource,c.idFieldProcessed=!0}o._internalId=Zi._internalIdCounter++,o.stores=[],o.unjoinedStores=[],o.originalData||(o.originalData=e),o.data=c.processData(e,!1,t,o,s),!((l=o.meta.initableValues)===null||l===void 0)&&l.size&&o.assignInitables(),o.id==null&&o.setData("id",o.generateId(t)),o.data[c.childrenField]&&o.processChildren(a),o.generation=0}set isCreating(e){const t=this;!!t.meta.isCreating!==e&&(t.meta.isCreating=e,t.stores.forEach(i=>{i.onIsCreatingToggle(t,e)}))}get isCreating(){return!!this.meta.isCreating}equals(e){if(e instanceof this.constructor){for(let t=this.$meta.fields.defs,i=0,{length:r}=t;i<r;i++){const s=t[i],{name:n}=s;if(n!=="id"&&!s.isEqual(this.getValue(n),e.getValue(n)))return!1}return!0}return!1}get subclass(){return new this.constructor(Object.setPrototypeOf({id:Ue},this.data),this.stores[0],null,!0)}static processData(e,t=!1,i,r,s){const{fieldMap:n,defaultValues:l}=this,{useRawData:o={enabled:!1}}=i||{},a=s||o.enabled?e:w.clone(e);let c;if(t=t||o.disableDefaultValue||s,!t){for(c in l)if(a[c]===Ue){let d=l[c];Array.isArray(d)&&(d=d.slice()),a[c]=d}}if(!o.disableTypeConversion&&!s)for(c in n){const d=n[c],{name:f,dataSource:g}=d,h=g!==f,p=d.complexMapping,m=h&&(p?w.pathExists(e,g):g in e),y=f in e&&(!h||!m),b=!o.disableTypeConversion&&d.convert;if((y||b)&&(!t||y||m)){const C=y?a[f]:p?w.getPath(a,g):a[g],E=b?d.convert(C,e,r):C;p?w.setPath(a,g,E):a[g]=E,h&&delete a[f]}}return this.$meta.fields.initable.length&&this.initInitables(r,a),a}static setupClass(e){super.setupClass(e),e.fields||this.setupFields(this,e)}static setupFields(e,t){var n,l,o,a,c;const i=Zt(e,"fields")&&e.fields,r=t.super.fields,s=t.fields={defs:(n=r==null?void 0:r.defs.slice())!=null?n:[],exposedData:!1,defaults:r?{...r.defaults}:{},exposed:Object.create((l=r==null?void 0:r.exposed)!=null?l:null),ordinals:Object.create((o=r==null?void 0:r.ordinals)!=null?o:null),map:Object.create((a=r==null?void 0:r.map)!=null?a:null),sources:Object.create((c=r==null?void 0:r.sources)!=null?c:null)};Zt(e,"defaults")&&Object.assign(s.defaults,e.defaults),Zt(e,"idField")&&(e.addField({name:"id",dataSource:e.idField,internal:!0}),s.exposed[e.idField]=!0),i!=null&&i.length&&i.map(e.addField,e),s.initable=s.defs.filter(d=>d.init),e.exposeRelations()}static get defaultValues(){return this.$meta.fields.defaults}static get allFields(){return this.$meta.fields.defs}get allFields(){return this.$meta.fields.defs}static get fieldMap(){return this.$meta.fields.map}get fieldMap(){return this.$meta.fields.map}static get fieldDataSourceMap(){return this.$meta.fields.sources}static exposeProperties(e,t=!0){const i=this,r=i.$meta.fields,s=t?"exposed":"map";if(e&&i.autoExposeFields&&!r.exposedData){let n,l,o;for(n in e)!r[s][n]&&n!==i.childrenField&&(o=w.typeOf(e[n]),l={name:n,dataSource:n,fromData:!0},uc[o]&&(l.type=o),i.addField(l));r.exposedData=!0}i.exposeRelations()}static addField(e){if(e==null)return;typeof e=="string"&&(e={name:e});const t=this.initClass(),i=t.$meta.fields,{ordinals:r}=i,s=i.exposed,{name:n}=e,l=i.map[n],o=e.dataSource||(e.dataSource=n);let a,c;if(!l||e.type&&e.type!==l.type)a=Le.create(e),a.definedBy=l?l.definedBy:t,a.ordinal=l?l.ordinal:r[n]=i.defs.length;else{a=Object.create(l);for(c in e)c!=="type"&&(a[c]=e[c])}return a.owner=t,i.defs[a.ordinal]=a,i.map[n]=a,i.sources[o]||(i.sources[o]=a),o.includes(".")&&(a.complexMapping=!0),a.complexMapping?s[o.split(".")[0]]=!0:s[o]=!0,"defaultValue"in a&&(i.defaults[o]=a.defaultValue),ac[n]||a.defineAccessor(t.prototype),t._nonPersistableFields=null,t._alwaysWriteFields=null,a}static removeField(e){const t=this.initClass(),i=t.$meta.fields,r=i.map[e],{ordinals:s}=i,n=s[e];if(r){i.defs.splice(n,1),delete s[e],delete i.defaults[e],delete i.exposed[e],delete i.map[e],delete i.sources[r.dataSource];for(const l in s)s[l]>n&&--s[l];delete t.prototype[e]}}static exposeRelations(){const e=this;if(!Zt(e,"exposedRelations")&&e.relations){e.exposedRelations=[];for(const t in e.relations){const i=e.relations[t];i.relationName=t,e.exposedRelations.push(i),Reflect.ownKeys(e.prototype).includes(t)||oc(e.prototype,t,{enumerable:!0,get:function(){return this.getForeign(t)},set:function(r){this.setForeign(t,r,i)}})}}}static initInitables(e,t){const i=e.meta.initableValues=new Map;for(const r of this.$meta.fields.initable){const s=w.getPath(t,r.dataSource);s!==void 0&&i.set(r,s),!r.lazy&&r.init(t,e)}}assignInitables(){const{initableValues:e}=this.meta;for(const[t,i]of e)t.set(i,this.data,this)!==!1&&e.delete(t)}static get autoExposeFields(){return!0}static fieldSorter(e,t){return(_n[e]||100)-(_n[t]||100)}get fields(){return this.$meta.fields.defs}getFieldDefinition(e){return this.$meta.fields.map[e]}getFieldDefinitionFromDataSource(e){return this.$meta.fields.sources[e]}get fieldNames(){return Object.keys(this.data)}static getFieldDefinition(e){return this.$meta.fields.map[e]}static getFieldDataSource(e){var t;return((t=this.getFieldDefinition(e))===null||t===void 0?void 0:t.dataSource)||e}getDataSource(e){const t=this.constructor.getFieldDefinition(e);return(t==null?void 0:t.dataSource)||(t==null?void 0:t.name)}static processField(e,t,i){const r=this.fieldMap[e];return r!=null&&r.convert?r.convert(t,this.data,i):t}initRelations(){const e=this;e.constructor.exposedRelations&&e.stores.forEach(i=>{var r;i.modelRelations||i.initRelations();const s=[];(r=i.modelRelations)===null||r===void 0||r.forEach(n=>{s.push({related:e.initRelation(n),config:n})}),i.updateRecordRelationCache(e,s)})}initRelation(e){const t=this,i=t.get(e.foreignKey),r=i!==Ue&&typeof e.foreignStore!="string"&&e.foreignStore.getById(i),s=t.meta.relationCache||(t.meta.relationCache={});return s[e.relationName]=r||(i!=null?{id:i,placeHolder:!0}:null),r}removeRelation(e){const{relationName:t,foreignKey:i,nullFieldOnRemove:r}=e;this.meta.relationCache[t]&&(delete this.meta.relationCache[t],r&&this.setData(i,null))}getForeign(e){var t;return(t=this.meta.relationCache)===null||t===void 0?void 0:t[e]}setForeign(e,t,i){const r=Zi.asId(t);return this.set(i.foreignKey,r)}getRelationConfig(e){var t,i;return(t=this.firstStore)===null||t===void 0||(i=t.modelRelations)===null||i===void 0?void 0:i.find(r=>r.foreignKey===e)}flatGet(e,t){return this.batching&&e in this.meta.batchChanges?this.meta.batchChanges[e]:t in this.data?this.data[t]:this.data[e]}complexGet(e,t){return this.batching&&e in this.meta.batchChanges?this.meta.batchChanges[e]:w.getPath(this.data,t)}get(e){if(!e)return;const t=this,i=t.fieldMap[e];if(!i){if(e.includes("[")){const[,r,s,n]=e.match(An),l=t.fieldMap[r];if(l!=null&&l.getAt){t._thisIsAUsedExpression(t[r]);const o=l.getAt(t,s);return o&&n?o.isModel?o.getValue(n):o[n]:o}return null}if(e.includes("."))return w.hasPath(t.data,e)?t.complexGet(e,e):w.getPath(t,e)}return i!=null&&i.complexMapping?t.complexGet(e,i.dataSource):t.flatGet(e,(i==null?void 0:i.dataSource)||e)}getValue(e){if(e)return e in this?this[e]:this.get(e)}setValue(e,t){e in this?this[e]=t:this.set(e,t)}setData(e,t){var s,n;const{data:i,fieldMap:r}=this;if(typeof e=="string"){const l=r[e],o=(s=l==null?void 0:l.dataSource)!=null?s:e;l!=null&&l.set?l.set(t,this.data,this):l!=null&&l.complexMapping?w.setPath(i,o,t):i[o]=t}else{const l=Object.keys(e);for(let o=0;o<l.length;o++){const a=l[o],c=r[a],d=(n=c==null?void 0:c.dataSource)!=null?n:a;c!=null&&c.set?c.set(t,this.data,this):d&&(c!=null&&c.complexMapping?w.setPath(i,d,e[a]):i[d]=e[a])}}}getData(e){var r;const t=this.fieldMap[e],i=(r=t==null?void 0:t.dataSource)!=null?r:e;if(i)return t!=null&&t.complexMapping?w.getPath(this.data,i):this.data[i]}syncId(e){const t=this.id;if(t!==e){this.setData("id",e);const i={id:{value:e,oldValue:t}};this.afterChange(i,i)}}set(e,t,i=!1,r=!1,s=!1,n=!1,l=!0){const o=this;if(o.isBatchUpdating)return o.inBatchSet(e,t,i||o.$silenceBatch),null;{var a;const c=o.inSet(e,t,i,r,s,n,l);return(a=o.afterSet)===null||a===void 0||a.call(o,e,t,i,r,c),c}}fieldToKeys(e,t){return typeof e!="string"?w.assign({},e):{[e]:t}}inBatchSet(e,t,i){const r=this,{meta:s,constructor:n,fieldMap:l}=r,o={};let a,c=!1;if(typeof e!="string"?Object.keys(r.fieldToKeys(e,t)).forEach(d=>{a=l[d]||w,t=n.processField(d,e[d],r),a.isEqual(s.batchChanges[d],t)||(o[d]={value:t,oldValue:r.get(d)},s.batchChanges[d]=t,c=!0)}):(a=l[e]||w,a.isEqual(s.batchChanges[e],t)||(o[e]={value:t,oldValue:r.get(e)},s.batchChanges[e]=t,c=!0)),c&&(r.generation++,!i)){const d={action:"update",record:r,records:[r],changes:o};r.stores.forEach(f=>{f.trigger("batchedUpdate",{...d})}),r.forEachLinked((f,g)=>f.trigger("batchedUpdate",{...d,record:g,records:[g]}))}}inSet(e,t,i,r,s=!1,n=!1,l=!0){var S,x;const o=this,{data:a,meta:c,fieldMap:d,constructor:f}=o,{prototype:g,childrenField:h,relations:p}=f,m={},y=o.fieldToKeys(e,t),b=Object.keys(y).sort(f.fieldSorter);let C=!1;if(!i&&!o.triggerBeforeUpdate(y))return null;o.inSetting=!0;for(let L=0;L<b.length;L++){const O=b[L];if(O===h)continue;if(O.includes("[")){const[,A,q,he]=O.match(An),$e=o.fieldMap[A];if($e!=null&&$e.getAt){const Be=$e.getAt(o,q);Be.isModel?Be.set(he,y[O]):w.setPath(Be,he,y[O]);continue}}const P=O.includes(".");if(p&&P){const[,A,q]=O.match(Pn);if(p[A]){o[A].set(q,y[O]);continue}}const I=d[O],G=I||w,K=I==null?void 0:I.readOnly,H=(S=I==null?void 0:I.dataSource)!=null?S:O,J=!s&&!I&&O in g||(I==null?void 0:I.useProp),_=J?o[H]:I!=null&&I.complexMapping||P?w.getPath(a,H):a[H],U=f.processField(O,y[O],o),re=y[O]={value:U},Y=o.getRelationConfig(O);if(!K&&!G.isEqual(_,U)&&(!n||U!==void 0)){var E;o.generation++,re.oldValue=(x=I==null||(E=I.getOldValue)===null||E===void 0?void 0:E.call(I,o))!=null?x:_,C=!0,O in c.modified&&G.isEqual(c.modified[O],U)?(Reflect.deleteProperty(c.modified,O),o.isReverting&&(o.data[H]=U)):o.ignoreBag||(O in c.modified||o.storeFieldChange(O,_),re.oldValue===Ue&&Reflect.deleteProperty(re,"oldValue")),m[O]=re,o.applyValue(J,H,U,s,I),Y&&!r&&(o.initRelation(Y),o.stores.forEach(A=>A.cacheRelatedRecord(o,U,Y.relationName,re.oldValue)))}}return C&&o.afterChange(y,m,i,r,s),o.inSetting=!1,C?m:null}applyValue(e,t,i,r,s){var n,l;const o=this;if((((n=s)===null||n===void 0?void 0:n.name)||t)===o.constructor.parentIdField){var a;(a=o.parent)!==null&&a!==void 0&&a.isRoot&&(i==null||!o.firstStore.getById(i))||(o.firstStore.getById(i)||o.firstStore.rootNode).insertChild(o,null,!1,{orderedParentIndex:{skip:!0}})}else if(e){var c;o[((c=s)===null||c===void 0?void 0:c.name)||t]=i}else if((l=s)!==null&&l!==void 0&&l.set)s.set(i,o.data,o);else{var d;let h=(d=s)===null||d===void 0?void 0:d.complexMapping;if(!s&&t.includes(".")){var f,g;const p=t.split(".")[0];s=o.constructor.fieldMap[p],h=((f=s)===null||f===void 0?void 0:f.complexMapping)||((g=s)===null||g===void 0?void 0:g.type)==="object"}h?w.setPath(o.data,t,i):o.data[t]=i}}afterChange(e,t,i,r,s){for(const n of this.stores)n.onModelChange(this,e,t,i,r,s);this.forEachLinked((n,l)=>n.onModelChange(l,e,t,i,r,s))}forEachLinked(e){for(const t of this.$links)for(const i of t.stores)e(i,t)}get isPersistable(){return!this.isBatchUpdating&&!this.isCreating}get isModified(){return!!(this.meta.modified&&Object.keys(this.meta.modified).length>0)}get hasPersistableChanges(){return this.isPersistable&&!w.isEmpty(this.rawModificationData)}isFieldModified(e){return this.isModified&&e in this.meta.modified}getFieldPersistentValue(e){const t=typeof e=="string"?this.getFieldDefinition(e):e,i=(t==null?void 0:t.name)||e;let r;return(!t||t.persist)&&(r=this.getValue(i),t!=null&&t.serialize&&(r=t.serialize(r,this))),r}get modifications(){const e=this.rawModifications;return e&&Object.keys(e).length&&(e[this.constructor.idField]=this.id),e}get rawModifications(){const e=this,t={};if(!e.isModified)return null;let i=!1;return Object.keys(e.meta.modified).forEach(r=>{const s=e.getFieldPersistentValue(r);s!==Ue&&(t[r]=s,i=!0)}),i?t:null}get modificationData(){const e=this.rawModificationData;return e&&Object.keys(e).length&&w.setPath(e,this.constructor.idField,this.id),e}get rawModificationData(){const e=this,{fieldMap:t}=e.constructor,i={};if(!e.isModified)return null;let r=!1;return Object.keys(e.meta.modified).forEach(s=>{var n,l;let o=t[s],a=(n=o)===null||n===void 0?void 0:n.dataSource;if(s.includes(".")){const c=s.match(Pn)[1];o=t[c],a=s}if((l=o)!==null&&l!==void 0&&l.persist){const c=e.getFieldPersistentValue(s);c!==Ue&&(w.setPath(i,a,c),r=!0)}}),r?i:null}get modificationDataToWrite(){const e=this.constructor.alwaysWriteFields,t=this.modificationData;return e.forEach(i=>{t[this.getFieldDefinition(i).dataSource]=this.getFieldPersistentValue(i)}),t}get persistableData(){const e=this,t={};return e.fields.forEach(i=>{const r=e.getFieldPersistentValue(i);r!==Ue&&(i!=null&&i.complexMapping?w.setPath(t,i.dataSource,r):t[i.dataSource]=r)}),t}get dataByFieldName(){const{data:e}=this;return this.fields.reduce((t,i)=>(w.hasPath(e,i.dataSource)&&(t[i.name]=e[i.dataSource]),t),{})}get isCommitting(){return!!this.meta.committing}clearChanges(e=!0,t=!0,i=null){const r=this,{meta:s}=r;if(i)for(const l in i)delete s.modified[l];else s.modified={};const n=w.isEmpty(s.modified);s.committing=!1,t&&r.stores.forEach(l=>{if(n&&l.modified.remove(r),l.added.remove(r),e){const o=l.collectDescendants(r).all;l.added.remove(o),n&&l.modified.remove(o)}})}storeFieldChange(e,t){this.meta.modified[e]=t}revertChanges(e=!1){this.isReverting=!0,this.set(this.meta.modified,Ue,e),this.isReverting=!1}applyChangeset(e,t="$PhantomId",i=!0){var g;const r=this,s=r.constructor,{idField:n,fieldDataSourceMap:l}=s,o=w.pathifyKeys(e,l),a=w.pathifyKeys(r.modificationData),c={},d=t in e;for(const h in o){const p=l[h],m=(g=p==null?void 0:p.name)!=null?g:h;(i||((p==null?void 0:p.name)===n?d:o[h]===a[h]))&&(c[m]=o[h])}const f=r.set(c);return r.clearChanges(!1,!0,i?null:c),f?Object.entries(f).reduce((h,[p,m])=>(h[p]=m.value,h),{}):{}}get internalId(){return this._internalId}get isPhantom(){return this.id===""||this.id==null||this.hasGeneratedId}get isModel(){return!0}get hasGeneratedId(){return typeof this.id=="string"&&this.id.startsWith("_generated")}static generateId(e=this.$$name){return`_generated${e}_${k.generateUUID()}`}generateId(){return this.constructor.generateId()}static asId(e){return e!=null&&e.isModel?e.id:w.isObject(e)?e[this.fieldMap.id.dataSource]:e}get json(){return k.safeJsonStringify(this)}toJSON(){const{children:e,unfilteredChildren:t}=this,i=this.persistableData;return(t||e)&&(i[this.constructor.childrenField]=(t||e).map(r=>r.toJSON())),i}toString(){const e=this,t=cc.find(r=>r in e.constructor.fieldMap),i=t?{[e.constructor.idField]:e.id,[t]:e[t]}:e.data;return k.safeJsonStringify(i)}get isBatchUpdating(){return!!this.batching}hasBatchedChange(e){var t,i;return(t=this.meta)===null||t===void 0||(i=t.batchChanges)===null||i===void 0?void 0:i[e]}beginBatch(e=!1){const t=this;t.batching||(t.batching=0,t.meta.batchChanges={}),e&&(t.$silenceBatch=(t.$silenceBatch||0)+1),t.batching++}endBatch(e=!1,t=!1,i=!0){const r=this,{parentIdField:s}=r.constructor;if(r.batching&&(r.batching--,r.$silenceBatch&&r.$silenceBatch--,!(r.batching>0)&&!w.isEmpty(r.meta.batchChanges))){let{batchChanges:n}=r.meta;r.meta.batchChanges=null,n[s]&&(n={...n},r.parentId=n[s],delete n[s]),r.set(n,Ue,e,!1,t,void 0,i)}}cancelBatch(){if(this.batching){const e=this,{batchChanges:t}=e.meta,i={};if(e.batching=null,e.meta.batchChanges=null,e.generation++,!e.$silenceBatch){Object.entries(t).forEach(([s,n])=>{i[s]={oldValue:n,value:e[s]}});const r={action:"update",record:e,records:[e],changes:i};e.stores.forEach(s=>{s.trigger("batchedUpdate",{...r})}),e.forEachLinked((s,n)=>{s.trigger("batchedUpdate",{...r,record:n,records:[n]})})}e.$silenceBatch&&e.$silenceBatch--}}triggerBeforeUpdate(e){var t;return!((t=this.stores)!==null&&t!==void 0&&t.some(i=>i.trigger("beforeUpdate",{record:this,changes:e})===!1))}copy(e=null,t){const i=this,r=w.clone(i.data),s=i.constructor.idField,n=w.isObject(t)?t.deep:t;let l;if(e&&typeof e=="object"?(l=e[s],Object.assign(r,e)):l=e,n&&i.children?r.children=i.children.map(a=>a.copy(void 0,t)):(delete r.children,delete r.expanded),i.$meta.fields.initable.length>0){const a=i.toJSON();for(const c of i.$meta.fields.initable)r[c.name]=a[c.name]}e!==!1&&(r[s]=l||i.generateId(i.firstStore));const o=new i.constructor(r,null,null,!1,!0);return o.originalInternalId=i.internalId,o}copyData(e,t,i){const r={};e.allFields.forEach(({name:s})=>{s!==e.constructor.idField&&(r[s]=t?e.get(s):e.getValue(s))}),this.set(r,null,i)}remove(e=!1){const t=this,{parent:i}=this;i?i.removeChild(t):t.stores.length&&!t.isSpecialRow&&t.stores.forEach(r=>r.remove(t,e,!1,!0))}beforeRemove(e,t){return super.beforeRemove(e,t)}get isValid(){return!0}get firstStore(){return this.stores.length>0&&this.stores[0]}joinStore(e){const t=this,{stores:i}=t;if(!i.includes(e)){var r;const{unjoinedStores:s}=t;super.joinStore(e),e.register(t),i.push(e),s.includes(e)&&s.splice(s.indexOf(e),1),t.isLoaded&&t.children.forEach(n=>n.joinStore(e)),t.initRelations(),e.tree&&!t.isRoot&&!((r=e.stm)!==null&&r!==void 0&&r.isRestoring)&&(t.instanceMeta(e.id).collapsed=!t.expanded)}}unjoinStore(e,t=!1){const i=this,{stores:r,unjoinedStores:s}=i;if(r.includes(e)){var n,l,o;e.isDestroying||(e.unregister(i),s.push(e)),(n=i.unfilteredChildren||i.children)===null||n===void 0||(l=n.forEach)===null||l===void 0||l.call(n,a=>a.unjoinStore(e,t)),r.splice(r.indexOf(e),1),(o=super.unjoinStore)===null||o===void 0||o.call(this,e,t),e.uncacheRelatedRecord(i)}}isPartOfStore(e){return e?e.includes(this):this.stores.length>0}get isRemoved(){return!this.isPartOfStore()}instanceMeta(e){const{meta:t}=this,i=e.id||e;return t.map||(t.map={}),t.map[i]||(t.map[i]={})}get isGroupHeader(){return"groupRowFor"in this.meta}get isGroupFooter(){return"groupFooterFor"in this.meta}get isSpecialRow(){var e;return!!(!((e=this.meta)===null||e===void 0)&&e.specialRow)}get $original(){return this.isLinked?this.proxyMeta.originalRecord:this}static get nonPersistableFields(){const e=this;return e._nonPersistableFields||(e._nonPersistableFields={},e.allFields.forEach(t=>{(!t.persist||t.calculated)&&(e._nonPersistableFields[t.name]=1)})),e._nonPersistableFields}static get alwaysWriteFields(){const e=this;return e._alwaysWriteFields||(e._alwaysWriteFields=[],e.allFields.forEach(t=>{t.alwaysWrite&&e._alwaysWriteFields.push(t.name)})),e._alwaysWriteFields}get domId(){return typeof this.id=="string"?this.id.replace(/[ .]/g,"-"):this.id}static toJavaScriptValue(e){const{names:t}=this.$meta,i=t[t.length-2],r=t[t.length-3];return`class ${i} extends ${r} { static fields = ${k.toJavaScriptValue(this.fields,e)}; }`}getCurrentConfig(e){const{data:t,children:i}=this,{defaultValues:r,applyConfigs:s}=this.constructor,n=s?super.getCurrentConfig(e):{};if(n){for(const l of this.fields)if(l.persist){const o=w.getPath(t,l.dataSource);l.isEqual(o,r[l.name])||w.setPath(n,l.dataSource,$.processConfigValue(o,e))}if(i)if(Array.isArray(i)){n.children=[];for(const l of i)n.children.push(l.getCurrentConfig(e))}else n.children=i;this.hasGeneratedId&&delete n.id,delete n.parentId,delete n.parentIndex}return n}};let se=Zi;R(se,"relations",null),se._idField="id",se._internalIdCounter=1,se._assignedIdField=!1,se.exposeProperties(),se._$name="Model";class At{constructor(e,t){typeof e=="number"||e===null?(this._magnitude=e,this._unit=t):(typeof e=="string"&&Object.assign(this,N.parseDuration(e)),typeof e=="object"&&Object.assign(this,e))}get magnitude(){return this._magnitude}set magnitude(e){this._magnitude=typeof e=="number"&&e}get unit(){return this._unit}set unit(e){this._unit=N.parseTimeUnit(e)}get isValid(){return this._magnitude!=null&&!!N.normalizeUnit(this._unit)}get milliseconds(){return this.isValid?Math.round(N.asMilliseconds(this._magnitude,this._unit)):0}isEqual(e){return!!e&&this._magnitude!=null&&e._magnitude!=null&&this.milliseconds===e.milliseconds}toString(e){const t=this,i=e?"getShortNameOfUnit":"getLocalizedNameOfUnit";return t.isValid?`${t._magnitude} ${N[i](t._unit,t._magnitude!==1)}`:""}toJSON(){return this.toString()}valueOf(){return this.milliseconds}diff(e){return new At({unit:this.unit,magnitude:N.as(this.unit,this.milliseconds-e.milliseconds)})}}At._$name="Duration";const dc=(u,e)=>u==null?void 0:u[e],fc=/^is(this|next|last)(week|month|year)$/i,hc=["isToday","isTomorrow","isYesterday","isThisWeek","isNextWeek","isLastWeek","isThisMonth","isNextMonth","isLastMonth","isThisYear","isNextYear","isLastYear","isYearToDate"],mi=class extends $.mixin(Gt){static get defaultConfig(){return{value:null,operator:null,filterBy:null,convert:null,caseSensitive:!0,id:null,type:null,internal:null,disabled:!1}}static get configurable(){return{property:null}}construct(e){typeof e=="function"&&(e={filterBy:e}),e.type?e.type==="date"&&e.value!=null&&!Array.isArray(e.value)?e.value=new Date(e.value):e.type==="duration"&&e.value!=null&&!Array.isArray(e.value)&&(e.value=new At(e.value)):N.isDate(e.value)||Array.isArray(e.value)&&e.value.every(N.isDate)?e.type="date":e.value instanceof At&&(e.type="duration"),super.construct(e)}get id(){return this._id||(this.internal?this._id=mi.generateId(`b-internal-${this.property}-filter-`):this._id=this.property||mi.generateId("b-filter-")),this._id}set id(e){this._id=e}onChange(e){var t;const i=this;!i.isConfiguring&&(t=i.owner)!==null&&t!==void 0&&t.onFilterChanged&&!i.owner.isConfiguring&&i.owner.onFilterChanged(i,e)}get filterBy(){return this._filterBy||this.defaultFilterBy}set filterBy(e){this._filterBy=e}defaultFilterBy(e){const t=this;let i;return e.isModel?i=e.getValue(t.property):t._propertyItems.length>1?i=t._propertyItems.reduce(dc,e):i=e[t.property],t[t.operator](t.convert(i))}updateProperty(e){this._propertyItems=e.split("."),this.onChange("property")}set value(e){const t=this;t._value=e,Array.isArray(e)&&({date:1,duration:1}[t.type]||e.length>0&&typeof e[0]=="string")?t._filterValue=e.map(i=>t.convert(i)):!t.caseSensitive&&Array.isArray(e)&&e.length>0&&typeof e[0]=="string"?t._filterValue=e.map(i=>i==null?void 0:i.toLowerCase()):!t.caseSensitive&&typeof e=="string"?t._filterValue=e.toLowerCase():t._filterValue=t.convert(e),t.onChange("value")}get value(){return this._value}get filterValue(){return this._filterValue}set operator(e){this._operator=e,this.onChange("operator")}get operator(){const e=this;return e._operator?e._operator:Array.isArray(e.filterValue)?"isIncludedIn":typeof e.filterValue=="string"?"*":"="}convert(e){var i;if(this.operator!=="sameTime"&&!(typeof this.filterValue=="string"&&e instanceof Date)){var t;this.operator==="sameDay"&&(e=N.clearTime(e)),e=(i=(t=e)===null||t===void 0?void 0:t.valueOf())!=null?i:e}return e=!this.caseSensitive&&typeof e=="string"?e.toLowerCase():e,e}filter(e){return this.filterBy(e)}startsWith(e){return String(e).startsWith(this.filterValue)}endsWith(e){return String(e).endsWith(this.filterValue)}isIncludedIn(e){return this.filterValue.length===0||this.filterValue.includes(e)}isNotIncludedIn(e){return!this.isIncludedIn(e)}includes(e){return this.filterValue.length===0||String(e).includes(this.filterValue)}doesNotInclude(e){return!this.includes(e)}sameTime(e){return N.isSameTime(e,this.filterValue)}sameDay(e){return e===this.filterValue}"="(e){return w.isEqual(e,this.filterValue)}"!="(e){return!w.isEqual(e,this.filterValue)}">"(e){return w.isMoreThan(e,this.filterValue)}">="(e){return w.isMoreThan(e,this.filterValue)||w.isEqual(e,this.filterValue)}"<"(e){return w.isLessThan(e,this.filterValue)}"<="(e){return w.isLessThan(e,this.filterValue)||w.isEqual(e,this.filterValue)}"*"(e){return w.isPartial(e,this.filterValue)}between(e){const[t,i]=this._filterValue;return(w.isMoreThan(e,t)||w.isEqual(e,t))&&(w.isLessThan(e,i)||w.isEqual(e,i))}notBetween(e){return!this.between(e)}empty(e){return e==null||String(e).length===0}notEmpty(e){return!this.empty(e)}isToday(e){return this.between(e)}isTomorrow(e){return this.between(e)}isYesterday(e){return this.between(e)}isThisWeek(e){return this.between(e)}isNextWeek(e){return this.between(e)}isLastWeek(e){return this.between(e)}isThisMonth(e){return this.between(e)}isNextMonth(e){return this.between(e)}isLastMonth(e){return this.between(e)}isThisYear(e){return this.between(e)}isNextYear(e){return this.between(e)}isLastYear(e){return this.between(e)}isYearToDate(e){return this.between(e)}isTrue(e){return e===!0}isFalse(e){return e===!1}setRelativeDateValues(){this._filterValue=mi.getRelativeDateRange(this._operator).map(e=>e.valueOf())}static getRelativeDateRange(e,t=new Date){let i,r,s,n,l,o,a;switch(e){case"isYearToDate":return[N.floor(t,"1 year"),t];case"isToday":return i=N.floor(t,"1 day"),[i,N.add(i,1,"day")];case"isYesterday":return i=N.floor(t,"1 day"),[N.add(i,-1,"day"),i];case"isTomorrow":return r=N.getStartOfNextDay(t),[r,N.add(r,1,"day")];case"isThisWeek":case"isNextWeek":case"isLastWeek":case"isThisMonth":case"isNextMonth":case"isLastMonth":case"isThisYear":case"isNextYear":case"isLastYear":if(s=e.toLowerCase().match(fc),!s)throw new Error(`Unrecognized relative date expression: ${e}`);return[,o,a]=s,n=`1 ${a}`,l=N.floor(t,n),o==="next"?l=N.add(l,1,a):o==="last"&&(l=N.add(l,-1,a)),[l,N.add(l,1,a)]}}static generateFiltersFunction(e){if(!e||!e.length&&!e.count)return ee.returnTrue;for(const t of e)t.type==="date"&&hc.includes(t._operator)&&t.setRelativeDateValues();return function(t){let i=!0;for(const r of e)if(r.disabled||(i=r.filter(t)),!i)break;return i}}};let fe=mi;R(fe,"$name","CollectionFilter"),fe._$name="CollectionFilter";const Nn=w.getPathDefault(globalThis,"bryntum.idCounts",Object.create(null));class Pi{static generateId(e="generatedId"){return e+(Nn[e]=(Nn[e]||0)+1)}}Pi._$name="IdHelper";class Qt extends ${static get defaultConfig(){return{property:null,direction:"ASC",sortFn:null,convert:null,id:null,useLocaleSort:null}}construct(e){typeof e=="function"&&(e={sortFn:e}),super.construct(e)}get id(){return this._id||(this._id=this.property||Pi.generateId("b-sorter"))}set id(e){this._id=e}set sortFn(e){this._sortFn=e}get sortFn(){return this._sortFn?this._sortFn:this.defaultSortFn}defaultSortFn(e,t){const i=this,{convert:r,property:s,useLocaleSort:n}=i,l=i.direction.toLowerCase()==="desc"?-1:1;if(e=e[s],t=t[s],r&&(e=r(e),t=r(t)),n&&e!=null&&t!=null&&typeof e=="string"){if(n===!0)return String(e).localeCompare(t);if(typeof n=="string")return String(e).localeCompare(t,n);if(typeof n=="object")return String(e).localeCompare(t,n.locale,n)}return(e>t?1:e<t?-1:0)*l}static generateSortFunction(e,t){const i=e.isCollection?e.values:e,r=i.length;return(s,n)=>{let l,o;for(o=0;o<r;++o)if(l=i[o].sortFn(s,n),l)return l;return t?t(s,n):0}}}Qt._$name="CollectionSorter";const gc=()=>0,mc=(u,e)=>e-u,Vr=Symbol("filteredIndicesProperty"),It=Object.freeze([]),pc=Object.freeze({action:"sort",added:It,removed:It,replaced:It}),yc=Object.freeze({action:"filter",added:It,removed:It,replaced:It}),gt={string:1,number:1};function Vn(u,e,t){if(e.unique!==!1)e.set(t,u);else{let i=e.get(t);i||(i=new Set,e.set(t,i)),i.add(u)}}function vc(u,e,t){e.unique!==!1?e.delete(t):e.has(t)&&(e.get(t).delete(u),e.get(t).size||e.delete(t))}function zn(u,e,t,i){for(let r=0;r<u.length;r++){const s=u[r];for(let n=0;n<i;n++){const l=t[n],o=s[l],a=e[l];Vn(s,a,o)}}}class Ge extends $.mixin(Oe){constructor(){super(...arguments);R(this,"_sortFunction",null);R(this,"_addedValues",null)}static get configurable(){return{idProperty:"id",extraKeys:null,autoFilter:!0,autoSort:!0,sorters:{$config:["lazy"],value:[]}}}get isCollection(){return!0}construct(t){this.generation=0,this._values=[],super.construct(t)}doDestroy(){var t;super.doDestroy();const i=this;i._values.length=0,i.isFiltered&&(i._filteredValues.length=0,i.filters.destroy()),(t=i._sorters)===null||t===void 0||t.destroy()}clear(){const t=this,i=t._values.slice();t.totalCount&&(t._values.length=0,t._filteredValues&&(t._filteredValues.length=0),t._indicesInvalid=!0,t.generation++,t.trigger("change",{action:"clear",removed:i}))}equals(t,i){if(t.isCollection&&(t=t.values),t.length===this.count){let{values:r}=this;return i&&(t=t.map(i),r=r.map(i)),j.delta(t,r).inBoth.length===this.count}return!1}replaceValues({values:t,filteredValues:i,silent:r=!1,isNewDataset:s=!1}){const n=this;let l,o;n.isFiltered&&!s?(!!i?t&&(l=n._values,n._values=t.slice()):(i=t.slice(),t=null),o=n._filteredValues,n._filteredValues=i.slice()):(l=n._values,n._values=t.slice(),i=null,n.isFiltered&&s&&n.autoFilter?(n._filterFunction=null,n._filteredValues=n._values.filter(n.filterFunction)):n._filteredValues&&(n._filteredValues.length=0)),n._indicesInvalid=!0,n._addedValues=void 0,n.generation++,r||n.trigger("change",{action:"replaceValues",replacedValues:l,replacedFilteredValues:o,values:t,filteredValues:i})}set values(t){this.invalidateIndices(),this.splice(0,this._values.length,t)}get values(){return this.isFiltered?this._filteredValues:this._values}get filteredValues(){return this._filteredValues}[Symbol.iterator](){return this.values[Symbol.iterator]()}forEach(t,i=!1){(this.isFiltered&&!i?this._filteredValues:this._values).forEach(t)}map(t,i=!1){return(this.isFiltered&&!i?this._filteredValues:this._values).map(t)}find(t,i=!1){return(this.isFiltered&&!i?this._filteredValues:this._values).find(t)}get first(){return this.values[0]}get last(){return this.values[this.count-1]}get allValues(){return this._values}get addedValues(){return this._addedValues}match(t,i=!0){const r=this,{_values:s}=r,n=[];return r.forEach(l=>{const o=t.get(l.id,!0);if(o){const a=r.indexOf(l,!0),c=s[a];s[a]=o,r.removeFromIndices(c),r.addToIndices(o)}else i&&n.push(l)}),n.length&&r.remove(n),r.isFiltered&&(r._filteredValues=r._values.filter(r.filterFunction)),n}add(...t){t.length===1?this.splice(this._values.length,null,...t):this.splice(this._values.length,null,t)}remove(...t){t.length===1?this.splice(0,...t):this.splice(0,t)}move(t,i){for(t=j.asArray(t);t.length&&t[0]===i;)t.shift();if(!t.length)return;const r=this,{_values:s}=r,n=r.indexOf(t[0],!0);if(t.length===1&&s[n+1]===i)return;r.suspendEvents(),r.remove(t),r.resumeEvents();const l=i?r.indexOf(i,!0):s.length;if(l===-1)throw new Error("Collection move beforeItem parameter must be present in Collection");return s.splice(l,0,...t),r._indicesInvalid=1,r.trigger("change",{action:"move",items:t,from:n,to:l}),l}splice(t=0,i,...r){const s=this,n=s.idProperty,l=s._values,o={},a=[],c=[],d=s.totalCount;let f,g;if(s.trigger("beforeSplice",{index:t,toRemove:i,toAdd:r})!==!1){if(r)if(r.length===1&&Array.isArray(r[0])&&(r=r[0]),d&&r.length){const h=s.indices[n];f=[];for(let p=0;p<r.length;p++){const m=r[p],y=m[n],b=h.get(y),C=b?l.indexOf(b):-1;o[y]=!0,C!==-1?l[C]!==m&&(c.push([l[C],m]),l[C]=m):f.push(m)}}else f=r;if(i){if(typeof i=="number"){i=Math.min(i,l.length-t);for(let h=t;i;--i){const p=l[h][n];o[p]?(t++,h++):(a.push(l[h]),l.splice(h,1),g=!0)}}else{let h=f.length===0,p;i=j.asArray(i);const m=i.reduce((y,b)=>{const C=typeof b=="number",E=C?b:s.indexOf(b,!0);return h&&(p!=null&&E!==p+1||C)&&(h=!1),E>=0&&E<d&&y.push(E),p=E,y},[]).sort(mc);if(h)m.length&&(a.push.apply(a,i),l.splice(m[m.length-1],m.length),g=!0);else for(let y=0;y<m.length;y++){const b=m[y];if(b!==-1){const C=l[b][n];o[C]||(a.unshift(l[b]),l.splice(b,1),g=!0)}}}a.length&&!s._indicesInvalid&&a.forEach(s.removeFromIndices,s)}if(f.length){l.splice(Math.min(t,l.length),0,...f),g=!0,s._indicesInvalid||f.forEach(s.addToIndices,s),s._addedValues||(s._addedValues=new Set);for(const h of f)s._addedValues.add(h)}if(a.length&&s._addedValues)for(const h of a)s._addedValues.delete(h);c.length&&!s._indicesInvalid&&c.forEach(h=>{s.removeFromIndices(h[0]),s.addToIndices(h[1])}),g||c.length?(s.isSorted?s.onSortersChanged():s.isFiltered&&(s.autoFilter?s.onFiltersChanged({action:"splice",oldCount:1}):s._filteredValues.splice(Math.min(t,s._filteredValues.length),0,...f)),s.generation++,s.trigger("change",{action:"splice",removed:a,added:f,replaced:c,oldCount:d})):s.trigger("noChange",{index:t,toRemove:i,toAdd:r})}}changeId(t,i){const r=this,{idProperty:s}=r,n=gt[typeof t]?t:t[s],l=r.get(n);if(l){const o=r.get(i);if(o&&l!==o)throw new Error(`Attempt to set item ${n} to already existing member's id ${i}`);r.removeIndexEntry(t,s,n),r.addIndexEntry(t,s,i),l[s]=i}}get(t,i=!1){return this.getBy(this.idProperty,t,i)}getAt(t,i=!1){return this.isFiltered&&!i?this._filteredValues[t]:this._values[t]}getBy(t,i,r=!1){return this.findItem(t,i,this.isFiltered&&r)}get count(){return this.values.length}get totalCount(){return this._values.length}updateIdProperty(t){this.addIndex({property:t,unique:!0})}changeSorters(t){return new Ge({values:j.asArray(t),internalListeners:{change:"onSortersChanged",thisObj:this}})}addSorter(t){const i=t instanceof Qt?t:new Qt(t);return this.sorters.add(i),i}get isSorted(){var t;return!!(!((t=this._sorters)===null||t===void 0)&&t.count)}onSortersChanged(){const t=this;t._sortFunction=null,t._addedValues=null,t._values.sort(t.sortFunction),t.trigger("change",pc)}get sortFunction(){return this._sortFunction||(this.isSorted?this._sortFunction=Qt.generateSortFunction(this.sorters.values):this._sortFunction=gc),this._sortFunction}get filters(){return this._filters||(this._filters=new Ge({internalListeners:{change:"onFiltersChanged",thisObj:this}})),this._filters}addFilter(t){const i=t instanceof fe?t:new fe(t);return this.filters.add(i),i}removeFilter(t){const{filters:i}=this;t.isCollectionFilter||(t=i.get(t)),i.remove(t)}clearFilters(){this.filters.clear()}get isFiltered(){return!!(this._filters&&this._filters.count)}onFiltersChanged({action:t,removed:i,oldCount:r}){const s=this,n=r||t==="clear"&&i.length?s._filteredValues:s._values;s._filterFunction=null,s._filteredValues=s._values.filter(s.filterFunction),s._indicesInvalid=!0;const{toAdd:l,toRemove:o}=j.delta(s._filteredValues,n,!0);s.trigger("change",{...yc,added:l,removed:o})}get filterFunction(){return this._filterFunction||(this.isFiltered?this._filterFunction=fe.generateFiltersFunction(this.filters.values):this._filterFunction=ee.returnTrue),this._filterFunction}changeExtraKeys(t){return j.asArray(t).map(r=>typeof r=="string"?{property:r,unique:!0}:r)}updateExtraKeys(t){for(let i=0;i<t.length;i++)this.addIndex(t[i])}addIndex(t){const i=this;t&&((i._indices||(i._indices={}))[t.property]=new Map,Object.assign(i._indices[t.property],t),i.invalidateIndices(),t.dependentOn&&(i.hasCompositeIndex=!0))}findIndex(t,i,r=!1){const s=this.findItem(t,i,r);return s?(this.isFiltered&&!r?this._filteredValues:this._values).indexOf(s):-1}findItem(t,i,r=!1){var o;const s=this,{isFiltered:n}=s,l=n&&!r?s.indices[Vr][t]:s.indices[t];if(l){const a=(o=l.get(i))!=null?o:typeof i=="string"&&i.length&&!isNaN(i)&&l.get(Number(i))||null;if(a!=null)return a}else{const a=n&&!r?s._filteredValues:s._values,c=a.length;for(let d=0;d<c;d++){const f=a[d];if(f[t]==i)return f}}return null}removeIndex(t){delete this._indices[t],this.hasCompositeIndex=Object.values(this.indices).some(i=>i.dependentOn)}indexOf(t,i=!1){return this.findIndex(this.idProperty,gt[typeof t]?t:t[this.idProperty],i)}includes(t,i=!1){return Array.isArray(t)?t.some(r=>this.includes(r)):!!this.findItem(this.idProperty,gt[typeof t]?t:t[this.idProperty],i)}get indices(){return this._indicesInvalid&&this.rebuildIndices(),this._indices}invalidateIndices(){this._indicesInvalid=!0}rebuildIndices(){const t=this,i=t.isFiltered,r=t._indices||(t._indices={}),s=Object.keys(r),n=s.length,l=t._values;let o;i&&(o=r[Vr]={});for(let a=0;a<n;a++){const c=r[s[a]];if(c.clear(),i){let d=o[s[a]];d?d.clear():(d=o[s[a]]=new Map,d.unique=c.unique)}}zn(l,r,s,n),i&&zn(t._filteredValues,o,s,n),t._indicesInvalid=!1}getIndices(t){const i=[this.indices[t]];return this.isFiltered&&i.push(this.indices[Vr][t]),i}addToIndices(t){Object.keys(this.indices).forEach(i=>{this.addIndexEntry(t,i,t[i])})}removeFromIndices(t){Object.keys(this.indices).forEach(i=>{this.removeIndexEntry(t,i,t[i])})}removeIndexEntry(t,i,r){this.getIndices(i).forEach(s=>vc(t,s,r))}addIndexEntry(t,i,r){this.getIndices(i).forEach(s=>Vn(t,s,r))}onItemMutation(t,i){const r=this;!r._indicesInvalid&&Object.keys(r.indices).length>1&&Object.keys(i).forEach(s=>{if(r.indices[s]){const{value:o,oldValue:a}=i[s];r.removeIndexEntry(t,s,a),r.addIndexEntry(t,s,o)}if(r.hasCompositeIndex){const o=Object.values(r.indices).find(a=>{var c;return(c=a.dependentOn)===null||c===void 0?void 0:c[s]});if(o){const a={};for(const d in o.dependentOn){var l;a[d]=((l=i[d])===null||l===void 0?void 0:l.oldValue)||t[d]}const c=t.buildIndexKey(a);r.removeIndexEntry(t,o.property,c),r.addIndexEntry(t,o.property,t[o.property])}}})}}Ge._$name="Collection";const Bn=new WeakMap,ei=u=>{if(u&&typeof u=="object"){let e=Bn.get(u);e===void 0&&(e=Symbol("bscik"),Bn.set(u,e)),u=e}return u};class ti{constructor(e){const t=this;t.generation=0,t.items=new Set,t.idMap={},t.idProperty="id",e&&(e.idProperty&&(t.idProperty=e.idProperty),e.values&&(t.values=e.values))}get(e){return this.idMap[ei(e)]}get count(){return this.items.size}add(...e){e.length===1&&Array.isArray(e[0])&&(e=e[0]);const t=this,{items:i,idMap:r,idProperty:s}=t,n=e.length;for(let l=0;l<n;l++){const o=e[l],a=gt[typeof o]?o:ei(o[s]),c=r[a];c==null?(r[a]=o,i.add(o),t.generation++):c!==o&&(r[a]=o,i.delete(c),i.add(o))}}at(e){let t,i;e<0&&(e+=this.count);for(t of this.items)if(!e--){i=t;break}return i}remove(e){e=j.asArray(e);const{items:t,idMap:i,idProperty:r}=this,s=e.length;for(let n=0;n<s;n++){const l=e[n],o=gt[typeof l]?l:ei(l[r]),a=i[o];a!=null&&(t.delete(a),delete i[o],this.generation++)}}clear(){this.items.clear(),this.idMap={},this.generation++}countOf(e){let t=0,i;for(i of this.items)e(i)&&++t;return t}changeId(e,t){const i=this,{idMap:r,idProperty:s}=i,n=gt[typeof e]?e:ei(e[s]),l=i.get(n);if(l){const o=i.get(t);if(o&&l!==o)throw new Error(`Attempt to set item ${n} to already existing member's id ${t}`);l[s]=t,delete r[n],r[t]=l}}filter(e,t){const{items:i}=this,r=[];let s=0;return i.forEach(n=>{e.call(t,n,s++,i)&&r.push(n)}),r}includes(e){const t=gt[typeof e]?e:ei(e[this.idProperty]);return!!this.idMap[t]}map(e,t){const{items:i}=this,r=new Array(i.size);let s=0;return i.forEach(n=>{r[s]=e.call(t,n,s++,i)}),r}forEach(e,t){return this.items.forEach(e,t)}find(e,t=0){let i,r;t<0&&(t+=this.countOf(e));for(i of this.items)if(e(i)&&!t--){r=i;break}return r}[Symbol.iterator](){return this.items[Symbol.iterator]()}indexOf(e,t){let i=-1,r;for(r of this.items)if((!t||t(r))&&(++i,r===e))return i;return-1}get values(){return[...this.items]}set values(e){e=j.asArray(e),this.clear(),this.add.apply(this,e),this.generation++}sort(e){this.values=this.values.sort(e)}some(e,t){return this.values.some(e,t)}}ti._$name="Bag";class Ai extends ti{add(...e){return e.length===1&&Array.isArray(e[0])&&(e=e[0]),super.add(...e.filter(t=>t.isPersistable))}}Ai._$name="StoreBag";var jn=u=>class extends(u||$){static get $name(){return"StoreCRUD"}static get defaultConfig(){return{autoCommit:!1}}static get properties(){return{isRemoving:!1,suspendCount:0}}remove(t,i=!1){const r=this,{storage:s}=r;if(t=j.asArray(t).reduce((n,l)=>(l=r.getById(l),l&&n.push(l),n),[]),t.length===0)return t;if(!r.tree&&!i&&r.trigger("beforeRemove",{records:t})===!1)return[];if(r.isRemoving=!0,r.isGrouped){const n=s.count,l=[],o=new Set;for(const a of t){const{groupParent:c}=a.instanceMeta(r);c.meta.collapsed&&l.push(a),j.remove(c.groupChildren,a),j.remove(c.unfilteredGroupChildren,a),c.meta.childCount--,o.add(c)}for(const a of o)a.groupChildren.length>0&&r.onModelChange(a,{},{});l.length&&s.trigger("change",{action:"splice",removed:l,added:[],replaced:[],oldCount:n})}else if(r.tree){const n=[],l=t.length>1,o=t[0],a=l?void 0:s.indexOf(o),c=t.reduce((f,g)=>{const{parent:h}=g;return h&&(f[h.id]||(f[h.id]=[h,[]]),f[h.id][1].push(g)),f},{}),d=Array.from(Object.values(c));if(!i&&r.trigger("beforeRemove",{records:t,isMove:!1,parent:l?void 0:o.parent})===!1)return r.isRemoving=!1,[];d.sort((f,g)=>g[0].childLevel-f[0].childLevel);for(const[f,g]of d)n.push(...f.removeChild(g,!1,!0));return i||(r.trigger("remove",{parent:l?void 0:o.parent,index:a,isChild:!0,allRecords:n,isMove:!1,records:t}),r.trigger("change",{action:"remove",records:t})),r.isRemoving=!1,t}if(t.length===0)return r.isRemoving=!1,t;for(const n of t)n.beforeRemove(t);return i&&r.suspendEvents(),s.remove(t),i&&r.resumeEvents(),r.autoCommit&&r.doAutoCommit(),r.isRemoving=!1,t}clear(t=!1){var i,r;const s=this,{storage:n}=s;if(s.storage.totalCount||(i=s.rootNode)!==null&&i!==void 0&&(r=i.unfilteredChildren)!==null&&r!==void 0&&r.length){if(!t&&s.trigger("beforeRemove",{records:n.allValues,removingAll:!0})===!1)return null;if(s.rootNode)s.isChained||s.rootNode.clearChildren(t);else if(t){const l=s.registeredRecords;for(let o=l.length-1,a;o>=0;o--)a=l[o],a&&!a.isDestroyed&&a.unjoinStore(s)}t&&(s.removed.clear(),n.suspendEvents()),n.clear(),t&&n.resumeEvents(),s.added.clear(),s.modified.clear()}}removeAll(t=!1){const i=this,r=i.storage;let s;if(i.isRemoving=!0,t){r.suspendEvents();const n=i.registeredRecords;for(let l=n.length-1,o;l>=0;l--)o=n[l],o&&!o.isDestroyed&&!o.isRoot&&o.unjoinStore(i)}return i.tree?s=i.rootNode.clear()!==!1:s=i.clear()!==null,t&&r.resumeEvents(),i.isRemoving=!1,s}add(t,i=!1,r={}){var s;const n=this,{storage:l}=n;if(t=j.asArray(t),!((s=t)!==null&&s!==void 0&&s.length))return;if(n.tree=n.tree||!!(n.autoTree&&t[0].children),n.tree){const a=new Map,c=n.modelClass.getFieldDataSource("parentIndex"),{parentIdField:d}=n.modelClass,f=[];return t.forEach(g=>{const h=g[d];a.has(h)||a.set(h,{append:[],insert:[]});const p=a.get(h);!g.isModel&&c in g?p.insert.push(g):p.append.push(g)}),a.forEach(({append:g,insert:h},p)=>{const m=p==null?n.rootNode:n.getById(p);if(!m)throw new Error(`Parent node with id ${p} not found, cannot add children.`);if(g.length&&f.push(...m.appendChild(g,i)),h.length)for(const y of h)f.push(m.insertChild(y,y[c],i,r))}),n.isFiltered&&n.reapplyFilterOnAdd&&n.filter({silent:!0}),n.reapplySortersOnAdd&&!n.isSyncingDataOnLoad&&n.sort(),f}if(!i&&n.trigger("beforeAdd",{records:t})===!1)return null;if(n.tree=n.tree||!!(n.autoTree&&t[0].children),n.tree)return n.rootNode.appendChild(t);const o=n.processRecords(t);return i&&n.suspendEvents(),l.add(o),i&&n.resumeEvents(),n.autoCommit&&n.doAutoCommit(),o}processRecords(t,i){return t.map(r=>{const s=this.processRecord(r.isModel?r:this.createRecord(r));return i==null||i.call(this,s),s})}insert(t,i,r=!1){const s=this,n=s.storage,l=s.getAt(t),o=n.values,a=[];if(i=j.asArray(i),s.tree){var c;const p=s.rootNode;return p.insertChild(i,(c=p.children)===null||c===void 0?void 0:c[t],r)}if(!r&&s.trigger("beforeAdd",{records:i})===!1)return null;let d,f,g;if(o[f=t]===i[0]||o[f=t-1]===i[0])for(d=!0,g=0;d&&g<i.length;g++)i[g]!==o[f+g]&&(d=!1);if(d)return null;const h=s.processRecords(i,p=>{const m=n.indexOf(p);p.children&&p.children.length&&s.autoTree&&(s.tree=!0),m>-1&&(m<t&&l&&t--,a.push(m)),p.meta.previousIndex=m});return s.suspendEvents(),s.storage.remove(a),s.resumeEvents(),r&&s.suspendEvents(),n.splice(t,0,...h),r&&s.resumeEvents(),s.autoCommit&&s.doAutoCommit(),h}move(t,i){this.isTree?i.parent.insertChild(t,i):this.storage.move(t,i)}setMultiple(t,i,r){const s=this,n=[],l=[];s.forEach(o=>{t(o)&&(l.push(o.set(i,r,!0)),n.push(o))}),s.trigger("updateMultiple",{records:n,all:s.records.length===n.length}),s.trigger("change",{action:"updatemultiple",records:n,all:s.records.length===n.length}),s.reapplyFilterOnUpdate&&s.isFiltered&&s.filter()}setAll(t,i){const r=this,s=[];r.forEach(n=>{s.push(n.set(t,i,!0))}),r.trigger("updateMultiple",{records:r.records,all:!0}),r.trigger("change",{action:"updatemultiple",records:r.records,all:!0}),r.reapplyFilterOnUpdate&&r.isFiltered&&r.filter()}acceptChanges(){const t=this;t.added.forEach(i=>i.clearChanges(!0,!1)),t.modified.forEach(i=>i.clearChanges(!0,!1)),t.added.clear(),t.modified.clear(),t.removed.clear()}commit(t=!1){const{changes:i}=this;return!t&&this.trigger("beforeCommit",{changes:i})===!1?!1:(this.acceptChanges(),t||this.trigger("commit",{changes:i}),i)}revertChanges(){const t=this,{changes:i}=t;if(i){const r={action:"clearchanges",changes:i};t.add(t.removed.values,!0),t.remove(t.added.values,!0),t.modified.forEach(s=>s.revertChanges(!0)),t.added.clear(),t.modified.clear(),t.removed.clear(),t.trigger("change",r),t.trigger("refresh",r)}}get changes(){const t=this,i=t.modified.values.filter(r=>r.rawModifications);return t.added.count||i.length||t.removed.count?{added:t.added.values.slice(),modified:i,removed:t.removed.values.slice()}:null}get autoCommit(){return this._autoCommit}set autoCommit(t){this._autoCommit=t,t&&this.changes&&this.commit()}suspendAutoCommit(){this.suspendCount++}resumeAutoCommit(t=!0){this.suspendCount--,this.autoCommit&&t&&this.doAutoCommit()}doAutoCommit(){this.suspendCount<=0&&this.commit()}},Hn=u=>class extends(u||$){static get $name(){return"StoreChanges"}static get configurable(){return{applyChangesetFilterSortTarget:"changes"}}applyChangesFromStore(t){const i=this,{changes:r}=t;r&&(r.added&&i.add(r.added),r.removed&&i.remove(r.removed.map(s=>s.id)),r.modified&&r.modified.forEach(s=>{const n=i.getById(s.id);n==null||n.set(s.modifications)}))}applyChangeset(t,i=null,r="$PhantomId",s=!0,n=!1){var C,E,S,x;const l=this,{added:o,updated:a,modified:c,removed:d}=(C=i==null?void 0:i(t,l))!=null?C:t,f=(E=a!=null?a:c)!=null?E:[],g=l.modelClass.getFieldDataSource("id"),h=n?new Map:null,p=[],m=[];let y=!1,b=[];if(l._groupVisibleRecordIds=[],l.isGrouped&&l.forEach(L=>{l._groupVisibleRecordIds.push(L.id)}),(o==null?void 0:o.length)>0){const L=[],O=[];for(const I of o)l.getById((S=I[r])!=null?S:w.getPath(I,g))?L.push(I):O.push(I);f.unshift.apply(f,L);const P=(x=l.add(O,!1,{orderedParentIndex:{skip:!0}}))!=null?x:[];if(p.push(...P),l.tree)for(const I of P){const{parent:G}=I;if(G.isRoot){y=!0,b=[G];break}!G.isRoot&&b.every(K=>!K.contains(G))&&b.push(G)}for(const I of P)h==null||h.set(I.id,I.data),I.clearChanges()}if((f==null?void 0:f.length)>0)for(const L of f){const O=L[r],P=w.getPath(L,g),I=l.getById(O!=null?O:P);if(I){const G=I.applyChangeset(L,r,s);l.tree&&!y&&b.every(K=>!K.contains(I))&&(I.parent.isRoot?(y=!0,b=[I.parent]):b.push(I.parent)),h==null||h.set(P,G),m.push(I)}}if((d==null?void 0:d.length)>0&&l.applyRemovals(d),l.applyChangesetFilterSortTarget==="changes"){const L=l.filterChangeset(p,m);b.push(...L)}return l.afterChangesetApplied(b),l._groupVisibleRecordIds=null,h}afterChangesetApplied(t){t.forEach(i=>{i.traverse(r=>{r.sortOrderedChildren(!1,!1),r.children&&r.updateChildrenIndices(r.children,"parentIndex",!0),r.unfilteredChildren&&r.updateChildrenIndices(r.unfilteredChildren,"unfilteredIndex",!0)})})}applyRemovals(t){const i=this,{removed:r}=i,s=i.modelClass.idField,n=[];for(const l of t){const o=w.getPath(l,s);r.includes(o)?r.remove(o):n.push(o)}i.remove(n);for(const l of n)r.remove(l)}filterChangeset(t,i){const r=this,{isFiltered:s,tree:n,isGrouped:l,filtersFunction:o}=r,a=r.isSorted?r.createSorterFn(r.sorters):void 0,{allValues:c,addedValues:d,isSorted:f}=r.storage,g=a!=null||f?a!=null?a:r.storage.sortFunction:null,h=new Set;if(!s)return[];let p=!1,m;if(l&&(m=r.groupers,r.clearGroupers(!0)),n){const b=new Set(i.filter(o));for(const E of t.filter(o))b.add(E);b.forEach(E=>E.bubble(S=>b.add(S))),b.delete(r.rootNode);const C=j.groupBy(Array.from(b),"parentId");for(const E of Object.values(C)){const{parent:S}=E[0];S.unfilteredChildren&&(S.children.push(...E.filter(x=>!S.children.includes(x))),h.add(S))}}else if(g&&!l){const{filteredValues:b}=r.storage,C=d?b.findLastIndex(x=>!d.has(x))+1:b.length,E=b.slice(0,C),S=new Set(i.filter(o));for(const x of b)S.has(x)&&S.delete(x);for(const x of S)E.push(x);E.sort(g),b.splice(0,C,...E),p=!0}else{const b=i.filter(C=>o(C)&&!r.storage.includes(C));b.length>0&&(r.includeInSubset(c,r.storage.filteredValues,b),p=!0)}const y=new Set(t.filter(b=>!o(b)));if(y.size>0){if(n)for(const b of y)j.remove(b.parent.children,b),h.add(b.parent);else j.remove(r.storage.filteredValues,y);p=!0}return m&&(r.group(m[0],null,!1,!0,!0),p=!0),n&&h.size>0?r.storage.replaceValues({values:r.collectDescendants(r.rootNode).visible,silent:!0}):p&&(r._idMap=null,r.trigger("refresh")),[...h]}includeInSubset(t,i,r){const s=new Set(r);let n=0,l=0,o=s.size===0;for(;l<t.length&&!o;){const a=i[n];let c=t[l];for(;a!==c;)s.has(c)&&(i.splice(n,0,c),n++,s.delete(c),o=s.size===0),c=t[++l];s.has(a)&&s.delete(a),n<i.length&&n++}return i}},Wn=u=>class extends(u||$){static get $name(){return"StoreFilter"}static get defaultConfig(){return{filters:null,reapplyFilterOnAdd:!1,reapplyFilterOnUpdate:!1}}set reapplyFilterOnAdd(t){this.storage.autoFilter=t}get reapplyFilterOnAdd(){return this.storage.autoFilter}set filters(t){const i=this,r=i.filters;if(r.clear(),i._filtersFunction=null,t){if(t.constructor.name==="Object")for(const s of Object.entries(t))s[0]==="filterBy"&&typeof s[1]=="function"?r.add(new fe({filterBy:s[1]})):r.add(new fe(s[1].constructor.name==="Object"?Object.assign({property:s[0]},s[1]):{property:s[0],value:s[1]}));else Array.isArray(t)?r.add(...t.map(s=>s instanceof fe?s:new fe(s))):t.isCollection?r.add(...t.values):r.add(new fe({filterBy:t}));r.forEach(s=>s.owner=i)}}get filters(){return this._filters||(this._filters=new Ge({extraKeys:["property"]}))}set filtersFunction(t){this._filtersFunction=t}get filtersFunction(){const t=this,{filters:i,isGrouped:r}=t;if(!t._filtersFunction)if(i.count){const s=fe.generateFiltersFunction(i);t._filtersFunction=n=>r&&n.isSpecialRow?n.groupChildren.some(s):s(n)}else t._filtersFunction=ee.returnTrue;return t._filtersFunction}get isFiltered(){return this.filters.values.some(t=>!t.disabled)}traverseFilter(t){const i=this,r=!t.isRoot&&i.filtersFunction(t),s=t.unfilteredChildren||t.children;return!s||!s.length?r:(t.unfilteredChildren||(t.unfilteredChildren=t.children.slice()),t.children=t.unfilteredChildren.filter(n=>i.traverseFilter(n)),t.updateChildrenIndices(t.unfilteredChildren,"unfilteredIndex",!0),t.updateChildrenIndices(t.children,"parentIndex",!0),r||!!t.children.length)}traverseClearFilter(t){const i=this;t.unfilteredChildren&&(t.children=t.orderedChildren.slice(),t.unfilteredChildren=null),t.children&&(t.children.forEach(r=>i.traverseClearFilter(r)),t.updateChildrenIndices(t.children,"parentIndex",!0))}get latestFilterField(){return this.filters.last?this.filters.last.property:null}addFilter(t,i=!1){const r=this;if(t=t instanceof fe?t:new fe(t),t.owner=r,r.filters.add(t),!i){if(r.remoteFilter)return r.filter().then(()=>t);r.filter()}return t}filter(t){const i=this;let r=!1,s;if(t){let l=typeof t;if(l==="object"&&("silent"in t||"replace"in t||t.filters)&&(r=t.silent,t.replace&&i.clearFilters(t.filters.length===0),s=t.internal,t=t.filters,l=typeof t),t){const o=i.isFiltered;if(i.isConfiguring=!0,Array.isArray(t))t.forEach(a=>i.addFilter(a,!0),i);else if(l==="function"){const a=new fe(t);a.internal=s,i.addFilter(a,!0)}else l==="string"?i.addFilter({property:t,value:arguments[1]},!0):i.addFilter(t,!0);if(i.isConfiguring=!1,!i.isFiltered&&!o)return null}}i.filtersFunction=null;const n=i.performFilter(r);return i._idMap=null,n}performFilter(t){const i=this,{storage:r,filters:s,rootNode:n}=i,l=i.count;i.trigger("beforeFilter",{filters:s});let o,a;if(i.tree){const c=r.values;i.isFiltered?i.traverseFilter(n):i.traverseClearFilter(n);const d=i.collectDescendants(n).visible;r.replaceValues({values:d,silent:!0});const f=j.delta(d,c,!0);o=f.toAdd,a=f.toRemove}else r.ion({change({removed:c,added:d}){a=c,o=d},once:!0}),i.isFiltered?(i.isGrouped&&i.includeCollapsed(),r.addFilter({id:"primary-filter",filterBy:i.filtersFunction}),i.isGrouped&&i.excludeCollapsed()):r.filters.clear();i.afterPerformFilter(t||i.isRemoteDataLoading?null:{action:"filter",filters:s,oldCount:l,added:o,removed:a,records:i.storage.values})}afterPerformFilter(t){this.resetRelationCache(),t&&this.triggerFilterEvent(t)}triggerFilterEvent(t){this.trigger("filter",t),this.remoteFilter||(this.trigger("refresh",t),this.trigger("change",t))}filterBy(t){return this.filter(t)}removeFilter(t,i=!1){const r=this,s=t instanceof fe?t:r.filters.get(t);if(s){if(r.filters.remove(s),r._filtersFunction=null,!i){if(r.remoteFilter)return r.filter().then(()=>s);r.filter()}return s}}clearFilters(t=!0){if(this.filters.remove(this.filters.values.filter(i=>!i.internal)),t)return this.filter()}convertFilterToString(t){const i=this.filters.getBy("property",t);return i&&!i.filterBy?String(i):""}doDestroy(){var t;(t=this._filters)===null||t===void 0||t.destroy(),super.doDestroy()}};const bc={add:1,replace:1};var Un=u=>{var e;return e=class extends(u||$){static get properties(){return{collapsedGroups:new Set}}construct(i){super.construct(i),this.ion({change:"onDataChanged",thisObj:this})}updateGroupers(i){this.setGroupers(i)}setGroupers(i,r=null){const s=this,{storage:n}=s;let l;return i!=null&&i.length?s._groupers=i:s.groupers&&(delete s._groupers,s.includeCollapsed(),n.replaceValues({values:s.removeHeadersAndFooters(n._values),filteredValues:n.isFiltered?s.removeHeadersAndFooters(n._filteredValues):null,silent:!0}),l=s.group(null,null,null,!1,r==null?void 0:r.silent)),s._idMap=null,l}get groupRecords(){const i=[];if(this.isGrouped)for(const r of this)r.isSpecialRow&&i.push(r);return i}get unfilteredGroupRecords(){const i=this;if(i.isGrouped){var r;const{generation:s}=i.storage;((r=i._unfilteredGroupRecords)===null||r===void 0?void 0:r.generation)!==s&&(i._unfilteredGroupRecords=i.storage.allValues.filter(n=>n.isSpecialRow),i._unfilteredGroupRecords.generation=s)}return i._unfilteredGroupRecords||[]}getGroupHeaderForRecord(i,r=!1){if(this.isGrouped){let s;const n=r?this.storage._values:this.storage.values;for(const l of n)if(l.isGroupHeader){if(!i)s=l;else if(l===i||l.unfilteredGroupChildren.includes(i)){s=l;break}}return s}}includeCollapsed(){for(const i of this.collapsedGroups)this.expand(this.getById(i),!1)}excludeCollapsed(){for(const i of this.collapsedGroups)this.collapse(this.getById(i))}onDataChange({source:i,action:r,removed:s}){var n;const l=this,{groupers:o}=l;o&&(o.length?(r==="splice"&&s!==null&&s!==void 0&&s.length||r==="move")&&i.replaceValues({...l.prepareGroupRecords(),silent:!0}):i.replaceValues({values:l.removeHeadersAndFooters(i._values),filteredValues:i.isFiltered?l.removeHeadersAndFooters(i._filteredValues):null,silent:!0})),(n=super.onDataChange)===null||n===void 0||n.call(this,...arguments)}move(i,r){const s=this;if(s.isGrouped&&!s.tree){var n,l;let o=r;if((n=r)!==null&&n!==void 0&&n.isSpecialRow&&(o=s.getPrev(r,!1,!1),!o))return;const a=s.getGroupHeaderForRecord(o),c=s.groupers[0].field,d=a.meta.groupRowFor,{reapplyFilterOnUpdate:f}=s;if(s.reapplyFilterOnUpdate=!1,s.beginBatch(),i.forEach(g=>g.setValue(c,d)),s.endBatch(),s.reapplyFilterOnUpdate=f,s.isFiltered&&(l=r)!==null&&l!==void 0&&l.isSpecialRow){const{unfilteredGroupRecords:g}=s,h=g.indexOf(a);r=g[h+1]}}super.move(i,r)}collapse(i){return i&&!i.meta.collapsed?(this.excludeGroupRecords(i),i.meta.collapsed=!0,this.collapsedGroups.add(i.id),this.trigger("toggleGroup",{groupRecord:i,collapse:!0}),!0):!1}expand(i,r=!0){return i!=null&&i.meta.collapsed?(this.includeGroupRecords(i),i.meta.collapsed=!1,r&&this.collapsedGroups.delete(i.id),r&&this.trigger("toggleGroup",{groupRecord:i,collapse:!1}),!0):!1}removeHeadersAndFooters(i){return i.filter(r=>r.isSpecialRow?(this.unregister(r),!1):!0)}prepareGroupRecords(i){const r=this,{isFiltered:s,reapplyFilterOnUpdate:n,startGroupsCollapsed:l}=r,o=r.collapsedGroups,{allValues:a}=r.storage,c=[],d=r._groupVisibleRecordIds||[],f=S=>{const x=!s||r.filtersFunction(S);return n?x:x||d.includes(S.id)};for(const S of a)S.isGroupHeader&&(S.meta.collapsed||o.has(S.id))&&(o.add(S.id),c.push(S));for(const S of c)r.includeGroupRecords(S);const g=r.removeHeadersAndFooters(r.storage._values);i&&g.sort(i),s&&(r.filtersFunction=null);const h=[],p=r.groupers[0].field;let m=null,y=null,b=0;function C(){const S=y.meta.groupRowFor,x=`group-footer-${typeof S=="number"?S:k.createId(S)}`,L=r.getById(x)||new r.modelClass({id:x},r,{specialRow:!0,groupFooterFor:S,groupRecord:y});return L.stores=[r],r.register(L),L.groupChildren=y.groupChildren,y.meta.collapsed||h.push(L),r.allRecords.push(L),y.groupChildren.push(L),y.unfilteredGroupChildren.push(L),b++,L}g.forEach(S=>{var x;const L=S.getValue(p),O=L==null?"__novalue__":L,P=`group-header-${typeof O=="number"?O:k.createId(O)}`;if(((x=S.unfilteredGroupChildren)===null||x===void 0?void 0:x.length)===0){r.unregister(S);return}w.isEqual(O,m)||(y&&(r.useGroupFooters&&C(),y.meta.childCount=b),y=r.getById(P),y||(y=new r.modelClass({id:P},r,{specialRow:!0,groupRowFor:O,groupField:p}),l&&(o.add(P),r.startGroupsCollapsed=!1)),y.meta.collapsed=o.has(P),y.stores=[r],r.register(y),y.groupChildren=[],y.unfilteredGroupChildren=[],h.push(y),r.allRecords.push(y),m=O,b=0),S.instanceMeta(r.id).groupParent=y,o.has(P)||h.push(S),f(S)&&(y.groupChildren.push(S),b++),y.unfilteredGroupChildren.push(S)}),y&&(r.useGroupFooters&&C(),y.meta.childCount=b),r._idMap=null;const E={values:h};return s&&(E.filteredValues=h.filter(f)),E}get isGrouped(){var i;return!!(!((i=this.groupers)===null||i===void 0)&&i.length)}group(i,r,s=!1,n=!0,l=!1){const o=this;let a,c;if(i&&typeof i=="object"&&(r=i.ascending,c=i.fn,i=i.field),s)o.groupers.push(a={field:i,ascending:r,complexMapping:i.includes(".")});else if(i){if(r==null){var d,f;r=((d=o.groupInfo)===null||d===void 0?void 0:d.field)===i&&((f=o.groupInfo)===null||f===void 0?void 0:f.fn)===c?!o.groupInfo.ascending:!0}o.groupInfo=a={field:i,ascending:r,fn:c,complexMapping:i.includes(".")},o.groupers=[o.groupInfo]}if(a){const{prototype:g}=o.modelClass;a.complexMapping&&!Object.prototype.hasOwnProperty.call(g,i)&&Object.defineProperty(g,i,{get(){return w.getPath(this,i)}})}if(n!==!1){if(o.remoteSort&&!o.isRemoteDataLoading)return o.sort(null,null,!1,!0).then(()=>o.onAfterGrouping(l));o.sort(null,null,!1,!0)}o.onAfterGrouping(l)}onAfterGrouping(i){if(i)return;const r=this,s=r.groupers||[];r.trigger("group",{isGrouped:r.isGrouped,groupers:s,records:r.storage.values}),r.trigger("refresh",{action:"group",isGrouped:r.isGrouped,groupers:s,records:r.storage.values})}addGrouper(i,r=!0){return this.group(i,r,!0)}removeGrouper(i){const r=this,{groupers:s}=r;if(!s)return;const n=s.findIndex(l=>l.field===i);if(n>-1)return s.splice(n,1),s.length?r.group():r.clearGroupers()}clearGroupers(i=!1){return this.setGroupers(null,{silent:i})}isRecordInGroup(i,r){var s;if(!this.isGrouped)return null;const n=(s=this.groupers[0])===null||s===void 0?void 0:s.field;return i.getValue(n)===r&&!i.isSpecialRow}isInCollapsedGroup(i){const r=i.instanceMeta(this).groupParent;return r==null?void 0:r.meta.collapsed}getGroupRecords(i){return this.isGrouped?this.storage.values.filter(r=>this.isRecordInGroup(r,i)):null}getGroupTitles(){return this.isGrouped?this.getDistinctValues(this.groupers[0].field):null}onDataChanged({changes:i,action:r}){this.isGrouped&&(!i&&bc[r]||i&&this.groupers.some(s=>s.field in i))&&this.sort()}internalIncludeExcludeGroupRecords(i,r){const s=this,n=s.indexOf(i),l=s.allIndexOf(i),{id:o,storage:a}=s,{_filteredValues:c,_values:d}=a,{meta:f,groupChildren:g,unfilteredGroupChildren:h}=i;l===-1||f.collapsed&&!r||!f.collapsed&&r||(h.forEach(p=>p.instanceMeta(o).hiddenByCollapse=!r),r?(c&&c.splice(n+1,0,...g.filter(p=>!s.isAvailable(p))),a._values.splice(l+1,0,...h.filter(p=>!s.isAvailable(p)))):(c&&c.splice(n+1,g.length),d.splice(l+1,h.length)),a._indicesInvalid=!0,s._idMap=null)}excludeGroupRecords(i){this.internalIncludeExcludeGroupRecords(i,!1)}includeGroupRecords(i){this.internalIncludeExcludeGroupRecords(i,!0)}collectGroupRecords(i,r=!0){return(i?this.storage.allValues:this.storage.values).reduce((n,l)=>(l.isSpecialRow&&(r&&!l.isGroupFooter&&n.push(l),l.isGroupHeader&&n.push.apply(n,l.groupChildren)),n),[])}},R(e,"$name","StoreGroup"),R(e,"configurable",{groupers:null,useGroupFooters:!1,startGroupsCollapsed:null}),e},qn=u=>class extends(u||$){static get configurable(){return{objectify:null}}initProxy(){if(!globalThis.Proxy)throw new Error("Proxy not supported");return new Proxy(this,{get(i,r){if(r in i)return i[r];if(r==="$store")return i;let s=i.getById(r);return!s&&!isNaN(parseInt(r))&&(s=i.getAt(parseInt(r))),s},set(i,r,s){return r in i||i.isDestroying?i[r]=s:i.add({[i.modelClass.idField]:r,...s}),!0},deleteProperty(i,r){return i.isDestroying?(delete i[r],!0):!!i.remove(r).length},has(i,r){if(r in i)return!0;if(r.startsWith("{")&&r.endsWith("}")){const s=k.safeJsonParse(r);r=s==null?void 0:s.id}return i.includes(r)}})}},Kn=u=>{var e;return e=class extends(u||$){initRelations(i){const r=this,s=r.modelClass.exposedRelations;i&&r.modelRelations&&r.modelRelations.forEach(n=>{var l;return(l=n.storeDetacher)===null||l===void 0?void 0:l.call(n)}),(!r.modelRelations||r.modelRelations.length===0||i)&&s&&(r.modelRelations=[],s==null||s.forEach(n=>{const l={...n},{foreignStore:o,relationName:a,relatedCollectionName:c}=l,d=typeof o=="string"?r[o]:o;if(l.dependentStore=r,r.modelRelations.push(l),d){l.foreignStoreProperty=l.foreignStore,l.foreignStore=d;const f=d.dependentStoreConfigs;if(f.has(r)){const g=f.get(r);if(i){const h=g.find(p=>p.relationName===a);h&&j.remove(g,h)}g.push(l)}else f.set(r,[l]);c&&d.initRelationCollection(l,r),d.count>0&&d.updateDependentStores("dataset",d.records)}}))}initRelationCollection(i,r){const s=this,n=i.relatedCollectionName,l=s.collectionStores||(s.collectionStores={});l[n]={store:r,config:i},s[n+"Store"]||(s[n+"Store"]=r),s.count>0&&s.initModelRelationCollection(n,s.records)}initModelRelationCollection(i,r){const s=this;r.forEach(n=>{n.traverse(l=>{const o=i in l?`$related${k.capitalize(i)}`:i;Object.defineProperty(l,o,{enumerable:!0,configurable:!0,get:function(){return s.getCollection(this,i)},set:function(a){return s.setCollection(this,i,a)}})})})}resetRelationCache(){this.relationCache={},this.forEach(i=>i.initRelations())}updateRecordRelationCache(i,r){r==null||r.forEach(s=>{const{config:n}=s,l=s.related?s.related.id:i.getValue(n.foreignKey);l!==void 0&&this.cacheRelatedRecord(i,l,n.relationName,l)})}getRelationCollection(i,r){var s;const n=se.asId(r);return((s=this.relationCache[i])===null||s===void 0?void 0:s[n])||[]}getCollection(i,r){var s;const{config:n,store:l}=this.collectionStores[r];return((s=l.relationCache[n.relationName])===null||s===void 0?void 0:s[i.id])||[]}setCollection(i,r,s){const{config:n,store:l}=this.collectionStores[r],o=l.relationCache[n.relationName]||(l.relationCache[n.relationName]={}),a=(o[i.id]||[]).slice(),c=[],d=[];l.suspendEvents(),a.forEach(f=>{s.includes(f)||(f[n.foreignKey]=null,l.remove(f),d.push(f))}),s.forEach(f=>{f.isModel instanceof se?f.stores.includes(l)||(l.add(f),c.push(f)):([f]=l.add(f),c.push(f)),f[n.foreignKey]=i.id}),l.resumeEvents(),d.length&&(l.trigger("remove",{records:d}),l.trigger("change",{action:"remove",records:d})),c.length&&(l.trigger("add",{records:c}),l.trigger("change",{action:"add",records:c}))}cacheRelatedRecord(i,r,s,n=null){const l=this,o=l.relationCache[s]||(l.relationCache[s]={});n!==null&&l.uncacheRelatedRecord(i,s,n),r!=null&&j.include(o[r]||(o[r]=[]),i)}uncacheRelatedRecord(i,r=null,s=null){const n=this;function l(o,a){const c=n.relationCache[o],d=c==null?void 0:c[a];if(d){const f=d.indexOf(i);f>=0&&d.splice(f,1),d.length===0&&delete c[a]}}s!=null?l(r,s):i.meta.relationCache&&Object.entries(i.meta.relationCache).forEach(([o,a])=>l(o,a==null?void 0:a.id))}updateDependentStores(i,r){this.dependentStoreConfigs.forEach(s=>{s.forEach(n=>{const{dependentStore:l,relatedCollectionName:o,relationName:a,foreignKey:c}=n,d=l.relationCache[a];if(i==="dataset"){o&&this.initModelRelationCollection(o,r),l.forEach(f=>{const g=f.initRelation(n);g&&l.cacheRelatedRecord(f,g.id,a,g.id)});return}if(i==="removeall"){l.forEach(f=>f.removeRelation(n)),delete l.relationCache[a];return}i==="add"&&o&&this.initModelRelationCollection(o,r),(i==="add"||i==="remove")&&r.forEach(f=>{const g=d==null?void 0:d[f.id];switch(i){case"remove":g&&g.forEach(h=>h.removeRelation(n));break;case"add":l.forEach(h=>{h.getValue(c)==f.id&&(h.initRelation(n),l.cacheRelatedRecord(h,f.id,a))});break}})})})}updateDependentRecordIds(i,r){var s;(s=this.dependentStoreConfigs)===null||s===void 0||s.forEach(n=>{n.forEach(l=>{var o;const{dependentStore:a,relationName:c,foreignKey:d}=l,f=a.relationCache[c],g=f==null||(o=f[i])===null||o===void 0?void 0:o.slice();g==null||g.forEach(h=>{a.cacheRelatedRecord(h,r,c,i),h.set(d,r,!1,!0)})})})}},R(e,"$name","StoreRelation"),e},Yn=u=>class extends(u||$){static get $name(){return"StoreSum"}sum(t,i=this.storage.values){return i?i.reduce((r,s)=>{if(s.isSpecialRow)return r;const n=Number(s.getValue(t));return isNaN(n)?r:r+n},0):0}min(t,i=this.storage.values){return i!=null&&i.length?i.reduce((r,s)=>{const n=s.getValue(t);return typeof(n==null?void 0:n.valueOf())==="number"&&n<r&&(r=n),r},i[0].getValue(t)):0}max(t,i=this.storage.values){return i!=null&&i.length?i.reduce((r,s)=>{const n=s.getValue(t);return typeof(n==null?void 0:n.valueOf())==="number"&&n>r&&(r=n),r},i[0].getValue(t)):0}average(t,i=this.storage.values){if(!(i!=null&&i.length))return 0;let r=0;const s=i.reduce((n,l)=>{if(l.isSpecialRow)return n;const o=parseFloat(l.getValue(t));return isNaN(o)?n:(r++,n+o)},0);return r>0?s/r:0}groupSum(t,i){return this.sum(i,this.getGroupRecords(t))}};const zr=(u,e)=>String(u).toLowerCase().includes(e),Gn={string:zr,number:zr,boolean:zr,date:(u,e)=>u instanceof Date&&e instanceof Date?u-e===0:String(u.getMonth()+1).includes(e)||String(u.getDate()).includes(e)||String(u.getFullYear()).includes(e),object:(u,e)=>u===e,undefined:(u,e)=>u===e};var Xn=u=>class extends(u||$){static get $name(){return"StoreSearch"}search(t,i=null,r,s){const n=this.isTree&&!s?this.rootNode.allChildren:this.getAllDataRecords(s),l=n.length,o=[];if(t==null)return[];typeof t=="string"&&(t=t.toLowerCase());let a,c,d,f,g,h;for(a=0;a<l;a++){d=n[a],c=0;for(const m of i||d.fieldNames){var p;f=d.getValue(m),g=f instanceof Date?"date":typeof f;const y=r==null?void 0:r[c];y&&(f=y(f),g="string"),h=Gn[g],f&&(p=h)!==null&&p!==void 0&&p(f,t)&&o.push({index:a,data:d,field:m,id:d.id}),c++}}return o}findByField(t,i,r=!1,s=!1){const n=this.getAllDataRecords(s),l=n.length,o=new Set,a=[];let c,d,f;for(i!=null&&(i=String(i).toLowerCase()),c=0;c<l;c++)if(d=n[c],f=d.getValue(t),!r||!o.has(f)){const g=f instanceof Date?"date":typeof f,h=Gn[g];(i==null&&f===i||i&&h(f,i))&&(a.push({id:d.id,index:c,data:d}),r&&o.add(f))}return a}find(t,i=!1){return this.getAllDataRecords(i).find(t)}findRecord(t,i,r=!1){const s=n=>w.isEqual(n[t],i);return this.isTree?this.query(s,r)[0]:this.getAllDataRecords(r).find(s)}query(t,i=!1){if(this.isTree){const r=[];return this.traverse(s=>{t(s)&&r.push(s)},void 0,void 0,i),r}return this.getAllDataRecords(i).filter(t)}some(t,i=!1){return this.getAllDataRecords(i).some(t)}},Jn=u=>class extends(u||$){static get $name(){return"StoreSort"}static get defaultConfig(){return{useLocaleSort:null}}static get configurable(){return{sorters:[],reapplySortersOnAdd:!1}}get isSorted(){return!!this.sorters.length||this.isGrouped}changeSorters(t){return t.map(i=>this.normalizeSorterConfig(i,!0))}updateReapplySortersOnAdd(t){this.storage.autoSort=t}sort(t,i,r=!1,s=!1){const n=this,l=n.allRecords,o=n.sorters?n.sorters.slice():[];let a=null,c;if(t)if(Array.isArray(t))n.sorters=t.map(d=>n.normalizeSorterConfig(d,typeof d=="string"?!0:i));else{const d=n.normalizeSorterConfig(t,i);r?(c=n.getCurrentSorterByField(d.field),c?(a=c.ascending,c.ascending=d.ascending):n.sorters.push(d)):n.sorters=[d]}return!s&&n.trigger("beforeSort",{sorters:n.sorters,records:l,currentSorters:o})===!1?(n.sorters=o,a!==null&&(c.ascending=a),null):n.performSort(s)}normalizeSorterConfig(t,i){var o;const r=this,s={ascending:i};if(typeof t=="object"?(w.assign(s,t),t.fn&&(delete s.fn,s.sortFn=t.fn),s.ascending=(o=t.ascending)!=null?o:i):typeof t=="function"?s.sortFn=t:s.field=t,s.ascending==null){const a=r.getCurrentSorterByField(s.field);s.ascending=a?!a.ascending:!0}if(s.sortFn==null){var n,l;const a=(n=r.modelClass)===null||n===void 0||(l=n.$meta.fields.map[s.field])===null||l===void 0?void 0:l.compareItems;a&&(s.sortFn=a)}return s}getCurrentSorterByField(t){return typeof t=="string"&&this.sorters.find(i=>i.field===t)||null}addSorter(t,i=!0){return this.sort(t,i,!0)}removeSorter(t){const i=this.sorters.findIndex(r=>r.field===t||r.sortFn===t);if(i>-1)return this.sorters.splice(i,1),this.sort()}clearSorters(t=!1){if(this.sorters.length)return this.sorters.length=0,this.sort(void 0,void 0,void 0,t)}createSorterFn(t){const i=this.useLocaleSort;return(r,s)=>{for(let n=0;n<t.length;n++){const l=t[n],{field:o,ascending:a=!0,useLocaleSort:c=i}=l,d=l.fn||l.sortFn,f=a?1:-1;if(d){const p=d.call(l,r,s);if(p===0)continue;if(p!==null)return p*f}const g=r.isModel?r.getValue(o):r[o],h=s.isModel?s.getValue(o):s[o];if(g!==h){if(g==null)return-f;if(h==null)return f;if(c&&typeof g=="string"){if(c===!0)return String(g).localeCompare(h)*f;if(typeof c=="string")return String(g).localeCompare(h,c)*f;if(typeof c=="object")return String(g).localeCompare(h,c.locale,c)*f}if(g>h)return f;if(g<h)return-f}}return 0}}get sorterFn(){const t=this,{sorters:i}=t;return t.createSorterFn(t.remoteSort?[{field:"_remoteSortIndex"}]:t.isGrouped?t.groupers.concat(i):i)}performSort(t){const i=this,{rootNode:r,storage:s,sorterFn:n}=i;i.tree?(!i.isChained&&r.traverse(l=>{l.isLoaded&&l.isParent&&(l.children.sort(n),l.updateChildrenIndices(l.children,"parentIndex",!0))}),s.replaceValues({values:i.collectDescendants(r).visible,silent:!0})):i.isGrouped?s.replaceValues({...i.prepareGroupRecords(n),silent:!0}):s.replaceValues({values:s.values.sort(n),silent:!0}),i.afterPerformSort(t||i.isRemoteDataLoading)}afterPerformSort(t){if(t)return;const i=this;i._idMap=null;const r={action:"sort",sorters:i.sorters,records:i.allRecords};i.trigger("sort",r),i.trigger("refresh",r)}};const Zn=()=>!0;var Qn=u=>class extends(u||$){static get $name(){return"StoreChained"}static get defaultConfig(){return{chainedFilterFn:null,chainedFields:null,masterStore:null,doRelayToMaster:["add","remove","insert"],dontRelayToMaster:[],excludeCollapsedRecords:!0,chainSuspended:0}}static get properties(){return{chainedStores:null}}construct(t){super.construct(t);const i=this,{masterStore:r}=i,s=i.syncOrder?"sort":"";r&&(i.methodNamesToRelay.forEach(n=>i[n]=(...l)=>i.relayToMaster(n,l)),i.removeAll=(...n)=>{r.remove(i.getRange(),...n)},r.ion({changePreCommit:i.onMasterDataChangedPreCommit,change:i.onMasterDataChanged,[s]:i.onMasterDataChanged,prio:1,thisObj:i}),r.chainedStores||(r.chainedStores=[]),r.chainedStores.push(i),i.fillFromMaster())}get $master(){return this.masterStore||this}get isChained(){return!!this.masterStore}set chainedFilterFn(t){this._chainedFilterFn=this.thisObj?t.bind(this.thisObj):t}get chainedFilterFn(){return this._chainedFilterFn||Zn}get methodNamesToRelay(){const t=Array.isArray(this.doRelayToMaster),i=Array.isArray(this.dontRelayToMaster);return t&&this.doRelayToMaster.filter(r=>!i||!this.dontRelayToMaster.includes(r))||[]}updateChainedStores(){this.chainedStores&&this.chainedStores.forEach(t=>t.fillFromMaster())}fillFromMaster(){const t=this,{masterStore:i,isTree:r}=t;let s=[];if(!t.isChained)throw new Error("fillFromMaster only allowed on chained store");if(!t.isChainSuspended){if(i.isGrouped&&i.isFiltered?i.forEach(n=>s.push(n),i,{includeFilteredOutRecords:!0,includeCollapsedGroupRecords:!0}):s=i.allRecords.filter(n=>!n.isSpecialRow&&t.chainedFilterFn(n)),r&&(t.idRegister={},t.internalIdRegister={},s.forEach(n=>{n.stores.includes(t)?t.register(n):n.joinStore(t)}),t.excludeCollapsedRecords)){const n=t.getChildren(t.rootNode);s=t.doIncludeExclude(n,!0)}t.isFillingFromMaster=!0,t.data=s,t.isFillingFromMaster=!1}}commitToMaster(){const t=this,i=t.masterStore;if(!t.isChained)throw new Error("commitToMaster only allowed on chained store");return i.beginBatch(),i.remove(t.removed.values),i.add(t.added.values),i.endBatch(),t.commit()}relayToMaster(t,i){return this.masterStore[t](...i)}onMasterDataChangedPreCommit(t){this.onMasterDataChanged(t),this.$masterEventhandled=!0}onMasterDataChanged({action:t,changes:i,$handled:r,isMove:s}){var n;if(this.$masterEventhandled){this.$masterEventhandled=!1;return}s&&t==="remove"||(t!=="update"||(n=this.chainedFields)!==null&&n!==void 0&&n.some(l=>l in i))&&this.fillFromMaster()}makeChained(t=Zn,i,r){return new((r==null?void 0:r.storeClass)||this.constructor)({...r||{},tree:!1,autoTree:!1,masterStore:this.$master,modelClass:this.modelClass,syncDataOnLoad:!1,chainedFilterFn:t,chainedFields:i})}chain(){return this.makeChained(...arguments)}doDestroy(){var t;(t=this.chainedStores)===null||t===void 0||t.forEach(i=>i.destroy()),super.doDestroy()}suspendChain(){this.chainSuspended++}resumeChain(t=!1){this.chainSuspended&&!--this.chainSuspended&&t&&this.fillFromMaster()}get isChainSuspended(){return this.chainSuspended>0}},el=u=>class extends(u||$){static get $name(){return"StoreState"}getState(){const{sorters:t,groupers:i,filters:r}=this,s={};return t!=null&&t.length&&(s.sorters=t.map(n=>{const l=w.cleanupProperties(w.clone(n));return delete l.fn,delete l.sortFn,l})),i!=null&&i.length&&(s.groupers=i.map(n=>{const l=w.cleanupProperties(w.clone(n));return delete l.fn,l})),r!=null&&r.values.length&&(s.filters=r.values.map(n=>{const l=w.cleanupProperties(w.clone(n.config));return l.value=n.value,l.caseSensitive&&delete l.caseSensitive,l})),s}applyState(t){const i=this,{sorters:r=[],groupers:s=[],filters:n=[]}=t,{sortParamName:l,filterParamName:o}=i;i.sorters=r.filter(a=>a.field||a.sortFn&&!l),i.groupers=s.slice(),i.sort(),i.filters=n.filter(a=>a.property||a.filterBy&&!o),i.filter()}};const Cc=u=>String(u).padStart(6,"0");class Ee{constructor(e){this.value=e,this._padded=null}set value(e){this._value=String(e!=null?e:"")}get value(){return this._value}static from(e){return e==null||e instanceof Ee?e:new Ee(e)}static pad(e){return e instanceof Ee?e.valueOf():Ee.split(e).map(Cc).join(".")}static split(e){let t,i;if(e||e===0)switch(typeof e){case"object":e=String(e);case"string":for(i=e.split("."),t=i.length;t-- >0;)i[t]=parseInt(i[t],10);break;case"number":i=[e];break}return i||[]}static compare(e,t){return e===t?0:!e||!t?e?1:t?-1:0:(e=Ee.pad(e),t=Ee.pad(t),e<t?-1:t<e?1:0)}append(e){const t=this.value;return Ee.from(t?`${t}.${e}`:e)}isEqual(e){return!Ee.compare(this,e)}match(e){let t=!1;if(e){const i=this.value,r=e[0]==="*",s=e.endsWith("*"),n=e.length;r===s?t=i.indexOf(r?e.substr(1,n-2):e)>-1:r?t=i.endsWith(e.substr(1)):t=i.startsWith(e.substr(0,n-1))}return t}toString(){return this.value}toJSON(){return this.toString()}valueOf(){var e;return(e=this._padded)!=null?e:this._padded=Ee.pad(this.value)}}Ee._$name="Wbs";const wc=Object.freeze([]),ii=Symbol("StopBranch");var tl=u=>{var e;return e=class extends(u||$){get StopBranch(){return ii}get isTree(){return this.tree||this.masterStore&&this.masterStore.tree}get leaves(){const i=this,r=[];return i.isTree?(i.traverse(s=>{s.isLeaf&&r.push(s)}),r):(i.allRecords.forEach(s=>{s.isLeaf&&r.push(s),s.traverse(n=>{n.isLeaf&&r.push(n)},!0)}),r)}async loadChildren(i){}onNodeAddChild(i,r,s,n,l=!1){const o=this,a=i===o.rootNode&&i.isLoading,{storage:c}=o,{previousSibling:d}=r[0];let f;const{visible:g,all:h}=o.collectDescendants(r,void 0,void 0,{inCollapsedBranch:!(i.isExpanded(o)&&i.ancestorsExpanded(o)),applyFilter:o.isFiltered&&o.reapplyFilterOnAdd});if(!a&&h.length)for(const m of h)!o.modified.includes(m)&&!n[m.id]&&(o.removed.includes(m)?o.removed.remove(m):m.isLinked||o.added.add(m));if(a&&o.rootVisible&&(g.unshift(i),h.unshift(i)),g.length?(s===0||!d?f=c.indexOf(i):f=c.indexOf(d)+d.getDescendantCount(!0,o),c.suspendEvents(),o.storage.splice(++f,0,g),c.resumeEvents(),o._idMap=null):o._allRecords=null,o.updateDependentStores("add",r),a&&g.length){var p;if(o.sorters.length&&o.sort(null,null,!1,!0),(p=o.afterLoadData)===null||p===void 0||p.call(o),!l){const m={action:"dataset",data:o._data,records:g};o.trigger("refresh",m),o.trigger("change",m)}}else if(!l){const m={action:"add",parent:i,isChild:!0,isMove:n,records:r,allRecords:h,index:f};if(o.trigger("add",m),o.trigger("change",m),Object.values(n).some(y=>y)){const y={newParent:i,records:r.filter(b=>n[b.id]),oldParents:r.map(b=>o.getById(b.meta.oldParentId))};o.trigger("move",y)}}}onNodeRemoveChild(i,r,s,n={isMove:!1,silent:!1,unfiltered:!1}){const l=this,{storage:o}=l,a=[],c=[],{isMove:d,silent:f,unfiltered:g}=n,h=g&&l.isFiltered,p=h&&i.unfilteredChildren?i.unfilteredChildren:r;if(l.collectDescendants(p,a,c,{inCollapsedBranch:!(i.isExpanded(l)&&i.ancestorsExpanded(l)),unfiltered:h}),!d){for(const m of r)m.unjoinStore(l);for(const m of c)m.stores.includes(l)&&m.unjoinStore(l),l.added.includes(m)?l.added.remove(m):m.isLinked||l.removed.add(m);l.modified.remove(c)}if(a.length?(s=o.indexOf(a[0]),s>-1&&(o.suspendEvents(),o.splice(s,a.length),o.resumeEvents(),l._idMap=null)):(s=-1,l._allRecords=null),!f&&(l.fireRemoveEventForMoveAction||!d)){const m={action:"remove",parent:i,isChild:!0,isMove:d,records:r,allRecords:c,index:s};l.trigger("remove",m),l.trigger("change",m)}return c}collectDescendants(i,r=[],s=[],n={}){var f;const l=this,{inCollapsedBranch:o=!1,unfiltered:a=!1,applyFilter:c=!1}=n,d=Array.isArray(i)?i:(f=l.getChildren(i,a))!=null?f:[];if(c)return{visible:d.flatMap(g=>this.collectVisibleNodeDescendantsFiltered(g)),all:d.flatMap(g=>g.allChildren)};for(let g=0,h=d.length,p;g<h;g++)p=d[g],o||r.push(p),s.push(p),l.collectDescendants(p,r,s,{inCollapsedBranch:o||!p.isExpanded(l),unfiltered:a});return{visible:r,all:s}}collectVisibleNodeDescendantsFiltered(i){const r=i.unfilteredChildren||i.children;if(!r||r.length===0||!i.isLeaf&&!i.isExpanded(this))return this.filtersFunction(i)?[i]:[];const s=r.flatMap(n=>this.collectVisibleNodeDescendantsFiltered(n));return s.length||this.filtersFunction(i)?[i,...s]:[]}getChildren(i,r=!1){const s=this,n=(r||s.isChained)&&i.unfilteredChildren||i.children;return n!=null&&n.length?s.isChained?n.filter(s.chainedFilterFn).sort(s.sorterFn):n:wc}internalToggleTreeSubRecords(i,r){const s=this,{storage:n}=s,l=n.indexOf(i),o=s.doIncludeExclude(s.getChildren(i),r);if(s.isFiltered&&r&&i.unfilteredChildren&&s.updateChildrenHiddenState(i),o.length&&l!==!1){if(n.suspendEvents(),r){n.splice(l+1,0,...o);const a={action:"add",isExpand:!0,records:o,index:l+1};s.trigger("add",a),s.trigger("change",a)}else{n.splice(l+1,o.length);const a={action:"remove",isCollapse:!0,records:o,index:l+1};s.trigger("remove",a),s.trigger("change",a)}n.resumeEvents(),s._idMap=null}}updateChildrenHiddenState(i){var r;(r=i.unfilteredChildren)===null||r===void 0||r.forEach(s=>{s.instanceMeta(this.id).hidden=!1,s.isLeaf||this.updateChildrenHiddenState(s)})}doIncludeExclude(i,r,s=[]){const n=this,l=(i==null?void 0:i.length)||0;for(let o=0;o<l;o++){const a=i[o];if(!n.isChained||n.chainedFilterFn(a)){const c=a.instanceMeta(n.id);(r||!c.hidden)&&s.push(a),c.hidden=!r,a.isExpanded(n)&&n.doIncludeExclude(n.getChildren(a),r,s)}}return s}async toggleCollapse(i,r){const s=this,n=s.getById(i),l=n.instanceMeta(s);if(r===void 0&&(r=!l.collapsed),!l.isLoadingChildren&&!n.isLeaf&&n.isExpanded(s)===r){if(s.trigger("beforeToggleNode",{record:n,collapse:r}),l.collapsed=r,l.collapsed)return s.onNodeCollapse(n),!0;{s.onNodeExpand(n);let o=!0;if(!n.isLoaded){l.isLoadingChildren=!0;try{await s.loadChildren(n)}catch(a){l.collapsed=!0,o=!1,s.trigger("loadChildrenException",{record:n,exception:a})}finally{l.isLoadingChildren=!1}}return o}}}onNodeCollapse(i){if(i.ancestorsExpanded(this))return this.internalToggleTreeSubRecords(i,!1)}onNodeExpand(i){if(i.ancestorsExpanded(this))return this.internalToggleTreeSubRecords(i,!0)}transformToTree(i){const{parentIdField:r,idField:s,childrenField:n}=this.modelClass,l=new Map,o=new Set,a=[];for(const d of i){const f=d[s];f!=null&&l.set(f,d),d[r]!=null&&o.add(d[r])}const c=d=>{const f=Object.assign({},d);return f[n]=[],l.set(f.id,f),f};for(let d of i){o.has(d.id)&&!d[n]&&(d=c(d));const f=d[r];if(f!=null){let g=l.get(f);g&&(g[n]||(g=c(g)),g[n].push(d))}else d[n]?a.push(d):d[s]!=null?a.push(c(d)):a.push(d)}return a}treeify(i,r,s=!1){const{length:n}=i,l=[],o=[],a={};let c,d;for(c=0;c<n;c++){let g=i[c];g=g.field||g,i[c].call||(i[c]=h=>h[g],i[c].fieldName=g),l[c]=new Map}this.rootNode.traverse(g=>{if(d=null,g.isLeaf){for(c=0;c<n;c++){var h;const p=((h=d)===null||h===void 0?void 0:h.path)||"",m=l[c],y=i[c](g);if(y===ii)break;const b=`${p+(y!=null&&y.isModel?y.id:y)}/`,C=k.makeValidDomId(`generated_${b}`,"_"),E=i[c].fieldName,S=m.get(C)||m.set(C,{id:C,key:y,path:b,expanded:!0,readOnly:!0,children:[],generatedParent:!0,field:E,firstGroupChild:g}).get(C);d&&!d.children.includes(S)&&d.children.push(S),d=S}d?d.children.push(g):o.push(g)}},!0),(r||s)&&l.forEach(g=>g.forEach((h,p,m)=>{r==null||r(h),s&&(h=this.createRecord(h),m.set(p,h))})),a.children=[...l[0].values(),...o];const f=g=>{g.children&&(g.children.sort((h,p)=>{if(h.isLeaf===p.isLeaf)if(h.isLeaf){let m;for(let y=0;!m&&y<n;y++){const b=i[y](h),C=i[y](p);if(b===ii||C===ii)return h.isLeaf<p.isLeaf?-1:h.isLeaf>p.isLeaf?1:0;m=b<C?-1:C>b?1:0}return m}else return typeof h.key=="string"&&typeof p.key=="string"?h.key.localeCompare(p.key,void 0,{numeric:!0}):h.key<p.key?-1:h.key>p.key?1:0;else return h.isLeaf<p.isLeaf?-1:h.isLeaf>p.isLeaf?1:0}),g.children.forEach(f))};return f(a),a}treeifyFlatData(i){const{childrenField:r,parentIdField:s}=this.modelClass;let n=!1,l=!0;for(const o of i){if(o.isModel||Array.isArray(o[r])){l=!1;break}o[s]!=null&&(n=!0)}return l&&n&&(i=this.transformToTree(i)),i}async indent(i){const r=this;if(i=Array.isArray(i)?i:[i],i=i.filter(s=>{let n=!!s.previousSibling;for(;n&&!s.isRoot;)n=!i.includes(s.parent),s=s.parent;return n}),i.length&&r.trigger("beforeIndent",{records:i})!==!1){i.sort((s,n)=>Ee.compare(s.wbsCode,n.wbsCode)),r.beginBatch();for(const s of i){const n=s.previousSibling;n.appendChild(s),r.toggleCollapse(n,!1)}r.endBatch(),r.trigger("indent",{records:i}),r.trigger("change",{action:"indent",records:i})}}async outdent(i){const r=this;if(i=Array.isArray(i)?i:[i],i=i.filter(s=>{const{parent:n}=s;let l=n&&!n.isRoot;for(;l&&!s.isRoot;)l=!i.includes(n),s=s.parent;return l}),i.length&&r.trigger("beforeOutdent",{records:i})!==!1){i.sort((s,n)=>Ee.compare(s.wbsCode,n.wbsCode)),r.beginBatch();for(const s of i){const{parent:n}=s,l=n.children.slice(n.children.indexOf(s)+1);n.parent.insertChild(s,n.nextSibling),s.appendChild(l),r.toggleCollapse(s,!1)}r.endBatch(),r.trigger("outdent",{records:i}),r.trigger("change",{action:"outdent",records:i})}}},R(e,"$name","StoreTree"),R(e,"StopBranch",ii),R(e,"configurable",{transformFlatData:null,fireRemoveEventForMoveAction:ne.checkVersion("core","6.0","<")}),e};class _i{static preWalk(e,t,i){const r=[e];let s,n;for(;r.length;)s=r.pop(),i(s),n=t(s),n&&r.push.apply(r,n.slice().reverse())}static preWalkWithParent(e,t,i){const r=[{node:e,parent:null}];for(;r.length;){const{parent:s,node:n}=r.pop();i(s,n);const l=t(n);Array.isArray(l)&&r.push(...l.slice().reverse().map(o=>({node:o,parent:n})))}}static preWalkUnordered(e,t,i){const r=[e];let s,n;for(;r.length;)s=r[r.length-1],i(s),n=t(s),n?r.splice(r.length-1,1,...n):r.length=r.length-1}static postWalk(e,t,i){const r=new Map,s=[e];let n,l;for(;s.length;)n=s[s.length-1],r.has(n)?(i(n),s.pop()):(l=t(n),l&&s.push(...l.slice().reverse()),r.set(n,n))}static prePostWalk(e,t,i,r){const s=new Map,n=[e];let l,o;for(;n.length;)l=n[n.length-1],s.has(l)?(r(l),n.pop()):(i(l),o=t(l),o&&n.push(...o.slice().reverse()),s.set(l,l))}}_i._$name="WalkHelper";var il=u=>class extends(u||$){static get $name(){return"StoreSync"}static get configurable(){return{syncDataOnLoad:null,shouldSyncDataset:null,shouldSyncRecord:null}}syncDataset(t){var i;const r=this,{storage:s}=r,n=(i=r.shouldSyncDataset)===null||i===void 0?void 0:i.call(r,{data:t});if(n===!1)return;r.isSyncingDataOnLoad=!0;const{toAdd:l,toRemove:o,toMove:a,updated:c,ids:d}=r.tree?r.syncTreeDataset(t,n):r.syncFlatDataset(t,n);let{threshold:f}=r.syncDataOnLoad,g=!1;if(f&&(typeof f=="string"&&(f=parseInt(f,10)/100*r.count),g=l.length+o.length+a.length+c.length>f),r.tree){if(l.length&&r.add(l,g).forEach(m=>m.clearParentId()),a.length)for(const{parent:p,node:m,index:y}of a)r.getById(p.id).insertChild(m,y);r.remove(o,g)}else g&&r.suspendEvents(),r.remove(o),r.add(l),g&&r.resumeEvents();f&&!g&&c.forEach(({record:p,toSet:m,wasSet:y})=>r.onModelChange(p,m,y)),r.acceptChanges();const h={added:l,removed:o,updated:c,thresholdSurpassed:g};if(r.isFiltered&&!r.remoteFilter&&r.filter({silent:r.isRemoteDataLoading}),r.isGrouped)r.group(null,null,!1,!0,r.isRemoteDataLoading);else if(r.isSorted)r.remoteSort?s.replaceValues({values:s.values.sort(r.createSorterFn(r.sorters)),silent:!0}):r.sort();else if(!r.tree)s.values.some((p,m)=>p.id!==d[m])&&(s.replaceValues({values:s.values.sort((p,m)=>d.indexOf(p.id)-d.indexOf(m.id)),silent:!0}),!g&&r.afterPerformSort());else{let p=!1,m=0;_i.preWalk(r.rootNode,y=>Array.isArray(y.children)&&!p?y.children:null,y=>{y.id!==d[m++]&&(p=!0)}),p&&(r.sort((y,b)=>d.indexOf(y.id)-d.indexOf(b.id),void 0,void 0,!0),r.clearSorters(!0),!g&&r.afterPerformSort())}g&&r.trigger("refresh",{action:"batch",data:t,records:s.values,syncInfo:h}),r.isSyncingDataOnLoad=!1,r.trigger("loadSync",h)}syncFlatDataset(t,i){if(!t)return{toRemove:this.records};const r=this,{idField:s,allFields:n}=r.modelClass,l=[],o=[],a=[],c={},d=[],f=Array.isArray(i),{threshold:g,keepMissingValues:h}=r.syncDataOnLoad;let p=0;if(t.forEach(m=>{m=m.isModel?m.data:m;const y=m[s],b=r.getById(y);if(!f||i.includes(y))if(b){var C;if(((C=r.shouldSyncRecord)===null||C===void 0?void 0:C.call(r,{record:b,data:m}))!==!1){if(h===!1)for(const S of n)!(S.dataSource in m)&&S.dataSource in b.data&&(m[S.dataSource]=S.defaultValue);const E=b.set(m,null,!!g);E&&a.push({record:b,wasSet:E,toSet:m})}}else o.push(r.processRecord(r.createRecord(m)));b&&p++,c[y]=1,d.push(y)}),p<r.storage.totalCount)if(i)for(const m of i)c[m]||l.push(r.getById(m));else r.forEach(m=>{c[m.id]||l.push(m)});return{toAdd:o,toRemove:l,toMove:[],updated:a,ids:d}}syncTreeDataset(t){if(!t)return{toRemove:this.records};const i=this,{idField:r,parentIdField:s,childrenField:n,allFields:l}=i.modelClass,{keepMissingValues:o,threshold:a}=i.syncDataOnLoad,c=[],d=[],f=[],g=[],h=new Set,p=[];return i.transformFlatData&&(t=i.treeifyFlatData(t)),_i.preWalkWithParent({isRoot:!0,id:i.rootNode.id,children:t},m=>m.children,(m,y)=>{if(m){const{id:C,node:E}=i.resolveSyncNode(y);if(E){var b;if(((b=i.shouldSyncRecord)===null||b===void 0?void 0:b.call(i,{record:E,data:y}))!==!1){let S;const x=E.children;if(x!==!0&&y[n]===!0&&(E.clearChildren(),E.data[n]=E.children=!0,delete y[n],i.toggleCollapse(E,!0),S=!0),E.parent.id!==m[r]&&f.push({node:E,parent:m,index:m[n].indexOf(y)}),o===!1)for(const O of l)O.name!=="parentId"&&!(O.dataSource in y)&&O.dataSource in E.data&&(y[O.dataSource]=O.defaultValue);const L=E.set(y,null,!!a);L?g.push({record:E,wasSet:L,toSet:y}):S&&E.signalNodeChanged({[n]:{value:!0,oldValue:x}})}}else y[s]=m[r],d.push({...y,...Array.isArray(y[n])?{children:[]}:void 0});h.add(E),p.push(C)}}),h.length!==t.length&&i.traverse(m=>{h.has(m)||c.push(m)}),{toAdd:d,toRemove:c,toMove:f,updated:g,ids:p}}resolveSyncNode(t){const i=t[this.modelClass.idField],r=this.getById(i);return{id:i,node:r}}};const rl=Symbol("STM_PROP");var sl=u=>class extends(u||$){static get $name(){return"StoreStm"}static get defaultConfig(){return{stm:null,ignoreRemoteChangesInSTM:!1}}get stm(){return this[rl]}set stm(t){const i=this;if(i.stm!==t){var r;(r=i.stm)!==null&&r!==void 0&&r.hasStore(i)&&i.stm.removeStore(i),i[rl]=t,i.stm&&!i.stm.hasStore(i)&&i.stm.addStore(i)}}add(t,i=!1,r={}){let s;const{stm:n}=this;if(!this.tree&&n!==null&&n!==void 0&&n.enabled){var l;s=super.add(t,i),(l=s)!==null&&l!==void 0&&l.length&&n.onStoreModelAdd(this,s,i)}else s=super.add(t,i,r);return s}insert(t,i,r=!1){let s;const{stm:n}=this;if(!this.tree&&n!==null&&n!==void 0&&n.enabled){var l;const o=(Array.isArray(i)?i:[i]).reduce((a,c)=>{const d=c instanceof se?this.indexOf(c):void 0;return d!==void 0&&d!==-1&&a.set(c,d),a},new Map);s=super.insert(t,i),(l=s)!==null&&l!==void 0&&l.length&&(t=this.indexOf(s[0]),n.onStoreModelInsert(this,t,s,o,r))}else s=super.insert(t,i,r);return s}remove(t,i=!1,r){let s;const{stm:n}=this;if(!this.tree&&n!==null&&n!==void 0&&n.enabled){var l;const a=(Array.isArray(t)?t:[t]).map(c=>this.getById(c)).filter(c=>!!c).reduce((c,d)=>{const f=this.indexOf(d);return f!==void 0&&f!==-1&&c.set(d,f),c},new Map);s=super.remove(t,i,r),(l=s)!==null&&l!==void 0&&l.length&&n.onStoreModelRemove(this,s,a,i)}else s=super.remove(t,i,r);return s}removeAll(t){const{stm:i}=this;let r;if(i!=null&&i.enabled){const{tree:s,rootNode:n,allRecords:l}=this,o=l.length,a=s?n.children.slice():l.slice();r=super.removeAll(t),o&&this.count===0&&i.onStoreRemoveAll(this,a,t)}else r=super.removeAll(t);return r}beforeApplyChangeset(){const{stm:t,crudManager:i}=this;let r=!1,s=null;return!(i!=null&&i.applyingChangeset)&&t!==null&&t!==void 0&&t.enabled&&(r=!0,t.isRecording&&(s=t.stash()),this.ignoreRemoteChangesInSTM?t.disable():t.startTransaction()),{shouldResume:r,transactionId:s}}applyChangeset(t,i,r,s,n){const{shouldResume:l,transactionId:o}=this.beforeApplyChangeset(),a=super.applyChangeset(t,i,r,s,n);return this.afterApplyChangeset(l,o),a}afterApplyChangeset(t,i){if(t){const{stm:r}=this;this.ignoreRemoteChangesInSTM?r.enable():r.stopTransaction(),r.applyStash(i)}}};const Sc={splice:1,clear:1},Ec={includeFilteredOutRecords:!1,includeCollapsedGroupRecords:!1},Br=(u,e)=>(e=e||!1,typeof e=="boolean"&&(e={includeFilteredOutRecords:e,includeCollapsedGroupRecords:!1}),e||Ec);class ie extends $.mixin(rt,Gt,Oe,wn,Lr,Wn,Hn,jn,Kn,Yn,Xn,Jn,Un,Qn,el,tl,sl,il,qn){static get $name(){return"Store"}static get properties(){return{relationCache:{},dependentStoreConfigs:new Map}}static get configurable(){return{id:!0,modelClass:se,verifyNoGeneratedIds:!0}}static get defaultConfig(){return{fields:null,autoTree:!0,data:null,tree:!1,callOnFunctions:!0,storage:null,useRawData:!1,allowNoId:!0,preventSubClassingModel:null}}static get identifiable(){return{registerGeneratedId:!1}}constructor(...e){if(super(...e),this.objectify)return this.initProxy()}construct(e={}){const t=this;Object.assign(t,{added:new Ai,removed:new Ai,modified:new Ai,idRegister:{},internalIdRegister:{},oldIdMap:{}}),e.storeId&&(e=w.assign({id:e.storeId},e)),super.construct(e),t.initRelations()}static from(e,t={},i=null){return e&&!e.isStore&&(typeof e=="string"?e=ie.getStore(e):(Array.isArray(e)&&(i&&(e=e.map(r=>r.isModel?r:i(r))),e=w.assign({},t,{data:e})),e=new ie(e))),e}doDestroy(){var e,t,i;const r=this,s=r.registeredRecords;(e=r.stm)===null||e===void 0||(t=e.removeStore)===null||t===void 0||t.call(e,r);for(let o=s.length-1,a;o>=0;o--){var n;a=s[o],(n=a)!==null&&n!==void 0&&n.isDestroyed||a.unjoinStore(r)}if((i=r._storage)===null||i===void 0||i.destroy(),!r.isChained){var l;(l=r.rootNode)===null||l===void 0||l.destroy()}super.doDestroy()}beginBatch(){this.suspendEvents()}endBatch(){this.resumeEvents()&&this.trigger("refresh",{action:"batch",data:this.storage.values,records:this.storage.values})}set storage(e){const t=this;e!=null&&e.isCollection?t._storage=e:t._storage=new Ge(e),t._storage.autoFilter=t.reapplyFilterOnAdd,t._storage.autoSort=t.reapplySortersOnAdd;for(const i of t._storage)i.joinStore(t);t._storage.ion({change:"onDataChange",thisObj:t})}get storage(){return this._storage||(this.storage={}),this._storage}get allRecords(){var e;const t=this;if(((e=t._allRecords)===null||e===void 0?void 0:e.generation)!==t.storage.generation){if(t.isTree){const i=t.collectDescendants(t.rootNode,void 0,void 0,{unfiltered:!0}).all;t.rootVisible&&i.unshift(t.rootNode),t._allRecords=i}else t._allRecords=t.isGrouped?t.collectGroupRecords():t.storage.allValues;t._allRecords.generation=t.storage.generation}return t._allRecords}getAllDataRecords(e){const t=this;return t.tree?e?t.allRecords:t.rootNode.allChildren:t.isGrouped?t.collectGroupRecords(e,!1):e?t.storage.allValues:t.storage.values}onIsCreatingToggle(e,t){const i=this,r=e.isPersistable&&!t;i.added[r?"add":"remove"](e),r&&(i.trigger("addConfirmed",{record:e}),i.autoCommit&&i.doAutoCommit())}joinRecordsToStore(e){const{allCount:t}=this;for(let i=0;i<e.length;i++){const r=e[i];r.setData("parentIndex",t+i-e.length),r.joinStore(this)}}onDataChange({source:e,action:t,added:i,removed:r,replaced:s,oldCount:n,items:l,from:o,to:a}){const c=this,d=Sc[t],f=d&&(i==null?void 0:i.length),g=d&&(r==null?void 0:r.length);let h,p;if(c._idMap=null,f&&c.joinRecordsToStore(i),s==null||s.forEach(([m,y])=>{m.unjoinStore(c,!0),y.joinStore(c)}),super.onDataChange(...arguments),!c.isTree){if(f){for(const m of i)c.removed.includes(m)?c.removed.remove(m):m.isLinked||c.added.add(m);h=!c.remoteFilter&&c.isFiltered&&c.reapplyFilterOnAdd,h&&c.filter({silent:!0}),p=!c.remoteSort&&c.isSorted&&c.reapplySortersOnAdd,p&&c.sort(null,null,!1,!0)}if(g){for(const m of r)m.cancelBatch(),m.unjoinStore(c),c.added.includes(m)?c.added.remove(m):!m._undoingInsertion&&!m.isCreating&&!m.isLinked&&c.removed.add(m);c.modified.remove(r),h=!c.remoteFilter&&c.isFiltered,h&&c.filter({silent:!0})}}switch(t){case"clear":c.relationCache={},c.updateDependentStores("removeall"),c.trigger("removeAll"),c.trigger("change",{action:"removeall"});break;case"splice":if(f){c.updateDependentStores("add",i);const m=i.reduce((C,E)=>{const{previousIndex:S}=E.meta;return S>-1&&S<C&&(C=S),C},i[0].meta.previousIndex),y=e.indexOf(i[0],!e.autoFilter),b={records:i,index:y};m>-1&&(b.oldIndex=m),c.trigger("add",b),c.trigger("change",Object.assign({action:"add"},b)),h&&c.triggerFilterEvent({action:"filter",filters:c.filters,oldCount:n,records:c.storage.allValues}),p&&c.trigger("sort",{action:"sort",sorters:c.sorters,records:c.storage.allValues})}r.length&&(c.updateDependentStores("remove",r),c.trigger("remove",{records:r}),c.trigger("change",{action:"remove",records:r})),s.length&&(c.trigger("replace",{records:s,all:c.records.length===s.length}),c.trigger("change",{action:"replace",replaced:s,all:c.records.length===s.length}));break;case"filter":(c.isGrouped||c.isSorted)&&c.performSort(!0);break;case"move":{const m=Math.min(o,a),y=Math.min(c.storage.allValues.length-1,Math.max(o,a));for(let b=c.storage.allValues,C=m;C<=y;C++)b[C].setData("parentIndex",C);c.trigger("move",{record:l[0],records:l,from:o,to:a}),c.isFiltered&&c.performFilter(),c.trigger("change",{action:t,record:l[0],records:l,from:o,to:a});break}}}onDataReplaced(e,t){var i;const r=this,{storage:s}=r,n=s.allValues,l=r.sorters.length>0;for(let a=0;a<n.length;a++)n[a].joinStore(r);if(!r.remoteFilter&&r.isFiltered&&r.filter({silent:!0}),r.remoteSort?r.isGrouped&&s.replaceValues({...r.prepareGroupRecords(),silent:!0}):(r.isGrouped&&r.group(null,null,!1,!l,!0),l&&r.sort(null,null,!1,!0)),!r.useRawData.disableDuplicateIdCheck){const{idMap:a}=r;if(Object.keys(a).length<s.values.length){const c=[];throw s.values.forEach(d=>a[d.id]?delete a[d.id]:c.push(d)),new Error(`Id collision on ${c.map(d=>d.id)}`)}}const o={action:e,data:t,records:s.values};r.updateDependentStores(e,o.records),(i=r.afterLoadData)===null||i===void 0||i.call(r),r.isRemoteDataLoading||r.trigger("refresh",o),r.trigger("change",o)}onModelChange(e,t,i,r,s){const n=this,l={record:e,records:[e],changes:i,batch:e.batching!=null,fromRelationUpdate:s},o=e.ignoreBag||e.isLinked?!1:n.updateModifiedBagForRecord(e);if(n.storage.onItemMutation(e,i),"id"in i){const{oldValue:a,value:c}=t.id;n.updateDependentRecordIds(a,c),n.onRecordIdChange({record:e,oldValue:a,value:c})}if(!r){if("id"in i){const{oldValue:a,value:c}=t.id;n.trigger("idChange",{store:n,record:e,oldValue:a,value:c})}n.onUpdateRecord(e,i),n.trigger("update",l),n.trigger("change",Object.assign({action:"update"},l))}n.autoCommit&&o&&n.doAutoCommit()}updateModifiedBagForRecord(e){const t=this;let i=!1;return e.isModified?!t.modified.includes(e)&&!t.added.includes(e)&&e.isPartOfStore(t)&&!e.isAutoRoot&&(e.isPhantom?t.added.add(e):t.modified.add(e),i=!0):t.modified.remove(e),i}get idMap(){const e=this,t=!e._idMap,i=e._idMap||(e._idMap={});if(t){const r=e.storage.values;for(let s,n=0,l=0;n<r.length;n++)s=r[n],i[s.id]={index:n,visibleIndex:l,record:s},s.isSpecialRow||l++;if(e.isFiltered)for(let s=0,n=e.storage._values.length;s<n;s++){const l=e.storage._values[s];l.id in i?i[l.id].unfilteredIndex=s:i[l.id]={index:-1,unfilteredIndex:s,record:l}}}return i}changeModelClass(e){const{fields:t}=this;this.originalModelClass=e;let i=e;if(t!=null&&t.length){class r extends e{static get fields(){return t}}i=r}else if(!this.preventSubClassingModel){class r extends e{}i=r}return i.initClass(),i}set storeId(e){this.id=e}get storeId(){return this.id}changeId(e,t){return super.changeId(e!==!0&&e,t)}updateId(e,t){const i=ie.getById(e);i&&ie.unregisterInstance(i),super.updateId(e,t)}generateAutoId(){return ie.generateId("store-")}get tree(){return this._tree}set tree(e){this._tree=e,e&&!this.rootNode&&(this.rootNode=this.buildRootNode(),this.rootNode.isAutoRoot=!0)}buildRootNode(){return{}}static getStore(e,t){if(e instanceof ie)return e;if(this.getById(e))return this.getById(e);if(Array.isArray(e)){let i;const r=e.map(s=>(s instanceof se?i=s.constructor:typeof s=="string"&&(s={text:s}),s));if(!i){class s extends se{}i=s}e={autoCreated:!0,data:r,modelClass:i,allowNoId:!0},t||(t=ie)}if(t)return new t(e)}static get stores(){return ie.registeredInstances}get rootNode(){return this.masterStore?this.masterStore.rootNode:this._rootNode}set rootNode(e){var t;const i=this,r=i._rootNode;e!==r&&(r&&i.clear(!0),e instanceof se?(e.instanceMeta(i).collapsed=!1,i._rootNode=e):i._rootNode=e=new i.modelClass(Object.assign({expanded:!0,[i.modelClass.idField]:`${i.id}-rootNode`},e),i,null,!0),i._tree=!0,e.isRoot=!0,e.joinStore(i),((t=e.children)!==null&&t!==void 0&&t.length||i.rootVisible)&&(e.isLoading=!0,i.onNodeAddChild(e,e.children||[],0),e.isLoading=!1),i.trigger("rootChange",{oldRoot:r,rootNode:e}))}set data(e){this.setStoreData(e)}setStoreData(e){var t,i;const r=this,{idField:s,childrenField:n}=r.modelClass;if(r.transformFlatData&&((t=e)===null||t===void 0?void 0:t.length)>0&&!Object.isExtensible(e[0])&&(r.useRawData=r.useRawData||{disableDuplicateIdCheck:!1,disableDefaultValue:!1,disableTypeConversion:!1},e=w.clone(e)),r.getConfig("plugins"),r.processConfiguredListeners(),e&&!Array.isArray(e)&&(e=w.transformNamedObjectToArray(e,s)),r.tree=!r.isChained&&(r.tree||!!(r.autoTree&&(!((i=e)===null||i===void 0)&&i.some(l=>l[n])))),e&&(r.remoteSort||r.remoteFilter))for(let l=0;l<e.length;l++)e[l]._remoteSortIndex=l;if(!r.syncDataOnLoad||!r._data){if(r._data=e,r.tree){r.transformFlatData&&(e=r.treeifyFlatData(e));const l=r.rootNode;if(l.isLoading=!0,r.clear(!0),l.appendChild(e),r.updateDependentStores("dataset",[l]),l.isLoading=!1,e.length===0){const o={action:"dataset",data:[],records:[]};r.trigger("refresh",o),r.trigger("change",o)}else r.isFiltered&&r.filter()}else r.loadData(e);r.added.clear(),r.removed.clear(),r.modified.clear()}else r.syncDataset(e)}loadData(e,t="dataset"){const i=this,{storage:r,allowNoId:s}=i,n=i.modelClass.fieldMap.id.dataSource,l=i.find(f=>f.isCreating);l&&r.values.splice(i.records.indexOf(l),1);let o=i.verifyNoGeneratedIds;if(i.removeHeadersAndFooters(i.storage.values),i._idMap=null,i.oldIdMap={},e){if(!(e[0]instanceof se)){i.modelClass.exposeProperties(e[0]);const g=e.length,h=new Array(g);for(let p=0;p<g;p++){var a,c,d;const m=e[p];if(!s&&m[n]==null)throw new Error(`Id required but not found on row ${p}`);o&&(a=m[n])!==null&&a!==void 0&&(c=(d=a).startsWith)!==null&&c!==void 0&&c.call(d,"_generated")&&(console.warn(`Generated id found in data: ${m[n]}. Generated ids are temporary and should be replaced with real ids by the backend`),o=!1),h[p]=i.processRecord(i.createRecord(m,!0),!0),h[p].setData("parentIndex",p)}i.clear(!0),r.replaceValues({values:h,isNewDataset:!0,silent:!0})}else i.clear(!0),r.replaceValues({values:e.slice(),isNewDataset:!0,silent:!0});l&&!r.values.includes(l)&&r.values.push(l),i._data=e,i.onDataReplaced(t,e)}else i.clear(!0),i._data=null;i.isSyncingDataOnLoad=!1}get data(){return this._data}getRange(e,t,i=!0){return(i?this.storage.allValues:this.storage.values).slice(e,t)}createRecord(e,t=!1,i=!1){return new this.modelClass(e,this,null,t,!1,i)}processRecord(e,t=!1){return e}refreshData(){this.filter(),this.sort()}onRecordIdChange({record:e,oldValue:t,value:i}){const r=this,s=r._idMap,{idRegister:n,oldIdMap:l}=r;if(r.storage._indicesInvalid=!0,l[t]=e,s&&!s[i]){const o=s[t];delete s[t],s[i]=o}r.added.changeId(t,i),r.removed.changeId(t,i),r.modified.changeId(t,i),delete n[t],n[i]=e,e.index=r.storage.indexOf(e)}onUpdateRecord(e,t){const i=this,{internalId:r}=t,{internalIdRegister:s}=i;r&&(this.storage._indicesInvalid=!0,delete s[r.oldValue],s[r.value]=e),i.reapplyFilterOnUpdate&&i.isFiltered&&i.filter()}get useRawData(){return this._useRawData}set useRawData(e){e===!0?this._useRawData={enabled:!0,disableDuplicateIdCheck:!0,disableTypeConversion:!0,disableDefaultValue:!1}:this._useRawData=e?Object.assign(e,{enabled:!0}):{enabled:!1}}getCount(e=!0){return e?this.count:this.originalCount}get originalCount(){var e;return this.storage.totalCount-(((e=this.groupRecords)===null||e===void 0?void 0:e.length)||0)}get count(){return this.storage.count}get allCount(){return this.isTree?this.rootNode.descendantCount:this.storage.totalCount}get records(){return this.storage.values}get first(){return this.storage.values[0]}get last(){return this.storage.values[this.storage.values.length-1]}getAt(e,t=!1){return this.storage.getAt(e,t)}register(e){const t=this;if(!t.useRawData.disableDuplicateIdCheck){const i=t.isTree&&t.idRegister[e.id];if(i&&i!==e)throw new Error(`Id collision on ${e.id}`)}t.idRegister[e.id]=e,t.internalIdRegister[e.internalId]=e}unregister(e){delete this.idRegister[e.id],delete this.internalIdRegister[e.internalId]}get registeredRecords(){return Object.values(this.idRegister)}getById(e){if(e!=null&&e.isModel){const t=e;return t.hasLinks&&!this.storage.allValues.includes(t)?t.$links.find(i=>this.storage.allValues.includes(i)):t}return this.idRegister[e]}isAvailable(e){const t=this.getById(e);return t&&this.storage.includes(t)||!1}getByInternalId(e){return this.internalIdRegister[e]}includes(e){return this.isTree?this.idRegister[se.asId(e)]!=null:this.indexOf(e)>-1}indexOf(e,t=!1,i=!1){if(e!=null&&e.isModel&&!e.stores.includes(this.$store||this)){const n=e.$links.find(l=>this.storage.allValues.includes(l));return n?this.indexOf(n,t):-1}if(this.isTree)return(i?this.rootNode.allChildren:this.storage.values).indexOf(this.getById(e));const r=se.asId(e);if(r==null)return-1;const s=this.idMap[r];return s?s[t?"visibleIndex":"index"]:-1}allIndexOf(e){return this.isTree?this.allRecords.indexOf(this.getById(e)):this.storage.indexOf(e,!0)}getDistinctValues(e,t=!1){const i=this,r=[],s={};let n;return i.forEach(l=>{if(!l.isSpecialRow&&!l.isRoot){n=l.getValue(e);const o=n instanceof Date?n.getTime():n;s[o]||(r.push(n),s[o]=1)}},i,t),r}getValueCount(e,t){let i=0;return this.forEach(r=>{w.isEqual(r.getValue(e),t)&&i++}),i}set json(e){typeof e=="string"&&(e=k.safeJsonParse(e)),this.data=e}get json(){return k.safeJsonStringify(this)}get formattedJSON(){return k.safeJsonStringify(this,null,4)}toJSON(){return(this.isTree?this.rootNode.unfilteredChildren||this.rootNode.children||[]:this.allRecords).map(e=>e.toJSON())}preProcessCurrentConfigs(e){super.preProcessCurrentConfigs(e),delete e.project}getInlineData(e){const t=[];if(this.tree){var i;(i=this.rootNode.children)===null||i===void 0||i.forEach(r=>t.push(r.getCurrentConfig(e)))}else this.forEach(r=>t.push(r.getCurrentConfig(e)));return t}getCurrentConfig(e){const t=super.getCurrentConfig(e),{state:i}=this;if(t){var r;t.data&&(t.data=this.getInlineData(e)),delete t.project,delete t.stm,delete t.asyncEvents,((r=t.modelClass)===null||r===void 0?void 0:r.$meta.hierarchy[t.modelClass.$meta.hierarchy.length-2])===this.constructor.defaultConfig.modelClass&&delete t.modelClass,this.tree||delete t.tree,i&&Object.assign(t,i)}return t}forEach(e,t=this,i){const r=this,s=(n,l)=>{if(!n.isRoot&&!n.isSpecialRow)return e.call(t,n,l)};if(i=Br(r,i),r.isTree)r.isChained&&(i={...i,sorterFn:r.sorterFn}),r.rootNode.traverseWhile(s,!1,i);else{const n=i.includeFilteredOutRecords?r.storage.allValues:r.storage.values;if(r.isGrouped&&i.includeCollapsedGroupRecords)for(let l=0;l<n.length;l++){const o=n[l],a=i.includeFilteredOutRecords?o.unfilteredGroupChildren:o.groupChildren;if(a&&o.meta.collapsed===!0)for(let c=0;c<a.length;c++){const d=a[c];if(s(d,c)===!1)return}else if(s(o,l)===!1)return}else for(let l=0;l<n.length;l++)if(s(n[l],l)===!1)return}}map(e,t=this){return this.storage.values.map(e,t)}flatMap(e,t=this){return this.storage.values.flatMap(e,t)}every(e,t=this,i){return this.storage[i?"allValues":"values"].every(e,t)}reduce(e,t=[],i=this){return i!==this&&(e=e.bind(i)),this.storage.values.reduce(e,t,i)}[Symbol.iterator](){return this.storage.values[Symbol.iterator]()}traverse(e,t=this.rootNode,i=t===this.rootNode,r){const s=this;if(r=Br(s,r),s.isTree){if(typeof t=="boolean"&&(i=t,t=s.rootNode),s.isChained){const n=e;e=l=>{s.chainedFilterFn(l)&&n(l)}}t.traverse(e,i,r)}else s.forEach(n=>n.traverse(e,!1,r),s,r)}traverseWhile(e,t=this.rootNode,i=t===this.rootNode,r){const s=this;if(r=Br(s,r),s.isTree){if(typeof t=="boolean"&&(i=t,t=s.rootNode),s.isChained){const n=e;e=l=>{s.chainedFilterFn(l)&&n(l)}}t.traverseWhile(e,i,r)}else for(const n of s.storage)if(n.traverse(e,!1,r)===!1)break}getNext(e,t=!1,i=!1){const r=this,s=r.storage.values;let n=r.indexOf(e);if(n>=s.length-1)if(t)n=-1;else return null;const l=s[n+1];return i&&l&&l.isSpecialRow?r.getNext(s[n+1],t,!0):l}getPrev(e,t=!1,i=!1){const r=this,s=r.storage.values;let n=r.indexOf(e);if(n===0)if(t)n=s.length;else return null;const l=s[n-1];return i&&l&&l.isSpecialRow&&n>0?r.getPrev(s[n-1],t,!0):l}getAdjacent(e,t=!0,i=!1,r=!1){return t?this.getNext(e,i,r):this.getPrev(e,i,r)}getNextLeaf(e,t=!1){const i=this,r=i.leaves,s=i.getById(e);let n=r.indexOf(s);if(n>=r.length-1)if(t)n=-1;else return null;return r[n+1]}getPrevLeaf(e,t=!1){const i=this,r=i.leaves,s=i.getById(e);let n=r.indexOf(s);if(n===0)if(t)n=r.length;else return null;return r[n-1]}getAdjacentLeaf(e,t=!0,i=!1){return t?this.getNextLeaf(e,i):this.getPrevLeaf(e,i)}}ie.initClass(),ie._$name="Store";const Tc=(u,e)=>(Array.isArray(e[1])?e[1].forEach(t=>u.push(encodeURIComponent(e[0])+"="+encodeURIComponent(t))):u.push(encodeURIComponent(e[0])+"="+encodeURIComponent(e[1])),u),Ni=Promise.resolve(),ri=u=>String(u).padStart(2,"0"),xc=u=>`${u.getFullYear()}-${ri(u.getMonth()+1)}-${ri(u.getDate())}T${ri(u.getHours())}:${ri(u.getMinutes())}:${ri(u.getSeconds())}.${u.getMilliseconds()}`;class Vi extends ie{static get defaultConfig(){return{headers:null,fetchOptions:null,sendAsFormData:null,writeAllFields:null,parentIdParamName:"id",responseSuccessProperty:"success",responseDataProperty:"data",responseTotalProperty:"total",filterParamName:null,restfulFilter:!1,sortParamName:null,pageParamName:null,pageStartParamName:null,pageSizeParamName:"pageSize",pageSize:50,useRestfulMethods:null,httpMethods:{create:"POST",read:"GET",update:"PUT",delete:"DELETE"}}}static get configurable(){return{params:null}}afterConstruct(e){super.afterConstruct(e),this.autoLoad&&this.load().catch(()=>{})}get isLoading(){return this._isLoading?2:this.loadTriggerPromise?1:!1}get isCommitting(){return!!this.commitPromise}set pageParamName(e){if(this.tree)throw new Error("Paging cannot be supported for tree stores");if(this.pageStartParamName)throw new Error("Configs pageStartParamName and pageParamName are mutually exclusive");this._pageParamName=e}get pageParamName(){return this._pageParamName}set pageStartParamName(e){if(this.tree)throw new Error("Paging cannot be supported for tree stores");if(this.pageParamName)throw new Error("Configs pageParamName and pageStartParamName are mutually exclusive");this._pageStartParamName=e}get pageStartParamName(){return this._pageStartParamName}get isPaged(){return this.pageParamName||this.pageStartParamName}get allCount(){return"remoteTotal"in this?this.remoteTotal:super.allCount}get lastPage(){if(this.isPaged)return Math.floor((this.allCount+this.pageSize-1)/this.pageSize)}buildQueryString(e,...t){const i=e.includes("?"),r=Object.entries(Object.assign({},...t)).reduce(Tc,[]).join("&");return r?(i?"&":"?")+r:""}async performSort(e){const t=this;if(t.remoteSort&&!t.isRemoteDataLoading){t.isRemoteDataLoading=!0;const i=await t.internalLoad({},"",r=>{t.data=r.data,t.afterPerformSort(e)});return t.isRemoteDataLoading=!1,i}else super.performSort(e)}async performFilter(e){const t=this;if(t.remoteFilter){var i;(i=t.loadingPromise)===null||i===void 0||i.abort(),t.isRemoteDataLoading=!0;const r=t.count,{filters:s}=t;t.currentPage=1;const n=await t.internalLoad({},"",l=>{t.data=l.data,l=e?null:{action:"filter",filters:s,oldCount:r,records:t.storage.values},t.afterPerformFilter(l),t.trigger("refresh",l)});return t.isRemoteDataLoading=!1,n}else super.performFilter(e)}encodeFilterParams(e){const t=[];for(const{property:i,operator:r,value:s,caseSensitive:n}of e)t.push({field:i,operator:r,value:s,caseSensitive:n});return JSON.stringify(t,function(i,r){return i===""?r:this[i]instanceof Date?xc(this[i]):r})}encodeSorterParams(e){return JSON.stringify(e.filter(t=>!t.sortFn).map(t=>t))}buildReadUrl(){const{readUrl:e}=this;return this.restfulFilter&&this.filters.count?(e.endsWith("/")?e:e+"/")+this.filters.first.value:e}internalLoad(e,t,i,r=0){e=w.assign({},this.params,e);const s=this,n=s.buildReadUrl(),l={action:"read"+t,params:e,url:n};if(!n)throw new Error("No load url specified");if(s.trigger("beforeLoad"+t,l)===!1)throw!1;return s.loadArgs=[n,l,e,t,i],r===!1?new Promise((o,a)=>s.sendLoadRequest(o,a)):s.loadTriggerPromise||(s.loadTriggerPromise=new Promise((o,a)=>{s.setTimeout({delay:r,fn:"sendLoadRequest",args:[o,a],cancelOutstanding:!0})}))}async sendLoadRequest(e,t){const i=this,[r,s,n,l,o]=i.loadArgs;if(i.loadTriggerPromise=null,r){if(i._isLoading=!0,i.trigger(`load${l}Start`,s),i.trigger("beforeRequest",s),i.filterParamName&&i.isFiltered&&(n[i.filterParamName]=i.encodeFilterParams(i.filters.values)),i.remoteSort&&i.isSorted&&(n[i.sortParamName]=i.encodeSorterParams(i.groupers?i.groupers.concat(i.sorters):i.sorters)),i.isPaged){if(!(i.pageParamName in n||i.pageStartParamName in n)){const c=Math.min(i.currentPage||1,i.allCount?i.lastPage:1/0);i.pageParamName?n[i.pageParamName]=c:n[i.pageStartParamName]=(c-1)*i.pageSize}n[i.pageSizeParamName]=i.pageSize}const a={headers:i.headers,parseJson:!0};i.useRestfulMethods&&(a.method=i.httpMethods.read,s.body&&(a.body=JSON.stringify(s.body)));try{const c=i.loadingPromise=Pe.get(s.url+i.buildQueryString(s.url,n),w.assign(a,i.fetchOptions)),d=await c,f=d.parsedJson,g=Array.isArray(f),h=g||f&&w.getPath(f,i.responseSuccessProperty)!==!1,p=g?null:w.getPath(f,i.responseTotalProperty);if(i.isDestroyed)return;if(i.loadingPromise=null,i._isLoading=!1,s.response=d,s.json=f,h){if(p!=null&&(i.remoteTotal=parseInt(p,10)),i.isPaged)if(i.remoteTotal>=0){const m=i.pageParamName?n[i.pageParamName]:n[i.pageStartParamName]/i.pageSize+1;i.currentPage=Math.min(m,i.lastPage)}else throw new Error("A paged store must receive its responseTotalProperty in each data packet");s.data=g?f:w.getPath(f,i.responseDataProperty),await o(s),!i.isDestroyed&&i.trigger("load"+l,s),e(s)}else Object.assign(s,{exception:!0,exceptionType:"server",error:f==null?void 0:f.error}),!i.isDestroyed&&i.trigger("exception",s),t(s);!i.isDestroyed&&i.trigger("afterRequest",s)}catch(c){i._isLoading=!1,s.exception=!0,c instanceof Response?(s.exceptionType=c.ok?"server":"network",s.response=c,s.error=c.error):(s.exceptionType="server",s.error=c),!i.isDestroyed&&i.trigger("exception",s),t(s),!i.isDestroyed&&i.trigger("afterRequest",s)}}}async load(e){const t=this;return t.isPaged?t.loadPage(t.currentPage||1,e):t.internalLoad(e,"",i=>{t.data=i.data})}async loadChildren(e){return this.readUrl?this.internalLoad({[this.parentIdParamName]:e.id},"Children",t=>{t.parentRecord=e,e.children.length&&e.clearChildren(!0),e.data[e.constructor.childrenField]=t.data,e.processChildren(e.stores)},!1):this.immediatePromise}async loadPage(e,t){this.allCount&&(e=Math.min(e,this.lastPage));const i=this,r=i.pageParamName?{[i.pageParamName]:e}:{[i.pageStartParamName]:(e-1)*i.pageSize};return r[i.pageSizeParamName]=i.pageSize,i.internalLoad(w.assign(r,t),"Page",s=>{i.loadData(s.data,"pageLoad")})}async nextPage(e){const t=this;return t.isPaged&&t.currentPage!==t.lastPage?t.loadPage(t.currentPage+1,e):Ni}async previousPage(e){return this.isPaged&&this.currentPage!==1?this.loadPage(this.currentPage-1,e):Ni}async commit(){const e=this,{changes:t}=e,i=[];if(e.commitPromise)return!1;if(!t)return e.modified.count&&(e.modified.forEach(r=>r.clearChanges(!0,!1)),e.modified.clear()),Ni;if(e.trigger("beforeCommit",{changes:t})!==!1){[...t.added,...t.modified,...t.removed].forEach(n=>n.meta.committing=!0),e.trigger("commitStart",{changes:t});const r={action:"commit",exception:!1,changes:t};let s=e.commitRemoved(r);return s&&i.push(s),s=e.commitAdded(r),s&&i.push(s),s=e.commitModified(r),s&&i.push(s),i.length?(s=i.length===1?i[0]:Promise.all(i),e.commitPromise=new Promise((n,l)=>{s.then(()=>{e.commitPromise=null,r.exception?(e.trigger("exception",r),l(r)):(e.trigger("commit",{changes:t}),n(r))}).catch(()=>{e.commitPromise=null,l(r)})})):(e.modified.forEach(n=>n.clearChanges(!0,!1)),e.modified.clear(),e.added.forEach(n=>n.clearChanges(!0,!1)),e.added.clear(),e.removed.clear(),e.trigger("commit",{changes:t}),Ni)}}doAutoCommit(){this.suspendCount<=0&&this.commit().catch(e=>{const{response:t}=e;if(!(t&&(t.ok&&t.parsedJson||[500,404].includes(t.status))))throw e})}commitAdded(e){const t=this,i=t.added,r={action:"create",params:t.params};return i.count&&t.createUrl?new Promise(s=>{const n=i.values.map(c=>c.persistableData);e.create=r,r.body={data:n},t.trigger("beforeRequest",r);let l=r.body;if(t.sendAsFormData){const c=new FormData;c.append("data",JSON.stringify(n)),l=c}const o={headers:t.headers,parseJson:!0},a=t.createUrl+t.buildQueryString(t.createUrl,t.params);t.useRestfulMethods&&(o.method=t.httpMethods.create),Pe.post(a,l,w.assign(o,t.fetchOptions)).then(c=>{const d=c.parsedJson,f=Array.isArray(d),g=f||d&&d.success!==!1;e.response=c,r.json=d,r.response=c,g?(t.processReturnedData(i.values,f?d:w.getPath(d,t.responseDataProperty)),i.clear(),t.trigger("commitAdded"),t.trigger("refresh",r),s(e)):(i.forEach(h=>h.meta.committing=!1),e.exception=r.exception=!0,e.exceptionType=r.exceptionType="server",t.trigger("exception",r),s(e)),t.trigger("afterRequest",r)}).catch(c=>{i.forEach(d=>d.meta.committing=!1),e.exception=r.exception=!0,c instanceof Response?(e.response=c,r.exceptionType=c.ok?"server":"network",r.response=c,r.error=c.error):(r.exceptionType="server",r.error=c),t.trigger("exception",r),s(e),t.trigger("afterRequest",r)})}):null}commitModified(e){const t=this,{modified:i}=t.changes,r={action:"update",params:t.params},s=i.length&&t.updateUrl?new Promise(n=>{const l=i.map(c=>t.writeAllFields?c.persistableData:c.modificationDataToWrite).filter(c=>!w.isEmpty(c));if(l.length===0){t.modified.clear(),i.forEach(c=>c.meta.committing=!1),n();return}e.update=r,r.body={data:l},t.trigger("beforeRequest",r);let o=r.body;if(t.sendAsFormData){const c=new FormData;c.append("data",JSON.stringify(l)),o=c}const a={headers:t.headers,parseJson:!0};t.useRestfulMethods&&(a.method=t.httpMethods.update),Pe.post(t.updateUrl+t.buildQueryString(t.updateUrl,t.params),o,w.assign(a,t.fetchOptions)).then(c=>{const d=c.parsedJson,f=Array.isArray(d),g=f||d&&d.success!==!1;e.response=c,r.json=d,r.response=c,g?(t.processReturnedData(i,f?d:w.getPath(d,t.responseDataProperty),!0),t.modified.clear(),t.trigger("commitModified"),t.trigger("refresh",r),n(e)):(i.forEach(h=>h.meta.committing=!1),e.exception=r.exception=!0,r.exceptionType="server",t.trigger("exception",r),n(e)),t.trigger("afterRequest",r)}).catch(c=>{i.forEach(d=>d.meta.committing=!1),e.exception=r.exception=!0,c instanceof Response?(e.response=c,r.exceptionType=c.ok?"server":"network",r.response=c,r.error=c.error):(r.exceptionType="server",r.error=c),t.trigger("exception",r),n(e),t.trigger("afterRequest",r)})}):null;return!i.length&&t.modified.count&&t.modified.clear(),s}processReturnedData(e,t,i=!1){const r=this,s=r.modelClass,n=s.fieldMap.id.dataSource;t.forEach((l,o)=>{const a=e[o];a.clearChanges(!0,!1),a.syncId(l[n]),Object.assign(e[o].data,s.processData(l,i,r,a))})}commitRemoved(e){const t=this,i=t.removed,r={action:"delete",params:t.params};return i.count&&t.deleteUrl?new Promise(s=>{e.delete=r,r.body={ids:i.map(o=>o.id)},t.trigger("beforeRequest",r);let n=r.body;if(t.sendAsFormData){const o=new FormData;o.append("id",JSON.stringify(n.ids)),n=o}const l={headers:t.headers,parseJson:!0};t.useRestfulMethods&&(l.method=t.httpMethods.delete),Pe.post(t.deleteUrl+t.buildQueryString(t.deleteUrl,t.params),n,w.assign(l,t.fetchOptions)).then(o=>{const a=o.parsedJson,c=Array.isArray(a),d=c||a&&a.success!==!1;e.response=o,r.json=a,r.response=o,d?(i.forEach(f=>f.meta.committing=!1),i.clear(),t.trigger("commitRemoved"),t.trigger("refresh",r),s(e)):(i.forEach(f=>f.meta.committing=!1),e.exception=r.exception=!0,r.exceptionType="server",t.trigger("exception",r),s(e)),t.trigger("afterRequest",r)}).catch(o=>{i.forEach(a=>a.meta.committing=!1),e.exception=r.exception=!0,o instanceof Response?(e.response=o,r.exceptionType=o.ok?"server":"network",r.response=o,r.error=o.error):(r.exceptionType="server",r.error=o),t.trigger("exception",r),s(e),t.trigger("afterRequest",r)})}):null}get remoteFilter(){return!!(this.filterParamName||this.restfulFilter)}get remoteSort(){return!!this.sortParamName}}R(Vi,"$name","AjaxStore"),Vi._$name="AjaxStore";class nl{static get(e,t){const i=e._domData||(e._domData={});return t!=null?i[t]:i}static remove(e,t){const{_domData:i}=e,r=i==null?void 0:i[t];return i==null||delete i[t],r}static set(e,t,i){arguments.length===3?(e._domData||(e._domData={}))[t]=i:e._domData=t}static assign(e,t){Object.assign(e._domData||(e._domData={}),t)}}nl._$name="DomDataStore";class jr{static insertRule(e,t=document.head){const i=this.getStyleSheet(t),r=i.cssRules.length;if(i.insertRule(e,0),i.cssRules.length>r)return i.cssRules[0]}static findRule(e){let t;const i=typeof e=="function";return Array.prototype.find.call(document.head.querySelectorAll("link[rel=stylesheet],style[type*=css]"),r=>{if(t=Array.prototype.find.call(r.sheet.rules||r.sheet.cssRules,s=>i?e(s):s.selectorText===e),t)return!0}),t}static getStyleSheet(e=document.head){return e.$bryntumStylesheet||(e.$bryntumStylesheet=v.createElement({tag:"style",id:"bryntum-private-styles",type:"text/css",parent:e}).sheet),e.$bryntumStylesheet}static getCSSVersion(){return getComputedStyle(document.documentElement).getPropertyValue("--bryntum-version").replace(/[" ]/gm,"")}}jr._$name="CSSHelper";const ll=Array.prototype.slice,ol=Object.freeze([]),Dc=Object.freeze({}),al=/[&<]/,{getPrototypeOf:cl}=Object,{toString:Mc}=Object.prototype,{isEqual:ul,isObject:Ic}=w,Oc={parent:1,elementData:1,ns:1,syncOptions:1},dl=()=>({ignore:Oc,refsFound:new Set}),fl={class:1,className:1,classname:1},Lc={bigint:1,boolean:1,function:1,number:1,string:1,symbol:1},Fc={tag:1,html:1,text:1,children:1,tooltip:1,parent:1,nextSibling:1,ns:1,reference:1,elementData:1,retainElement:1,compareHtml:1,syncOptions:1,listeners:1,isReleased:1,null:1,"":1,keepChildren:1},kc=(u,e)=>{const t="className"in e?"className":"class",i=e[t];if(i)if(typeof i=="string"){const r=i.split(" ");r.includes(u)||(r.push(u),e[t]=r.join(" "))}else Array.isArray(i)?i.includes(u)||i.push(u):i.isDomClassList?i.add(u):w.isObject(i)&&(i[u]=1)},$c=(u,e)=>{const t="className"in e?"className":"class",i=e[t];if(i)if(typeof i=="string"){const r=i.split(" ");r.includes(u)&&(r.splice(r.indexOf(u),1),e[t]=r.join(" "))}else Array.isArray(i)?i.includes(u)&&i.splice(i.indexOf(u),1):i.isDomClassList?i.remove(u):w.isObject(i)&&delete i[u]};class X{static checkEquality(e,t,i,r){if(e===t)return!0;if(e==null)return t==null;if(!e||!t)return!1;const s=typeof e;if(s!==typeof t||Lc[s])return!1;let l=i.equalityCache||(i.equalityCache=new Map),o=!!r,a,c,d,f,g,h,p;if(l=l.get(e)||l.set(e,new Map).get(e),a=l.get(t),a===void 0){if(a=!0,cl(e)!==cl(t)||e instanceof Node)a=!1;else if(Array.isArray(e)){if(c=e.length,c!==t.length)a=!1;else for(;c-- >0;)if(!X.checkEquality(e[c],t[c],i,o)){a=!1;break}}else{var m;h=e.syncOptions,f=(m=h)===null||m===void 0?void 0:m.ignoreRefs,f&&(o=!0,r=f!=="children"),d=i.ignore||Dc;for(g in t)if(!d[g]&&!(g in e)&&!(r&&g==="reference")){a=!1;break}if(a){if(Mc.call(t)==="[object Date]")a=e.getTime()===t.getTime();else for(g in e)if(!d[g]&&!(r&&g==="reference")){if(!(g in t)){a=!1;break}if(p=e[g],!X.checkEquality(p,t[g],i,o)){a=!1;break}}}}if(!r&&Ic(e)&&e.reference){var y;(y=i.refsFound)===null||y===void 0||y.add(e.reference)}l.set(t,a)}return a}static sync(e){const t=e,{refOwner:i}=e,r=i==null?void 0:i.byRef,s=dl();let n=e.affected,l,o,a,c;if(typeof n=="string"&&(n=[n]),e={...e,checkEqualityOptions:s},i){if(i.byRef={},n)for(o in r)n.includes(o)||(i.byRef[o]=r[o]);e.refsWas=r}if(t.changed=X.performSync(e,e.targetElement),i)for(n||(n=Object.keys(r)),l=0;l<n.length;++l)o=n[l],a=r[o],s.refsFound.has(o)||a.retainElement?i.byRef[o]=a:(c=a.lastDomConfig,a.remove(),i.detachRef(o,a,c));return e.targetElement}static performSync(e,t){const{domConfig:i,callback:r}=e,{lastDomConfig:s}=t;if((e.configEquality||X.checkEquality)(i,s,e.checkEqualityOptions,e.ignoreRefs))r==null||r({action:"none",domConfig:i,targetElement:t});else return i?(i.onlyChildren||(X.syncAttributes(i,t,e),X.syncContent(i,t)),i.keepChildren||X.syncChildren(e,t)):(t.innerHTML=null,t.syncIdMap=null),t.lastDomConfig=i!=null&&i.onlyChildren&&s?{...s,children:i.children}:i,!0;return!1}static syncDataset(e,t){const{lastDomConfig:i}=t,r=e===i,s=Object.keys(e.dataset),n=i&&i.dataset&&Object.keys(i.dataset),l=j.delta(s,n);let o,a,c,d;for(a=0;a<l.onlyInA.length;a++)o=l.onlyInA[a],d=e.dataset[o],d!=null&&t.setAttribute(`data-${k.hyphenate(o)}`,d);for(a=0;a<l.inBoth.length;a++)o=l.inBoth[a],d=e.dataset[o],(r||d!=i.dataset[o])&&(c=`data-${k.hyphenate(o)}`,d==null?t.removeAttribute(c):t.setAttribute(c,d));for(a=0;a<l.onlyInB.length;a++)t.removeAttribute(`data-${k.hyphenate(l.onlyInB[a])}`)}static addCls(e,t){const{lastDomConfig:i}=t;e=W.normalize(e,"array"),e.forEach(r=>{t.classList.add(r),kc(r,i)})}static removeCls(e,t){const{lastDomConfig:i}=t;e=W.normalize(e,"array"),e.forEach(r=>{t.classList.remove(r),$c(r,i)})}static syncClassList(e,t,i){let r=e.className||e.class,s=!1,n,l,o,a,c,d;if(i){for(l=W.normalize(t,"array"),r=W.normalize(r,"object"),d=W.normalize(i.className||i.class,"object"),c=[],o=0,a=l.length;o<a;++o)n=l[o],r[n]||!(n in d)?(d[n]=1,c.push(n)):s=!0;for(n in r)d[n]||(c.push(n),s=!0);if(!s)return;r=c.join(" ")}else r=W.normalize(r);t.setAttribute("class",r)}static getSyncAttributes(e){const t={},i=[];return e&&Object.keys(e).forEach(r=>{if(!Fc[r]){const s=r.toLowerCase();t[s]=e[r],i.push(s)}}),{attributes:t,names:i}}static syncAttributes(e,t,i){const{lastDomConfig:r}=t,s=e===r,n=X.getSyncAttributes(e),{attributes:l,names:o}=n,{attributes:a,names:c}=s?n:X.getSyncAttributes(r),{onlyInA:d,onlyInB:f,inBoth:g}=s?{onlyInA:ol,onlyInB:ol,inBoth:o}:j.delta(o,c);let h,p;for(p=0;p<d.length;p++){h=d[p];const m=l[h];h==="style"&&m!=null?v.applyStyle(t,m,!0):h==="dataset"?X.syncDataset(e,t):fl[h]?X.syncClassList(e,t):m!=null&&t.setAttribute(h,m)}for(p=0;p<f.length;p++)t.removeAttribute(f[p]);for(p=0;p<g.length;p++){h=g[p];const m=l[h],y=a[h];m==null?t.removeAttribute(h):h==="style"?i.strict?s?X.syncStyles(t,m):ul(m,y,!0)||X.syncStyles(t,m,y):(s||!ul(m,y,!0))&&v.applyStyle(t,m,!0):h==="dataset"?X.syncDataset(e,t):fl[h]?X.syncClassList(e,t,i.strict&&t.lastDomConfig):(s||m!==y)&&t.setAttribute(h,m)}}static syncStyles(e,t,i){let r,s,n;if(!i)r=t;else{if(r={},t=v.parseStyle(t),i=v.parseStyle(i),t)for(s in t)n=t[s],i[s]!==n&&(r[s]=n);for(s in i)s in t||(r[s]="")}v.applyStyle(e,r)}static syncContent(e,t){const{html:i,text:r}=e,s=r!=null?r:i;if(t.didSetTextContent=!1,e.elementData&&(t.elementData=e.elementData),s instanceof DocumentFragment)t.childNodes.length===1&&v.getChildElementCount(t)===0&&s.childNodes.length===1&&v.getChildElementCount(s)===0?v.setInnerText(t,s.firstChild.data):(t.innerHTML="",t.appendChild(s));else if(i!=null&&al.test(i))t.innerHTML=String(i);else if(s!=null){var n;const{lastDomConfig:l}=t;l!=null&&(n=l.children)!==null&&n!==void 0&&n.length||l!=null&&l.html&&al.test(t.lastDomConfig.html)?t.innerHTML=s:(v.setInnerText(t,String(s)),t.didSetTextContent=!0)}}static insertTextNode(e,t,i,r,s=null){const n=document.createTextNode(e);t.insertBefore(n,s),r&&(n.$refOwnerId=r.id),i==null||i({action:"newNode",domConfig:e,targetElement:n})}static insertElement(e,t,i,r,s,n,l){var o;const a=l.ns?document.createElementNS(l.ns,e.tag||"svg"):document.createElement(e.tag||"div");t.insertBefore(a,i),X.performSync(l,a),n!=null&&(s[n]=a),!e.role&&!e.tabIndex&&!e["aria-hidden"]&&!v.isFocusable(a,!0)&&!a.htmlFor&&a.setAttribute("role","presentation"),r&&(a.$refOwnerId=r.id,n&&(a.$reference=n,r.attachRef(n,a,e))),(o=l.callback)===null||o===void 0||o.call(l,{action:"newElement",domConfig:e,targetElement:a,syncId:n})}static syncChildren(e,t){var H,J;let{domConfig:i,syncIdField:r,callback:s,releaseThreshold:n,configEquality:l,ns:o,refOwner:a,refsWas:c,strict:d,checkEqualityOptions:f,ignoreRefs:g}=e,h=null,p,m,y;const b=i.syncOptions||{};if((H=i.html)!=null?H:i.text)return;g=!!((J=b.ignoreRefs)!=null?J:g),g&&(a=c=null),"strict"in b&&(d=b.strict);const C=a?a.byRef:{},E=ll.call(i.children||[]),S=ll.call(t.childNodes),x=c||t.syncIdMap||{},L=t.releasedIdMap||{},O=_=>{for(;S.length&&S[0].parentNode!==t;)S.shift();return(_?S.shift():S[0])||null};r=b.syncIdField||r,d=b.strict||d,s=b.callback||s,l=b.configEquality||l,n="releaseThreshold"in b?b.releaseThreshold:n,r&&(t.syncIdMap=C);const P={checkEqualityOptions:f||dl(),ignoreRefs:g,refOwner:a,refsWas:c,strict:d,syncIdField:r,releaseThreshold:n,callback:s,configEquality:l};for(;E.length;){const _=E.shift();if(y=null,!_)continue;if(v.isReactElement(_)){s({jsx:_,targetElement:t});continue}if(Array.isArray(_)){this.syncChildren({...e,domConfig:{...e.domConfig,children:_}},t);continue}if(_ instanceof Node){m=O(),_!==m&&t.insertBefore(_,m),p=S.indexOf(_),p>-1&&S.splice(p,1);continue}const U=typeof _=="string";if(P.domConfig=_,P.ns=_.ns||o,!U){if(a?y=_.reference:r&&_.dataset&&(y=_.dataset[r]),y!=null&&!_.unmatched){const q=x[y]||L[y];if(q){const{lastDomConfig:he}=q;if(!q.retainElement){if(X.performSync(P,q)){var I;(I=s)===null||I===void 0||I({action:"reuseOwnElement",domConfig:_,targetElement:q,lastDomConfig:he,syncId:y})}}_.retainElement&&(q.retainElement=!0),C[y]=q,j.remove(S,q),delete L[y],q.isReleased=!1,m=O(),(q.parentNode!==t||d&&q.nextSibling!==m)&&t.insertBefore(q,m)}else d?X.insertElement(_,t,O(),a,C,y,P):(E.push(_),_.unmatched=!0);continue}_.unmatched&&delete _.unmatched}let re=null,Y=null,A;for(;!Y&&(A=O(!0));){if(a){if(A.$refOwnerId!==a.id)continue;if(A.$reference){if(!d)continue;re=A;break}Y=A}else A.retainElement||(Y=A);Y||(h||(h=[])).push(A)}if(re||!Y)U?X.insertTextNode(_,t,s,a,re):X.insertElement(_,t,re,a,C,y,P);else if(!U&&Y.nodeType===Node.ELEMENT_NODE&&(_.tag||"div").toLowerCase()===Y.tagName.toLowerCase()){var G,K;const{lastDomConfig:q}=Y,he=X.performSync(P,Y);if(r&&(q==null||(G=q.dataset)===null||G===void 0?void 0:G[r])!=null){const $e=q.dataset[r];delete L[$e],delete x[$e]}y!=null&&(C[y]=Y),Y.isReleased=!1,he&&((K=s)===null||K===void 0||K({action:"reuseElement",domConfig:_,targetElement:Y,lastDomConfig:q,syncId:y}))}else U&&Y.nodeType===Node.TEXT_NODE?Y.data=_:(U?X.insertTextNode(_,t,s,a,Y):X.insertElement(_,t,Y,a,C,y,P),Y.remove())}if(!(t.didSetTextContent&&S.length===1&&S[0].nodeType===Node.TEXT_NODE)){for(;m=O(!0);)(!a||m.$refOwnerId===a.id&&!m.$reference)&&(h||(h=[])).push(m);h&&X.syncChildrenCleanup(t,h,C,s,a,n,r)}}static syncChildrenCleanup(e,t,i,r,s,n,l){let o=0,a;for(const c of t){const{lastDomConfig:d}=c;if(c.nodeType===Element.TEXT_NODE){c.remove();continue}c.retainElement?l&&d&&(i[c.dataset[l]]=c):!s&&l&&(n==null||o<n)?(c.isReleased||(c.className="b-released",c.isReleased=!0,d!=null&&d.dataset&&(e.releasedIdMap||(e.releasedIdMap={}),e.releasedIdMap[d.dataset[l]]=c),r==null||r({action:"releaseElement",domConfig:d,lastDomConfig:d,targetElement:c}),d&&(d.isReleased=!0,d.className&&(d.className="b-released"),d.class&&(d.class="b-released"),d.style&&(d.style=null))),o++):(c.remove(),s&&(a=c.$reference,a&&s.detachRef(a,c,d)),e.releasedIdMap&&l&&d!==null&&d!==void 0&&d.dataset&&delete e.releasedIdMap[d.dataset[l]],r==null||r({action:"removeElement",domConfig:c.lastDomConfig,lastDomConfig:c.lastDomConfig,targetElement:c}))}}static removeChild(e,t){if(e.contains(t)){const i=e.syncIdMap;if(i){const r=Object.values(i).indexOf(t);r>-1&&delete i[Object.keys(i)[r]]}e.removeChild(t)}}static addChild(e,t,i){e.appendChild(t),e.syncIdMap||(e.syncIdMap={}),e.syncIdMap[i]=t}static getChild(e,t){const i=String(t).split(".");for(const n of i){var r,s;if(e=(r=e)===null||r===void 0||(s=r.syncIdMap)===null||s===void 0?void 0:s[n],!e)return null}return e}}X._$name="DomSync";class _e{static init(){const e=["fullscreenEnabled","requestFullscreen","exitFullscreen","fullscreenElement"],t=n=>e.map(l=>{let o=n+k.capitalize(l);return n==="moz"&&(o=o.replace("screen","Screen"),"mozCancelFullScreen"in document&&l==="exitFullscreen"&&(o="mozCancelFullScreen")),o});this.functions="fullscreenEnabled"in document&&e||"webkitFullscreenEnabled"in document&&t("webkit")||"mozFullScreenEnabled"in document&&t("moz")||"msFullscreenEnabled"in document&&t("ms")||[];const i=["fullscreenchange","fullscreenerror"],r=["MSFullscreenChange","MSFullscreenError"],s=n=>i.map(l=>n+k.capitalize(l));this.events="fullscreenEnabled"in document&&i||"webkitFullscreenEnabled"in document&&s("webkit")||"mozFullscreenEnabled"in document&&s("moz")||"msFullscreenEnabled"in document&&r||[],this.onFullscreenChange(this.onInternalFullscreenChange.bind(this))}static get enabled(){return!!(this.functions[0]&&document[this.functions[0]])}static async request(e){return this.functions[1]&&(e==null?void 0:e[this.functions[1]]())}static async exit(){return this.functions[2]&&document[this.functions[2]]()}static get isFullscreen(){return!!this.element}static get element(){return this.functions[3]&&document[this.functions[3]]}static onFullscreenChange(e){this.events[0]&&document.addEventListener(this.events[0],e)}static unFullscreenChange(e){this.events[0]&&document.removeEventListener(this.events[0],e)}static onInternalFullscreenChange(){const e=this,{element:t}=e;if(t){if(!t.closest(".b-floatroot")){const i=v.getRootElement(t),{floatRoot:r}=i;r&&(e._floatRoot=r,e._oldParent=r.parentElement,t.appendChild(r))}}else e._floatRoot&&e._oldParent.appendChild(e._floatRoot),e._oldParent=null,e._floatRoot=null}}_e.init(),_e._$name="Fullscreen";let Hr=null;const Wr=[],Rc=u=>{var e;return u.nodeType===u.ELEMENT_NODE&&((e=u.ownerDocument.defaultView)===null||e===void 0?void 0:e.getComputedStyle(u).getPropertyValue("position"))==="absolute"};class ce{static addResizeListener(e,t){const i=this;if((e===document||e===globalThis)&&(e=document.body),e.nodeType===e.DOCUMENT_FRAGMENT_NODE&&(e=e.host),e.classList.contains("b-resize-monitored")||(e.classList.add("b-resize-monitored"),e._bResizemonitor={handlers:[]}),e===document.body)i.hasWindowResizeListener||(globalThis.addEventListener("resize",i.onWindowResize),i.hasWindowResizeListener=!0);else if(globalThis.ResizeObserver)i.resizeObserver||(i.resizeObserver=new ResizeObserver(i.onElementResize)),i.resizeObserver.observe(e);else{e.classList.add("b-no-resizeobserver");const[r,s,n]=v.createElement({parent:e,className:"b-resize-monitors",children:[{className:"b-resize-monitor-expand"},{className:"b-resize-monitor-shrink"}]},{returnAll:!0});s.scrollLeft=s.scrollTop=n.scrollLeft=n.scrollTop=1e6,s.addEventListener("scroll",i.onSizeMonitorScroll,!0),n.addEventListener("scroll",i.onSizeMonitorScroll,!0),(t.targetMutationMonitor=new MutationObserver(l=>{const o=[],a=[];for(const d of l)d.type==="childList"&&(o.push.apply(o,d.addedNodes),a.push.apply(a,d.removedNodes));const c=[...o.filter(d=>!a.includes(d)),...a.filter(d=>!o.includes(d))];c.length!==0&&(c.length>0&&c.every(Rc)||s.dispatchEvent(new CustomEvent("scroll",{bubbles:!1})))})).observe(e,{childList:!0,subtree:!0}),t.monitorElement=r}e._bResizemonitor.handlers.push(t)}static removeResizeListener(e,t){if(e){(e===document||e===globalThis)&&(e=document.body);const i=e._bResizemonitor;let r=0;i&&i.handlers&&(j.remove(i.handlers,t),r=i.handlers.length),r||(e.classList.remove("b-resize-monitored"),this.resizeObserver?this.resizeObserver.unobserve(e):(t.monitorElement&&(t.monitorElement.remove(),t.monitorElement=null),t.targetMutationMonitor&&t.targetMutationMonitor.disconnect()))}}static onElementResize(e){for(const t of e){const i=t.target,r=i._bResizemonitor,s=t.contentRect||i.getBoundingClientRect();if(it(i)&&(!r.rectangle||s.width!==r.rectangle.width||s.height!==r.rectangle.height)){const n=r.rectangle;r.rectangle=s;for(const l of r.handlers)l(i,n,s)}}}static onSizeMonitorScroll(e){var t;if((t=document.body)!==null&&t!==void 0&&t.contains(e.target)){e.stopImmediatePropagation();const i=e.target.parentNode,r=i.parentNode,s=r._bResizemonitor,n=r.getBoundingClientRect();(!s.rectangle||n.width!==s.rectangle.width||n.height!==s.rectangle.height)&&(Wr.push([r,s.rectangle,n]),s.rectangle=n,Hr||(Hr=requestAnimationFrame(ce.fireResizeEvents))),i.firstChild.scrollLeft=i.firstChild.scrollTop=i.childNodes[1].scrollTop=i.childNodes[1].scrollLeft=1e6}}static onWindowResize(e){const t=document.body,i=t._bResizemonitor,r=i.rectangle;i.rectangle=document.documentElement.getBoundingClientRect();for(const s of i.handlers)s(t,r,i.rectangle)}static fireResizeEvents(){for(const e of Wr)for(const t of e[0]._bResizemonitor.handlers)e[0].offsetParent&&t.apply(this,e);Hr=null,Wr.length=0}static removeGlobalListeners(){globalThis.removeEventListener("resize",this.onWindowResize)}}ce._$name="ResizeMonitor";const hl={auto:"auto",true:"auto",false:"hidden","hidden-scroll":"auto",clip:B.supportsOverflowClip?"clip":"hidden"},gl="b-widget-scroller",Ur={block:"nearest"},ml=Promise.resolve(),pl=u=>new Promise(e=>z.on({element:u===document.documentElement?globalThis:u,scroll:e,once:!0})),Pc={x:1},zi={auto:1,scroll:1},Ac={true:1,auto:1},_c={overflowX:"auto",overflowY:"auto"},Nc=u=>{var s,n,l,o;let e,t,i,r;return u?typeof u=="number"?e=t=i=r=u:(e=(s=u.top)!=null?s:0,t=(n=u.bottom)!=null?n:0,i=(l=u.start)!=null?l:0,r=(o=u.end)!=null?o:0):e=t=i=r=0,{top:e,bottom:t,start:i,end:r}};class ut extends rt(Oe($)){static get configurable(){return{widget:null,element:{$config:{nullify:!0},value:null},contentElement:{$config:{nullify:!0},value:null},overflowX:null,overflowY:null,translate:null,x:0,y:0,rtlSource:null,propagateSync:null}}static get delayable(){return{onScrollEnd:{type:"buffer",delay:100}}}get isRTL(){var e;return!!(!((e=this.rtlSource)===null||e===void 0)&&e.rtl)}syncOverflowState(){const e=this,{element:t}=e,i=new W(t.classList),r=e.hasOverflowX=t.scrollWidth>t.clientWidth,s=e.hasOverflowY=t.scrollHeight>t.clientHeight;i.value=t.classList,(i.toggle("b-horizontal-overflow",r)||i.toggle("b-vertical-overflow",s))&&(v.syncClassList(t,i),e.isConfiguring||e.trigger("overflowChange",{x:r,y:s}))}hasOverflow(e="y"){const t=this,i=t[`overflow${e.toUpperCase()}`],r=t[`overflow${e==="y"?"x":"y"}`];if(!v.scrollBarWidth||!Ac[i]||r==="hidden-scroll"){const s=e==="y"?"Height":"Width";return t[`scroll${s}`]>t[`client${s}`]}return t[`hasOverflow${e.toUpperCase()}`]}hasScrollbar(e="y"){const{element:t}=this;if(t&&v.scrollBarWidth){const i=e==="y",r=i?"Width":"Height",s=t[`client${r}`],n=parseInt(v.getStyleValue(t,`border${i?"Left":"Top"}Width`))+parseInt(v.getStyleValue(t,`border${i?"Right":"Bottom"}Width`)),l=t[`offset${r}`]-n-s;return Math.abs(l-v.scrollBarWidth)<2}}addPartner(e,t=Pc){const i=this;typeof t=="string"&&(t={[t]:1}),i.partners||(i.partners={}),i.partners[e.id]={scroller:e,axes:t},t.x&&(e.x=i.x),t.y&&(e.y=i.y),e.isPartneredWith(i)||e.addPartner(i,t)}eachPartner(e){const{partners:t}=this;t&&Object.values(t).forEach(e)}removePartner(e){e&&this.isPartneredWith(e)&&(delete this.partners[e.id],e.removePartner(this))}isPartneredWith(e){var t;return!!(!((t=this.partners)===null||t===void 0)&&t[e.id])}clearPartners(){this.partners&&Object.values(this.partners).forEach(e=>e.scroller.removePartner(this))}async scrollIntoView(e,t=Ur){const i=this,{isRectangle:r}=e,s=r?e:V.from(e),{xDelta:n,yDelta:l}=i.getDeltaTo(e,t),o=i.scrollBy(n,l,t);return(t.highlight||t.focus)&&o.then(()=>{r&&(e=s.translate(-n,-l)),t.highlight&&(isNaN(t.highlight)?(i.widget||i).callback(t.highlight,null,[e]):v.highlight(e,i)),t.focus&&v.focusWithoutScrolling(e)}),o}static async scrollIntoView(e,t=Ur,i=!1){const r=V.from(e),s=typeof t=="object"?t.animate:t,n=ut._globalScroller||(ut._globalScroller=new ut),l=[];n.rtlSource={rtl:i};let o=0,a=0,c;for(let d=e.parentNode;d.nodeType===Node.ELEMENT_NODE;d=d.parentNode){if(d===document.body&&d!==document.scrollingElement)continue;const f=d===document.scrollingElement?_c:d.ownerDocument.defaultView.getComputedStyle(d);if(t.y!==!1&&zi[f.overflowY]&&d.scrollHeight>d.clientHeight||t.x!==!1&&zi[f.overflowX]&&d.scrollWidth>d.clientWidth){n.element=d,n.positionDirty=!0;const{xDelta:g,yDelta:h}=n.getDeltaTo(r,t);(g||h)&&(l.push({element:d,x:d.scrollLeft,y:d.scrollTop,xDelta:g,yDelta:h}),r.translate(-g,-h),o+=g,a+=h)}}if(l.length){const d=Math.abs(o),f=Math.abs(a);let g=s&&(typeof s=="number"?s:typeof s.duration=="number"?s.duration:300);if(g&&(d>10||f>10))Math.max(d,f)<50&&(g=Math.min(g,500)),c=n.scrollAnimation=ee.animate(g,h=>{const p=h===1;for(const{element:m,x:y,y:b,xDelta:C,yDelta:E}of l)n.element=m,C&&(n.x=Math[i?"min":"max"](y+(p?C:Math.round(C*h)),0)),E&&(n.y=Math.max(b+(p?E:Math.round(E*h)),0))},null,s.easing),c.then(()=>{n.scrollAnimation=null});else{for(const{element:h,xDelta:p,yDelta:m}of l)h.scrollTop+=m,h.scrollLeft+=p;c=pl(l[l.length-1].element)}}else c=ml;return(t.highlight||t.focus)&&c.then(()=>{t.highlight&&(isNaN(t.highlight)?n.callback(t.highlight,null,[e]):v.highlight(e,n)),t.focus&&e.focus()}),c}scrollBy(e=0,t=0,i=Ur){const r=this,s=typeof i=="object"?i.animate:i,n=Math.abs(e),l=Math.abs(t);r.scrollAnimation&&(r.scrollAnimation.cancel(),r.scrollAnimation=null),(e||t)&&(r.silent=i.silent);let o=s&&(typeof s=="number"?s:typeof s.duration=="number"?s.duration:300);if(o&&(n>10||l>10)){const{x:a,y:c}=r;let d=a,f=c;return Math.max(n,l)<50&&(o=Math.min(o,500)),r.scrollAnimation=ee.animate(o,g=>{const h=g===1;if(e){if(Math.abs(r.x-d)>1&&!i.force){var p;return(p=r.scrollAnimation)===null||p===void 0?void 0:p.cancel()}r.x=Math.max(a+(h?e:Math.round(e*g)),0)}if(t){if(Math.abs(r.y-f)>1&&!i.force){var m;return(m=r.scrollAnimation)===null||m===void 0?void 0:m.cancel()}r.y=Math.max(c+(h?t:Math.round(t*g)),0)}d=r.x,f=r.y},r,s.easing),r.element.classList.add("b-scrolling"),r.scrollAnimation.then(()=>{r.isDestroyed||(r.element.classList.remove("b-scrolling"),r.scrollAnimation=null)}),r.scrollAnimation}else{if(e||t){const a=r.x,c=r.y;if(r.x+=e,r.y+=t,r.x!==a||r.y!==c)return pl(r.element)}return ml}}async scrollTo(e,t,i){const{x:r,y:s}=this,n=e==null?0:e-r,l=t==null?0:t-s;return this.scrollBy(n,l,i)}doDestroy(){var e;const t=this;if(t._element){var i;t._element.removeEventListener("scroll",t.scrollHandler),(i=t.wheelListenerRemover)===null||i===void 0||i.call(t)}(e=t.scrollAnimation)===null||e===void 0||e.cancel(),Object.values(t.partners||{}).forEach(({scroller:r})=>r.removePartner(t)),super.doDestroy()}onElMutation(e){const t=this,[i,r]=v.getTranslateXY(t.element);if(t._x!==-i||t.y!==-r){const s=new CustomEvent("scroll",{bubbles:!0});Object.defineProperty(s,"target",{get:()=>t.element}),t.onScroll(s)}}onElResize(){const e=this,{widget:t}=e;t!=null&&t.isAnimating?t.findListener("animationend","onElResize",e)===-1&&t.ion({animationEnd:"onElResize",thisObj:e,once:!0}):e.syncOverflowState()}onScroll(e){const t=this,{_x:i,_y:r,element:s}=t;let n=0;t.overflowX==="clip"&&s.scrollLeft!==i&&(s.scrollLeft=i,++n),t.overflowY==="clip"&&s.scrollTop!==r&&(s.scrollTop=r,++n),n!==2&&(!t.widget||!t.widget.isDestroyed)&&(t.positionDirty=!0,s.classList.contains("b-scrolling")||s.classList.add("b-scrolling"),e.widget=t.widget,t.silent||t.trigger("scroll",e),t.syncPartners(),t.controllingPartner=null,t.onScrollEnd(e))}syncPartners(e,t=this.propagateSync){const i=this;i.partners&&Object.values(i.partners).forEach(({axes:r,scroller:s})=>{(s!==i.controllingPartner||e)&&s.sync(i,r)&&t&&s.syncPartners(e,t)})}onScrollEnd(e){const t=this;t.silent&&(t.silent=!1),t.trigger("scrollEnd",e),t.controllingPartner=null,t.element.classList.remove("b-scrolling")}getDeltaTo(e,t){const i=this;if(!i.viewport)return{xDelta:0,yDelta:0};const{x:r,y:s,scrollWidth:n,scrollHeight:l,isRTL:o}=i,a=e instanceof V?e:V.from(e),c=t.block||"nearest",d=i.viewport,f=Nc(t.edgeOffset),g=d.width>=a.width+(f.start+f.end)?f:{start:0,end:0},h=d.height>=a.height+(f.top+f.bottom)?f:{top:0,bottom:0},p=new V(o?d.right- -r-n:d.x-r,d.y-s,n,l),m=a.clone().adjust(-g.start,-h.top,g.end,h.bottom).constrainTo(p),y=m.clone(),b=i.isRTL?-1:1;let C=0,E=0;if(c==="start")y.moveTo(d.x+(i.isRTL?d.width-y.width:0),d.y),C=m.x-y.x,E=m.y-y.y;else if(c==="end")y.moveTo(d.x+(i.isRTL?0:d.width-y.width),d.bottom-y.height),C=m.x-y.x,E=m.y-y.y;else if(c==="center"){const S=d.center;y.moveTo(S.x-y.width/2,S.y-y.height/2),C=C||m.x-y.x,E=E||m.y-y.y}else y.width>d.width?C=y.x-d.x:y.right>d.right?C=y.right-d.right:y.x<d.x&&(C=y.x-d.x),y.height>d.height?E=y.y-d.y:y.bottom>d.bottom?E=y.bottom-d.bottom:y.y<d.y&&(E=y.y-d.y);return C=b*Math.round(C),E=Math.round(E),{xDelta:t.x===!1?0:Math.max(Math.min(C,i.maxX-r),-r),yDelta:t.y===!1?0:Math.max(Math.min(E,i.maxY-s),-s)}}get viewport(){return V.client(this.element)}updateWidget(e){this.rtlSource=this.owner=e}updateElement(e,t){const i=this;if(i===ut._globalScroller){i._element=e,i.positionDirty=!0;return}const r=i.scrollHandler||(i.scrollHandler=i.onScroll.bind(i)),s=i.resizeHandler||(i.resizeHandler=i.onElResize.bind(i));if(t){if(i.translate){var n;(n=i.mutationObserver)===null||n===void 0||n.disconnect()}else t.removeEventListener("scroll",r),t.classList.remove(gl),t.style.overflowX=t.style.overflowY="";ce.removeResizeListener(t,s)}if(e){if(i.translate){if(i.mutationObserver||(i.mutationObserver=new MutationObserver(i.mutationHandler||(i.mutationHandler=i.onElMutation.bind(i)))),i._x=i._y=0,document.contains(e)){const[l,o]=v.getTranslateXY(e);i._x=-l,i._y=-o}i.mutationObserver.observe(e,{attributes:!0})}else e.addEventListener("scroll",r),e.classList.add(gl);ce.addResizeListener(e,s),i.widget||(i.rtlSource={get rtl(){return v.getStyleValue(e,"direction")==="rtl"}}),i.isRTL&&e.classList.add("b-rtl"),i.positionDirty&&(i.updateOverflowX(i.overflowX),i.updateOverflowY(i.overflowY)),i.syncOverflowState(),i.isConfiguring&&(i._x&&i.updateX(i._x),i._y&&i.updateY(i._y))}i.positionDirty=!0}get x(){const e=this,{element:t}=e;if(t&&e.positionDirty){if(e.translate){const[i,r]=v.getTranslateXY(t);e._x=-i,e._y=-r}else e._x=Math.abs(t.scrollLeft),e._y=t.scrollTop;e.positionDirty=!1}return e._x}get scrollLeft(){return this.x*(this.isRTL?-1:1)}changeX(e){if(e=Math.max(e,0),!this.isConfiguring||e)return e;this._x=e}updateContentElement(e){e&&(e=typeof e=="string"?this.element.querySelector(e):e,ce.addResizeListener(e,this.resizeHandler))}updateX(e){var t;const i=this,{element:r}=i;r&&!((t=i.widget)!==null&&t!==void 0&&t.isConfiguring)&&(e=Math.round(e),i.trigger("scrollStart",{x:e}),i.translate?v.setTranslateX(r,-e):r.scrollLeft=i.isRTL?-e:e),i.positionDirty=!0}sync(e,t){const i=this,{x:r,y:s}=t;let n=!1;return r!=null&&i.x!==e.x&&(i.controllingPartner=e,i.x=e.x,n=!0),s!=null&&i.y!==e.y&&(i.controllingPartner=e,i.y=e.y,n=!0),n}get y(){const e=this,{element:t}=e;if(t&&e.positionDirty){if(e.translate){const[i,r]=v.getTranslateXY(t);e._x=-i,e._y=-r}else e._x=t.scrollLeft,e._y=t.scrollTop;e.positionDirty=!1}return e._y}changeY(e){if(!this.isConfiguring||e)return e;this._y=e}updateY(e){const{element:t,widget:i}=this;t&&!(i!=null&&i.isConfiguring)&&(this.trigger("scrollStart",{y:e}),this.translate?v.setTranslateY(t,-e):t.scrollTop=e),this.positionDirty=!0}get maxX(){return this.scrollWidth-this.clientWidth}get maxY(){return this.scrollHeight-this.clientHeight}get lastScrollLeft(){return(this.scrollWidth-this.clientWidth)*(this.isRTL?-1:1)}updateOverflowX(e,t){const i=this,{element:r,translate:s}=i,{style:n,classList:l}=r;t==="hidden-scroll"&&l.remove("b-hide-scroll"),e==="hidden-scroll"&&!s&&(zi[n.overflowY]?(e="hidden",i.enableWheel()):l.add("b-hide-scroll")),s||(n.overflowX=hl[e]||e),i.isConfiguring||(i.positionDirty=!0,i.syncOverflowState())}updateOverflowY(e,t){const i=this,{element:r,translate:s}=i,{style:n,classList:l}=r;t==="hidden-scroll"&&l.remove("b-hide-scroll"),e==="hidden-scroll"&&!s&&(zi[n.overflowX]?(e="hidden",i.enableWheel()):l.add("b-hide-scroll")),s||(n.overflowY=hl[e]||e),i.isConfiguring||(i.positionDirty=!0,i.syncOverflowState())}enableWheel(){this.wheelListenerRemover||(this.wheelListenerRemover=z.on({element:this.element,wheel:"onWheel",thisObj:this}))}onWheel(e){Math.abs(e.deltaX)>Math.abs(e.deltaY)&&this.overflowX==="hidden-scroll"?this.x+=e.deltaX:this.overflowY==="hidden-scroll"&&(this.y+=e.deltaY)}get scrollWidth(){var t;var e;return(t=(e=this.element)===null||e===void 0?void 0:e.scrollWidth)!=null?t:0}set scrollWidth(e){const t=this,{element:i,isRTL:r}=t;let s=t.widthStretcher;s&&e==null?(s.remove(),t.widthStretcher=null):e&&(e=Math.abs(e),s||(s=t.widthStretcher=v.createElement({className:"b-scroller-stretcher b-horizontal-stretcher",retainElement:!0})),s.style.transform=`translateX(${(e-1)*(r?-1:1)}px)`,i&&!i.contains(s)&&i.insertBefore(s,i.firstElementChild)),t.propagate!==!1&&t.eachPartner(({scroller:n})=>{n.propagate=!1,n.scrollWidth=e,delete n.propagate}),t.positionDirty=!0,t.syncOverflowState()}get scrollHeight(){var t;var e;return(t=(e=this.element)===null||e===void 0?void 0:e.scrollHeight)!=null?t:0}set scrollHeight(e){const t=this,i=t.stretcher||(t.stretcher=v.createElement({className:"b-scroller-stretcher"}));i.style.transform=`translateY(${e-1}px)`,t.element&&t.element.lastChild!==i&&t.element.appendChild(i),t.positionDirty=!0,t.syncOverflowState()}get clientWidth(){var e;return((e=this.element)===null||e===void 0?void 0:e.clientWidth)||0}get clientHeight(){var e;return((e=this.element)===null||e===void 0?void 0:e.clientHeight)||0}get id(){return this._id||(this.widget?this._id=`${this.widget.id}-scroller`:this._id=Pi.generateId("scroller-")),this._id}preProcessCurrentConfigs(e){super.preProcessCurrentConfigs(),delete e.widget,delete e.element}}ut._$name="Scroller";class Bi{constructor(e){this.promise=new Promise((t,i)=>{this.resolve=t,this.reject=i}),e&&e(this)}}Bi._$name="Promissory";const{defineProperty:qr}=Reflect;class ct extends $.mixin(Bt,Oe,rt,Gt){static get configurable(){return{element:null}}static get delayable(){return{refreshDom:"raf"}}static get identifiable(){return{}}static get renderConfigs(){const e=this,t=e.$meta;let i=t.renderConfigs,r,s;if(i===void 0){i=null,r=t.configs;for(s in r)r[s].render&&(i||(i=new Set)).add(s);t.renderConfigs=e.prototype.$renderConfigs=i}return i}construct(...e){this.$iid=++ct.$idSeed,this.byRef={},super.construct(...e),this.onDraw!==ct.prototype.onDraw&&this.initDrawable()}startConfigure(e){this.element=this.renderContext.renderDom(),super.startConfigure(e)}get element(){return this.refreshDom.flush(),this._element}changeElement(e,t){const i=this;return t&&t.remove(),e&&(e.id=i.id,e=v.createElement(e,{refOwner:i})),e}updateId(e,t){const i=this;if(t){const r=i.element;r.id=e,i.fixRefOwnerId(r,e,t)}}get classes(){return this.element.classList}fixRefOwnerId(e,t,i){if(e.$refOwnerId===i){e.$refOwnerId=t;const r=e.$reference;r&&(e.id=`${t}-${r}`);for(const s of e.childNodes)this.fixRefOwnerId(s,t,i)}}onConfigChange({name:e}){!this.isConfiguring&&this.$renderConfigs.has(e)&&this.refreshDom()}attachRef(e,t,i){const r=this,s="_"+e,{listeners:n}=i;s in r||qr(r,e,{get(){return r.refreshDom.flush(),r[s]},set(l){r[s]=l}}),t.id=`${r.id}-${e}`,r.byRef[e]=t,r[e]=t,n&&(i.listeners={on:n,un:z.on(Object.assign({element:t,thisObj:r},n))})}detachRef(e,t,i){i.listeners&&(i.listeners.un(),i.listeners=null),this[e]=null,delete this.byRef[e]}renderDom(){return{}}get renderContext(){const e=this,t=e.$meta,i=e.constructor;let r=t.renderConfigs||i.renderConfigs,s=e;if(!r){s=Object.create(e),r=new Set;for(const n in t.configs)qr(s,n,{get(){return r.add(n),e[n]}});s.renderDom=()=>e.renderDom.call(s),e.$renderConfigs=r}return qr(e,"renderContext",{value:s}),s}refreshDom(){X.sync({targetElement:this.element,domConfig:this.renderContext.renderDom(),refOwner:this,strict:!0})}onListen(e){e==="draw"&&this.initDrawable()}initDrawable(){const e=this;if(!e.intersector){let t=Object.values(e.byRef).find(i=>i.classList.contains("b-drawable"));t||(t=e.element,t.classList.add("b-drawable")),e.intersector=new IntersectionObserver(i=>{e.isDestroyed||i.forEach(r=>{r.isIntersecting&&e.onDraw({count:++e.drawCounter})})}),e.intersector.observe(t)}}onDraw(e){this.trigger("draw",e)}}ct.$idSeed=0,Object.assign(ct.prototype,{drawCounter:0,hasGeneratedId:!1,intersector:null}),ct._$name="Renderable";const Nt=class extends ct{construct(e){if(e){let r=e.element,s;r&&(ne.deprecate("Core","4.0.0",'Mask "element" config has been renamed to "target"'),e=s=Object.assign({},e),delete s.element,s.target=r),r=e.target,typeof r=="string"&&(e=s=s||Object.assign({},e),s.target=e.owner[r])}super.construct(e);const t=this,{type:i}=t;t.target||(t.target=document.body),t.maskName=`mask${typeof i=="string"?i.trim():""}-${Nt.counter++}`,t.show()}doDestroy(){const e=this,{element:t}=e;if(e.type==="trial")return!1;t&&(e.element=null,e.mode.endsWith("blur")&&v.forEachChild(t,i=>{i.classList.remove(`b-masked-${e.mode}`)}),e.target.classList.remove("b-masked"),e.target[e.maskName]=null,j.remove(Nt.masks,e)),super.doDestroy()}get maskElement(){return this.element}set error(e){this.setConfig(this.errorDefaults),this.text=e}renderDom(){const e=this,{maxProgress:t}=e;return{class:{"b-mask":1,"b-delayed-show":e.showDelay,"b-widget":1,[`b-mask-${e.mode}`]:1,"b-progress":t,"b-prevent-transitions":!e.useTransition},children:[{reference:"maskContent",class:"b-mask-content b-drawable",children:[t?{reference:"progressElement",class:"b-mask-progress-bar",style:{width:`${Math.max(0,Math.min(100,Math.round(e.progress/t*100)))}%`}}:null,{reference:"maskText",class:"b-mask-text",html:(e.icon?`<i class="b-mask-icon ${e.icon}"></i>`:"")+e.text}]}]}}static mergeConfigs(...e){const t={};for(const i of e)typeof i=="string"?t.text=i:w.assign(t,i);return t}static mask(e,t=document.body){return Nt.new({target:t},typeof e!="string"?{...e}:{text:e})}static unmask(e=document.body){const t=this.getElementMasks(e);return t.length>0?t[t.length-1].close():null}static unmaskAll(e=document.body){return this.getElementMasks(e).forEach(t=>t.close())}static getElementMasks(e){return this.masks.filter(t=>t.target===e)}updateAutoClose(e){this.deferredClose.cancel(),e&&(this.deferredClose.delay=e,this.deferredClose())}updateCover(){this.syncCover()}syncCover(){var e,t;(e=this.owner)===null||e===void 0||(t=e.syncMaskCover)===null||t===void 0||t.call(e,this)}onOwnerResize(){this.syncCover()}updateOwner(e){this.detachListeners("cover"),e==null||e.ion({name:"cover",recompose:"onOwnerResize",resize:"onOwnerResize",thisObj:this})}updateShowDelay(e){const{delayedShow:t}=this;t.delay=e,e||t.flush()}deferredClose(){var e;const{owner:t}=this;this.close().then(()=>{var i;t==null||(i=t.onMaskAutoClose)===null||i===void 0||i.call(t,this)}),t==null||(e=t.onMaskAutoClosing)===null||e===void 0||e.call(t,this)}delayedShow(){this.classes.remove("b-delayed-show")}show(){const e=this,{element:t,target:i,hiding:r,maskName:s}=e;r&&(r.resolve(),e.hiding=null,e.clearTimeout("hide")),e.showDelay&&(t.classList.add("b-delayed-show"),e.delayedShow()),t.classList.add("b-visible"),t.classList.remove("b-hidden"),i.classList.add("b-masked"),i[s]||(i[s]=e,i.appendChild(t)),j.include(Nt.masks,e),e.shown=!0,e.trigger("show"),e.mode.endsWith("blur")&&v.forEachChild(i,n=>{n!==t&&n.classList.add(`b-masked-${e.mode}`)})}hide(){const e=this,{target:t,element:i}=e;let{hiding:r}=e;if(!r){if(!e.shown)return Promise.resolve();e.hiding=r=new Bi,e.shown=!1,i.classList.remove("b-visible"),i.classList.add("b-hidden"),t.classList.remove("b-masked"),e.mode.endsWith("blur")&&v.forEachChild(t,s=>{s!==i&&s.classList.remove(`b-masked-${e.mode}`)}),r.promise=r.promise.then(()=>{e.hiding===r&&(e.hiding=null)}),e.setTimeout(()=>r.resolve(),500,"hide")}return r.promise}async close(){await this.hide(),this.destroy()}};let xe=Nt;R(xe,"$name","Mask"),R(xe,"type","mask"),R(xe,"configurable",{autoClose:null,cover:null,icon:"b-icon b-icon-spinner",errorDefaults:{icon:"b-icon b-icon-warning",autoClose:3e3,showDelay:0},maxProgress:null,mode:"dark",progress:null,owner:{$config:"nullify",value:null},target:null,text:null,type:null,showDelay:null,useTransition:!1}),R(xe,"delayable",{deferredClose:0,delayedShow:0,syncCover:{type:"throttle",delay:100}}),R(xe,"counter",0),R(xe,"masks",[]),xe._$name="Mask";var yl=u=>{var e;return e=class extends(u||$){get widgetClass(){}get keyMapElement(){return this.element}get keyMapSubComponents(){return this.features}matchKeyMapEntry(i,r=this.keyMap){if(r&&!i.handled&&i.key!==void 0)return w.keys(r).find(s=>{const n=s.split("+"),l=n.includes("Alt"),o=n.includes("Shift"),a=n.includes("Ctrl");let c=n[n.length-1].toLowerCase();return c==="space"&&(c=" "),c===i.key.toLowerCase()&&(!i.altKey&&!l||i.altKey&&l)&&(!i.ctrlKey&&!a||i.ctrlKey&&a)&&(!i.shiftKey&&!o||i.shiftKey&&o)})}performKeyMapAction(i){const{keyMap:r}=this;let s=!1;if(r&&!i.handled&&i.key!==void 0){const l=this.matchKeyMapEntry(i);if(r[l]){const o=j.asArray(r[l]);i.fromKeyMap=!0;let a;for(let c of o){if(a=!0,w.isObject(c)){if(!c.handler)continue;c.preventDefault===!1&&(a=!1),c=c.handler}if(typeof c=="string"){var n;const{thisObj:d,handler:f}=this.resolveKeyMapAction(c);if(((n=d.isActionAvailable)===null||n===void 0?void 0:n.call(d,{key:l,action:c,event:i,actionName:c.split(".").pop()}))!==!1&&f.call(d,i)!==!1){s=!0;break}}else if(c.call(this)!==!1){s=!0;break}}delete i.fromKeyMap,s&&(a&&i.preventDefault(),i.handled=!0)}}return s}resolveKeyMapAction(i){const{keyMapSubComponents:r}=this;if(i.startsWith("up.")||i.startsWith("this."))return this.resolveCallback(i);if(r&&i.includes(".")){const[s,n]=i.split(".");if(s&&n)return{thisObj:r[s],handler:r[s][n]}}return{thisObj:this,handler:this[i]}}updateKeyMap(i){var r;(r=this.keyMapDetacher)===null||r===void 0||r.call(this),w.isEmpty(i)||(this.keyMapDetacher=z.on({element:this.keyMapElement,keydown:"keyMapOnKeyDown",thisObj:this}))}keyMapOnKeyDown(i){this.performKeyMapAction(i)}mergeKeyMaps(i,r,s=null){const n={};i&&w.assign(n,i);for(const l in r){if(!r[l])continue;const o=j.asArray(i==null?void 0:i[l]),a=[];o!=null&&o.length&&a.push(...o);for(const c of j.asArray(r[l]))w.isObject(c)&&c.handler?a.push(w.assignIf({handler:(s?s+".":"")+c.handler},c)):a.push((s?s+".":"")+c);a.sort((c,d)=>{const f=(c.weight||0)-(d.weight||0);return f===0&&o!==null&&o!==void 0&&o.length?o.indexOf(c)-o.indexOf(d):f}),n[l]=a}return n}},R(e,"$name","KeyMap"),R(e,"configurable",{keyMap:{value:null,$config:{merge:"objects",nullify:!0}}}),e},vl=u=>{var e;return e=class extends(u||$){get widgetClass(){}get isRTL(){return this.rtl}updateRtl(i){const{element:r}=this;r&&(r.classList.toggle("b-rtl",i===!0),r.classList.toggle("b-ltr",i===!1))}startConfigure(i){var r;if((r=super.startConfigure)===null||r===void 0||r.call(this,arguments),!i.floating&&i.rtl==null){var s;const n=this,l=i.rootElement||i.forElement||((s=n.parent)===null||s===void 0?void 0:s.contentElement)||(n.floating?n.floatRoot:n.changeElementRef(n.getRenderContext(i)[0]||i.adopt||document.body)),o=i.owner||i.parent||n.constructor.fromElement(l);o?i.rtl=o[o.isConfiguring?"peekConfig":"getConfig"]("rtl"):i.rtl=(l==null?void 0:l.nodeType)===1&&getComputedStyle(l).getPropertyValue("direction")==="rtl",i.rtl&&(n.configDone.rtl=!1)}}render(...i){var r;if(super.render&&super.render(...i),(B.isChrome&&B.chromeVersion<87||B.isFirefox&&B.firefoxVersion<66||B.isSafari&&B.safariVersion<14.1)&&this.element.classList.add("b-legacy-inset"),getComputedStyle(this.element).direction==="rtl"||(r=this.owner)!==null&&r!==void 0&&r.rtl){var s;this.rtl=!0,(s=this.childItems)===null||s===void 0||s.forEach(n=>n.rtl=!0)}}},R(e,"$name","RTL"),R(e,"configurable",{rtl:null}),e};const bl=Object.freeze({highlight:!1,onlyName:!1}),si=[],Kr="highlightExternalChange",Yr=/transparent|rgba\(0,\s*0,\s*0,\s*0\)/,ji=Symbol("renderConfigObserver"),Vc={INPUT:1,TEXTAREA:1},Gr=(u,e,t,i)=>{var r;let s=(t==null?void 0:t.listeners)||(t==null?void 0:t.internalListeners);if(s=((r=s)===null||r===void 0?void 0:r.on)||s,s){const n=z.on(w.assign({element:e,thisObj:u},s));i?(u._refListeners||(u._refListeners=Object.create(null)))[i]=n:t.listeners={on:s,un:n}}},Cl=(u,e)=>u&&e&&e[w.keys(u)[0]]?Q.merge(u,e):u,zc=u=>{u.isVisible&&u.triggerPaint()},Bc=/^:not\((.+)\)$/,jc=/absolute|fixed/i,Hc=u=>u.scale!=null,{hasOwn:mt}=w,{defineProperty:wl}=Reflect,Sl=u=>parseFloat(u)*(u.endsWith("ms")?1:1e3),El=["b-aligned-above","b-aligned-right","b-aligned-below","b-aligned-left"],Wc={configurable:!0,get(){return!1}},Hi=/(?:L\{([^}.]+)\})/,Uc=(u,e)=>"L{Tooltip."+e+"}",Tl=/^([trblc])(\d*)-([trblc])(\d*)$/i,qc=(u,e)=>(Tl.test(u)&&(u={align:u}),Tl.test(e)&&(e={align:e}),Q.merge(u,e)),Kc=/^[\w.]+$/,xl={1:"maxHeight",2:"height",4:"maxWidth",8:"width"};class M extends $.mixin(Bt,Oe,rt,Gt,Mt,yl,vl){static mergeCls(e,t){return t&&e?e=new W(t).assign(typeof e=="string"?new W(e):e):e&&!e.isDomClassList&&(e=new W(e)),e}static get $name(){return"Widget"}static get type(){return"widget"}static get configurable(){return{element:!0,callOnFunctions:!0,id:"",html:null,content:null,cls:{$config:{merge:"classList"},value:null},ui:{$config:{merge:"classList"},value:null},collapsify:null,contentElementCls:{$config:{merge:"classList"},value:null},defaultCls:{$config:{merge:"classList"},value:null},dock:null,forwardTwinEvents:{$config:{merge:"classList"},value:null},parent:null,tab:null,elementAttributes:null,htmlCls:{$config:{merge:"classList"},value:{"b-html":1}},style:null,disabled:null,readOnly:{value:null,default:!1,$config:null},ignoreParentReadOnly:null,adopt:null,appendTo:null,insertBefore:null,insertFirst:null,dataset:null,tooltip:{$config:["lazy","nullify"],value:null},showTooltipWhenDisabled:!0,preventTooltipOnTouch:null,monitorResize:{$config:["lazy","nullify"],value:null},masked:{$config:"nullify",value:null},maskDefaults:{target:"element"},cache:{},floating:null,positioned:null,draggable:null,align:{$config:{merge:qc},value:"t-b"},centered:null,constrainTo:void 0,anchor:null,owner:null,scrollAction:null,hideAnimation:{$config:{merge:Cl},value:null},showAnimation:{$config:{merge:Cl},value:null},x:null,y:null,scrollable:{$config:["lazy","nullify"],value:null},scrollerClass:ut,defaultBindProperty:"html",defaultAction:null,overflowable:{value:null,default:!0,$config:null},width:null,height:null,maxHeight:null,maxWidth:null,minWidth:null,minHeight:null,scaleToFitWidth:null,allowGrowWidth:!0,margin:null,flex:null,weight:null,alignSelf:null,ripple:null,title:null,localizableProperties:["title","ariaLabel","ariaDescription"],requireSize:!1,ref:null,hidden:null,textAlign:null,ignoreScrollDuration:500,tag:"div",recomposeAsync:null,rootElement:null,htmlMutationObserver:{$config:["lazy","nullify"],value:{childList:!0,subtree:!0}},role:{$config:"lazy",value:"presentation"},ariaLabel:{$config:"lazy",value:null},ariaDescription:{$config:"lazy",value:null},ariaElement:"element",ariaHasPopup:null,realignTimeout:300,testConfig:{ignoreScrollDuration:100,realignTimeout:50},maximizeOnMobile:null}}static get prototypeProperties(){return{hasGeneratedId:!1,innerItem:!0}}static get declarable(){return["renderConfigs"]}static get delayable(){return{recompose:"raf",doHideOrRealign:"raf",onAlignConstraintChange:"raf"}}static get factoryable(){return{defaultType:"widget"}}static get identifiable(){return{}}static get all(){return super.all}static get recomposeAsync(){return M._recomposeAsync}static set recomposeAsync(e){if(M._recomposeAsync=e,e!=null){const{all:t}=M;for(let i=0;i<t.length;++i)t[i].isComposable&&(t[i].recomposeAsync=e)}}isType(e,t){return M.isType(this,e,t)}static setupRenderConfigs(e,t){const i=t.getInherited("renderConfigs"),{renderConfigs:r}=e;if(r){if(Array.isArray(r))for(const s of r)i[s]=!0;else w.assign(i,r);i[ji]=null}}construct(e={},...t){const i=this,{domSyncCallback:r}=i;if(!globalThis.bryntum.cssVersion){const n=globalThis.bryntum.cssVersion=jr.getCSSVersion(),l=ne.getVersion("core");n&&n!==l&&console.warn(`CSS version ${n} doesn't match bundle version ${l}!
Make sure you have imported css from the appropriate product version.`)}i.configureAriaDescription=e.ariaDescription,i._isAnimatingCounter=0,i.alignmentChanges=0,i.byRef=Object.create(null),i.onTargetResize=i.onTargetResize.bind(i),i.onFullscreenChange=i.onFullscreenChange.bind(i),i.domSyncCallback=r.$nullFn?null:r.bind(i),i._isUserAction=!1,super.construct(e,...t);const{recomposeAsync:s}=M;s!=null&&i.recomposeAsync==null&&(i.recomposeAsync=s),i.finalizeInit()}startConfigure(e){super.startConfigure(e);const t=this,{adopt:i,element:r}=t;i&&(t.adoptElement(r,i,e.id),t.updateElement(t._element,r))}finalizeInit(){const e=this,t=e.insertBefore||e.appendTo||e.insertFirst||e.adopt;if(t){var i;e.owner||(i=t.nodeType?t:document.getElementById(t))!==null&&i!==void 0&&i.isConnected?e.render():(e.onFirstResizeAfterConnect=e.onFirstResizeAfterConnect.bind(e),ce.addResizeListener(t,e.onFirstResizeAfterConnect))}}onFirstResizeAfterConnect(e){ce.removeResizeListener(e,this.onFirstResizeAfterConnect),!this.isDestroyed&&!this.rendered&&this.render()}doDestroy(){var e;const t=this,{preExistingElements:i,element:r,adopt:s,_refListeners:n,_rootElement:l}=t;if(_e.element===r&&_e.exit(),n&&(Object.values(n,d=>d()),t._refListeners=null),r){var o,a,c;const d=!t._tooltip&&l&&((o=M.Tooltip)===null||o===void 0?void 0:o.getSharedTooltip(l,t.eventRoot,!0));if((d==null?void 0:d.owner)===t&&(d.owner=null,d.hide()),t.onExitFullscreen(),t.clearTimeout(t.scrollListenerTimeout),t.clearTimeout(t.resizeListenerTimeout),t.removeTransientListeners(),t.floating||t.positioned?t.hide(!1):t.revertFocus(),ce.removeResizeListener(r.parentElement,t.onParentElementResize),ce.removeResizeListener(r,t.onElementResize),s){for(let f=Array.from(r.childNodes),g=0,{length:h}=f;g<h;g++){const p=f[g];!i.includes(p)&&p!==t.floatRoot&&p.remove()}r.className=t.adoptedElementClassName,r.style.cssText=t.adoptedElementCssText}(a=t.dragEventDetacher)===null||a===void 0||a.call(t),(c=t.dragOverEventDetacher)===null||c===void 0||c.call(t),t.dragGhost.remove()}(e=t.connectedObserver)===null||e===void 0||e.disconnect(),super.doDestroy(),s||r.remove()}get assignValueDefaults(){return bl}get valueName(){return this.name||this.ref||this.id}getValueName(e){return e=e&&typeof e=="object"?e.onlyName:e,e?this.name:this.valueName}assignFieldValue(e,t,i){const r=this,s=r.defaultBindProperty;s in r&&(r[s]=i)}assignValue(e,t=bl){const i=this,r=i[Kr],s=i.getValueName(t);s&&(!e||s in e)&&(t.highlight===!1&&(i[Kr]=!1),i.assignFieldValue(e,s,e?e[s]:null),i[Kr]=r)}gatherValue(e){const t=this,i=t.defaultBindProperty;t.constructor!==M&&i in t&&(e[t.name||t.ref||t.id]=t[i])}gatherValues(e){this.eachWidget(t=>t.gatherValue(e),!1)}get forwardTwinEvents(){const e=this._forwardTwinEvents;return e&&w.getTruthyKeys(e)}configureOverflowTwin(e){var t;const i=this;let r=w.clone(i.initialConfig);return delete r.id,r.hidden=!1,r.type=i.type,r._overflowTwinOrigin=i,r.disabled=i.disabled,"value"in i&&(r.value=i.value),(t=i.forwardTwinEvents)===null||t===void 0||t.forEach(s=>{delete r[`on${k.capitalize(s)}`]}),e&&(r=typeof e=="function"?e(r)||r:w.assign(r,e)),r}createOverflowTwin(e){var t;const i=this,r=i.configureOverflowTwin(e),s=M.create(r);return(t=i.forwardTwinEvents)===null||t===void 0||t.forEach(n=>{s.ion({[n]:l=>{i.overflowTwin===l.source&&(l=w.assign({},l),delete l.source,i.trigger(l.eventName,l))}})}),s}ensureOverflowTwin(e,t){let{overflowTwin:i}=this;return i||(this.overflowTwin=i=this.createOverflowTwin(e),t==null||t(i)),i}get isComposable(){return!this.compose.$nullFn}adoptElement(e,t,i){const r=this,s=typeof t=="string"?document.getElementById(t):t,n=M.fromElement(s);n&&n.adopt&&n!==r&&(typeof n.adopt=="string"?document.getElementById(n.adopt):n.adopt)===s&&n.destroy(),r.preExistingElements=Array.from(s.childNodes),r.adoptedElementClassName=s.className,r.adoptedElementCssText=s.style.cssText,s.id&&!i&&(r.id=e.id=s.id),v.syncAttributes(e,s);for(let c=0,{length:d}=e.childNodes;c<d;c++)s.appendChild(e.childNodes[0]);delete r._contentRange,r._element=s;const l=e.lastDomConfig,o=l==null?void 0:l.listeners;if(o&&r.isComposable){var a;(a=o.un)===null||a===void 0||a.call(o),Gr(r,s,l)}s.lastDomConfig=l||s.lastDomConfig,s.$refOwnerId=r.id,r.scaleToFitWidth||r.getConfig("monitorResize")}addRefAccessor(e,t){const{prototype:i}=this.constructor;wl(i,t,{writable:!0,value:null}),wl(i,e,{get(){return this.recompose.flush(),this[t]},set(r){this[t]=r}})}attachRef(e,t,i){const r=this,s="_"+e;t.dataset&&(t.dataset.ownerCmp=r.id),r.isComposable&&(s in r||r.addRefAccessor(e,s),Gr(r,t,i,e)),r.byRef[e]=t,r[e]=t}detachRef(e,t,i){const r=this,s=r._refListeners;s!=null&&s[e]&&(s[e](),delete s[e]),r[e]=null,delete r.byRef[e]}afterRecompose(){}compose(){return{class:W.normalize(this.widgetClassList,"object")}}doCompose(){const e=this,{$meta:t}=e,i=t.hierarchy,r=t.renderConfigs||t.getInherited("renderConfigs");let{composers:s}=t,n=null,l,o,a,c;if(e.recompose.suspend(),!s){for(t.composers=s=[],a=i.indexOf(M);a<i.length;++a)c=i[a].prototype,mt(c,"compose")&&s.push(c);mt(r,ji)||(r[ji]={get(d){r[d]=!0}})}for(e.configObserver=r[ji],a=0;a<s.length;++a)l=s[a].compose.call(e,n),n=n?v.merge(n,l):l;return mt(e,"compose")&&(l=e.compose)&&(l=l.call(e,n),v.merge(n,l)),e.configObserver=null,v.normalizeChildren(n,(d,f)=>{f&&(o="_"+d,o in e||e.addRefAccessor(d,o))})}get element(){return this.isComposable&&!this.isDestroying&&this.recompose.flush(),this._element}domSyncCallback(e){}changeElement(e){const t=this,i=t.isComposable;return i&&(e=t.doCompose()),typeof e=="string"?e=v.createElementFromTemplate(e):w.isObject(e)?(e=v.createElement(e,{refOwner:t,callback:t.domSyncCallback}),t.recompose.resume(),i&&Gr(t,e,e.lastDomConfig)):v.isReactElement(t.peekConfig("html"))?e=document.createElement("div"):e.nodeType!==1&&(e=v.createElementFromTemplate(t.template(t))),e.id=t.id,t.elementAttributes&&v.setAttributes(e,t.elementAttributes),e}updateElement(e){const t=this,{className:i}=e,{contentElement:r,contentElementCls:s,isComposable:n}=t,l=r!==e,o=!n&&e.querySelectorAll("[data-reference]"),a=n?[]:t.widgetClassList;let c=(l||!n)&&t.uiClasses;if(i&&a.unshift(i),t._hidden&&a.push("b-hidden"),t._readOnly&&a.push("b-readonly"),ee.noThrow(e,"remove"),c?(s!=null&&s.value&&(c=c.slice(),c.push(s.value)),c=c.join(" ")):c=s==null?void 0:s.value,c&&(l?r.className+=" "+c:a.push(c)),!t.parent){const{defaultCls:d}=t,{outerCls:f}=M;a.push(...d?f.filter(g=>!(g in d)||d[g]):f)}if(e.className=a.join(" "),o)for(let d,f=0;f<o.length;++f)d=o[f],t.attachRef(d.getAttribute("data-reference"),d),d.removeAttribute("data-reference");!t.adopt&&!t.scaleToFitWidth&&t.getConfig("monitorResize"),t.getConfig("role"),t.getConfig("ariaLabel"),t.getConfig("ariaDescription"),t._html&&t.getConfig("htmlMutationObserver"),t.trigger("elementCreated",{element:e})}updateAriaDescription(e){const{ariaElement:t}=this,i=`${this.id}-aria-desc-el`;if(e){const r=this._ariaDescEl||(this._ariaDescEl=v.createElement({className:"b-aria-desc-element",id:i,parent:t}));r.innerText=e.match(Hi)?this.L(e,this):e,t.setAttribute("aria-describedBy",r.id)}else t.getAttribute("aria-describedby")===i&&t.removeAttribute("aria-describedBy")}updateAriaLabel(e){v.setAttributes(this.ariaElement,{"aria-label":e!=null&&e.match(Hi)?this.L(e,this):e})}updateAriaHasPopup(e){v.setAttributes(this.ariaElement,{"aria-haspopup":e})}updateRole(e){if(e){var t;(t=this.ariaElement)===null||t===void 0||t.setAttribute("role",e)}else{var i;(i=this.ariaElement)===null||i===void 0||i.removeAttribute("role")}}get ariaElement(){this.getConfig("element");const{_ariaElement:e}=this;return e.nodeType===Node.ELEMENT_NODE?e:w.getPath(this,e)}isCollapsified({collapsed:e,alt:t}){const{collapsify:i}=this,r=i==="hide",s=i===!1,n=i==null;return t?i==="overlay"||n&&e:s||r||n&&!e}async recompose(){const e=this,t={targetElement:e.element,domConfig:e.doCompose(),refOwner:e,callback:e.domSyncCallback,strict:!0};if(e.transitionRecompose){if(e.isTransitioningDom=!0,await v.transition(w.assign({element:e.element,action(){X.sync(t)}},e.transitionRecompose)),e.isDestroyed)return;e.isTransitioningDom=!1,e.trigger("transitionedRecompose")}else X.sync(t);t.changed&&(e.afterRecompose(),e.trigger("recompose")),e.resumeRecompose()}resumeRecompose(){this.recompose.resume()}changeElementRef(e){if(typeof e=="string"){const t=e;if(!(e=document.getElementById(t)))throw new Error(`No element found with id '${t}'`)}return e}changeAppendTo(e){return this.changeElementRef(e)}updateAppendTo(e){!this.isConfiguring&&e&&this.render()}changeInsertBefore(e){return this.changeElementRef(e)}updateInsertBefore(e){!this.isConfiguring&&e&&this.render()}changeInsertFirst(e){return this.changeElementRef(e)}updateInsertFirst(e){!this.isConfiguring&&e&&this.render()}getRenderContext(e=this,t){let i=t||e.appendTo,{insertFirst:r,insertBefore:s}=e;return r&&(i=r,s=i.firstChild),s&&(i||(i=s.parentElement)),[i,s||void 0]}render(e,t=!0){const i=this,{element:r}=i,[s,n]=i.getRenderContext(i,e);i.emptyCache(),i.syncElement&&i.currentElement?v.sync(r,i.currentElement):(s==null||s.insertBefore(r,n),i.currentElement=r),M.fromElement(r.parentElement)&&r.classList.remove(...M.outerCls),super.render(s,t),i.rendered=!0,i.getConfig("role"),t&&(i.getConfig("contentRange"),i.triggerPaint()),i.setupFocusListeners()}template({tag:e,html:t,htmlCls:i,name:r}){var s;const n=this;typeof t=="string"&&Kc.test(t)&&n.resolveCallback(t,n,!1)&&(t=n.callback(t,n,[n]));const l=(s=t)!==null&&s!==void 0&&s.call?t.call(n,n):t;return`<${e} class="${l?i:""}" ${r?`data-name="${r}"`:""}>${l||""}</${e}>`}updateRecomposeAsync(e){this.recompose.immediate=!e}onConfigChange({name:e}){var t;this._element&&!this.isDestroying&&(t=this.$meta.renderConfigs)!==null&&t!==void 0&&t[e]&&this.recompose()}preProcessCurrentConfigs(e){super.preProcessCurrentConfigs(e),delete e.parent}getConfigValue(e,t){return e==="style"?this._style:super.getConfigValue(e,t)}getCurrentConfig(e){const t=super.getCurrentConfig(e);return(e==null?void 0:e.depth)>0&&(t.type=this.type),t}get dataset(){return this.element.dataset}changeDataset(e){w.assign(this.dataset,e)}get dragGhost(){return this.constructor._dragGhost||(this.constructor._dragGhost=v.createElement({html:"\xA0",style:"position:absolute;top:-10000em;left:-10000em"}))}updateParent(e){const{_element:t}=this;t&&t.classList[e?"remove":"add"](...M.outerCls)}get constrainTo(){var e;let t=this._constrainTo;if(t=t===void 0?globalThis:((e=t)===null||e===void 0?void 0:e.nodeType)===Node.DOCUMENT_FRAGMENT_NODE?t.host||t.ownerDocument:t,this.positioned){const{offsetParent:i}=this.element;if(i&&v.getStyleValue(i,"overflow")==="hidden")t=V.from(i).moveTo(0,0);else if(t&&!t.isRectangle){const r=t===document||t===globalThis;t=V.from(t,i),r&&t.translate(globalThis.pageXOffset,globalThis.pageYOffset)}}return t}updateCentered(e){const{element:t,_anchorElement:i}=this;if(e&&!this.floating&&!this.positioned)throw new Error("`centered` is only relevant when a Widget is `floating` or `positioned`");e?(t.classList.add("b-centered"),t.style.transform=t.style.left=t.style.top="",i==null||i.classList.add("b-hide-display"),t.classList.remove("b-anchored")):t.classList.remove("b-centered")}get contentElement(){return this.element}get contentRange(){const e=this,{contentElement:t}=e,i=e._contentRange||(e._contentRange=new Range);return i.collapsed&&(i.setStart(t,e.contentRangeStartOffset||0),i.setEnd(t,e.contentRangeEndOffset||t.childNodes.length)),i}fixRefOwnerId(e,t,i){if(e.$refOwnerId===i){e.$refOwnerId=t;for(let{childNodes:r}=e,s=r.length;s-- >0;)this.fixRefOwnerId(r[s],t,i)}}get placement(){const e=this,{element:t}=e;let i,r,s;if(t!=null&&t.offsetParent&&!jc.test(v.getStyleValue(t,"position"))){const l=t.nextElementSibling,o=t.previousElementSibling,a=!l&&o;if(r=v.getStyleValue(t.parentElement,"flex-direction"),r)r=r.startsWith("row")?"h":"v";else{var n;i=(n=l||o)===null||n===void 0?void 0:n.getBoundingClientRect(),s=i&&t.getBoundingClientRect(),r=i&&Math.abs(i.top-s.top)<Math.abs(i.left-s.left)?"h":"v"}r+=r==="h"?a?"r":"l":a?"b":"t"}return r}updateId(e,t){if(super.updateId(e,t),t){const{byRef:i,element:r}=this;for(const s in i)i[s].dataset&&(i[s].dataset.ownerCmp=e);r.id=e,this.fixRefOwnerId(r,e,t)}}get style(){const{element:e}=this;return(e==null?void 0:e.ownerDocument.defaultView.getComputedStyle(e))||this._style}updateStyle(e){this.element&&v.applyStyle(this.element,e)}updateTitle(e){this.titleElement&&(this.titleElement.innerHTML=e)}beforeAlignTo(e){}alignTo(e){var t,i;const r=this,{lastAlignSpec:s,element:n}=r,{offsetParent:l,style:o,classList:a}=n;if(s&&(s.monitorIntersection&&r.intersectionObserver.unobserve(s.target),isFinite(s.zone)&&n.classList.remove(El[s.zone])),!e){r.removeTransientListeners(),r.anchor=r.lastAlignSpec=null;return}r.beforeAlignTo(e),(e.nodeType===Element.ELEMENT_NODE||e.isWidget||e.$$name==="Point")&&(e={target:e}),r.releaseSizeConstraints();const{scrollable:c,constrainTo:d}=r,f=v.measureSize(v.getStyleValue(n,"minHeight"),n),g=v.measureSize(v.getStyleValue(n,"minWidth"),n),h=r.positioned&&v.getStyleValue(n,"position")!=="fixed",p=r.scale||1,m=e.target,y=e.domEvent||e.event||m,b=m!=null&&m.isRectangle?m:(m==null?void 0:m.element)||m,C=V.from(n,h?l:null,!0),{width:E,height:S}=C,x=(b==null?void 0:b.nodeType)===Element.ELEMENT_NODE,L=(y==null||(t=y.target)===null||t===void 0?void 0:t.nodeType)===Element.ELEMENT_NODE;e=e.realignTarget?e:w.assign({aligningToEvent:L,aligningToElement:x,constrainTo:d,align:"b-t",axisLock:r.axisLock,anchor:r.anchor},r.align,e);const O=e.minWidth||g,P=e.minHeight||f;if(C.isAlignRectangle=!0,O&&(C.minWidth=O*p),P&&(C.minHeight=P*p),r.lastAlignSpec=e,L)delete e.target,e.domEvent=y,e.anchoredTo=y.target,e.position=new Ve(y.clientX+1,y.clientY+1);else if(x&&(e.target=b,it(b instanceof SVGElement?b.closest("svg"):b))){if(e=Object.setPrototypeOf({},e),e.target=r.lastAlignSpec.targetRect=e.realignTarget||(e.allowTargetOut?V.from(b,h?l:null,!h):v.isInView(b,!1,r)),!e.target){const A=r.hide();return r.isDestroyed||(r.lastAlignSpec.targetOutOfView=!0),A}e.target.height=Math.max(e.target.height,1),e.target.width=Math.max(e.target.width,1),r.lastAlignSpec.anchoredTo=b}e.anchor&&(e.anchorSize=r.anchorSize,n.contains(r.anchorPathElement)||n.appendChild(r.anchorElement)),r.isAligning=!0,r.trigger("beforeAlign",e),r.isAligning=!1,e.rtl=r.rtl,(e.align.includes("s")||e.align.includes("e"))&&(r.rtl?e.align=e.align.replace(/s/g,"r").replace(/e/g,"l"):e.align=e.align.replace(/s/g,"l").replace(/e/g,"r"));const I=r.lastAlignSpec.result=C.alignTo(e);let{align:G,anchor:K,x:H,y:J,width:_,height:U,overlap:re}=I;if(r.lastAlignSpec.zone=I.zone,U!=S){const A=U<S;r.alignmentChanges=r.alignmentChanges|(A?1:2),o[r.alignedHeightStyle=xl[r.alignmentChanges&3]]=`${U/p}px`,A&&!r._minHeight&&f&&(o.minHeight=`${Math.min(U,f)/p}px`),c&&(c.overflowY=A)}if(_!=E){const A=_<E;r.alignmentChanges=r.alignmentChanges|(A?4:8),o[r.alignedWidthStyle=xl[r.alignmentChanges&12]]=`${_/p}px`,A&&!r._minWidth&&g&&(o.minWidth=`${Math.min(_,g)/p}px`),c&&(c.overflowX=A)}if(G&&r.alignmentChanges){const A=V.from(n,h?l:null,!0);A.minWidth=I.minWidth,A.minHeight=I.minHeight,e.align=G;const q=r.lastAlignSpec.result=A.alignTo(e);K=q.anchor,H=q.x,J=q.y,_=q.width,U=q.height}if(r.centered||r.setXY(H,J),!I.overlap&&isFinite(I.zone)&&a.add(El[I.zone]),(i=K)!==null&&i!==void 0&&i.edge){var Y;const{edge:A}=K,{anchorElement:q}=r,{style:he}=q,$e=V.from(n),Be=[];A==="top"||A==="bottom"?(Be[0]=K.x,Be[1]=A==="top"?1:$e.height-1):(Be[0]=A==="left"?1:$e.width-1,Be[1]=K.y),he.display="none";let De=v.childFromPoint(n,...Be);if((Y=De)!==null&&Y!==void 0&&Y.matches(":hover,:focus")&&n.compareDocumentPosition(De)&Node.DOCUMENT_POSITION_CONTAINED_BY&&(De=De.parentNode),De&&De!==document){let pi=v.getStyleValue(De,"background-color");for(;pi.match(Yr)&&v.getStyleValue(De,"position")!=="absolute"&&(De=De.parentNode,De!==document);)pi=v.getStyleValue(De,"background-color");pi.match(Yr)?r.anchorPathElement.setAttribute("fill",r.defaultAnchorBackgroundColor):r.anchorPathElement.setAttribute("fill",pi)}he.transform=he.display="",q.className=`b-anchor b-anchor-${A}`,K.x&&(K.x/=p),K.y&&(K.y/=p),v.setTranslateXY(q,K.x,K.y),a.add("b-anchored")}else r._anchorElement&&(r.anchorElement.classList.add("b-hide-display"),a.remove("b-anchored"));if(!x){o.pointerEvents="none";const A=v.elementFromPoint(H,J);r.owns(A)||(r.lastAlignSpec.anchoredTo=A),o.pointerEvents=""}if((r.scrollAction==="realign"&&x||r.scrollAction==="hide")&&!r.documentScrollListener&&(r.clearTimeout(r.scrollListenerTimeout),e.monitorTargetMutation&&!r.targetObserver&&(r.targetObserver||(r.targetObserver=new MutationObserver(r.onTargetParentMutation.bind(r)))).observe(v.getRootElement(b),{childList:!0,attributes:!0,subtree:!0}),r.scrollListenerTimeout=r.setTimeout(()=>{var A,q;const he=(A=(q=x?b:r.lastAlignSpec.anchoredTo).getRootNode)===null||A===void 0?void 0:A.call(q);r.documentScrollListener=z.addListener(document,"scroll","doHideOrRealign",{capture:!0,thisObj:r}),he!=null&&he.mode&&(r.targetRootScrollListener=z.addListener(he,"scroll","doHideOrRealign",{capture:!0,thisObj:r}))},r.scrollAction==="hide"?r.ignoreScrollDuration:0)),x&&(e.monitorResize&&!r.targetResizeListener&&(ce.addResizeListener(b,r.onTargetResize),r.targetResizeListener=!0),e.monitorIntersection&&!(re||b.contains(n)||b.ownerSVGElement)&&r.intersectionObserver.observe(b)),!B.isAndroid&&!r.constrainListeners){const A=d!=null&&d.isRectangle?globalThis:d;r.clearTimeout(r.resizeListenerTimeout),r.resizeListenerTimeout=r.setTimeout(()=>{r.constrainListeners=!0,ce.addResizeListener(A||globalThis,r.onAlignConstraintChange)},r.ignoreScrollDuration)}}onTargetParentMutation(e){const{element:t,lastAlignSpec:i}=this;if(i!=null&&i.aligningToElement){var r;(r=i.target)!==null&&r!==void 0&&r.isConnected?e.some(({target:s})=>s.contains(i.target)&&!t.contains(s))&&this.realign():this.hide()}}get intersectionObserver(){return this._intersectionObserver||(this._intersectionObserver=new IntersectionObserver(this.onTargetIntersectionchange.bind(this),{root:B.isSafari?this.rootElement:this.rootElement.ownerDocument}))}onTargetIntersectionchange(e){if(!this.isDestroyed){const t=e[e.length-1];t.isIntersecting||this.onAlignTargetOutOfView(t.target)}}onTargetResize(){const{lastAlignSpec:e}=this;if(e){const{width:t,height:i}=e.targetRect,{width:r,height:s}=e.target.getBoundingClientRect();(r!==t||s!==i)&&this.onAlignConstraintChange(...arguments)}}onAlignTargetOutOfView(e){this.hide(),this.lastAlignSpec&&(this.lastAlignSpec.targetOutOfView=!0)}onAlignConstraintChange(e,t,{height:i}){const{style:r}=this.contentElement,{overflowY:s}=r;this.setTimeout(this.realign,50),t&&i>t.height&&(r.overflowY="hidden",this.requestAnimationFrame(()=>r.overflowY=s))}realign(){const e=this,{lastAlignSpec:t}=e;if((e.floating||e.positioned)&&t&&e.isVisible){if(t.aligningToElement){const i=t.target.contains(this.element),r=v.isInView(t.target,!1,e);if(!t.allowTargetOut&&(!it(t.target)||!r)){e.hide(),e.isDestroyed||(e.lastAlignSpec.targetOutOfView=!0);return}t.realignTarget=i?null:r}v.addTemporaryClass(e.element,"b-realigning",e.realignTimeout,e),e.alignTo(t)}}rectangle(e,t,i){return this.rectangleOf("element",e,t,i)}rectangleOf(e,t,i,r){var s;return typeof t!="string"?(r=i,i=t,t=""):t==="border"&&(t=""),typeof i=="boolean"&&(r=i,i=void 0),e!=="element"&&i===void 0&&(i=this.element),i=(s=i)!==null&&s!==void 0&&s.isWidget?i.element:i,V[t||"from"](this[e],i,r)}releaseSizeConstraints(){const e=this,{scrollable:t,element:i,alignmentChanges:r}=e,{style:s}=i;r&12&&(v.setLength(i,e.alignedWidthStyle,e[`_last${k.capitalize(e.alignedWidthStyle)}`]||""),s.minWidth=e._minWidth||"",t&&(t.overflowY=t.config.overflowY)),r&3&&(v.setLength(i,e.alignedHeightStyle,e[`_last${k.capitalize(e.alignedHeightStyle)}`]||""),s.minHeight=e._minHeight||"",t&&(t.overflowX=t.config.overflowX)),e.alignmentChanges=0}toFront(){const{element:e}=this,t=this.floating?this.floatRoot:this.positioned?e==null?void 0:e.parentNode:null,i=document.createDocumentFragment();if(this.containsFocus){for(let r=e.nextSibling,s;r;r=s)s=r.nextSibling,t.contains(r)&&!this.owns(r)&&i.appendChild(r);t.insertBefore(i,e)}else t.appendChild(e)}updateRef(e){this.element.dataset.ref=e}get overflowElement(){return this.contentElement}get maxHeightElement(){return this.element}changeAlign(e){return typeof e=="string"?{align:e}:e}changeScrollable(e,t){return typeof e=="boolean"&&(e={overflowX:e,overflowY:e}),e?(e.element=this.overflowElement,e.widget=this,e.isScroller||(e=t?t.setConfig(e):new this.scrollerClass(e)),e.syncOverflowState()):t==null||t.destroy(),e}handleReactElement(e){const t=this.closest(i=>i.reactComponent);t!=null&&t.reactComponent&&t.reactComponent.processWidgetContent({reactElement:e,widget:this,reactComponent:t.reactComponent})}get html(){return this.initializingElement||!this.element?this.content||this._html:this.contentElement.innerHTML}updateHtml(e){const t=this,i=e==null,{element:r,contentElement:s,htmlCls:n}=t;if(!r&&v.isReactElement(e)){t.whenVisible(()=>t.handleReactElement(e));return}if(r){t.updatingHtml=!0;const l=s===r&&t._anchorElement;n&&n.values.forEach(o=>r.classList[i?"remove":"add"](o)),l&&r.removeChild(l),e&&typeof e=="object"?v.isReactElement(e)?t.handleReactElement(e):X.sync({domConfig:{...e,onlyChildren:!0},targetElement:t.contentElement}):t.contentElement.innerHTML=i?"":e,t.getConfig("htmlMutationObserver"),l&&r.appendChild(l),t.isComposable?t.recompose():(t.floating||t.positioned)&&(t.isAligning||t.realign())}}changeHtmlMutationObserver(e,t){const i=this,{contentElement:r}=i;if(t==null||t.disconnect(),e){const s=new MutationObserver(()=>{i.updatingHtml?i.updatingHtml=!1:i._html=r.innerHTML});return s.observe(r,e),s}}updateContent(e){const t=this,i=e==null,{element:r,htmlCls:s}=t;if(r){const{contentRange:n}=t;s&&s.values.forEach(l=>r.classList[i?"remove":"add"](l)),r.isConnected?(n.deleteContents(),i||n.insertNode(v.createElementFromTemplate(e,{fragment:!0}))):t.contentElement.innerHTML=e,t.contentRangeStartOffset=n.startOffset,t.contentRangeEndOffset=n.endOffset,(t.floating||t.positioned)&&!t.isAligning&&t.realign()}}onThemeChange(){var e;(e=this.anchorElement)!==null&&e!==void 0&&e.offsetParent&&(this._anchorSize=null,this.realign())}get anchorSize(){const e=this;let t=this._anchorSize;if(!t){const i=parseFloat(v.getStyleValue(e.element,"border-top-width")),r=v.getStyleValue(e.element,"border-top-color"),s=e.anchorElement,{className:n}=s,l=s.firstElementChild,o=e.anchorPathElement=l.lastElementChild,a=e._hidden;s.className="b-anchor b-anchor-top";let c=v.getStyleValue(e.contentElement,"background-color");c.match(Yr)&&(c=v.getStyleValue(e.element,"background-color")),e.defaultAnchorBackgroundColor=c,t=s.getBoundingClientRect();const[d,f]=t=e._anchorSize=[t.width,t.height];s.className=n,l.setAttribute("height",f+i),l.setAttribute("width",d),o.setAttribute("d",`M0,${f}L${d/2},0.5L${d},${f}`),i&&(o.setAttribute("stroke-width",i),o.setAttribute("stroke",r)),t[1]-=i,a&&e.element.classList.add("b-hidden"),e.themeChangeListener||(e.themeChangeListener=ae.ion({theme:"onThemeChange",thisObj:e})),e.anchorPathElement.setAttribute("fill",e.defaultAnchorBackgroundColor)}return t}get anchorElement(){const e=this;if(!e._anchorElement){const t=e.floating,i=`${e.id}-shadow-filter`;e._anchorElement=v.createElement({parent:e.element,className:"b-anchor b-anchor-top",children:[{tag:"svg",ns:"http://www.w3.org/2000/svg",version:"1.1",class:"b-pointer-el",children:[t?{tag:"defs",children:[{tag:"filter",id:i,children:[{tag:"feDropShadow",dx:0,dy:-1,stdDeviation:1,"flood-opacity":.2}]}]}:null,{tag:"path",[t?"filter":""]:`url(#${i})`}]}]})}return e._anchorElement}updateAnchor(e){this._anchorElement&&this._anchorElement.classList[e?"remove":"add"]("b-hide-display")}updateDraggable(e){const t=this,{element:i}=t;if(e)t.dragEventDetacher=z.addListener({element:i,dragstart:"onWidgetDragStart",dragend:"onWidgetDragEnd",thisObj:t}),t.dragDetacher=z.on({element:i,mousedown(l){const{target:o}=l,a=M.fromElement(o);(!l.target.closest(".b-field-inner")&&a===this||this.strips&&Object.values(this.strips).includes(a))&&i.setAttribute("draggable","true")},thisObj:t});else{var r,s,n;(r=t.dragEventDetacher)===null||r===void 0||r.call(t),(s=t.dragOverEventDetacher)===null||s===void 0||s.call(t),(n=t.dragDetacher)===null||n===void 0||n.call(t)}}onWidgetDragStart(e){var t;const i=this;if(!i.validateDragStartEvent(e))return;const{element:r,align:s,constrainTo:n}=i,l=i.positioned&&v.getStyleValue(r,"position")!=="fixed",o=l?r.parentElement:i.rootElement,a=V.from(r,l?o:null),c=e.clientX,d=e.clientY,f=document.scrollingElement||document.body,[g,h]=l?v.getOffsetXY(r,o):i.getXY(),p=(t=l?V.content(o).moveTo(0,0):n&&(n!=null&&n.isRectangle?n:V.from(n)))===null||t===void 0?void 0:t.deflate(s.constrainPadding||0),m={element:o,dragover:y=>{r.classList.remove("b-centered"),a.moveTo(g+y.clientX-c-(l?0:f.scrollLeft),h+y.clientY-d-(l?0:f.scrollTop)),p&&a.constrainTo(p),v.setTranslateXY(r,a.x,a.y)}};B.isTouchDevice&&(m.touchmove=y=>y.preventDefault()),i.floatRoot.appendChild(i.dragGhost),i.setDragImage(e),e.dataTransfer.effectAllowed="none",i.dragOverEventDetacher=z.addListener(m),i.alignTo()}validateDragStartEvent(e){const t=this,{element:i}=t,r=v.elementFromPoint(e.clientX,e.clientY),{handleSelector:s}=t.draggable;if(s){var n;const l=(n=Bc.exec(s))===null||n===void 0?void 0:n[1];if(l){if(r.closest(`#${i.id} ${l}`))return e.preventDefault(),!1}else if(!r.closest(`#${i.id} ${s}`))return e.preventDefault(),!1}return!0}setDragImage(e){e.dataTransfer.setDragImage&&(e.dataTransfer.setData("application/node type",""),e.dataTransfer.setDragImage(this.dragGhost,-9999,-9999))}setStyle(e,t){return v.applyStyle(this.element,w.isObject(e)?e:{[e]:t}),this}onWidgetDragEnd(){this.dragGhost.remove(),this.dragOverEventDetacher(),this.element.removeAttribute("draggable")}changeFloating(e){return!!e}changePositioned(e){return!!e}updatePositioned(e){this.element.classList[e?"add":"remove"]("b-positioned")}getXY(){return[v.getPageX(this.element),v.getPageY(this.element)]}setXY(e,t){const i=this,{element:r}=i;if(i.floating||i.positioned){if(e!=null&&(i._x=e),t!=null&&(i._y=t),v.getStyleValue(r,"position")==="fixed"){const s=r.getBoundingClientRect(),[n,l]=v.getTranslateXY(r),o=e-s.x,a=t-s.y;v.setTranslateXY(r,n+o,l+a)}else v.setTranslateXY(r,i._x||0,i._y||0);i.isConstructing?i.centered=!1:r.classList.remove("b-centered")}}get x(){return this.getXY()[0]}changeX(e){this.setXY(e)}get y(){return this.getXY()[1]}changeY(e){this.setXY(null,e)}get width(){const e=this,t=e.element;return e.monitorResize?(e._width==null&&(e._width=t.offsetWidth),e._width):t.offsetWidth}changeWidth(e){const t=this;v.setLength(t.element,"width",e),t._lastWidth=e,t._width=null,t._flex=null,t.element.style.flex=""}clearWidthCache(){this._width=null}get maxWidth(){return v.measureSize(this.element.style.maxWidth,this.element)}updateMaxWidth(e){this._lastMaxWidth=e,v.setLength(this.element,"maxWidth",e)}get minWidth(){return v.measureSize(this.element.style.minWidth,this.element)}updateMinWidth(e){v.setLength(this.element,"minWidth",e)}updateFlex(e){this.getConfig("width"),(typeof e=="number"||!isNaN(e))&&(e=`${e} ${e}`),this.element.style.flex=e,this.element.style.width=""}updateAlignSelf(e){this.element.style.alignSelf=e}updateMargin(e){this.element.style.margin=this.parseTRBL(e).join(" ")}updateTextAlign(e,t){t&&this.element.classList.remove(`b-text-align-${t}`),this.element.classList.add(`b-text-align-${e}`)}updatePlaceholder(e){this.input&&(e==null?this.input.removeAttribute("placeholder"):this.input.placeholder=e)}get height(){const e=this,t=e.element;return e.monitorResize?(e._height==null&&(e._height=t.offsetHeight),e._height):t.offsetHeight}changeHeight(e){v.setLength(this.element,"height",e),this._lastHeight=e,this._height=null}get maxHeight(){return v.measureSize(this.maxHeightElement.style.maxHeight,this.element)}updateMaxHeight(e){this._lastMaxHeight=e,v.setLength(this.maxHeightElement,"maxHeight",e)}get minHeight(){return v.measureSize(this.element.style.minHeight,this.element)}updateMinHeight(e){v.setLength(this.element,"minHeight",e)}updateDisabled(e=!1){const{element:t,focusElement:i,ariaElement:r}=this;this.trigger("beforeUpdateDisabled",{disabled:e}),!(e&&(this.revertFocus(),this._disabled!==e))&&(t&&(t.classList[e?"add":"remove"]("b-disabled"),i&&(i.disabled=e),r&&r.setAttribute("aria-disabled",e)),this.onDisabled(e))}onDisabled(e){}disable(){this.disabled=!0}enable(){this.disabled=!1}requestFullscreen(){const e=this,t=_e.request(e.floating?e.floatRoot:e.element);return _e.onFullscreenChange(e.onFullscreenChange),e.element.classList.add("b-fullscreen"),t}exitFullscreen(){return _e.exit()}onFullscreenChange(){_e.isFullscreen||this.onExitFullscreen()}onExitFullscreen(){_e.unFullscreenChange(this.onFullscreenChange),this.element.classList.remove("b-fullscreen")}get tooltip(){const e=this;if(e._tooltip)return e._tooltip;{var t;const i=(t=M.Tooltip)===null||t===void 0?void 0:t.getSharedTooltip(e.rootElement,e.eventRoot);if(i&&i.activeTarget===e._element&&i.isVisible)return i}}changeTooltip(e,t){const i=this,{element:r}=i;if(e){if(!(i.preventTooltipOnTouch&&B.isTouchDevice)){if(!e.isTooltip&&e.constructor.name!=="Object"&&(e={html:typeof e=="string"?e:i.placeholder,textContent:!0}),!i.configureAriaDescription){var s;i.ariaDescription=(s=e.html)!==null&&s!==void 0&&s.match(Hi)?e.html.replace(Hi,Uc):e.html}if(t!=null&&t.isTooltip||e.newInstance)e.type="tooltip",e.forElement||(e.forElement=r),!("showOnHover"in e)&&!e.forSelector&&(e.showOnHover=!0),"autoClose"in e||(e.autoClose=!0),e=M.reconfigure(t,e,i),i.detachListeners("tooltipValueListener"),i.configureAriaDescription||e.ion({name:"tooltipValueListener",innerHtmlUpdate:"onTooltipValueChange",thisObj:i});else{r.dataset.btip=!0,i.tipConfig=e;return}}}else if(t)if(e==null&&t.isTooltip)t.destroy();else{t.html=null;return}else delete r.dataset.btip;return e}onTooltipValueChange({value:e,source:t}){this.ariaDescription=typeof e=="string"?e:t.contentElement.innerText}get tooltipText(){const e=this._tooltip;if(e)return e.isTooltip?e.contentElement.innerText:typeof e=="string"?e:e.html;if(this.tipConfig)return this.tipConfig.html}get isVisible(){const e=this,{element:t}=e;let i;return!!(t&&!e._hidden&&!e.isDestroying&&t.isConnected&&(!e.requireSize||it(t))&&(!(i=e.containingWidget)||i.isVisible))}whenVisible(e,t=this,i,r=e){const s=this;s.isVisible&&s.isPainted?s.callback(e,t,i):(s.toCallWhenVisible||(s.toCallWhenVisible=new Map)).set(r,{callback:e,thisObj:t,args:i})}focus(){this.isFocusable&&v.focusWithoutScrolling(this.focusElement)}get focusElement(){}get isFocusable(){const e=!this.isDestroying&&this.isVisible&&!this.disabled&&this.focusElement;return e&&(e===document.body||e.offsetParent)}async show({align:e,animate:t=!0}={}){const i=this,{element:r,floating:s}=i,{style:n}=r,l=t&&i.showAnimation;let o,a,c=!i.isVisible;return c&&(c=i.trigger("beforeShow"),w.isPromise(c)&&(c=await c)),c!==!1&&(!i.internalBeforeShow||i.internalBeforeShow()!==!1)?new Promise(d=>{if(i.cancelHideShowAnimation(),i.updateCentered(i._centered),s){const f=i.floatRoot;f.contains(r)||(i.rendered?f.appendChild(i.element):i.render(f,!1)),n.transform.includes("scale")&&(i.scale=null,n.transform=n.transformOrigin="");const g=i.closest(Hc);if(g){const{scale:h}=g;i.scale=h,n.transform=`scale(${h})`,n.transformOrigin="0 0"}}if(i._hidden=!1,r.classList.remove("b-hidden"),s&&!Tr(r)&&(i.hide(!1),d()),i.onConfigChange({name:"hidden",value:!1,was:!0,config:i.$meta.configs.hidden}),l){o=Object.keys(l)[0],a=l[o];const f=i.currentAnimation={showing:!0,styleProp:o,resolve:d};i.isAnimating=!0,n.transition="none",n[o]=a.from,v.getStyleValue(r,o),i.currentAnimation.detacher=z.onTransitionEnd({element:r,property:o,duration:Sl(a.duration)+20,handler:()=>i.afterHideShowAnimate(f),thisObj:i}),n.transition=`${o} ${a.duration} ease ${a.delay}`,n[o]=a.to}i.afterShow(e,l?null:d)}):Promise.resolve()}async showBy(e,t,i){const r=this,s=Array.isArray(e);if(s||typeof e=="number"){const n=s?e:[e,t];e=Object.assign({target:new Ve(n[0]+1,n[1]+1),matchSize:!1,align:"t0-b0"},s?t:i)}if(r.requireSize=!0,r.isVisible)v.addTemporaryClass(r.element,"b-realigning",300,r),r.alignTo(e);else return r.show({align:e})}async showByPoint(){return ne.deprecate("Core","6.0.0","Widget.showByPoint() replaced by Widget.showBy() with the same signature"),this.showBy(...arguments)}afterShow(e,t){var i,r;const s=this;s.trigger("show"),s._configuredAnchorState=s.anchor,(i=s.owner)===null||i===void 0||(r=i.onChildShow)===null||r===void 0||r.call(i,s),s.triggerPaint(),(s.floating||s.positioned)&&(e?s.alignTo(e):s.centered?s.alignTo({target:s.constrainTo,align:"c-c"}):s.forElement&&s.alignTo(s.forElement)),t==null||t()}onChildHide(e){e.floating&&this.ariaElement.removeAttribute("aria-owns")}onChildShow(e){e.floating&&(this.ariaHasPopup=e.role,this.ariaElement.setAttribute("aria-owns",e.id))}triggerPaint(){const e=this,{element:t,toCallWhenVisible:i}=e,r=!e.isPainted;if(e.isVisible){if(r&&(e.getConfig("scrollable"),e.scaleToFitWidth&&!e.monitorResize&&(e.onParentElementResize=e.onParentElementResize.bind(e),ce.addResizeListener(t.parentElement,e.onParentElementResize),e.updateScale()),!e.hideBryntumDomMessage&&(e.isTaskBoardBase||e.isGridBase||e.isCalendar)&&t.insertBefore(new Comment("POWERED BY BRYNTUM (https://bryntum.com)"),t.firstChild),e.onConnectedCallback&&globalThis.ResizeObserver&&(e.connectedObserver=new ResizeObserver(()=>{e.isElementConnected&&!t.isConnected?(e.onConnectedCallback(!1),e.isElementConnected=!1):!e.isElementConnected&&t.isConnected&&(e.onConnectedCallback(!0,e.isElementConnected==null),e.isElementConnected=!0)}),e.connectedObserver.observe(t))),e.eachWidget(zc,!1),r&&(e.getConfig("tooltip"),!M.Ripple&&M.RippleClass&&(M.Ripple=new M.RippleClass({rootElement:e.rootElement})),globalThis.DocsBrowser&&e.floating&&e.closest(s=>{var n;return(n=s.element)===null||n===void 0?void 0:n.closest(".fiddlePanelResult,.b-owned-by-fiddle")})&&t.classList.add("b-owned-by-fiddle")),e.isPainted=!0,r&&e.triggerConfigs("paint"),e.trigger("paint",{firstPaint:r}),i!=null&&i.size){for(const{callback:s,thisObj:n,args:l}of i.values())e.callback(s,n,l);i.clear()}r&&e.monitorResize&&!e.scaleToFitWidth&&ce.onElementResize([{target:t}])}}cancelHideShowAnimation(){const e=this,{currentAnimation:t,element:i}=e;t&&(e.isAnimating=!1,i.classList.contains("b-hiding")&&(i.classList.remove("b-hiding"),e._hidden=!1),t.detacher(),t.resolve(),i.style.transition=i.style[t.styleProp]="",e.currentAnimation=null,e.trigger(`${t.showing?"show":"hide"}AnimationEnd`))}afterHideShowAnimate(e){const t=this;e===t.currentAnimation&&(t.element.classList.remove("b-hiding"),t.cancelHideShowAnimation(),t._hidden&&t.afterHideAnimation())}suspendVisibility(){this._visibilitySuspended=(this._visibilitySuspended||0)+1,Object.defineProperty(this,"isVisible",Wc)}resumeVisibility(e=!0){--this._visibilitySuspended||(delete this.isVisible,e&&this.triggerPaint())}hide(e=!0){return new Promise(t=>{const i=this,{element:r,lastAlignSpec:s}=i,{style:n}=r,l=e&&i.hideAnimation;if(i.clearTimeout(i.scrollListenerTimeout),i.clearTimeout(i.resizeListenerTimeout),!i._hidden&&i.trigger("beforeHide",{animate:e})!==!1){if(i._hidden=!0,s&&(s.targetOutOfView=null,s.monitorIntersection&&(i.intersectionObserver.takeRecords(),i.intersectionObserver.unobserve(s.target))),i.onConfigChange({name:"hidden",value:!0,was:!1,config:i.$meta.configs.hidden}),!r){t();return}if(r.contains(v.getActiveElement(r))&&i.revertFocus(!0),i.isDestroyed){t();return}if(i.cancelHideShowAnimation(),l){const o=Object.keys(l)[0],a=l[o];if(Number(getComputedStyle(i.element)[o])!==a.to){const c=i.currentAnimation={hiding:!0,styleProp:o,resolve:t};r.classList.add("b-hiding"),i.isAnimating=!0,i.currentAnimation.detacher=z.onTransitionEnd({element:r,property:o,duration:Sl(a.duration)+20,handler:()=>i.afterHideShowAnimate(c),thisObj:i}),n[o]=a.from,v.getStyleValue(r,o),n.transition=`${o} ${a.duration} ease ${a.delay}`,n[o]=a.to}else r.classList.add("b-hidden")}else r.classList.add("b-hidden");i.afterHide(!l&&t,l)}})}doHideOrRealign({target:e,isTrusted:t}){const i=this,{lastAlignSpec:r,element:s}=i,n=r==null?void 0:r.anchoredTo,l=r==null?void 0:r.target,o=r==null?void 0:r.position,a=v.getActiveElement(i);if(!t||!it(s)||e&&(s.contains(e)||e.nodeType===Element.ELEMENT_NODE&&i.owns(e)||e.nodeType===Element.DOCUMENT_NODE&&s.contains(a)&&Vc[a]&&globalThis.innerHeight<document.body.offsetHeight))return;if(r.aligningToElement){const d=v.isInView(l,!1,i);if(d&&d.equals(r.targetRect))return}const c=i.scrollAction==="hide"&&i.getXY();if(i.realign(),!i.isDestroyed&&Tr(s)&&i.scrollAction==="hide"){const[d,f]=i.getXY(),g=d!==c[0]||f!==c[1];(r!=null&&r.aligningToEvent||(g||(l==null?void 0:l.$$name)==="Point"||o)&&(!n||!it(n)||e&&v.isDescendant(e,n)))&&i.hide()}}afterHide(e=null,t=this.hideAnimation){var i,r;const s=this;s._anchor=s._configuredAnchorState,s.removeTransientListeners(),t||s.afterHideAnimation(),s.trigger("hide"),(i=s.owner)===null||i===void 0||(r=i.onChildHide)===null||r===void 0||r.call(i,s),e&&e()}removeTransientListeners(){var e,t;const i=this,{targetObserver:r,lastAlignSpec:s}=i;if(i.clearTimeout(i.resizeListenerTimeout),i.clearTimeout(i.scrollListenerTimeout),r&&(r.disconnect(),delete i.targetObserver),i.documentScrollListener=(e=i.documentScrollListener)===null||e===void 0?void 0:e.call(i),i.targetRootScrollListener=(t=i.targetRootScrollListener)===null||t===void 0?void 0:t.call(i),i.targetResizeListener&&(ce.removeResizeListener(s.target,i.onTargetResize),i.targetResizeListener=!1),i.constrainListeners){var n;const l=(n=s.constrainTo)!==null&&n!==void 0&&n.isRectangle?globalThis:s.constrainTo;ce.removeResizeListener(l||globalThis,i.onAlignConstraintChange),i.constrainListeners=!1}}afterHideAnimation(){const e=this,{element:t}=e;e.floating&&e.floatRoot.contains(t)?t.remove():t.classList.add("b-hidden"),e.defaultAnchorBackgroundColor&&e.anchorPathElement.setAttribute("fill",e.defaultAnchorBackgroundColor)}changeHidden(e){const t=this;let i;return t.isConfiguring?(i=!!e,t.element.classList[e?"add":"remove"]("b-hidden")):(t.trigger("beforeChangeHidden",{hidden:e}),e?t.hide():t.show()),i}get assignedId(){return this.hasGeneratedId?null:this.id}get owner(){return this.parent||this._owner||this.containingWidget}get containingWidget(){let e=this.parent;if(!e){var t,i;const r=((t=this.forElement)===null||t===void 0?void 0:t.nodeType)===Element.ELEMENT_NODE?this.forElement:(i=this.element)===null||i===void 0?void 0:i.parentNode;e=(r==null?void 0:r.closest(".b-widget"))&&M.fromElement(r)}return e}get previousSibling(){return this.getSibling(-1)}get nextSibling(){return this.getSibling(1)}getSibling(e){const t=this,{parent:i}=t,r=i?i.childItems:Array.from(t.element.parentElement.querySelectorAll(".b-widget"));return i?r[r.indexOf(t)+e]:M.fromElement(r[r.indexOf(t.element)+e])}up(e,t,i){var r;const{owner:s}=this;return e?s==null||(r=s.closest)===null||r===void 0?void 0:r.call(s,e,t,i):s}closest(e,t,i){const r=typeof i,s=r==="number",n=r==="string";for(let l=this,o=1;l;l=l.owner,o++){if(M.widgetMatches(l,e,t))return l;if(s&&o>=i)return;if(n&&M.widgetMatches(l,i,t))return;if(l===i)return}}owns(e){if(e){if("eventPhase"in e&&(e=e.target),e.nodeType===Element.ELEMENT_NODE){if(this.element.contains(e))return!0;e=M.fromElement(e)}for(;e;){if(e===this)return!0;e=e.owner}}return!1}eachAncestor(e){let t=this.owner;for(;t;){if(e(t)===!1)return!1;t=t.owner}return!0}changeMaximizeOnMobile(e){const t=this;if(t.floating&&B.isMobile){const{initialConfig:i}=t;e?(t.centered=t.modal=!1,t.maximized=!0):(t.centered=i.modal,t.modal=i.centered,t.maximized=i.maximized)}}changeMonitorResize(e,t){const i=this.scaleToFitWidth?!1:!!e;if(i!==!!t)return i}updateMonitorResize(e){const t=this;mt(t,"onElementResize")||(t.onElementResize=t.onElementResize.bind(t)),ce[e?"addResizeListener":"removeResizeListener"](t.element,t.onElementResize)}changeReadOnly(e){if(e=!!e,!!this._readOnly!==e)return e}updateReadOnly(e){var t;(t=this.element)===null||t===void 0||t.classList[e?"add":"remove"]("b-readonly"),this.isConfiguring||(this.eachWidget(i=>{i.ignoreParentReadOnly||("_originalReadOnly"in i||(i._originalReadOnly=i.config.readOnly||!1),i.readOnly=e||i._originalReadOnly)},!1),this.trigger("readOnly",{readOnly:e}))}eachWidget(e,t=!0){const i=this.childItems,r=(i==null?void 0:i.length)||0,s={};for(let n=0;n<r;n++){const l=i[n];if(s.down=t,e(l,s)===!1||s.down&&l.eachWidget&&l.eachWidget(e,t)===!1)return!1}return!0}queryAll(e){const t=[];return this.eachWidget(i=>{e(i)&&t.push(i)}),t}query(e){let t=null;return this.eachWidget(i=>{if(e(i))return t=i,!1}),t}getWidgetByRef(e){var t,i;return e instanceof M?e:(this===null||this===void 0||(t=this.widgetMap)===null||t===void 0?void 0:t[e])||(this===null||this===void 0||(i=this.owner)===null||i===void 0?void 0:i.getWidgetByRef(e))}onFocusIn(e){const t=this,{element:i}=t;t.containsFocus=!0,t.focusInEvent=e,(t.floating||t.positioned)&&t.toFront(),i.classList.add("b-contains-focus"),t.updateAriaLabel(t.localizeProperty("ariaLabel")),t.updateAriaDescription(t.localizeProperty("ariaDescription")),i.contains(e._target)&&t.onInternalKeyDown&&!t.keyDownListenerRemover&&(t.keyDownListenerRemover=z.on({element:i,keydown:"onInternalKeyDown",thisObj:t})),t.trigger("focusin",e)}onFocusOut(e){const t=this;t.keyDownListenerRemover&&(t.keyDownListenerRemover(),t.keyDownListenerRemover=null),t.isDestroyed||(e.relatedTarget||t.revertFocus(!t.isVisible),t.containsFocus=!1,t.element.classList.remove("b-contains-focus"),t.updateAriaLabel(t.localizeProperty("ariaLabel")),t.updateAriaDescription(t.localizeProperty("ariaDescription")),t.trigger("focusout",e))}captureFocus(){const e=this,t=v.getActiveElement(e),i=e.contains(t)&&e.captureFocusItem(t);return(r,s)=>{i&&!e.isDestroying&&(v.getActiveElement(e)!==t||s)&&i(r)}}captureFocusItem(e){return(t=!0)=>{this.contains(e)&&(t?e.focus():v.focusWithoutScrolling(e))}}contains(e,t){const{element:i}=this;if(e&&i)return e.isWidget&&(e=e.element),i.contains(e)&&(!t||i!==e)}revertFocus(e){var t,i;const r=this,s=v.getActiveElement(r);let n=(t=r.focusInEvent)===null||t===void 0?void 0:t.relatedTarget;(e||r.containsFocus&&((i=n)===null||i===void 0?void 0:i.nodeType)===Element.ELEMENT_NODE&&r.element.contains(s))&&((!n||!v.isFocusable(n))&&(n=r.getFocusRevertTarget()),r._isRevertingFocus=!0,n&&v.isFocusable(n)?(n._isRevertingFocus=!0,v.focusWithoutScrolling(n),n._isRevertingFocus=!1):s==null||s.blur(),r._isRevertingFocus=!1)}getFocusRevertTarget(){const e=this,{owner:t,focusInEvent:i}=e,r=i&&i.backwards?1:-1;let s=i&&i.relatedTarget;const n=s&&M.fromElement(s);if(t&&!t.isDestroyed&&(!s||!v.isFocusable(s)||n&&!n.isFocusable)){var l;if(s=null,t.eachWidget){const o=[];if(t.eachWidget(a=>{(a===e||a.isFocusable)&&o.push(a)},!1),o.length>1){const a=o.indexOf(e);s=o[a+r]||o[a-r]}}!s&&t.isFocusable&&(s=t),s=s?s.focusElement:(l=t.getFocusRevertTarget)===null||l===void 0?void 0:l.call(t)}return s}getStaticWidgetClasses(e,t){const i=new W,r=this.$meta.hierarchy;let s,n,l,o,a;for(n=r.indexOf(e);n<r.length;++n){var c;s=r[n],a=Reflect.getOwnPropertyDescriptor(s.prototype,"widgetClass"),(c=a)!==null&&c!==void 0&&c.get?o=a.get.call(this):(l=mt(s,"$$name")||mt(s,"$name")||mt(s,"_$name")?s.$$name:s.name,(l.length<3||l.includes("$"))&&console.warn(`Class "${l}" extending "${s.$name}" should have "$name" static getter with no less than 3 chars.`),o=`b-${l.toLowerCase()}`),o&&i.add(t?o+t:o)}return i}get rootUiClass(){return M}get staticClassList(){const{$meta:e}=this;let t=e.staticClassList;return t||(e.staticClassList=t=this.getStaticWidgetClasses(M),B.isTouchDevice&&t.add("b-touch")),t}get uiClasses(){return this.getConfig("ui"),this._uiClasses}get uiClassList(){return this.getConfig("ui"),this._uiClassList}get widgetClassList(){const e=this,{cls:t,defaultCls:i,uiClasses:r}=e;let{staticClassList:s}=e;(i||t)&&(s=s.clone(),i&&s.assign(i),t&&s.assign(t));const n=s.values;return r&&n.push(...r),e.floating&&n.push("b-floating"),e.collapsify==="hide"&&n.push("b-collapsify-hide"),n}changeCls(e){return W.from(e)}updateCls(e,t){if(!this.isConfiguring&&!this.isComposable){const{element:i}=this;t&&w.getTruthyKeys(t).forEach(r=>i.classList.remove(r)),e.assignTo(i)}}changeContentElementCls(e){return W.from(e)}changeHtmlCls(e){return W.from(e)}changeDefaultCls(e){return W.from(e,!0)}changeUi(e){return W.from(e)}updateUi(e){var t;let i=null,r,s;if(e){const n=this.getStaticWidgetClasses(this.rootUiClass);for(s in e)if(e[s])for(r in n)n[r]&&((i||(i=new W))[`${r}-ui-${s}`]=1)}this._uiClasses=(t=i)===null||t===void 0?void 0:t.values,this._uiClassList=i}fromCache(e,t=!1,i=this.element){if(!i)return null;const r=this;return r.cache[e]||(r.cache[e]=t?v.children(i,e):v.down(i,e)),r.cache[e]}emptyCache(){this.cache={}}changeMasked(e,t){var i;if(((i=this.masked)===null||i===void 0?void 0:i.type)!=="trial"){if((e===!0||e==="")&&(e="\xA0"),t&&!t.isDestroyed)typeof e=="string"?(t.text=e,e=t):e?(t.setConfig(e),e=t):t.destroy();else if(e){const r=M.resolveType("mask");e=r.mergeConfigs(this.maskDefaults,e),e.owner=this,e=r.mask(e)}return e||null}}onMaskAutoClose(e){e.isDestroyed&&e===this.masked&&(this.masked=null)}mask(e){return this.masked=e,this.masked}unmask(){this.masked=null}onInternalResize(e,t,i,r,s){this._width=e.offsetWidth,this._height=e.offsetHeight}onElementResize(e,t){const i=this,{element:r}=i,s=i._width,n=i._height,l=r.offsetWidth,o=r.offsetHeight;i.floating&&t&&i.onFloatingWidgetResize(...arguments),!i.suspendResizeMonitor&&(s!==l||n!==o)&&(i.onInternalResize(r,l,o,s,n),i.trigger("resize",{width:l,height:o,oldWidth:s,oldHeight:n}))}onFloatingWidgetResize(e,t,i){const r=this,{lastAlignSpec:s,constrainTo:n}=r;if(r.isVisible&&s&&s.target){const l=!t||i.height!==t.height,o=!t||i.width!==t.width,a=n&&!V.from(n).contains(V.from(r.element,null,!0));(l&&s.zone!==2||o&&s.zone!==1||a)&&r.requestAnimationFrame(()=>r.realign())}}updateScale(){const e=this,t=e.element,i=t.parentElement;e.configuredWidth||(e.configuredWidth=e.width),t.style.display="none";const r=V.client(i),s=r.width/e.configuredWidth,n=e.scale=e.allowGrowWidth?Math.min(s,1):s;t.style.transform=`scale(${n})`,t.style.transformOrigin="top left",t.style.display="",e.allowGrowWidth&&s>1&&(e.width=e.configuredWidth*s)}onParentElementResize(e){this.updateScale()}parseTRBL(e,t="px"){if(e=e||0,typeof e=="number")return[`${e}${t}`,`${e}${t}`,`${e}${t}`,`${e}${t}`];const i=e.split(" "),r=i.length;return r===1?i[1]=i[2]=i[3]=i[0]:r===2?(i[2]=i[0],i[3]=i[1]):r===3&&(i[3]=i[1]),[isFinite(i[0])?`${i[0]}${t}`:i[0],isFinite(i[1])?`${i[1]}${t}`:i[2],isFinite(i[2])?`${i[2]}${t}`:i[3],isFinite(i[3])?`${i[3]}${t}`:i[4]]}get documentRoot(){var e;return((e=this.owner)===null||e===void 0?void 0:e.documentRoot)||this.element.getRootNode()}get eventRoot(){var e,t;return(e=this.element)!==null&&e!==void 0&&e.isConnected?v.getRootElement(this.element):((t=this.owner)===null||t===void 0?void 0:t.eventRoot)||this._rootElement}get rootElement(){const e=this;if(!e._rootElement){var t,i;let r=((t=e.owner)===null||t===void 0?void 0:t.rootElement)||v.getRootElement(e.forElement||((i=e.element)!==null&&i!==void 0&&i.isConnected?e.element:e.getRenderContext()[0]||e.element));r||(r=document.body),e._rootElement=r}return e._rootElement}get floatRoot(){const e=this,{rootElement:t}=e;let{floatRoot:i}=t;if(i)t.contains(i)||t.appendChild(i);else{var r;const{outerCls:s}=M,n=(r=v.getThemeInfo(null,t))===null||r===void 0?void 0:r.name;if(!v.isValidFloatRootParent(t))throw new Error("Attaching float root to wrong root");n&&s.push(`b-theme-${n.toLowerCase()}`),i=t.floatRoot=v.createElement({className:`b-float-root ${s.join(" ")}`,parent:t}),si.push(i),B.isAndroid&&(i.style.height=`${screen.height}px`,z.on({element:globalThis,orientationchange:()=>i.style.height=`${screen.height}px`,thisObj:this})),ae.ion({theme:({theme:l,prev:o})=>{i.classList.add(`b-theme-${l.toLowerCase()}`),i.classList.remove(`b-theme-${o.toLowerCase()}`)}})}return i}get floatRootMaxZIndex(){let e=1;return Array.from(this.floatRoot.children).forEach(t=>{const i=parseInt(getComputedStyle(t).zIndex||0,10);i>e&&(e=i)}),e}static resetFloatRootScroll(){si.forEach(e=>e.scrollTop=e.scrollLeft=0)}static get floatRoots(){return si}static removeFloatRoot(e){si.splice(si.indexOf(e),1)}static get outerCls(){const e=["b-outer"],{platform:t}=B;return t&&e.push(`b-${t}`),B.isTouchDevice&&e.push("b-touch-events"),B.isMobile&&e.push("b-mobile"),v.scrollBarWidth?e.push("b-visible-scrollbar"):e.push("b-overlay-scrollbar"),B.isChrome?e.push("b-chrome"):B.isSafari?e.push("b-safari"):B.isFirefox&&e.push("b-firefox"),B.isPhone&&e.push("b-phone"),globalThis.ResizeObserver||e.push("b-no-resizeobserver"),e}get isAnimating(){return this._isAnimatingCounter>0}set isAnimating(e){const t=this,{_isAnimatingCounter:i}=t;t._isAnimatingCounter=Math.max(0,i+(e?1:-1)),i===0&&e?(t.element.classList.add("b-animating"),t.trigger("animationStart")):i===1&&!e&&(t.element.classList.remove("b-animating"),t.trigger("animationEnd"))}async waitForAnimations(){this.isAnimating&&await this.await("animationend",{checkLog:!1})}static query(e,t=!1){const{idMap:i}=M.identifiable;for(const r in i)if(M.widgetMatches(i[r],e,t))return i[r];return null}static queryAll(e,t=!1){const{idMap:i}=M.identifiable,r=[];for(const s in i)M.widgetMatches(i[s],e,t)&&r.push(i[s]);return r}static fromElement(e,t,i){const r=typeof t;e&&!e.nodeType&&(e=e.target),(r==="number"||t&&t.nodeType===Element.ELEMENT_NODE)&&(i=t,t=null);let s=e,n=0,l,o,a;for(typeof i!="number"&&(l=i,i=Number.MAX_VALUE),r==="string"&&(t=t.toLowerCase());s&&s.nodeType===Element.ELEMENT_NODE&&n<i&&s!==l;){if(o=s.dataset&&s.dataset.ownerCmp||s.id,o){if(a=M.getById(o),a)if(t){if(r==="function"){if(t(a))return a}else if(M.widgetMatches(a,t,!0))return a}else return a;n++}s=s.parentNode}return null}static fromSelector(e){const t=document.querySelector(e);return t?M.fromElement(t):null}triggerFieldChange(e,t=!0){var i;t&&this.trigger("change",e),(i=this.eachAncestor)===null||i===void 0||i.call(this,r=>{var s,n;if((s=r.onFieldChange)===null||s===void 0||s.call(r,e),(n=r.isolateFieldChange)!==null&&n!==void 0&&n.call(r,this))return!1})}isolateFieldChange(e){return this.isolateFields}setupFocusListeners(){ae.setupFocusListenersOnce(this.eventRoot,z)}static widgetMatches(e,t,i){return t==="*"?!0:typeof t=="function"?t(e):M.isType(e,t,i)}static attachTooltip(e,t){return typeof t=="string"&&(t={html:t}),M.create(Object.assign({forElement:e},t),"tooltip"),e}changeDock(e){return e==="start"?"left":e==="end"?"right":e}updateRtl(e){super.updateRtl(e),this.eachWidget(t=>{"rtl"in t.initialConfig||(t.rtl=e)})}}const Yc=M.prototype;["compose","domSyncCallback"].forEach(u=>Yc[u].$nullFn=!0),M.initClass(),M.register("mask",xe),v.Widget=M,ae.Widget=M,xe.identifiable.idMap=M.identifiable.idMap,Object.assign(globalThis.bryntum||(globalThis.bryntum={}),{get:M.getById.bind(M),query:M.query,queryAll:M.queryAll,fromElement:M.fromElement,fromSelector:M.fromSelector}),M._$name="Widget";class qe extends $.mixin(Oe,Mt){get contentElement(){var e;return(e=this.owner)===null||e===void 0?void 0:e.contentElement}onChildAdd(e){}onChildRemove(e){}renderChildren(){const e=this,{owner:t,itemCls:i}=e,{contentElement:r,items:s}=t,n=t.itemCls,l=s==null?void 0:s.length;if(l){t.textContent=!1;for(let o=0;o<l;o++){const a=s[o],{element:c}=a,{classList:d}=c;c.dataset.itemIndex=o,d.contains("b-outer")&&d.remove(...M.outerCls),i&&d.add(i),n&&d.add(n),a.render(r,!!t.isPainted)}}e.syncPendingConfigs(),e.syncChildCount()}removeChild(e){const t=this,{element:i}=e,{owner:r,itemCls:s}=t,{contentElement:n}=r,l=r.itemCls;n.contains(i)&&i.remove(),delete i.dataset.itemIndex,s&&i.classList.remove(s),l&&i.classList.remove(l),t.fixChildIndices(),t.syncChildCount()}appendChild(e){const{element:t}=e,{owner:i,itemCls:r}=this,{contentElement:s}=i,n=i.itemCls;t.dataset.itemIndex=i.indexOfChild(e),i.textContent=!1,r&&t.classList.add(r),n&&t.classList.add(n),e.render(s,!!i.isPainted),this.syncChildCount()}insertChild(e,t){const i=this,{element:r}=e,{owner:s,itemCls:n}=i,{contentElement:l}=s,o=v.getChild(l,`[data-item-index="${t}"]`),a=s.itemCls;s.textContent=!1,n&&r.classList.add(n),a&&r.classList.add(a),l.insertBefore(r,o),e.render(null,!!s.isPainted),i.fixChildIndices(),i.syncChildCount()}fixChildIndices(){this.owner.items.forEach((e,t)=>{e.element.dataset.itemIndex=t})}syncChildCount(){var e;const{owner:t}=this,{length:i}=t.items;(e=t.contentElement)===null||e===void 0||e.classList[i===1?"add":"remove"]("b-single-child")}syncConfigLater(e){const t=this.pendingConfigs||(this.pendingConfigs=[]);t.includes(e)||t.push(e)}syncConfigStyle({name:e,style:t,classes:i,map:r}){const s=this,n=`b-box-${e}-`,{contentElement:l}=s,o=s[e];let a=(r==null?void 0:r[o])||o;if(l){if(i){const{classList:c}=l;i.forEach(d=>{d!==a&&c.remove(n+d)}),i.includes(a)&&(c.add(n+a),a="")}l.style[t]=a}else s.syncConfigLater(e)}syncPendingConfigs(){const e=this,{pendingConfigs:t}=e;let i;if(t)for(e.pendingConfigs=null;i=t.pop();)e[e.$meta.configs[i].updater](e[i])}}R(qe,"type","default"),R(qe,"configurable",{owner:null,containerCls:"b-auto-container",itemCls:null}),R(qe,"factoryable",{defaultType:"default"}),qe.initClass(),qe._$name="Layout";let Dl=0;const Gc=u=>u.ripple;class Xr extends M{static get defaultConfig(){return{old_element:{children:[{className:"b-ripple-inner",reference:"rippleElement"}]},element:{children:[{tag:"svg",class:"b-ripple-inner",reference:"rippleElement",ns:"http://www.w3.org/2000/svg",version:"1.1",viewBox:"0 0 100 100",children:[{reference:"circleElement",tag:"circle",cx:"0",cy:"0",r:10}]}]},floating:!0,hideAnimation:!1,showAnimation:!1,scrollAction:"realign",color:"rgba(0,0,0,.3)",startRadius:10,radius:100}}static get $name(){return"Ripple"}afterConstruct(){super.afterConstruct(),z.on({element:this.rootElement,mousedown:"onRippleControllingEvent",thisObj:this,capture:!0,once:!0})}onRippleControllingEvent(e){var t;const i=this;i.show();const r=v.getStyleValue(i.circleElement,"animationName");i.hide(),(t=i.listenerDetacher)===null||t===void 0||t.call(i),r&&r!=="none"&&(i.listenerDetacher=z.on({mousedown:{element:i.rootElement,capture:!0,handler:"onMousedown"},touchstart:{element:i.rootElement,capture:!0,handler:"onTouchStart"},animationend:{element:i.circleElement,handler:"onAnimationEnd"},thisObj:i}),e.type==="mousedown"&&(i.onMousedown(e),ae.ion({theme:"onRippleControllingEvent",thisObj:this})))}onTouchStart(e){Dl=performance.now(),this.handleTriggerEvent(e)}onMousedown(e){performance.now()-Dl>200&&this.handleTriggerEvent(e)}handleTriggerEvent(e){const t=M.fromElement(e.target,Gc);if(t){const i=t.ripple,r=i.delegate?e.target.closest(i.delegate):t.focusElement||t.element;if(r){const s=w.assign({event:e,target:r,radius:this.radius},i);if(typeof s.clip=="string"&&(s.clip=t[s.clip]||e.target.closest(s.clip),!s.clip))return;this.ripple(s)}}}ripple({event:e,point:t=z.getClientPoint(e),target:i=e.target,clip:r=i,radius:s=this.radius,color:n=this.color}){this.clip=r,r=V.from(r,null,!0);const l=this,o=r.getDelta(t),a=l.rippleElement.style,c=l.circleElement,d=v.getStyleValue(i,"border-radius");l.hide(),a.transform=`translateX(${o[0]}px) translateY(${o[1]}px)`,a.height=a.width=`${s}px`,l.element.style.borderRadius=d,c.setAttribute("r",s),c.setAttribute("fill",n),l.showBy({target:r,align:"c-c",matchSize:!0})}onAnimationEnd(e){e.animationName==="b-ripple-expand"&&this.hide()}}M.RippleClass=Xr,Xr._$name="Ripple";const Xc=Object.freeze({}),{isArray:Ot}=Array,Jc=u=>u.weight,Ml=({weight:u},{weight:e})=>typeof u=="string"||typeof e=="string"?String(u).localeCompare(String(e)):(u!=null?u:Number.MAX_SAFE_INTEGER)-(e!=null?e:Number.MAX_SAFE_INTEGER),Il=u=>u&&!u.hidden,Zc=["display","flex-direction"],Qc={default:1,box:1};class pt extends M{static get $name(){return"Container"}static get type(){return"container"}static get configurable(){return{items:null,lazyItems:{$config:["lazy"],value:null},defaults:null,defaultType:"widget",layoutStyle:null,itemCls:null,layout:{type:"default"},namedItems:null,overflowable:{value:null,default:!1,$config:null},textContent:!0,record:null,strictRecordMapping:null,autoUpdateRecord:null,autoUpdateFields:null,hideWhenEmpty:null,contentElMutationObserver:{$config:["lazy","nullify"],value:!0},isolateFields:!1,focusDescendant:!1,defaultBindProperty:null,defaultFocus:null}}static get prototypeProperties(){return{flexRowCls:"b-flex-row",flexColCls:"b-flex-column",initialItems:!0}}startConfigure(e){const t=e.items||e.lazyItems;(this.hasItems=!!(t&&(Ot(t)?t:Object.keys(t)).length))||(this.initialItems=!1),super.startConfigure(e)}get firstItem(){return this.getAt(0)}get lastItem(){return this.getAt(-1)}getAt(e){return this.ensureItems().at(e)}remove(...e){let t=!0;e.length===1&&(Ot(e[0])?e=e[0]:t=!1);const i=this,{_items:r}=i,s=[];for(let n=0;n<e.length;n++){const l=e[n];r.includes(l)&&(r.remove(l),i.layout.removeChild(l),s.push(l),i.onChildRemove(l))}return t?s:s[0]}removeAll(){return this.remove(this.items)}add(...e){const t=this,i=t.ensureItems(),r=[];let s=!0,n,l,o;for(e.length===1&&(Ot(e[0])?e=e[0]:s=!1),l=0;l<e.length;l++){var a;n=e[l],n.isWidget?n.parent=t:n=t.createWidget(n),((a=n)===null||a===void 0?void 0:a.weight)!=null?(o=j.findInsertionIndex(n,i.values,Ml),r.push(t.insert(n,o))):n&&(i.includes(n)||(i.add(n),t.onChildAdd(n),t.layout.appendChild(n),r.push(n)))}return s?r:r[0]}ensureItems(){const e=this;return e.getConfig("items"),e.getConfig("lazyItems"),e._items||(e.items=[]),e._items}insert(e,t){const i=this,r=i.ensureItems();e instanceof M?e.parent=i:e=i.createWidget(e),r.includes(t)&&(t=i.indexOfChild(t)),t=Math.min(t,r.count);const s=r.values;return s.splice(t,0,e),r.values=s,i.onChildAdd(e),i.layout.insertChild(e,t),e}indexOfChild(e){return this.items.indexOf(e)}changeLazyItems(e){this.items=e,this.layout.renderChildren()}changeItems(e,t){const i=this,r=[],s=new ti;return Ot(e)?i.processItemsArray(e,r):e&&i.processItemsObject(e,i.namedItems,r),r.some(Jc)&&r.sort(Ml),s.add(r),t&&t.forEach(n=>{i.remove(n),!s.includes(n)&&n._createdBy===i&&n.destroy()}),s}afterConstruct(){const{rtl:e}=this,{classList:t}=this.contentElement;t.toggle("b-rtl",e===!0),t.toggle("b-ltr",e===!1)}updateRtl(e){super.updateRtl(e);const{contentElement:t}=this;t&&(t.classList.toggle("b-rtl",e===!0),t.classList.toggle("b-ltr",e===!1))}updateItems(e,t){let i=0;e.forEach(r=>{this.onChildAdd(r),t&&!t.temporary&&this.layout.insertChild(r,i),++i}),this.initialItems=!1}updateHideWhenEmpty(){this.syncChildCount(this.rendered)}get items(){const e=this;if(e.getConfig("lazyItems"),!e._items){if(e.initializingItems)return[];e._items=new ti,e._items.temporary=!0}return e._items.values}processItemsArray(e,t){const i=e.length;let r,s;for(r=0;r<i;r++)s=e[r],s instanceof M?(s.parent=this,s.element.classList.remove(...M.outerCls)):s=this.createWidget(s),s&&((s.ref||s.id)&&this.addDescendant(s),t.push(s))}processItemsObject(e,t,i){let r,s;for(s in e)r=e[s],r&&(t&&s in t&&(r=typeof r=="object"?w.merge(w.clone(t[s]),r):t[s]),r&&(r instanceof M?r.parent=this:(r instanceof Object&&(r.ref=s),r=this.createWidget(r)),r&&(r.ref=s,this.addDescendant(r),i.push(r))))}onChildAdd(e){if(e.innerItem&&this.readOnly&&!e.ignoreParentReadOnly&&(e.readOnly=!0),this.onChildAddLayout(e),e.ref||e.id)for(let t=this;t;t=t.parent)t.addDescendant(e);this.syncChildCount(!0)}onChildAddLayout(e){e.innerItem&&this.layout.onChildAdd(e)}onChildHide(e){var t;super.onChildHide(e),(t=this._items)!==null&&t!==void 0&&t.includes(e)&&this.syncChildCount(!0)}onChildShow(e){var t;super.onChildShow(e),(t=this._items)!==null&&t!==void 0&&t.includes(e)&&this.syncChildCount(!0)}syncChildCount(e){if(!this.isConfiguring){const t=this,{items:i,hasItems:r}=t,s=i.filter(Il),{length:n}=s;if(t.visibleChildCount=n,t.hideWhenEmpty&&e){const l=!n;!!t._hidden!==l&&(t.hidden=l)}i.forEach(l=>l.element.classList.remove("b-last-visible-child","b-first-visible-child")),n&&(s[0].element.classList.add("b-first-visible-child"),s[n-1].element.classList.add("b-last-visible-child")),t.hasItems=!!t.childItems.length,t.contentElement.classList[n?"remove":"add"]("b-no-visible-children"),t.isComposable?r!==t.hasItems&&t.recompose():t.updateTextContent(t._textContent)}}syncFlexDirection(){const e=this,{contentElement:t,flexColCls:i,flexRowCls:r}=e,s=new W(t.className),n=v.getStyleValue(t,Zc);s[r]=s[i]=0,n.display==="flex"&&(s[n["flex-direction"]==="row"?r:i]=1),v.syncClassList(t,s)}addDescendant(e){const t=e.ref||e.id,i=this._widgetMap||(this._widgetMap={});i[t]||(i[t]=e)}onChildRemove(e){const t=this,i=e.ref||e.id;if(i)for(let r=t;r;r=r.parent)r.widgetMap[i]===e&&delete r.widgetMap[i];t.layout.onChildRemove(e),t.syncChildCount(!0)}get widgetMap(){return this._widgetMap||(this._widgetMap={}),this.initializingItems||this.getConfig("items"),this._widgetMap}changeRecord(e){return this._record=e==null?Xc:null,e}updateRecord(e){var t;const i=this;(t=i.recordUpdateDetacher)===null||t===void 0||t.call(i),i.trigger("beforeSetRecord",{record:e}),i.setValues(e,{onlyName:i.strictRecordMapping,highlight:!!i.$highlight}),i.autoUpdateFields&&e!==null&&e!==void 0&&e.firstStore&&(i.recordUpdateDetacher=e.firstStore.ion({update:i.onRecordUpdated,thisObj:i}))}setRecord(e,t){this.$highlight=t,this.record=e,this.$highlight=!1}onRecordUpdated({record:e}){e===this.record&&this.setValues(this.record,!0,!0)}onFieldChange({source:e,userAction:t}){if(this.autoUpdateRecord&&t){const{record:i,strictRecordMapping:r}=this,{name:s,ref:n,isValid:l=!0,value:o}=e,a=r?s:s||n;i&&a&&l&&(i.isModel?i.setValue(a,o):i[a]=o)}}getValues(e){const t={};return this.eachWidget((i,r)=>{i.isolateFields?r.down=!1:"name"in i&&(!e||e(i))&&(t[i.name]=i.value)},!0),t}get values(){const e={};return this.gatherValue(e),e}set values(e){this.assignValue(e)}get isSettingValues(){return!!this.assigningValues}get assigningValues(){var e;return this._assigningValues||((e=this.parent)===null||e===void 0?void 0:e.assigningValues)}set assigningValues(e){this._assigningValues=e}assignValue(e,t){super.assignValue(e,t),this.isolateFields||this.setValues(e,t)}gatherValue(e){super.gatherValue(e),this.isolateFields||this.gatherValues(e)}setValues(e,t=this.assignValueDefaults){this.assigningValues=t,this.eachWidget(i=>i.assignValue(e,t),!1),this.assigningValues=!1}get hasNoChildren(){const e=this,{items:t,lazyItems:i}=e.initialConfig,r=t&&(Ot(t)?t:w.values(t)),s=i&&(Ot(i)?i:w.values(i)),n=e.isConfiguring?s||r:e.items;return!(n!=null&&n.filter(Il).length)}afterRecompose(){super.afterRecompose(),this.realign()}updateTextContent(e){const t=this;if(!t.isComposable){const i=!!(e&&t.hasNoChildren),{classList:r}=t.contentElement;i!==r.contains("b-text-content")&&(r[i?"add":"remove"]("b-text-content"),t.rendered&&t.realign())}}updateLayoutStyle(e){v.applyStyle(this.contentElement,e)}updateElement(e){if(super.updateElement(...arguments),e){const{classList:t}=this.contentElement,{containerCls:i}=this.layout;t.add("b-content-element"),i&&t.add(i)}}onPaint(){var e;(e=super.onPaint)===null||e===void 0||e.call(this,...arguments),this.getConfig("contentElMutationObserver")}changeContentElMutationObserver(e,t){if(t&&(t.takeRecords(),t.disconnect()),e){const i=this,{element:r,contentElement:s}=i;e=new MutationObserver(n=>i.onContentElMutation(n)),e.observe(s,{attributes:!0}),s!==r&&e.observe(r,{attributes:!0}),i.syncFlexDirection()}return e}onContentElMutation(){Qc[this.layout.type]&&this.isVisible&&this.syncFlexDirection()}changeLayout(e,t){return qe.reconfigure(t,e,{owner:this,defaults:{owner:this}})}get childItems(){return this.items}getWidgetById(e){return this.widgetMap[e]}processWidgetConfig(e){}setupWidgetConfig(e,t){const i=this;typeof e=="string"?e={html:e}:e.nodeType===Element.ELEMENT_NODE&&(e={element:e,id:e.id}),(typeof t=="string"||!t&&(t=e.type))&&(t==="checkbox"&&B.isMobile&&M.resolveType("slidetoggle",!0)&&(t=e.type="slidetoggle"),t=M.resolveType(t,!0)),e=(t||M).mergeConfigs(i.defaults,e,{parent:i});for(let r=e.parent;r;r=r.parent)if(r.processWidgetConfig(e)===!1)return null;return i.trigger("beforeWidgetCreate",{widgetConfig:e})===!1?null:e}createWidget(e){const t=M.create(this.setupWidgetConfig(e),this.defaultType);return t&&(t._createdBy=this),t}updateDefaults(e,t){if(!this.isConfiguring&&e){const i=Object.entries(e);this.eachWidget(r=>{i.forEach(([s,n])=>{(!t||r[s]===t[s])&&(r[s]=n)})},!1)}}render(){this.getConfig("lazyItems"),this.layout.renderChildren(),this.syncChildCount(),super.render(...arguments)}get focusElement(){const e=this.query(this.defaultFocus||(t=>{var i;return t.isFocusable&&t.ref!=="close"&&!((i=t.ref)!==null&&i!==void 0&&i.endsWith("collapse"))}));return e?e.focusElement:super.focusElement}doDestroy(){var e;(e=this._items)===null||e===void 0||e.forEach(t=>{var i;return(i=t.destroy)===null||i===void 0?void 0:i.call(t)}),this.layout.destroy(),super.doDestroy()}get isValid(){let e=!0;return this.eachWidget(t=>{t.isVisible&&"isValid"in t&&!t.isValid&&(e=!1)},!0),e}}pt.initClass(),pt._$name="Container";const{assign:ni}=w,Ol=()=>performance.now(),eu={start:!1},tu=/^[.\d]+([^\d].*)?$/,Ll=u=>{const e=u.$bryntum||(u.$bryntum={});return e.transitions||(e.transitions=Object.create(null))},Fl=(u,e)=>{if(typeof u=="string"){var t;e=(t=tu.exec(u))===null||t===void 0?void 0:t[1],u=parseFloat(u)}return u&&u*(e==="s"||!e&&u<10?1e3:1)},Jr=u=>{const e=w.values(Ll(u)).filter(t=>t.completed==null).map(t=>t.toString());u.style.transition=e.join(", ")},kl=u=>class extends u{static get prototypeProperties(){return{_delay:null,_duration:null,_retain:null,_timing:null,_unit:null,owner:null,reverting:null}}constructor(...t){super(...t),this.id=++iu}start(){this.startTime=Ol()}get delay(){var i,r;var t;return Fl((r=(i=this._delay)!=null?i:(t=this.owner)===null||t===void 0?void 0:t.delay)!=null?r:0,this.unit)}set delay(t){this._delay=t}get duration(){var r;const{owner:t,unit:i}=this;return Fl((r=this._duration)!=null?r:t?t.duration:te.defaultDuration,i)}set duration(t){this._duration=t}get elapsed(){return Ol()-this.startTime}get remaining(){return this.duration-this.elapsed}get retain(){var i;var t;return(i=this._retain)!=null?i:(t=this.owner)===null||t===void 0?void 0:t.retain}set retain(t){this._retain=t}get timing(){var i;var t;return(i=this._timing)!=null?i:(t=this.owner)===null||t===void 0?void 0:t.timing}set timing(t){this._timing=t}get unit(){var i;var t;return(i=this._unit)!=null?i:(t=this.owner)===null||t===void 0?void 0:t.unit}set unit(t){this._unit=t}};let iu=0;class hi extends $.mixin(kl){static get $name(){return"AnimatorTransition"}static get prototypeProperties(){return{element:null,property:null,from:null,to:null,completed:null,promissory:null,reverting:null}}afterConstruct(){super.afterConstruct();const e=this,{element:t,transitions:i}=e;let{property:r}=e;[r,e.to]=v.unitize(r,e.to),e.from=v.unitize(r,e.from)[1],e.promissory=new Bi,e.property=r;const s=i[r];i[r]=e;let{from:n}=e;s&&(e.from=s.to,n=null,s.destroy()),n===null&&(n=e.getCurrentStyleValue(),s||(e.from=n)),t.style[r]=n,e.getCurrentStyleValue()}doDestroy(){const e=this;e.finish(!1),e.completed&&!e.retain&&e.clearStyle(),super.doDestroy()}get promise(){var e;return(e=this.promissory)===null||e===void 0?void 0:e.promise}get transitions(){return Ll(this.element)}clearStyle(){this.setStyle("")}finish(e){const t=this,{transitions:i,promissory:r,property:s}=t;r&&(t.completed=e,t.promissory=null,r.resolve(e),i[s]===t?(delete i[s],e||(Jr(t.element),t.clearStyle())):t.completed=!1)}getCurrentStyleValue(){return v.getStyleValue(this.element,this.property)}revert(){const{duration:e,elapsed:t,element:i,from:r,property:s,_retain:n,_timing:l}=this;return new hi({element:i,property:s,retain:n,timing:l,duration:Math.round(Math.min(e,t)),reverting:this,to:r,unit:"ms"})}setStyle(e){this.element.style[this.property]=e}start(){const e=this,{delay:t,duration:i,element:r,property:s}=e;z.onTransitionEnd({element:r,property:s,duration:t+i+20,thisObj:e.owner,handler:()=>{var n;return(n=e.finish)===null||n===void 0?void 0:n.call(e,!0)}}),super.start(),e.setStyle(e.to)}toString(){const{delay:e,duration:t,property:i,timing:r}=this;return`${i} ${t}ms ${r||"ease-in-out"}${e?` ${e}ms`:""}`}}hi.initClass();class te extends $.mixin(kl){static get $name(){return"Animator"}static get prototypeProperties(){return{element:null,finalize:null,prefinalize:null,completed:null,items:null}}static register(e,t){if(w.isObject(e)){w.entries(e).forEach(i=>te.register(...i));return}te.fx[e]=t,te[e]=i=>(v.isElement(i)?i={element:i,[e]:{}}:(i={element:i.element,[e]:i},delete i[e].element),te.run(i))}static run(e){return new te(e).start()}constructor(e){var t;super(null);const i=this,r=[],s={};let n,l,o,a;if(Array.isArray(e))i.items=e;else for(o in e)(te.specialPropsRe.test(o)?i:s)[o]=e[o];w.keys(s).forEach(c=>{a=s[c],a!=null&&a!==!1&&a===a&&((l=te.fx[c])?(a=ni(i.defaults,l(a,i,c)),a.owner=i,n=new te(a)):(a=ni(i.defaults,typeof a=="object"?a:{to:a}),a.owner=i,a.property=c,n=new hi(a)),r.push(n))}),(t=i.items)===null||t===void 0||t.forEach(c=>{w.isInstantiated(c)?c.owner=i:(c=ni(i.defaults,c),c.owner=i,c=new te(c)),r.push(c)}),i.items=r,i.promise=(r.length===1?r[0].promise:Promise.all(r.map(c=>c.promise))).then(c=>{var d;return(d=i.finish)===null||d===void 0||d.call(i,c),i.completed||!1})}doDestroy(){this.items.forEach(e=>e.destroy()),super.doDestroy()}get defaults(){return{element:this.element}}get retain(){const{_retain:e,finalize:t,owner:i}=this;return e!=null?e:t?!1:i?i.retain:!0}set retain(e){super.retain=e}done(){return this.promise}finish(e){var t,i;const r=this,{items:s}=r;for(Jr(r.element),r.completed=typeof e=="boolean"?e:!e.some(n=>!n),(t=r.prefinalize)===null||t===void 0||t.call(r,r.completed,r);s.length;)s.pop().destroy();(i=r.finalize)===null||i===void 0||i.call(r,r.completed,r)}revert(e){var n;const t=this,{reverting:i}=t,r=!e||((n=e.start)!=null?n:!0);let s=t.defaults;return i&&(i.finalize&&(s.finalize=i.finalize),i.prefinalize&&(s.prefinalize=i.prefinalize),s.retain=i._retain),s=ni(s,e,{items:t.items.map(l=>l.revert(eu)),reverting:t}),s=new te(s),r&&s.start(),s}start(){const{element:e,items:t}=this;return super.start(),t.length&&(Jr(e),t.forEach(i=>i.start())),this}}te.initClass().Transition=hi,te.specialPropsRe=new RegExp(`^(?:${Object.keys(te.prototypeProperties).concat(Object.keys(te.superclass.prototypeProperties)).map(u=>u[0]==="_"?u.substr(1):u).join("|")})$`),te.defaultDuration=200,te.fx={},te.register({puff(u){return u===!0?u={}:typeof u!="object"?u={transform:`scale(${u})`}:u.scale&&(u=w.clone(u),u.transform=`scale(${u.scale})`,delete u.scale),ni({opacity:0,transform:"scale(8)"},u)}}),te._$name="Animator";class Wi extends $.mixin(rt){static get configurable(){return{element:null,delegate:null,delay:500,startRate:2,endRate:20,accelerateDuration:4e3,pressedCls:"b-pressed"}}doDestroy(){var e;(e=this.mousedownRemover)===null||e===void 0||e.call(this),this.cancel(),super.doDestroy()}cancel(){var e,t,i;const r=this;(e=r.activeElement)===null||e===void 0||e.classList.remove(r.pressedCls),r.activeElement=null,(t=r.acceleration)===null||t===void 0||t.cancel(),r.activeListenerRemover=(i=r.activeListenerRemover)===null||i===void 0?void 0:i.call(r),r.clearTimeout(r.autoRepeatTimer),r.clearTimeout(r.repeatTimer)}updateElement(e){var t;(t=this.mousedownRemover)===null||t===void 0||t.call(this),this.mousedownRemover=z.on({element:e,mousedown:"onMouseDown",thisObj:this})}onMouseDown(e){const t=this,i=t.delegate?e.target.closest(t.delegate):t.element;t.cancel(),i&&(t.activeElement=i,t.triggerEvent=e,i.classList.add(t.pressedCls),t.activeListenerRemover=z.on({mouseup:{element:document,capture:!0,handler:"onMouseUp"},mousemove:{element:i,handler:"onTargetMouseMove"},mouseleave:{element:i,handler:"onTargetMouseLeave"},mouseenter:{element:i,handler:"onTargetMouseEnter"},thisObj:t}),t.autoRepeatTimer=t.setTimeout("startAutoRepeat",t.delay))}onMouseUp(){this.cancel()}onTargetMouseLeave(){this.activeElement.classList.remove(this.pressedCls),this.clearTimeout(this.repeatTimer)}onTargetMouseEnter(e){const t=this;e.buttons?(t.activeElement.classList.add(t.pressedCls),t.triggerEvent=e,t.fireClick()):t.cancel()}onTargetMouseMove(e){this.triggerEvent=e}startAutoRepeat(){const e=this;e.interval=e.startInterval=1e3/e.startRate,e.accelerationDelta=e.startInterval-1e3/e.endRate,e.fireClick(),e.acceleration=ee.animate(e.accelerateDuration,e.nextTick,e,"easeOutQuad")}nextTick(e){this.interval=this.startInterval-this.accelerationDelta*e}fireClick(){const e=this,t=new MouseEvent("click",e.triggerEvent);e.triggerEvent.target.dispatchEvent(t),e.repeatTimer=e.setTimeout(e.fireClick,e.interval)}}Wi._$name="ClickRepeater";const ru=/^(?:undefined|null|LEFT|RIGHT)$/,su={TOP:"BOTTOM",RIGHT:"LEFT",BOTTOM:"TOP",LEFT:"RIGHT"},$l=u=>{const e=u==null?void 0:u.toUpperCase();return[e,e==="LEFT"||e==="RIGHT"]};var Zr=u=>class extends(u||$){static get $name(){return"Rotatable"}static get configurable(){return{rotate:null,invertRotate:null}}compose(){const{rotate:t}=this;return{class:{[`b-rotate-${(t||"").toLowerCase()}`]:t,"b-rotate-vertical":t}}}syncRotationToDock(t){if(ru.test(String(this.rotate))){const[i,r]=$l(t);this.rotate=r?this.invertRotate?su[i]:i:null}}get widgetClass(){return null}};class yt extends M.mixin(Zr){compose(){const{align:e,href:t}=this;return{tag:t!=null?"a":"button",class:{[`b-align-${e||"end"}`]:1,"b-icon":1},listeners:{click:"onInternalClick"}}}get focusElement(){return this.element}get panel(){var e,t;if((e=this.parent)!==null&&e!==void 0&&e.isPanel&&(t=this.element)!==null&&t!==void 0&&t.parentNode.matches(".b-panel-header"))return this.parent}changeAlign(e){return e}onInternalClick(e){const t=this,{handler:i,panel:r}=t,s={domEvent:e,tool:t};t.disabled||(t.trigger("click",s),t.isDestroyed||(t.trigger("action",s),!t.isDestroyed&&(r==null?void 0:r.trigger("toolClick",s))!==!1&&i&&t.callback(i,r,[e,r,t])))}onInternalKeyDown(e){(e.key.trim()||e.code)==="Enter"&&(e.cancelBubble=!0,e.stopPropagation())}updateDisabled(e,t){var i;super.updateDisabled(e,t),e&&((i=this.repeat)===null||i===void 0||i.cancel())}changeRepeat(e,t){return t==null||t.destroy(),e&&Wi.new({element:this.element},e)}}R(yt,"$name","Tool"),R(yt,"type","tool"),R(yt,"configurable",{align:{value:null,$config:{merge:"replace"}},href:null,repeat:null,defaultBindProperty:null}),yt.initClass(),yt._$name="Tool";const nu=/right/i,lu=u=>(u.collapsed||u.collapsing)&&u.owner.expandedHeaderDock==="top"&&u.owner.collapsible.direction.match(nu)?"start":"end";class Qr extends yt{static get $name(){return"CollapseTool"}static get type(){return"collapsetool"}static get configurable(){return{autoAlign:!0,collapsed:null,collapsing:null,collapsify:!1,direction:"up",defaultBindProperty:null}}compose(){const{collapsed:e,direction:t}=this;return{class:{[`b-icon-collapse-${t}`]:1,"b-collapsed":e}}}changeAutoAlign(e){return e===!0?lu:e}syncAutoAlign(){const{autoAlign:e}=this;e&&(this.align=e(this))}updateAutoAlign(){this.syncAutoAlign()}updateCollapsed(){this.syncAutoAlign()}updateCollapsing(){this.syncAutoAlign()}updateDirection(){this.syncAutoAlign()}}Qr.initClass(),Qr._$name="CollapseTool";const Rl=/^(?:UP|DOWN|LEFT|RIGHT)$/,ou=/^(left|top)$/i,au={},Pl=/^b-dock-(top|left|right|bottom)$/,es="b-panel-collapse-revealer",cu=/^(?:left|right)$/i,Ui="b-collapse-unflex",{round:st}=Math,Al=["up","down","left","right"].reduce((u,e)=>(u[e.toUpperCase()]=u[e]=e,u),{}),ts={top:["top","bottom"],right:["right","left"],bottom:["bottom","top"],left:["left","right"]},uu={hl:"LEFT",hr:"RIGHT",vb:"DOWN",vt:"UP"},du={h:"w",w:"h"},_l={up:"top",right:"right",down:"bottom",left:"left"},qi={top:!1,right:!0,bottom:!1,left:!0},fu={top:"UP",right:"RIGHT",bottom:"DOWN",left:"LEFT"},Nl={top:u=>`translate(0, -${st(u.height||0)}px)`,bottom:u=>`translate(0, ${st(u.height||0)}px)`,right:u=>`translate(${st(u.width||0)}px, 0)`,left:u=>`translate(-${st(u.width||0)}px, 0)`};let hu=0;class li extends $.mixin(Mt){static get $name(){return"PanelCollapser"}static get type(){return"inline"}static get configurable(){return{animation:{duration:200},collapsed:{value:null,$config:null,default:!1},direction:null,collapseTooltip:"L{Collapse}",expandTooltip:"L{Expand}",panel:{value:null,$config:"nullify"},supportAxis:null,tool:{type:"collapsetool",handler(e){var t;(t=this.collapsible)===null||t===void 0||t.onCollapseClick(e)}}}}static get factoryable(){return{defaultType:"inline"}}get collapsing(){return this.collapsingExpanding==="collapsing"}get collapsingExpanding(){var e;const t=(e=this.currentOperation)===null||e===void 0?void 0:e.collapsing;return t==null?null:t?"collapsing":"expanding"}get currentDock(){var r;var e,t,i;return(r=(e=this.panel)===null||e===void 0||(t=e.header)===null||t===void 0||(i=t.dock)===null||i===void 0?void 0:i.toLowerCase())!=null?r:"top"}get expanding(){return this.collapsingExpanding==="expanding"}get collapseTool(){var e,t;return(e=this.panel)===null||e===void 0||(t=e.tools)===null||t===void 0?void 0:t.collapse}get collapseDim(){return cu.test(this.collapseDir)?"width":"height"}getCollapseDir(e){let{direction:t,panel:i}=this;if(!t||Rl.test(t)){const s=i==null?void 0:i.placement;if(s)t=uu[s];else{var r;t=fu[(i==null||(r=i.header)===null||r===void 0?void 0:r.dock)||"top"]}}return e?Al[t]:t}get collapseDir(){return this.getCollapseDir(!0)}get collapseDock(){return this.collapseInfo[0]}get collapseInfo(){const{panel:e}=this,t=e.hasHeader&&e.expandedHeaderDock;let i=_l[this.collapseDir],r=!1;return t&&((r=qi[i]!==qi[t])||(i=t)),[i,r]}get toolsConfig(){const{direction:e,tool:t}=this;return t&&{collapse:w.assign({direction:e.toLowerCase()},t)}}beforeCollapse(e){const{panel:t}=this,{element:i}=t;i.contains(v.getActiveElement(i))&&t.revertFocus(!0)}changeTool(e){const t=this,{panel:i}=t;if(t.isConfiguring||t.isDestroying||!i||i.isDestroying)return e;i.tools={collapse:e}}collapse(e){var o;var t,i;const r=this,{panel:s}=r,n={id:++hu,completed:!1,panel:s};let{currentOperation:l}=r;return e=e!=null?e:!0,w.isObject(e)&&(n.collapsed=!0,w.assign(n,e),e=n.collapsed,delete n.collapsed),n.collapsing=e,n.previous=l!=null?l:null,e!==r.collapsed?l?l.collapsing!==e&&(n.animation=l.animation.revert({finalize(){var a;(a=r.collapseFinalize)===null||a===void 0||a.call(r,n,!0)}}),n.collapsing=e,l=n):(n.animation=w.clone(("animation"in n?n:r).animation),r.beforeCollapse(n)!==!1&&(n.animation&&(n.animation.finalize=a=>{var c;return(c=r.collapseFinalize)===null||c===void 0?void 0:c.call(r,n,a)}),s.changingCollapse=!0,r[e?"collapseBegin":"expandBegin"](n),n.animation?l=n:(n.completed=!0,r[e?"collapseEnd":"expandEnd"](n)),s.changingCollapse=!1,n.animation||r.onComplete(e?"collapse":"expand"))):l&&l.collapsing!==e&&(r[e?"expandRevert":"collapseRevert"](n),n.animation=l.animation.revert({finalize(){var a;(a=r.collapseFinalize)===null||a===void 0||a.call(r,n,!1)}}),l=n),r.currentOperation=l,(o=(t=l)===null||t===void 0||(i=t.animation)===null||i===void 0?void 0:i.done())!=null?o:Promise.resolve(e===r.collapsed)}collapseFinalize(e,t){const i=this,{currentOperation:r,panel:s}=i,n=s.collapsed?"expand":"collapse";r===e&&(i.currentOperation=null,e.completed=t,s.changingCollapse=!0,i[n+"End"](e),s.changingCollapse=!1,t&&i.onComplete(n))}applyHeaderDock(e,t=!0){const i=this,{currentDock:r,panel:s}=i,n=e?i.collapseDock:s.expandedHeaderDock;n!==r&&s.hasHeader&&(s.header={dock:n},t&&s.recompose.flush())}composeHeader(e){const{panel:t}=this,{class:i}=e,r=t.expandedHeaderDock||Object.keys(i).filter(s=>i[s]&&Pl.test(s)).map(s=>Pl.exec(s)[1][0]);return i[es]=1,i[`b-collapsible-${r[0]}${this.collapseDir[0]}`]=1,e}composeTitle(e){return e.class[es]=1,e}collapseBegin(e){var t;const i=this,{animation:r}=e,{collapseDim:s,collapseTool:n,panel:l}=i,{element:o,placement:a}=l,[c,d]=i.collapseInfo,f=n==null?void 0:n.element.classList,g=!a||a[0]==="h"&&s==="width"||a[0]==="v"&&s==="height";i.configuredWidth=l._lastWidth,i.configuredHeight=l._lastHeight,i.transverseCollapse=d,i.applyHeaderDock(!0);const h=l.rectangle(),p=i.lockInnerSize().moveTo(0,0),m=p.clone(),y=ts[c],b=(t=l.headerElement)===null||t===void 0?void 0:t.getBoundingClientRect(),C=st((b==null?void 0:b[s])||0);o.classList.toggle(Ui,g),r?(m[y[0]]=m[y[1]],o.classList.add("b-collapsing"),f==null||f.add("b-collapsed","b-collapsing"),n&&(n.collapsing=!0),f&&(f.remove("b-collapsed"),l.rectangle(),f.remove("b-collapsing"),f.add("b-collapsed")),r.element=o,r.retain=!0,r[s]={from:st(h[s]),to:C},r.items=[{element:i.innerElement,retain:!1,clip:{from:`rect(${p})`,to:`rect(${m})`}}],d&&r.items.push({element:l.headerElement,duration:r.duration,retain:!1,transform:{from:Nl[c](b),to:"translate(0, 0)"}}),e.animation=te.run(r)):(o.style[s]=`${C}px`,n&&(f.add("b-collapsing","b-collapsed"),n.rectangle(),f.remove("b-collapsing")))}collapseEnd(e){const t=this,{collapseTool:i}=t;t.panel.element.classList.remove("b-collapsing"),i&&(i.collapsing=!1),e.completed?t.collapsed=!0:(t.applyHeaderDock(!1),t.restoreConfiguredSize(),t.lockInnerSize(!1))}collapseRevert(e){var t;(t=this.collapseTool)===null||t===void 0||t.element.classList.remove("b-collapsed")}expandBegin(e){const t=this,{animation:i}=e,{collapseDim:r,collapseTool:s,panel:n}=t,[l,o]=t.collapseInfo,{element:a}=n,c=a.classList,d=c.contains(Ui),f=n.rectangle();c.remove("b-collapsed","b-collapsing"),n.element.style[r]="",t.restoreConfiguredSize(),t.lockInnerSize(!1);const g=n.rectangle(),h=t.lockInnerSize().moveTo(0,0),p=h.clone(),m=ts[t.collapseDock];s==null||s.element.classList.remove("b-collapsed"),i&&(p[m[0]]=p[m[1]],c.add("b-collapsed","b-expanding"),d&&c.add(Ui),i.element=a,i[r]={from:st(f[r]),to:st(g[r])},i.items=[{element:t.innerElement,retain:!1,clip:{from:`rect(${p})`,to:`rect(${h})`}}],o&&i.items.push({element:n.headerElement,duration:i.duration,retain:!1,transform:{from:"translate(0, 0)",to:Nl[l](f)}}),e.animation=te.run(i))}expandEnd(e){const t=this;t.panel.element.classList.remove("b-expanding"),e.completed&&(t.collapsed=!1,t.applyHeaderDock(!1),t.restoreConfiguredSize(),t.lockInnerSize(!1))}expandRevert(e){var t;(t=this.collapseTool)===null||t===void 0||t.element.classList.add("b-collapsed")}get innerElement(){return this.panel.collapseWrapElement||this.panel.bodyWrapElement}get innerSizeElement(){return this.transverseCollapse?this.panel.element:this.innerElement}get supportAxis(){let{_supportAxis:e}=this;const t=e===!0;return(t||e==null)&&(e=this.collapseDim[0],(t||v.getStyleValue(this.panel.element,"position")==="absolute")&&(e+=du[e])),e||""}lockInnerSize(e=!0){const t=this,{innerElement:i,panel:r}=t,s=e?t.supportAxis:"",n=r.element,l=r.headerElement,o=e&&l&&V.from(l,n),a=e&&V.from(t.innerSizeElement,n),c=i.style;return l&&(l.style.minWidth=s.includes("w")?`${o.width}px`:"",l.style.minHeight=s.includes("h")?`${o.height}px`:""),c.width=e?`${a.width}px`:"",c.height=e?`${a.height}px`:"",i.classList[e?"add":"remove"]("b-panel-collapse-size-locker"),a}onCollapseClick(e){let t=this.collapsing?!1:this.expanding?!0:!this.collapsed;e.altKey&&(t={animation:null,collapsed:t}),this.collapse(t)}onComplete(e){var t;(t=this.panel)===null||t===void 0||t.trigger(e)}onHeaderClick({event:e}){e.button===0&&this.panel.collapsed&&e.target.classList.contains(es)&&this.onRevealerClick()}onPanelConfigChange({name:e,value:t}){const i=this,{panel:r}=i;e==="collapsed"?r.isPainted&&(i.collapsed=t):e==="header"&&!r.changingCollapse&&i.syncDirection()}onPanelPaint(){this.syncDirection(),this.panel.collapsed&&!this.collapsed&&this.collapse({animation:null,collapsed:!0})}onRevealerClick(){this.panel._collapse({collapsed:!1})}restoreConfiguredSize(e){const{configuredHeight:t,configuredWidth:i,panel:r}=this;e=e!=null?e:"wh",r.element.classList.remove(Ui),i!=null&&e.includes("w")&&(r.width=i),t!=null&&e.includes("h")&&(r.height=t)}splitHeaderItems({as:e,dock:t}=au){var i;return(i=this.panel)===null||i===void 0?void 0:i.splitHeaderItems({as:e,dock:t,alt:!0})}syncDirection(){const e=this,{direction:t}=e;(!t||Rl.test(t))&&(e.direction=e.getCollapseDir())}changeCollapsed(e){return!!e}updateCollapsed(e){const{collapseTool:t,panel:i}=this;i&&(i.collapsed=e,i.element.classList[e?"add":"remove"]("b-collapsed")),t&&(t.collapsed=e)}updateDirection(e){const{collapseTool:t,panel:i}=this;t&&(t.direction=Al[e]),i!=null&&i.rendered&&i.recompose()}updatePanel(e){var t;const i=this;i.syncDirection(),(t=i.panelChangeDetacher)===null||t===void 0||t.call(i),i.panelChangeDetacher=e&&ee.after(e,"onConfigChange","onPanelConfigChange",i,{return:!1})}wrapCollapser(e,t){var i;const r=this,[s,n]=r.collapseInfo;if(!n)return[e,t];const{collapseDir:l,panel:o}=r,{expandedHeaderDock:a,header:c,uiClassList:d}=o,f=(i=o.tools)===null||i===void 0?void 0:i.recollapse,[g,h]=r.splitHeaderItems({as:"element",dock:s}),p=o.hasHeader?o.title||(c==null?void 0:c.title)||"\xA0":null,m=p&&{tag:"header",class:new W({...d,[`b-dock-${a}`]:1,"b-panel-header":1,"b-panel-collapser-header":1},c==null?void 0:c.cls),children:[...g,{reference:"collapserTitleElement",html:p,class:{...d,[`b-align-${(c==null?void 0:c.titleAlign)||"start"}`]:1,"b-header-title":1}},...h]};return f&&(f.direction=l),["collapseWrapElement",{class:{...d,[`b-panel-collapser-header-${a}`]:1,[`b-panel-collapser-${l}`]:1,[`b-${qi[a]?"h":"v"}box`]:1,"b-panel-collapser":1,"b-box-center":1},children:ou.test(a)?{collapserHeaderElement:m,[e]:t}:{[e]:t,collapserHeaderElement:m}}]}}li.maps={clipByDock:ts,dockByDirection:_l,dockIsHorz:qi},li.initClass(),li._$name="PanelCollapser";const oi=Symbol("pendingCreate");class Lt extends ${static get prototypeProperties(){return{cleanup:null,configName:null,created:null,factory:null,inferType:"name",owner:null,ownerName:null,proxyable:typeof Proxy!="undefined",setup:null,transform:null}}static get properties(){return{defaults:{},instances:{},object:Object.create({})}}get proxy(){const e=this;let t=null;return e.proxyable&&(t=new Proxy(e.instances,{get(i,r){return e.get(r)},set(i,r,s){return e.set(r,s),!0},deleteProperty(i,r){return e.set(r,null),!0}})),Reflect.defineProperty(e,"proxy",{configurable:!0,value:t}),t}get target(){return this.proxy||this.object}define(e,t){const i=this,{transform:r}=i,s=r?r(t,e):t,n=w.isInstantiated(s);i.instances[e]=oi,n||i.setDefaults(e,s),i.defineProp(e,!0),n&&i.set(e,s)}defineProp(e,t){const i=this,{object:r}=i;i.proxy||Reflect.defineProperty(t?Object.getPrototypeOf(r):r,e,{configurable:!t,enumerable:!0,get(){return i.get(e)},set(s){return i.set(e,s)}})}flush(){const e=this;try{var t;e.updating=!0;for(const i in e.defaults)e.get(i);e.afterConfigureOwner=(t=e.afterConfigureOwner)===null||t===void 0?void 0:t.call(e)}finally{e.updating=!1}}get(e){const{defaults:t,instances:i}=this;return i[e]===oi&&this.set(e,oi),i[e]||t[e]&&null}set(e,t){const i=this,{cleanup:r,configName:s,defaults:n,factory:l,instances:o,owner:a,setup:c,transform:d,updating:f}=i,g=a&&s&&!f,h=o[e]===oi?null:o[e],p=l.reconfigure(h,t===oi?{}:t||null,{cleanup:r&&(y=>r(y,e)),defaults:n[e]||i.setDefaults(e,{}),owner:i.owner,setup:c&&((y,b,C)=>c(y,e,b,C)),transform:d&&(y=>d(y,e))});if(p!==h){const y=g&&{...o};if(o[e]=p,p){var m;i.defineProp(e),(m=i.created)===null||m===void 0||m.call(i,p,e)}else delete i.object[e],delete o[e];g&&a.onConfigChange({name:s,config:a.$meta.configs[s],value:i.target,was:y})}}setDefaults(e,t){const{defaults:i,factory:r,inferType:s,instances:n,owner:l,ownerName:o}=this,{typeKey:a}=r.factoryable;return t=t===!0?{}:w.assign({},t),(s==="name"||s===!0&&!t[a])&&(t[a]=e),o&&(t[o]=l),t.beforeConfigure=c=>{n[e]=c},i[e]=t}update(e){const t=this,{owner:i}=t;let r,s;try{if(t.updating=!0,e)for(r in e)s=e[r],t.defaults[r]?t.set(r,s):s&&t.define(r,s);else for(r in t.instances)t.set(r,null)}finally{t.updating=!1}i&&(i.isConfiguring?t.afterConfigureOwner||(t.afterConfigureOwner=ee.before(i,"afterConfigure","flush",t)):t.flush())}}Lt.initClass(),Lt._$name="DynamicObject";const gu=[],is={},mu={align:1,weight:1};var rs=u=>class extends(u||M){static get $name(){return"Toolable"}static get configurable(){return{tools:{value:null,$config:{nullify:!0}},toolDefaults:{"*":{type:"tool",align:"end"}}}}byWeightSortFn(t,i){return(t.weight||0)-(i.weight||0)}byWeightReverseSortFn(t,i){return(i.weight||0)-(t.weight||0)}gatherTools({align:t,alt:i,refs:r}=is){var y,b;const{collapsed:s,tools:n}=this,l={collapsed:s,alt:i};let o=[],a,c,d,f,g;for(c in n){var h,p,m;g=n[c],a=(b=(y=(h=g)===null||h===void 0||(p=h.align)===null||p===void 0?void 0:p.align)!=null?y:(m=g)===null||m===void 0?void 0:m.align)!=null?b:"end",a===t&&g.isCollapsified(l)&&o.push(g)}if(o.sort(this[t==="end"?"byWeightReverseSortFn":"byWeightSortFn"]),r){const C=r==="widget",E={};for(d=0;d<o.length;++d)f=o[d],E[f.ref]=C?f:f.element;o=E}return o}getEndTools({alt:t,refs:i}=is){return this.gatherTools({align:"end",alt:t,refs:i})}getStartTools({alt:t,refs:i}=is){return this.gatherTools({align:"start",alt:t,refs:i})}get childItems(){return[...this.getStartTools(),...this._items||gu,...this.getEndTools()]}changeTools(t,i){const r=this,s=r.$tools||(r.$tools=new Lt({configName:"tools",factory:M,inferType:!1,owner:r,created(n){var l,o;n.innerItem=!1,(l=n.syncRotationToDock)===null||l===void 0||l.call(n,(o=r.header)===null||o===void 0?void 0:o.dock),ee.after(n,"onConfigChange",(a,{name:c})=>{mu[c]&&r.onConfigChange({name:"tools",value:s.target})}),r.onChildAdd(n)},setup(n,l){return n=w.merge({},r.toolDefaults["*"],r.toolDefaults[l],n),n.parent=r,n.ref=l,n}}));if(s.update(t),!i)return s.target}get widgetClass(){}};const Vl=["b-hbox","b-vbox"],pu={name:"align",style:"alignItems"},yu={name:"contentAlign",style:"alignContent"},vu={name:"direction",style:"flexDirection"},bu={name:"justify",style:"justifyContent",classes:["stretch"]},Cu={name:"wrap",style:"flexWrap",map:{false:"nowrap",true:"wrap",reverse:"wrap-reverse"}};class vt extends qe{get vertical(){return this.horizontal===!1}set vertical(e){return this.horizontal=!e}updateAlign(){this.syncConfigStyle(pu)}updateContentAlign(){this.syncConfigStyle(yu)}updateDirection(){this.syncConfigStyle(vu)}updateHorizontal(){var e;const t=this,i=(e=t.contentElement)===null||e===void 0?void 0:e.classList,r=Number(t.vertical);i?(i.remove(Vl[1-r]),i.add(Vl[r])):t.syncConfigLater("horizontal"),t.syncDirection()}updateJustify(){this.syncConfigStyle(bu)}updateReverse(){this.syncDirection()}updateWrap(){this.syncConfigStyle(Cu)}syncDirection(){const e=this,{reverse:t}=e;e.direction=t?`${e.vertical?"column":"row"}${t?"-reverse":""}`:null}}R(vt,"$name","Box"),R(vt,"type","box"),R(vt,"alias","hbox"),R(vt,"configurable",{containerCls:"b-box-container",itemCls:"b-box-item",align:null,contentAlign:null,direction:null,horizontal:!0,justify:null,reverse:null,wrap:null}),vt.initClass(),vt._$name="Box";class ai extends vt{}R(ai,"$name","VBox"),R(ai,"type","vbox"),R(ai,"configurable",{horizontal:!1}),ai.initClass(),ai._$name="VBox";var ss=u=>class extends(u||$){static get $name(){return"Badge"}static get configurable(){return{badge:null}}compose(){const{badge:t}=this;return{dataset:{badge:t},class:{"b-badge":t!=null&&t!==""}}}};const zl=/(?:^|\s)b-icon-/,Bl=/(?:^|\s)b-fa-/,jl=Symbol("defaultToggleable"),wu=["items","type","widgets","html","listeners"],Hl=Symbol("defaultListener");class ns extends M.mixin(ss,Zr){static get $name(){return"Button"}static get type(){return"button"}static get configurable(){return{icon:null,menuIcon:"b-icon-picker",pressedIcon:null,iconAlign:"start",behaviorType:"button",text:{value:null,$config:null,default:""},color:null,toggleable:jl,pressed:!1,toggleGroup:null,supportsPressedClick:!1,ripple:{radius:75},forwardTwinEvents:["action","toggle"],localizableProperties:["text"],menu:{$config:["lazy","nullify"],value:null},menuDefaults:{type:"menu",autoShow:!1,autoClose:!0,floating:!0,scrollAction:"realign",align:"t0-b0"},href:null,target:null,defaultBindProperty:null}}updateElement(e,t){var i,r,s;const n=this,{constructor:l}=n,o=super.updateElement(e,t),a=n.peekConfig("menu"),c=a?a.isWidget?a.role:((i=l.resolveType(a.type))===null||i===void 0||(r=i.configurable)===null||r===void 0?void 0:r.role)||((s=l.configurable.menuDefaults)===null||s===void 0?void 0:s.type)||"menu":!1;return n.ariaHasPopup=c,o}compose(){const{color:e,href:t,icon:i,iconAlign:r,pressed:s,pressedIcon:n,target:l,text:o,toggleable:a,toggleGroup:c,menuIcon:d,behaviorType:f}=this,g=this.hasConfig("menu"),h=s&&n?n:i;return{tag:t?"a":"button",href:t,target:l,type:f,class:{[`b-icon-align-${r}`]:i,[e]:!!e,"b-pressed":s&&a,"b-text":!!o,"b-has-menu":g},"aria-pressed":s,dataset:{group:c},listeners:{click:"onInternalClick",mousedown:"onInternalMousedown"},children:{iconElement:(i||n)&&{"aria-hidden":!0,tag:"i",class:{...W.normalize(h,"object"),"b-icon":zl.test(h),"b-fa":Bl.test(h)}},label:o&&{tag:"label",text:o},menuIconElement:g&&d&&{tag:"i",class:{"b-icon":zl.test(d),"b-fa":Bl.test(d),"b-button-menu-icon":1,[d]:1}}}}}configureOverflowTwin(e){const t=this,i=super.configureOverflowTwin(e);return i.text||(i.text=t.text||t.tooltipText),i}onHide(){var e;(e=this._menu)===null||e===void 0||e.hide()}get childItems(){return this._menu&&[this.menu]}onFocusOut(e){var t;super.onFocusOut(e),(t=this.menu)===null||t===void 0||t.hide()}get focusElement(){return this.element}changeText(e){return e==null?"":e}changeToggleable(e){return e===jl?this.toggleGroup||this.config.menu:e}changeMenu(e,t){const i=this,{element:r}=i;return e?(e.isWidget?(e.forElement=r,e.owner=i,e.constrainTo=i.rootElement):(typeof e=="object"&&!wu.some(s=>s in e)&&(e={lazyItems:e}),e=M.reconfigure(t,e?w.merge({owner:i,constrainTo:i.rootElement,forElement:r},i.menuDefaults,e):null,i)),e.align.constrainPadding=10,i.detachListeners(Hl),e.ion({name:Hl,beforeShow:"onMenuBeforeShow",hide:"onMenuHide",show:"onMenuShow",thisObj:this})):t==null||t.destroy(),e}onMenuBeforeShow({source:e}){return this.trigger("beforeShowMenu",{menu:e})}onMenuShow(){this.ariaElement.setAttribute("aria-expanded",!0)}onMenuHide(){this.ariaElement.setAttribute("aria-expanded",!1),this.toggle(!1)}updateMenu(e){this.toggleable=!!e}updatePressed(e){var r,s;const t=this;if(!t.toggleable||t.isConfiguring)return;const{menu:i}=t;e&&v.forEachSelector(t.rootElement,`button[data-group=${t.toggleGroup}]`,n=>{n!==t.element&&(M.getById(n.id).pressed=!1)}),i&&(i.initialConfig.minWidth||(i.minWidth=t.width),i.align.minHeight=(r=i._minHeight)!=null?r:100,i.align.minWidth=(s=i._minWidth)!=null?s:100,i[e?"show":"hide"]()),t.trigger("toggle",{pressed:e,userAction:t._isUserAction})}onInternalMousedown(e){var t;(t=this._menu)!==null&&t!==void 0&&t.containsFocus&&this.pressed&&e.preventDefault()}onInternalClick(e){const t=this,i={event:e};t.disabled||(t._isUserAction=!0,!(t.toggleable&&(t.toggleGroup&&t.pressed&&!t.supportsPressedClick||((!t.toggleGroup||!t.pressed)&&t.toggle(!t.pressed),t.isDestroyed)))&&(t.trigger("click",i),t.isDestroyed||t.trigger("action",i),t.href||(e.preventDefault(),e.stopPropagation()),t._isUserAction=!1))}toggle(e=!this.pressed){this.trigger("beforeToggle",{pressed:e,userAction:this._isUserAction})!==!1&&(this.pressed=e)}}ns.initClass(),ns._$name="Button";const Wl={refs:"element"},Su=u=>u.element.style.margin="",Eu=u=>u.isToolbar,Ul=u=>u[0]+(u[1].minifiable?0:9e9),ql={hidden:!1,width:""},Tu={...ql,flex:""},xu=[{box:"hbox",clientSizeProp:"clientWidth",edgeProp:"right",flexDir:"row",horizontal:!0,max:"maxX",overflow:"overflowX",pos:"x",scrollSize:"scrollWidth",sizeProp:"width"},{box:"vbox",clientSizeProp:"clientHeight",edgeProp:"bottom",flexDir:"column",horizontal:!1,max:"maxY",overflow:"overflowY",pos:"y",scrollSize:"scrollHeight",sizeProp:"height"}],Du={delay:0,startRate:40,endRate:200,accelerateDuration:500},Mu={menu:1,pressed:1};class gi extends pt.mixin(rs){static get $name(){return"Toolbar"}static get type(){return"toolbar"}static get delayable(){return{syncOverflowVisibility:{type:"raf",cancelOutstanding:!0}}}static get configurable(){return{defaultType:"button",dock:"top",layout:{type:"box"},overflow:{$config:["lazy","nullify"],value:{type:"menu"}},toolDefaults:{overflowMenuButton:{type:"button",hidden:!0,icon:"b-icon-menu",menuIcon:null,defaultCls:{"b-overflow-button":1}},overflowScrollEnd:{handler:"up.onEndScrollClick",hidden:!0,defaultCls:{"b-icon-angle-right":1,"b-overflow-button":1,"b-icon":1}},overflowScrollStart:{align:"start",handler:"up.onStartScrollClick",hidden:!0,defaultCls:{"b-icon-angle-left":1,"b-overflow-button":1,"b-icon":1}}},widgetCls:null,ignoreParentReadOnly:!0}}static get prototypeProperties(){return{flexRowCls:"b-hbox",flexColCls:"b-vbox"}}static getEvictionList(e){const t=e.filter(i=>i.overflowable!=="none");return t.forEach((i,r)=>t[r]=[r,i]),t.sort((i,r)=>Ul(r)-Ul(i)),t}compose(){const e=this,{axisProps:t,dock:i}=e,r=e.getEndTools(Wl),s=e.getStartTools(Wl);return{class:{[`b-dock-${i}`]:1,[`b-${i}-toolbar`]:1,[`b-${t.box}`]:1},children:{...s,toolbarContent:{class:{"b-box-center":1,"b-toolbar-content":1}},...r}}}get axisProps(){return xu[this.layout.horizontal?0:1]}get contentElement(){return this.toolbarContent}get overflowMenuButton(){var e;return(e=this.tools)===null||e===void 0?void 0:e.overflowMenuButton}get overflowType(){const{overflow:e}=this;return typeof e=="string"?e:e==null?void 0:e.type}onChildAdd(e){var t;super.onChildAdd(e),this.processAddedLeafItem(e),(t=e.syncRotationToDock)===null||t===void 0||t.call(e,this.dock)}onChildRemove(e){super.onChildRemove(e),this.syncOverflowVisibility()}processAddedLeafItem(e){ee.after(e,"onConfigChange",this.onLeafItemConfigChange,e),e.isContainer&&e.eachWidget(t=>this.processAddedLeafItem(t))}onPaint({firstPaint:e}){var t;(t=super.onPaint)===null||t===void 0||t.call(this,...arguments),e&&this.getConfig("overflow")}updateDock(e){const t=this,{layout:i}=t,{vertical:r}=i;if(i.vertical=$l(e)[1],!t.initialItems){r!==i.vertical&&t.updateOverflow(t.overflow);for(const n of t.childItems){var s;(s=n.syncRotationToDock)===null||s===void 0||s.call(n,e)}}}updateOverflow(e,t){var i;const r=this,{axisProps:s,contentElement:n,overflowType:l}=r,{flexDir:o}=s,a=(i=r.overflowMenuButton)===null||i===void 0?void 0:i._menu,c={};if(a&&(e?a==null||a.removeAll():a.eachWidget(f=>{f._overflowTwinOrigin.overflowTwin=null})),t==="menu"?c.overflowMenuButton=null:t==="scroll"&&(c.overflowScrollStart=c.overflowScrollEnd=null),l==="menu"){var d;(d=r.scrollable)===null||d===void 0||d.destroy(),n.style.overflow=n.style.overflowX=n.style.overflowY="",c.overflowMenuButton={cls:{[`b-${o}-menu`]:1}}}else if(l==="scroll"){const f=typeof e=="object"&&(e==null?void 0:e.repeat)||Du;r.scrollable={[s.overflow]:"hidden-scroll",element:n,internalListeners:{scroll:"onContentScroll",thisObj:r}},c.overflowScrollStart={repeat:f,invertRotate:!0,cls:{[`b-${o}-start-scroller`]:1}},c.overflowScrollEnd={repeat:f,invertRotate:!0,cls:{[`b-${o}-end-scroller`]:1}}}r.tools=c,l?(n.classList.add("b-overflow"),r.monitorResize=!0,r.syncOverflowVisibility()):(n.classList.remove("b-overflow"),r.monitorResize=!1)}onContentScroll(){this.syncScrollerState()}onStartScrollClick(){this.scrollable[this.axisProps.pos]-=2}onEndScrollClick(){this.scrollable[this.axisProps.pos]+=2}onInternalResize(){super.onInternalResize(...arguments),this.isPainted&&this.syncOverflowVisibility()}syncOverflowVisibility(){const e=this,{overflowType:t,contentElement:i,isVisible:r}=e,{clientSizeProp:s,edgeProp:n,sizeProp:l}=e.axisProps,{overflowMenuButton:o,overflowScrollStart:a,overflowScrollEnd:c}=e.tools,d=e.rtl&&e.layout.horizontal,f=t==="menu",g=()=>Math.ceil(i[s]+(!a||a.hidden?0:a.rectangle("outer")[l])+(!c||c.hidden?0:c.rectangle("outer")[l])),h=()=>{if(I.length===0)return 0;const H=I[I.length-1].rectangle(i);return Math.floor(d?i[s]-H.left:H[n])};let p,m,y,b,C,E,S,x,L,O,P,I;if(!(!r||!t||e.items.length===0)){if(e.inSyncOverflowVisibility=!0,o==null||o.hide(),e.eachWidget((H,J)=>{S=H.minifiable,O=H.overflowable,O=S?O||S:O,H.floating?J.down=!1:(J.down=!O,H.innerItem&&(H._toolbarOverflow&&(H.hidden=H._toolbarOverflow=!1),H._toolbarMinified&&(H.minified=H._toolbarMinified=!1),H.isVisible&&(S&&(x||(x=[])).push(H),O&&(I||(I=[])).push(H))))}),I&&(p=g(),m=h()),I&&m>p)if(f){for(;m>p&&(C=(G=x)===null||G===void 0?void 0:G.pop());){var G;E=m,C._toolbarMinified=!0,C.minified=!0,m=h(),E-=m,(L||(L=[])).push([C,E])}if(m>p){o.show(),p=g(),b=gi.getEvictionList(I);for(y of b)m>p&&(C=y[1],C._toolbarOverflowWidth=C.width,C._toolbarOverflow=!0,C.hidden=!0,I.splice(I.indexOf(C),1),(P||(P=[])).push(y),m=h());if(P){for(P.sort((H,J)=>H[0]-J[0]).forEach((H,J)=>P[J]=H[1]);(K=L)!==null&&K!==void 0&&K.length;){var K;[C,E]=L.pop(),m+E<=p&&!C._toolbarOverflow&&(m+=E,C.minified=C._toolbarMinified=!1)}e.syncOverflowMenuButton(P)}else o.hide()}}else c.show(),a.show(),e.syncScrollerState();else f||(c==null||c.hide(),a==null||a.hide());e.inSyncOverflowVisibility=!1}}syncOverflowMenuButton(e){var t;const i=this,{axisProps:r,overflowMenuButton:s}=i,n={cls:"b-toolbar-overflow-menu",minWidth:280,items:[],align:{align:r.horizontal?"t100-b100":"r100-l100",axisLock:"flexible"}};if(i.addToMenu(n,e.filter(l=>i.overflowItemFilter(l))),(t=s._menu)!==null&&t!==void 0&&t.isMenu){const l=s.menu,{toAdd:o,toRemove:a}=j.delta(n.items,l.items,1);if(l.remove(a),l.items.length)for(let c=o.length-1;c>=0;c--)l.insert(o[c],0);else l.add(o)}else s.menu=n}syncScrollerState(){const e=this,{axisProps:t,scrollable:i}=e,{overflowScrollStart:r,overflowScrollEnd:s}=e.tools,n=i[t.pos],l=i[t.max];r.disabled=!n,s.disabled=Math.abs(Math.ceil(n))>=Math.abs(l)}overflowItemFilter(e){const{filter:t}=this.overflow;return!!(t?t.call(this,e):v.getChildElementCount(e.element))}addToMenu(e,t){const i=this.horizontal?Tu:ql;for(const r of t){const s=r.ensureOverflowTwin(i,Su);e.items.push(s)}}onLeafItemConfigChange(e,{name:t,value:i}){const r=this,s=r.up(Eu),n=s.hasConfig("overflow"),{overflowTwin:l}=r;!n||s!=null&&s.inSyncOverflowVisibility||t==="hidden"&&i===r._toolbarOverflow||(l&&!Mu[t]&&(l[t]=i),s!=null&&s.isPainted&&r.ref!=="overflowMenuButton"&&(r.isTextField&&t==="value"&&(r.containsFocus||l!=null&&l.containsFocus)||s.syncOverflowVisibility()))}createWidget(e){e==="->"?e={type:"widget",cls:"b-toolbar-fill"}:e==="|"?e={type:"widget",cls:"b-toolbar-separator"}:typeof e=="string"&&(e={type:"widget",cls:"b-toolbar-text",html:e});const t=super.createWidget(e);return this.widgetCls&&t.element.classList.add(this.widgetCls),t}}gi.initClass(),gi._$name="Toolbar";const Iu=u=>!u.classList.contains("b-focus-trap")&&v.isFocusable(u)?v.NodeFilter.FILTER_ACCEPT:v.NodeFilter.FILTER_SKIP,ls=[],Ou={},Kl=[ls,ls],Yl=(u,e,t)=>{const{vertical:i}=u;return delete u.vertical,{...u,class:{...e,[`b-${i?"v":"h"}box`]:1,"b-box-center":1,"b-panel-bar-wrap":!t}}},os=(u,e,t=!1)=>{const i={vertical:t,children:u?[u]:[]};return e&&(i.tag=e),i},Ki=(u,e)=>{u!=null&&u.classList?u==null||u.classList.add(e):u!=null&&u.class&&(typeof u.class=="string"&&(u.class={[u.class]:1}),u.class[e]=1)},Lu={dock:1,hidden:1,weight:1},bt={top:[!0,!0],bottom:[!0,!1],left:[!1,!0],right:[!1,!1]},Gl={header:1,"pre-header":1};class dt extends pt.mixin(Lr,rs){static get $name(){return"Panel"}static get type(){return"panel"}static get configurable(){return{localizableProperties:["title"],collapsed:{value:null,$config:null,default:!1},collapsible:{value:null,$config:"nullify"},bodyCls:{$config:{merge:"classList"},value:null},bodyTag:null,bodyWrapTag:null,trapFocus:null,title:null,header:null,stateful:["collapsed"],stripDefaults:{"*":{type:"toolbar",dock:"top"},bbar:{dock:"bottom",weight:-1e3},tbar:{weight:-1e3}},strips:{value:null,$config:"nullify"},toolDefaults:{close:{weight:-1e3},collapse:{weight:-990}},footer:null,revealed:null,tbar:null,bbar:null,role:"region"}}updateElement(e,t){const i=super.updateElement(e,t);return this.titleElement&&v.setAttributes(this.ariaElement,{"aria-describedby":this.titleElement.id}),i}compose(){const e=this,{collapsible:t,focusable:i,hasItems:r,revealed:s,tools:n}=e,l=e.composeHeader(),o=(l==null?void 0:l.class["b-dock-left"])||(l==null?void 0:l.class["b-dock-right"]);let a=e.composeBody(),c="bodyWrapElement";return t&&([c,a]=t.wrapCollapser(c,a)),{tabIndex:r&&i!==!1||i?0:null,class:{[`b-panel-collapsible-${t==null?void 0:t.type}`]:t,[`b-panel-collapse-${t==null?void 0:t.collapseDir}`]:t,[`b-${o?"h":"v"}box`]:1,"b-panel-collapsible":t,"b-panel-has-header":l,"b-panel-has-tools":n?1:0,"b-panel-overlay-revealed":s},children:{topFocusTrap:{"aria-hidden":!0,tabIndex:0,class:{"b-focus-trap":1}},headerElement:l,[c]:a,bottomFocusTrap:{"aria-hidden":!0,tabIndex:0,class:{"b-focus-trap":1,"b-end-focus-trap":1}}}}}composeBody(){var e,t;const i=this,{bodyCls:r,bodyConfig:s,bodyWrapTag:n,footer:l,uiClassList:o}=i,a=w.values(i.strips,(C,E)=>!bt[E==null?void 0:E.dock]).sort(i.byWeightSortFn),c={top:null,right:null,bottom:null,left:null};let d,f,g,h,p,m,y;for(l&&(g=l.dock||"bottom",a.unshift({dock:g,element:{tag:"footer",reference:"footerElement",html:typeof l=="string"?l:l.html,class:{...o,[`b-dock-${g}`]:1,[`${l.cls||""}`]:1}}})),r&&(s[p="className"]||(p="class"),s[p]=new W(s[p]).assign(r)),h=a.length;h-- >0;)d=a[h],[m,f]=bt[d.dock],y?y.vertical!==m&&(y=os(Yl(y,o),"",m)):y=os(s,n,m),y.children[f?"unshift":"push"](d.element),c[d.dock]=d;Ki(c.top,"b-innermost"),Ki(c.right,"b-innermost"),Ki(c.bottom,"b-innermost"),Ki(c.left,"b-innermost");const b=Yl(y||os(s,n),o,!0);return b.class[`${(e=i.layout)===null||e===void 0?void 0:e.containerCls}-panel`]=!!(!((t=i.layout)===null||t===void 0)&&t.containerCls),b.class["b-panel-body-wrap"]=1,b.class[`b-${i.$$name.toLowerCase()}-body-wrap`]=1,b}get hasHeader(){if(this.header===!1)return!1;const{header:e,title:t,tools:i,parent:r}=this,s=this.maximizable||Object.values(i||{}).some(n=>!n.hidden);return e||!(r!=null&&r.suppressChildHeaders)&&(t||s)}get rootUiClass(){return dt}composeHeader(e){var t;const i=this;if(!i.hasHeader&&!e)return;const r=i.header||{},s=r.dock||"top",[n,l]=i.splitHeaderItems({as:"element",dock:s}),o=i.$meta.hierarchy,a=i.composeTitle(r),c=new W({[`b-dock-${s}`]:1,...i.uiClassList},r.cls);let d,f;for(d=o.indexOf(dt);d<o.length;++d)f=o[d].$$name,f!=="Grid"&&(c[`b-${f.toLowerCase()}-header`]=1);const g={tag:"header",class:c,children:[...n,a,...l]};return((t=i.collapsible)===null||t===void 0?void 0:t.composeHeader(g))||g}composeTitle(e){var t;const i=typeof e=="string"?e:this.title||e.title,r={reference:"titleElement",id:`${this.id}-panel-title`,html:i!=null?i:"\xA0",class:{[`b-align-${e.titleAlign||"start"}`]:1,"b-header-title":1,...this.uiClassList}};return w.isObject(i)&&(delete r.html,w.merge(r,i)),((t=this.collapsible)===null||t===void 0?void 0:t.composeTitle(r))||r}updateTitle(){}afterRecompose(){var e;super.afterRecompose();const t=this,{headerElement:i}=t;(e=t._headerClickDetacher)===null||e===void 0||e.call(t),t._headerClickDetacher=i&&z.on({element:i,click:r=>{var s;return(s=t.trigger)===null||s===void 0?void 0:s.call(t,"headerClick",{event:r})}})}onHeaderClick(e){var t;(t=this.collapsible)===null||t===void 0||t.onHeaderClick(e)}onPaint(){var e;super.onPaint(...arguments),(e=this.collapsible)===null||e===void 0||e.onPanelPaint(this)}splitHeaderItems({as:e,dock:t,alt:i}=Ou){const r=this,s=e==="element",{collapsed:n}=r,l=r.getEndTools({alt:i}),o=r.getStartTools({alt:i}),a=w.values(r.strips,(b,C)=>!Gl[C==null?void 0:C.dock]&&C.isCollapsified({collapsed:n,alt:i}));let c=Kl,d,f,g;if(a.length+l.length+o.length){for(c=[f=[...o,...a.filter(b=>b.dock==="pre-header").sort(r.byWeightSortFn)],d=[...a.filter(b=>b.dock==="header").sort(r.byWeightReverseSortFn),...l]],g=0;g<f.length;++g){var h,p;t&&((h=(p=f[g]).syncRotationToDock)===null||h===void 0||h.call(p,t)),s&&(f[g]=f[g].element)}for(g=0;g<d.length;++g){var m,y;t&&((m=(y=d[g]).syncRotationToDock)===null||m===void 0||m.call(y,t)),s&&(d[g]=d[g].element)}}return c}set bodyConfig(e){this._bodyConfig=e}get bodyConfig(){const e=this,{bodyTag:t}=e,i=w.merge({reference:"bodyElement",className:{...e.getStaticWidgetClasses(dt,"-content"),"b-box-center":1,"b-text-content":e.textContent&&e.hasNoChildren}},e._bodyConfig);return t&&(i.tag=t),(e.initializingElement||!e._element)&&(i.html=e.content||e._html),i}changeBodyCls(e){return W.from(e)}changeTbar(e){return this.getConfig("strips"),this.strips={tbar:e},this.strips.tbar}changeBbar(e){return this.getConfig("strips"),this.strips={bbar:e},this.strips.bbar}get childItems(){var e;const t=this,i=w.values(t.strips,(o,a)=>!bt[a==null?void 0:a.dock]).sort(t.byWeightSortFn),[r,s]=t.splitHeaderItems(),[n,l]=((e=t.collapsible)===null||e===void 0?void 0:e.splitHeaderItems())||Kl;return[...r,...n,...s,...l,...i.filter(o=>bt[o.dock][1]),...t._items||ls,...i.filter(o=>!bt[o.dock][1]).reverse()]}changeStrips(e,t){const i=this,r=i.$strips||(i.$strips=new Lt({configName:"strips",factory:M,inferType:!1,owner:i,created(s){var n;const{dock:l}=s;if(!Gl[l]&&!bt[l])throw new Error(`Invalid dock value "${l}"; must be: top, left, right, bottom, header, or pre-header`);ee.after(s,"onConfigChange",(o,{name:a})=>{Lu[a]&&i.onConfigChange({name:"strips",value:r.target})}),s.innerItem=!1,i.onChildAdd(s),s.parent=i,(n=s.layout)===null||n===void 0||n.renderChildren(),s.hasItems&&(i.hasItems=!0)},setup(s,n){return s=w.merge(w.clone(i.stripDefaults["*"]),i.stripDefaults[n],s),s.parent=i,s.ref=n,s},transform(s){return Array.isArray(s)&&(s={items:s}),s||null}}));if(r.update(e),!t)return r.target}get collapsing(){var e;return(e=this.collapsible)===null||e===void 0?void 0:e.collapsing}get collapsingExpanding(){var e;return(e=this.collapsible)===null||e===void 0?void 0:e.collapsingExpanding}get expanding(){var e;return(e=this.collapsible)===null||e===void 0?void 0:e.expanding}changeCollapsed(e){const t=this,{collapsible:i}=t;if(t.recompose.flush(),e=!!e,!i||t.changingCollapse||!t.isPainted)return e;i==null||i.collapse({animation:null,collapsed:e})}changeCollapsible(e,t){const i=this;return i.getConfig("tools"),e&&(e===!0?e={}:typeof e=="string"&&(e={[bt[e]?"direction":"type"]:e})),li.reconfigure(t,e,{owner:i,defaults:{panel:i},cleanup(){i.collapsed&&(t.collapse({animation:null,collapsed:!1}),i._collapsed=1)}})}updateCollapsible(e){const t=this,i=e==null?void 0:e.toolsConfig;t.tools={collapse:(i==null?void 0:i.collapse)||null,recollapse:(i==null?void 0:i.recollapse)||null},e&&t.isPainted&&t.collapsed&&(t._collapsed=1),t.collapsed===1&&(t.collapsed=!0)}_collapse(e,t){var i;return t!==!0&&t!==void 0&&(t===!1?e.collapsed=!e.collapsed:typeof t=="number"?e.animation={duration:t}:t===null?e.animation=t:t===!0||("animation"in t?w.merge(e,t):e.animation=t)),(i=this.collapsible)===null||i===void 0?void 0:i.collapse(e)}collapse(e){return this._collapse({collapsed:!0},e)}expand(e){return this._collapse({collapsed:!1},e)}toggleCollapsed(e){return this.collapsed?this.expand(e):this.collapse(e)}get expandedHeaderDock(){var t,i;var e;return(i=(t=this._expandedHeaderDock)!=null?t:(e=this.initialConfig.header)===null||e===void 0?void 0:e.dock)!=null?i:"top"}set expandedHeaderDock(e){this._expandedHeaderDock=e==null?void 0:e.toLowerCase()}updateHeader(e){this.changingCollapse||(this.expandedHeaderDock=e==null?void 0:e.dock)}updateTrapFocus(e){var t;const i=this;i.element.classList[e?"add":"remove"]("b-focus-trapped"),i.focusTrapListener=(t=i.focusTrapListener)===null||t===void 0?void 0:t.call(i),e&&(i.focusTrapListener=z.on({element:i.element,focusin:"onFocusTrapped",delegate:".b-focus-trap",thisObj:i}),i.treeWalker||(i.treeWalker=this.setupTreeWalker(i.element,v.NodeFilter.SHOW_ELEMENT,Iu)))}setupTreeWalker(e,t,i){return document.createTreeWalker(e,t,i)}onFocusTrapped(e){const t=this,i=t.treeWalker;if(e.target===t.bottomFocusTrap)i.currentNode=t.topFocusTrap,i.nextNode();else if(e.target===t.topFocusTrap)i.currentNode=t.bottomFocusTrap,i.previousNode();else return;t.requestAnimationFrame(()=>i.currentNode.focus())}get focusElement(){return this.hasItems&&(super.focusElement||this.element)}get contentElement(){return this.element&&this.bodyElement}get widgetClassList(){const e=this,t=super.widgetClassList;if(e.hasHeader){var i;t.push("b-panel-has-header",`b-header-dock-${((i=e.header)===null||i===void 0?void 0:i.dock)||"top"}`)}return e.tbar&&t.push("b-panel-has-top-toolbar"),e.bbar&&t.push("b-panel-has-bottom-toolbar"),t}}dt.initClass(),dt._$name="Panel";class Fe extends dt{static get $name(){return"Popup"}static get type(){return"popup"}static get configurable(){return{autoShow:!0,autoClose:!0,showOnClick:!1,forElement:null,monitorResize:!0,floating:!0,hidden:!0,axisLock:!0,hideAnimation:{opacity:{from:1,to:0,duration:".3s",delay:"0s"}},showAnimation:{opacity:{from:0,to:1,duration:".4s",delay:"0s"}},stripDefaults:{bbar:{layout:{justify:"flex-end"}}},testConfig:{hideAnimation:null,showAnimation:null},closeAction:"hide",trapFocus:!0,focusOnToFront:!0,closable:null,maximizable:null,modal:null,maximized:null,tools:{close:{cls:"b-popup-close",handler:"close",weight:-1e3,ariaLabel:"L{Popup.close}",hidden:!0},maximize:{cls:"b-popup-expand",handler:"toggleMaximized",weight:-999,hidden:!0}},highlightReturnedFocus:!0,role:"dialog"}}finalizeInit(){const e=this,{forElement:t}=e;e.anchoredTo=t,e.initialAnchor=e.anchor,t&&e.showOnClick&&(e.initialConfig.autoShow||(e.autoShow=!1),z.on({element:t,click:"onElementUserAction",thisObj:e})),super.finalizeInit(),e.autoShow&&(!t||v.isVisible(t))&&(e.autoShow===!0?e.show():e.setTimeout(()=>e.show(),e.autoShow))}onPaint({firstPaint:e}){var t;(t=super.onPaint)===null||t===void 0||t.call(this,...arguments);const i=this;e&&i.headerElement&&z.on({element:i.headerElement,dblclick:i.onHeaderDblClick,thisObj:i})}doDestroy(){this.syncModalMask(),super.doDestroy()}compose(){const{hasNoChildren:e,textContent:t}=this;return{class:{"b-text-popup":!!(t&&e)}}}close(){const e=this;if(!e._hidden&&e.trigger("beforeClose")!==!1||e._hidden&&e.closeAction==="destroy")return e.modal&&e.closeAction==="destroy"&&e.revertFocus(),e.unmask(),e.containsFocus&&e.highlightReturnedFocus&&e.setTimeout(()=>e.element.classList.add("b-using-keyboard"),0),e[e.closeAction]()}toggleMaximized(){this.maximized=!this.maximized}updateMaximized(e){v.toggleClasses(this.element,["b-maximized"],e)}onInternalKeyDown(e){const t=this;e.key==="Escape"&&(e.stopImmediatePropagation(),t.floating||t.positioned?t.close(!0):t.collapsible&&(t.revealed?t.collapsible.toggleReveal():t.collapse()))}onDocumentMouseDown({event:e}){const t=this,{owner:i}=t,{target:r}=e;if(e.type!=="touchend"&&i!==null&&i!==void 0&&i.isButton&&i._menu===t&&i.element.contains(r))return e.preventDefault(),!1;t.modal&&r===Fe.modalMask?(e.preventDefault(),t.modal.closeOnMaskTap?t.close():t.containsFocus||t.focus()):!t.owns(r)&&t.autoClose&&!t.containsFocus&&t.close()}get isTopModal(){return v.isVisible(Fe.modalMask)&&this.element.previousElementSibling===Fe.modalMask}onFocusIn(e){const t=v.getActiveElement(this);super.onFocusIn(e),v.getActiveElement(this)===t&&e.target===this.element&&this.focus()}onFocusOut(e){!(globalThis.visualViewport&&globalThis.visualViewport.height<document.documentElement.clientHeight-1)&&!this.modal&&this.autoClose&&this.close(),super.onFocusOut(e)}onShow(){var e;const t=this;t.autoClose&&t.addDocumentMouseDownListener(),t.focusOnToFront&&t.focus(),(e=super.onShow)===null||e===void 0||e.call(this),t.syncModalMask()}addDocumentMouseDownListener(){this.mouseDownRemover||(this.mouseDownRemover=ae.ion({globaltap:"onDocumentMouseDown",thisObj:this}))}updateModal(e){e&&(this.floating=!0)}syncModalMask(){const e=this,{modal:t,element:i}=e;if(i.setAttribute("aria-modal",!!t),t&&e.isVisible)typeof e._x!="number"&&typeof e._y!="number"&&(e.centered=!0,e.anchor=!1),e.modalMask.classList.remove("b-hide-display"),i.classList.add("b-modal");else if(e.isPainted){i.classList.remove("b-modal");const r=e.floatRoot.querySelectorAll(".b-modal"),s=r.length?Fe.fromElement(r[r.length-1],"popup"):null;s?s.syncModalMask():Fe.modalMask.classList.add("b-hide-display")}}onHide(){var e,t;const i=this;(e=i.mouseDownRemover)===null||e===void 0||e.call(i),i.mouseDownRemover=null,(t=super.onHide)===null||t===void 0||t.call(this),i.syncModalMask()}onElementUserAction(){this.show()}onHeaderDblClick(){this.maximizable&&this.toggleMaximized()}updateClosable(e){this.tools.close.hidden=!e}updateMaximizable(e){this.tools.maximize.hidden=!e}get modalMask(){const{modalMask:e}=Fe;return e.nextElementSibling!==this.element&&this.floatRoot.insertBefore(e,this.element),e}static get modalMask(){return this._modalMask||(this._modalMask=v.createElement({className:"b-modal-mask b-hide-display"}),z.on({element:this._modalMask,wheel:e=>e.preventDefault()})),this._modalMask}}Fe.initClass(),Fe._$name="Popup";const Fu=/^b-icon-/,ku=/^b-fa-/;class ci extends M{static get $name(){return"MenuItem"}static get type(){return"menuitem"}static get configurable(){return{checked:null,separator:null,toggleGroup:null,menu:{value:null,$config:["lazy","nullify"]},icon:null,closeParent:null,href:null,target:null,localizableProperties:["text"],role:"menuitem",closeMenuDelay:200}}updateElement(e,t){const i=super.updateElement(e,t);return typeof this.checked=="boolean"&&(this.role="menuitemcheckbox"),this.ariaHasPopup=this.hasMenu?"menu":!1,i}compose(){var e;const t=this,{checked:i,href:r,hasMenu:s,separator:n,target:l,text:o,toggleGroup:a}=t,c=typeof i=="boolean",d=t.icon||(c?"b-fw-icon":""),f=`b-icon-${a?"radio-":""}`,g=typeof o=="object";return{tag:r?"a":"div",tabIndex:-1,href:r,target:l,class:{"b-has-submenu":s,"b-checked":i,"b-separator":n||((e=t.cls)===null||e===void 0?void 0:e["b-separator"])},dataset:{group:t.toggleGroup},[c?"aria-checked":""]:i,[s?"aria-expanded":""]:!1,children:{iconElement:d&&{"aria-hidden":!0,tag:"i",class:{"b-fa":ku.test(d),"b-icon":Fu.test(d),"b-menuitem-icon":1,[`${f}checked`]:i===!0,[`${f}unchecked`]:i===!1,...W.normalize(d,"object")}},textElement:{tag:"span",html:g?null:o,class:{"b-menu-text":1,"b-menu-custom-content":g},children:g?[o]:null},subMenuIcon:s&&{"aria-hidden":!0,tag:"i",class:{"b-fw-icon":1,"b-icon-sub-menu":1}}}}}doAction(e){const t=this,i=this.parent,r={menu:i,item:t,element:t.element,bubbles:!0,domEvent:e};if(typeof t.checked=="boolean"){const s=!t.checked;(!t.toggleGroup||s)&&(t.checked=!t.checked)}t.trigger("beforeItem",r),t.trigger("item",r),t.closeParent&&i&&(i.rootMenu.close(),e&&!t.href&&e.preventDefault())}get focusElement(){return this.element}get contentElement(){return this.textElement}get isFocusable(){const{focusElement:e}=this;return e&&this.isVisible&&(e===document.body||e.offsetParent)}get hasMenu(){return this.hasConfig("menu")}get childItems(){const{_menu:e}=this;return e?[e]:[]}get text(){return this.html}set text(e){this.html=e}onFocusIn(e){super.onFocusIn(e),!this.disabled&&this.menu&&this.delay("openMenu",200)}onFocusOut(e){this.clearTimeout("openMenu"),super.onFocusOut(e),this._menu&&(this.menu.closeTimer=this.menu.setTimeout(()=>this.closeMenu(),this.closeMenuDelay))}openMenu(e){const{menu:t}=this;!this.disabled&&t&&(t.focusOnToFront=e,t.show())}onChildShow(e){super.onChildShow(e),this.ariaElement.setAttribute("aria-expanded",!0)}closeMenu(){this._menu instanceof M&&this.menu.close()}onChildHide(e){super.onChildHide(e),this.ariaElement.setAttribute("aria-expanded",!1)}changeToggleGroup(e){return e&&typeof this.checked!="boolean"&&(this.checked=!1),e}changeChecked(e,t){if(this.isConfiguring||typeof t=="boolean")return!!e}updateChecked(e){const t=this;t.isConfiguring||(t.toggleGroup&&t.uncheckToggleGroupMembers(),t.element.setAttribute("aria-checked",e),t.trigger("toggle",{menu:t.owner,item:t,element:t.element,bubbles:!0,checked:e}))}getToggleGroupMembers(){const e=this,{checked:t,toggleGroup:i,element:r}=e,s=[];return t&&i&&v.forEachSelector(e.rootElement,`[data-group=${i}]`,n=>{if(n!==r){const l=M.fromElement(n);l&&s.push(l)}}),s}uncheckToggleGroupMembers(){this.checked&&this.toggleGroup&&this.getToggleGroupMembers().forEach(e=>e.checked=!1)}get closeParent(){return(typeof this.checked=="boolean"?this._closeParent:this._closeParent!==!1)&&!this.hasMenu}changeMenu(e,t){const i=this,{constrainTo:r,scrollAction:s}=i.owner;return e&&typeof e=="object"&&!("items"in e)&&!("widgets"in e)&&!("html"in e)&&(e={lazyItems:e}),Ft.reconfigure(t,e,{owner:i,defaults:{type:"menu",align:"s0-e0",anchor:!0,autoClose:!0,autoShow:!1,cls:"b-sub-menu",forElement:i.element,owner:i,ariaLabel:i.text,constrainTo:r,scrollAction:s}})}}ci.initClass(),ci._$name="MenuItem";const $u={ArrowUp:1,ArrowDown:1,ArrowRight:1,ArrowLeft:1,Enter:1,Escape:1};class Ft extends Fe{static get $name(){return"Menu"}static get type(){return"menu"}static get configurable(){return{layout:"vbox",focusable:!0,align:"t-b",scrollAction:"hide",focusOnHover:null,scrollable:!1,defaultType:"menuitem",tools:{close:!1},role:"menu",ariaElement:"bodyElement"}}construct(e){Array.isArray(e)&&(e={lazyItems:e}),super.construct(e),z.on({element:this.element,click:"onMouseClick",mouseover:"onMouseOver",mouseenter:"onMouseEnter",mouseleave:"onMouseLeave",thisObj:this})}afterShow(){const{items:e,element:t}=this;e.some(s=>!!s._menu)&&t.classList.add("b-menu-with-submenu"),e.some(s=>s.icon)&&t.classList.add("b-menu-with-icon"),super.afterShow(...arguments)}createWidget(e){return typeof e=="string"&&(e={text:e}),super.createWidget(e)}get focusElement(){var e;const t=this,i=(e=t.parentMenu)===null||e===void 0?void 0:e.element.contains(v.getActiveElement(t.parentMenu)),r=t.items[0];return i||v.usingKeyboard||!(r instanceof ci)?super.focusElement:t.element}onDocumentMouseDown({event:e}){if(!this.parentMenu||!this.parentMenu.owns(e.target))return super.onDocumentMouseDown(...arguments)}hide(e){const t=this;if(super.hide(e),!t.isVisible){var i,r;(i=t.currentSubMenu)===null||i===void 0||(r=i.hide)===null||r===void 0||r.call(i,e),t.parentMenu&&(t.parentMenu.currentSubMenu=null)}}show(){super.show(...arguments);const{parentMenu:e}=this;this.isVisible&&e&&(e.currentSubMenu=this)}onMouseClick(e){const t=e.target.closest(".b-menuitem");t&&this.triggerElement(t,e)}onMouseOver(e){if(this.focusOnHover!==!1){var t;const i=(t=e.relatedTarget)===null||t===void 0?void 0:t.closest(".b-widget"),r=e.target.closest(".b-widget"),s=M.fromElement(r);!v.isTouchEvent&&r&&r!==i&&s.parent===this&&this.setTimeout({fn:"handleMouseOver",delay:30,args:[s],cancelOutstanding:!0})}}handleMouseOver(e){e.focus()}onMouseEnter(){this.clearTimeout(this.closeTimer)}onMouseLeave(e){const t=this,{relatedTarget:i}=e,r=i&&t.owns(i);let s=i instanceof HTMLElement&&M.fromElement(i),n=!r;if(s){for(;s.ownerCmp;)s=s.ownerCmp;n&=!v.getAncestor(s.element,[e.target])}!r&&n&&(t.currentSubMenu&&!t.currentSubMenu.closeTimer&&t.currentSubMenu.hide(),t.element.contains(v.getActiveElement(t))&&v.getActiveElement(t).matches(".b-menuitem")&&t.focusElement.focus())}onInternalKeyDown(e){const t=M.fromElement(e),i=t&&t!==this&&!(t instanceof ci);if(e.key==="Escape"){(i?this:this.rootMenu).close();return}if(super.onInternalKeyDown(e),i)return;$u[e.key]&&e.preventDefault();const r=this.element,s=v.getActiveElement(r);this.navigateFrom(s!==r&&r.contains(s)?s:null,e.key,e)}navigateFrom(e,t,i){const r=this,{treeWalker:s}=r,n=e&&r.getItem(e),l=r.rtl?"ArrowLeft":"ArrowRight",o=r.rtl?"ArrowRight":"ArrowLeft";let a;switch(t){case"ArrowUp":s.currentNode=e||(e=r.bottomFocusTrap),s.previousNode(),a=s.currentNode;break;case"ArrowDown":s.currentNode=e||(e=r.topFocusTrap),s.nextNode(),a=s.currentNode;break;case" ":e&&!e.classList.contains("b-disabled")&&(n!=null&&n.menu?r.openSubMenu(e,n):r.triggerElement(e,i));break;case l:if(e&&n!==null&&n!==void 0&&n.menu&&!e.classList.contains("b-disabled")){const c=r.openSubMenu(e,n);c==null||c.focus()}else s.currentNode=e||(e=r.topFocusTrap),s.nextNode(),a=s.currentNode;break;case o:r.isSubMenu?r.hide():e||(s.currentNode=e||(e=r.topFocusTrap),s.nextNode(),a=s.currentNode);break;case"Enter":e&&!e.classList.contains("b-disabled")&&r.triggerElement(e,i);break}a&&(a===r.element?r.navigateFrom(r.bottomFocusTrap,"ArrowUp",i):a===e?r.navigateFrom(r.topFocusTrap,"ArrowDown",i):a.focus())}getItem(e){if(e!=null)return typeof e=="number"?this.items[e]:e.nodeType===Element.ELEMENT_NODE?M.fromElement(e,"menuitem",this.contentElement):this.items.find(t=>t.id==e)}triggerElement(e,t){const i=this.getItem(e);i&&!i.disabled&&i.doAction(t)}get isSubMenu(){var e;return this===((e=this.owner)===null||e===void 0?void 0:e.menu)}openSubMenu(e,t){const i=this,r=t.menu;if(r){if(!r.isVisible){var s;const n={item:t,element:e};if(i.trigger("beforeSubMenu",n)===!1||((s=t.onBeforeSubMenu)===null||s===void 0?void 0:s.call(t,n))===!1)return;r.show()}return i.currentSubMenu=r}}set selectedElement(e){const t=this,i=t._selectedElement;if(i){const r=t.getItem(i),s=r==null?void 0:r.menu;s==null||s.hide(),i.classList.remove("b-active")}if(t._selectedElement=e,e){const r=v.isFocusable(e);e.classList.add("b-active"),t.scrollable.scrollIntoView(e,{animate:!r,focus:r})}}get selectedElement(){return this._selectedElement}selectFirst(){const e=this.treeWalker;e.currentNode=this.topFocusTrap,e.nextNode(),this.requestAnimationFrame(()=>e.currentNode.focus())}get parentMenu(){var e;const t=this.owner;return t&&(t.isMenu?t:(e=t.up)===null||e===void 0?void 0:e.call(t,"menu"))}get rootMenu(){let e=this;for(;e.parentMenu instanceof this.constructor;)e=e.parentMenu;return e}}Ft.initClass(),Ft._$name="Menu";let Yi;class Xl extends xt{static get $name(){return"ContextMenuBase"}static get configurable(){return{type:null,menu:{$config:["lazy","nullify"],value:{type:"menu",autoShow:!1,closeAction:"hide",scrollAction:"hide",constrainTo:globalThis}},items:{},triggerEvent:!1,clickTriggerSelector:null,keyMap:{" ":{handler:"showContextMenuByKey",weight:100},"Ctrl+Space":"showContextMenuByKey"}}}static get pluginConfig(){return{assign:["showContextMenu"],chain:["onElementContextMenu","onElementClick","onElementDblClick"]}}construct(...e){var t;if(super.construct(...e),!((t=this.type)!==null&&t!==void 0&&t.length))throw new Error("Config 'type' is required to be specified for context menu")}onElementContextMenu(e){this.onElementEvent(e)}onElementClick(e){this.onElementEvent(e)}onElementDblClick(e){this.onElementEvent(e)}onElementEvent(e){if(!e.handled&&this.triggerEvent===e.type){if(e.ctrlKey===!0&&!B.isMac){e.preventDefault();return}const t=e;if(Yi){const{target:i}=Yi;e=z.fixEvent(new MouseEvent(e.type,e)),Object.defineProperty(e,"target",{get:()=>i,configurable:!0}),e.preventDefault=function(){t.preventDefault(),t.handled=!0}}this.internalShowContextMenu(e)}else e.type==="click"&&this.clickTriggerSelector&&e.target.matches(this.clickTriggerSelector)&&this.internalShowContextMenu(e)}showContextMenuByKey(e){if(!v.isEditable(e.target)){const t=this.getKeyboardContextMenuTarget(e.target);if(t)return Yi=e,v.triggerMouseEvent(t,this.triggerEvent),e.handled=!0,e.preventDefault(),e.stopImmediatePropagation(),Yi=null,!0}return!1}getKeyboardContextMenuTarget(e){const t=v.isInView(e);return e.children.length?v.childFromPoint(e,t.width/2,t.height/2):e}internalShowContextMenu(e){const t=this;if(t.disabled)return;const i=t.getDataFromEvent(e);!e.handled&&!e.defaultPrevented&&i&&t.shouldShowMenu(i)&&(e.type==="contextmenu"&&B.isSafari&&e.ctrlKey&&!e.metaKey&&z.on({element:e.target,capture:!0,once:!0,thisObj:this,click(r){r.preventDefault(),r.stopImmediatePropagation()}}),i.domEvent=e,t.showContextMenu(i))}getDataFromEvent(e){return{event:e,targetElement:this.getTargetElementFromEvent(e)}}getTargetElementFromEvent(e){return e.target}async showContextMenu(e,t){var i;const r=this,s=v.isDOMEvent(e),n=s?r.getDataFromEvent(e):e,l=s?e:n.domEvent;if((i=r._menu)===null||i===void 0||i.hide(),r.disabled)return;r.menuContext=n;const{type:o,client:a,processItems:c}=r,d=v.isInView(n.targetElement).center;if(F.assign(n,{feature:r,point:l!=null&&l.clientX?[l.clientX+1,l.clientY+1]:[d.x,d.y],menu:r,items:{},selection:a.selectedRecords}),r.callChainablePopulateMenuMethod(n),F.merge(n.items,r.baseItems),r.preventDefaultEvent(n),(!c||r.callback(c,a,[n])!==!1)&&r.hasActiveMenuItems(n)&&(r.populateItemsWithData(n),r.beforeContextMenuShow(n)!==!1)){const{menu:g}=r;let h=a.trigger(`${o}MenuBeforeShow`,n);if(w.isPromise(h)&&(l.handled=!0,h=await h),h!==!1){var f;g.items=n.items,g.showBy(t||{target:n.domEvent}),(f=r.touchMoveDetacher)===null||f===void 0||f.call(r),r.touchMoveDetacher=z.on({element:a.element,touchmove:()=>g.hide(),thisObj:g,once:!0}),l&&(l.preventDefault(),l.handled=!0)}}}get baseItems(){if(!this._baseItems){const e=this,{namedItems:t}=e,i=e._baseItems=F.assign({},e.items);for(const r in i){const s=i[r];s&&(t&&r in t?i[r]=typeof s=="object"?F.merge(F.clone(t[r]),s):t[r]:s===!0&&delete i[r])}}return this._baseItems}hideContextMenu(e){var t;(t=this.menu)===null||t===void 0||t.hide(e)}callChainablePopulateMenuMethod(e){var t,i;(t=(i=this.client)[`populate${k.capitalize(this.type)}Menu`])===null||t===void 0||t.call(i,e)}hasActiveMenuItems(e){return Object.values(e.items).some(t=>t&&!t.hidden)}shouldShowMenu(){return!0}beforeContextMenuShow(e){}populateItemsWithData(e){}preventDefaultEvent(e){var t;(t=e.event)===null||t===void 0||t.preventDefault()}changeTriggerEvent(e){return e||this.client.contextMenuTriggerEvent}changeMenu(e,t){const i=this,{client:r,type:s}=i;if(e)return Ft.reconfigure(t,e?Ft.mergeConfigs({owner:r,rootElement:r.rootElement,onItem(n){r.trigger(`${s}MenuItem`,n)},onToggle(n){r.trigger(`${s}MenuToggleItem`,n)},onDestroy(){i.menu=null},onBeforeItem(n){Object.assign(n,i.menuContext)},onShow({source:n}){i.menuContext.menu=n,r.trigger(`${s}MenuShow`,i.menuContext)}},e):null,i);t!=null&&t.isWidget&&t.destroy()}}Xl._$name="ContextMenuBase";const Jl=/>[ \t\r\n]+</g,Ru=/\s\s+/g;class ot{static tpl(e,...t){let i=0,r=t.map((s,n)=>{let l=e[n];return Array.isArray(s)?l+=s.reduce((o,a)=>o+=(typeof a=="string"?a.trim():a)+`
`,""):(s===void 0&&(s=""),l+=typeof s=="string"?s.trim():s),i++,l}).join("");return i<=e.length&&(r+=e[e.length-1]),r.replace(Jl,"><").replace(Ru," ").trim()}static docsTpl(e,...t){let i=0,r=t.map((s,n)=>{let l=e[n];return Array.isArray(s)?l+=s.reduce((o,a)=>o+=(typeof a=="string"?a.trim():a)+`
`,""):(s===void 0&&(s=""),l+=typeof s=="string"?s.trim():s),i++,l}).join("");return i<=e.length&&(r+=e[e.length-1]),r.replace(Jl,"><").trim()}static repeat(e){return function(...t){return ot.tpl(...t).repeat(e)}}static loop(e){}}ot._$name="TemplateHelper";class Pu extends Array{constructor(e,t){super(),this.timeZone=e,this.year=t}}class Au{constructor(e,t){this.asString=e,this.timeZone=t,this.asArray=Nu(e)}get asLocalDate(){return this._asLocalDate||(this._asLocalDate=new Date(...this.asArray)),this._asLocalDate}get asTicksUtc(){return this._asTicksUtc||(this._asTicksUtc=new Date(Date.UTC(...this.asArray)).getTime()),this._asTicksUtc}}const Zl=(u,e)=>{const t=u.toLocaleString("sv-SE",{timeZone:e});return new Au(t,e)},_u=(u,e)=>{const{asTicksUtc:t,asString:i}=Zl(new Date(u),e);return{offset:(u-t)/6e4,tzTicksUtc:t,tzString:i}},Nu=u=>{const e=u.split(/[\s-:]/).map(t=>t*1);return e[1]-=1,e},Vu=-6e4,zu=36e5,Ql=-864e5,ui=2592e6,eo=(u,e)=>{const t=to.get(u,e);if(t)return t;const i=new Pu(u,e),r=new Date(Date.UTC(e,0,1)).getTime();let s=r,n=ui,l=0,o=[],a=null,c,d,f,g;for(;!g;)({offset:f,tzTicksUtc:c,tzString:d}=_u(s,u)),a==null?(a=f,i.push({offset:f})):n>0&&f!==a?n=n===ui?Ql:Vu:n<0&&f===a&&(n===Ql?n=zu:(i.length===1?(i.push(o),a=o.offset):(i[0].startTicks=o.startTicks,i[0].startDateString=o.startDateString,g=!0),n=ui)),o={offset:f,startDateString:d,startTicks:c},n===ui&&(s=r,s+=l*ui,l+=1),s+=n,l>11&&(g=!0);return to.set(i),i},to={_cache:{},get(u,e){var t;return(t=this._cache[u])===null||t===void 0?void 0:t[e]},set(u){const{timeZone:e}=u,{_cache:t}=this;t[e]||(t[e]={}),t[e][u.year]=u}};class as{static get $name(){return"TimeZoneHelper"}static toTimeZone(e,t){if(typeof t=="number")return this.toUtcOffset(e,t);const i=Zl(e,t);return i.asArray[3]!==i.asLocalDate.getHours()&&console.warn("Incorrect time zone conversion due to local DST-switch detected"),i.asLocalDate}static fromTimeZone(e,t){if(typeof t=="number")return this.fromUtcOffset(e,t);const i=this.dateAsArray(e),r=eo(t,e.getUTCFullYear());let s=r[0].offset;if(r.length===2){const n=Date.UTC(...i);n>=r[1].startTicks&&n<r[0].startTicks&&(s=r[1].offset)}return i[4]+=s,new Date(Date.UTC(...i))}static toUtcOffset(e,t){const i=e.getTimezoneOffset()+t;return new Date(e.getTime()+i*60*1e3)}static fromUtcOffset(e,t){const i=-e.getTimezoneOffset()-t;return new Date(e.getTime()+i*60*1e3)}static dateAsArray(e){return[e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()]}}as.findOffsetDates=eo,as._$name="TimeZoneHelper";class Xe extends M{static get $name(){return"Toast"}static get type(){return"toast"}static get configurable(){return{testConfig:{destroyTimeout:1,timeout:1e3},floating:!0,timeout:2500,autoDestroy:null,destroyTimeout:200,showProgress:!0,color:null,bottomMargin:20}}compose(){const{appendTo:e,color:t,html:i,showProgress:r,style:s,timeout:n}=this;return{parent:e||this.floatRoot,class:{...W.normalize(t,"object"),"b-toast-hide":1},html:i,style:s,children:{progressElement:r&&{style:`animation-duration:${n/1e3}s;`,class:{"b-toast-progress":1}}},listeners:{click:"hide"}}}doDestroy(){this.untoast(),super.doDestroy()}get nextBottom(){const{bottomMargin:e,element:t}=this;return parseInt(t.style.bottom,10)+t.offsetHeight+e}async show(){var s;await super.show(...arguments);const e=this,{element:t}=e,{toasts:i}=Xe;if(!i.includes(e)){var r;t.style.bottom=((s=(r=i[0])===null||r===void 0?void 0:r.nextBottom)!=null?s:e.bottomMargin)+"px",i.unshift(e),t.getBoundingClientRect(),t.classList.remove("b-toast-hide"),e.timeout>0&&(e.hideTimeout=e.setTimeout("hide",e.timeout))}}async hide(){const e=this;e.untoast(),e.element.classList.add("b-toast-hide"),e.autoDestroy&&!e.destroyTimer&&(e.destroyTimer=e.setTimeout("destroy",e.destroyTimeout))}untoast(){const{toasts:e}=Xe;e.includes(this)&&e.splice(e.indexOf(this),1)}static hideAll(){Xe.toasts.slice().reverse().forEach(e=>e.hide())}static show(e){const t=Xe.new({autoDestroy:!0,rootElement:document.body},typeof e=="string"?{html:e}:e);return t.show(),t}}Xe.toasts=[],Xe.initClass(),Xe._$name="Toast";class kt extends $.mixin(Oe,Mt){static get $name(){return"Navigator"}static get type(){return"navigator"}static get configurable(){return{ownerCmp:null,itemsTabbable:null,target:null,keyEventTarget:null,processEvent:null,itemSelector:null,activeItem:null,focusCls:"b-active",keys:null,allowCtrlKey:null,allowShiftKey:null,scrollDuration:50,disabled:null,datasetIdProperty:"id",testConfig:{scrollDuration:1}}}static get factoryable(){return{defaultType:"navigator"}}get activeItem(){const{_activeItem:e}=this;if(this.target.contains(e))return e;this._activeItem=null}updateOwnerCmp(e){this.itemSelector||(this.itemSelector=`.${this.ownerCmp.itemCls}`),v.setAttributes(this.keyEventTarget,{"aria-activedescendant":`${this.owner.id}-active-descendant`})}set navigationEvent(e){const{owner:t}=this;this._navigationEvent=t.navigationEvent=e,e&&Promise.resolve(1).then(()=>this.navigationEvent=null)}get navigationEvent(){return this._navigationEvent}static getComposedKeyName(e){const t=(e.key||"").trim()||e.code;return`${e.ctrlKey?"CTRL+":""}${e.shiftKey?"SHIFT+":""}${e.altKey?"ALT+":""}${t}`}onKeyDown(e){const t=this,{ownerCmp:i,itemSelector:r,activeItem:s,itemsTabbable:n}=t,{target:l}=e,o=t.target.querySelector(r),a=(e.key||"").trim()||e.code,c=t.constructor.getComposedKeyName(e),d=l.matches(r)||l===t.keyEventTarget;if(!t.disabled&&t.processEvent&&(e=t.processEvent.call(i,e)),e&&!t.disabled&&o&&t.target.offsetParent&&d){if(!n){if(t.inlineFlow==null){const g=o.parentNode,h=v.getStyleValue(o,"position"),p=v.getStyleValue(o,"display"),m=v.getStyleValue(o,"float");t.inlineFlow=h==="absolute"||p==="inline"||p==="inline-block"||m==="left"||m==="right"||v.getStyleValue(g,"display")==="flex"&&v.getStyleValue(g,"flex-direction")==="row"}t.prevKey||(t.inlineFlow?(t.prevKey="ArrowLeft",t.nextKey="ArrowRight"):(t.prevKey="ArrowUp",t.nextKey="ArrowDown"))}if(t.navigationEvent=e,s)switch(a){case t.prevKey:if(t.disabled||e.ctrlKey&&!t.allowCtrlKey||e.shiftKey&&!t.allowShiftKey)return;e.preventDefault(),e.handled=!0,t.navigatePrevious(e);break;case t.nextKey:if(t.disabled||e.ctrlKey&&!t.allowCtrlKey||e.shiftKey&&!t.allowShiftKey)return;e.preventDefault(),e.handled=!0,t.navigateNext(e);break;default:{var f;const g=(f=t.keys)===null||f===void 0?void 0:f[c];if(g&&!t.disabled){if(t.callback(g,t.thisObj||i,[e])===!1)return}else i.onInternalKeyDown&&i.onInternalKeyDown(e);if(v.getActiveElement(l)!==l&&e.preventDefault(),n)return}}else{if(n)return;(a===t.nextKey||a===t.prevKey)&&(t.activeItem=t.getDefaultNavigationItem(e))}t.activeItem!==s&&t.triggerNavigate(e)}}getDefaultNavigationItem(e){const{target:t,itemSelector:i,prevKey:r,nextKey:s}=this;if(t.compareDocumentPosition(e.target)&4&&e.key===r)return t.querySelector(`${i}:last-of-type`);if(t.compareDocumentPosition(e.target)&2&&e.key===s)return t.querySelector(`${i}`)}navigatePrevious(e){const t=this,i=t.previous;e.preventDefault(),i&&t.ownerCmp.scrollable.scrollIntoView(i,{animate:t.scrollDuration}).then(()=>{t.activeItem=i,t.triggerNavigate(e)})}navigateNext(e){const t=this,i=t.next;e.preventDefault(),i&&t.ownerCmp.scrollable.scrollIntoView(i,{animate:t.scrollDuration}).then(()=>{t.activeItem=i,t.triggerNavigate(e)})}get owner(){return this.ownerCmp}get previous(){return this.getAdjacent(-1)}get next(){return this.getAdjacent(1)}getAdjacent(e=1,t=this.activeItem){const i=this.treeWalker;if(i.currentNode=t,i[e<0?"previousNode":"nextNode"](),i.currentNode!==this.activeItem)return i.currentNode}onTargetFocusIn(e){const t=this,{target:i,relatedTarget:r}=e,{owner:s,itemsTabbable:n,skipScrollIntoView:l,previousActiveItem:o}=t;if(!i.matches(".b-focus-trap")){if(i.matches(t.itemSelector))t.skipScrollIntoView=!0,t.activeItem=i,t.skipScrollIntoView=l,t.activeItem&&n&&t.triggerNavigate(e);else if(i===t.target)if((r?i.compareDocumentPosition(r):0)&Node.DOCUMENT_POSITION_CONTAINED_BY){var a;(a=s.previousSibling)===null||a===void 0||a.focus()}else t.activeItem=o&&t.target.contains(o)?o:0}}onTargetFocusOut(e){const t=this,{relatedTarget:i}=e;i!=null&&i.matches(".b-focus-trap")||(!i||!t.target.contains(i)||!i.matches(t.itemSelector))&&t.activeItem&&(t.activeItem=null,t.itemsTabbable&&t.triggerNavigate(e))}onTargetMouseDown(e){const t=this,i=e.target.closest(t.itemSelector);t.navigationEvent=e,t.itemsTabbable?i===t.activeItem&&t.triggerNavigate(e):t.ownerCmp.itemsFocusable===!1?t.onFocusGesture(e):i&&(e.preventDefault(),v.focusWithoutScrolling(i))}onTargetClick(e){var t;const i=this,{skipScrollIntoView:r}=i;if(i.skipNextClick||(t=i.navigationEvent)!==null&&t!==void 0&&t.ignoreNavigation){i.skipNextClick=!1;return}i.disabled||(i.skipScrollIntoView=!0,i.processEvent&&(e=i.processEvent.call(i.ownerCmp,e)),e&&(i.activeItem=e.target.closest(i.itemSelector),i.triggerNavigate(e)),i.skipScrollIntoView=r)}onFocusGesture(e){(e.target===this.ownerCmp.contentElement||e.target.closest(this.itemSelector)&&this.ownerCmp.itemsFocusable===!1)&&e.preventDefault()}acceptNode(e){return e.offsetParent&&e.matches&&e.matches(this.itemSelector)?v.NodeFilter.FILTER_ACCEPT:v.NodeFilter.FILTER_SKIP}changeActiveItem(e){return e!=null&&this.ownerCmp.getItem&&(e=this.ownerCmp.getItem(e)),e}updateActiveItem(e,t){const i=this,{ownerCmp:r}=i,s=t&&i.target.contains(t),n=e&&v.isFocusable(e)&&e!==v.getActiveElement(e);if(s&&(i.previousActiveItem=t),t&&(t.classList.remove(i.focusCls),t.removeAttribute("id")),e!=null){if(i.skipScrollIntoView)n&&v.focusWithoutScrolling(e);else{var l;(l=r.scrollable)===null||l===void 0||l.scrollIntoView(e,{block:"nearest",focus:n,silent:i.scrollSilently})}if(e===t&&s)return;e.classList.add(i.focusCls),e.id=`${i.owner.id}-active-descendant`,i._activeItem=e}else i._activeItem=null,t===v.getActiveElement(t)&&r.revertFocus()}updateTarget(e,t){const i=this,r={element:e,thisObj:i,focusin:"onTargetFocusIn",focusout:"onTargetFocusOut",mousedown:{handler:"onTargetMouseDown",delegate:i.itemSelector}};!i.itemsTabbable&&!i.itemsFocusable&&(r.click="onTargetClick"),Object.prototype.hasOwnProperty.call(i,"acceptNode")||(i.acceptNode=i.acceptNode.bind(i),i.acceptNode.acceptNode=i.acceptNode),z.on(r),i.treeWalker=i.setupTreeWalker(e,v.NodeFilter.SHOW_ELEMENT,i.acceptNode),i.keyEventTarget||(i.keyEventTarget=e),(i.targetMutationMonitor=new MutationObserver(i.onTargetChildListChange.bind(i))).observe(e,{childList:!0,subtree:!0})}setupTreeWalker(e,t,i){return document.createTreeWalker(e,t,i)}onTargetChildListChange(){const e=this,{activeItem:t,datasetIdProperty:i}=e;if(t)if(e.target.contains(t))t.classList.contains(e.focusCls)||t.classList.add(e.focusCls);else{var r;e.activeItem=e.target.querySelector(`${e.itemSelector}.${e.focusCls}[data-${k.hyphenate(i)}="${t.dataset[i]}"]`)||((r=e.target.querySelector(`${e.itemSelector}.${e.focusCls}`))===null||r===void 0?void 0:r[t.dataset.index])||null}}changeKeyEventTarget(e){this._keyEventTarget=e,z.on({element:e,keydown:"onKeyDown",thisObj:this})}triggerNavigate(e,t=this.activeItem){var i;const r={event:e,item:t,oldItem:this.previousActiveItem};this.trigger("navigate",r),(i=this.ownerCmp)===null||i===void 0||i.trigger("navigate",r)}}kt._$name="Navigator";var Bu=u=>{var e;return e=class extends u{static get configurable(){return{loadMaskDefaults:{useTransition:!0,showDelay:1e3},loadMaskError:{icon:"b-icon b-icon-warning",autoClose:3e3,showDelay:0},loadMask:{text:"L{GridBase.loadMask}"},syncMask:{text:"L{GridBase.syncMask}"},localizableProperties:["loadMask.text","syncMask.text"],testConfig:{loadMaskError:{icon:"b-icon b-icon-warning",autoClose:500,showDelay:0}}}}applyLoadMask(){const i=this,{loadMask:r}=i;return r&&(i.masked=xe.mergeConfigs(i.loadMaskDefaults,r)),i.masked}applyMaskError(i){const{loadMaskError:r,masked:s}=this;return r===!1?s.hide():s&&(w.assign(s.errorDefaults,r),s.error=i),s}get widgetClass(){}},R(e,"$name","LoadMaskable"),e};const Gi=60*1e3,Ct=60*Gi,Ke=24*Ct,ju=/(\d+)?:?(\d*)/;class be{static format(e){const t=Math.floor(e/Ct),i=Math.floor(e/Gi)%60;return`${t}:${i<10?"0":""}${i}`}static parse(e){const t=typeof e;if(t==="string"){const i=ju.exec(e);e=Number(i[1]||0)*Ct+Number(i[2]||0)*Gi}else t!=="number"?e=N.getTimeOfDay(e):e<=24&&(e*=Ct);return Math.min(Math.max(Math.floor(e),0),Ke)}constructor(e){let t=0,i,r;e!=null&&e.isDayView?(t=e.dayStartShift,i=e.dayStartTime,r=e.dayEndTime):typeof e=="number"?t=i=r=e:e&&(t=e.startShift,i=e.timeStart,r=e.timeEnd),this.startShift=t=be.parse(t||0),this.timeEnd=(r==null?(t+Ke)%Ke:be.parse(r))||Ke,this.timeStart=i==null?t:be.parse(i)}get startHour(){return Math.floor(this.timeStart/Ct)}get endHour(){return Math.floor(this.timeEnd/Ct)}get startTimeOffsetMs(){const{startShift:e,timeStart:t}=this;return t<e?Ke-e+t:t-e}get today(){return this.startOfDay(new Date)}ceil(e){const t=this.startOfDay(e);return t<e&&t.setDate(t.getDate()+1),t}contains(e){return!this.outside(e)}dateKey(e){return e=this.shiftDate(e,-1),N.makeKey(e)}dayOfDate(e){return this.shiftDate(N.clearTime(e))}dayOfWeek(e){return e=this.shiftDate(e,-1),e.getDay()}delta(e,t="ms"){const{timeStart:i}=this,r=be.parse(e),s=(this.startShift&&r<i?r+Ke:r)-i;return t==="ms"?s:N.as(t,s,"ms")}duration(e="ms"){const{timeStart:t,timeEnd:i}=this,r=t<i?i-t:Ke-t+i;return e==="ms"?r:N.as(e,r,"ms")}equals(e){return this.startShift===(e==null?void 0:e.startShift)&&this.timeStart===e.timeStart&&this.timeEnd===e.timeEnd}intersects(e,t){const i=this,{timeStart:r,timeEnd:s}=i,[n,l]=i._dateRangeArgs(e,t),[o,a]=i.timeRange(n,l);return r<s?o<a?o<s&&r<=a:o<s||r<=a:!(o<a)||o<s||r<=a}isIntraDay(e,t){const i=this,[r,s]=i._dateRangeArgs(e,t),n=i.startOfDay(r),l=Ke-N.diff(n,s,"ms");return l<0?!1:l>0||n<r}isInterDay(e){return e.allDay||!this.isIntraDay(...arguments)}outside(e){const{startShift:t,timeStart:i,timeEnd:r}=this,s=be.parse(e);return i<r?s<i?s<t?1:-1:s<r?0:s<t?-1:1:s<r||s>=i?0:s<t?1:-1}parseKey(e){return this.dayOfDate(N.parseKey(e))}shiftDate(e,t=1){const{startShift:i}=this,r=typeof e;return e=r==="number"?new Date(e):r==="string"?N.parse(e):new Date(e.getTime()),t&&i&&e.setMilliseconds(t>0?i:-i),e}sortEvents(e,t){const i=this.startOfDay(e);return t==null?void 0:t.sort((r,s)=>{r=r.eventRecord||r,s=s.eventRecord||s;let{startDate:n}=r,{startDate:l}=s;return n?l?(n=n<i?i:n,l=l<i?i:l,n-l||s.endDate-l-(r.endDate-n)):1:-1})}startOfDay(e){return e=this.shiftDate(e,-1),e=N.clearTime(e),e=this.shiftDate(e),e}timeRange(e,t){const[i,r]=this._dateRangeArgs(e,t);return[N.getTimeOfDay(i),N.getTimeOfDay(r)]}toString(){const{startShift:e,timeEnd:t,timeStart:i}=this,r=e?`@${be.format(e)}`:"",s=be.format(i);return i===t?e?r:s:`${s}-${be.format(t)}${r}`}_dateRangeArgs(e,t){return e.isModel?[e.startDate,e.endingDate]:[e,t]}}be.MIDNIGHT=new be({startShift:0,timeStart:0,timeEnd:24}),be.MILLIS_PER_MINUTE=Gi,be.MILLIS_PER_HOUR=Ct,be.MILLIS_PER_DAY=Ke,be._$name="DayTime";class io extends rt($){static get configurable(){return{element:null,zoneWidth:50,scrollSpeed:5,direction:"both",startScrollDelay:500,stopScrollWhenPointerOut:!1,testConfig:{scrollSpeed:2,startScrollDelay:100},activeScroll:{$config:["lazy"],value:{}},monitoring:{$config:["lazy","nullify"],value:!0},owner:null}}changeMonitoring(e,t){return t==null||t.clear(),new Map}doDestroy(){this.stopMonitoring(),super.doDestroy()}get isScrolling(){return Object.keys(this.activeScroll).length!==0}get rtl(){var e;return(e=this.owner)===null||e===void 0?void 0:e.rtl}startMonitoring(e={}){const t=this,{element:i,direction:r}=t,{scrollables:s=[],direction:n=r,callback:l}=e,o=[];return s.length||s.push({element:i}),s.forEach(a=>{const c=a.element;typeof c=="string"?v.forEachSelector(i,c,d=>{t.createMonitor(d,a.direction||n,a.callback||l),o.push(d)}):(t.createMonitor(c,a.direction||n,a.callback||l),o.push(c))}),function(){var c;(c=t.stopMonitoring)===null||c===void 0||c.call(t,o)}}createMonitor(e,t,i){const{monitoring:r}=this;r.has(e)||r.set(e,new Hu({scrollManager:this,element:e,direction:t,callback:i}))}stopMonitoring(e){const t=this,{monitoring:i}=t;if(e=j.asArray(e),i){if(!e){i.forEach(r=>t.stopMonitoring(r.element));return}e.forEach(r=>{const s=i.get(r);r.classList.remove("b-scrolling"),s&&(s.destroy(),i.delete(r))})}}requestScroll(e,t){const{activeScroll:i}=this;return e in i&&i[e]!==t?!1:(i[e]=t,!0)}releaseScroll(e){const{activeScroll:t={}}=this;Object.keys(t).forEach(i=>{t[i]===e&&delete t[i]})}getRelativeScroll(e,t="left"){let i=0;return this.monitoring.forEach((r,s)=>{v.isDescendant(s,e)&&(i+=t==="left"?r.scrollRelativeLeft:r.scrollRelativeTop)}),i}}class Hu extends ${construct(e){const t=this,{element:i}=e,r=i.scrollLeft,s=i.scrollTop;Object.assign(e,{startScrollLeft:r,startScrollTop:s}),super.construct(e),z.on({element:i,scroll:"onElementScroll",pointermove:"onMouseMove",capture:!0,thisObj:t}),z.on({element:i,pointerleave:"onPointerLeave",thisObj:t})}doDestroy(){this.stopScroll(),super.doDestroy()}startScroll(){const e=this;e.pendingScrollFinalize&&(e.scrollManager.releaseScroll(e),e.pendingScrollFinalize=!1),e.scrolling=!0,e.performScroll()}stopScroll(e=null){const t=this,i=()=>{t.pendingScrollFinalize=!1,t.isDestroyed||(t.scrollManager.releaseScroll(t),t.scrolling=!1)};t.scrollRequested&&(t.scrollManager.cancelAnimationFrame(t.frameId),t.scrollRequested=!1),t.scrollManager.clearTimeout(t.scrollTimeout),t.scrollTimeout=null,!e&&(t.ongoingScrollTop||t.ongoingScrollLeft)?(t.pendingScrollFinalize=!0,Promise.all([t.ongoingScrollTop,t.ongoingScrollLeft].filter(Boolean)).then(()=>t.pendingScrollFinalize&&i())):(t.ongoingScrollTop=t.ongoingScrollLeft=null,i())}onPointerLeave(){this.scrollManager.stopScrollWhenPointerOut&&this.stopScroll()}onMouseMove(e){const t=this,{scrollManager:i}=t,r=t.element.getBoundingClientRect(),s=i.zoneWidth,n=i.scrollSpeed;if(t.scrollDeltaX=t.scrollDeltaY=0,t.direction!=="vertical"){const{scrollLeft:l,scrollWidth:o,clientWidth:a}=t.element;i.rtl?e.clientX<r.left+s&&o+l-a>=1?t.scrollDeltaX=-Math.round((s+(r.left-e.clientX))/n)-1:e.clientX>r.right-s&&l<0&&(t.scrollDeltaX=Math.round((s-(r.right-e.clientX))/n)+1):e.clientX>r.right-s&&o-l-a>=1?t.scrollDeltaX=Math.round((s-(r.right-e.clientX))/n)+1:e.clientX<r.left+s&&l>0&&(t.scrollDeltaX=-Math.round((s+(r.left-e.clientX))/n)-1)}if(t.direction!=="horizontal"){const{scrollTop:l,scrollHeight:o,clientHeight:a}=t.element;e.clientY>r.bottom-s&&o-l-a>=1?t.scrollDeltaY=Math.round((s-(r.bottom-e.clientY))/n)+1:e.clientY<r.top+s&&l>0&&(t.scrollDeltaY=-Math.round((s+(r.top-e.clientY))/n)-1)}t.scrollDeltaX!==0&&!i.requestScroll("horizontal",t)&&(t.scrollDeltaX=0),t.scrollDeltaY!==0&&!i.requestScroll("vertical",t)&&(t.scrollDeltaY=0),t.scrollDeltaX===0&&t.scrollDeltaY===0?t.scrolling&&t.stopScroll():t.scrollTimeout||(t.scrollTimeout=i.setTimeout(()=>t.startScroll(),i.startScrollDelay))}performScroll(){const e=this,{element:t}=e;if(e.scrolling&&!e.scrollRequested){if(e.scrollDeltaX!==0){const i=t.scrollLeft,r=Math.min(i+e.scrollDeltaX,t.scrollWidth-t.clientWidth);t.scrollLeft=r,t.scrollLeft!==i?e.ongoingScrollLeft=new Promise(s=>t.addEventListener("scroll",s,{once:!0})):(e.ongoingScrollLeft=null,e.scrollDeltaX=0)}if(e.scrollDeltaY!==0){const i=t.scrollTop,r=Math.min(i+e.scrollDeltaY,t.scrollHeight-t.clientHeight);t.scrollTop=r,t.scrollTop!==i?e.ongoingScrollTop=new Promise(s=>t.addEventListener("scroll",s,{once:!0})):(e.ongoingScrollTop=null,e.scrollDeltaY=0)}e.scrollDeltaX!==0||e.scrollDeltaY!==0?(e.scrollRequested=!0,e.frameId=e.scrollManager.requestAnimationFrame(()=>{e.scrollRequested=!1,e.performScroll(e)})):e.stopScroll()}}onElementScroll(){var e,t;(e=this.config)===null||e===void 0||(t=e.callback)===null||t===void 0||t.call(this.thisObj||this.scrollManager,this)}get scrollLeft(){return this.element.scrollLeft}get scrollTop(){return this.verticalElement?this.verticalElement.scrollTop:this.element.scrollTop}get scrollRelativeLeft(){return this.scrollLeft-this.startScrollLeft}get scrollRelativeTop(){return this.scrollTop-this.startScrollTop}getRelativeLeftScroll(e){return this.scrollManager.getRelativeScroll(e,"left")}getRelativeTopScroll(e){return this.scrollManager.getRelativeScroll(e,"top")}}io._$name="ScrollManager";const Wu={left:!0,right:!0,top:!0,bottom:!0,transform:!0},Uu={true:1,false:1},qu=Promise.resolve();class Ce extends Fe{static get $name(){return"Tooltip"}static get type(){return"tooltip"}static get configurable(){return{mouseOffsetX:15,mouseOffsetY:15,html:{$config:{equals:()=>!1}},getHtml:null,forElement:null,trackMouse:null,updateContentOnMouseMove:!1,forSelector:null,hideOnDelegateChange:null,anchorToTarget:!0,showOnHover:!1,hoverDelay:500,autoShow:!1,dismissDelay:0,hideDelay:500,loadingMsg:"Loading...",allowOver:null,anchor:!0,align:{align:"b-t",minHeight:300},axisLock:!0,activeTarget:null,testConfig:{hideDelay:100,hoverDelay:100,showAnimation:null,hideAnimation:null}}}afterConfigure(){const e=this,{forSelector:t}=e;t&&(e.showOnHover=!0,e.forElement||(e.anchorToTarget||(e.trackMouse=!0),e.forElement=e.rootElement.host||e.rootElement)),super.afterConfigure(),e.forElement&&e.showOnHover&&(e.pointerOverOutDetacher=z.on({element:e.forElement,pointerover:"internalOnPointerOver",pointerout:"internalOnPointerOut",thisObj:e}))}doDestroy(){var e;(e=this.pointerOverOutDetacher)===null||e===void 0||e.call(this),super.doDestroy()}set focusOnToFront(e){super.focusOnToFront=e}get focusOnToFront(){return super.focusOnToFront&&v.usingKeyboard}get focusElement(){const e=super.focusElement;if(e!==this.element)return e}get anchorToTarget(){return this._anchorToTarget&&!this.trackMouse}get anchor(){return super.anchor&&!this.trackMouse}set anchor(e){super.anchor=e}onDocumentMouseDown({event:e}){const t=this,{triggeredByEvent:i}=t;i&&v.isTouchEvent&&e.pageX===i.pageX&&e.pageY===i.pageY&&t.activeTarget.contains(e.target)&&performance.now()-i.timeStamp<500||(t.abortDelayedShow(),super.onDocumentMouseDown({event:e}))}internalOnPointerOver(e){const t=this,{target:i,relatedTarget:r}=e,{forElement:s,forSelector:n,activeTarget:l}=t;let o;if(!(t.disabled||t.owner&&!t.owner.showTooltipWhenDisabled&&t.owner.disabled)&&!(t.allowOver&&t.element.contains(i))){if(n){if(o=t.filterTarget(i),l!=null&&l.contains(i)&&l.contains(r)&&o===l||o&&(r==null?void 0:r.closest(n))===o)return}else if(!s.contains(r))o=s;else return;o?t.handleForElementOver(e,o):l&&t.handleForElementOut()}}filterTarget(e){return e.closest(this.forSelector)}onTransitionEnd(e){const t=this,{currentOverElement:i}=Ce;if(Wu[e.propertyName]){var r;if(t.allowOver&&t.element.contains(i))return;(r=t.activeTarget)!==null&&r!==void 0&&r.contains(i)&&!t.trackMouse&&t.realign()}}async handleForElementOver(e,t){const i=this,{activeTarget:r,hideOnDelegateChange:s,anchorToTarget:n}=i,l=t!==r,o=l&&s;if(i.trigger("pointerOver",{event:e,target:t})===!1)i.internalOnPointerOut(e);else{if(i.triggeredByEvent=e,i.hasTimeout("hide")&&(i.abortDelayedHide(),!l))return;if(!s&&i.element.classList.contains("b-hiding")&&i.cancelHideShowAnimation(),!i._hidden&&o&&i.hide(!1),i.activeTarget=t,i.isVisible){const a=i.updateContent();if(F.isPromise(a)&&!i.loadingMsg&&await a,i.trigger("beforeShow")===!1)return i.hide();i.alignTo({[n?"target":"position"]:n?t:"mouse",overlap:!(n&&i.anchor)}),i.trigger("show"),i.afterShowByTarget()}else i.delayShow(t)}}async delayShow(e){var t;const i=this;if((t=i.currentAnimation)!==null&&t!==void 0&&t.showing&&i.cancelHideShowAnimation(),!i.isVisible&&!i.hasTimeout("show"))if(!i.hoverDelay||i.forSelector&&Date.now()-i.lastHidden<i.quickShowInterval){const r=i.updateContent();F.isPromise(r)&&!i.loadingMsg&&await r,i.showByTarget(e)}else i.addDocumentMouseDownListener(),!i.listeningForMouseMove&&!i.anchorToTarget&&(i.mouseMoveRemover=z.on({element:i.rootElement,mousemove:"onMouseMove",thisObj:i})),i.setTimeout(async()=>{if(e.isConnected){const r=i.updateContent();F.isPromise(r)&&!i.loadingMsg&&await r,i.showByTarget(e)}},!i.triggeredByEvent||i.triggeredByEvent.type==="pointerover"?i.hoverDelay:0,"show");else i.isVisible&&i.showByTarget(e)}changeAllowOver(e){return this.inAfterShow||(this.configuredAllowOver=e),e}updateAllowOver(e){const t=this,{element:i}=t;if(i.classList.toggle("b-allow-over",!!e),e)t.allowOverlisteners=z.on({element:i,mouseenter:"onOwnElementMouseEnter",mouseleave:"internalOnPointerOut",thisObj:t});else{var r;(r=t.allowOverlisteners)===null||r===void 0||r.call(t)}}updateContent(){const e=this;if(e.getHtml){const t=e.callback(e.getHtml,e,[{tip:e,element:e.element,activeTarget:e.activeTarget,event:e.triggeredByEvent}]);return e.html=t,t}}get hasContent(){return!!(v.isReactElement(this._html)||this._html!==""&&typeof this.html=="string"&&this.html.length||this.items.length)}internalBeforeShow(){return(this.updateContentOnMouseMove||this.hasContent)&&!this.disabled}showAsyncMessage(e=this.optionalL(this.loadingMsg)){e&&(this.html=`
                <div class="b-tooltip-loading">
                    <i class="b-icon b-icon-spinner"></i>
                    ${e}
                </div>
            `)}showByTarget(e){var t;const i=this,{anchorToTarget:r}=i;i.mouseMoveRemover=(t=i.mouseMoveRemover)===null||t===void 0?void 0:t.call(i),i.showBy({[r?"target":"position"]:r?e:"mouse",overlap:!(r&&i.anchor)})}afterShowByTarget(){const e=this,{dismissDelay:t}=e;e.abortDelayedShow(),t&&e.setTimeout("hide",t),e.element.parentNode&&e.toFront(),!e.mouseMoveRemover&&(e.trackMouse||e.updateContentOnMouseMove)&&(e.mouseMoveRemover=z.on({element:e.rootElement,pointermove:"onMouseMove",thisObj:e})),e.inAfterShow=!0,e.allowOver=e.allowOver||e.configuredAllowOver!=!1&&e.childItems.some(i=>i.isVisible&&!i.disabled&&i.focusElement),e.inAfterShow=!1}updateActiveTarget(e,t){e&&!this.isConfiguring&&this.trigger("overTarget",{newTarget:e,lastTarget:t})}internalOnPointerOut(e){var t;const i=this,r=e.relatedTarget;i.allowOver&&i.element.contains(r)||i.element.contains(e.target)&&(t=i.activeTarget)!==null&&t!==void 0&&t.contains(r)||i.activeTarget&&!i.activeTarget.contains(r)&&i.handleForElementOut()}handleForElementOut(){const e=this,{hideDelay:t}=e;if(e.trigger("pointerOut")===!1){e.activeTarget=null;return}e.abortDelayedShow(),e.isVisible&&t!==!1&&(e.abortDelayedHide(),t>0?e.setTimeout("hide",t):e.hide())}show(e){const t=this;!e&&t.forElement&&t.anchorToTarget&&!t.forSelector?t.showByTarget(t.forElement):super.show(...arguments),t.isVisible&&(t.afterShowByTarget(),t.forElement&&!t.transitionEndDetacher&&!t._hidden&&(t.transitionEndDetacher=z.on({element:t.forElement,transitionend:"onTransitionEnd",thisObj:t})))}hide(){const e=this;if(e.abortDelayedShow(),e._hidden)return qu;{var t,i;e.abortDelayedHide();const r=super.hide(...arguments);return e.lastHidden=Date.now(),e.activeTarget=null,(t=e.mouseMoveRemover)===null||t===void 0||t.call(e),e.mouseMoveRemover=null,(i=e.transitionEndDetacher)===null||i===void 0||i.call(e),e.transitionEndDetacher=null,r}}abortDelayedShow(){const e=this;if(e.hasTimeout("show")){var t,i,r;(t=e.mouseDownRemover)===null||t===void 0||t.call(e),e.mouseDownRemover=null,e.clearTimeout("show"),(i=e.mouseMoveRemover)===null||i===void 0||i.call(e),e.mouseMoveRemover=null,(r=e.transitionEndDetacher)===null||r===void 0||r.call(e),e.transitionEndDetacher=null}}abortDelayedHide(){this.clearTimeout("hide")}realign(){const e=this,t=e.lastAlignSpec;!e.isConfiguring&&!e.isVisible&&t!==null&&t!==void 0&&t.targetOutOfView&&(t.allowTargetOut||v.isInView(t.target,!1,e))&&(e.show(),t.targetOutOfView=!1),super.realign()}alignTo(e){const t=this,{mouseOffsetX:i,mouseOffsetY:r}=t;if(!t.isVisible)return;let s;!t.anchorToTarget&&e.position==="mouse"&&(s=new Ve(t.triggeredByEvent.pageX-globalThis.scrollX,t.triggeredByEvent.pageY-globalThis.scrollY),e.position=new Ve(s.x+t.mouseOffsetX*(t.rtl?-1:1),s.y+t.mouseOffsetY)),e&&!(t.triggeredByEvent&&t.element.contains(t.triggeredByEvent.target))&&e.nodeType===Node.ELEMENT_NODE&&(e={target:e}),super.alignTo(e),s&&t.lastAlignSpec.result.inflate(5).contains(s)&&(t.lastAlignSpec.position="mouse",t.mouseOffsetY=-r-t.height,t.mouseOffsetX=-i-t.width,t.realign(),t.mouseOffsetY=r,t.mouseOffsetX=i)}changeHtml(e){const t=this;if(F.isPromise(e)){t.showAsyncMessage(),e.target=t.activeTarget,e.then(i=>{e.target===t.activeTarget&&(t.html=i)});return}return typeof e!="object"&&(e=e!=null?t.optionalL(String(e)):""),e}updateHtml(e,t){const i=this;let r=e==="";r||(super.updateHtml(e,t),i.hasContent?(i.isVisible&&i.realign(),F.isPromise(e)||i.trigger("innerHtmlUpdate",{value:e})):r=!0),r&&i.hide()}onMouseMove(e){const t=this,{forElement:i,activeTarget:r}=t,s=t.hasTimeout("hide"),n=e.target;if(t.triggeredByEvent=e,!t._hidden){let l;const o=r==null?void 0:r.contains(n),a=!o&&t.forSelector&&r&&!s&&n.nodeType===Node.ELEMENT_NODE&&!n.matches(t.forSelector)&&!(t.allowOver&&t.element.contains(n)),c=i!=null&&i.document?i.document.documentElement:i,d=c&&(c.contains?c.contains(n):c.compareDocumentPosition(n)&16);if(a&&(l=t.handleForElementOut()),l||!s||d){if(t.dismissDelay&&!s&&t.setTimeout("hide",t.dismissDelay),t.updateContentOnMouseMove&&t.getHtml&&(t.html=t.callback(t.getHtml,t,[{tip:t,element:t.element,forElement:r,event:e}]),!t.html)){t.hide();return}t.trackMouse&&t.alignTo({position:"mouse",ignorePageScroll:!0})}}}onOwnElementMouseEnter(e){this.abortDelayedHide()}static getSharedTooltip(e,t,i){var r,s;let n=(r=t.bryntum)===null||r===void 0||(s=r.tooltip)===null||s===void 0?void 0:s.get(Ce);if(!n&&!i){var l;(l=t.bryntum)!==null&&l!==void 0&&l.tooltip||w.setPath(t,"bryntum.tooltip",new Map);const o=t.bryntum.tooltip;o.set(Ce,!0),n=new Ce({forElement:t,rootElement:e,forSelector:"[data-btip]",resetCfg:{},isShared:!0,cls:"b-tooltip-shared",internalListeners:{pointerOver({source:a,target:c}){for(const g in a.resetCfg)g==="listeners"?a.un(a.resetCfg[g].set):g!=="html"&&(a[g]=a.resetCfg[g].was);a.resetCfg={};const d=M.getById(c.id),f=(d==null?void 0:d.tipConfig)||a.gatherDataConfigs(c.dataset);if(d&&d.element!==c||!d&&c.matches(".b-widget")||d!=null&&d.disabled&&!d.showTooltipWhenDisabled)return!1;a.owner=d;for(const g in f)a.resetCfg[g]={set:f[g],was:a[g]},g==="listeners"?a.ion(f[g]):a[g]=f[g]},hide({source:a}){a.owner=null}},gatherDataConfigs(a){const c=this,d={};for(const f in a)if(f.startsWith("btip"))if(f.length>4){const g=k.uncapitalize(f.substr(4));if(g in c.getDefaultConfiguration()){const h=a[f];d[g]=Uu[h]?h==="true":isNaN(h)?h:parseInt(h,10)}}else d.html=a[f];return d},filterTarget(a){const c=a.closest(this.forSelector);if(c)return c;if(Ce.showOverflow)for(;((d=a)===null||d===void 0?void 0:d.nodeType)===Element.ELEMENT_NODE;){var d;if(v.getStyleValue(a,"text-overflow")==="ellipsis"&&a.clientWidth<a.scrollWidth)return this.html=k.encodeHtml(a.textContent),a;a=a.parentNode}}}),z.on({element:t,mouseenter:a=>Ce.currentOverElement=a.target,keydown:a=>Ce.currentOverElement=a.target,capture:!0,thisObj:n}),o.set(Ce,n)}return n}static encodeConfig(e){const t={};if(typeof e=="string")t.btip=e;else for(const i in e)t[`btip${i==="html"?"":k.capitalize(i)}`]=e[i];return t}}Ce.initClass(),Object.defineProperty(M,"tooltip",{get(){return Ce.getSharedTooltip(document.body,document.body)}}),M.Tooltip=Ce,Ce._$name="Tooltip";var ro=u=>class extends(u||$){static get $name(){return"Labelable"}static get configurable(){return{label:null,labelPosition:"before",labelCls:null,labelWidth:{value:null,$config:{localeKey:"L{labelWidth}"}}}}get hasLabel(){return!!this.label}compose(){const{hasLabel:t,labelPosition:i}=this;return{class:{[`b-label-${i}`]:t,"b-has-label":t}}}changeLabel(t){return t||""}setupLabel(t){return w.assign({tag:"label",for:`${this.id}-input`,class:`b-label b-align-${t.align||"start"}`},t)}updateLabelWidth(t){this.labelElement&&(this.labelElement.style.flex=`0 0 ${v.setLength(t)}`,this.inputWrap.style.flexBasis=t==null?"":"auto")}get widgetClass(){}};class cs extends pt{static get $name(){return"FieldContainer"}static get type(){return"fieldcontainer"}static get configurable(){return{animation:{duration:300},collapsed:null,collapser:{value:null,$config:"nullify"},syncableConfigs:null,syncConfigTriggers:{$config:{merge:"classList"},value:null},testConfig:{animation:{duration:10}}}}static get delayable(){return{syncChildConfigs:"raf"}}get inline(){var e;return(e=this.owner.inline)!=null?e:this.ensureItems().count===1}changeCollapsed(e){if(this.togglingCollapse)return this.togglingCollapse=!1,e;this.toggleCollapse(!!e)}updateCollapsed(e){var t;this.collapser=(t=this.collapser)===null||t===void 0?void 0:t.destroy(),this.setCollapsedCls(e)}updateCollapser(e,t){t&&t.completed==null&&(!t.reverting||!e)&&t.destroy(),this.setOwnerCls("b-collapsing",e)}get collapsing(){const{collapser:e}=this;return e!=null&&e.collapsed}get collapsingExpanding(){return this.collapser!=null}get expanding(){const{collapser:e}=this;return e!=null&&!e.collapsed}collapse(e){this.toggleCollapse(!0,e)}expand(e){this.toggleCollapse(!1,e)}setCollapsedCls(e){this.setOwnerCls("b-collapsed",e)}setOwnerCls(e,t){var i,r;(i=this.owner)===null||i===void 0||(r=i.element)===null||r===void 0||r.classList[t?"add":"remove"](e)}syncChildConfigs(){const e=this,{owner:t,syncableConfigs:i}=e;if(i){let r,s;for(r in i)s=i[r](t),e.eachWidget(n=>{n[r]=s},!1)}t.afterSyncChildConfigs(e)}syncContainer(){const{inline:e,layout:t}=this;this.autoLayout&&(t.horizontal=e,t.justify=e?"center":"stretch")}toggleCollapse(e,t){const i=this,{animation:r,collapser:s,inline:n}=i,{containerWrapElement:l}=i.owner,o=a=>{a&&(i.element.style.height="",i.togglingCollapse=!0,i.collapsed=e,i.collapser=null)};if(e==null&&(e=!i.collapsed),t!==!1&&t!==null&&(!l||!i.isVisible?t=null:(t===!0?t={}:typeof t=="number"&&(t={duration:t}),t=r||t?w.merge({},r,t):null)),!t)i.togglingCollapse=!0,i.collapsed=e;else if(s&&e!==s.collapsed)i.collapser=s.revert({finalize:o}),i.collapser.collapsed=e;else if(!s&&e!==i.collapsed){!e&&i.setCollapsedCls(!1);const{element:a}=i,{height:c}=a.getBoundingClientRect(),d=n?1:c;!e&&i.setCollapsedCls(!0),a.style.height=`${c}px`,i.collapser=te.run(w.merge({finalize:o,element:l,[n?"opacity":"height"]:{from:e?d:0,to:e?0:d}},t)),i.collapser.collapsed=e}}}cs.initClass(),cs._$name="FieldContainer";const Ku=(u,e)=>(u.weight||0)-(e.weight||0),Yu=(u,e)=>(e.weight||0)-(u.weight||0),us=[],Gu={align:!0,weight:!0};class ve extends M.mixin(ss,ro){static get $name(){return"Field"}static get type(){return"field"}static get configurable(){return{defaultBindProperty:"value",placeholder:null,value:"",name:null,labels:null,required:null,clearable:null,revertOnEscape:null,hint:null,hintHtml:null,inputWidth:null,keyStrokeChangeDelay:0,readOnly:null,editable:!0,defaultAction:"change",triggers:null,highlightExternalChange:!0,localizableProperties:["label","title","placeholder","labelWidth"],autoSelect:!1,autoComplete:"off",spellCheck:null,validateOnInput:!0,inputAttributes:null,inputType:"text",inputAlign:null,attributes:{value:["placeholder","autoComplete","spellCheck","minLength","maxLength","pattern","tabIndex","min","max"],$config:{merge:"distinct"}},nullValue:{$config:null,value:null,default:null},updatedClsDuration:500,inputReadOnly:!1,ariaElement:"input",container:{$config:"nullify",value:null},containerDefaults:{type:"fieldcontainer",syncableConfigs:{disabled:e=>e.disabled},syncConfigTriggers:{disabled:1}},containValues:null,inline:null,testConfig:{updatedClsDuration:10},keyMap:{}}}static get delayable(){return{highlightChanged:"raf"}}doDestroy(){var e,t,i;const r=this,{triggers:s}=r,n=r.isPainted&&ve.getSharedErrorTooltip(r.rootElement,!0);if((e=r.inputListenerRemover)===null||e===void 0||e.call(r),(t=r.keyListenerRemover)===null||t===void 0||t.call(r),(i=r.container)===null||i===void 0||i.destroy(),super.doDestroy(),s)for(const l of Object.values(s))l.destroy();(n==null?void 0:n.field)===r&&n.hide()}get childItems(){const{container:e,triggers:t}=this,i=t?Object.values(t):[];return e?[...i,...e.childItems]:i}get invalidValueError(){return"L{invalidValue}"}get errorTip(){return this.constructor.getSharedErrorTooltip(this.rootElement)}static getSharedErrorTooltip(e,t){var i;let r=(i=e.bryntum)===null||i===void 0?void 0:i.errorTooltip;return!r&&!t&&(e.bryntum=e.bryntum||{},r=new Ce({cls:"b-field-error-tip",forSelector:".b-field.b-invalid .b-field-inner",align:{align:"l-r",monitorTargetMutation:!0},scrollAction:"realign",trapFocus:!1,rootElement:e,onBeforeShow(){const s=this,n=M.fromElement(s.activeTarget);if(n){const l=n.getErrors();if(l)return s.html=l.join("<br>"),s.field=n,!0}return!1}}),e.bryntum.errorTooltip=r),r}static get errorTip(){return this.getSharedErrorTooltip(document.body)}construct(e){super.construct(e);const t=this;t.keyStrokeChangeDelay&&(t.changeOnKeyStroke=t.buffer(t.internalOnChange,t.keyStrokeChangeDelay))}changeKeyMap(e){const t=this;let i={};e&&(t._fieldKeyMap?w.assign(i,t._fieldKeyMap):(t._fieldKeyMap=e,w.assign(i,e)));for(const s in t.triggers){var r;(r=t.triggers[s])!==null&&r!==void 0&&r.keyMap&&(i=t.mergeKeyMaps(i,t.triggers[s].keyMap,s))}return i}get keyMapSubComponents(){return this.triggers}onFocusIn(e){const t=this;t.valueOnFocus=w.clone(t.value),t.validOnFocus=!(t.errors&&Object.keys(t.errors).length),super.onFocusIn(e),t.focusing=!0,t.syncInvalid(),t.focusing=!1}onFocusOut(e){super.onFocusOut(e),this.syncRequired(),this.onEditComplete()}onEditComplete(){}get rootUiClass(){return ve}compose(){this.getConfig("clearable");const e=this,{container:t,innerElements:i,label:r,labels:s,labelCls:n,readOnly:l,triggers:o}=e,a=w.values(o,(h,p)=>!p),c=a.filter(h=>h.align==="start").sort(Ku),d=a.filter(h=>h.align!=="start").sort(Yu),f=e.setupLabel.bind(e),g=[...c.map(h=>h.element),...i,...d.map(h=>h.element)];return{class:{"b-has-start-trigger":c.length,"b-no-input":!i.length,"b-readonly":l,"b-field-container":!!t,"b-field-container-inline":t==null?void 0:t.inline},children:[...(s||us).filter(h=>h&&h.align!=="end").map(f),(r||null)&&f({reference:"labelElement",class:`b-label b-align-start ${n||""}`,html:r}),g.length?{class:"b-field-inner",reference:"inputWrap",children:g}:null,...(s||us).filter(h=>(h==null?void 0:h.align)==="end").map(f),...t?[{reference:"containerWrapElement",children:[t.element],class:{"b-field-container-wrap":1}}]:us]}}updateElement(e,t){var i;const r=this,s=r.initialConfig.value,{input:n}=r;super.updateElement(e,t),s!=null&&(r.value=s),r.syncEmpty(),r.updateInputReadOnly(r.inputReadOnly),r.syncInvalid();const l=n||r.focusElement;(i=r.keyListenerRemover)===null||i===void 0||i.call(r),r.keyListenerRemover=l&&z.on({element:l,thisObj:r,keydown:"internalOnKeyEvent",keypress:"internalOnKeyEvent",keyup:"internalOnKeyEvent"})}get innerElements(){return[this.inputElement]}get inputElement(){const{attributes:e,inputAttributes:t,id:i,inputCls:r,inputType:s,name:n}=this,l=w.assign({reference:"input",tag:"input",type:s,name:n||i,id:`${i}-input`,retainElement:!0},t);r&&(l.class=r);for(let o,a,c=e.length;c-- >0;)o=e[c],a=this[o],a!=null&&(l[o]=a);return l}get caretPos(){return this.textSelection[0]}set caretPos(e){this.textSelection=e}get focusElement(){return this.input}get textSelection(){const e=this.input;let t;try{t=[e.selectionStart,e.selectionEnd,e.selectionDirection]}catch(r){var i;t=((i=e.value)===null||i===void 0?void 0:i.length)||0,t=[t,t]}return t}set textSelection(e){typeof e=="number"?this.select(e,e):this.select(...e)}get hasTextSelection(){const[e,t]=this.textSelection;return e&&t-e>0}getAfterValue(e){const[t,i]=this.textSelection,r=this.input.value;return`${r.substr(0,t)}${e}${r.substr(i||t)}`}select(e,t){const i=this.focusElement;if(i.value.length){if(arguments.length===0){this.selectAll();return}if(!this.supportsTextSelection)return;i.setSelectionRange(e,t)}}moveCaretToEnd(){const e=this.input;if(e.createTextRange){const t=e.createTextRange();t.collapse(!1),t.select()}else this.supportsTextSelection&&this.select(e.value.length,e.value.length)}selectAll(){this.focusElement.select()}syncEmpty(){var e;const{isEmptyInput:t,isEmpty:i,element:r}=this,s=(e=this.triggers)===null||e===void 0?void 0:e.clear,n=t&&i;r&&(s&&s[n?"hide":"show"](),r.classList.toggle("b-empty",n))}updateHint(){this.syncHint()}updateHintHtml(){this.syncHint()}syncHint(){const e=this,{input:t,hint:i,hintHtml:r}=e,s=t==null?void 0:t.parentElement;if(t){let n=r||i;const l=e.hintElement||n&&(e.hintElement=v.createElement({parent:s,className:"b-field-hint",nextSibling:t.nextSibling,children:[{className:"b-field-hint-content"}]}));l&&(typeof n=="function"&&(n=n({source:e,value:e.value})),l.firstChild[r?"innerHTML":"textContent"]=n||""),e.element.classList[n?"remove":"add"]("b-field-no-hint")}}syncInvalid(){const e=this,{isPainted:t}=e;if(e.updatingInvalid=!0,t){const{isValid:i,element:r,inputWrap:s}=e;if(r.classList[i?"remove":"add"]("b-invalid"),i){const n=e.constructor.getSharedErrorTooltip(e.rootElement,!0);n!=null&&n.isVisible&&n.field===e&&n.hide()}else{const n=e.errorTip;n&&(e.containsFocus||e.isVisible&&s.contains(Ce.currentOverElement))&&(n.activeTarget===s&&n.isVisible?n.onBeforeShow():(n.activeTarget=s,n.showBy(s)))}}e.updatingInvalid=!1}updateEditable(){this.syncInputReadOnly()}syncInputReadOnly(){this.getConfig("readOnly"),this.inputReadOnly=this._readOnly||this.editable===!1}updateInputReadOnly(e){const t=this,{input:i,inputListenerRemover:r}=t;i&&(i.readOnly=e?"readOnly":null,e?t.inputListenerRemover=r==null?void 0:r():r||(t.inputListenerRemover=z.on({element:i,thisObj:t,focus:"internalOnInputFocus",change:"internalOnChange",input:"internalOnInput"})))}changeReadOnly(e){return!!e}updateReadOnly(e){this.syncInputReadOnly()}updateClearable(e){const t=this;t.getConfig("triggers"),t.triggers={clear:e&&w.assign({cls:"b-icon-remove",weight:1e3,key:"Shift+backspace",handler(){t._isUserAction=!0,t.clear(...arguments),t._isUserAction=!1}},e)||null}}changeTriggers(e,t){const i=this,r=i.$triggers||(i.$triggers=new Lt({configName:"triggers",factory:ve.Trigger,inferType:!1,owner:i,created(s){ee.after(s,"onConfigChange",(n,{name:l})=>{Gu[l]&&i.onConfigChange({name:"triggers",value:r.target})})},setup(s,n){s.reference=s.ref=n,s.parent=i}}));if(i.stepTriggers===!1&&(e.back||e.forward)&&(e=w.assign({},e),delete e.back,delete e.forward),r.update(e),i.element&&(i.keyMap=i.keyMap),!t)return r.target}updateInputWidth(e){this.input.style.width=v.setLength(e),this.element.classList.add("b-has-width")}updateInputAlign(e){this.input.style.textAlign=e}get isValid(){const e=this;if(!e.disabled){if(e.syncRequired(),e.errors&&Object.keys(e.errors).length)return!1;const t=e.validity;if(t)return t.valid}return!0}get isEmpty(){return this.value==null||this.value===""}get isEmptyInput(){return!this.input||this.input.value==null||this.input.value===""}get validity(){const e=this.input;return e==null?void 0:e.validity}async setValue(e){this.value=e}changeValue(e,t){return e==null&&(e=this.nullValue),this.hasChanged(t,e)?e:(e===""&&this.syncRequired(),t)}updateValue(e,t){const i=this;i.isConfiguring||(i.syncRequired(),i.inputting||i.triggerChange()),i.inputting||(i._lastValue=e),i.syncInputFieldValue(),i.overflowTwin&&!i._overflowTwinSync&&(i._overflowTwinSync=!0,i.overflowTwin.value=e,i._overflowTwinSync=!1)}hasChanged(e,t){return t!==e}syncInputFieldValue(e=!1){const t=this,{input:i,parent:r,inputValueAttr:s,inputValue:n}=t;if(i&&!t.inputting&&i[s]!==n&&(i[s]=n,!t.isConfiguring&&!t.containsFocus&&t.highlightExternalChange)){if(i.classList.remove("b-field-updated"),t.clearTimeout("removeUpdatedCls"),r){const{assigningValues:l}=r;(l===!0||(l==null?void 0:l.highlight)===!1)&&(e=!0)}e||t.highlightChanged()}t.syncEmpty(),t.syncInvalid()}highlightChanged(){this.input.classList.add("b-field-updated"),this.setTimeout("removeUpdatedCls",this.updatedClsDuration)}removeUpdatedCls(){this.input.classList.remove("b-field-updated")}get inputValue(){return this.value==null?"":this.value}get inputValueAttr(){return"value"}get supportsTextSelection(){const e=this.focusElement;return e&&(e.tagName.toLowerCase()==="textarea"||e.type&&/text|search|password|tel|url/.test(e.type))}internalOnInputFocus(){this.autoSelect&&this.selectAll()}internalOnChange(e){const t=this;t.hasChanged(t._lastValue,t.value)&&t.isValid&&(t.triggerChange(e,!0),t._lastValue=t.value)}triggerChange(e,t=!!this._isUserAction){const i=this,{value:r,_lastValue:s,isValid:n}=i;i.syncHint(),i.triggerFieldChange({value:r,oldValue:s,event:e,userAction:t,valid:n}),i.defaultAction==="change"&&i.trigger("action",{value:r,oldValue:s,event:e,userAction:t,valid:n})}fetchInputValue(){this.value=this.input[this.inputValueAttr]}internalOnInput(e){var t;const i=this;i.validateOnInput||i.errorTip.hide(),i.inputting=!0,i.fetchInputValue(),i.inputting=!1,i.trigger("input",{value:i.value,event:e}),(t=i.changeOnKeyStroke)===null||t===void 0||t.call(i,e)}get needsInputSync(){var e;return this.input[this.inputValueAttr]!==String((e=this.inputValue)!=null?e:"")}internalOnKeyEvent(e){const t=this,{value:i}=t;let r=!1;if(e.type==="keydown"&&e.key==="Escape"&&!(t.readOnly||t.disabled)){const s=t.isValid,n="initialValue"in t?t.initialValue:t.valueOnFocus,l=t.hasChanged(n,i),{needsInputSync:o}=t;t.revertOnEscape&&(!s||l||o)&&(l&&(t.value=n),o&&t.syncInputFieldValue(!0),t.clearError(),r=(l||o)&&t.isValid||s!==t.validOnFocus)}t.isDestroyed||(r&&e.stopImmediatePropagation(),t.trigger(e.type,{event:e}))}clear(e){const t=this,{value:i}=t;(i!==t.nullValue||t.input.value.length>0)&&(t.value=t.nullValue,t.clearError(),t.syncInvalid(),t.trigger("clear",{event:e}))}onDisabled(){this.syncInvalid()}syncRequired(){var e;const t=this;!t.isConfiguring&&!t.focusing&&t.required&&t.isEmpty&&!((e=t.parent)!==null&&e!==void 0&&e.isSettingValues)?t.setError("L{fieldRequired}",t.updatingInvalid):t.clearError("L{fieldRequired}",t.updatingInvalid)}setError(e,t,i){const r=this;if((r.errors||(r.errors={}))[r.optionalL(e)]=1,t||r.syncInvalid(),i){const s=()=>{r.clearError(e),n()},n=r.ion({keydown:s,focusOut:s})}}clearError(e,t){const i=this;i.errors&&(e?delete this.errors[this.optionalL(e)]:i.errors={}),t||i.syncInvalid()}getErrors(){const e=this;if(!e.isValid){var t;const i=e.validity,r=w.keys(i).find(l=>l!=="valid"&&l!=="customError"&&i[l]),s=e.errors&&Object.keys(e.errors);let n;if(s!=null&&s.length?n=s:i.customError?n=[e.input.validationMessage]:r?n=[e.L(r,{min:e.min,max:e.max})]:n=[e.L(e.invalidValueError)],((t=n)===null||t===void 0?void 0:t.length)>0)return n}}createOverflowTwin(e){const t=this,i=super.createOverflowTwin(e);return i.ion({change({value:r}){t._overflowTwinSync=!0,t.value=r,t._overflowTwinSync=!1}}),i}get containerCollapsed(){var e;return(e=this.container)===null||e===void 0?void 0:e.collapsed}set containerCollapsed(e){const{container:t}=this;t&&(t.collapsed=e)}afterSyncChildConfigs(e){}changeContainer(e,t){e&&(Array.isArray(e)||!("type"in e||"items"in e))&&(e={items:e});const i=this,r=e&&w.merge({owner:i,layout:"box"},i.containerDefaults),s=M.reconfigure(t,e,{owner:i,defaults:r});if(s&&(s.autoLayout=(r==null?void 0:r.layout)==="box",s===t)){s.syncContainer();return}return s}onConfigChange(e){var t,i;super.onConfigChange(e),(t=this.container)!==null&&t!==void 0&&(i=t.syncConfigTriggers)!==null&&i!==void 0&&i[e.name]&&this.container.syncChildConfigs()}assignValue(e,t){const i=this,{container:r,containValues:s}=i,n=i.getValueName(t),l=e&&n in e;r&&s!==!1?e&&s==="nested"?l&&(e=w.clone(e[n]),super.assignValue({[n]:e&&!("value"in e)||e.value},t),e&&delete e.value,r.assignValue(e,t)):(super.assignValue(e,t),r.assignValue(e,t)):super.assignValue(e,t)}gatherValue(e){super.gatherValue(e),this.gatherValues(e)}gatherValues(e,t){const i=this,{container:r,containValues:s,valueName:n}=i,l=typeof s;t=t!=null?t:n in e,r&&s!==!1&&(s==="nested"?t&&(e[n]={value:e[n],...r.values}):(s===!0||s==null&&t||l==="string"&&i[s]||l==="function"&&s(i))&&r.gatherValues(e))}updateContainer(e,t){t&&this.detachListeners(t.id),e&&(e.rendered||e.render(),e.syncContainer(),e.syncChildConfigs())}}ve.Trigger=class extends M{static get $name(){return"FieldTrigger"}static get factoryable(){return{defaultType:ve.Trigger,extends:null}}static get type(){return"trigger"}static get configurable(){return{align:null,weight:null,role:void 0}}get field(){return this.parent}construct(){super.construct(...arguments),this.key&&(this.keyMap={[this.key]:"onClick"})}compose(){return{"aria-hidden":!0,class:{[`b-align-${this.align||"end"}`]:1,"b-icon":1},listeners:{click:"onClick",mousedown:"onMousedown"}}}changeAlign(e){return e}onClick(e){const t=this,{field:i}=t;i.disabled||i.readOnly||(e.key&&e.preventDefault(),i.trigger("trigger",{trigger:t})!==!1&&t.handler&&i.callback(t.handler,i,[e,t]))}onMousedown(e){const t=this.field;!("key"in e)&&v.isTouchEvent&&t.editable&&(t.editable=!1,t.setTimeout(()=>t.editable=!0,500)),e.preventDefault(),v.getActiveElement(t.input)!==t.input&&t.focus()}},ve.SpinTrigger=class extends ve.Trigger{static get $name(){return"SpinTrigger"}static get type(){return"spintrigger"}static get configurable(){return{repeat:{$config:["nullify"],value:!0}}}compose(){return{children:{upButton:{class:{"b-icon":1,"b-spin-up":1}},downButton:{class:{"b-icon":1,"b-spin-down":1}}}}}updateRepeat(e){var t;(t=this.clickRepeater)===null||t===void 0||t.destroy(),this.clickRepeater=e?Wi.new({element:this.element},e):null}onClick(e){const t=this,{field:i}=t;i.disabled||i.readOnly||(e.target===t.upButton?i.doSpinUp(e.shiftKey):e.target===t.downButton&&i.doSpinDown(e.shiftKey))}},ve.Trigger.initClass(),ve.SpinTrigger.initClass(),M.register(ve.Trigger,"trigger"),M.register(ve.SpinTrigger,"spintrigger"),ve._$name="Field";class Xi extends ve{static get type(){return"textfield"}static get alias(){return"text"}static get configurable(){return{nullValue:""}}static get $name(){return"TextField"}construct(e){(e==null?void 0:e.inputType)==="hidden"&&(e.hidden=!0),super.construct(...arguments)}}Xi.initClass(),Xi._$name="TextField";class ds extends Xi{static get $name(){return"PickerField"}static get type(){return"pickerfield"}static get configurable(){return{editable:!0,pickerAlignElement:"inputWrap",value:null,triggers:{expand:{cls:"bars"}},autoClose:!0,autoExpand:null,picker:{value:{floating:!0},$config:["lazy","nullify"]},inputType:"text",monitorResize:!0,nullValue:null}}doDestroy(){var e;(e=this.globalTapListener)===null||e===void 0||e.call(this),super.doDestroy()}changeEditable(e){return B.isMobile&&this.initialConfig.editable!==!0&&(e=!1),e}updateEditable(e){const t=this,{element:i,ariaElement:r,nonEditableClickTarget:s}=t,{expand:n}=t.triggers,l=globalThis.matchMedia("(max-width: 410px)").matches;if(super.updateEditable(...arguments),i.classList.toggle("b-not-editable",!e),e===!1){var o;B.isMobile&&l&&(n==null||n.hide()),r.removeAttribute("aria-autocomplete"),(o=t.globalTapListener)===null||o===void 0||o.call(t),z.on({element:s,click:a=>{const c=s.getRootNode().elementFromPoint(a.clientX,a.clientY);a.target===s&&c===s&&t.onTriggerClick(a)},thisObj:t})}else n==null||n.show(),r.setAttribute("aria-autocomplete","list"),t.globalTapListener=ae.ion({globaltap:"showKeyboard",thisObj:t})}get nonEditableClickTarget(){return this.input}updateElement(e,t){var i;const r=super.updateElement(e,t),s=this.peekConfig("picker"),n=s?s.isWidget?s.role:(i=this.constructor.resolveType(s.type))===null||i===void 0?void 0:i.$meta.config.role:!1;return this.ariaHasPopup=n,r}changePicker(e,t){throw new Error("changePicker(oldPicker, newPicker) must be implemented in PickerField subclass implementations")}get childItems(){const e=super.childItems;return this._picker&&e.push(this.picker),e}onEditComplete(){super.onEditComplete(),this.autoClosePicker()}onElementResize(e){const t=this;t.pickerVisible&&t.picker.requestAnimationFrame(t.picker.realign,null,t.picker),super.onElementResize(e)}internalOnKeyEvent(e){const t=this;let i=!0;if(e.type==="keydown"&&!t.disabled&&!e.shiftKey&&!e.ctrlKey)if(t.pickerVisible){const{picker:r}=t;e.key==="Escape"?(e.preventDefault(),e.stopImmediatePropagation(),t.hidePicker(),i=!1):r.onInternalKeyDown?r.onInternalKeyDown(e):e.key==="ArrowDown"&&r.focusable&&r.focus()}else e.key==="ArrowDown"&&(e.stopImmediatePropagation(),e.preventDefault(),t.onTriggerClick(e));i&&super.internalOnKeyEvent(e)}onFocusIn(e){const t=this;super.onFocusIn(e),t.autoExpand&&(t.minChars=0,t.onTriggerClick(e),t.ignoreTriggerClick=!0,t.setTimeout(()=>t.ignoreTriggerClick=!1,100))}onTriggerClick(e){this.disabled||this.togglePicker("key"in e)}showKeyboard({event:e}){const t=this.input;v.isTouchEvent&&v.getActiveElement(t)===t&&e.target===t&&(ae.suspendFocusEvents(),t.blur(),t.focus(),ae.resumeFocusEvents())}togglePicker(e){this.pickerVisible?this.hidePicker():this.showPicker(e)}showPicker(e){const t=this,{picker:i}=t;t.pickerHideShowListenersAdded||(i.ion({show:"onPickerShow",hide:"onPickerHide",thisObj:t}),t.pickerHideShowListenersAdded=!0),v.setAttributes(t.ariaElement,{"aria-controls":i.id,"aria-expanded":!0}),i.autoClose=t.autoClose,i.show(),i.isVisible&&e&&t.focusPicker()}onPickerShow(){const e=this;e.pickerVisible=!0,e.element.classList.add("b-open"),e.trigger("togglePicker",{show:!0}),e.pickerTapOutRemover=ae.ion({globaltap:"onPickerTapOut",thisObj:e}),e.pickerKeyDownRemover=z.on({element:e.picker.element,keydown:"onPickerKeyDown",thisObj:e})}onPickerHide(){var e,t;const i=this;i.ariaElement.setAttribute("aria-expanded",!1),i.pickerVisible=!1,i.element.classList.remove("b-open"),i.trigger("togglePicker",{show:!1}),(e=i.pickerTapOutRemover)===null||e===void 0||e.call(i),(t=i.pickerKeyDownRemover)===null||t===void 0||t.call(i)}onPickerTapOut({event:e}){!this.containsFocus&&!this.owns(e.target)&&this.autoClosePicker()}onPickerKeyDown(e){if(e.key==="Tab"&&!this.picker.trapFocus){const t=v.getActiveElement(this.input),i=new KeyboardEvent("keydown",e);this.input.dispatchEvent(i),i.defaultPrevented&&e.preventDefault(),v.getActiveElement(this.input)===t?this.input.focus():e.preventDefault(),this.isDestroyed||this.hidePicker()}}autoClosePicker(){this.autoClose&&this.hidePicker()}hidePicker(){this.pickerVisible&&this.picker.hide()}focusPicker(){}focus(){const e=this.input;v.isTouchEvent&&this.editable&&(e.readOnly=!0,this.setTimeout(()=>e.readOnly=!1,500)),super.focus()}}ds._$name="PickerField";const nt=document.createRange();class lt extends M{static get $name(){return"List"}static get type(){return"list"}static get configurable(){return{itemCls:"b-list-item",selectedCls:"b-selected",selectIconCls:"b-icon-check",tag:"ul",items:null,displayField:"text",store:null,navigator:!0,scrollable:{overflowX:!1,overflowY:!0},itemsFocusable:!0,multiSelect:!1,toggleAllIfCtrlPressed:!1,selectAllItem:!1,itemTpl(e){let t=k.encodeHtml(e.getValue(this.displayField));return(t==null||t==="")&&(t="&nbsp;"),t},getItemStyle:null,getItemCls:null,groupHeaderTpl(e,t){let i=k.encodeHtml(t);return(i==null||i==="")&&(i="&nbsp;"),`${this.allowGroupSelect?this.itemIconTpl(e):""}${i}`},allowGroupSelect:!0,selected:{$config:"nullify",value:{}},activateOnMouseover:null,role:"listbox",keyMap:{"Ctrl+a":"selectAll"}}}construct(e,...t){var i;const r=this;Array.isArray(e)&&(e={items:e}),super.construct(e,...t);const{element:s}=r,{classList:n}=s;r.multiSelect&&n.add("b-multiselect"),(i=r.store)!==null&&i!==void 0&&i.count?r.refresh():n.add("b-empty"),z.on({element:s,delegate:r.itemSelector,mouseover:"onMouseOver",click:"onClick",thisObj:r})}doDestroy(){var e;this.detachListeners("store"),(e=this.navigator)===null||e===void 0||e.destroy(),super.doDestroy()}onFocusIn(e){var t;this.restoreActiveItem((t=e._target)===null||t===void 0?void 0:t.closest(this.itemSelector)),super.onFocusIn(e)}contentTpl(){const e=this,t=e.store.records.map((i,r)=>e.itemWrapperTpl(i,r));return e.multiSelect&&e.selectAllItem!==!1&&t.unshift(e.selectAllItemTpl()),ot.tpl`${t}`}itemWrapperTpl(e,t){const{selected:i,getItemStyle:r}=this,s=r?`style="${this.callback(r,this,[e])}"`:"";return ot.tpl`<li ${s} class="${this.getItemClasses(e,t)}" role="option" aria-selected="${i.includes(e)}" data-index="${t}" data-id="${k.encodeHtml(e.id)}" ${this.itemsFocusable?'tabindex="-1"':""}>${this.itemContentTpl(e,t)}</li>`}itemContentTpl(e,t){return"groupRowFor"in e.meta?this.groupHeaderTpl(e,k.capitalize(e.groupChildren[0][e.meta.groupField])):`${this.itemIconTpl(e,t)}${this.itemTpl(e,t)}`}itemIconTpl(e,t){return this.multiSelect?`<i class="b-selected-icon b-icon ${this.selectIconCls}"></i>`:""}selectAllItemTpl(){const e=this.allSelected?"b-selected":"";return`<li class="${this.itemCls} b-select-all-item ${e}" data-noselect data-select-all data-id="select-all">${this.itemIconTpl({})}<div>${this.L("selectAll")}</div></li>`}getItemClasses(e){var t;const i=this,{getItemCls:r}=i,s=(t=i._navigator)===null||t===void 0?void 0:t.activeItem,n=(s==null?void 0:s.dataset.id)==e.id,l="groupRowFor"in e.meta?"b-list-item-group-header":"",o=i.selected.includes(e)||e.isSpecialRow&&e.groupChildren.every(c=>i.selected.includes(c)),a=r?this.callback(r,this,[e]):"";return`${i.itemCls} ${e.cls||""} ${a} ${o?i.selectedCls:""} ${n?i.navigator.focusCls:""} ${l}`}onBeforeStoreLoad(){this.mask(this.L("L{loading}"))}onAfterStoreRequest(){this.unmask()}onStoreChange({source:e,action:t,records:i,record:r,changes:s}){const n=this,{selected:l}=n;switch(t){case"dataset":{l.match(e.storage,!n._externallyOwnedSelection);break}case"remove":l.remove(i);break;case"clear":n.deselectAll();break;case"update":{const{id:o}=s;o&&v.setAttributes(n.contentElement.querySelector(k.encodeAttributeSelector("data-id",o.oldValue)),{"data-id":o.value}),n.refreshItem(r);return}}n.refresh()}onStoreRefresh(){this.refresh()}refresh(){const e=this;if(e.isVisible){var t;const i=(t=e.navigator)===null||t===void 0?void 0:t.activeItem;e.paintListener=null;const r=v.createElementFromTemplate(e.contentTpl(),{fragment:!0});e.clearItems().insertNode(r),i&&e.restoreActiveItem(i),e.refreshCount=(e.refreshCount||0)+1,e.element.classList[e.store.count>0?"remove":"add"]("b-empty"),e.updateSelectAllState()}else e.paintListener||(e.paintListener=e.ion({paint:"refresh",thisObj:e,once:!0}))}clearItems(){const e=this,t=e.contentElement.querySelector(e.itemSelector),i=e.contentElement.lastChild;if(t){const r=e.contentElement.querySelectorAll(`${e.itemSelector}:not(.b-mask)`);nt.setStartBefore(t),nt.setEndAfter(r[r.length-1]),nt.deleteContents()}else i?(nt.setStartAfter(i),nt.setEndAfter(i)):(nt.setStart(e.contentElement,0),nt.setEnd(e.contentElement,0));return nt}refreshItem(...e){for(const t of e){const i=this.getItem(t);if(i){const r=this.store.indexOf(t),s=v.createElementFromTemplate(this.itemWrapperTpl(t,r));v.sync(s,i)}}}getItem(e){if(e!=null){var t;return typeof e=="number"?this.contentElement.querySelector(`[data-index="${e<0?this.store.count+e:e}"]`):(e.nodeType===Element.ELEMENT_NODE&&(e=e.dataset.id),((t=e)===null||t===void 0?void 0:t.id)!=null&&(e=e.id),this.contentElement.querySelector(k.encodeAttributeSelector("data-id",e)))}}getRecordFromElement(e){return e.target&&(e=e.target),e=e.closest(this.itemSelector),this.store.getAt(parseInt(e.dataset.index))}updateItems(e){const t=this;t.store&&t.store.autoCreated&&t.store.destroy(),t.store=ie.getStore(e)}updateDisabled(e){super.updateDisabled(...arguments),this.navigator&&(this.navigator.disabled=e)}changeSelected(e,t){if(e){let i;e.isCollection?this._externallyOwnedSelection=!0:(Array.isArray(e)?(i=e,e={}):e.values&&(i=e.values,e={...e,values:[]}),e=new Ge(e)),e.ion({change:"onSelectionChange",thisObj:this}),this.initialSelection=i}else t==null||t.destroy();return e}get itemSelector(){return`.${this.itemCls}`}get selected(){return this._selected}get store(){return this.getConfig("items"),this._store}changeStore(e){const t=this;if(e instanceof ie||(Array.isArray(e)&&(e={data:e}),e=new ie(e)),t.detachListeners("store"),e){const i={name:"store",change:"onStoreChange",refresh:"onStoreRefresh",thisObj:t};e.readUrl&&(i.beforeLoad="onBeforeStoreLoad",i.afterRequest="onAfterStoreRequest"),e.isGrouped&&(t.element.classList.add("b-grouped"),i.groupchange="onStoreRefresh"),e.ion(i)}return e}updateStore(e){const{initialSelection:t}=this;Array.isArray(t)&&(e.count?(this.select(t),this.selected.count||this.onSelectionChange({action:"clear",removed:[]})):e.ion({refresh:()=>this.select(t),once:!0})),this.refresh()}changeNavigator(e,t){const i=this,{element:r}=i;if(r){var s;e=kt.reconfigure(t,e?kt.mergeConfigs({ownerCmp:i,disabled:i.disabled,target:r,keyEventTarget:r},e):null,i),((s=e)===null||s===void 0?void 0:s.keyEventTarget)===r&&!i.itemsTabbable&&(r.tabIndex=0)}return e}get minAlignHeight(){const e=this.element.lastElementChild,t=this.minHeight;if(t!=null)return e?Math.min(e.offsetTop+e.offsetHeight,t):0}alignTo(...e){super.minHeight=this.minAlignHeight,super.alignTo(...e)}hide(...e){return this.navigator&&(this.navigator.activeItem=null),super.hide(...e)}show(){const{refreshCount:e}=this,{previousActiveItem:t}=this.navigator;super.minHeight=this._minHeight;const i=super.show(...arguments);return this.refreshCount===e&&this.restoreActiveItem(t,!0),i}restoreActiveItem(e=this.navigator.previousActiveItem,t="nearest"){const i=this,{navigator:r,lastAlignSpec:s}=i;if(e!=null){if(typeof t!="string"){const n=s?s.zone:1;t=n&1?"nearest":n?"start":"end"}e=i.getItem(e),e&&!i.disabled&&(i.scrollable.scrollIntoView(e,{block:t}),r.activeItem=e)}}onMouseOver(e){const t=this,i=e.currentTarget;!v.isTouchEvent&&i&&t.navigator&&t.activateOnMouseover&&t.setTimeout({fn:"handleMouseOver",delay:30,args:[i],cancelOutstanding:!0})}handleMouseOver(e){this.navigator.activeItem=e}onClick(e){const t=e.target.closest(this.itemSelector);t&&this.onItemClick(t,e)}onInternalKeyDown(e){const t=this,i=t.navigator.activeItem;if(!t.disabled)switch(e.key){case" ":if(e.target.nodeName.toUpperCase()==="INPUT"&&!e.target.readOnly)break;case"Enter":i&&(this.onItemClick(i,e),e.stopImmediatePropagation(),e.preventDefault())}}onItemClick(e,t){const i=this,{allowGroupSelect:r}=i,s=parseInt(e.dataset.index),n=i.store.getAt(s),l=n==null?void 0:n.isSpecialRow;if(!(i.disabled||i.trigger("beforeItem",{item:e,record:n,index:s,event:t,userAction:!0})===!1)){if(i._isUserAction=!0,e.contains(t.target.closest("[data-select-all]")))i.onSelectAllClick(e,t);else if(n&&!e.contains(t.target.closest("[data-noselect]"))&&(!l||r)){const{selected:o}=i,{groupParent:a}=n.instanceMeta(this.store);if(i.multiSelect){let c=o.includes(n),d=n;i.toggleAllIfCtrlPressed&&t.ctrlKey?d=i.store.records:r&&l&&(c=!n.groupChildren.some(f=>!o.includes(f)),e.classList.toggle("b-selected",!c),d=n.groupChildren),o[c?"remove":"add"](d),!l&&a&&r&&i.getItem(a).classList.toggle("b-selected",a.groupChildren.every(g=>o.includes(g)))}else o.splice(0,o.count,n)}i.isDestroyed||(i.lastClicked=n,i.trigger("item",{item:e,record:n,index:s,event:t,userAction:!0}),i._isUserAction=!1)}}onSelectionChange({action:e,removed:t,added:i,replaced:r}){const s=this,{selectedCls:n,unselectedCls:l}=s;let o,a;if(e==="clear")for(a of s.element.querySelectorAll(`.${n}`))a.classList.remove(n),a.setAttribute("aria-selected",!1),l&&a.classList.remove(l);else if(e!=="replaceValues"){for(o of t)a=s.getItem(o),a&&(a.classList.remove(n),a.setAttribute("aria-selected",!1));for(o of i)a=s.getItem(o),a&&(a.classList.add(n),a.setAttribute("aria-selected",!0))}s.selectAllItem&&s.updateSelectAllState()}onSelectAllClick(e){e.classList.contains(this.selectedCls)?this.deselectAll():this.selectAll()}updateSelectAllState(){var e;(e=this.element.querySelector(".b-select-all-item"))===null||e===void 0||e.classList.toggle(this.selectedCls,this.allSelected)}get allSelected(){const{selected:e,store:t}=this;return e.count&&(t.isFiltered?t.records.every(i=>e.includes(i)):t.count===e.count)}selectAll(e){const t=this;(t.multiSelect||!e)&&(t.selected.add(t.store.records),e&&!t.navigator.activeItem&&(t.navigator.activeItem=t.getItem(-1)))}deselectAll(){this.selected.clear()}select(e){const{store:t}=this,{modelClass:i}=t;e=j.asArray(e).reduce((r,s)=>(s=t.getById(i.asId(s)),s&&r.push(s),r),[]),this.selected.add(e)}deselect(e){const{modelClass:t}=this.store;e=j.asArray(e).reduce((i,r)=>(r=this.selected.get(t.asId(r)),r&&i.push(r),i),[]),this.selected.remove(e)}}lt.initClass(),lt.prototype.navigatorClass=kt,lt._$name="List";class di extends lt{static get $name(){return"ChipView"}static get configurable(){return{itemCls:"b-chip",multiSelect:!1,closable:!0,iconTpl:null,closeHandler:null}}itemContentTpl(e,t){const i=this;return ot.tpl`${i.iconTpl?this.iconTpl(e):""}
            ${i.itemTpl(e,t)}
            ${i.closable?'<div class="b-icon b-close-icon b-icon-clear" data-noselect></div>':""}`}onInternalKeyDown(e){const t=this;t.closable&&t.selected.count&&(e.key==="Delete"||e.key==="Backspace")?t.callback(t.closeHandler,t.owner,[t.selected.values,{isKeyEvent:!0}]):super.onInternalKeyDown(e)}updateClosable(e){this.element.classList[e?"add":"remove"]("b-chips-closable"),this.navigator&&(this.navigator.disabled=!e),this.isConfiguring||this.refresh()}onClick(e){const t=this,i=e.target.closest(`.${t.itemCls}`);if(t.closable&&e.target.classList.contains("b-close-icon")){const r=t.store.getAt(parseInt(i.dataset.index));t.closeHandler?t.callback(t.closeHandler,t.owner,[[r]]):t.store.remove(r)}else super.onClick(e)}}R(di,"type","chipview"),di.initClass(),di._$name="ChipView";const fs="L{Field.fieldRequired}",$t="L{Field.validateFilter}",Xu="L{Combo.recordNotCommitted}";class Ji extends ds{static get $name(){return"Combo"}static get type(){return"combo"}static get alias(){return"combobox,dropdown"}static get configurable(){return{primaryFilter:{},picker:{type:"list",floating:!0,scrollAction:"realign",itemsFocusable:!1,activateOnMouseover:!0,align:{align:"t0-b0",axisLock:!0},maxHeight:324,scrollable:{overflowY:!0},autoShow:!1,focusOnHover:!1},multiSelect:null,items:null,store:null,valueField:void 0,displayField:"text",pickerWidth:null,minChars:null,selected:null,listItemTpl:null,displayValueRenderer:null,listCls:null,triggers:{expand:{cls:"b-icon-picker",handler:"onTriggerClick"}},filterParamName:null,encodeFilterParams:e=>e.map(t=>t.value),filterOnEnter:!1,hideTrigger:null,overlayAnchor:null,keyStrokeFilterDelay:null,defaultAction:"select",triggerAction:"all",filterOperator:"startsWith",caseSensitive:!1,hidePickerOnSelect:null,chipView:{$config:["lazy","nullify"],value:{type:"combochipview"}},chipStore:{$config:["lazy","nullify"],value:{}},filterSelected:null,emptyText:null,value:null,valueCollection:{$config:["nullify","lazy"],value:{}},validateFilter:!0,clearTextOnPickerHide:!0,destroyStore:!1,multiValueSeparator:",",createOnUnmatched:null,role:"combobox",inlinePicker:null,testConfig:{keyStrokeFilterDelay:0},localizeDisplayFields:!1,buildItems:null}}static get queryLast(){return"last"}construct(e){super.construct(...arguments),this.store||(this.items=[]),this.filterOnEnter&&(this.hideTrigger=!0)}startConfigure(e){this.usingRecordAsValue=e.valueField===null,super.startConfigure(...arguments)}afterConfigure(){super.afterConfigure();const e=this;w.hasOwn(e,"_value")||(e._value=e.valueField===e.displayField?"":null,e._lastValue=e._lastValue||e._value)}get childItems(){const{_chipView:e,_picker:t}=this,i=super.childItems;return e&&i.push(e),t&&i.push(t),i}get innerElements(){var e;const t=(e=this._chipView)===null||e===void 0?void 0:e.element,{input:i,inputElement:r}=this;return t&&X.sync({targetElement:i,domConfig:r}),[t||r]}updateInlinePicker(e){e&&(this.element.classList.add("b-inline-picker"),this.getConfig("picker"),this.triggers.expand=null,this.pickerVisible=!0)}hidePicker(){if(!this.inlinePicker)return super.hidePicker(...arguments)}changeChipStore(e){return e&&!(e instanceof ie)&&(e=new ie(ie.mergeConfigs({storage:this.valueCollection},e))),e}updateChipStore(e,t){t==null||t.destroy()}changeChipView(e,t){const i=this;if(i.element.classList[e?"add":"remove"]("b-uses-chipview"),e){const{input:r}=i;return i.chipStore||(i.chipStore={}),so.reconfigure(t,e,{defaults:{parent:i,insertBefore:r,store:i.chipStore,closable:!i.readOnly,navigator:{type:"combochipnavigator",keyEventTarget:r}}})}t==null||t.destroy()}updateChipView(e){var t;const i=this;i._chipViewEventDetacher=(t=i._chipViewEventDetacher)===null||t===void 0?void 0:t.call(i),i.chipStore=e==null?void 0:e.store,e&&(e.element.appendChild(i.input),i._chipViewEventDetacher=z.on({element:e.element,mousedown:"onChipViewMousedown",thisObj:i}))}updateMultiSelect(e,t){const i=this,{input:r,element:s}=i,n=!i.isConfiguring;let{value:l}=i;if(s.classList[e?"add":"remove"]("b-multiselect"),e){const{chipView:a}=i,{parentNode:c}=r,d=a==null?void 0:a.element;d&&d!==c&&(c.insertBefore(d,r),d.appendChild(r),i.chipView.refresh()),r.value="",n&&(l=j.asArray(l))}else{const a=i._chipView,{parentNode:c}=r,d=a==null?void 0:a.element;if(d===c&&(d.parentNode.insertBefore(r,d),d.remove(),s.classList.remove("b-uses-chipview")),n&&typeof l!="string"){var o;l=(o=l)!==null&&o!==void 0&&o.length?l[0]:null}}n&&(i.value=l)}onChipViewMousedown(e){e.preventDefault(),this.containsFocus||this.focus()}onChipClose(e,t={}){(t.isKeyEvent&&this.input.value===""||!t.isKeyEvent)&&(this._isUserAction=!0,this.valueCollection.remove(e),this._isUserAction=!1)}updateFilterParamName(e){this.hideTrigger!==!1&&(this.hideTrigger=!!e)}updateHideTrigger(e){this.element.classList[e?"add":"remove"]("b-hide-trigger")}updateKeyStrokeFilterDelay(e){this.filterOnInput.delay=e}updateReadOnly(e){super.updateReadOnly(...arguments),this._chipView&&(this._chipView.closable=!e)}updateDisabled(e){super.updateDisabled(...arguments),this._chipView&&(this._chipView.closable=!e)}updateFilterOperator(e){this.primaryFilter&&(this.primaryFilter.operator=e)}get minChars(){const e=this._minChars;return e!=null?e:this.remoteFilter?4:1}get validateFilter(){return this._validateFilter&&!this.createOnUnmatched}get items(){return this.store.allRecords}updateBuildItems(e){e&&(this.items=e.call(this))}changeItems(e){var t;const i=this;if(e==null){if(i.store&&!i.store.isItemStore)return;e=[]}if(i.buildItems&&!((t=e)!==null&&t!==void 0&&t.length)&&(e=i.buildItems()),e instanceof ie){i.store=e;return}const r=i.displayField;let s,n=i.valueField,l;if(Array.isArray(e)?l=e.map(o=>{let a=o;return o instanceof se?(s=o.constructor,n||(i.valueField=n=s.idField)):typeof o=="string"||typeof o=="number"?(n||(i.valueField=n=i.displayField),a={[n]:o,[r]:o}):(n||(i.valueField=n="value"),Array.isArray(o)&&(a={[n]:o[0],[r]:o[1]})),o.selected&&(i.value=a),a}):(n||(i.valueField=n="value"),l=[],Object.entries(e).forEach(([o,a])=>{l.push({[n]:o,[r]:a})})),i.store)i.store.data=l;else{const o=n===r?{name:"value",dataSource:r}:n;if(!s){class a extends se{static get idField(){return i.valueField}static set idField(d){super.idField=d}static get fields(){return[o,r]}}s=a}i.store=new ie({isItemStore:!0,data:l,idField:n,verifyNoGeneratedIds:!1,modelClass:s})}}get value(){const e=this,{valueCollection:t,valueField:i}=e;if(i==null)return e.multiSelect?t.values.slice():t.first;let r;return e.multiSelect?r=t.count?t.map(s=>s[i]):e._lastValue||[]:r=t.count?t.first[i]:e._lastValue,r}set value(e){super.value=e}get needsInputSync(){return this.usesChipView?!1:!this.editable}changeValue(e,t){var h;const i=this;if(e===t){i.syncInputFieldValue(!0);return}if(!i.multiSelect&&Array.isArray(e)&&e.length>1)throw new Error("Multiple values cannot be set to a non-multiSelect Combo");if(i.triggerConfig("items"),!i.inputting){var r;(r=i._chipView)===null||r===void 0||r.selected.clear()}i.store||(i.items=[]);const{valueField:s,displayField:n,store:l,valueCollection:o,_picker:a}=i,{storage:c}=l,d=(h=i.hidePickerOnSelect)!=null?h:!i.multiSelect,f=i._isUserAction||(a==null?void 0:a._isUserAction)||d&&i.pickerVisible||!1;if(!i.remoteFilter&&l.isAjaxStore&&!l.count){l.ion({load:()=>i.value=e,once:!0,thisObj:i}),i._lastValue=e;return}let g;if(e!=null){const p=Array.isArray(e),m=p?e.slice():[e];if(i.remoteFilter){if(e!=null){if(w.isObject(e)||e.isModel)i.store.data=[e],i.valueCollection.splice(0,i.valueCollection.count,i.store.first);else{const C=i.isConfiguring;i.primaryFilter.setConfig({value:e,disabled:!1}),l.performFilter(!0).then(()=>{if(i.isDestroyed)return;const{isConfiguring:E}=i;i.isConfiguring=C,o.splice(0,o.count,l.allRecords),i.isConfiguring=E})}return}}else l.isFiltered&&(i.primaryFilter.disabled=!0,l.filter());for(let C=0,E=m.length;C<E;C++){let S=m[C];if(S instanceof se)c.includes(S,!0)||l.add(S);else{const x=w.isObject(S);x&&(S=S[l.modelClass.fieldMap[s].dataSource]),g=c.getBy(n,S)||c.getBy(s,S)||o.getBy(n,S)||o.getBy(s,S),g instanceof Set&&(g=[...g][0]),g?(x&&g.set(m[C]),m[C]=g):(m.splice(C,1),E--,C--)}}const y=!m.length,b=o.generation;o.splice(0,o.count,m),y&&(i._value=p&&e.length===0?null:e,i._lastValue=i._value),(y||o.generation===b)&&i.syncInputFieldValue(),i.syncEmpty(),y&&!i.isConfiguring&&i.triggerFieldChange({value:e,oldValue:t,userAction:f,valid:i.isValid})}else if(o.count)o.clear();else{const p=i._value;i._value=null,i.syncInputFieldValue(),i.syncEmpty(),i.isConfiguring||i.triggerFieldChange({value:e,oldValue:p,userAction:f,valid:i.isValid})}i._lastValue=i._value}hasChanged(e,t){return this.multiSelect?!w.isEqual(e,t):super.hasChanged(...arguments)}onComboStoreChange({action:e}){e!=="filter"&&this.syncInputFieldValue(!0)}syncInputFieldValue(e){if(this.usesChipView){var t;(t=this.chipView)===null||t===void 0||t.refresh()}else super.syncInputFieldValue(e)}get usesChipView(){return!!(this.multiSelect&&this._chipView)}get isEmpty(){return this.valueCollection.count===0}get inputValue(){const e=this;let t=e.selected?e.selected[e.displayField]:e.value;return e.displayValueRenderer&&(t=e.callback(e.displayValueRenderer,e,[e.selected,e])),t==null?"":t}get nonEditableClickTarget(){var e;return this.multiSelect&&((e=this.chipView)===null||e===void 0?void 0:e.element)||super.nonEditableClickTarget}changeValueCollection(e,t){if(t==null||t.destroy(),e)return e.isCollection||(e=new Ge({internalListeners:{noChange:"onValueCollectionNoChange",change:"onValueCollectionChange",prio:-1e3,thisObj:this}})),e}changePrimaryFilter(e){return e.isCollectionFilter?e.setConfig({disabled:!0,property:this.displayField,operator:this.filterOperator,caseSensitive:this.caseSensitive}):(typeof e=="function"&&(e={filterBy:e}),e=new fe({id:"primary",disabled:!0,property:this.displayField,operator:this.filterOperator,caseSensitive:this.caseSensitive,...e})),e}changeStore(e){const t=this,i=[],{valueCollection:r,keyStrokeFilterDelay:s,filterParamName:n}=t;if(Array.isArray(e)){t.items=e;return}let l;if(e){if(e.isStore){const o=e.filters.get("primary");t.remoteFilter&&(e.filterParamName=n),l=e.remoteFilter||e.restfulFilter,o?t.primaryFilter=o:i.push(t.primaryFilter)}else typeof e=="string"?e=ie.getStore(e):(e=new(e.readUrl?Vi:ie)(e),t.destroyStore=!0),l=t.remoteFilter||e.restfulFilter,l&&n&&(e.filterParamName=n,t.encodeFilterParams&&(e.encodeFilterParams=t.encodeFilterParams)),i.push(t.primaryFilter);if(!t.valueField&&!t.usingRecordAsValue&&(t.valueField=e.modelClass.idField),t.filterSelected){const o=a=>!t.containsFocus||!r.includes(a);l?(e.storage.autoFilter=!0,e.storage.addFilter({id:`${t.id}-selected-filter`,filterBy:o})):(i.push(o),e.reapplyFilterOnAdd=!0)}r.addIndex({property:t.displayField,unique:!1}),r.addIndex({property:t.valueField,unique:!0}),i.forEach(o=>e.addFilter(o,!0)),l?t.keyStrokeFilterDelay=Math.max(300,s||0):t.keyStrokeFilterDelay=s!=null?s:10}return e}updateStore(e,t){const i=this,{_picker:r}=i;let s;i.destroyStore&&t&&t.destroy(),r&&(r.store=e),e.storage.addIndex({property:i.displayField,unique:!1}),e.storage.addIndex({property:i.valueField,unique:!0}),s={filter:"onStoreFilter"},i.displayValueRenderer&&((s||(s={})).change="onComboStoreChange"),i.detachListeners("store"),e!=null&&e.storage&&i.valueCollection.match(e.storage),i.syncInputFieldValue(),s&&(s.name="store",s.thisObj=i,e.ion(s))}get remoteFilter(){var e;return!!(this.filterParamName||!((e=this._store)===null||e===void 0)&&e.restfulFilter)}get record(){return this.selected}get records(){return this.valueCollection.values.slice()}get selected(){const{store:e}=this;return this.multiSelect?this.valueCollection.values.slice().sort((t,i)=>e.indexOf(t)-e.indexOf(i))[0]:this.valueCollection.first}onEditComplete(){const e=this,t=e.valueCollection.count;super.onEditComplete(),t&&(e.clearError($t),e.syncInputFieldValue()),e.required&&!t&&e.setError(fs)}onTriggerClick(e){const t=this,i="key"in e;if(!(t.ignoreTriggerClick||t.remoteFilter&&t.filterOnEnter)){if(t.pickerVisible)t.hidePicker();else if(!t.readOnly&&!t.disabled){var r;switch((r=t.triggerAction)===null||r===void 0?void 0:r.toLowerCase()){case"all":t.doFilter(null,i);break;case"last":t.doFilter(t.lastQuery,i);break;default:t.doFilter(t.input.value,i)}}}}internalOnInput(e){const t=this;t.syncEmpty(),t.syncInputWidth(),t.filterOnInput(e),t.trigger("input",{value:t.input.value,event:e})}filterOnInput(e){const t=this,{value:i}=e.type==="input"?e.target:t.input,r=i.length;t.inputting=!0,t.inlinePicker||r>=t.minChars&&(!t.filterOnEnter||e.key==="Enter")?t.doFilter(i):(t.validateFilter&&!t.remoteFilter&&t[r?"setError":"clearError"]($t),t.hidePicker()),t.inputting=!1}syncInputWidth(){const e=this;if(e.usesChipView){const t=e.input,i=e._inputPadding||(e._inputPadding=v.getEdgeSize(t,"padding","lr")),r=t.value||"",s=v.measureText(r+"W",t,!1,e.element)+i.width;t.style.flex=`1 1 ${Math.ceil(s)}px`}}doFilter(e,t){var i;const r=this,{store:s,picker:n}=r,l=e==null||e==="";r.lastQuery=e,r.primaryFilter.setConfig({value:e,disabled:l}),r.remoteFilter&&s.clear(!0);const o=()=>{const{navigator:a,isVisible:c}=n;s.count?!l&&a&&(a.activeItem=0):!r.remoteFilter&&!l&&(a&&(a.activeItem=null),r.validateFilter&&r.setError($t)),c&&n.realign()};(i=r.filterPromise=s.filter())===null||i===void 0||i.then(()=>{r.filterPromise=null,o()}),r.inlinePicker||(n!=null&&n.isVisible?n.lastAlignSpec.zone===0&&n.realign():r.showPicker(t)),r.filterPromise||o()}onStoreFilter({source:e}){const t=this,i=t._picker,r=i==null?void 0:i.element.dataset,{count:s}=e;t.remoteFilter&&(s?i&&(i.navigator.activeItem=0):t.validateFilter&&t.setError($t),t.filterSelected&&t.valueCollection.count&&(e.storage.onFiltersChanged({action:"splice",oldCount:1}),i&&i.refresh())),r&&(t.createOnUnmatched&&!s?r.addNewValue=t.L("L{addNewValue}")(t.primaryFilter.value):r==null||delete r.addNewValue)}onValueCollectionChange({source:e}){var f;const t=this,{multiSelect:i,_picker:r}=t,s=(f=t.hidePickerOnSelect)!=null?f:!i,n=i?e.values.slice():e.first,l=e.values.slice(),o=t._isUserAction||(r==null?void 0:r._isUserAction)||s&&t.pickerVisible||!1,a=t._value;s&&t.hidePicker(),!e.count&&t.required?t.setError(fs):(t.clearError(fs),t.clearError($t)),t.validateFilter&&n&&t.clearError($t),t.filterSelected&&(t.remoteFilter?(t.store.storage.onFiltersChanged({action:"splice",oldCount:1}),t._picker&&t._picker.refresh()):t.store.filter()),t._value=null,t._lastValue=null;const c=t.cacheCurrentValue(t.value);if(t.syncInputFieldValue(),t.syncEmpty(),!t.isConfiguring){var d;t.triggerFieldChange({value:c,oldValue:a,userAction:o,valid:t.isValid}),(d=t.trigger)===null||d===void 0||d.call(t,"select",{record:n,records:l,userAction:o}),t.defaultAction==="select"&&t.trigger("action",{value:c,record:n,records:l,userAction:o})}}cacheCurrentValue(e){return this._value=e}onValueCollectionNoChange({toAdd:e}){!this.inlinePicker&&!this.multiSelect&&e.length&&this.pickerVisible&&this.picker.hide()}showPicker(){const e=this,{picker:t}=e;if(!(e.readOnly||e.inlinePicker)){if(t.multiSelect=e.multiSelect,super.showPicker(...arguments),e.overlayAnchor&&!t.align.offset&&(t.align.offset=-t.anchorSize[1],t.realign()),t.restoreActiveItem)if(e.multiSelect){var i;t.restoreActiveItem(((i=t.navigator)===null||i===void 0?void 0:i.previousActiveItem)||e.selected||0,!0)}else t.restoreActiveItem(e.selected||0,!0);e.input.focus()}}changePicker(e,t){var i;const r=this,s=r.pickerWidth||((i=e)===null||i===void 0?void 0:i.width),n=lt.mergeConfigs({owner:r,store:r.store,selected:r.valueCollection,multiSelect:r.multiSelect,cls:r.listCls,displayField:r.displayField,forElement:r[r.pickerAlignElement],align:{matchSize:s==null,anchor:r.overlayAnchor,target:r[r.pickerAlignElement],minHeight:r.inlinePicker?null:Math.min(3,r.store.count)*40},[r.listItemTpl?"itemTpl":void 0]:r.listItemTpl,width:s,navigator:{keyEventTarget:r.input}},e);return r.inlinePicker&&Object.assign(n,{floating:!1,align:null,activateOnMouseover:!1,maxHeight:null,appendTo:r.element}),e=lt.reconfigure(t,e?n:null,r),e&&(e.element.classList.add("b-combo-picker"),e.element.dataset.emptyText=r.emptyText?r.L(r.emptyText):r.L("L{noResults}"),e.ion({navigate:"onPickerNavigate",thisObj:r}),z.on({element:e.element,pointerdown:l=>r.onPickerNavigate({event:l}),thisObj:r})),e}onPickerNavigate({event:e}){e.target.matches("[data-add-new-value]")&&this.addNewRecord(this.primaryFilter.value)}onPickerHide(){const e=this;super.onPickerHide(),e.multiSelect&&e.clearTextOnPickerHide&&(e.input.value="")}async internalOnKeyEvent(e){const t=this,i=t.input[t.inputValueAttr],r=i.length,{key:s}=e,{store:n,_picker:l,multiSelect:o}=t;if(e.type==="keydown"&&l!==null&&l!==void 0&&l.isVisible&&l.navigator){const{activeItem:a}=l.navigator;if(a&&o&&s===t.multiValueSeparator){t.input.value="",t.primaryFilter.setConfig({value:"",disabled:!0}),n.filter(),l.onItemClick(a,e),l.hide(),e.preventDefault();return}if(!a&&t.createOnUnmatched&&(o&&s===t.multiValueSeparator||s==="Enter")){e.preventDefault(),await t.addNewRecord(i);return}}super.internalOnKeyEvent(...arguments),e.type==="keydown"&&s==="Enter"&&t.filterOnEnter&&r>=t.minChars&&(e.stopPropagation(),t.filterOnInput.now(e))}async addNewRecord(e){const t=this,{store:i,_picker:r,valueCollection:s,multiSelect:n,primaryFilter:l}=t,o=i.remoteFilter&&i.autoCommit;t.filterPromise&&await t.filterPromise,o||(l.setConfig({value:"",disabled:!0}),i.filter());const[a]=i.add(t.callback(t.createOnUnmatched,t,[e,t]));if(i.isCommitting){let f;try{await i.commitPromise}catch(g){var c,d;f=(c=g.response)===null||c===void 0||(d=c.parsedJson)===null||d===void 0?void 0:d.error}a.isPhantom&&(t.clearError(),t.setError(f||Xu,!1,!0),i.remove(a),i.removed.remove(a))}o&&(l.setConfig({value:"",disabled:!0}),i.filter()),t.input.value="",i.includes(a)&&s.splice(n?s.count:0,n?0:s.count,a),r==null||r.hide()}changeCreateOnUnmatched(e){return e===!0&&(e=this.defaultRecordCreater),e}defaultRecordCreater(e){return this.store.createRecord({[this.displayField]:e})}updateLocalization(){super.updateLocalization();const e=this,{displayField:t}=e;let{localizedDisplayFieldsMap:i}=e;if(e.localizeDisplayFields===!0){i||(e.localizedDisplayFieldsMap=i=new Map),!e.store&&e.buildItems&&(e.items=e.buildItems());for(const s of e.items)if(s.id){var r;let n=i.get(s.id);!n&&(r=s[t])!==null&&r!==void 0&&r.startsWith("L{")&&(n=s[t],i.set(s.id,n)),n&&(s[t]=e.L(n))}e.syncInputFieldValue()}}}R(Ji,"delayable",{filterOnInput:0});class so extends di{static get $name(){return"ComboChipView"}static get type(){return"combochipview"}static get defaultConfig(){return{closeHandler:"up.onChipClose",itemsFocusable:!1,multiSelect:!0,itemTpl(e){return k.encodeHtml(e.getValue(this.owner.displayField))},scrollable:{overflowY:"auto"}}}}class Ju extends kt{static get $name(){return"ComboChipNavigator"}static get type(){return"combochipnavigator"}static get configurable(){return{allowShiftKey:!0}}onTargetClick(e){const t=this,i=e.target.closest(t.itemSelector);i&&!e.target.classList.contains("b-close-icon")&&(!e.shiftKey&&!i.contains(e.target.closest("[data-noselect]"))&&t.ownerCmp.selected.clear(),t.inClickHandler=!0,t.activeItem=i,t.inClickHandler=!1)}onKeyDown(e){e.key!=="Enter"&&!e.target.selectionStart&&!e.target.selectionEnd&&super.onKeyDown(e)}updateActiveItem(e,t){const i=this.ownerCmp;super.updateActiveItem(e,t),e&&!this.inClickHandler&&i.selected.add(i.getRecordFromElement(e))}navigatePrevious(e){const t=this.ownerCmp;t.navigator.activeItem&&!e.shiftKey&&t.selected.clear(),this.previous?super.navigatePrevious(e):this.activeItem=null}navigateNext(e){const t=this.ownerCmp;t.navigator.activeItem&&!e.shiftKey&&t.selected.clear(),this.next?super.navigateNext(e):this.activeItem=null}}Ji.initClass(),so.initClass(),Ju.initClass(),Ji._$name="Combo";const Zu=u=>!u.value;class hs extends ve{static get $name(){return"Checkbox"}static get type(){return"checkbox"}static get alias(){return"check"}static get configurable(){return{inputType:"checkbox",autoCollapse:null,containerDefaults:{syncableConfigs:{disabled:e=>e.disabled||!e.value},syncConfigTriggers:{autoCollapse:1,value:1}},text:"",checkedValue:!0,uncheckedValue:!1,color:null,value:"",toggleGroup:null,localizableProperties:["label","text"]}}construct(e){"checked"in e&&(e=w.assign({},e),e.value=e.checked,delete e.checked),super.construct(e),this.syncHasText()}get textLabelCls(){return"b-checkbox-label"}get innerElements(){return[this.inputElement,{tag:"label",class:this.textLabelCls,for:`${this.id}-input`,reference:"textLabel",html:this.text||""}]}get inputElement(){const e=super.inputElement;return this.toggleGroup&&(e.dataset={group:this.toggleGroup}),e.listeners={click:"internalOnClick",change:"internalOnChange",input:"internalOnInput"},e}get checked(){return this.value}set checked(e){this.value=e}syncHasText(){this.element.classList[this.text?"add":"remove"]("b-text")}updateText(e){this.textLabel&&(this.syncHasText(),this.textLabel.innerHTML=e)}afterSyncChildConfigs(e){super.afterSyncChildConfigs(e);let{autoCollapse:t}=this;t&&(t=t===!0?Zu:t,e.collapsed=t(this))}assignFieldValue(e,t,i){this.value=i===this.checkedValue||(i===this.uncheckedValue?!1:null)}fetchInputValue(){this.readOnly||(this.value=this.input.checked)}gatherValue(e){var t;const i=this,r=i.value?i.checkedValue:i.uncheckedValue,s=r!==void 0,{valueName:n}=i;s&&(e[n]=r),i.gatherValues(e,s),r===!0&&((t=e[n])===null||t===void 0?void 0:t.value)===r&&delete e[n].value}changeValue(e){return e==="false"?!1:!!e}updateValue(e){var t;const i=this,r=i.input.checked!==e;i.input.checked=e,(t=i.container)===null||t===void 0||t.syncChildConfigs(),r&&!i.inputting&&!i.isConfiguring&&(i.uncheckToggleGroupMembers(),i.triggerChange(!1))}get inputValueAttr(){return"checked"}updateColor(e,t){const i=this.element.classList;t&&i.remove(t),e&&i.add(e)}getToggleGroupMembers(){const e=this,{checked:t,toggleGroup:i,input:r,type:s}=e,n=[];return t&&i&&v.forEachSelector(e.rootElement,`input[type=${s}][data-group=${i}]`,l=>{if(l!==r){const o=M.fromElement(l);o&&n.push(o)}}),n}uncheckToggleGroupMembers(){this.checked&&this.toggleGroup&&this.getToggleGroupMembers().forEach(e=>e.checked=!1)}check(){this.checked=!0}uncheck(){this.checked=!1}toggle(){this.checked=!this.checked}internalOnClick(e){return this.readOnly?(e.preventDefault(),!1):this.trigger("click",{event:e})}internalOnChange(e){const t=this;if(t.readOnly&&t.value!==t.input.checked){t.input.checked=t.value;return}t.value=t.input.checked,t.inputting||(t.inputting=!0,t.triggerChange(!0),t.inputting=!1)}updateInputReadOnly(e){}triggerChange(e){const t=this,{checked:i}=t.input,r={checked:i,value:i,userAction:e,valid:!0};if(!i&&e&&t.toggleGroup&&t.getToggleGroupMembers().filter(n=>n.isVisible&&!n.disabled).length||t.trigger("beforeChange",r)===!1)t.input.checked=t._value=!i;else return t.triggerFieldChange(r,!1),e&&t.uncheckToggleGroupMembers(),t.trigger("action",r),t.trigger("change",r),!0}}hs.initClass(),hs._$name="Checkbox";class Rt extends lt{configure(e){super.configure(e),this.setItems(),this.ion({item:"onColorSelect"})}setItems(){const e=this,{colors:t,colorClasses:i}=e;let r=i||t;e.addNoColorItem&&(r=[...r],r.push(null)),e.items=r.map(s=>!s||typeof s=="string"?{color:s,text:(i?k.capitalize(s):s)||e.L("L{noColor}")}:s)}afterConfigure(){var e;super.afterConfigure(...arguments),(this.addNoColorItem||this.value)&&this.select((e=this.value)!=null?e:null)}updateColors(){this.isConfiguring||this.setItems()}updateAddNoColorItem(){this.isConfiguring||this.setItems()}onColorSelect({record:e}){var t;this.refresh();const i={color:e.color,record:e,bubbles:!0};(t=this.colorSelected)===null||t===void 0||t.call(this,i),this.trigger("colorSelected",i)}select(e){(!e||typeof e=="string")&&(e=this.store.findRecord("color",e!=null?e:null)),e&&super.select(e)}updateColumns(e){this.style=`grid-template-columns:repeat(${e}, 1fr);`}getColorClassName(e){var t,i;return(t=this.colorClasses)!==null&&t!==void 0&&t.includes(e)||(i=this.colorClasses)!==null&&i!==void 0&&i.find(r=>r&&r.color===e)?this.colorClassPrefix+e:e?"":"b-no-color"}}R(Rt,"$name","ColorPicker"),R(Rt,"type","colorpicker"),R(Rt,"configurable",{itemsFocusable:!1,navigator:{focusCls:"b-color-active"},itemWrapperTpl(e,t){const{selected:i}=this,{color:r,text:s}=e,n=this.getColorClassName(r);return ot.tpl`
                    <li
                        class="${this.getItemClasses(e,t)} ${n}"
                        role="option"
                        aria-selected="${i.includes(e)}"
                        data-index="${t}"
                        data-id="${k.encodeHtml(r)}"
                        data-btip="${s}"
                        ${this.itemsFocusable?'tabindex="-1"':""}
                        style="${n?"":"background-color: "+r}"
                    ></li>`},colorClasses:null,colorClassPrefix:null,colors:["#45171D","#F03861","#FF847C","#FECEA8","#A5F2E7","#AA83F3","#8983F3","#A10054","#073059","#2866AB","#5FBDC5","#D8D95C","#FFDEDE","#F7F3CE","#C5ECBE","#3E3E3E","#405559","#68868C","#EDEDED","#D3D6DB","#3A4750","#303841","#BE3144"],addNoColorItem:!0,columns:6,colorSelected:null}),Rt.initClass(),Rt._$name="ColorPicker";class fi extends qe{}R(fi,"$name","Fit"),R(fi,"type","fit"),R(fi,"configurable",{containerCls:"b-fit-container",itemCls:"b-fit-item"}),fi.initClass(),fi._$name="Fit";class Pt extends pt{afterConfigure(){const e=this;super.afterConfigure(),e.onTargetSizeChange=e.onTargetSizeChange.bind(e),z.on({element:e.element,keydown:"onKeyDown",contextmenu:"stopMouseEvents",mousedown:"stopMouseEvents",mouseover:"stopMouseEvents",mouseout:"stopMouseEvents",mouseup:"stopMouseEvents",click:"stopMouseEvents",dblclick:"stopMouseEvents",thisObj:e}),e.ion({beforeHide:"beforeEditorHide",hide:"afterEditorHide",thisObj:e}),me.ion({locale:"onLocaleChange",thisObj:e})}onLocaleChange(){const{inputField:e}=this;e&&!e.isDestroyed&&e.syncInputFieldValue&&e.syncInputFieldValue(!0)}render(e){const t=this.element.parentNode,[i]=this.getRenderContext(this,e);i.classList.add("b-editing"),super.render(...arguments),t!=null&&t.classList&&i!==t&&t.classList.remove("b-editing")}async startEdit(e){const t=this;if(e=w.assignIf(e,{align:t.align,hideTarget:t.hideTarget,matchSize:t.matchSize,matchFont:t.matchFont,fitTargetContent:t.fitTargetContent,focus:!0}),t.trigger("beforeStart",e)!==!1){var i,r,s;const{target:n,hideTarget:l,matchSize:o,matchFont:a,fitTargetContent:c,record:d,field:f=t.inputField.name,focus:g}=e,{inputField:h}=t,{input:p}=h,m=v.getStyleValue(n,"font-size"),y=v.getStyleValue(n,"font-family");let{value:b,align:C}=e;if(d&&f&&(t.record=d,t.dataField=f,b===void 0&&(b=d.getValue(f))),o&&(n instanceof HTMLElement&&t.updateSize(n,o),n instanceof HTMLElement&&ce.addResizeListener(n,t.onTargetSizeChange)),p&&(a?(p.style.fontSize=m,p.style.fontFamily=y):p.style.fontSize=p.style.fontFamily=""),t.assigningValues=!0,(i=h.clearError)===null||i===void 0||i.call(h),"setValue"in h?await h.setValue(b):h.value=b,t.assigningValues=!1,typeof C=="string"&&(C={align:C}),await t.showBy({target:n,allowTargetOut:!0,...C}),c){const S=p.scrollWidth-p.clientWidth;S>0&&(t.width+=S+v.scrollBarWidth)}g&&((r=h.focus)===null||r===void 0||r.call(h)),n.nodeType===Element.ELEMENT_NODE&&l&&n.classList.add("b-hide-visibility"),t.editing=!0;const E=h.value;return t.trigger("start",{value:E}),Array.isArray(E)&&h.editingRecords&&(s=E[0])!==null&&s!==void 0&&s.isModel?t.oldValue=E.map(S=>S.copy(S.id)):(t.oldValue=E,Array.isArray(t.oldValue)&&(t.oldValue=t.oldValue.slice())),h.initialValue=t.oldValue,!0}return!1}async refreshEdit(){if(this.isVisible){const{record:e,dataField:t,inputField:i}=this;if(e&&t){const r=e.getValue(t);w.isEqual(i.value,r)||await i.setValue(r)}}}finishEdit(){const{target:e,aligningToElement:t}=this.lastAlignSpec;t&&(e.classList.remove("b-editing"),e.classList.remove("b-hide-visibility")),this.editing=!1,this.trigger("finishEdit")}onKeyDown(e){var t;const i=this;switch(e.key){case i.completeKey:i.completeEdit(null,e),e.stopImmediatePropagation();break;case i.cancelKey:i.cancelEdit(e),e.stopImmediatePropagation();break}(t=i.trigger)===null||t===void 0||t.call(i,"keydown",{event:e})}stopMouseEvents(e){this.allowMouseEvents||e.stopPropagation()}onFocusOut(e){super.onFocusOut(e);const t=this;if(!t.isFinishing&&t.editing)switch(t.blurAction){case"cancel":t.cancelEdit(e);break;case"complete":t.completeEdit(null,e)}}async completeEdit(e,t){const i=this,{inputField:r,oldValue:s,record:n}=i,l=r.invalidAction||(r.allowInvalid===!1?"block":i.invalidAction),{value:o}=r;if(i.isVisible){if(!r.isValid&&l!=="allow"){if(l==="block"){var a;return(a=r.focus)===null||a===void 0||a.call(r),!1}else if(l==="revert")return i.cancelEdit(t),!0}else{if(w.isEqual(o,s))return i.cancelEdit(t),!0;{const g={inputField:r,record:n,value:o,oldValue:s};if(i.trigger("beforeComplete",g)===!1){var c;(c=r.focus)===null||c===void 0||c.call(r)}else{if(!e){var d;e=g.finalize||((d=g.editorContext)===null||d===void 0?void 0:d.finalize)}if(e){let h=await e(g);if(h===!0)i.onEditComplete();else{if(r.setError){const p=h||r.invalidValueError,m=()=>{y(),r.clearError(p)},y=r.ion({change:m,input:m});r.setError(p)}if(l==="block"){var f;(f=r.focus)===null||f===void 0||f.call(r)}else l==="revert"&&(await r.setValue(s),h=!0);h=!1}return h}else return i.onEditComplete(),!0}}}return!1}}cancelEdit(e){const t=this,{inputField:i,oldValue:r}=t,{value:s}=i;if(t.editing&&!t.isFinishing&&t.trigger("beforeCancel",{value:s,oldValue:r,event:e})!==!1){var n;(n=i.clearError)===null||n===void 0||n.call(i),t.isFinishing=!0,t.hide(),t.trigger("cancel",{value:s,oldValue:r,event:e}),t.finishEdit(),t.isFinishing=!1}}onEditComplete(){const e=this,{record:t,dataField:i,inputField:r,oldValue:s}=e,{value:n}=r;if(!e.isFinishing){if(e.isFinishing=!0,e.hide(),t){const l=`set${k.capitalize(i)}`;t[l]?t[l](n):t.setValue(i,n)}e.trigger("complete",{value:n,oldValue:s}),e.finishEdit(),e.isFinishing=!1}}doDestroy(){this.createdInputField&&this.inputField.destroy(),super.doDestroy()}set owner(e){this._owner=e}get owner(){return this._owner||M.fromElement(this.element.parentNode)}changeInputField(e,t){const i=this;return t&&t.destroy(),typeof e=="string"&&(e={type:e}),e instanceof M||(e=M.create(e),i.createdInputField=!0),i.completeOnChange&&e.ion({change:"onInputFieldChange",thisObj:i}),e.parent=i,e}updateInputField(e){this.removeAll(),this.add(e)}get inputField(){return this.items[0]}onInputFieldChange(){this.containsFocus&&this.completeEdit()}onTargetSizeChange(e,t,i){t&&i&&this.updateSize(e)}updateSize(e,t=this.lastMatchSize){const i=this,r=V.inner(e);i.width=t.width===!1?"auto":r.width-i.align.offset[0],i.height=t.height===!1?"auto":r.height,i.lastMatchSize=t}beforeEditorHide(){if(this.editing&&!this.isFinishing)return this.cancelEdit(),!1}afterEditorHide(){this.positioned&&this.element.remove(),ce.removeResizeListener(this.lastAlignSpec.target,this.onTargetSizeChange)}}R(Pt,"$name","Editor"),R(Pt,"type","editor"),R(Pt,"configurable",{positioned:!0,hidden:!0,layout:"fit",align:{align:"t0-t0",offset:[0,0]},hideTarget:!1,matchSize:!0,matchFont:!0,fitTargetContent:!1,inputField:"textfield",blurAction:"complete",completeKey:"Enter",cancelKey:"Escape",invalidAction:"block",completeOnChange:null,isolateFields:!0}),Pt.initClass(),Pt._$name="Editor";export{Pe as AjaxHelper,Vi as AjaxStore,te as Animator,Xt as ArrayDataField,j as ArrayHelper,gr as AsyncHelper,ss as Badge,ti as Bag,$ as Base,$r as BooleanDataField,B as BrowserHelper,ns as Button,jr as CSSHelper,hs as Checkbox,di as ChipView,Wi as ClickRepeater,Qr as CollapseTool,Ge as Collection,fe as CollectionFilter,Qt as CollectionSorter,Rt as ColorPicker,Ji as Combo,Q as Config,pt as Container,Xl as ContextMenuBase,Le as DataField,Rr as DateDataField,N as DateHelper,be as DayTime,rt as Delayable,W as DomClassList,nl as DomDataStore,v as DomHelper,X as DomSync,At as Duration,Lt as DynamicObject,Pt as Editor,z as EventHelper,Oe as Events,Mt as Factoryable,ve as Field,cs as FieldContainer,_e as Fullscreen,ee as FunctionHelper,ae as GlobalEvents,Pi as IdHelper,Gt as Identifiable,xt as InstancePlugin,Pr as IntegerDataField,yl as KeyMap,ro as Labelable,qe as Layout,lt as List,Bu as LoadMaskable,we as LocaleHelper,me as LocaleManagerSingleton,Bt as Localizable,xe as Mask,Ft as Menu,ci as MenuItem,se as Model,Ar as ModelDataField,kn as ModelLink,On as ModelStm,kt as Navigator,_r as NumberDataField,Nr as ObjectDataField,w as ObjectHelper,F as Objects,dt as Panel,li as PanelCollapser,ds as PickerField,wn as Pluggable,Ve as Point,Fe as Popup,Bi as Promissory,vl as RTL,V as Rectangle,ct as Renderable,ce as ResizeMonitor,Xr as Ripple,Zr as Rotatable,io as ScrollManager,ut as Scroller,Lr as State,wt as StateProvider,Dt as StateStorage,ie as Store,jn as StoreCRUD,Qn as StoreChained,Hn as StoreChanges,Jt as StoreDataField,Wn as StoreFilter,Un as StoreGroup,qn as StoreProxy,Kn as StoreRelation,Xn as StoreSearch,Jn as StoreSort,el as StoreState,sl as StoreStm,Yn as StoreSum,il as StoreSync,tl as StoreTree,Ri as StringDataField,k as StringHelper,ot as TemplateHelper,Xi as TextField,as as TimeZoneHelper,Xe as Toast,yt as Tool,rs as Toolable,gi as Toolbar,Ce as Tooltip,Ln as TreeNode,ne as VersionHelper,_i as WalkHelper,Ee as Wbs,M as Widget,cn as parseAlign,We as unitMagnitudes};
//# sourceMappingURL=Editor.js.map
