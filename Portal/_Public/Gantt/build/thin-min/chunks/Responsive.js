/*!
 *
 * Bryntum Gantt 5.5.0
 *
 * Copyright(c) 2023 Bryntum AB
 * https://bryntum.com/contact
 * https://bryntum.com/license
 *
 */
var D=Object.defineProperty;var E=(n,r,o)=>r in n?D(n,r,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[r]=o;var d=(n,r,o)=>(E(n,typeof r!="symbol"?r+"":r,o),o);import{Base as F,DynamicObject as L,ObjectHelper as m,StringHelper as z,TextField as k,Delayable as H,BrowserHelper as I,FunctionHelper as P}from"./Editor.js";var M=n=>class extends(n||F){static get $name(){return"Featureable"}static get configurable(){return{features:null}}static get declarable(){return["featureable"]}static setupFeatureable(o){const e={ownerName:"client",...o.featureable};e.factory.initClass(),Reflect.defineProperty(o,"featureable",{get(){return e}})}doDestroy(){const o=this.features;super.doDestroy();for(const t in o){var e;const i=o[t];(e=i.destroy)===null||e===void 0||e.call(i)}}hasFeature(o){var e;return!!(!((e=this.features)===null||e===void 0)&&e[o])}changeFeatures(o,e){if(this.isDestroying)return;const t=this,{featureable:i}=t.constructor,s=t.$features||(t.$features=new L({configName:"features",factory:i.factory,owner:t,ownerName:i.ownerName}));if(s.update(o),!e)return s.target}get widgetClass(){}getCurrentConfig(o){const e=super.getCurrentConfig(o),{features:t}=e;if(t)for(const i in t)Object.keys(t[i]).length===0&&(t[i]=!0);return e}};const{defineProperty:B}=Object,{hasOwn:V}=m,W=Symbol("fencible"),A=[],N=n=>Array.from(new Set(n)),$=n=>n?N(z.split(n)):A,Y=(n,r,o)=>{o===!0&&(o=r),m.isObject(o)||(o={all:o});let e=$(o.any);const t=$(o.all),i=o.lock?$(o.lock):N(t.concat(e)),s=r+"Impl",a=function(...l){const u=this,c=V(u,W)?u[W]:u[W]={},f=v=>!c[v];if(t.every(f)&&(!e||e.some(f)))try{return i.forEach(v=>c[v]=(c[v]||0)+1),u[s](...l)}finally{i.forEach(v=>--c[v])}};e=e.length?e:null,!n[s]&&B(n,s,{configurable:!0,value:n[r]}),B(n,r,{configurable:!0,value:a})};var O=n=>{var r;return r=class extends(n||F){static setupFenced(e){let{fenced:t}=e;const i=t.static,s=[];i&&(t={...t},delete t.static,s.push([i,e])),s.push([t,e.prototype]);for(const[a,l]of s)for(const u in a)Y(l,u,a[u])}get widgetClass(){}},d(r,"$name","Fencible"),d(r,"declarable",["fenced"]),r};class S extends k{static get $name(){return"FilterField"}static get type(){return"filterfield"}static get configurable(){return{field:null,store:null,filterFunction:null,clearable:!0,revertOnEscape:!0,keyStrokeChangeDelay:100,onChange({value:r}){const{store:o,field:e,filterFunction:t}=this;if(o){const i=`${e||this.id}-Filter`;if(r.length===0)o.removeFilter(i);else{let s;t?s=a=>t(a,r):(r=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),s=a=>{var l;return(l=a.getValue(e))===null||l===void 0?void 0:l.match(new RegExp(r,"i"))}),o.filter({id:i,filterBy:s})}}}}}updateValue(r,o){super.updateValue(r,o),r&&this.isConfiguring&&this.onChange({value:r})}}S.initClass(),S._$name="FilterField";const q=[],G=n=>n[0]!=="*",x=(n,r)=>{const o=n[r]||null;return delete n[r],o},J=n=>n.responsiveRoot,U={number:n=>({width:r})=>r<=n&&n},j=n=>(delete n.once,{callback:x(n,"callback"),configs:n,when:x(n,"when")}),T=(n,...r)=>{const o=r.flatMap(i=>(i==null?void 0:i.once)||q),e=n.mergeConfigs(...r),t=j(e);return t.once=o.length?j(n.mergeConfigs(...o)):null,t},K=(n,r)=>{let o,e=Proxy.revocable(n,{get(s,a){return o&&(o[a]=!0),n[a]}}),t=P.after(n,"onConfigChange",(s,{name:a})=>{var l;(l=o)!==null&&l!==void 0&&l[a]&&r()}),i=n.ion({resize:()=>{r()}});return n.monitorResize=!0,{widget:n,get object(){var s;return(s=e)===null||s===void 0?void 0:s.proxy},destroy(){e&&(e.revoke(),t(),i(),e=t=i=null)},reset(){o=Object.create(null)}}};var Q=n=>{var r;return r=class extends(n||F).mixin(H,O){get isResponsivePending(){return this.responsiveUpdateCount===0&&this.hasConfig("responsive")}get isResponsiveUpdating(){var e;return this._responsiveUpdating||((e=this.responsiveWidget)===null||e===void 0?void 0:e._responsiveUpdating)}updateResponsive(e){const t=this,i=t.constructor,{responsiveDefaults:s}=t,a=Array.from(new Set(m.keys(e).concat(m.keys(s)))).filter(G);let l=null,u,c,f,v;if(e){l={"*":T(i,s["*"],e["*"])};for(c of a)if(f=e[c],f!==null&&f!==!1){var h;u=u||f&&"when"in f,l[c]=T(i,s["*"],s[c],e["*"],f),v=l[c].when,l[c].when=((h=U[typeof v])===null||h===void 0?void 0:h.call(U,v))||v}}t.$responsiveStates=l,t.$responsiveWhen=u,t.syncResponsiveWidget()}updateResponsiveState(e,t){var i;const s=this,{$responsiveStates:a}=s,l=++s.responsiveStateChanges===1,u=(i=s.element)===null||i===void 0?void 0:i.classList,c=a["*"],f=a[e]||c,v=l&&(f.once||c.once),h=l&&s.isStateful,y=s.responsiveWidget;let p=f.configs,g=v==null?void 0:v.configs;g&&(p=p?s.constructor.mergeConfigs(p,g):g),t&&(u==null||u.remove(`b-responsive-${t.toLowerCase()}`)),e&&(u==null||u.add(`b-responsive-${e.toLowerCase()}`)),h&&(g=s.loadStatefulData(),g&&(p=p?s.constructor.mergeConfigs(p,g):g),s.suspendStateful()),s._responsiveUpdating=!0;try{var C,b,w,R;(C=s.trigger)===null||C===void 0||C.call(s,"beforeResponsiveStateChange",{state:e,oldState:t,target:y}),p&&s.setConfig(p),(b=f.callback)===null||b===void 0||b.call(f,{source:s,state:e,oldState:t,target:y,initial:l}),v==null||(w=v.callback)===null||w===void 0||w.call(v,{source:s,state:e,oldState:t,target:y,initial:l}),(R=s.trigger)===null||R===void 0||R.call(s,"responsiveStateChange",{state:e,oldState:t,target:y})}finally{s._responsiveUpdating=!1,h&&s.resumeStateful()}}get responsiveTarget(){return this.responsiveWidget||this._responsiveTarget}updateResponsiveTarget(){this.syncResponsiveWidget()}updateResponsiveWidget(e){var t;const i=this,s=e&&i.responsiveUpdate;(t=i.$responsiveWrapper)===null||t===void 0||t.destroy(),i.$responsiveWrapper=e&&K(e,s),s==null||s.now()}responsiveUpdate(){const e=this,{$responsiveStates:t,$responsiveWrapper:i}=e,s=i==null?void 0:i.widget;if(t&&i){let a=null,l=0,u=t,c,f;s&&s!==e&&!e.$responsiveWhen&&(s.getConfig("responsive"),u=s.$responsiveStates||u),i.reset();for(f in t)f!=="*"&&(c=u[f].when(i.object,I),c!=null&&c!==!1&&(!a||c<l)&&(a=f,l=c));++e.responsiveUpdateCount,e.responsiveState=a}}syncResponsiveWidget(){const e=this;let t=null,i;if(!e.isDestroying&&e.responsive){if(i=e.responsiveTarget,t=i){if(typeof i=="string"&&(t=i==="@"?e:i[0]==="@"?e[i.substring(1)]:e.up(i),!t))throw new Error(`No match for responsiveTarget="${i}"`)}else{var s;t=!e.responsiveRoot&&((s=e.up)===null||s===void 0?void 0:s.call(e,J))||e}if(!t.isWidget)throw new Error(`${t.constructor.$$name} is not a widget and cannot be a responsiveTarget`)}return e.responsiveWidget=t,t}changeBreakpoints(e){return m.assertObject(e,"breakpoints"),e!=null&&e.width&&Object.keys(e.width).forEach(t=>{e.width[t].maxWidth=t}),e!=null&&e.height&&Object.keys(e.height).forEach(t=>{e.height[t].maxHeight=t}),e}updateBreakpoints(e){e&&(this.monitorResize=!0)}getBreakpoint(e,t){const i=Object.keys(e).map(a=>parseInt(a)).sort(),s=i.find(a=>t<=a);return e[s!=null?s:e["*"]&&"*"]}activateBreakpoint(e,t){const i=this,s=i[`current${e}Breakpoint`];if(t!==s){var a,l;i[`current${e}Breakpoint`]=t,i.setConfig(t.configs),s&&i.element.classList.remove(`b-breakpoint-${s.name.toLowerCase()}`),i.element.classList.add(`b-breakpoint-${t.name.toLowerCase()}`),i.trigger(`responsive${e}Change`,{breakpoint:t,prevBreakpoint:s}),(a=t.callback)===null||a===void 0||a.call(t,{source:i,breakpoint:t,prevBreakpoint:s}),(l=i.recompose)===null||l===void 0||l.call(i)}}applyResponsiveBreakpoints(e,t){var l;const i=this,{width:s,height:a}=(l=i.breakpoints)!=null?l:{};if(s){const u=i.getBreakpoint(s,e);i.activateBreakpoint("Width",u)}if(a){const u=i.getBreakpoint(a,t);i.activateBreakpoint("Height",u)}}onInternalResize(e,t,i,s,a){super.onInternalResize(e,t,i,s,a),this.applyResponsiveBreakpoints(t,i)}},d(r,"$name","Responsive"),d(r,"configurable",{responsive:{$config:{lazy:"paint"},value:null},responsiveDefaults:{small:{when:400},medium:{when:800},large:{when:()=>1/0},"*":{}},responsiveRoot:null,responsiveState:null,responsiveTarget:{value:null,$config:{lazy:"paint"}},responsiveWidget:{value:null,$config:{nullify:!0}},breakpoints:null}),d(r,"delayable",{responsiveUpdate:"raf"}),d(r,"fenced",{syncResponsiveWidget:!0}),d(r,"prototypeProperties",{responsiveStateChanges:0,responsiveUpdateCount:0}),r};export{M as Featureable,O as Fencible,S as FilterField,Q as Responsive};
//# sourceMappingURL=Responsive.js.map
