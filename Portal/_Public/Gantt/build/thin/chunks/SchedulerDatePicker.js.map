{"version":3,"file":"SchedulerDatePicker.js","sources":["../../../../Scheduler/lib/Scheduler/data/util/recurrence/RecurrenceLegend.js","../../../../Scheduler/lib/Scheduler/feature/base/EditBase.js","../../../../Scheduler/lib/Scheduler/view/EventEditor.js","../../../../Scheduler/lib/Scheduler/view/recurrence/field/RecurrenceCombo.js","../../../../Scheduler/lib/Scheduler/view/recurrence/RecurrenceLegendButton.js","../../../../Scheduler/lib/Scheduler/view/recurrence/RecurrenceEditor.js","../../../../Scheduler/lib/Scheduler/feature/mixin/RecurringEventEdit.js","../../../../Scheduler/lib/Scheduler/widget/ResourceCombo.js","../../../../Scheduler/lib/Scheduler/feature/EventEdit.js","../../../../Scheduler/lib/Scheduler/widget/ResourceFilter.js","../../../../Scheduler/lib/Scheduler/widget/SchedulerDatePicker.js"],"sourcesContent":["import Localizable from '../../../../Core/localization/Localizable.js';\nimport DayRuleEncoder from './RecurrenceDayRuleEncoder.js';\nimport DateHelper from '../../../../Core/helper/DateHelper.js';\n\n/**\n * @module Scheduler/data/util/recurrence/RecurrenceLegend\n */\n\n/**\n * A static class allowing to get a human readable description of the provided recurrence.\n *\n * ```javascript\n * const event = new EventModel({\n *      startDate : new Date(2018, 6, 3),\n *      endDate   : new Date(2018, 6, 4)\n * });\n * const recurrence = new RecurrenceModel({\n *      frequency : 'WEEKLY',\n *      days : ['MO', 'TU', 'WE']\n * });\n * event.recurrence = recurrence;\n * // \"Weekly on Mon, Tue and Wed\"\n * RecurrenceLegend.getLegend(recurrence);\n * ```\n *\n * @mixes Core/localization/Localizable\n */\nexport default class RecurrenceLegend extends Localizable() {\n\n    // <debug>\n    // region Localization test\n    static localization = [\n        'L{position1}',\n        'L{position2}',\n        'L{position3}',\n        'L{position4}',\n        'L{position5}',\n        'L{position-1}'\n    ];\n    // endregion\n    // </debug>\n\n    static get $name() {\n        return 'RecurrenceLegend';\n    }\n\n    static get allDaysValueAsArray() {\n        return ['SU', 'MO', 'TU', 'WE', 'TH', 'FR', 'SA'];\n    }\n\n    static get allDaysValue() {\n        return this.allDaysValueAsArray.join(',');\n    }\n\n    static get workingDaysValue() {\n        return this.allDaysValueAsArray.filter((day, index) => !DateHelper.nonWorkingDays[index]).join(',');\n    }\n\n    static get nonWorkingDaysValue() {\n        return this.allDaysValueAsArray.filter((day, index) => DateHelper.nonWorkingDays[index]).join(',');\n    }\n\n    /**\n     * Returns the provided recurrence description. The recurrence might be assigned to a timespan model,\n     * in this case the timespan start date should be provided in the second argument.\n     * @param {Scheduler.model.RecurrenceModel} recurrenceRecurrence model.\n     * @param {Date} [timeSpanStartDate] The recurring timespan start date. Can be omitted if the recurrence is assigned\n     * to a timespan model (and the timespan has {@link Scheduler.model.TimeSpan#field-startDate} filled). Then start\n     * date will be retrieved from the model.\n     * @returns {String} The recurrence description.\n     */\n    static getLegend(recurrence, timeSpanStartDate) {\n        const\n            me                                                         = this,\n            { timeSpan, interval, days, monthDays, months, positions } = recurrence,\n            startDate                                                  = timeSpanStartDate || timeSpan.startDate,\n            tplData                                                    = { interval };\n\n        let fn;\n\n        switch (recurrence.frequency) {\n            case 'DAILY':\n                return interval === 1 ? me.L('L{Daily}') : me.L('L{Every {0} days}', tplData);\n\n            case 'WEEKLY':\n                if (days && days.length) {\n                    tplData.days = me.getDaysLegend(days);\n                }\n                else if (startDate) {\n                    tplData.days = DateHelper.getDayName(startDate.getDay());\n                }\n\n                return me.L(interval === 1 ? 'L{Weekly on {1}}' : 'L{Every {0} weeks on {1}}', tplData);\n\n            case 'MONTHLY':\n                if (days && days.length && positions && positions.length) {\n                    tplData.days = me.getDaysLegend(days, positions);\n                }\n                else if (monthDays && monthDays.length) {\n                    // sort dates to output in a proper order\n                    monthDays.sort((a, b) => a - b);\n\n                    tplData.days = me.arrayToText(monthDays);\n                }\n                else if (startDate) {\n                    tplData.days = startDate.getDate();\n                }\n\n                return me.L(interval === 1 ? 'L{Monthly on {1}}' : 'L{Every {0} months on {1}}', tplData);\n\n            case 'YEARLY':\n\n                if (days && days.length && positions && positions.length) {\n                    tplData.days = me.getDaysLegend(days, positions);\n                }\n                else {\n                    tplData.days = startDate.getDate();\n                }\n\n                if (months && months.length) {\n                    // sort months to output in a proper order\n                    months.sort((a, b) => a - b);\n\n                    if (months.length > 2) {\n                        fn = month => DateHelper.getMonthShortName(month - 1);\n                    }\n                    else {\n                        fn = month => DateHelper.getMonthName(month - 1);\n                    }\n\n                    tplData.months = me.arrayToText(months, fn);\n                }\n                else {\n                    tplData.months = DateHelper.getMonthName(startDate.getMonth());\n                }\n\n                return me.L(interval === 1 ? 'L{Yearly on {1} of {2}}' : 'L{Every {0} years on {1} of {2}}', tplData);\n        }\n    }\n\n    static getDaysLegend(days, positions) {\n        const\n            me      = this,\n            tplData = { position : '' };\n        let fn;\n\n        if (positions && positions.length) {\n            tplData.position = me.arrayToText(positions, position => me.L(`L{position${position}}`));\n        }\n\n        if (days.length) {\n            days.sort((a, b) => DayRuleEncoder.decodeDay(a)[0] - DayRuleEncoder.decodeDay(b)[0]);\n\n            switch (days.join(',')) {\n                case me.allDaysValue :\n                    tplData.days = me.L('L{day}');\n                    break;\n\n                case me.workingDaysValue :\n                    tplData.days = me.L('L{weekday}');\n                    break;\n\n                case me.nonWorkingDaysValue :\n                    tplData.days = me.L('L{weekend day}');\n                    break;\n\n                default :\n                    if (days.length > 2) {\n                        fn = day => DateHelper.getDayShortName(DayRuleEncoder.decodeDay(day)[0]);\n                    }\n                    else {\n                        fn = day => DateHelper.getDayName(DayRuleEncoder.decodeDay(day)[0]);\n                    }\n\n                    tplData.days = me.arrayToText(days, fn);\n            }\n        }\n\n        return me.L('L{daysFormat}', tplData);\n    }\n\n    // Converts array of items to a human readable list.\n    // For example: [1,2,3,4]\n    // to: \"1, 2, 3 and 4\"\n    static arrayToText(array, fn) {\n        if (fn) {\n            array = array.map(fn);\n        }\n\n        return array.join(', ').replace(/,(?=[^,]*$)/, this.L('L{ and }'));\n    }\n\n}\n","import InstancePlugin from '../../../Core/mixin/InstancePlugin.js';\nimport DateField from '../../../Core/widget/DateField.js';\nimport DateHelper from '../../../Core/helper/DateHelper.js';\nimport ObjectHelper from '../../../Core/helper/ObjectHelper.js';\nimport Config from '../../../Core/Config.js';\nimport Objects from '../../../Core/helper/util/Objects.js';\n\n/**\n * @module Scheduler/feature/base/EditBase\n */\n\nconst\n    DH             = DateHelper,\n    scheduleFields = ['startDate', 'endDate', 'resource', 'recurrenceRule'],\n    makeDate       = (fields) => {\n        // single field, update record directly\n        if (fields.length === 1) return fields[0].value;\n        // two fields, date + time\n        else if (fields.length === 2) {\n            const\n                [date, time] = fields[0] instanceof DateField ? fields : fields.reverse(),\n                dateValue    = DH.parse(date.value);\n\n            if (dateValue && time.value) {\n                dateValue.setHours(\n                    time.value.getHours(),\n                    time.value.getMinutes(),\n                    time.value.getSeconds(),\n                    time.value.getMilliseconds()\n                );\n            }\n\n            // Clone to not end up sharing dates\n            return dateValue ? DateHelper.clone(dateValue) : null;\n        }\n        // shouldn't happen...\n        return null;\n    },\n    copyTime       = (dateTo, dateFrom) => {\n        const d = new Date(dateTo.getTime());\n        d.setHours(dateFrom.getHours(), dateFrom.getMinutes());\n        return d;\n    },\n    adjustEndDate  = (startDate, startTime, me) => {\n        // The end datetime just moves in response to the changed start datetime, keeping the same duration.\n        if (startDate && startTime && me.endDateField && me.endTimeField) {\n            const newEndDate = DH.add(copyTime(me.startDateField.value, me.startTimeField.value), me.eventRecord.durationMS, 'milliseconds');\n            me.endDateField.value = newEndDate;\n            me.endTimeField.value = DH.clone(newEndDate);\n        }\n    };\n\n/**\n * Base class for EventEdit. Not to be used directly.\n *\n * @extends Core/mixin/InstancePlugin\n */\nexport default class EditBase extends InstancePlugin {\n    //region Config\n\n    static get configurable() {\n        return {\n            /**\n             * True to save and close this panel if ENTER is pressed in one of the input fields inside the panel.\n             * @config {Boolean}\n             * @default\n             * @category Editor\n             */\n            saveAndCloseOnEnter : true,\n\n            triggerEvent : null,\n\n            /**\n             * This config parameter is passed to the `startDateField` and `endDateField` constructor.\n             * @config {String}\n             * @default\n             * @category Editor widgets\n             */\n            dateFormat : 'L', // date format that uses browser locale\n\n            /**\n             * This config parameter is passed to the `startTimeField` and `endTimeField` constructor.\n             * @config {String}\n             * @default\n             * @category Editor widgets\n             */\n            timeFormat : 'LT', // date format that uses browser locale\n\n            /**\n             * Default editor configuration, which widgets it shows etc.\n             *\n             * This is the entry point into configuring any aspect of the editor.\n             *\n             * The {@link Core.widget.Container#config-items} configuration of a Container\n             * is *deeply merged* with its default `items` value. This means that you can specify\n             * an `editorConfig` object which configures the editor, or widgets inside the editor:\n             * ```javascript\n             * const scheduler = new Scheduler({\n             *     features : {\n             *         eventEdit  : {\n             *             editorConfig : {\n             *                 autoClose : false,\n             *                 modal     : true,\n             *                 cls       : 'editor-widget-cls',\n             *                 items : {\n             *                     resourceField : {\n             *                         hidden : true\n             *                     },\n             *                     // Add our own event owner field at the top of the form.\n             *                     // Weight -100 will make it sort top the top.\n             *                     ownerField : {\n             *                         weight : -100,\n             *                         type   : 'usercombo',\n             *                         name   : 'owner',\n             *                         label  : 'Owner'\n             *                     }\n             *                 },\n             *                 bbar : {\n             *                     items : {\n             *                         deleteButton : false\n             *                     }\n             *                 }\n             *             }\n             *         }\n             *     }\n             * });\n             * ```\n             * @config {PopupConfig}\n             * @category Editor\n             */\n            editorConfig : null,\n\n            /**\n             * An object to merge with the provided items config of the editor to override the\n             * configuration of provided fields, or add new fields.\n             *\n             * To remove existing items, set corresponding keys to `null`:\n             *\n             * ```javascript\n             * const scheduler = new Scheduler({\n             *     features : {\n             *         eventEdit  : {\n             *             items : {\n             *                 // Merged with provided config of the resource field\n             *                 resourceField : {\n             *                     label : 'Calendar'\n             *                 },\n             *                 recurrenceCombo : null,\n             *                 owner : {\n             *                     weight : -100, // Will sort above system-supplied fields which are weight 0\n             *                     type   : 'usercombo',\n             *                     name   : 'owner',\n             *                     label  : 'Owner'\n             *                 }\n             *             }\n             *         }\n             *     }\n             * });\n             *```\n             *\n             * The provided fields are called\n             *  - `nameField`\n             *  - `resourceField`\n             *  - `startDateField`\n             *  - `startTimeField`\n             *  - `endDateField`\n             *  - `endTimeField`\n             *  - `recurrenceCombo`\n             *  - `editRecurrenceButton`\n             * @config {Object<String,ContainerItemConfig|Boolean|null>}\n             * @category Editor widgets\n             */\n            items : null,\n\n            /**\n             * The week start day used in all date fields of the feature editor form by default.\n             * 0 means Sunday, 6 means Saturday.\n             * Defaults to the locale's week start day.\n             * @config {Number}\n             */\n            weekStartDay : null\n        };\n    }\n\n    //endregion\n\n    //region Init & destroy\n\n    construct(client, config) {\n        const me = this;\n\n        client.eventEdit = me;\n\n        super.construct(client, ObjectHelper.assign({\n            weekStartDay : client.weekStartDay\n        }, config));\n\n        me.clientListenersDetacher = client.ion({\n            [me.triggerEvent] : 'onActivateEditor',\n            dragCreateEnd     : 'onDragCreateEnd',\n\n            // Not fired at the Scheduler level.\n            // Calendar, which inherits this, implements this event.\n            eventAutoCreated : 'onEventAutoCreated',\n            thisObj          : me\n        });\n    }\n\n    doDestroy() {\n        this.clientListenersDetacher();\n\n        this._editor?.destroy();\n\n        super.doDestroy();\n    }\n\n    //endregion\n\n    //region Editing\n\n    // Not implemented at this level.\n    // Scheduler Editing relies on being called at point of event creation.\n    onEventAutoCreated() {}\n\n    changeEditorConfig(editorConfig) {\n        const { items } = this;\n\n        // Merge items which is an Object with the default editorConfig's items\n        if (items) {\n            editorConfig = Objects.clone(editorConfig);\n            editorConfig.items = Config.merge(items, editorConfig.items);\n        }\n\n        return editorConfig;\n    }\n\n    changeItems(items) {\n        this.cleanItemsConfig(items);\n        return items;\n    }\n\n    // Remove any items configured as === true which just means default config options\n    cleanItemsConfig(items) {\n        for (const ref in items) {\n            const itemCfg = items[ref];\n\n            if (itemCfg === true) {\n                delete items[ref];\n            }\n            else if (itemCfg?.items) {\n                this.cleanItemsConfig(itemCfg.items);\n            }\n        }\n    }\n\n    onDatesChange(params) {\n        const\n            me    = this,\n            field = params.source,\n            value = params.value;\n\n        // End date can never be less than start date\n        if (me.startDateField && me.endDateField) {\n            me.endDateField.min = me.startDateField.value;\n        }\n\n        if (me.endTimeField) {\n            // If the event starts and ends on the same day, the time fields need\n            // to have their min and max set against each other.\n            if (DH.isEqual(DH.clearTime(me.startDateField?.value), DH.clearTime(me.endDateField?.value))) {\n                me.endTimeField.min = me.startTimeField.value;\n            }\n            else {\n                me.endTimeField.min = null;\n            }\n        }\n\n        switch (field.ref) {\n            case 'startDateField':\n                me.startTimeField?.value && adjustEndDate(value, me.startTimeField.value, me);\n                break;\n\n            case 'startTimeField':\n                me.startDateField?.value && adjustEndDate(me.startDateField.value, value, me);\n                break;\n        }\n    }\n\n    //endregion\n\n    //region Save\n\n    async save() {\n        throw new Error('Implement in subclass');\n    }\n\n    get values() {\n        const\n            me          = this,\n            { editor }  = me,\n            startFields = [],\n            endFields   = [],\n            { values }  = editor;\n\n        // The standard values getter will produce (almost) what we want, however, there are some special fields that\n        // we need to take over. Remove those fields:\n        scheduleFields.forEach(f => delete values[f]);\n\n        editor.eachWidget(widget => {\n            const { name } = widget;\n\n            // If the widget is part of the recurrence editor, we don't gather it.\n            if (!name || widget.hidden || widget.up(w => w === me.recurrenceEditor)) {\n                delete values[name];\n                return;\n            }\n\n            switch (name) {\n                case 'startDate':\n                    startFields.push(widget);\n                    break;\n                case 'endDate':\n                    endFields.push(widget);\n                    break;\n                case 'resource':\n                    values[name] = widget.record;\n                    break;\n                case 'recurrenceRule':\n                    // If recurrence set to null, completely clear the recurrenceRule.\n                    // Otherwise it will still be perceived as recurring with the rule 'FREQ=none'\n                    values[name] = editor.widgetMap.recurrenceCombo?.value === 'none' ? '' : widget.value;\n                    break;\n                // Ignore other widgets and allow the standard values getter to provide them:\n                // default:\n                //     values[name] = widget.value;\n            }\n        }, true);\n\n        // if is changing from not allDay to allDay should consider time fields to not change them on makeDate\n        if (values.allDay && !me.eventRecord.allDay) {\n            startFields.push(me.startTimeField);\n            endFields.push(me.endTimeField);\n        }\n\n        // Handle fields being configured away\n        if (startFields.length) {\n            values.startDate = makeDate(startFields);\n        }\n        if (endFields.length) {\n            values.endDate = makeDate(endFields);\n        }\n\n        // Since there is no duration field in the editor,\n        // we don't need to recalc duration value on each date change.\n        // It's enough to return correct duration value in `values`,\n        // so the record will get updated with the correct data.\n        if (('startDate' in values) && ('endDate' in values)) {\n            values.duration = DH.diff(values.startDate, values.endDate, me.editor.record.durationUnit, true);\n        }\n\n        return values;\n    }\n\n    /**\n     * Template method, intended to be overridden. Called before the event record has been updated.\n     * @param {Scheduler.model.EventModel} eventRecord The event record\n     *\n     **/\n    onBeforeSave(eventRecord) {}\n\n    /**\n     * Template method, intended to be overridden. Called after the event record has been updated.\n     * @param {Scheduler.model.EventModel} eventRecord The event record\n     *\n     **/\n    onAfterSave(eventRecord) {}\n\n    /**\n     * Updates record being edited with values from the editor\n     * @private\n     */\n    updateRecord(record) {\n        const { values } = this;\n\n        // Clean resourceId / resources out of values when using assignment store, it will handle the assignment\n        if (this.assignmentStore) {\n            delete values.resource;\n        }\n\n        return record.set(values);\n    }\n\n    //endregion\n\n    //region Events\n\n    onBeforeEditorShow() {\n        const\n            { eventRecord, editor } = this.editingContext,\n            { nameField } = editor.widgetMap;\n\n        // Editing new event. Make sure user doesn't have to clear the input field.\n        // Record field value still should be there because a rendered event block\n        // looks bad with no text in it.\n        // nameField may have been configured away.\n        if (nameField && eventRecord.isCreating) {\n            // Avoid initial invalid because required state.\n            editor.assigningValues = true;\n            nameField.value = '';\n            editor.assigningValues = false;\n\n            // Show new event text as a placeholder\n            nameField._configuredPlaceholder = nameField.placeholder;\n            nameField.placeholder = eventRecord.name;\n        }\n    }\n\n    resetEditingContext() {\n        const me = this;\n\n        if (!me.editingContext) {\n            return;\n        }\n\n        const\n            { client }              = me,\n            { editor, eventRecord } = me.editingContext,\n            { eventStore }          = client,\n            { nameField }           = editor.widgetMap;\n\n        // This will remove the record from the store, *and* from the added bag, so no sync will take place.\n        if (eventRecord.isCreating) {\n            // Ensure that during the engine's async processing of the remove, the element is non-interactive.\n            // Mousedown on the just-created element itself passes through here, and the immediate mouseup\n            // after that instigates a click which will find no corresponding event.\n            if (client.isTimelineBase) {\n                me.editingContext.eventElement?.closest('[data-event-id]').classList.add('b-released');\n            }\n\n            eventStore.remove(eventRecord);\n\n            // Clear isCreating *after* removal.\n            // Store doesn't register as a removed record if isCreating is set\n            eventRecord.isCreating = false;\n        }\n\n        // Revert any placeholder that we may have set\n        // nameField may have been configured away.\n        if (nameField) {\n            nameField.placeholder = nameField._configuredPlaceholder;\n        }\n\n        client.element.classList.remove('b-eventeditor-editing');\n\n        // Reset context\n        me.targetEventElement = me.editingContext = editor._record = null;\n    }\n\n    onPopupKeyDown({ event }) {\n        const me = this;\n\n        if (!me.readOnly && event.key === 'Enter' && me.saveAndCloseOnEnter && event.target.tagName.toLowerCase() === 'input') {\n            // Need to prevent this key events from being fired on whatever receives focus after the editor is hidden\n            event.preventDefault();\n\n            // If enter key was hit in an input element of a start field, need to adjust end date fields (the same way as if #onDatesChange handler was called)\n            if (event.target.name === 'startDate') {\n                me.startTimeField && adjustEndDate(me.startDateField.value, me.startTimeField.value, me);\n            }\n\n            me.onSaveClick();\n        }\n    }\n\n    async finalizeStmCapture(saved) {\n    }\n\n    async onSaveClick() {\n        // <remove-on-release>\n        // TODO: add new API on Container: blurFocusedField which manages this scenario\n        //  of blurring active field just before hiding\n        // </remove-on-release>\n        this.editor.focus();\n\n        this.isFinalizingEventSave = true;\n\n        const saved = await this.save();\n\n        this.isFinalizingEventSave = false;\n\n        if (saved) {\n            await this.finalizeStmCapture(false);\n\n            this.editor.close();\n\n            /**\n             * Fires on the owning Scheduler after editor is closed by any action - save, delete or cancel\n             * @event afterEventEdit\n             * @on-owner\n             * @param {Scheduler.view.Scheduler} source The scheduler\n             */\n            this.client.trigger('afterEventEdit');\n        }\n        return saved;\n    }\n\n    async onDeleteClick() {\n        // `deleteEvent` call actually additionally closes the editor for some reason\n        // see the comment for `editor.revertFocus();` call in EventEdit.js feature\n        // that triggers `resetEditingContext` in which by default we assume canceling flow\n        // so we need to detect that context is being reset for delete action somehow\n        this.isDeletingEvent = true;\n\n        const removed = await this.deleteEvent();\n\n        this.isDeletingEvent = false;\n\n        if (removed) {\n            await this.finalizeStmCapture(false);\n\n            const { editor } = this;\n            // We expect deleteEvent will trigger close if autoClose is true and focus has moved out,\n            // otherwise need to call it manually\n            if (!editor.autoClose || editor.containsFocus) {\n                editor.close();\n            }\n            this.client.trigger('afterEventEdit');\n        }\n    }\n\n    async onCancelClick() {\n        this.isCancelingEdit = true;\n\n        this.editor.close();\n\n        this.isCancelingEdit = false;\n\n        if (this.hasStmCapture) {\n            await this.finalizeStmCapture(true);\n        }\n\n        this.client.trigger('afterEventEdit');\n    }\n\n    //endregion\n}\n","import Store from '../../Core/data/Store.js';\nimport Popup from '../../Core/widget/Popup.js';\nimport '../../Core/widget/SlideToggle.js';\n\n/**\n * @module Scheduler/view/EventEditor\n */\n\n/**\n * Provided event editor dialog.\n *\n * @extends Core/widget/Popup\n * @private\n */\nexport default class EventEditor extends Popup {\n    // Factoryable type name\n    static get type() {\n        return 'eventeditor';\n    }\n\n    static get $name() {\n        return 'EventEditor';\n    }\n\n    static get configurable() {\n        return {\n            items     : [],\n            draggable : {\n                handleSelector : ':not(button,.b-field-inner)' // Ignore buttons and field inners\n            },\n            axisLock : 'flexible',\n\n            scrollable : {\n                // In case editor is very tall or window is small, make it scrollable\n                overflowY : true\n            },\n            readOnly : null,\n\n            /**\n             * A Function (or *name* of a function) which produces a customized Panel header based upon the event being edited.\n             * @config {Function|String}\n             * @param {Scheduler.model.EventModel} eventRecord The record being edited\n             * @returns {String} The Panel title.\n             */\n            titleRenderer : null,\n\n            // We want to maximize on phones and tablets\n            maximizeOnMobile : true\n        };\n    }\n\n    updateLocalization() {\n        super.updateLocalization(...arguments);\n\n        // Use this if there's no titleRenderer\n        this.initialTitle = this.title || '';\n    }\n\n    chainResourceStore() {\n        return this.eventEditFeature.resourceStore.chain(\n            record => !record.isSpecialRow,\n            null,\n            {\n                // It doesn't need to be a Project-based Store\n                storeClass              : Store,\n                // Need to show all records in the combo. Required in case resource store is a tree.\n                excludeCollapsedRecords : false\n            }\n        );\n    }\n\n    processWidgetConfig(widget) {\n        if (widget.type?.includes('date') && widget.weekStartDay == null) {\n            widget.weekStartDay = this.weekStartDay;\n        }\n\n        if (widget.type === 'extraItems') {\n            return false;\n        }\n\n        const\n            { eventEditFeature } = this,\n            fieldConfig          = {};\n\n        if (widget.ref === 'resourceField') {\n            const { store } = widget;\n\n            // Can't use store directly since it may be grouped and then contains irrelevant group records\n            widget.store = this.chainResourceStore();\n\n            // Allow the incoming widget's config to augment its store\n            if (store) {\n                widget.store.setConfig(store);\n            }\n\n            // When events are loaded with resourceId, we should only support single select.\n            // Only override this if the widget has not been explicitly configured\n            // with multiSelect.\n            if (!('multiSelect' in widget)) {\n                widget.multiSelect = !eventEditFeature.eventStore.usesSingleAssignment;\n            }\n        }\n\n        if ((widget.name === 'startDate' || widget.name === 'endDate') && widget.type === 'date') {\n            fieldConfig.format = eventEditFeature.dateFormat;\n        }\n\n        if ((widget.name === 'startDate' || widget.name === 'endDate') && widget.type === 'time') {\n            fieldConfig.format = eventEditFeature.timeFormat;\n        }\n\n        Object.assign(widget, fieldConfig);\n\n        return super.processWidgetConfig(widget);\n    }\n\n    setupEditorButtons() {\n        const\n            { record }       = this,\n            { deleteButton } = this.widgetMap;\n\n        // Hide delete button if we are readOnly or the event is in a create phase\n        // which means we are editing a dblclick-created or drag-created event.\n        if (deleteButton) {\n            deleteButton.hidden = this.readOnly || record.isCreating;\n        }\n    }\n\n    onBeforeShow(...args) {\n        const\n            me               = this,\n            {\n                record,\n                titleRenderer\n            }                = me;\n\n        me.setupEditorButtons();\n\n        if (titleRenderer) {\n            me.title = me.callback(titleRenderer, me, [record]);\n        }\n        else {\n            me.title = me.initialTitle;\n        }\n\n        super.onBeforeShow?.(...args);\n    }\n\n    onInternalKeyDown(event) {\n        this.trigger('keyDown', { event });\n        super.onInternalKeyDown(event);\n    }\n\n    updateReadOnly(readOnly) {\n        const\n            {\n                deleteButton,\n                saveButton,\n                cancelButton\n            } = this.widgetMap;\n\n        super.updateReadOnly(readOnly);\n\n        if (deleteButton) {\n            deleteButton.hidden = readOnly;\n        }\n\n        if (saveButton) {\n            saveButton.hidden = readOnly;\n        }\n\n        if (cancelButton) {\n            cancelButton.hidden = readOnly;\n        }\n    }\n}\n\n// Register this widget type with its Factory\nEventEditor.initClass();\n","import RecurrenceFrequencyCombo from './RecurrenceFrequencyCombo.js';\n\n/**\n * @module Scheduler/view/recurrence/field/RecurrenceCombo\n */\n\n/**\n * A combobox field for selecting a recurrence pattern: `Daily`, `Weekly`, `Monthly` or `Yearly` if the recurrence\n * has no other non-default settings, or `Custom...` if the recurrence has custom setting applied.\n *\n * {@inlineexample Scheduler/view/RecurrenceCombo.js}\n *\n * @extends Scheduler/view/recurrence/field/RecurrenceFrequencyCombo\n * @classType recurrencecombo\n */\nexport default class RecurrenceCombo extends RecurrenceFrequencyCombo {\n\n    static get $name() {\n        return 'RecurrenceCombo';\n    }\n\n    // Factoryable type name\n    static get type() {\n        return 'recurrencecombo';\n    }\n\n    static get defaultConfig() {\n        return {\n            customValue             : 'custom',\n            placeholder             : 'None',\n            // <remove-on-release>\n            // TODO: draw a splitting line\n            // </remove-on-release>\n            splitCls                : 'b-recurrencecombo-split',\n            items                   : true,\n            highlightExternalChange : false\n        };\n    }\n\n    buildItems() {\n        const me = this;\n\n        return [\n            { value : 'none', text : 'L{None}' },\n            ...super.buildItems(),\n            { value : me.customValue, text : 'L{Custom}', cls : me.splitCls }\n        ];\n    }\n\n    set value(value) {\n        // Use 'none' instead of falsy value\n        value = value || 'none';\n\n        super.value = value;\n    }\n\n    get value() {\n        return super.value;\n    }\n\n    set recurrence(recurrence) {\n        const me = this;\n\n        if (recurrence) {\n            me.value = me.isCustomRecurrence(recurrence) ? me.customValue : recurrence.frequency;\n        }\n        else {\n            me.value = null;\n        }\n    }\n\n    isCustomRecurrence(recurrence) {\n        const { interval, days, monthDays, months } = recurrence;\n\n        return Boolean(interval > 1 || (days && days.length) || (monthDays && monthDays.length) || (months && months.length));\n    }\n};\n\n// Register this widget type with its Factory\nRecurrenceCombo.initClass();\n","import Button from '../../../Core/widget/Button.js';\nimport RecurrenceLegend from '../../data/util/recurrence/RecurrenceLegend.js';\n\n/**\n * @module Scheduler/view/recurrence/RecurrenceLegendButton\n */\n\n/**\n * A button which displays the associated {@link #property-recurrence} info in a human readable form.\n * @extends Core/widget/Button\n * @classType recurrencelegendbutton\n */\nexport default class RecurrenceLegendButton extends Button {\n\n    static get $name() {\n        return 'RecurrenceLegendButton';\n    }\n\n    // Factoryable type name\n    static get type() {\n        return 'recurrencelegendbutton';\n    }\n\n    static get defaultConfig() {\n        return {\n            localizableProperties : [],\n            recurrence            : null\n        };\n    }\n\n    /**\n     * Sets / gets the recurrence to display description for.\n     * @property {Scheduler.model.RecurrenceModel}\n     */\n    set recurrence(recurrence) {\n        this._recurrence = recurrence;\n        this.updateLegend();\n    }\n\n    get recurrence() {\n        return this._recurrence;\n    }\n\n    set eventStartDate(eventStartDate) {\n        this._eventStartDate = eventStartDate;\n        this.updateLegend();\n    }\n\n    get eventStartDate() {\n        return this._eventStartDate;\n    }\n\n    updateLegend() {\n        const { recurrence } = this;\n\n        this.text = recurrence ? RecurrenceLegend.getLegend(recurrence, this.eventStartDate) : '';\n    }\n\n    onLocaleChange() {\n        // on locale switch we update the button text to use proper language\n        this.updateLegend();\n    }\n\n    updateLocalization() {\n        this.onLocaleChange();\n        super.updateLocalization();\n    }\n}\n\n// Register this widget type with its Factory\nRecurrenceLegendButton.initClass();\n","import Popup from '../../../Core/widget/Popup.js';\nimport './RecurrenceEditorPanel.js';\n\n/**\n * @module Scheduler/view/recurrence/RecurrenceEditor\n */\n\n/**\n * Class implementing a dialog to edit a {@link Scheduler.model.RecurrenceModel recurrence model}. The class is used by\n * the {@link Scheduler.view.mixin.RecurringEvents recurring events} feature, and you normally don't need to instantiate\n * it.\n *\n * Before showing the dialog need to use {@link Core.widget.Container#property-record} to load a\n * {@link Scheduler.model.RecurrenceModel recurrence model} data into the editor fields. For example:\n *\n * ```javascript\n * // make the editor instance\n * const editor = new RecurrenceEditor();\n * // load recurrence model into it\n * editor.record = new RecurrenceModel({ frequency : \"WEEKLY\" });\n * // display the editor\n * editor.show();\n * ```\n *\n * @extends Core/widget/Popup\n * @classType recurrenceeditor\n */\nexport default class RecurrenceEditor extends Popup {\n\n    // <debug>\n    // region Localization test\n    static localization = [\n        'L{DAILYintervalUnit}',\n        'L{WEEKLYintervalUnit}',\n        'L{MONTHLYintervalUnit}',\n        'L{YEARLYintervalUnit}'\n    ];\n    // endregion\n    // </debug>\n\n    static get $name() {\n        return 'RecurrenceEditor';\n    }\n\n    // Factoryable type name\n    static get type() {\n        return 'recurrenceeditor';\n    }\n\n    static get configurable() {\n        return {\n            draggable : true,\n            closable  : true,\n            floating  : true,\n            cls       : 'b-recurrenceeditor',\n            title     : 'L{Repeat event}',\n            autoClose : true,\n            width     : 470,\n            items     : {\n                recurrenceEditorPanel : {\n                    type  : 'recurrenceeditorpanel',\n                    title : null\n                }\n            },\n            bbar : {\n                defaults : {\n                    localeClass : this\n                },\n                items : {\n                    foo : {\n                        type   : 'widget',\n                        cls    : 'b-label-filler',\n                        weight : 100\n                    },\n                    saveButton : {\n                        color   : 'b-green',\n                        text    : 'L{Save}',\n                        onClick : 'up.onSaveClick',\n                        weight  : 200\n                    },\n                    cancelButton : {\n                        color   : 'b-gray',\n                        text    : 'L{Object.Cancel}',\n                        onClick : 'up.onCancelClick',\n                        weight  : 300\n                    }\n                }\n            },\n            scrollable : {\n                overflowY : true\n            }\n        };\n    }\n\n    updateReadOnly(readOnly) {\n        super.updateReadOnly(readOnly);\n\n        // No save or cancel buttons. It's purely for information display when in readOnly mode\n        this.bbar.hidden = readOnly;\n    }\n\n    get recurrenceEditorPanel() {\n        return this.widgetMap.recurrenceEditorPanel;\n    }\n\n    updateRecord(record) {\n        this.recurrenceEditorPanel.record = record;\n    }\n\n    onSaveClick() {\n        const me = this;\n\n        if (me.saveHandler) {\n            me.saveHandler.call(me.thisObj || me, me, me.record);\n        }\n        else {\n            me.recurrenceEditorPanel.syncEventRecord();\n            me.close();\n        }\n    }\n\n    onCancelClick() {\n        const me = this;\n\n        if (me.cancelHandler) {\n            me.cancelHandler.call(me.thisObj || me, me, me.record);\n        }\n        else {\n            me.close();\n        }\n    }\n\n}\n\n// Register this widget type with its Factory\nRecurrenceEditor.initClass();\n","import Widget from '../../../Core/widget/Widget.js';\nimport Base from '../../../Core/Base.js';\nimport '../../view/recurrence/RecurrenceConfirmationPopup.js';\nimport '../../view/recurrence/field/RecurrenceCombo.js';\nimport '../../view/recurrence/RecurrenceLegendButton.js';\nimport '../../view/recurrence/RecurrenceEditor.js';\n\n/**\n * @module Scheduler/feature/mixin/RecurringEventEdit\n */\n\n/**\n * This mixin class provides recurring events functionality to the {@link Scheduler.feature.EventEdit event editor}.\n * @mixin\n */\nexport default Target => class RecurringEventEdit extends (Target || Base) {\n    static get $name() {\n        return 'RecurringEventEdit';\n    }\n\n    static get configurable() {\n        return {\n            recurringEventsItems : {\n                /**\n                 * Reference to the `Repeat` event field, if used\n                 * @member {Scheduler.view.recurrence.field.RecurrenceCombo} recurrenceCombo\n                 * @readonly\n                 */\n                recurrenceCombo : {\n                    type   : 'recurrencecombo',\n                    label  : 'L{EventEdit.Repeat}',\n                    ref    : 'recurrenceCombo',\n                    weight : 700\n                },\n                /**\n                 * Reference to the button that opens the event repeat settings dialog, if used\n                 * @member {Scheduler.view.recurrence.RecurrenceLegendButton} editRecurrenceButton\n                 * @readonly\n                 */\n                editRecurrenceButton : {\n                    type                 : 'recurrencelegendbutton',\n                    ref                  : 'editRecurrenceButton',\n                    name                 : 'recurrenceRule',\n                    color                : 'b-gray',\n                    menuIcon             : null,\n                    flex                 : 1,\n                    weight               : 800,\n                    ignoreParentReadOnly : true\n                }\n            },\n\n            /**\n             * Set to `false` to hide recurring fields in event editor, even if the\n             * {@link Scheduler.view.mixin.RecurringEvents#config-enableRecurringEvents Recurring Events} is `true`\n             * and a recurring event is being edited.\n             * @config {Boolean}\n             * @category Recurring\n             */\n            showRecurringUI : null\n        };\n    }\n\n    changeEditorConfig(editorConfig) {\n        editorConfig.items = { ...editorConfig.items, ...this.recurringEventsItems };\n\n        // EditBase inserts extraItems *after* all default items are in\n        editorConfig = super.changeEditorConfig(editorConfig);\n\n        return editorConfig;\n    }\n\n    doDestroy() {\n        this._recurrenceConfirmation?.destroy();\n        this._recurrenceEditor?.destroy();\n\n        super.doDestroy();\n    }\n\n    onEditorConstructed(editor) {\n        const me = this;\n\n        editor.ion({\n            hide    : me.onRecurringEventEditorHide,\n            thisObj : me\n        });\n\n        if (me.editRecurrenceButton) {\n            me.editRecurrenceButton.menu = me.recurrenceEditor;\n        }\n\n        me.recurrenceCombo?.ion({\n            change  : me.onRecurrenceComboChange,\n            thisObj : me\n        });\n    }\n\n    updateReadOnly(readOnly) {\n        if (this._recurrenceEditor) {\n            this._recurrenceEditor.readOnly = readOnly;\n        }\n    }\n\n    internalShowEditor() {\n        this.toggleRecurringFieldsVisibility(this.client.enableRecurringEvents && this.showRecurringUI !== false);\n    }\n\n    toggleRecurringFieldsVisibility(show = true) {\n        const methodName = show ? 'show' : 'hide';\n\n        this.editRecurrenceButton?.[methodName]?.();\n        this.recurrenceCombo?.[methodName]?.();\n    }\n\n    onRecurringEventEditorHide() {\n        if (this.recurrenceEditor?.isVisible) {\n            this.recurrenceEditor.hide();\n        }\n\n        if (this.recurrenceConfirmation?.isVisible) {\n            this.recurrenceConfirmation.hide();\n        }\n    }\n\n    // Builds RecurrenceModel to load into the recurrenceEditor\n    // It builds the model based on either:\n    // - recurrence rule string (if provided)\n    // - or the event being edited recurrence (if the event is repeating)\n    // - or simply make a recurrence model w/ default state (by default means: Frequency=Daily, Interval=1)\n    makeRecurrence(rule) {\n        const\n            event     = this.eventRecord,\n            eventCopy = event.copy();\n\n        let recurrence = event.recurrence;\n\n        if (!rule && recurrence) {\n            recurrence = recurrence.copy();\n        }\n        else {\n            recurrence = new event.recurrenceModel(rule ? { rule } : {});\n        }\n\n        // bind cloned recurrence to the cloned event\n        recurrence.timeSpan = eventCopy;\n        // update cloned event w/ start date from the UI field\n        eventCopy.setStartDate(this.values.startDate);\n\n        recurrence.suspendTimeSpanNotifying();\n\n        return recurrence;\n    }\n\n    onRecurrableEventBeforeSave({ eventRecord, context }) {\n        const me = this;\n\n        // Other views features may trigger beforeEventSave, so only react when *we* are editing.\n        if (me.isEditing && !eventRecord.isCreating && eventRecord.supportsRecurring &&\n                (eventRecord.isRecurring || eventRecord.isOccurrence)) {\n            me.recurrenceConfirmation.confirm({\n                actionType : 'update',\n                eventRecord,\n                changerFn() {\n                    context.finalize(true);\n                },\n                cancelFn() {\n                    context.finalize(false);\n                }\n            });\n\n            // signalizes that we plan to decide save or not asynchronously\n            context.async = true;\n        }\n    }\n\n    set recurrenceConfirmation(recurrenceConfirmation) {\n        this._recurrenceConfirmation = recurrenceConfirmation;\n    }\n\n    get recurrenceConfirmation() {\n        const me = this;\n\n        let recurrenceConfirmation = me._recurrenceConfirmation;\n\n        if (!recurrenceConfirmation || !recurrenceConfirmation.$$name) {\n            recurrenceConfirmation = Widget.create({\n                type  : 'recurrenceconfirmation',\n                owner : me.editor,\n                ...recurrenceConfirmation\n            });\n\n            me._recurrenceConfirmation = recurrenceConfirmation;\n        }\n\n        return recurrenceConfirmation;\n    }\n\n    set recurrenceEditor(recurrenceEditor) {\n        this._recurrenceEditor = recurrenceEditor;\n    }\n\n    get recurrenceEditor() {\n        const me = this;\n\n        let recurrenceEditor = me._recurrenceEditor;\n\n        // Recurrence editor is centered and modal.\n        if (!recurrenceEditor || !recurrenceEditor.$$name) {\n            me._recurrenceEditor = recurrenceEditor = Widget.create({\n                type         : 'recurrenceeditor',\n                autoShow     : false,\n                centered     : true,\n                modal        : true,\n                // It's used as the Menu of a Button which syncs the width unless it's already set\n                minWidth     : 'auto',\n                constrainTo  : globalThis,\n                anchor       : false,\n                rootElement  : me.rootElement,\n                saveHandler  : me.recurrenceEditorSaveHandler,\n                onBeforeShow : me.onBeforeShowRecurrenceEditor.bind(me),\n                thisObj      : me,\n                ...recurrenceEditor\n            });\n\n            // Must set *after* construction, otherwise it becomes the default state\n            // to reset readOnly back to.  Must use direct property access because\n            // getter consults state of editor.\n            recurrenceEditor.readOnly = me._readOnly;\n        }\n\n        return recurrenceEditor;\n    }\n\n    onBeforeShowRecurrenceEditor() {\n        const\n            me                                = this,\n            { recurrenceEditor, eventRecord } = me;\n\n        if (recurrenceEditor && eventRecord?.supportsRecurring) {\n            // if the event has no recurrence yet ..initialize it before showing recurrence editor\n            if (!me.recurrence) {\n                me.recurrence = me.makeRecurrence();\n            }\n\n            // update the cloned recurrence w/ up to date start date value\n            me.recurrence.timeSpan.setStartDate(me.values.startDate);\n\n            // load RecurrenceModel record into the recurrence editor\n            recurrenceEditor.record = me.recurrence;\n\n            // In case they drag it. Centered falls off if the widget has position set.\n            recurrenceEditor.centered = true;\n        }\n    }\n\n    loadRecurrenceData(recurrence) {\n        this.recurrence = recurrence;\n\n        this.updateRecurrenceFields(recurrence);\n    }\n\n    updateRecurrenceFields(recurrence) {\n        const\n            me                       = this,\n            { editRecurrenceButton } = me;\n\n        if (me.recurrenceCombo) {\n            me.recurrenceCombo.recurrence = recurrence;\n        }\n\n        // update the recurrence legend\n        if (editRecurrenceButton) {\n            editRecurrenceButton.recurrence = recurrence;\n            editRecurrenceButton.value = recurrence ? recurrence.rule : null;\n\n            if (recurrence && me.client.enableRecurringEvents && me.showRecurringUI !== false) {\n                editRecurrenceButton.show();\n            }\n            else {\n                editRecurrenceButton.hide();\n            }\n        }\n    }\n\n    onRecurrenceComboChange({ source, value, userAction }) {\n        if (userAction) {\n            const\n                me                   = this,\n                { recurrenceEditor } = me;\n\n            if (value === source.customValue) {\n                // if user picked \"Custom\" - show recurrence editor\n                // This will recurse through the change event into the opposite side\n                // of the value test which will call updateRecurrenceFields, where the\n                // assignment to the value of the recurrenceCombo will be a non-change.\n                // That will sync the state of the recurrenceButton.\n                me.recurrenceCombo.recurrence = me.makeRecurrence();\n\n                if (recurrenceEditor.centered) {\n                    recurrenceEditor.show();\n                }\n                else {\n                    recurrenceEditor.show((me.editRecurrenceButton || source).element);\n                }\n            }\n            // user has picked some frequency -> make a new recurrence based on it\n            else {\n                me.loadRecurrenceData(value && value !== 'none' ? me.makeRecurrence(`FREQ=${value}`) : null);\n            }\n        }\n    }\n\n    recurrenceEditorSaveHandler(editor, recurrence) {\n        // apply changes to the kept recurrence\n        editor.recurrenceEditorPanel.syncEventRecord(recurrence);\n\n        // update the recurrence related UI\n        this.updateRecurrenceFields(recurrence);\n\n        editor.close();\n    }\n\n    onDatesChange(...args) {\n        super.onDatesChange(...args);\n\n        if (!this.loadingRecord && this.editRecurrenceButton) {\n            const { startDate } = this.values;\n\n            if (startDate) {\n                this.editRecurrenceButton.eventStartDate = startDate;\n            }\n        }\n    }\n\n    internalLoadRecord(eventRecord) {\n        if (eventRecord?.supportsRecurring) {\n            this.loadRecurrenceData(eventRecord.recurrence ? this.makeRecurrence() : null);\n        }\n    }\n\n    updateRecord(record) {\n        // Special handling for when setting recurrence to \"None\". Since button gets hidden its value is not picked up\n        // by the normal flow.\n        if (record.recurrenceRule && !this.recurrence) {\n            record.recurrenceRule = null;\n        }\n\n        return super.updateRecord(record);\n    }\n};\n","import Combo from '../../Core/widget/Combo.js';\nimport DomHelper from '../../Core/helper/DomHelper.js';\n\n/**\n * @module Scheduler/widget/ResourceCombo\n */\n\n/**\n * A Combo subclass which selects resources, optionally displaying the {@link Scheduler.model.ResourceModel#field-eventColor}\n * of each resource in the picker and in the input area.\n *\n * {@inlineexample Scheduler/widget/ResourceCombo.js}\n *\n * @extends Core/widget/Combo\n * @classType resourcecombo\n * @inputfield\n */\nexport default class ResourceCombo extends Combo {\n    static get $name() {\n        return 'ResourceCombo';\n    }\n\n    // Factoryable type name\n    static get type() {\n        return 'resourcecombo';\n    }\n\n    static get configurable() {\n        return {\n            /**\n             * Show the {@link Scheduler.model.ResourceModel#field-eventColor event color} for each resource\n             * @config {Boolean}\n             * @default\n             */\n            showEventColor : false,\n\n            displayField : 'name',\n            valueField   : 'id',\n\n            picker : {\n                cls : 'b-resourcecombo-picker',\n\n                itemIconTpl(record) {\n                    const\n                        { eventColor } = record,\n                        isStyleColor   = !DomHelper.isNamedColor(eventColor),\n                        style          = eventColor ? (isStyleColor ? ` style=\"color:${eventColor}\"` : '') : ' style=\"display:none\"',\n                        colorClass     = !eventColor || isStyleColor ? '' : ` b-sch-foreground-${eventColor}`;\n\n                    return `<div class=\"b-icon b-icon-square${colorClass}\"${style}></div>`;\n                }\n            }\n        };\n    }\n\n    changeShowEventColor(showEventColor) {\n        return Boolean(showEventColor);\n    }\n\n    updateShowEventColor(showEventColor) {\n        const\n            { _picker } = this,\n            methodName  = showEventColor ? 'add' : 'remove';\n\n        this.element.classList[methodName]('b-show-event-color');\n        _picker?.element.classList[methodName]('b-show-event-color');\n    }\n\n    changePicker(picker, oldPicker) {\n        picker = super.changePicker(picker, oldPicker);\n        picker?.element.classList[this.showEventColor ? 'add' : 'remove']('b-show-event-color');\n        return picker;\n    }\n\n    // Implementation needed at this level because it has two inner elements in its inputWrap\n    get innerElements() {\n        return [\n            {\n                class     : 'b-icon b-resource-icon b-icon-square b-hide-display',\n                reference : 'resourceIcon'\n            },\n            this.inputElement\n        ];\n    }\n\n    syncInputFieldValue() {\n        const\n            me            = this,\n            {\n                resourceIcon,\n                lastResourceIconCls\n            }             = me,\n            { classList } = resourceIcon,\n            eventColor    = me.selected?.eventColor ?? '';\n\n        super.syncInputFieldValue();\n\n        // Remove last colour whichever way it was done\n        resourceIcon.style.color = '';\n        lastResourceIconCls && classList.remove(lastResourceIconCls);\n        me.lastResourceIconCls = null;\n\n        if (eventColor) {\n            if (DomHelper.isNamedColor(eventColor)) {\n                me.lastResourceIconCls = `b-sch-foreground-${eventColor}`;\n                classList.add(me.lastResourceIconCls);\n            }\n            else {\n                resourceIcon.style.color = eventColor;\n            }\n            classList.remove('b-hide-display');\n        }\n        else {\n            classList.add('b-hide-display');\n        }\n    }\n}\n\n// Register this widget type with its Factory\nResourceCombo.initClass();\n","import EditBase from './base/EditBase.js';\nimport GridFeatureManager from '../../Grid/feature/GridFeatureManager.js';\nimport ObjectHelper from '../../Core/helper/ObjectHelper.js';\nimport '../view/EventEditor.js';\nimport Delayable from '../../Core/mixin/Delayable.js';\nimport RecurringEventEdit from './mixin/RecurringEventEdit.js';\nimport '../../Core/widget/TextField.js';\nimport '../../Scheduler/widget/ResourceCombo.js';\nimport TimeSpan from '../../Scheduler/model/TimeSpan.js';\nimport '../../Core/widget/DateField.js';\nimport '../../Core/widget/TimeField.js';\nimport '../../Core/widget/Button.js';\nimport '../widget/EventColorField.js';\nimport Widget from '../../Core/widget/Widget.js';\nimport DateHelper from '../../Core/helper/DateHelper.js';\nimport AsyncHelper from '../../Core/helper/AsyncHelper.js';\nimport TaskEditStm from './mixin/TaskEditStm.js';\n\n/**\n * @module Scheduler/feature/EventEdit\n */\n\nconst punctuation = /[^\\w\\d]/g;\n\n/**\n * Feature that displays a popup containing widgets for editing event data.\n *\n * {@inlineexample Scheduler/feature/EventEdit.js}\n *\n * To customize its contents you can:\n *\n * * Reconfigure built in widgets by providing override configs in the {@link Scheduler.feature.base.EditBase#config-items} config.\n * * Change the date format of the date & time fields: {@link Scheduler.feature.base.EditBase#config-dateFormat} and {@link Scheduler.feature.base.EditBase#config-timeFormat }\n * * Configure provided widgets in the editor and add your own in the {@link Scheduler.feature.base.EditBase#config-items} config.\n * * Remove fields related to recurring events configuration (such as `recurrenceCombo`) by setting {@link Scheduler.feature.mixin.RecurringEventEdit#config-showRecurringUI} config to `false`.\n * * Advanced: Reconfigure the whole editor widget using {@link #config-editorConfig}\n *\n * ## Built in widgets\n *\n * The built in widgets are:\n *\n * | Widget ref             | Type                                                     | Weight | Description                                                    |\n * |------------------------|----------------------------------------------------------|--------|----------------------------------------------------------------|\n * | `nameField`            | {@link Core.widget.TextField}                            | 100    | Edit name                                                      |\n * | `resourceField`        | {@link Scheduler.widget.ResourceCombo}                   | 200    | Pick resource(s)                                               |\n * | `startDateField`       | {@link Core.widget.DateField}                            | 300    | Edit startDate (date part)                                     |\n * | `startTimeField`       | {@link Core.widget.TimeField}                            | 400    | Edit startDate (time part)                                     |\n * | `endDateField`         | {@link Core.widget.DateField}                            | 500    | Edit endDate (date part)                                       |\n * | `endTimeField`         | {@link Core.widget.TimeField}                            | 600    | Edit endDate (time part)                                       |\n * | `recurrenceCombo`      | {@link Scheduler.view.recurrence.field.RecurrenceCombo}  | 700    | Select recurrence rule (only visible if recurrence is used)    |\n * | `editRecurrenceButton` | {@link Scheduler.view.recurrence.RecurrenceLegendButton} | 800    | Edit the recurrence rule  (only visible if recurrence is used) |\n * | `colorField`          | {@link Scheduler.widget.EventColorField}                 | 700    | Choose background color for the event bar                      |\n *\n * **** Set the {@link Scheduler.view.SchedulerBase#config-showEventColorPickers} config to `true` to enable this field\n *\n * The built in buttons are:\n *\n * | Widget ref             | Type                                                                     | Weight | Description                                                    |\n * |------------------------|--------------------------------------------------------------------------|--------|----------------------------------------------------------------|\n * | `saveButton`           | {@link Core.widget.Button}                                               | 100    | Save event button on the bbar                                  |\n * | `deleteButton`         | {@link Core.widget.Button}                                               | 200    | Delete event button on the bbar                                |\n * | `cancelButton`         | {@link Core.widget.Button}                                               | 300    | Cancel event editing button on the bbar                        |\n *\n * ## Removing a built in item\n *\n * To remove a built in widget, specify its `ref` as `null` in the `items` config:\n *\n * ```javascript\n * const scheduler = new Scheduler({\n *     features : {\n *         eventEdit : {\n *             items : {\n *                 // Remove the start time field\n *                 startTimeField : null\n *             }\n *         }\n *     }\n * })\n * ```\n *\n * Bottom buttons may be hidden using `bbar` config passed to `editorConfig`:\n * ```javascript\n * const scheduler = new Scheduler({\n *     features : {\n *         eventEdit : {\n *             editorConfig : {\n *                 bbar : {\n *                     items : {\n *                         deleteButton : null\n *                     }\n *                 }\n *             }\n *         }\n *     }\n * })\n * ```\n *\n * To remove fields related to recurring events configuration (such as `recurrenceCombo`), set {@link Scheduler.feature.mixin.RecurringEventEdit#config-showRecurringUI} config to `false`.\n *\n * ## Customizing a built in widget\n *\n * To customize a built in widget, use its `ref` as the key in the `items` config and specify the configs you want\n * to change (they will merge with the widgets default configs):\n *\n * ```javascript\n * const scheduler = new Scheduler({\n *     features : {\n *         eventEdit : {\n *             items : {\n *                 // ref for an existing field\n *                 nameField : {\n *                     // Change its label\n *                     label : 'Description'\n *                 }\n *             }\n *         }\n *     }\n * })\n * ```\n *\n * ## Adding custom widgets\n *\n * To add a custom widget, add an entry to the `items` config. The `name` property links the input field to a field in\n * the loaded event record:\n *\n * ```javascript\n * const scheduler = new Scheduler({\n *     features : {\n *         eventEdit : {\n *             items : {\n *                 // Key to use as fields ref (for easier retrieval later)\n *                 color : {\n *                     type  : 'combo',\n *                     label : 'Color',\n *                     items : ['red', 'green', 'blue'],\n *                     // name will be used to link to a field in the event record when loading and saving in the editor\n *                     name  : 'eventColor'\n *                 }\n *             }\n *         }\n *     }\n * })\n * ```\n *\n * For more info on customizing the event editor, please see \"Customize event editor\" guide.\n *\n * This feature is **enabled** by default\n *\n * @mixes Scheduler/feature/mixin/RecurringEventEdit\n * @extends Scheduler/feature/base/EditBase\n * @demo Scheduler/eventeditor\n * @classtype eventEdit\n * @feature\n */\nexport default class EventEdit extends EditBase.mixin(TaskEditStm, RecurringEventEdit, Delayable) {\n    //region Config\n\n    static get $name() {\n        return 'EventEdit';\n    }\n\n    static get configurable() {\n        return {\n            /**\n             * The event that shall trigger showing the editor. Defaults to `eventdblclick`, set to `''` or null to\n             * disable editing of existing events.\n             * @config {String}\n             * @default\n             * @category Editor\n             */\n            triggerEvent : 'eventdblclick',\n\n            /**\n             * The data field in the model that defines the eventType.\n             * Applied as class (b-eventtype-xx) to the editors element, to allow showing/hiding fields depending on\n             * eventType. Dynamic toggling of fields in the editor is activated by adding an `eventTypeField` field to\n             * your widget:\n             *\n             * ```javascript\n             * const scheduler = new Scheduler({\n             *    features : {\n             *       eventEdit : {\n             *           items : {\n             *               eventTypeField : {\n             *                  type  : 'combo',\n             *                  name  : 'eventType',\n             *                  label : 'Type',\n             *                  items : ['Appointment', 'Internal', 'Meeting']\n             *               }\n             *           }\n             *        }\n             *     }\n             * });\n             * ```\n             * Note, your event model class also must declare this field:\n             * ```javascript\n             *  class MyEvent extends EventModel {\n             *      static get fields() {\n             *          return [\n             *              { name : 'eventType' }\n             *          ];\n             *      }\n             *  }\n             * ```\n             * @config {String}\n             * @default\n             * @category Editor\n             */\n            typeField : 'eventType',\n\n            /**\n             * The current {@link Scheduler.model.EventModel} record, which is being edited by the event editor.\n             * @property {Scheduler.model.EventModel}\n             * @readonly\n             */\n            eventRecord : null,\n\n            /**\n             * Specify `true` to put the editor in read only mode.\n             * @config {Boolean}\n             * @default false\n             */\n            readOnly : null,\n\n            /**\n             * The configuration for the internal editor widget. With this config you can control the *type*\n             * of editor (defaults to `Popup`) and which widgets to show,\n             * change the items in the `bbar`, or change whether the popup should be modal etc.\n             *\n             * ```javascript\n             * const scheduler = new Scheduler({\n             *     features : {\n             *         eventEdit  : {\n             *             editorConfig : {\n             *                 modal  : true,\n             *                 cls    : 'my-editor' // A CSS class,\n             *                 items  : {\n             *                     owner : {\n             *                         weight : -100, // Will sort above system-supplied fields which are weight 100 to 800\n             *                         type   : 'usercombo',\n             *                         name   : 'owner',\n             *                         label  : 'Owner'\n             *                     },\n             *                     agreement : {\n             *                         weight : 1000, // Will sort below system-supplied fields which are weight 100 to 800\n             *                         type   : 'checkbox',\n             *                         name   : 'agreement',\n             *                         label  : 'Agree to terms'\n             *                     },\n             *                     resourceField : {\n             *                         // Apply a special filter to limit the Combo's access\n             *                         // to resources.\n             *                         store  {\n             *                             filters : [{\n             *                                 filterBy(resource) {\n             *                                     return shouldShowResource(record);\n             *                                 }\n             *                             }]\n             *                         }\n             *                     }\n             *                 },\n             *                 bbar : {\n             *                     items : {\n             *                         deleteButton : {\n             *                             hidden : true\n             *                         }\n             *                     }\n             *                 }\n             *             }\n             *         }\n             *     }\n             * });\n             * ```\n             *\n             * Or to use your own custom editor:\n             *\n             * ```javascript\n             * const scheduler = new Scheduler({\n             *     features : {\n             *         eventEdit  : {\n             *             editorConfig : {\n             *                 type : 'myCustomEditorType'\n             *             }\n             *         }\n             *     }\n             * });\n             * ```\n             * @config {Object}\n             * @category Editor\n             */\n            editorConfig : {\n                type        : 'eventeditor',\n                title       : 'L{EventEdit.Edit event}',\n                closable    : true,\n                localeClass : this,\n\n                defaults : {\n                    localeClass : this\n                },\n                items : {\n                    /**\n                     * Reference to the name field, if used\n                     * @member {Core.widget.TextField} nameField\n                     * @readonly\n                     */\n                    nameField : {\n                        type      : 'text',\n                        label     : 'L{Name}',\n                        clearable : true,\n                        name      : 'name',\n                        weight    : 100,\n                        required  : true\n                    },\n                    /**\n                     * Reference to the resource field, if used\n                     * @member {Core.widget.Combo} resourceField\n                     * @readonly\n                     */\n                    resourceField : {\n                        type                    : 'resourcecombo',\n                        label                   : 'L{Resource}',\n                        name                    : 'resource',\n                        editable                : true,\n                        valueField              : 'id',\n                        displayField            : 'name',\n                        highlightExternalChange : false,\n                        destroyStore            : true,\n                        weight                  : 200\n                    },\n                    /**\n                     * Reference to the start date field, if used\n                     * @member {Core.widget.DateField} startDateField\n                     * @readonly\n                     */\n                    startDateField : {\n                        type             : 'date',\n                        clearable        : false,\n                        required         : true,\n                        label            : 'L{Start}',\n                        name             : 'startDate',\n                        validateDateOnly : true,\n                        weight           : 300\n                    },\n                    /**\n                     * Reference to the start time field, if used\n                     * @member {Core.widget.TimeField} startTimeField\n                     * @readonly\n                     */\n                    startTimeField : {\n                        type      : 'time',\n                        clearable : false,\n                        required  : true,\n                        name      : 'startDate',\n                        cls       : 'b-match-label',\n                        weight    : 400\n                    },\n                    /**\n                     * Reference to the end date field, if used\n                     * @member {Core.widget.DateField} endDateField\n                     * @readonly\n                     */\n                    endDateField : {\n                        type             : 'date',\n                        clearable        : false,\n                        required         : true,\n                        label            : 'L{End}',\n                        name             : 'endDate',\n                        validateDateOnly : true,\n                        weight           : 500\n                    },\n                    /**\n                     * Reference to the end time field, if used\n                     * @member {Core.widget.TimeField} endTimeField\n                     * @readonly\n                     */\n                    endTimeField : {\n                        type      : 'time',\n                        clearable : false,\n                        required  : true,\n                        name      : 'endDate',\n                        cls       : 'b-match-label',\n                        weight    : 600\n                    },\n\n                    colorField : {\n                        label  : 'L{SchedulerBase.color}',\n                        type   : 'eventColorField',\n                        name   : 'eventColor',\n                        weight : 700\n                    }\n                },\n\n                bbar : {\n                    // When readOnly, child buttons are hidden\n                    hideWhenEmpty : true,\n\n                    defaults : {\n                        localeClass : this\n                    },\n                    items : {\n                        /**\n                         * Reference to the save button, if used\n                         * @member {Core.widget.Button} saveButton\n                         * @readonly\n                         */\n                        saveButton : {\n                            color  : 'b-blue',\n                            cls    : 'b-raised',\n                            text   : 'L{Save}',\n                            weight : 100\n                        },\n                        /**\n                         * Reference to the delete button, if used\n                         * @member {Core.widget.Button} deleteButton\n                         * @readonly\n                         */\n                        deleteButton : {\n                            text   : 'L{Delete}',\n                            weight : 200\n                        },\n                        /**\n                         * Reference to the cancel button, if used\n                         * @member {Core.widget.Button} cancelButton\n                         * @readonly\n                         */\n                        cancelButton : {\n                            text   : 'L{Object.Cancel}',\n                            weight : 300\n                        }\n                    }\n                }\n            },\n\n            targetEventElement : null\n        };\n    }\n\n    static get pluginConfig() {\n        return {\n            chain : [\n                'populateEventMenu',\n                'onEventEnterKey',\n                'editEvent'\n            ]\n        };\n    }\n\n    //endregion\n\n    //region Init & destroy\n\n    construct(scheduler, config) {\n        // Default to the scheduler's state, but configs may override\n        this.readOnly = scheduler.readOnly;\n\n        super.construct(scheduler, config);\n\n        scheduler.ion({\n            projectChange : 'onChangeProject',\n            readOnly      : 'onClientReadOnlyToggle',\n            thisObj       : this\n        });\n    }\n\n    get scheduler() {\n        return this.client;\n    }\n\n    get project() {\n        return this.client.project;\n    }\n    //endregion\n\n    //region Editing\n\n    /**\n     * Get/set readonly state\n     * @property {Boolean}\n     */\n    get readOnly() {\n        return this._editor ? this.editor.readOnly : this._readOnly;\n    }\n\n    updateReadOnly(readOnly) {\n        super.updateReadOnly(readOnly);\n\n        if (this._editor) {\n            this.editor.readOnly = readOnly;\n        }\n    }\n\n    onClientReadOnlyToggle({ readOnly }) {\n        this.readOnly = readOnly;\n    }\n\n    /**\n     * Returns the editor widget representing this feature\n     * @member {Core.widget.Popup}\n     */\n    get editor() {\n        const\n            me              = this,\n            editorListeners = {\n                beforehide : 'resetEditingContext',\n                beforeshow : 'onBeforeEditorShow',\n                keydown    : 'onPopupKeyDown',\n                thisObj    : me\n            };\n\n        let { _editor : editor } = me;\n\n        if (editor) {\n            return editor;\n        }\n\n        editor = me._editor = Widget.create(me.getEditorConfig());\n\n        const {\n            startDateField,\n            startTimeField,\n            endDateField,\n            endTimeField\n        } = editor.widgetMap;\n\n        // If the date field doesn't exist, the time field must encapsulate the\n        // date component of the start/end points and must lay out right.\n        if (!startDateField && startTimeField) {\n            startTimeField.keepDate = true;\n            startTimeField.label = me.L('Start');\n            startTimeField.flex = '1 0 100%';\n        }\n        if (!endDateField && endTimeField) {\n            endTimeField.keepDate = true;\n            endTimeField.label = me.L('End');\n            endTimeField.flex = '1 0 100%';\n        }\n\n        // If the default Popup has been reconfigured to be static, add it as a child of our client.\n        if (!editor.floating && !editor.positioned) {\n            // If not configured with an appendTo, we add it as a child of our client.\n            if (!editor.element.parentNode) {\n                me.client.add(editor);\n            }\n\n            delete editorListeners.beforehide;\n            delete editorListeners.beforeshow;\n\n            editorListeners.beforeToggleReveal = 'onBeforeEditorToggleReveal';\n        }\n\n        // Must set *after* construction, otherwise it becomes the default state\n        // to reset readOnly back to. Must use direct property access because\n        // getter consults state of editor.\n        editor.readOnly = me._readOnly;\n\n        if (editor.items.length === 0) {\n            console.warn('Event Editor configured without any `items`');\n        }\n\n        // add listeners programmatically so users cannot override them accidentally\n        editor.ion(editorListeners);\n\n        /**\n         * Fired before the editor will load the event record data into its input fields. This is useful if you\n         * want to modify the fields before data is loaded (e.g. set some input field to be readonly)\n         * @on-owner\n         * @event eventEditBeforeSetRecord\n         * @param {Core.widget.Container} source The editor widget\n         * @param {Scheduler.model.EventModel} record The record\n         */\n        me.scheduler.relayEvents(editor, ['beforeSetRecord'], 'eventEdit');\n\n        // assign widget variables, using widget name: startDate -> me.startDateField\n        // widgets with id set use that instead, id -> me.idField\n        Object.values(editor.widgetMap).forEach(widget => {\n            const ref = widget.ref || widget.id;\n            // don't overwrite if already defined\n            if (ref && !me[ref]) {\n                me[ref] = widget;\n\n                switch (widget.name) {\n                    case 'startDate':\n                    case 'endDate':\n                        widget.ion({ change : 'onDatesChange', thisObj : me });\n                        break;\n                }\n            }\n        });\n\n        // launch onEditorConstructed hook if provided\n        me.onEditorConstructed?.(editor);\n\n        me.eventTypeField?.ion({ change : 'onEventTypeChange', thisObj : me });\n\n        me.saveButton?.ion({ click : 'onSaveClick', thisObj : me });\n        me.deleteButton?.ion({ click : 'onDeleteClick', thisObj : me });\n        me.cancelButton?.ion({ click : 'onCancelClick', thisObj : me });\n\n        return editor;\n    }\n\n    getEditorConfig() {\n        const\n            me                 = this,\n            { cls, scheduler } = me,\n            result             = ObjectHelper.assign({\n                owner            : scheduler,\n                eventEditFeature : me,\n                weekStartDay     : me.weekStartDay,\n                align            : 'b-t',\n                id               : `${scheduler.id}-event-editor`,\n                autoShow         : false,\n                anchor           : true,\n                scrollAction     : 'realign',\n                constrainTo      : globalThis,\n                cls\n            }, me.editorConfig);\n\n        // User configuration may have included a render target which means the editor\n        // will not be floating.\n        if (Widget.prototype.getRenderContext(result)[0]) {\n            result.floating = false;\n        }\n\n        // If the default Popup has been reconfigured to be static, ensure it starts\n        // life as a visible but collapsed panel.\n        if (result.floating === false && !result.positioned) {\n            result.collapsible = {\n                type           : 'overlay',\n                direction      : 'right',\n                autoClose      : false,\n                tool           : null,\n                recollapseTool : null\n            };\n            result.collapsed = true;\n            result.hidden = result.anchor = false;\n            result.hide = function() {\n                this.collapsible.toggleReveal(false);\n            };\n        }\n\n        if (!scheduler.showEventColorPickers && result.items.colorField) {\n            result.items.colorField.hidden = true;\n        }\n\n        // Layout-affecting props must be available early so that appendTo ends up with\n        // correct layout.\n        result.onElementCreated = me.updateCSSVars.bind(this);\n\n        return result;\n    }\n\n    updateCSSVars({ element }) {\n        // must result in longest format, ie 2 digits for date and all time parts.\n        const\n            time               = new Date(2000, 12, 31, 23, 55, 55),\n            dateLength         = DateHelper.format(time, this.dateFormat).replace(punctuation, '').length,\n            timeLength         = DateHelper.format(time, this.timeFormat).replace(punctuation, '').length,\n            dateTimeLength     = dateLength + timeLength;\n\n        element.style.setProperty('--date-time-length', `${dateTimeLength}em`);\n        element.style.setProperty('--date-width-difference', `${(dateLength - timeLength) / 2}em`);\n    }\n\n    // Called from editEvent() to actually show the editor\n    async internalShowEditor(eventRecord, resourceRecord, align = null) {\n        const\n            me            = this,\n            { scheduler } = me,\n            // Align to the element (b-sch-event) and not the wrapper\n            eventElement = align?.target?.nodeType === Element.ELEMENT_NODE\n                ? align.target\n                : scheduler.getElementFromEventRecord(eventRecord, resourceRecord),\n            isPartOfStore = eventRecord.isPartOfStore(scheduler.eventStore);\n\n        align = align ?? {\n            // Align to the element (b-sch-event) and not the wrapper\n            target : eventElement,\n            anchor : true\n        };\n\n        // Event not in current TimeAxis - cannot be edited without extending the TimeAxis.\n        // If there's no event element and the eventRecord is not in the store, we still\n        // edit centered on the Scheduler - we're adding a new event\n        if (align.target || (!isPartOfStore || eventRecord.resources.length === 0) || eventRecord.isCreating) {\n            // need to add this css class as early as possible to prevent\n            // the event tooltip from appearing\n            scheduler.element.classList.add('b-eventeditor-editing');\n\n            me.resourceRecord = resourceRecord;\n\n            const { editor } = me;\n\n            me.editingContext = {\n                eventRecord,\n                resourceRecord,\n                eventElement,\n                editor,\n                isPartOfStore\n            };\n\n            super.internalShowEditor?.(eventRecord, resourceRecord, align);\n\n            if (me.typeField) {\n                me.toggleEventType(eventRecord.getValue(me.typeField));\n            }\n\n            me.loadRecord(eventRecord, resourceRecord);\n\n            // If it's a static child of the client which is collapsed, expand it.\n            // Floating components focusOnShow by default, this will need to be focused.\n            if (editor.collapsed) {\n                // The *initial* reveal does not animate unless the toggleReveal call is delayed.\n                await AsyncHelper.sleep(100);\n                await editor.collapsible.toggleReveal(true);\n                editor.focus();\n            }\n            // Honour alignment settings \"anchor\" and \"centered\" which may be injected from editorConfig.\n            else if (editor.centered || !editor.anchor || !editor.floating) {\n                editor.show();\n            }\n            else if (eventElement) {\n                me.targetEventElement = eventElement;\n                editor.showBy(align);\n            }\n            // We are adding an unrendered event. Display the editor centered\n            else {\n                editor.show();\n\n                // Must be done after show because show always reverts to its configured centered setting.\n                editor.updateCentered(true);\n            }\n\n            // Adjust time field step increment based on timeAxis resolution\n            const timeResolution = scheduler.timeAxisViewModel.timeResolution;\n\n            if (timeResolution.unit === 'hour' || timeResolution.unit === 'minute') {\n                const step = `${timeResolution.increment}${timeResolution.unit}`;\n                if (me.startTimeField) {\n                    me.startTimeField.step = step;\n                }\n                if (me.endTimeField) {\n                    me.endTimeField.step = step;\n                }\n            }\n\n            // Might end up here with the old listener still around in monkey test for stress demo in turbo mode.\n            // Some action happening during edit, but cannot track down what is going on\n            me.detachListeners('changesWhileEditing');\n\n            scheduler.eventStore.ion({\n                change  : me.onChangeWhileEditing,\n                refresh : me.onChangeWhileEditing,\n                thisObj : me,\n                name    : 'changesWhileEditing'\n            });\n        }\n    }\n\n    onChangeWhileEditing() {\n        const me = this;\n        // If event was removed, cancel editing\n        // however, there's one valid case when even can be removed during save finalization - that is when\n        // all its assignments has been removed - in such case ignore the removal and do not call the `onCancelClick`\n        // because that will reject the STM transaction and revert all changes\n        if (!me.isFinalizingEventSave && me.isEditing && me.editingContext.isPartOfStore && !me.eventRecord.isPartOfStore(me.scheduler.eventStore)) {\n            me.onCancelClick();\n        }\n    }\n\n    // Fired in a listener so that it's after the auto-called onBeforeShow listeners so that\n    // subscribers to the beforeEventEditShow are called at exactly the correct lifecycle point.\n    onBeforeEditorShow() {\n        super.onBeforeEditorShow(...arguments);\n\n        /**\n         * Fires on the owning Scheduler when the editor for an event is available but before it is populated with\n         * data and shown. Allows manipulating fields etc.\n         * @event beforeEventEditShow\n         * @on-owner\n         * @param {Scheduler.view.Scheduler} source The scheduler\n         * @param {Scheduler.feature.EventEdit} eventEdit The eventEdit feature\n         * @param {Scheduler.model.EventModel} eventRecord The record about to be shown in the event editor.\n         * @param {Scheduler.model.ResourceModel} resourceRecord The Resource record for the event. If the event\n         * is being created, it will not contain a resource, so this parameter specifies the resource the\n         * event is being created for.\n         * @param {HTMLElement} eventElement The element which represents the event in the scheduler display.\n         * @param {Core.widget.Popup} editor The editor\n         */\n        this.scheduler.trigger('beforeEventEditShow', {\n            eventEdit : this,\n            ...this.editingContext\n        });\n    }\n\n    updateTargetEventElement(targetEventElement, oldTargetEventElement) {\n        targetEventElement?.classList.add('b-editing');\n        oldTargetEventElement?.classList.remove('b-editing');\n    }\n\n    /**\n     * Opens an editor for the passed event. This function is exposed on Scheduler and can be called as\n     * `scheduler.editEvent()`.\n     * @param {Scheduler.model.EventModel} eventRecord Event to edit\n     * @param {Scheduler.model.ResourceModel} [resourceRecord] The Resource record for the event.\n     * This parameter is needed if the event is newly created for a resource and has not been assigned, or when using\n     * multi assignment.\n     * @param {HTMLElement} [element] Element to anchor editor to (defaults to events element)\n     * @on-owner\n     */\n    editEvent(eventRecord, resourceRecord, element = null, stmCapture = null) {\n        const\n            me = this,\n            { client } = me,\n            { simpleEventEdit } = client.features;\n\n        if (me.isEditing) {\n            // old editing flow already running, clean it up\n            me.resetEditingContext();\n        }\n\n        // If simple edit feature is active, use it when a new event is created\n        if (me.disabled || eventRecord.readOnly || (eventRecord.isCreating && simpleEventEdit?.enabled)) {\n            return;\n        }\n\n        /**\n         * Fires on the owning Scheduler before an event is displayed in an editor.\n         * This may be listened for to allow an application to take over event editing duties. Returning `false`\n         * stops the default editing UI from being shown.\n         * @event beforeEventEdit\n         * @on-owner\n         * @param {Scheduler.view.Scheduler} source The scheduler\n         * @param {Scheduler.feature.EventEdit} eventEdit The eventEdit feature\n         * @param {Scheduler.model.EventModel} eventRecord The record about to be shown in the event editor.\n         * @param {Scheduler.model.ResourceModel} resourceRecord The Resource record for the event. If the event\n         * is being created, it will not contain a resource, so this parameter specifies the resource the\n         * event is being created for.\n         * @param {HTMLElement} eventElement The element which represents the event in the scheduler display.\n         * @preventable\n         */\n        if (client.trigger('beforeEventEdit', {\n            eventEdit    : me,\n            eventRecord,\n            resourceRecord,\n            eventElement : client.getElementFromEventRecord?.(eventRecord, resourceRecord) || element\n        }) === false) {\n            client.element.classList.remove('b-eventeditor-editing');\n            return false;\n        }\n\n        if (stmCapture) {\n            me.applyStmCapture(stmCapture);\n            me.hasStmCapture = true;\n\n            // indicate that editor has been opened, and is now managing the \"stm capture\"\n            stmCapture.transferred = true;\n        }\n        // it is set to `false` by calendar, to ignore the STM mechanism\n        else if (stmCapture !== false && !client.isCalendar && !me.hasStmCapture) {\n            me.captureStm(true);\n        }\n\n        return me.doEditEvent(...arguments).then(result => {\n            if (!me.isDestroying) {\n                // The Promise being async allows a mouseover to trigger the event tip\n                // unless we add the editing class immediately (But only if we actually began editing).\n                if (!me.isEditing && !client.isCalendar && !me.rejectingStmTransaction) {\n                    // probably a custom event editor was used or editing was vetoed for some other reason\n                    if (result !== false && me.hasStmCapture) {\n                        // Skip stm rejection if built-in editor is disabled in beforeEventEdit (using of custom event editor)\n                        return me.freeStm(false);\n                    }\n                    else {\n                        return me.freeStm();\n                    }\n                }\n            }\n        });\n    }\n\n    /**\n     * Returns true if the editor is currently active\n     * @readonly\n     * @property {Boolean}\n     */\n    get isEditing() {\n        const { _editor } = this;\n\n        return Boolean(\n            // Editor is not visible if it is collapsed and not expanded\n            _editor?.isVisible && !(_editor.collapsed && !_editor.revealed)\n        );\n    }\n\n    // editEvent is the single entry point in the base class.\n    // Subclass implementations of the action may differ, so are implemented in doEditEvent\n    async doEditEvent(eventRecord, resourceRecord, element = null) {\n        const\n            me            = this,\n            { scheduler } = me,\n            isNewRecord   = eventRecord.isCreating;\n\n        if (!resourceRecord) {\n            // Need to handle resourceId for edge case when creating an event with resourceId and editing it before\n            // adding it to the EventStore\n            resourceRecord = eventRecord.resource || me.resourceStore.getById(eventRecord.resourceId);\n        }\n\n        if (isNewRecord) {\n            // Ensure temporal data fields are ready when the editor is shown\n            TimeSpan.prototype.normalize.call(eventRecord);\n        }\n\n        // If element is specified (call triggered by EventDragCreate)\n        // Then we can align to that, and no scrolling is necessary.\n        // If we are simply being asked to edit a new event which is not\n        // yet added, the editor is centered, and no scroll is necessary\n        if (element || isNewRecord || eventRecord.resources.length === 0) {\n            return me.internalShowEditor(eventRecord, resourceRecord, element ? {\n                target : element\n            } : null);\n        }\n        else {\n            // Ensure event is in view before showing the editor.\n            // Note that we first need to extend the time axis to include\n            // currently out of range events.\n            return scheduler.scrollResourceEventIntoView(resourceRecord, eventRecord, {\n                animate        : true,\n                edgeOffset     : 0,\n                extendTimeAxis : false\n            }).then(() => me.internalShowEditor(eventRecord, resourceRecord), () => scheduler.element.classList.remove('b-eventeditor-editing'));\n        }\n    }\n\n    /**\n     * Sets fields values from record being edited\n     * @private\n     */\n    loadRecord(eventRecord, resourceRecord) {\n        this.loadingRecord = true;\n\n        this.internalLoadRecord(eventRecord, resourceRecord);\n\n        this.loadingRecord = false;\n    }\n\n    get eventRecord() {\n        return this._editor?.record;\n    }\n\n    internalLoadRecord(eventRecord, resourceRecord) {\n        const\n            me                        = this,\n            { eventStore }            = me.client,\n            { editor, resourceField } = me;\n\n        me.resourceRecord = resourceRecord;\n\n        // Update chained store early, to have records in place when setting value below (avoids adding the resource to\n        // empty combo store, https://github.com/bryntum/support/issues/5378). It is not done automatically for\n        // grouping/trees or when project is replaced\n        if (resourceField && resourceField.store?.masterStore !== me.resourceStore) {\n            resourceField.store = editor.chainResourceStore();\n        }\n\n        editor.record = eventRecord;\n\n        if (resourceField) {\n            const resources = eventStore.assignmentStore.getResourcesForEvent(eventRecord);\n\n            // Flag on parent Container to indicate that initially blank fields are valid\n            editor.assigningValues = true;\n\n            // If this is an unassigned event, select the resource we've been provided\n            if (!eventRecord.isOccurrence && !eventStore.storage.includes(eventRecord, true) && resourceRecord) {\n                me.resourceField.value = resourceRecord.getValue(me.resourceField.valueField);\n            }\n            else if (me.assignmentStore) {\n                me.resourceField.value = resources.map((resource) => resource.getValue(me.resourceField.valueField));\n            }\n            editor.assigningValues = false;\n        }\n\n        super.internalLoadRecord(eventRecord, resourceRecord);\n    }\n\n    toggleEventType(eventType) {\n        // expose eventType in dataset, for querying and styling\n        this.editor.element.dataset.eventType = eventType || '';\n\n        this.editor.eachWidget(widget => { // need {}'s here so we don't return false and end iteration\n            widget.dataset?.eventType && (widget.hidden = widget.dataset.eventType !== eventType);\n        });\n    }\n\n    //endregion\n\n    //region Save\n\n    async finalizeEventSave(eventRecord, resourceRecords, resolve, reject) {\n        const\n            me = this,\n            {\n                scheduler,\n                assignmentStore\n            }  = me;\n\n        const aborted = false;\n\n        // Prevent multiple commits from this flow\n        assignmentStore.suspendAutoCommit();\n\n        // Avoid multiple redraws, from event changes + assignment changes\n        scheduler.suspendRefresh();\n\n        me.onBeforeSave(eventRecord);\n\n        eventRecord.beginBatch();\n        me.updateRecord(eventRecord);\n        eventRecord.endBatch();\n\n        if (!eventRecord.isOccurrence) {\n            if (me.resourceField) {\n                assignmentStore.assignEventToResource(eventRecord, resourceRecords, null, true);\n            }\n        }\n        // An occurrence event record may have changed only resources value. In that case we'll never get into afterChange() method that\n        // apply changed data and make an event \"real\", because resources is not a field and a record won't be marked as dirty.\n        // We used temporary field to save updated resources list and get into afterChange() method.\n        else if (resourceRecords) {\n            eventRecord.set('resourceRecords', resourceRecords);\n        }\n\n        // If it was a provisional event, passed in here from drag-create or dblclick or contextmenu,\n        // it's now it's no longer a provisional event and will not be removed in resetEditingContext\n        // Also, when promoted to be permanent, auto syncing will kick in if configured.\n        eventRecord.isCreating = false;\n\n        if (!aborted) {\n            await scheduler.project.commitAsync();\n        }\n\n        assignmentStore.resumeAutoCommit();\n\n        // Redraw once\n        scheduler.resumeRefresh(true);\n\n        if (!aborted) {\n            /**\n             * Fires on the owning Scheduler after an event is successfully saved\n             * @event afterEventSave\n             * @on-owner\n             * @param {Scheduler.view.Scheduler} source The scheduler instance\n             * @param {Scheduler.model.EventModel} eventRecord The record about to be saved\n             */\n            scheduler.trigger('afterEventSave', { eventRecord });\n            me.onAfterSave(eventRecord);\n        }\n        resolve(aborted ? false : eventRecord);\n    }\n\n    /**\n     * Saves the changes (applies them to record if valid, if invalid editor stays open)\n     * @private\n     * @fires beforeEventSave\n     * @fires beforeEventAdd\n     * @fires afterEventSave\n     * @async\n     */\n    save() {\n        return new Promise((resolve, reject) => {\n            const\n                me                         = this,\n                { scheduler, eventRecord } = me;\n\n            if (!eventRecord || !me.editor.isValid) {\n                resolve(false);\n                return;\n            }\n\n            const\n                { eventStore, values } = me,\n                resourceRecords        = me.resourceField?.records || (me.resourceRecord ? [me.resourceRecord] : []);\n\n            // Check for potential overlap scenarios before saving\n            // <remove-on-release>\n            // TODO: needs to be indicated in the UI\n            // </remove-on-release>\n            if (!me.scheduler.allowOverlap && eventStore) {\n                let { startDate, endDate } = values;\n\n                // Should support using a duration field instead of the end date field\n                if (!endDate) {\n                    if ('duration' in values) {\n                        endDate = DateHelper.add(startDate, values.duration, values.durationUnit || eventRecord.durationUnit);\n                    }\n                    else if ('fullDuration' in values) {\n                        endDate = DateHelper.add(startDate, values.fullDuration);\n                    }\n                    else {\n                        endDate = eventRecord.endDate;\n                    }\n                }\n\n                const abort = resourceRecords.some(resource => {\n                    return !eventStore.isDateRangeAvailable(startDate, endDate, eventRecord, resource);\n                });\n\n                if (abort) {\n                    resolve(false);\n                    return;\n                }\n            }\n\n            const context = {\n                finalize(saveEvent) {\n                    try {\n                        if (saveEvent !== false) {\n                            me.finalizeEventSave(eventRecord, resourceRecords, resolve, reject);\n                        }\n                        else {\n                            resolve(false);\n                        }\n                    }\n                    catch (e) {\n                        reject(e);\n                    }\n                }\n            };\n\n            /**\n             * Fires on the owning Scheduler before an event is saved.\n             * Return `false` to immediately prevent saving\n             *\n             * ```javascript\n             *  scheduler.on({\n             *      beforeEventSave() {\n             *          // prevent saving if some custom variable hasn't 123 value\n             *          return myCustomValue === 123;\n             *      }\n             *  });\n             * ```\n             * or a `Promise` yielding `true` or `false` for async vetoing.\n             *\n             * ```javascript\n             *  scheduler.on({\n             *      beforeEventSave() {\n             *          const\n             *              // send ajax request\n             *              response = await fetch('http://my-server/check-parameters.php'),\n             *              data     = await response.json();\n             *\n             *          // decide whether it's ok to save based on response \"okToSave\" property\n             *          return data.okToSave;\n             *      }\n             *  });\n             * ```\n             *\n             * @event beforeEventSave\n             * @on-owner\n             * @param {Scheduler.view.Scheduler} source The scheduler instance\n             * @param {Scheduler.model.EventModel} eventRecord The record about to be saved\n             * @param {Scheduler.model.ResourceModel[]} resourceRecords The resources to which the event is assigned\n             * @param {Object} values The new values\n             * @param {Object} context Extended save context:\n             * @param {Boolean} [context.async] Set this to `true` in a listener to indicate that the listener will asynchronously decide to prevent or not the event save.\n             * @param {Function} context.finalize Function to call to finalize the save. Used when `async` is `true`. Provide `false` to the function to prevent the save.\n             * @preventable\n             * @async\n             */\n            const triggerResult = scheduler.trigger('beforeEventSave', { eventRecord, resourceRecords, values, context });\n\n            // Helper function to handle beforeEventSave listeners result\n            function handleEventResult(result, eventRecord, context) {\n                // save prevented by a listener\n                if (result === false) {\n                    resolve(false);\n                }\n                else {\n                    // <remove-on-release>\n                    // TODO move this back to RecurringEventEdit mixin\n                    // after fixing listeners in https://github.com/bryntum/bryntum-suite/issues/7438\n                    // </remove-on-release>\n                    me.onRecurrableEventBeforeSave({ eventRecord, context });\n                    // truthy context.async means than a listener will decide to approve saving asynchronously\n                    if (!context.async) {\n                        context.finalize();\n                    }\n                }\n            }\n\n            if (ObjectHelper.isPromise(triggerResult)) {\n                triggerResult.then(result => handleEventResult(result, eventRecord, context));\n            }\n            else {\n                handleEventResult(triggerResult, eventRecord, context);\n            }\n        });\n    }\n\n    //endregion\n\n    //region Delete\n\n    /**\n     * Delete event being edited\n     * @fires beforeEventDelete\n     * @private\n     * @async\n     */\n    deleteEvent() {\n        this.detachListeners('changesWhileEditing');\n\n        return new Promise((resolve, reject) => {\n            const\n                me                      = this,\n                { eventRecord, editor } = me;\n\n            me.scheduler.removeEvents([eventRecord], removeRecord => {\n                // The reason it does it here is to move focus *before* it gets deleted,\n                // and then there's code in the delete to see that it's deleting the focused one,\n                // and jump forwards or backwards to move to the next or previous event\n                // See 'Should allow key activation' test in tests/view/mixins/EventNavigation.t.js\n                if (removeRecord && editor.containsFocus) {\n                    editor.revertFocus();\n                }\n\n                resolve(removeRecord);\n            }, editor);\n        });\n    }\n\n    //endregion\n\n    //region Stores\n\n    onChangeProject() {\n        // Release resource store on project change, it will be re-chained on next show\n        if (this.resourceField) {\n            this.resourceField.store = {}; // Cannot use null\n        }\n    }\n\n    get eventStore() {\n        return this.scheduler.project.eventStore;\n    }\n\n    get resourceStore() {\n        return this.scheduler.project.resourceStore;\n    }\n\n    get assignmentStore() {\n        return this.scheduler.project.assignmentStore;\n    }\n\n    //endregion\n\n    //endregion\n\n    //region Events\n\n    onActivateEditor({ eventRecord, resourceRecord, eventElement }) {\n        this.editEvent(eventRecord, resourceRecord, eventElement);\n    }\n\n    onDragCreateEnd({ eventRecord, resourceRecord, proxyElement, stmCapture }) {\n        this.editEvent(eventRecord, resourceRecord, proxyElement, stmCapture);\n    }\n\n    // chained from EventNavigation\n    onEventEnterKey({ assignmentRecord, eventRecord, target }) {\n        const\n            { client }  = this,\n            // Event can arrive from the wrap element in some products (such as Calendar)\n            // so in these cases, we must use querySelector to look *inside* the element.\n            element     = target[target.matches(client.eventSelector) ? 'querySelector' : 'closest'](client.eventInnerSelector);\n\n        if (assignmentRecord) {\n            this.editEvent(eventRecord, assignmentRecord.resource, element);\n        }\n        else if (eventRecord) {\n            this.editEvent(eventRecord, eventRecord.resource, element);\n        }\n    }\n\n    // Toggle fields visibility when changing eventType\n    onEventTypeChange({ value }) {\n        this.toggleEventType(value);\n    }\n\n    //endregion\n\n    //region Context menu\n\n    populateEventMenu({ eventRecord, resourceRecord, items }) {\n        if (!this.scheduler.readOnly && !this.disabled) {\n            items.editEvent = {\n                text        : 'L{EventEdit.Edit event}',\n                localeClass : this,\n                icon        : 'b-icon b-icon-edit',\n                weight      : 100,\n                disabled    : eventRecord.readOnly,\n                onItem      : () => {\n                    this.editEvent(eventRecord, resourceRecord);\n                }\n            };\n        }\n    }\n\n    //endregion\n\n    onBeforeEditorToggleReveal({ reveal }) {\n\n        if (reveal) {\n            this.editor.setupEditorButtons();\n        }\n\n        // reveal true/false is analogous to show/hide\n        this[reveal ? 'onBeforeEditorShow' : 'resetEditingContext']();\n    }\n\n    async resetEditingContext() {\n        const me = this;\n\n        me.detachListeners('changesWhileEditing');\n\n        // super call has to go before the `me.rejectStmTransaction();` below\n        // because it can be removing an event manually, bypassing the stm\n        super.resetEditingContext();\n\n        // client does not use STM for task editing (at least yet)\n        if (me.hasStmCapture && !me.isDeletingEvent && !me.isCancelingEdit) {\n            await me.freeStm(false);\n        }\n\n        // Clear to prevent retaining project\n        me.resourceRecord = null;\n    }\n\n    finalizeStmCapture(shouldReject) {\n        return this.freeStm(!shouldReject);\n    }\n\n    updateLocalization() {\n        if (this._editor) {\n            this.updateCSSVars({ element : this._editor.element });\n        }\n\n        super.updateLocalization(...arguments);\n    }\n}\n\nGridFeatureManager.registerFeature(EventEdit, true, 'Scheduler');\nGridFeatureManager.registerFeature(EventEdit, false, ['SchedulerPro', 'ResourceHistogram']);\n\nEventEdit.initClass();\n","import List from '../../Core/widget/List.js';\nimport DomHelper from '../../Core/helper/DomHelper.js';\nimport StringHelper from '../../Core/helper/StringHelper.js';\nimport ArrayHelper from '../../Core/helper/ArrayHelper.js';\n\n/**\n * @module Scheduler/widget/ResourceFilter\n */\n\n/**\n * A List which allows selection of resources to filter a specified eventStore to only show\n * events for the selected resources.\n *\n * Because this widget maintains a state that can be changed through the UI, it offers some of the\n * API of an input field. It has a read only {@link #property-value} property, and it fires a\n * {@link #event-change} event.\n *\n * @extends Core/widget/List\n * @classType resourceFilter\n * @widget\n */\nexport default class ResourceFilter extends List {\n    static get $name() {\n        return 'ResourceFilter';\n    }\n\n    // Factoryable type name\n    static get type() {\n        return 'resourcefilter';\n    }\n\n    static get delayable() {\n        return {\n            applyFilters : 'raf'\n        };\n    }\n\n    static get configurable() {\n        return {\n            /**\n             * The {@link Scheduler.data.EventStore EventStore} to filter.\n             * Events for resources which are deselected in this List will be filtered out.\n             * @config {Scheduler.data.EventStore}\n             */\n            eventStore : null,\n\n            multiSelect            : true,\n            toggleAllIfCtrlPressed : true,\n            itemTpl                : record => StringHelper.encodeHtml(record.name || ''),\n\n            /**\n             * An optional filter function to apply when loading resources from the project's\n             * resource store. Defaults to loading all resources.\n             *\n             * **This is called using this `ResourceFilter` as the `this` object.**\n             * @config {Function|String}\n             * @default\n             */\n            masterFilter : () => true,\n\n            /**\n             * By default, deselecting list items filters only the {@link #config-eventStore} so that\n             * events for the deselected resources are hidden from view. The `resourceStore` is __not__\n             * filtered.\n             *\n             * Configure this as `true` to also filter the `resourceStore` so that deselected resources\n             * are also hidden from view (They will remain in this `List`)\n             * @config {Boolean}\n             * @default false\n             */\n            filterResources : null\n        };\n    }\n\n    itemIconTpl(record, i) {\n        const\n            { eventColor } = record,\n            // Named colors are applied using CSS\n            cls            = DomHelper.isNamedColor(eventColor) ? ` b-sch-foreground-${eventColor}` : '',\n            // CSS style color is used as is\n            style          = !cls && eventColor ? ` style=\"color:${eventColor}\"` : '';\n\n        return this.multiSelect ? `<div class=\"b-selected-icon b-icon${cls}\"${style}></div>` : '';\n    }\n\n    updateEventStore(eventStore) {\n        const\n            me                 = this,\n            // HACK: Temp workaround until List's store is dynamically updatable.\n            chainedStoreConfig = me.initialConfig.store?.isStore ? me.initialConfig.store.initialConfig : me.store?.config,\n            // Allow configuration of the filter for loading records from the master store.\n            { resourceStore }  = eventStore,\n            store              = me.store = resourceStore.chain(me.masterFilter, null, {\n                ...chainedStoreConfig,\n                syncOrder : true\n            }),\n            changeListeners    = {\n                change  : 'onStoreChange',\n                thisObj : me\n            };\n\n        // We need to sync selection and rendering on changes fired from master store\n        store.un(changeListeners);\n        resourceStore.ion(changeListeners);\n\n        if (!resourceStore.count) {\n            resourceStore.project.ion({\n                name    : 'project',\n                refresh : 'initFilter',\n                thisObj : me\n            });\n        }\n        else {\n            me.initFilter();\n        }\n    }\n\n    changeMasterFilter(masterFilter) {\n        // Cannot use bind, otherwise fillFromMaster's check for whether it's a filter function fails.\n        const me = this;\n\n        // If we are filtering the resource store, we cannot now fill ourselves from the filtered\n        // view of the resource store. Otherwise, the list would hide the list items as they are deselected.\n        if (!me.filterResources) {\n            return function(r) {\n                return me.callback(masterFilter, me, [r]);\n            };\n        }\n    }\n\n    initFilter() {\n        const { eventStore, selected } = this;\n\n        if (eventStore.resourceStore.count) {\n            // We default to all resources selected unless this was configured with\n            // an initialSelection. See List#changeSelection\n            if (!this.initialSelection) {\n                selected.add(this.store.getRange());\n            }\n            this.detachListeners('project');\n        }\n    }\n\n    onStoreRefresh({ source : store, action }) {\n        // We need to re-enable the filter if the store becomes filtered.\n        // We only disable the filter if we know that we have selected all available\n        // resources.\n        if (action === 'filter' && this.eventStoreFilter) {\n            const\n                { eventStoreFilter } = this,\n                { disabled }       = eventStoreFilter,\n                newDisabled        = !store.isFiltered && this.allSelected;\n\n            if (newDisabled !== disabled) {\n                eventStoreFilter.disabled = newDisabled;\n                this.applyFilters();\n            }\n        }\n        super.onStoreRefresh(...arguments);\n    }\n\n    onSelectionChange({ source : selected, added, removed }) {\n        // Filter disabled if all resources selected\n        const\n            me       = this,\n            // Only disable the filter if the allSelected method is seeing *all* of the\n            // records from its masterStore with no filtering.\n            disabled = !me.store.isFiltered && me.allSelected;\n\n        super.onSelectionChange(...arguments);\n\n        let filtersAdded = false;\n\n        // If this is the first selection change triggered from the first project refresh\n        // in which all the resources are selected, then we ony need to apply the filters.\n        // if *not* all resources are selected, ie if added.length !== entire store length.\n        if (!me.eventStoreFilter) {\n            // Our client EventStore is filtered to only show events for our selected resources.\n            // Events without an associated resource are filtered into visibility.\n            // The addFilter function with silent param adds the filter but don't reevaluate filtering.\n            me.eventStoreFilter = me.eventStore.addFilter({\n                id       : `${me.id}-filter-instance`,\n                filterBy : e => !e.resource || me.selected.includes(e.resources),\n                disabled\n            }, added?.length === me.store.count);\n\n            filtersAdded = true;\n        }\n\n        if (me.filterResources && !me.resourceStoreFilter) {\n            // Our client EventStore is filtered to only show events for our selected resources.\n            // Events without an associated resource are filtered into visibility.\n            // The addFilter function with silent param adds the filter but don't reevaluate filtering.\n            me.resourceStoreFilter = me.eventStore.resourceStore.addFilter({\n                id       : `${me.id}-filter-instance`,\n                filterBy : r => me.selected.includes(r),\n                disabled\n            }, added?.length === me.store.count);\n\n            filtersAdded = true;\n        }\n\n        // The filters have been just added and so will take effect. No need to call applyFilter.\n        if (filtersAdded) {\n            return;\n        }\n\n        // Filter disabled if all resources selected\n        me.eventStoreFilter.disabled = disabled;\n        me.resourceStoreFilter && (me.resourceStoreFilter.disabled = disabled);\n\n        // Have the client EventStore refresh its filtering but after a small delay so the List UI updates immediately.\n        me.applyFilters();\n\n        if (me.eventListeners.change) {\n            const\n                value    = selected.values,\n                oldValue = value.concat(removed);\n\n            ArrayHelper.remove(oldValue, ...added);\n\n            /**\n             * Fired when this widget's selection changes\n             * @event change\n             * @param {String} value - This field's value\n             * @param {String} oldValue - This field's previous value\n             * @param {Core.widget.Field} source - This ResourceFilter\n             */\n            me.triggerFieldChange({\n                value,\n                oldValue\n            });\n        }\n    }\n\n    /**\n     * An array encapsulating the currently selected resources.\n     * @member {Scheduler.model.ResourceModel[]}\n     * @readonly\n     */\n    get value() {\n        return this.selected.values;\n    }\n\n    applyFilters() {\n        this.eventStore.filter();\n        this.filterResources && this.eventStore.resourceStore.filter();\n    }\n\n    doDestroy() {\n        this.store?.destroy();\n        super.doDestroy();\n    }\n}\n\n// Register this widget type with its Factory\nResourceFilter.initClass();\n","import DatePicker from '../../Core/widget/DatePicker.js';\nimport DateHelper from '../../Core/helper/DateHelper.js';\nimport DomHelper from '../../Core/helper/DomHelper.js';\nimport VersionHelper from '../../Core/helper/VersionHelper.js';\n\n/**\n * @module Scheduler/widget/SchedulerDatePicker\n */\n\n/**\n * A subclass of {@link Core.widget.DatePicker} which is able to show the presence of\n * events in its cells if configured with an {@link #config-eventStore}, and\n * {@link #config-showEvents} is set to a truthy value.\n *\n * The `datepicker` Widget type is implemented by this class when this class is imported, or built\n * into a bundle, and so any {@link Core.widget.DateField} may have its\n * {@link Core.widget.PickerField#config-picker} configured to use its capabilities of showing\n * the presence of events in its date cells.\n *\n * @classtype datepicker\n * @extends Core/widget/DatePicker\n * @inlineexample Scheduler/widget/SchedulerDatePicker.js\n * @widget\n */\nexport default class SchedulerDatePicker extends DatePicker {\n    static get $name() {\n        return 'SchedulerDatePicker';\n    }\n\n    static get type() {\n        return 'datepicker';\n    }\n\n    static get configurable() {\n        return {\n            /**\n             * How to show presence of events in the configured {@link #config-eventStore} in the\n             * day cells. Values may be:\n             *\n             * * `false` - Do not show events in cells.\n             * * `true` - Show a themeable bullet to indicate the presence of events for a date.\n             * * `'count'` - Show a themeable badge containing the event count for a date.\n             * @config {Boolean|'count'}\n             * @default false\n             */\n            showEvents : null,\n\n            /**\n             * The {@link Scheduler.data.EventStore event store} from which the in-cell event presence\n             * indicators are drawn.\n             * @config {Scheduler.data.EventStore}\n             */\n            eventStore : null,\n\n            /**\n             * A function, or the name of a function in the ownership hierarchy to filter which events\n             * are collected into the day cell data blocks.\n             *\n             * Return `true` to include the passed event, or a *falsy* value to exclude the event.\n             * @config {Function|String}\n             */\n            eventFilter : {\n                $config : 'lazy',\n                value   : null\n            }\n        };\n    }\n\n    construct(config) {\n        // Handle deprecated events config. It is now showEvents.\n        // events conflicts with the events data which may be passed in\n        if ('events' in config) {\n            config = {\n                ...config,\n                showEvents : config.events\n            };\n            delete config.events;\n\n            VersionHelper.deprecate(VersionHelper['calendar'] ? 'Calendar' : 'Scheduler', '6.0.0', 'DatePicker#events should be configured as showEvents');\n        }\n        super.construct(config);\n    }\n\n    changeEventFilter(eventFilter) {\n        if (typeof eventFilter === 'string') {\n            const { handler, thisObj } = this.resolveCallback(eventFilter);\n            eventFilter = handler.bind(thisObj);\n        }\n        return eventFilter;\n    }\n\n    doRefresh() {\n        // Hidden widgets must not query the EventStore for loading on demand to be able to use\n        // the EventStore's dateRangeRequested event.\n        if (this.isVisible || !this.showEvents) {\n            this.refreshEventsMap();\n            return super.doRefresh(...arguments);\n        }\n        else {\n            this.whenVisible('doRefresh');\n        }\n    }\n\n    updateShowEvents(showEvents, oldShowEvents) {\n        const\n            me            = this,\n            { classList } = me.contentElement;\n\n        let { eventStore } = me;\n\n        // Begin any animations in the next AF\n        me.requestAnimationFrame(() => {\n            me.element.classList.toggle('b-datepicker-with-events', Boolean(showEvents));\n            me.owner?.element.classList.toggle('b-datepicker-with-events', Boolean(showEvents));\n            showEvents && classList.add(`b-show-events-${showEvents}`);\n            classList.remove(`b-show-events-${oldShowEvents}`);\n        });\n\n        if (showEvents) {\n            if (!eventStore) {\n                const eventStoreOwner = me.up(w => w.eventStore);\n\n                if (eventStoreOwner) {\n                    eventStore = eventStoreOwner.eventStore;\n                }\n                else {\n                    throw new Error('DatePicker configured with events but no eventStore');\n                }\n            }\n        }\n        else {\n            me.eventsMap = null;\n        }\n        if (!me.isConfiguring) {\n            me.updateEventStore(eventStore);\n            me.doRefresh();\n        }\n    }\n\n    refreshEventsMap() {\n        const me = this;\n\n        if (me.showEvents) {\n            me.eventsMap = me.eventStore.getEventCounts({\n                startDate : me.startDate,\n                endDate   : me.endDate,\n                dateMap   : me.eventsMap,\n                filter    : me.eventFilter\n            });\n        }\n    }\n\n    updateEventStore(eventStore) {\n        // Add a listener to refresh on any event change unless the listener is already added.\n        if (eventStore.findListener('change', 'refresh', this) === -1) {\n            eventStore?.[this.showEvents ? 'on' : 'un']?.({\n                change  : 'refresh',\n                thisObj : this\n            });\n        }\n    }\n\n    cellRenderer({ cell, date }) {\n        const\n            { showEvents } = this,\n            count          = this.eventCounts?.get?.(DateHelper.makeKey(date)),\n            isCount        = showEvents === 'count';\n\n        delete cell.dataset.btip;\n        if (count) {\n            if (!isCount && this.eventCountTip) {\n                cell.dataset.btip = this.L('L{ResourceInfoColumn.eventCountText}', count);\n            }\n            DomHelper.createElement({\n                dataset : {\n                    count\n                },\n                class : {\n                    [isCount ? 'b-cell-events-badge' : 'b-icon b-icon-circle'] : 1,\n                    [SchedulerDatePicker.getEventCountClass(count)]            : 1\n                },\n                parent                  : cell,\n                [isCount ? 'text' : ''] : count\n            });\n        }\n    }\n\n    static getEventCountClass(count) {\n        if (count) {\n            if (count < 4) {\n                return 'b-datepicker-1-to-3-events';\n            }\n            if (count < 7) {\n                return 'b-datepicker-4-to-6-events';\n            }\n            return 'b-calendar-7-or-more-events';\n        }\n        return '';\n    }\n\n    static setupClass(meta) {\n        // We take over the type name 'datepicker' when we are in the app\n        meta.replaceType = true;\n\n        super.setupClass(meta);\n    }\n}\n\n// Register this widget type with its Factory\nSchedulerDatePicker.initClass();\n"],"names":["RecurrenceLegend","Localizable","$name","allDaysValueAsArray","allDaysValue","join","workingDaysValue","filter","day","index","DateHelper","nonWorkingDays","nonWorkingDaysValue","getLegend","recurrence","timeSpanStartDate","me","timeSpan","interval","days","monthDays","months","positions","startDate","tplData","fn","frequency","L","length","getDaysLegend","getDayName","getDay","sort","a","b","arrayToText","getDate","month","getMonthShortName","getMonthName","getMonth","position","DayRuleEncoder","decodeDay","getDayShortName","array","map","replace","_$name","DH","scheduleFields","makeDate","fields","value","date","time","DateField","reverse","dateValue","parse","setHours","getHours","getMinutes","getSeconds","getMilliseconds","clone","copyTime","dateTo","dateFrom","d","Date","getTime","adjustEndDate","startTime","endDateField","endTimeField","newEndDate","add","startDateField","startTimeField","eventRecord","durationMS","EditBase","InstancePlugin","configurable","saveAndCloseOnEnter","triggerEvent","dateFormat","timeFormat","editorConfig","items","weekStartDay","construct","client","config","eventEdit","ObjectHelper","assign","clientListenersDetacher","ion","dragCreateEnd","eventAutoCreated","thisObj","doDestroy","_this$_editor","_editor","destroy","onEventAutoCreated","changeEditorConfig","Objects","Config","merge","changeItems","cleanItemsConfig","ref","itemCfg","onDatesChange","params","_me$startTimeField","_me$startDateField2","field","source","min","_me$startDateField","_me$endDateField","isEqual","clearTime","save","Error","values","editor","startFields","endFields","forEach","f","eachWidget","widget","_editor$widgetMap$rec","name","hidden","up","w","recurrenceEditor","push","record","widgetMap","recurrenceCombo","allDay","endDate","duration","diff","durationUnit","onBeforeSave","onAfterSave","updateRecord","assignmentStore","resource","set","onBeforeEditorShow","editingContext","nameField","isCreating","assigningValues","_configuredPlaceholder","placeholder","resetEditingContext","eventStore","isTimelineBase","_me$editingContext$ev","eventElement","closest","classList","remove","element","targetEventElement","_record","onPopupKeyDown","event","readOnly","key","target","tagName","toLowerCase","preventDefault","onSaveClick","finalizeStmCapture","saved","focus","isFinalizingEventSave","close","trigger","onDeleteClick","isDeletingEvent","removed","deleteEvent","autoClose","containsFocus","onCancelClick","isCancelingEdit","hasStmCapture","EventEditor","Popup","type","draggable","handleSelector","axisLock","scrollable","overflowY","titleRenderer","maximizeOnMobile","updateLocalization","arguments","initialTitle","title","chainResourceStore","eventEditFeature","resourceStore","chain","isSpecialRow","storeClass","Store","excludeCollapsedRecords","processWidgetConfig","_widget$type","includes","fieldConfig","store","setConfig","multiSelect","usesSingleAssignment","format","Object","setupEditorButtons","deleteButton","onBeforeShow","args","_super$onBeforeShow","callback","call","onInternalKeyDown","updateReadOnly","saveButton","cancelButton","initClass","RecurrenceCombo","RecurrenceFrequencyCombo","defaultConfig","customValue","splitCls","highlightExternalChange","buildItems","text","cls","isCustomRecurrence","Boolean","RecurrenceLegendButton","Button","localizableProperties","_recurrence","updateLegend","eventStartDate","_eventStartDate","onLocaleChange","RecurrenceEditor","closable","floating","width","recurrenceEditorPanel","bbar","defaults","localeClass","foo","weight","color","onClick","saveHandler","syncEventRecord","cancelHandler","Target","RecurringEventEdit","Base","recurringEventsItems","label","editRecurrenceButton","menuIcon","flex","ignoreParentReadOnly","showRecurringUI","_this$_recurrenceConf","_this$_recurrenceEdit","_recurrenceConfirmation","_recurrenceEditor","onEditorConstructed","_me$recurrenceCombo","hide","onRecurringEventEditorHide","menu","change","onRecurrenceComboChange","internalShowEditor","toggleRecurringFieldsVisibility","enableRecurringEvents","show","_this$editRecurrenceB","_this$editRecurrenceB2","_this$recurrenceCombo","_this$recurrenceCombo2","methodName","_this$recurrenceEdito","_this$recurrenceConfi","isVisible","recurrenceConfirmation","makeRecurrence","rule","eventCopy","copy","recurrenceModel","setStartDate","suspendTimeSpanNotifying","onRecurrableEventBeforeSave","context","isEditing","supportsRecurring","isRecurring","isOccurrence","confirm","actionType","changerFn","finalize","cancelFn","async","$$name","Widget","create","owner","autoShow","centered","modal","minWidth","constrainTo","globalThis","anchor","rootElement","recurrenceEditorSaveHandler","onBeforeShowRecurrenceEditor","bind","_readOnly","loadRecurrenceData","updateRecurrenceFields","userAction","loadingRecord","internalLoadRecord","recurrenceRule","ResourceCombo","Combo","showEventColor","displayField","valueField","picker","itemIconTpl","eventColor","isStyleColor","DomHelper","isNamedColor","style","colorClass","changeShowEventColor","updateShowEventColor","_picker","changePicker","oldPicker","_picker2","innerElements","class","reference","inputElement","syncInputFieldValue","_me$selected","resourceIcon","lastResourceIconCls","selected","punctuation","EventEdit","mixin","TaskEditStm","Delayable","typeField","clearable","required","resourceField","editable","destroyStore","validateDateOnly","colorField","hideWhenEmpty","pluginConfig","scheduler","projectChange","project","onClientReadOnlyToggle","_me$onEditorConstruct","_me$eventTypeField","_me$saveButton","_me$deleteButton","_me$cancelButton","editorListeners","beforehide","beforeshow","keydown","getEditorConfig","keepDate","positioned","parentNode","beforeToggleReveal","console","warn","relayEvents","id","eventTypeField","click","result","align","scrollAction","prototype","getRenderContext","collapsible","direction","tool","recollapseTool","collapsed","toggleReveal","showEventColorPickers","onElementCreated","updateCSSVars","dateLength","timeLength","dateTimeLength","setProperty","resourceRecord","_align","_align$target","nodeType","Element","ELEMENT_NODE","getElementFromEventRecord","isPartOfStore","resources","_super$internalShowEd","toggleEventType","getValue","loadRecord","AsyncHelper","sleep","showBy","updateCentered","timeResolution","timeAxisViewModel","unit","step","increment","detachListeners","onChangeWhileEditing","refresh","updateTargetEventElement","oldTargetEventElement","editEvent","stmCapture","_client$getElementFro","simpleEventEdit","features","disabled","enabled","applyStmCapture","transferred","isCalendar","captureStm","doEditEvent","then","isDestroying","rejectingStmTransaction","freeStm","revealed","isNewRecord","getById","resourceId","TimeSpan","normalize","scrollResourceEventIntoView","animate","edgeOffset","extendTimeAxis","_resourceField$store","masterStore","getResourcesForEvent","storage","eventType","dataset","_widget$dataset","finalizeEventSave","resourceRecords","resolve","reject","suspendAutoCommit","suspendRefresh","beginBatch","endBatch","assignEventToResource","commitAsync","resumeAutoCommit","resumeRefresh","Promise","_me$resourceField","isValid","records","allowOverlap","fullDuration","abort","some","isDateRangeAvailable","saveEvent","e","triggerResult","handleEventResult","isPromise","removeEvents","removeRecord","revertFocus","onChangeProject","onActivateEditor","onDragCreateEnd","proxyElement","onEventEnterKey","assignmentRecord","matches","eventSelector","eventInnerSelector","onEventTypeChange","populateEventMenu","icon","onItem","onBeforeEditorToggleReveal","reveal","shouldReject","GridFeatureManager","registerFeature","ResourceFilter","List","delayable","applyFilters","toggleAllIfCtrlPressed","itemTpl","StringHelper","encodeHtml","masterFilter","filterResources","i","updateEventStore","_me$initialConfig$sto","_me$store","chainedStoreConfig","initialConfig","isStore","syncOrder","changeListeners","un","count","initFilter","changeMasterFilter","r","initialSelection","getRange","onStoreRefresh","action","eventStoreFilter","newDisabled","isFiltered","allSelected","onSelectionChange","added","filtersAdded","addFilter","filterBy","resourceStoreFilter","eventListeners","oldValue","concat","ArrayHelper","triggerFieldChange","_this$store","SchedulerDatePicker","DatePicker","showEvents","eventFilter","$config","events","VersionHelper","deprecate","changeEventFilter","handler","resolveCallback","doRefresh","refreshEventsMap","whenVisible","updateShowEvents","oldShowEvents","contentElement","requestAnimationFrame","_me$owner","toggle","eventStoreOwner","eventsMap","isConfiguring","getEventCounts","dateMap","findListener","_eventStore","cellRenderer","cell","_this$eventCounts","_this$eventCounts$get","eventCounts","get","makeKey","isCount","btip","eventCountTip","createElement","getEventCountClass","parent","setupClass","meta","replaceType"],"mappings":"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9F,GAAG,CAAC,gBAAgB,CAAC,CAAA;AACnC,KAAA;AACJ,GAAA;AACJ,CAAA;AACA;AACAoR,aAAa,CAAC9G,SAAS,EAAE,CAAA;AACzB8G,aAAa,CAACjT,MAAM,GAAG,eAAe;;ACrFtC;AACA;AACA;AACA,MAAM6U,WAAW,GAAG,UAAU,CAAA;AAC9B;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACe,MAAMC,SAAS,SAAS5S,QAAQ,CAAC6S,KAAK,CAACC,WAAW,EAAEzG,kBAAkB,EAAE0G,SAAS,CAAC,CAAC;AAC9F;EACA,WAAW/X,KAAKA,GAAG;AACf,IAAA,OAAO,WAAW,CAAA;AACtB,GAAA;EACA,WAAWkF,YAAYA,GAAG;IACtB,OAAO;AACH;AACZ;AACA;AACA;AACA;AACA;AACA;AACYE,MAAAA,YAAY,EAAG,eAAe;AAC9B;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACY4S,MAAAA,SAAS,EAAG,WAAW;AACvB;AACZ;AACA;AACA;AACA;AACYlT,MAAAA,WAAW,EAAG,IAAI;AAClB;AACZ;AACA;AACA;AACA;AACYkG,MAAAA,QAAQ,EAAG,IAAI;AACf;AACZ;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACYzF,MAAAA,YAAY,EAAG;AACXiH,QAAAA,IAAI,EAAU,aAAa;AAC3BW,QAAAA,KAAK,EAAS,yBAAyB;AACvCmD,QAAAA,QAAQ,EAAM,IAAI;AAClBM,QAAAA,WAAW,EAAG,IAAI;AAClBD,QAAAA,QAAQ,EAAG;AACPC,UAAAA,WAAW,EAAG,IAAA;SACjB;AACDpL,QAAAA,KAAK,EAAG;AACJ;AACpB;AACA;AACA;AACA;AACoBsE,UAAAA,SAAS,EAAG;AACR0C,YAAAA,IAAI,EAAQ,MAAM;AAClBgF,YAAAA,KAAK,EAAO,SAAS;AACrByG,YAAAA,SAAS,EAAG,IAAI;AAChBzP,YAAAA,IAAI,EAAQ,MAAM;AAClBsI,YAAAA,MAAM,EAAM,GAAG;AACfoH,YAAAA,QAAQ,EAAI,IAAA;WACf;AACD;AACpB;AACA;AACA;AACA;AACoBC,UAAAA,aAAa,EAAG;AACZ3L,YAAAA,IAAI,EAAsB,eAAe;AACzCgF,YAAAA,KAAK,EAAqB,aAAa;AACvChJ,YAAAA,IAAI,EAAsB,UAAU;AACpC4P,YAAAA,QAAQ,EAAkB,IAAI;AAC9BjC,YAAAA,UAAU,EAAgB,IAAI;AAC9BD,YAAAA,YAAY,EAAc,MAAM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"}