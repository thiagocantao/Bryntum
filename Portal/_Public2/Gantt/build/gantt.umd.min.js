/*!
 *
 * Bryntum Gantt 4.0.3
 *
 * Copyright(c) 2020 Bryntum AB
 * https://bryntum.com/contact
 * https://bryntum.com/license
 *
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("gantt",[],t):"object"==typeof exports?exports.gantt=t():(e.bryntum=e.bryntum||{},e.bryntum.gantt=t())}(window,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var i=t[r]={i:r,l:!1,exports:{}};return e[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)n.d(r,i,function(t){return e[t]}.bind(null,i));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=36)}([function(e,t){function n(t){return e.exports=n=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)},n(t)}e.exports=n},function(e,t){e.exports=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}},function(e,t,n){var r=n(22);e.exports=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&r(e,t)}},function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}e.exports=function(e,t,r){return t&&n(e.prototype,t),r&&n(e,r),e}},function(e,t,n){var r=n(10),i=n(17);e.exports=function(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?i(e):t}},function(e,t,n){var r=n(23);function i(t,n,o){return"undefined"!=typeof Reflect&&Reflect.get?e.exports=i=Reflect.get:e.exports=i=function(e,t,n){var i=r(e,t);if(i){var o=Object.getOwnPropertyDescriptor(i,t);return o.get?o.get.call(n):o.value}},i(t,n,o||t)}e.exports=i},function(e,t,n){e.exports=n(34)},function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},function(e,t){function n(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(e){return void n(e)}s.done?t(u):Promise.resolve(u).then(r,i)}e.exports=function(e){return function(){var t=this,r=arguments;return new Promise((function(i,o){var a=e.apply(t,r);function s(e){n(a,i,o,s,u,"next",e)}function u(e){n(a,i,o,s,u,"throw",e)}s(void 0)}))}}},function(e,t,n){var r=n(25),i=n(26),o=n(21),a=n(27);e.exports=function(e){return r(e)||i(e)||o(e)||a()}},function(e,t){function n(t){return"function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?e.exports=n=function(e){return typeof e}:e.exports=n=function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(t)}e.exports=n},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return s}));var r=n(1),i=n.n(r),o=n(3),a=n.n(o),s=function(){function t(){i()(this,t)}return a()(t,null,[{key:"cacheFlags",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:navigator.platform,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:navigator.userAgent,n=this;n._isLinux=Boolean(e.match(/Linux/)),n._isMac=Boolean(e.match(/Mac/)),n._isWindows=Boolean(e.match(/Win32/)),n._isIE11=Boolean(t.match(/rv:11/)),n._edgeVersion=n.getVersion(t,/Edge?\/(\d+)\./),n._isEdge=n._edgeVersion>0&&n._edgeVersion<80,n._isEdge||(n._edgeVersion=0),n._isWebkit=Boolean(t.match(/WebKit/))&&!n._isEdge,n._firefoxVersion=n.getVersion(t,/Firefox\/(\d+)\./),n._isFirefox=n._firefoxVersion>0,n._chromeVersion=n._isEdge?0:n.getVersion(t,/Chrom(?:e|ium)\/(\d+)\./),n._isChrome=n._chromeVersion>0,n._isSafari=Boolean(t.match(/Safari/))&&!n._isChrome&&!n._isEdge,n._isMobileSafari=Boolean(t.match(/Mobile.*Safari/)),n._isAndroid=Boolean(t.match(/Android/g));try{document.querySelector(":scope"),n.supportsQueryScope=!n._isFirefox}catch(e){n.supportsQueryScope=!1}n._supportsPassive=!1;try{document.addEventListener("__notvalid__",null,{get passive(){n._supportsPassive=!0}})}catch(e){}}},{key:"getVersion",value:function(e,t){var n=e.match(t);return n?parseInt(n[1]):0}},{key:"setLocalStorageItem",value:function(e,t){this.storageAvailable&&localStorage.setItem(e,t)}},{key:"getLocalStorageItem",value:function(e){return this.storageAvailable&&localStorage.getItem(e)}},{key:"removeLocalStorageItem",value:function(e){this.storageAvailable&&localStorage.removeItem(e)}},{key:"searchParam",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:document.location.search,r=new RegExp("[?&]".concat(e,"=([^&]*)")),i=n.match(r);return i&&i[1]||t}},{key:"getCookie",value:function(e){for(var t=encodeURIComponent(e)+"=",n=document.cookie.split(";"),r=0;r<n.length;r++){for(var i=n[r];" "===i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(t))return decodeURIComponent(i.substring(t.length,i.length))}return""}},{key:"download",value:function(e,t){var n=document.createElement("a");n.download=e,n.href=t||e,n.style.cssText="display:none",document.body.appendChild(n),n.click(),document.body.removeChild(n)}},{key:"downloadBlob",value:function(e,t){var n=window.URL.createObjectURL(e);this.download(t,n),window.URL.revokeObjectURL(n)}},{key:"copyToClipboard",value:function(e){var t=!0,n=document.createElement("textarea");n.value=e,n.style.height=n.style.width=0,document.body.appendChild(n),n.select();try{document.execCommand("copy")}catch(e){t=!1}return n.remove(),t}},{key:"isTouchDevice",get:function(){return"_isTouchDevice"in this?this._isTouchDevice:"ontouchstart"in window||!this.isEdge&&navigator.maxTouchPoints>0||this.isEdge&&window.TouchEvent||navigator.msMaxTouchPoints>0},set:function(e){this._isTouchDevice=e}},{key:"supportsPointerEvents",get:function(){return Boolean(window.PointerEvent||window.MSPointerEvent)}},{key:"isMac",get:function(){return this._isMac}},{key:"isWindows",get:function(){return this._isWindows}},{key:"isLinux",get:function(){return this._isLinux}},{key:"isIE11",get:function(){return this._isIE11}},{key:"isEdge",get:function(){return this._isEdge}},{key:"edgeVersion",get:function(){return this._edgeVersion}},{key:"isWebkit",get:function(){return this._isWebkit}},{key:"isChrome",get:function(){return this._isChrome}},{key:"chromeVersion",get:function(){return this._chromeVersion}},{key:"isFirefox",get:function(){return this._isFirefox}},{key:"firefoxVersion",get:function(){return this._firefoxVersion}},{key:"isSafari",get:function(){return this._isSafari}},{key:"isMobileSafari",get:function(){return this._isMobileSafari}},{key:"isAndroid",get:function(){return this._isAndroid}},{key:"supportsPassive",get:function(){return this._supportsPassive}},{key:"storageAvailable",get:function(){var e,t;try{return e=localStorage,t="__storage_test__",e.setItem(t,t),e.removeItem(t),!0}catch(t){return t instanceof DOMException&&(22===t.code||1014===t.code||"QuotaExceededError"===t.name||"NS_ERROR_DOM_QUOTA_REACHED"===t.name)&&0!==e.length}}},{key:"queryString",get:function(){var e=new URL(window.location.href).searchParams;return Object.fromEntries(e.entries())}},{key:"isBrowserEnv",get:function(){return"undefined"!=typeof window}},{key:"global",get:function(){return"undefined"!=typeof window?window:void 0!==e?e:globalThis||{}}}]),t}();s.isBrowserEnv&&s.cacheFlags(),s._$name="BrowserHelper"}).call(this,n(29))},function(e,t,n){var r=n(30),i=n(31),o=n(21),a=n(32);e.exports=function(e,t){return r(e)||i(e,t)||o(e,t)||a()}},function(e,t,n){var r=n(23),i=n(7);function o(e,t,n,a){return(o="undefined"!=typeof Reflect&&Reflect.set?Reflect.set:function(e,t,n,o){var a,s=r(e,t);if(s){if((a=Object.getOwnPropertyDescriptor(s,t)).set)return a.set.call(o,n),!0;if(!a.writable)return!1}if(a=Object.getOwnPropertyDescriptor(o,t)){if(!a.writable)return!1;a.value=n,Object.defineProperty(o,t,a)}else i(o,t,n);return!0})(e,t,n,a)}e.exports=function(e,t,n,r,i){if(!o(e,t,n,r||e)&&i)throw new Error("failed to set property");return n}},function(e,t,n){"use strict";(function(e){n.d(t,"a",(function(){return c}));var r=n(1),i=n.n(r),o=n(3),a=n.n(o),s=n(11),u=!1;try{u=Boolean(s.a.global.parent&&s.a.global.parent.Siesta||void 0!==e&&(s.a.global.StartTest||s.a.global.Siesta))}catch(e){}var c=function(){function e(){i()(this,e)}return a()(e,null,[{key:"setVersion",value:function(e,t){e=e.toLowerCase(),l[e]={version:t,isNewerThan:function(e){return e<t},isOlderThan:function(e){return e>t}};var n="".concat("gantt",".").concat(e).concat(t.replace(/\./g,"-"));if(s.a.isBrowserEnv)if(!0===window.bryntum[n]){if(!u)throw new Error("Bundle included twice, check cache-busters and file types (.js)");window.BUNDLE_EXCEPTION=!0}else window.bryntum[n]=!0}},{key:"getVersion",value:function(e){if(e=e.toLowerCase(),!l[e])throw new Error("No version specified! Please check that you import VersionHelper right into the class from where you call `deprecate` function.");return l[e].version}},{key:"checkVersion",value:function(e,t,n){var r,i=l.getVersion(e);switch(n){case"<":r=i<t;break;case"<=":r=i<=t;break;case"=":r=i===t;break;case">=":r=i>=t;break;case">":r=i>t}return r}},{key:"deprecate",value:function(e,t,n){if(!l.checkVersion(e,t,"<"))throw new Error("Deprecated API use. ".concat(n));console.warn("Deprecation warning: You are using a deprecated API which will change in v".concat(t,". ").concat(n))}},{key:"isTestEnv",get:function(){return u}}]),e}(),l=c;s.a.isBrowserEnv&&((window.bryntum||(window.bryntum={})).getVersion=l.getVersion.bind(l),window.bryntum.checkVersion=l.checkVersion.bind(l),window.bryntum.deprecate=l.deprecate.bind(l)),c._$name="VersionHelper"}).call(this,n(28))},function(e,t){e.exports=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}},function(e,t,n){var r=n(24);e.exports=function(e){return new r(e)}},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(e,t,n){var r=n(35);e.exports=function(e){return function(){return new r(e.apply(this,arguments))}}},function(e,t,n){var r=n(22),i=n(33);function o(t,n,a){return i()?e.exports=o=Reflect.construct:e.exports=o=function(e,t,n){var i=[null];i.push.apply(i,t);var o=new(Function.bind.apply(e,i));return n&&r(o,n.prototype),o},o.apply(null,arguments)}e.exports=o},function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}},function(e,t,n){var r=n(20);e.exports=function(e,t){if(e){if("string"==typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}},function(e,t){function n(t,r){return e.exports=n=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e},n(t,r)}e.exports=n},function(e,t,n){var r=n(0);e.exports=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=r(e)););return e}},function(e,t){e.exports=function(e){this.wrapped=e}},function(e,t,n){var r=n(20);e.exports=function(e){if(Array.isArray(e))return r(e)}},function(e,t){e.exports=function(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(e,t){var n,r,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:o}catch(e){n=o}try{r="function"==typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var u,c=[],l=!1,f=-1;function d(){l&&u&&(l=!1,u.length?c=u.concat(c):f=-1,c.length&&h())}function h(){if(!l){var e=s(d);l=!0;for(var t=c.length;t;){for(u=c,c=[];++f<t;)u&&u[f].run();f=-1,t=c.length}u=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function v(e,t){this.fun=e,this.array=t}function p(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new v(e,t)),1!==c.length||l||s(h)},v.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=p,i.addListener=p,i.once=p,i.off=p,i.removeListener=p,i.removeAllListeners=p,i.emit=p,i.prependListener=p,i.prependOnceListener=p,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(e){"object"==typeof window&&(n=window)}e.exports=n},function(e,t){e.exports=function(e){if(Array.isArray(e))return e}},function(e,t){e.exports=function(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(e,t){e.exports=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}},function(e,t,n){var r=function(e){"use strict";var t=Object.prototype,n=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(e){s=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var i=t&&t.prototype instanceof f?t:f,o=Object.create(i.prototype),a=new S(r||[]);return o._invoke=function(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return R()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=b(a,n);if(s){if(s===l)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=c(e,t,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===l)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(e,n,a),o}function c(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(e){return{type:"throw",arg:e}}}e.wrap=u;var l={};function f(){}function d(){}function h(){}var v={};v[i]=function(){return this};var p=Object.getPrototypeOf,g=p&&p(p(D([])));g&&g!==t&&n.call(g,i)&&(v=g);var y=h.prototype=f.prototype=Object.create(v);function m(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function k(e,t){var r;this._invoke=function(i,o){function a(){return new t((function(r,a){!function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==typeof f&&n.call(f,"__await")?t.resolve(f.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(f).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}(i,o,r,a)}))}return r=r?r.then(a,a):a()}}function b(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,b(e,t),"throw"===t.method))return l;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=c(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,l;var i=r.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,l):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,l)}function w(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function C(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function S(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(w,this),this.reset(!0)}function D(e){if(e){var t=e[i];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:R}}function R(){return{value:void 0,done:!0}}return d.prototype=y.constructor=h,h.constructor=d,d.displayName=s(h,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===d||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,h):(e.__proto__=h,s(e,a,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},m(k.prototype),k.prototype[o]=function(){return this},e.AsyncIterator=k,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new k(u(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},m(y),s(y,a,"Generator"),y[i]=function(){return this},y.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=D,S.prototype={constructor:S,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(C),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,l):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),l},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),C(n),l}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;C(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:D(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},e}(e.exports);try{regeneratorRuntime=r}catch(e){Function("r","regeneratorRuntime = r")(r)}},function(e,t,n){var r=n(24);function i(e){var t,n;function i(t,n){try{var a=e[t](n),s=a.value,u=s instanceof r;Promise.resolve(u?s.wrapped:s).then((function(e){u?i("return"===t?"return":"next",e):o(a.done?"return":"normal",e)}),(function(e){i("throw",e)}))}catch(e){o("throw",e)}}function o(e,r){switch(e){case"return":t.resolve({value:r,done:!0});break;case"throw":t.reject(r);break;default:t.resolve({value:r,done:!1})}(t=t.next)?i(t.key,t.arg):n=null}this._invoke=function(e,r){return new Promise((function(o,a){var s={key:e,arg:r,resolve:o,reject:a,next:null};n?n=n.next=s:(t=n=s,i(e,r))}))},"function"!=typeof e.return&&(this.return=void 0)}"function"==typeof Symbol&&Symbol.asyncIterator&&(i.prototype[Symbol.asyncIterator]=function(){return this}),i.prototype.next=function(e){return this._invoke("next",e)},i.prototype.throw=function(e){return this._invoke("throw",e)},i.prototype.return=function(e){return this._invoke("return",e)},e.exports=i},function(e,t,n){"use strict";n.r(t),n.d(t,"later",(function(){return u})),n.d(t,"Base",(function(){return ue})),n.d(t,"Config",(function(){return Y})),n.d(t,"GlobalEvents",(function(){return $r})),n.d(t,"AjaxStore",(function(){return Uo})),n.d(t,"DomDataStore",(function(){return qo})),n.d(t,"Duration",(function(){return Ko})),n.d(t,"DataField",(function(){return gi})),n.d(t,"BooleanDataField",(function(){return mi})),n.d(t,"DateDataField",(function(){return bi})),n.d(t,"IntegerDataField",(function(){return Ci})),n.d(t,"ModelDataField",(function(){return Di})),n.d(t,"NumberDataField",(function(){return xi})),n.d(t,"ObjectDataField",(function(){return Ti})),n.d(t,"StringDataField",(function(){return Ai})),n.d(t,"Model",(function(){return Bi})),n.d(t,"StateTrackingManager",(function(){return Fs})),n.d(t,"Store",(function(){return No})),n.d(t,"Transaction",(function(){return ga})),n.d(t,"AjaxHelper",(function(){return Je})),n.d(t,"ArrayHelper",(function(){return De})),n.d(t,"AsyncHelper",(function(){return Ls})),n.d(t,"BrowserHelper",(function(){return j.a})),n.d(t,"CSSHelper",(function(){return js})),n.d(t,"DateHelper",(function(){return Zt})),n.d(t,"DomHelper",(function(){return Cr})),n.d(t,"DomSync",(function(){return Gs})),n.d(t,"DragHelper",(function(){return hu})),n.d(t,"EventHelper",(function(){return nu})),n.d(t,"FunctionHelper",(function(){return xe})),n.d(t,"IdHelper",(function(){return zi})),n.d(t,"ObjectHelper",(function(){return an})),n.d(t,"ResizeHelper",(function(){return Su})),n.d(t,"ResizeMonitor",(function(){return Mu})),n.d(t,"StringHelper",(function(){return E})),n.d(t,"TemplateHelper",(function(){return Iu})),n.d(t,"VersionHelper",(function(){return y.a})),n.d(t,"WidgetHelper",(function(){return lc})),n.d(t,"DataGenerator",(function(){return dc})),n.d(t,"DemoBot",(function(){return pc})),n.d(t,"DomClassList",(function(){return An})),n.d(t,"Formatter",(function(){return bc})),n.d(t,"Fullscreen",(function(){return wc})),n.d(t,"NumberFormat",(function(){return Tc})),n.d(t,"Objects",(function(){return F})),n.d(t,"Point",(function(){return Xs})),n.d(t,"Promissory",(function(){return Vu})),n.d(t,"RandomGenerator",(function(){return fc})),n.d(t,"Rectangle",(function(){return En})),n.d(t,"Scroller",(function(){return Hu})),n.d(t,"LocaleManager",(function(){return rt})),n.d(t,"Localizable",(function(){return lt})),n.d(t,"LocaleHelper",(function(){return tt})),n.d(t,"Delayable",(function(){return _a})),n.d(t,"Draggable",(function(){return Nc})),n.d(t,"Droppable",(function(){return zc})),n.d(t,"Events",(function(){return Ge})),n.d(t,"Factoryable",(function(){return vi})),n.d(t,"Featureable",(function(){return Xc})),n.d(t,"Finalizable",(function(){return Ac})),n.d(t,"Hoverable",(function(){return ol})),n.d(t,"InstancePlugin",(function(){return qr})),n.d(t,"Override",(function(){return sl})),n.d(t,"Pluggable",(function(){return Xr})),n.d(t,"State",(function(){return Jr})),n.d(t,"Bag",(function(){return so})),n.d(t,"ClickRepeater",(function(){return cl})),n.d(t,"Collection",(function(){return no})),n.d(t,"CollectionFilter",(function(){return Vi})),n.d(t,"CollectionSorter",(function(){return Gi})),n.d(t,"DragContext",(function(){return _c})),n.d(t,"DragProxy",(function(){return Hc})),n.d(t,"DragTipProxy",(function(){return ef})),n.d(t,"DynamicObject",(function(){return Yc})),n.d(t,"Month",(function(){return rf})),n.d(t,"Parser",(function(){return Rf})),n.d(t,"Badge",(function(){return Ml})),n.d(t,"BooleanCombo",(function(){return ed})),n.d(t,"Button",(function(){return Fl})),n.d(t,"ButtonGroup",(function(){return nd})),n.d(t,"CalendarPanel",(function(){return id})),n.d(t,"Checkbox",(function(){return ad})),n.d(t,"ChipView",(function(){return Uf})),n.d(t,"Combo",(function(){return Xf})),n.d(t,"Container",(function(){return Rl})),n.d(t,"DateField",(function(){return pd})),n.d(t,"DatePicker",(function(){return hd})),n.d(t,"DateTimeField",(function(){return wd})),n.d(t,"DisplayField",(function(){return Sd})),n.d(t,"DurationField",(function(){return Rd})),n.d(t,"Editor",(function(){return fd})),n.d(t,"Field",(function(){return Pf})),n.d(t,"FileField",(function(){return Ed})),n.d(t,"FilePicker",(function(){return Md})),n.d(t,"FilterField",(function(){return Pd})),n.d(t,"List",(function(){return Wf})),n.d(t,"Mask",(function(){return Ku})),n.d(t,"Menu",(function(){return Hd})),n.d(t,"MenuItem",(function(){return jd})),n.d(t,"MessageDialog",(function(){return zd})),n.d(t,"NumberField",(function(){return Yd})),n.d(t,"PagingToolbar",(function(){return qd})),n.d(t,"Panel",(function(){return Nl})),n.d(t,"Popup",(function(){return zl})),n.d(t,"Renderable",(function(){return Uu})),n.d(t,"Ripple",(function(){return ml})),n.d(t,"Slider",(function(){return Zd})),n.d(t,"Splitter",(function(){return nh})),n.d(t,"TabPanel",(function(){return sh})),n.d(t,"TextAreaField",(function(){return ch})),n.d(t,"TextField",(function(){return Of})),n.d(t,"TimeField",(function(){return kd})),n.d(t,"TimePicker",(function(){return yd})),n.d(t,"Toast",(function(){return cc})),n.d(t,"Tool",(function(){return fl})),n.d(t,"Toolbar",(function(){return jl})),n.d(t,"Tooltip",(function(){return Kl})),n.d(t,"Widget",(function(){return oc})),n.d(t,"Histogram",(function(){return gh})),n.d(t,"Scale",(function(){return wh})),n.d(t,"ActionColumn",(function(){return Ph})),n.d(t,"AggregateColumn",(function(){return Oh})),n.d(t,"CheckColumn",(function(){return Hh})),n.d(t,"Column",(function(){return Dh})),n.d(t,"DateColumn",(function(){return Nh})),n.d(t,"PercentColumn",(function(){return zh})),n.d(t,"RatingColumn",(function(){return Uh})),n.d(t,"RowNumberColumn",(function(){return Kh})),n.d(t,"TemplateColumn",(function(){return Zh})),n.d(t,"TimeColumn",(function(){return Qh})),n.d(t,"TreeColumn",(function(){return nv})),n.d(t,"WidgetColumn",(function(){return _h})),n.d(t,"ColumnStore",(function(){return Th})),n.d(t,"GridRowModel",(function(){return iv})),n.d(t,"CellMenu",(function(){return hv})),n.d(t,"CellTooltip",(function(){return pv})),n.d(t,"ColumnAutoWidth",(function(){return kv})),n.d(t,"ColumnDragToolbar",(function(){return Dv})),n.d(t,"ColumnPicker",(function(){return xv})),n.d(t,"ColumnReorder",(function(){return Tv})),n.d(t,"ColumnResize",(function(){return Av})),n.d(t,"ContextMenu",(function(){return Iv})),n.d(t,"Filter",(function(){return _v})),n.d(t,"FilterBar",(function(){return Nv})),n.d(t,"GridFeatureManager",(function(){return fv})),n.d(t,"GridGroupSummary",(function(){return Gv})),n.d(t,"GridSummary",(function(){return Uv})),n.d(t,"Group",(function(){return Zv})),n.d(t,"HeaderMenu",(function(){return Qv})),n.d(t,"QuickFind",(function(){return rp})),n.d(t,"RegionResize",(function(){return op})),n.d(t,"RowReorder",(function(){return sp})),n.d(t,"Search",(function(){return fp})),n.d(t,"Sort",(function(){return pp})),n.d(t,"Stripe",(function(){return yp})),n.d(t,"Tree",(function(){return bp})),n.d(t,"GridExportDialog",(function(){return Fp})),n.d(t,"GridMultiPageExporter",(function(){return zp})),n.d(t,"GridMultiPageVerticalExporter",(function(){return Gp})),n.d(t,"GridPdfExport",(function(){return Kp})),n.d(t,"ExportOrientationCombo",(function(){return Ip})),n.d(t,"ExportRowsCombo",(function(){return Ap})),n.d(t,"LocalizableCombo",(function(){return Tp})),n.d(t,"GridSinglePageExporter",(function(){return Up})),n.d(t,"PaperFormat",(function(){return Cp})),n.d(t,"Orientation",(function(){return Sp})),n.d(t,"RowsRange",(function(){return wp})),n.d(t,"FileFormat",(function(){return Dp})),n.d(t,"GridExcelExporter",(function(){return eg})),n.d(t,"GanttMspExport",(function(){return hg})),n.d(t,"ScrollManager",(function(){return pg})),n.d(t,"TableExporter",(function(){return Zp})),n.d(t,"Bar",(function(){return yg})),n.d(t,"Footer",(function(){return wg})),n.d(t,"Grid",(function(){return Ty})),n.d(t,"GridBase",(function(){return Cy})),n.d(t,"Header",(function(){return Bg})),n.d(t,"RowManager",(function(){return Eg})),n.d(t,"SubGrid",(function(){return ly})),n.d(t,"TreeGrid",(function(){return Ay})),n.d(t,"AbstractCrudManager",(function(){return Ny})),n.d(t,"AjaxTransport",(function(){return zy})),n.d(t,"CrudManagerView",(function(){return Gy})),n.d(t,"JsonEncoder",(function(){return Uy})),n.d(t,"SchedulerProjectCrudManager",(function(){return Ky})),n.d(t,"ResourceTimeRangeStore",(function(){return rm})),n.d(t,"SchedulerAssignmentStore",(function(){return GC})),n.d(t,"SchedulerCrudManager",(function(){return Ix})),n.d(t,"SchedulerDependencyStore",(function(){return Ax})),n.d(t,"SchedulerEventStore",(function(){return sx})),n.d(t,"SchedulerResourceStore",(function(){return tD})),n.d(t,"TimeAxis",(function(){return Vx})),n.d(t,"ColumnLines",(function(){return Wx})),n.d(t,"DependencyCreation",(function(){return Yx})),n.d(t,"EventContextMenu",(function(){return Jx})),n.d(t,"EventDrag",(function(){return iE})),n.d(t,"EventDragCreate",(function(){return uE})),n.d(t,"EventDragSelect",(function(){return lE})),n.d(t,"EventEdit",(function(){return JE})),n.d(t,"EventFilter",(function(){return eT})),n.d(t,"EventMenu",(function(){return Xx})),n.d(t,"EventResize",(function(){return oT})),n.d(t,"EventTooltip",(function(){return cT})),n.d(t,"GroupSummary",(function(){return $A})),n.d(t,"HeaderContextMenu",(function(){return VA})),n.d(t,"HeaderZoom",(function(){return WA})),n.d(t,"NonWorkingTime",(function(){return XA})),n.d(t,"Pan",(function(){return JA})),n.d(t,"ResourceTimeRanges",(function(){return nP})),n.d(t,"ScheduleContextMenu",(function(){return aP})),n.d(t,"ScheduleMenu",(function(){return iP})),n.d(t,"SchedulerDependencies",(function(){return pP})),n.d(t,"SchedulerDependencyEdit",(function(){return kP})),n.d(t,"SchedulerLabels",(function(){return xP})),n.d(t,"ScheduleTooltip",(function(){return TP})),n.d(t,"SimpleEventEdit",(function(){return AP})),n.d(t,"Summary",(function(){return IP})),n.d(t,"TimeAxisHeaderMenu",(function(){return FP})),n.d(t,"TimeRanges",(function(){return jP})),n.d(t,"TimeSpanMenuBase",(function(){return qx})),n.d(t,"TimeSpanRecordContextMenuBase",(function(){return BP})),n.d(t,"SchedulerExportDialog",(function(){return zP})),n.d(t,"SchedulerMultiPageExporter",(function(){return qP})),n.d(t,"SchedulerMultiPageVerticalExporter",(function(){return XP})),n.d(t,"SchedulerPdfExport",(function(){return eI})),n.d(t,"SchedulerSinglePageExporter",(function(){return JP})),n.d(t,"ScheduleRangeCombo",(function(){return NP})),n.d(t,"ScheduleRange",(function(){return HP})),n.d(t,"ExcelExporter",(function(){return iI})),n.d(t,"ResourceInfoColumn",(function(){return aI})),n.d(t,"SchedulerTimeAxisColumn",(function(){return PA})),n.d(t,"ResourceTimeRangeModel",(function(){return tm})),n.d(t,"TimeSpan",(function(){return Qy})),n.d(t,"SchedulerAssignmentModel",(function(){return RC})),n.d(t,"SchedulerDependencyModel",(function(){return mx})),n.d(t,"SchedulerEventModel",(function(){return KR})),n.d(t,"SchedulerResourceModel",(function(){return WS})),n.d(t,"ProjectModelMixin",(function(){return zT})),n.d(t,"PresetManager",(function(){return $x})),n.d(t,"PresetStore",(function(){return Bx})),n.d(t,"ViewPreset",(function(){return jx})),n.d(t,"RectangularPathFinder",(function(){return uP})),n.d(t,"ScheduleTableExporter",(function(){return nI})),n.d(t,"HorizontalTimeAxis",(function(){return EA})),n.d(t,"Scheduler",(function(){return uI})),n.d(t,"SchedulerBase",(function(){return _A})),n.d(t,"TimeAxisViewModel",(function(){return hT})),n.d(t,"UndoRedo",(function(){return fI})),n.d(t,"SchedulerProAssignmentStore",(function(){return wI})),n.d(t,"CalendarManagerStore",(function(){return EI})),n.d(t,"SchedulerProDependencyStore",(function(){return FI})),n.d(t,"EventStore",(function(){return bO})),n.d(t,"SchedulerProResourceStore",(function(){return FO})),n.d(t,"PartOfProject",(function(){return yI})),n.d(t,"ProjectCrudManager",(function(){return jO})),n.d(t,"SchedulerProAssignmentModel",(function(){return kI})),n.d(t,"SchedulerProCalendarIntervalModel",(function(){return SI})),n.d(t,"SchedulerProCalendarModel",(function(){return RI})),n.d(t,"SchedulerProDependencyModel",(function(){return II})),n.d(t,"EventModel",(function(){return mO})),n.d(t,"SchedulerProProjectModel",(function(){return NO})),n.d(t,"SchedulerProResourceModel",(function(){return IO})),n.d(t,"PercentDoneMixin",(function(){return jI})),n.d(t,"DurationColumn",(function(){return zO})),n.d(t,"ResourceCalendarColumn",(function(){return KO})),n.d(t,"ProTaskEditStm",(function(){return ZO})),n.d(t,"CalendarField",(function(){return UO})),n.d(t,"ConstraintTypePicker",(function(){return QO})),n.d(t,"DependencyTypePicker",(function(){return nF})),n.d(t,"EffortField",(function(){return iF})),n.d(t,"EndDateField",(function(){return aF})),n.d(t,"GanttTaskEditor",(function(){return NF})),n.d(t,"ModelCombo",(function(){return GO})),n.d(t,"SchedulerTaskEditor",(function(){return UF})),n.d(t,"SchedulingModePicker",(function(){return LF})),n.d(t,"StartDateField",(function(){return bF})),n.d(t,"TaskEditorBase",(function(){return dF})),n.d(t,"Timeline",(function(){return KF})),n.d(t,"AdvancedTab",(function(){return _F})),n.d(t,"DependencyTab",(function(){return EF})),n.d(t,"EditorTab",(function(){return gF})),n.d(t,"FormTab",(function(){return mF})),n.d(t,"GeneralTab",(function(){return CF})),n.d(t,"NotesTab",(function(){return HF})),n.d(t,"PredecessorsTab",(function(){return PF})),n.d(t,"ResourcesTab",(function(){return OF})),n.d(t,"SchedulerAdvancedTab",(function(){return GF})),n.d(t,"SchedulerGeneralTab",(function(){return zF})),n.d(t,"SuccessorsTab",(function(){return MF})),n.d(t,"ReadyStatePropagator",(function(){return uF})),n.d(t,"EventLoader",(function(){return vF})),n.d(t,"PercentBar",(function(){return sL})),n.d(t,"ResourceNonWorkingTime",(function(){return cL})),n.d(t,"SchedulerProTaskEdit",(function(){return fL})),n.d(t,"ResourceHistogram",(function(){return yL})),n.d(t,"SchedulerProBase",(function(){return hL})),n.d(t,"SchedulerPro",(function(){return wL})),n.d(t,"AddNewColumn",(function(){return SL})),n.d(t,"AllColumns",(function(){return h_})),n.d(t,"CalendarColumn",(function(){return EL})),n.d(t,"ConstraintDateColumn",(function(){return PL})),n.d(t,"ConstraintTypeColumn",(function(){return OL})),n.d(t,"DeadlineDateColumn",(function(){return LL})),n.d(t,"DependencyColumn",(function(){return vj})),n.d(t,"EarlyEndDateColumn",(function(){return _L})),n.d(t,"EarlyStartDateColumn",(function(){return HL})),n.d(t,"EffortColumn",(function(){return NL})),n.d(t,"EndDateColumn",(function(){return zL})),n.d(t,"EventModeColumn",(function(){return p_})),n.d(t,"GanttDateColumn",(function(){return ML})),n.d(t,"LateEndDateColumn",(function(){return GL})),n.d(t,"LateStartDateColumn",(function(){return UL})),n.d(t,"ManuallyScheduledColumn",(function(){return KL})),n.d(t,"MilestoneColumn",(function(){return ZL})),n.d(t,"NameColumn",(function(){return QL})),n.d(t,"NoteColumn",(function(){return tj})),n.d(t,"PercentDoneColumn",(function(){return rj})),n.d(t,"PredecessorColumn",(function(){return gj})),n.d(t,"ResourceAssignmentColumn",(function(){return Xj})),n.d(t,"RollupColumn",(function(){return Jj})),n.d(t,"SchedulingModeColumn",(function(){return e_})),n.d(t,"SequenceColumn",(function(){return n_})),n.d(t,"ShowInTimelineColumn",(function(){return i_})),n.d(t,"StartDateColumn",(function(){return a_})),n.d(t,"SuccessorColumn",(function(){return u_})),n.d(t,"TimeAxisColumn",(function(){return y_})),n.d(t,"TotalSlackColumn",(function(){return l_})),n.d(t,"WBSColumn",(function(){return d_})),n.d(t,"AssignmentsManipulationStore",(function(){return $j})),n.d(t,"AssignmentStore",(function(){return D_})),n.d(t,"DependencyStore",(function(){return T_})),n.d(t,"ResourceStore",(function(){return I_})),n.d(t,"TaskStore",(function(){return KB})),n.d(t,"WbsField",(function(){return F_})),n.d(t,"Baselines",(function(){return ZB})),n.d(t,"CellEdit",(function(){return QB})),n.d(t,"CriticalPaths",(function(){return rH})),n.d(t,"Dependencies",(function(){return lH})),n.d(t,"DependencyEdit",(function(){return dH})),n.d(t,"DragBase",(function(){return nE})),n.d(t,"Labels",(function(){return vH})),n.d(t,"Indicators",(function(){return gH})),n.d(t,"ProgressLine",(function(){return mH})),n.d(t,"ProjectLines",(function(){return bH})),n.d(t,"Rollups",(function(){return RH})),n.d(t,"TaskEdit",(function(){return MH})),n.d(t,"TaskContextMenu",(function(){return OH})),n.d(t,"TaskMenu",(function(){return PH})),n.d(t,"TaskTooltip",(function(){return LH})),n.d(t,"MultiPageExporter",(function(){return HH})),n.d(t,"MultiPageVerticalExporter",(function(){return NH})),n.d(t,"PdfExport",(function(){return GH})),n.d(t,"SinglePageExporter",(function(){return zH})),n.d(t,"AssignmentModel",(function(){return C_})),n.d(t,"AssignmentsManipulationModel",(function(){return mj})),n.d(t,"Baseline",(function(){return _B})),n.d(t,"CalendarIntervalModel",(function(){return UH})),n.d(t,"CalendarModel",(function(){return KH})),n.d(t,"DependencyModel",(function(){return x_})),n.d(t,"ProjectModel",(function(){return a$})),n.d(t,"ResourceModel",(function(){return A_})),n.d(t,"TaskModel",(function(){return WB})),n.d(t,"ProjectGenerator",(function(){return h$})),n.d(t,"ResourceAssignmentParser",(function(){return _j})),n.d(t,"Gantt",(function(){return H$})),n.d(t,"GanttBase",(function(){return P$})),n.d(t,"AssignmentField",(function(){return Uj})),n.d(t,"AssignmentGrid",(function(){return zj})),n.d(t,"AssignmentPicker",(function(){return Gj})),n.d(t,"CalendarPicker",(function(){return RL})),n.d(t,"DependencyField",(function(){return cj})),n.d(t,"TaskEditor",(function(){return EH})),n.d(t,"ConstraintType",(function(){return XC})),n.d(t,"GanttProjectMixin",(function(){return n$})),n.d(t,"ProjectType",(function(){return tS})),n.d(t,"SchedulingMode",(function(){return ZC})),n.d(t,"TimeUnit",(function(){return KC})),n.d(t,"GanttTag",(function(){return z$}));var r=function(){var e={version:"1.2.0"};return Array.prototype.indexOf||(Array.prototype.indexOf=function(e){if(null==this)throw new TypeError;var t=Object(this),n=t.length>>>0;if(0===n)return-1;var r=0;if(arguments.length>1&&((r=Number(arguments[1]))!=r?r=0:0!=r&&r!=1/0&&r!=-1/0&&(r=(r>0||-1)*Math.floor(Math.abs(r)))),r>=n)return-1;for(var i=r>=0?r:Math.max(n-Math.abs(r),0);i<n;i++)if(i in t&&t[i]===e)return i;return-1}),String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),e.array={},e.array.sort=function(e,t){e.sort((function(e,t){return+e-+t})),t&&0===e[0]&&e.push(e.shift())},e.array.next=function(e,t,n){for(var r,i=0!==n[0],o=0,a=t.length-1;a>-1;--a){if((r=t[a])===e)return r;if(!(r>e||0===r&&i&&n[1]>e))break;o=a}return t[o]},e.array.nextInvalid=function(e,t,n){for(var r=n[0],i=n[1],o=t.length,a=0===t[o-1]&&0!==r?i:0,s=e,u=t.indexOf(e),c=s;s===(t[u]||a);)if(++s>i&&(s=r),++u===o&&(u=0),s===c)return;return s},e.array.prev=function(e,t,n){for(var r,i=t.length,o=0!==n[0],a=i-1,s=0;s<i;s++){if((r=t[s])===e)return r;if(!(r<e||0===r&&o&&n[1]<e))break;a=s}return t[a]},e.array.prevInvalid=function(e,t,n){for(var r=n[0],i=n[1],o=t.length,a=0===t[o-1]&&0!==r?i:0,s=e,u=t.indexOf(e),c=s;s===(t[u]||a);)if(--s<r&&(s=i),-1===--u&&(u=o-1),s===c)return;return s},e.day=e.D={name:"day",range:86400,val:function(t){return t.D||(t.D=e.date.getDate.call(t))},isValid:function(t,n){return e.D.val(t)===(n||e.D.extent(t)[1])},extent:function(t){if(t.DExtent)return t.DExtent;var n=e.M.val(t),r=e.DAYS_IN_MONTH[n-1];return 2===n&&366===e.dy.extent(t)[1]&&(r+=1),t.DExtent=[1,r]},start:function(t){return t.DStart||(t.DStart=e.date.next(e.Y.val(t),e.M.val(t),e.D.val(t)))},end:function(t){return t.DEnd||(t.DEnd=e.date.prev(e.Y.val(t),e.M.val(t),e.D.val(t)))},next:function(t,n){n=n>e.D.extent(t)[1]?1:n;var r=e.date.nextRollover(t,n,e.D,e.M),i=e.D.extent(r)[1];return n=n>i?1:n||i,e.date.next(e.Y.val(r),e.M.val(r),n)},prev:function(t,n){var r=e.date.prevRollover(t,n,e.D,e.M),i=e.D.extent(r)[1];return e.date.prev(e.Y.val(r),e.M.val(r),n>i?i:n||i)}},e.dayOfWeekCount=e.dc={name:"day of week count",range:604800,val:function(t){return t.dc||(t.dc=Math.floor((e.D.val(t)-1)/7)+1)},isValid:function(t,n){return e.dc.val(t)===n||0===n&&e.D.val(t)>e.D.extent(t)[1]-7},extent:function(t){return t.dcExtent||(t.dcExtent=[1,Math.ceil(e.D.extent(t)[1]/7)])},start:function(t){return t.dcStart||(t.dcStart=e.date.next(e.Y.val(t),e.M.val(t),Math.max(1,7*(e.dc.val(t)-1)+1||1)))},end:function(t){return t.dcEnd||(t.dcEnd=e.date.prev(e.Y.val(t),e.M.val(t),Math.min(7*e.dc.val(t),e.D.extent(t)[1])))},next:function(t,n){n=n>e.dc.extent(t)[1]?1:n;var r=e.date.nextRollover(t,n,e.dc,e.M);n=n>e.dc.extent(r)[1]?1:n;var i=e.date.next(e.Y.val(r),e.M.val(r),0===n?e.D.extent(r)[1]-6:1+7*(n-1));return i.getTime()<=t.getTime()?(r=e.M.next(t,e.M.val(t)+1),e.date.next(e.Y.val(r),e.M.val(r),0===n?e.D.extent(r)[1]-6:1+7*(n-1))):i},prev:function(t,n){var r=e.date.prevRollover(t,n,e.dc,e.M),i=e.dc.extent(r)[1];return n=n>i?i:n||i,e.dc.end(e.date.prev(e.Y.val(r),e.M.val(r),1+7*(n-1)))}},e.dayOfWeek=e.dw=e.d={name:"day of week",range:86400,val:function(t){return t.dw||(t.dw=e.date.getDay.call(t)+1)},isValid:function(t,n){return e.dw.val(t)===(n||7)},extent:function(){return[1,7]},start:function(t){return e.D.start(t)},end:function(t){return e.D.end(t)},next:function(t,n){return n=n>7?1:n||7,e.date.next(e.Y.val(t),e.M.val(t),e.D.val(t)+(n-e.dw.val(t))+(n<=e.dw.val(t)?7:0))},prev:function(t,n){return n=n>7?7:n||7,e.date.prev(e.Y.val(t),e.M.val(t),e.D.val(t)+(n-e.dw.val(t))+(n>=e.dw.val(t)?-7:0))}},e.dayOfYear=e.dy={name:"day of year",range:86400,val:function(t){return t.dy||(t.dy=Math.ceil(1+(e.D.start(t).getTime()-e.Y.start(t).getTime())/e.DAY))},isValid:function(t,n){return e.dy.val(t)===(n||e.dy.extent(t)[1])},extent:function(t){var n=e.Y.val(t);return t.dyExtent||(t.dyExtent=[1,n%4?365:366])},start:function(t){return e.D.start(t)},end:function(t){return e.D.end(t)},next:function(t,n){n=n>e.dy.extent(t)[1]?1:n;var r=e.date.nextRollover(t,n,e.dy,e.Y),i=e.dy.extent(r)[1];return n=n>i?1:n||i,e.date.next(e.Y.val(r),e.M.val(r),n)},prev:function(t,n){var r=e.date.prevRollover(t,n,e.dy,e.Y),i=e.dy.extent(r)[1];return n=n>i?i:n||i,e.date.prev(e.Y.val(r),e.M.val(r),n)}},e.hour=e.h={name:"hour",range:3600,val:function(t){return t.h||(t.h=e.date.getHour.call(t))},isValid:function(t,n){return e.h.val(t)===n},extent:function(){return[0,23]},start:function(t){return t.hStart||(t.hStart=e.date.next(e.Y.val(t),e.M.val(t),e.D.val(t),e.h.val(t)))},end:function(t){return t.hEnd||(t.hEnd=e.date.prev(e.Y.val(t),e.M.val(t),e.D.val(t),e.h.val(t)))},next:function(t,n){n=n>23?0:n;var r=e.date.next(e.Y.val(t),e.M.val(t),e.D.val(t)+(n<=e.h.val(t)?1:0),n);return!e.date.isUTC&&r.getTime()<=t.getTime()&&(r=e.date.next(e.Y.val(r),e.M.val(r),e.D.val(r),n+1)),r},prev:function(t,n){return n=n>23?23:n,e.date.prev(e.Y.val(t),e.M.val(t),e.D.val(t)+(n>=e.h.val(t)?-1:0),n)}},e.minute=e.m={name:"minute",range:60,val:function(t){return t.m||(t.m=e.date.getMin.call(t))},isValid:function(t,n){return e.m.val(t)===n},extent:function(e){return[0,59]},start:function(t){return t.mStart||(t.mStart=e.date.next(e.Y.val(t),e.M.val(t),e.D.val(t),e.h.val(t),e.m.val(t)))},end:function(t){return t.mEnd||(t.mEnd=e.date.prev(e.Y.val(t),e.M.val(t),e.D.val(t),e.h.val(t),e.m.val(t)))},next:function(t,n){var r=e.m.val(t),i=e.s.val(t),o=n>59?60-r:n<=r?60-r+n:n-r,a=new Date(t.getTime()+o*e.MIN-i*e.SEC);return!e.date.isUTC&&a.getTime()<=t.getTime()&&(a=new Date(t.getTime()+(o+120)*e.MIN-i*e.SEC)),a},prev:function(t,n){return n=n>59?59:n,e.date.prev(e.Y.val(t),e.M.val(t),e.D.val(t),e.h.val(t)+(n>=e.m.val(t)?-1:0),n)}},e.month=e.M={name:"month",range:2629740,val:function(t){return t.M||(t.M=e.date.getMonth.call(t)+1)},isValid:function(t,n){return e.M.val(t)===(n||12)},extent:function(){return[1,12]},start:function(t){return t.MStart||(t.MStart=e.date.next(e.Y.val(t),e.M.val(t)))},end:function(t){return t.MEnd||(t.MEnd=e.date.prev(e.Y.val(t),e.M.val(t)))},next:function(t,n){return n=n>12?1:n||12,e.date.next(e.Y.val(t)+(n>e.M.val(t)?0:1),n)},prev:function(t,n){return n=n>12?12:n||12,e.date.prev(e.Y.val(t)-(n>=e.M.val(t)?1:0),n)}},e.second=e.s={name:"second",range:1,val:function(t){return t.s||(t.s=e.date.getSec.call(t))},isValid:function(t,n){return e.s.val(t)===n},extent:function(){return[0,59]},start:function(e){return e},end:function(e){return e},next:function(t,n){var r=e.s.val(t),i=n>59?60-r:n<=r?60-r+n:n-r,o=new Date(t.getTime()+i*e.SEC);return!e.date.isUTC&&o.getTime()<=t.getTime()&&(o=new Date(t.getTime()+(i+7200)*e.SEC)),o},prev:function(t,n,r){return n=n>59?59:n,e.date.prev(e.Y.val(t),e.M.val(t),e.D.val(t),e.h.val(t),e.m.val(t)+(n>=e.s.val(t)?-1:0),n)}},e.time=e.t={name:"time",range:1,val:function(t){return t.t||(t.t=3600*e.h.val(t)+60*e.m.val(t)+e.s.val(t))},isValid:function(t,n){return e.t.val(t)===n},extent:function(){return[0,86399]},start:function(e){return e},end:function(e){return e},next:function(t,n){n=n>86399?0:n;var r=e.date.next(e.Y.val(t),e.M.val(t),e.D.val(t)+(n<=e.t.val(t)?1:0),0,0,n);return!e.date.isUTC&&r.getTime()<t.getTime()&&(r=e.date.next(e.Y.val(r),e.M.val(r),e.D.val(r),e.h.val(r),e.m.val(r),n+7200)),r},prev:function(t,n){return n=n>86399?86399:n,e.date.next(e.Y.val(t),e.M.val(t),e.D.val(t)+(n>=e.t.val(t)?-1:0),0,0,n)}},e.weekOfMonth=e.wm={name:"week of month",range:604800,val:function(t){return t.wm||(t.wm=(e.D.val(t)+(e.dw.val(e.M.start(t))-1)+(7-e.dw.val(t)))/7)},isValid:function(t,n){return e.wm.val(t)===(n||e.wm.extent(t)[1])},extent:function(t){return t.wmExtent||(t.wmExtent=[1,(e.D.extent(t)[1]+(e.dw.val(e.M.start(t))-1)+(7-e.dw.val(e.M.end(t))))/7])},start:function(t){return t.wmStart||(t.wmStart=e.date.next(e.Y.val(t),e.M.val(t),Math.max(e.D.val(t)-e.dw.val(t)+1,1)))},end:function(t){return t.wmEnd||(t.wmEnd=e.date.prev(e.Y.val(t),e.M.val(t),Math.min(e.D.val(t)+(7-e.dw.val(t)),e.D.extent(t)[1])))},next:function(t,n){n=n>e.wm.extent(t)[1]?1:n;var r=e.date.nextRollover(t,n,e.wm,e.M),i=e.wm.extent(r)[1];return n=n>i?1:n||i,e.date.next(e.Y.val(r),e.M.val(r),Math.max(1,7*(n-1)-(e.dw.val(r)-2)))},prev:function(t,n){var r=e.date.prevRollover(t,n,e.wm,e.M),i=e.wm.extent(r)[1];return n=n>i?i:n||i,e.wm.end(e.date.next(e.Y.val(r),e.M.val(r),Math.max(1,7*(n-1)-(e.dw.val(r)-2))))}},e.weekOfYear=e.wy={name:"week of year (ISO)",range:604800,val:function(t){if(t.wy)return t.wy;var n=e.dw.next(e.wy.start(t),5),r=e.dw.next(e.Y.prev(n,e.Y.val(n)-1),5);return t.wy=1+Math.ceil((n.getTime()-r.getTime())/e.WEEK)},isValid:function(t,n){return e.wy.val(t)===(n||e.wy.extent(t)[1])},extent:function(t){if(t.wyExtent)return t.wyExtent;var n=e.dw.next(e.wy.start(t),5),r=e.dw.val(e.Y.start(n)),i=e.dw.val(e.Y.end(n));return t.wyExtent=[1,5===r||5===i?53:52]},start:function(t){return t.wyStart||(t.wyStart=e.date.next(e.Y.val(t),e.M.val(t),e.D.val(t)-(e.dw.val(t)>1?e.dw.val(t)-2:6)))},end:function(t){return t.wyEnd||(t.wyEnd=e.date.prev(e.Y.val(t),e.M.val(t),e.D.val(t)+(e.dw.val(t)>1?8-e.dw.val(t):0)))},next:function(t,n){n=n>e.wy.extent(t)[1]?1:n;var r=e.dw.next(e.wy.start(t),5),i=e.date.nextRollover(r,n,e.wy,e.Y);1!==e.wy.val(i)&&(i=e.dw.next(i,2));var o=e.wy.extent(i)[1],a=e.wy.start(i);return n=n>o?1:n||o,e.date.next(e.Y.val(a),e.M.val(a),e.D.val(a)+7*(n-1))},prev:function(t,n){var r=e.dw.next(e.wy.start(t),5),i=e.date.prevRollover(r,n,e.wy,e.Y);1!==e.wy.val(i)&&(i=e.dw.next(i,2));var o=e.wy.extent(i)[1],a=e.wy.end(i);return n=n>o?o:n||o,e.wy.end(e.date.next(e.Y.val(a),e.M.val(a),e.D.val(a)+7*(n-1)))}},e.year=e.Y={name:"year",range:31556900,val:function(t){return t.Y||(t.Y=e.date.getYear.call(t))},isValid:function(t,n){return e.Y.val(t)===n},extent:function(){return[1970,2099]},start:function(t){return t.YStart||(t.YStart=e.date.next(e.Y.val(t)))},end:function(t){return t.YEnd||(t.YEnd=e.date.prev(e.Y.val(t)))},next:function(t,n){return n>e.Y.val(t)&&n<=e.Y.extent()[1]?e.date.next(n):e.NEVER},prev:function(t,n){return n<e.Y.val(t)&&n>=e.Y.extent()[0]?e.date.prev(n):e.NEVER}},e.fullDate=e.fd={name:"full date",range:1,val:function(e){return e.fd||(e.fd=e.getTime())},isValid:function(t,n){return e.fd.val(t)===n},extent:function(){return[0,3250368e7]},start:function(e){return e},end:function(e){return e},next:function(t,n){return e.fd.val(t)<n?new Date(n):e.NEVER},prev:function(t,n){return e.fd.val(t)>n?new Date(n):e.NEVER}},e.modifier={},e.modifier.after=e.modifier.a=function(e,t){var n=t[0];return{name:"after "+e.name,range:(e.extent(new Date)[1]-n)*e.range,val:e.val,isValid:function(e,t){return this.val(e)>=n},extent:e.extent,start:e.start,end:e.end,next:function(t,r){return r!=n&&(r=e.extent(t)[0]),e.next(t,r)},prev:function(t,r){return r=r===n?e.extent(t)[1]:n-1,e.prev(t,r)}}},e.modifier.before=e.modifier.b=function(e,t){var n=t[t.length-1];return{name:"before "+e.name,range:e.range*(n-1),val:e.val,isValid:function(e,t){return this.val(e)<n},extent:e.extent,start:e.start,end:e.end,next:function(t,r){return r=r===n?e.extent(t)[0]:n,e.next(t,r)},prev:function(t,r){return r=r===n?n-1:e.extent(t)[1],e.prev(t,r)}}},e.compile=function(t){var n,r=[],i=0;for(var o in t){var a=o.split("_"),s=a[0],u=a[1],c=t[o],l=u?e.modifier[u](e[s],c):e[s];r.push({constraint:l,vals:c}),i++}return r.sort((function(e,t){var n=e.constraint.range,r=t.constraint.range;return r<n?-1:r>n?1:0})),n=r[i-1].constraint,{start:function(t,o){for(var a,s=o,u=e.array[t],c=1e3;c--&&!a&&s;){a=!0;for(var l=0;l<i;l++){var f=r[l].constraint,d=f.val(s),h=f.extent(s),v=u(d,r[l].vals,h);if(!f.isValid(s,v)){s=f[t](s,v),a=!1;break}}}return s!==e.NEVER&&(s="next"===t?n.start(s):n.end(s)),s},end:function(t,n){for(var o,a=e.array[t+"Invalid"],s=function(e){return"next"===e?function(e,t){return e.getTime()>t.getTime()}:function(e,t){return t.getTime()>e.getTime()}}(t),u=i-1;u>=0;u--){var c,l=r[u].constraint,f=l.val(n),d=l.extent(n),h=a(f,r[u].vals,d);void 0!==h&&(!(c=l[t](n,h))||o&&!s(o,c)||(o=c))}return o},tick:function(t,r){return new Date("next"===t?n.end(r).getTime()+e.SEC:n.start(r).getTime()-e.SEC)},tickStart:function(e){return n.start(e)}}},e.schedule=function(t){if(!t)throw new Error("Missing schedule definition.");if(!t.schedules)throw new Error("Definition must include at least one schedule.");for(var n=[],r=t.schedules.length,i=[],o=t.exceptions?t.exceptions.length:0,a=0;a<r;a++)n.push(e.compile(t.schedules[a]));for(var s=0;s<o;s++)i.push(e.compile(t.exceptions[s]));function u(t,r,a,s,u){var k,b,w,C=y(t),S=r,D=1e3,R=[],x=[],E=[],T="next"===t,M=T?0:1,A=T?1:0;if(!(a=a?new Date(a):new Date)||!a.getTime())throw new Error("Invalid start date.");for(!function(e,t,n,r){for(var i=0,o=t.length;i<o;i++)n[i]=t[i].start(e,r)}(t,n,R,a),function(t,n,r,i){y(t);for(var o=0,a=n.length;o<a;o++){var s=n[o].start(t,i);r[o]=s?[s,n[o].end(t,s)]:e.NEVER}}(t,i,x,a);D--&&S&&(k=m(R,C))&&(!s||!C(k,s));)if(o&&(f(t,i,x,k),b=v(t,x,k)))l(t,n,R,b);else{if(u){var P=p(x,C);b=g(t,n,R,k,P);var I=T?[new Date(Math.max(a,k)),b?new Date(s?Math.min(b,s):b):void 0]:[b?new Date(s?Math.max(s,b.getTime()+e.SEC):b.getTime()+e.SEC):void 0,new Date(Math.min(a,k.getTime()+e.SEC))];if(w&&I[M].getTime()===w[A].getTime()?(w[A]=I[A],S++):(w=I,E.push(w)),!b)break;l(t,n,R,b)}else E.push(T?new Date(Math.max(a,k)):h(n,R,k,s)),d(t,n,R,k);S--}for(var O=0,F=E.length;O<F;O++){var L=E[O];E[O]="[object Array]"===Object.prototype.toString.call(L)?[c(L[0]),c(L[1])]:c(L)}return 0===E.length?e.NEVER:1===r?E[0]:E}function c(e){if(e instanceof Date&&!isNaN(e.valueOf()))return new Date(e)}function l(e,t,n,r){for(var i=y(e),o=0,a=t.length;o<a;o++)n[o]&&!i(n[o],r)&&(n[o]=t[o].start(e,r))}function f(t,n,r,i){for(var o=y(t),a=0,s=n.length;a<s;a++)if(r[a]&&!o(r[a][0],i)){var u=n[a].start(t,i);r[a]=u?[u,n[a].end(t,u)]:e.NEVER}}function d(e,t,n,r){for(var i=0,o=t.length;i<o;i++)n[i]&&n[i].getTime()===r.getTime()&&(n[i]=t[i].start(e,t[i].tick(e,r)))}function h(e,t,n,r){for(var i,o=0,a=t.length;o<a;o++)if(t[o]&&t[o].getTime()===n.getTime()){var s=e[o].tickStart(n);if(r&&s<r)return r;(!i||s>i)&&(i=s)}return i}function v(e,t,n){for(var r,i=y(e),o=0,a=t.length;o<a;o++){var s=t[o];!s||i(s[0],n)||s[1]&&!i(s[1],n)||r&&!i(s[1],r)||(r=s[1])}return r}function p(e,t){for(var n,r=0,i=e.length;r<i;r++)!e[r]||n&&!t(n,e[r][0])||(n=e[r][0]);return n}function g(e,t,n,r,i){for(var o,a=y(e),s=0,u=t.length;s<u;s++){var c=n[s];if(c&&c.getTime()===r.getTime()){var l=t[s].end(e,c);if(i&&(!l||a(l,i)))return i;o&&!a(l,o)||(o=l)}}return o}function y(e){return"next"===e?function(e,t){return!t||e.getTime()>t.getTime()}:function(e,t){return!e||t.getTime()>e.getTime()}}function m(e,t){for(var n=e[0],r=1,i=e.length;r<i;r++)e[r]&&t(n,e[r])&&(n=e[r]);return n}return{isValid:function(t){return u("next",1,t,t)!==e.NEVER},next:function(e,t,n){return u("next",e||1,t,n)},prev:function(e,t,n){return u("prev",e||1,t,n)},nextRange:function(e,t,n){return u("next",e||1,t,n,!0)},prevRange:function(e,t,n){return u("prev",e||1,t,n,!0)}}},e.setTimeout=function(t,n){var r,i=e.schedule(n);return t&&function e(){var n=Date.now(),o=i.next(2,n);if(!o[0])return void(r=void 0);var a=o[0].getTime()-n;a<1e3&&(a=o[1]?o[1].getTime()-n:1e3);r=a<2147483647?setTimeout(t,a):setTimeout(e,2147483647)}(),{isDone:function(){return!r},clear:function(){clearTimeout(r)}}},e.setInterval=function(t,n){if(t){var r=e.setTimeout((function o(){i||(t(),r=e.setTimeout(o,n))}),n),i=r.isDone();return{isDone:function(){return r.isDone()},clear:function(){i=!0,r.clear()}}}},e.date={},e.date.timezone=function(t){e.date.build=t?function(e,t,n,r,i,o){return new Date(e,t,n,r,i,o)}:function(e,t,n,r,i,o){return new Date(Date.UTC(e,t,n,r,i,o))};var n=t?"get":"getUTC",r=Date.prototype;e.date.getYear=r[n+"FullYear"],e.date.getMonth=r[n+"Month"],e.date.getDate=r[n+"Date"],e.date.getDay=r[n+"Day"],e.date.getHour=r[n+"Hours"],e.date.getMin=r[n+"Minutes"],e.date.getSec=r[n+"Seconds"],e.date.isUTC=!t},e.date.UTC=function(){e.date.timezone(!1)},e.date.localTime=function(){e.date.timezone(!0)},e.date.UTC(),e.SEC=1e3,e.MIN=60*e.SEC,e.HOUR=60*e.MIN,e.DAY=24*e.HOUR,e.WEEK=7*e.DAY,e.DAYS_IN_MONTH=[31,28,31,30,31,30,31,31,30,31,30,31],e.NEVER=0,e.date.next=function(t,n,r,i,o,a){return e.date.build(t,void 0!==n?n-1:0,void 0!==r?r:1,i||0,o||0,a||0)},e.date.nextRollover=function(t,n,r,i){var o=r.val(t),a=r.extent(t)[1];return(n||a)<=o||n>a?new Date(i.end(t).getTime()+e.SEC):i.start(t)},e.date.prev=function(t,n,r,i,o,a){var s=arguments.length;return n=s<2?11:n-1,r=s<3?e.D.extent(e.date.next(t,n+1))[1]:r,i=s<4?23:i,o=s<5?59:o,a=s<6?59:a,e.date.build(t,n,r,i,o,a)},e.date.prevRollover=function(e,t,n,r){return t>=n.val(e)||!t?r.start(r.prev(e,r.val(e)-1)):r.start(e)},e.parse={},e.parse.cron=function(e,t){var n={JAN:1,FEB:2,MAR:3,APR:4,MAY:5,JUN:6,JUL:7,AUG:8,SEP:9,OCT:10,NOV:11,DEC:12,SUN:1,MON:2,TUE:3,WED:4,THU:5,FRI:6,SAT:7},r={"* * * * * *":"0/1 * * * * *","@YEARLY":"0 0 1 1 *","@ANNUALLY":"0 0 1 1 *","@MONTHLY":"0 0 1 * *","@WEEKLY":"0 0 * * 0","@DAILY":"0 0 * * *","@HOURLY":"0 * * * *"},i={s:[0,0,59],m:[1,0,59],h:[2,0,23],D:[3,1,31],M:[4,1,12],Y:[6,1970,2099],d:[5,1,7,1]};function o(e,t,r){return isNaN(e)?n[e]||null:Math.min(+e+(t||0),r||9999)}function a(e,t,n,r,i){var o=n;for(e[t]||(e[t]=[]);o<=r;)e[t].indexOf(o)<0&&e[t].push(o),o+=i||1;e[t].sort((function(e,t){return e-t}))}function s(e,t,n,r){(t.d&&!t.dc||t.dc&&t.dc.indexOf(r)<0)&&(e.push(function(e){var t,n={};for(t in e)"dc"!==t&&"d"!==t&&(n[t]=e[t].slice(0));return n}(t)),t=e[e.length-1]),a(t,"d",n,n),a(t,"dc",r,r)}function u(e,t,r,i,u,c){var l,f,d=t.schedules,h=d[d.length-1];"L"===e&&(e=i-1),null!==(l=o(e,c,u))?a(h,r,l,l):null!==(l=o(e.replace("W",""),c,u))?function(e,t,r){var i={},o={};1===r?(a(t,"D",1,3),a(t,"d",n.MON,n.FRI),a(i,"D",2,2),a(i,"d",n.TUE,n.FRI),a(o,"D",3,3),a(o,"d",n.TUE,n.FRI)):(a(t,"D",r-1,r+1),a(t,"d",n.MON,n.FRI),a(i,"D",r-1,r-1),a(i,"d",n.MON,n.THU),a(o,"D",r+1,r+1),a(o,"d",n.TUE,n.FRI)),e.exceptions.push(i),e.exceptions.push(o)}(t,h,l):null!==(l=o(e.replace("L",""),c,u))?s(d,h,l,i-1):2===(f=e.split("#")).length?s(d,h,l=o(f[0],c,u),o(f[1])):function(e,t,n,r,i,s){var u=e.split("/"),c=+u[1],l=u[0];if("*"!==l&&"0"!==l){var f=l.split("-");r=o(f[0],s,i),i=o(f[1],s,i)||i}a(t,n,r,i,c)}(e,h,r,i,u,c)}function c(e){return e.indexOf("#")>-1||e.indexOf("L")>0}function l(e,t){return c(e)&&!c(t)?1:e-t}var f=function(e){var t=e.toUpperCase();return r[t]||t}(e);return function(e){var t,n,r,o,a={schedules:[{}],exceptions:[]},s=e.replace(/(\s)+/g," ").split(" ");for(t in i)if((r=s[(n=i[t])[0]])&&"*"!==r&&"?"!==r){var c,f=(o=r.split(",").sort(l)).length;for(c=0;c<f;c++)u(o[c],a,t,n[1],n[2],n[3])}return a}(t?f:"0 "+f)},e.parse.recur=function(){var t,n,r,i,o,a,s,u,c,l=[],f=[],d=l;function h(e,l,f){if(e=o?e+"_"+o:e,t||(d.push({}),t=d[0]),t[e]||(t[e]=[]),n=t[e],i){for(r=[],u=l;u<=f;u+=i)r.push(u);c={n:e,x:i,c:n.length,m:f}}var h=(r=a?[l]:s?[f]:r).length;for(u=0;u<h;u+=1){var v=r[u];n.indexOf(v)<0&&n.push(v)}r=i=o=a=s=0}return{schedules:l,exceptions:f,on:function(){return r=arguments[0]instanceof Array?arguments[0]:arguments,this},every:function(e){return i=e||1,this},after:function(e){return o="a",r=[e],this},before:function(e){return o="b",r=[e],this},first:function(){return a=1,this},last:function(){return s=1,this},time:function(){for(var e=0,t=r.length;e<t;e++){var n=r[e].split(":");n.length<3&&n.push(0),r[e]=3600*+n[0]+60*+n[1]+ +n[2]}return h("t"),this},second:function(){return h("s",0,59),this},minute:function(){return h("m",0,59),this},hour:function(){return h("h",0,23),this},dayOfMonth:function(){return h("D",1,s?0:31),this},dayOfWeek:function(){return h("d",1,7),this},onWeekend:function(){return r=[1,7],this.dayOfWeek()},onWeekday:function(){return r=[2,3,4,5,6],this.dayOfWeek()},dayOfWeekCount:function(){return h("dc",1,s?0:5),this},dayOfYear:function(){return h("dy",1,s?0:366),this},weekOfMonth:function(){return h("wm",1,s?0:5),this},weekOfYear:function(){return h("wy",1,s?0:53),this},month:function(){return h("M",1,12),this},year:function(){return h("Y",1970,2450),this},fullDate:function(){for(var e=0,t=r.length;e<t;e++)r[e]=r[e].getTime();return h("fd"),this},customModifier:function(t,n){var i=e.modifier[t];if(!i)throw new Error("Custom modifier "+t+" not recognized!");return o=t,r=arguments[1]instanceof Array?arguments[1]:[arguments[1]],this},customPeriod:function(t){var n=e[t];if(!n)throw new Error("Custom time period "+t+" not recognized!");return h(t,n.extent(new Date)[0],n.extent(new Date)[1]),this},startingOn:function(e){return this.between(e,c.m)},between:function(e,n){return t[c.n]=t[c.n].splice(0,c.c),i=c.x,h(c.n,e,n),this},and:function(){return t=d[d.push({})-1],this},except:function(){return d=f,t=null,this}}},e.parse.text=function(t){var n,r=e.parse.recur,i=0,o="",a={eof:/^$/,rank:/^((\d\d\d\d)|([2-5]?1(st)?|[2-5]?2(nd)?|[2-5]?3(rd)?|(0|[1-5]?[4-9]|[1-5]0|1[1-3])(th)?))\b/,time:/^((([0]?[1-9]|1[0-2]):[0-5]\d(\s)?(am|pm))|(([0]?\d|1\d|2[0-3]):[0-5]\d))\b/,dayName:/^((sun|mon|tue(s)?|wed(nes)?|thu(r(s)?)?|fri|sat(ur)?)(day)?)\b/,monthName:/^(jan(uary)?|feb(ruary)?|ma((r(ch)?)?|y)|apr(il)?|ju(ly|ne)|aug(ust)?|oct(ober)?|(sept|nov|dec)(ember)?)\b/,yearIndex:/^(\d\d\d\d)\b/,every:/^every\b/,after:/^after\b/,before:/^before\b/,second:/^(s|sec(ond)?(s)?)\b/,minute:/^(m|min(ute)?(s)?)\b/,hour:/^(h|hour(s)?)\b/,day:/^(day(s)?( of the month)?)\b/,dayInstance:/^day instance\b/,dayOfWeek:/^day(s)? of the week\b/,dayOfYear:/^day(s)? of the year\b/,weekOfYear:/^week(s)?( of the year)?\b/,weekOfMonth:/^week(s)? of the month\b/,weekday:/^weekday\b/,weekend:/^weekend\b/,month:/^month(s)?\b/,year:/^year(s)?\b/,between:/^between (the)?\b/,start:/^(start(ing)? (at|on( the)?)?)\b/,at:/^(at|@)\b/,and:/^(,|and\b)/,except:/^(except\b)/,also:/(also)\b/,first:/^(first)\b/,last:/^last\b/,in:/^in\b/,of:/^of\b/,onthe:/^on the\b/,on:/^on\b/,through:/(-|^(to|through)\b)/},s={jan:1,feb:2,mar:3,apr:4,may:5,jun:6,jul:7,aug:8,sep:9,oct:10,nov:11,dec:12,sun:1,mon:2,tue:3,wed:4,thu:5,fri:6,sat:7,"1st":1,fir:1,"2nd":2,sec:2,"3rd":3,thi:3,"4th":4,for:4};function u(e,t,n,r){return{startPos:e,endPos:t,text:n,type:r}}function c(e){var t,n,r,a,s,c,l=e instanceof Array?e:[e],f=/\s+/;for(l.push(f),s=i;!t||t.type===f;){c=-1,n=o.substring(s),t=u(s,s,o.split(f)[0]);var d,h=l.length;for(d=0;d<h;d++)(r=(a=l[d]).exec(n))&&0===r.index&&r[0].length>c&&(t=u(s,s+(c=r[0].length),n.substring(0,c),a));t.type===f&&(s=t.endPos)}return t}function l(e){var t=c(e);return i=t.endPos,t}function f(e){for(var t=+m(e),n=g(a.through)?+m(e):t,r=[],i=t;i<=n;i++)r.push(i);return r}function d(e){for(var t=f(e);g(a.and);)t=t.concat(f(e));return t}function h(e){var t,n,r,i;g(a.weekend)?e.on(s.sun,s.sat).dayOfWeek():g(a.weekday)?e.on(s.mon,s.tue,s.wed,s.thu,s.fri).dayOfWeek():(t=m(a.rank),e.every(t),n=p(e),g(a.start)?(t=m(a.rank),e.startingOn(t),y(n.type)):g(a.between)&&(r=m(a.rank),g(a.and)&&(i=m(a.rank),e.between(r,i))))}function v(e){g(a.first)?e.first():g(a.last)?e.last():e.on(d(a.rank)),p(e)}function p(e){var t=y([a.second,a.minute,a.hour,a.dayOfYear,a.dayOfWeek,a.dayInstance,a.day,a.month,a.year,a.weekOfMonth,a.weekOfYear]);switch(t.type){case a.second:e.second();break;case a.minute:e.minute();break;case a.hour:e.hour();break;case a.dayOfYear:e.dayOfYear();break;case a.dayOfWeek:e.dayOfWeek();break;case a.dayInstance:e.dayOfWeekCount();break;case a.day:e.dayOfMonth();break;case a.weekOfMonth:e.weekOfMonth();break;case a.weekOfYear:e.weekOfYear();break;case a.month:e.month();break;case a.year:e.year();break;default:n=i}return t}function g(e){var t=c(e).type===e;return t&&l(e),t}function y(e){var t=l(e);return t.type?t.text=function(e,t){var n=e;switch(t){case a.time:var r=e.split(/(:|am|pm)/),i="pm"===r[3]&&r[0]<12?parseInt(r[0],10)+12:r[0],o=r[2].trim();n=(1===i.length?"0":"")+i+":"+o;break;case a.rank:n=parseInt(/^\d+/.exec(e)[0],10);break;case a.monthName:case a.dayName:n=s[e.substring(0,3)]}return n}(t.text,e):n=i,t}function m(e){return y(e).text}return function(e){i=0,o=e,n=-1;for(var t=r();i<o.length&&n<0;){switch(y([a.every,a.after,a.before,a.onthe,a.on,a.of,a.in,a.at,a.and,a.except,a.also]).type){case a.every:h(t);break;case a.after:void 0!==c(a.time).type?(t.after(m(a.time)),t.time()):(t.after(m(a.rank)),p(t));break;case a.before:void 0!==c(a.time).type?(t.before(m(a.time)),t.time()):(t.before(m(a.rank)),p(t));break;case a.onthe:v(t);break;case a.on:t.on(d(a.dayName)).dayOfWeek();break;case a.of:t.on(d(a.monthName)).month();break;case a.in:t.on(d(a.yearIndex)).year();break;case a.at:for(t.on(m(a.time)).time();g(a.and);)t.on(m(a.time)).time();break;case a.and:break;case a.also:t.and();break;case a.except:t.except();break;default:n=i}}return{schedules:t.schedules,exceptions:t.exceptions,error:n}}(t.toLowerCase())},e}();r.date.localTime();var i,o,a,s,u=r,c=n(10),l=n.n(c),f=n(9),d=n.n(f),h=n(1),v=n.n(h),p=n(3),g=n.n(p),y=n(14),m=/([a-z])([A-Z])/g,k=/[.*+?^${}()|[\]\\]/g,b=/(^[^a-z]+|[^\w]+)/gi,w=/\s+/,C=function(e,t){return o[t.toLowerCase()]||String.fromCharCode(parseInt(t.substr(2),10))},S=function(e,t){return i[t]},D=function(e,t,n){return t+"-"+n.toLowerCase()},R=function(e){return e?"_x".concat(e.charCodeAt(0).toString(16)):"__blank__"},x={},E=function(){function e(){v()(this,e)}return g()(e,null,[{key:"capitalize",value:function(e){return e&&e[0].toUpperCase()+e.substr(1)}},{key:"capitalizeFirstLetter",value:function(e){return y.a.deprecate("Core","5.0.0","Deprecated in favor of `capitalize()`, will be removed in 5.0"),e?e[0].toUpperCase()+e.substr(1):null}},{key:"decodeHtml",value:function(e){return e?String(e).replace(s,C):e}},{key:"encodeHtml",value:function(e){return e?String(e).replace(a,S):e}},{key:"lowercaseFirstLetter",value:function(e){return y.a.deprecate("Core","5.0.0","Deprecated in favor of `uncapitalize()`, will be removed in 5.0"),e?e[0].toLowerCase()+e.substr(1):null}},{key:"uncapitalize",value:function(e){return e&&e[0].toLowerCase()+e.substr(1)}},{key:"hyphenate",value:function(e){var t=x[e];return t||(x[e]=e.replace(m,D))}},{key:"initHtmlEntities",value:function(e){e=e||{"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#39;"};var t=Object.keys(e);i=e,o=t.reduce((function(t,n){return t[e[n]]=n,t}),{}),a=new RegExp("([".concat(t.map((function(e){return"[-]".includes(e)?"\\"+e:e})).join(""),"])"),"g"),s=new RegExp("(".concat(Object.values(e).join("|"),"|&#[0-9]+;)"),"ig")}},{key:"safeJsonParse",value:function(e){var t=null;try{t=JSON.parse(e)}catch(e){}return t}},{key:"safeJsonStringify",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=null;try{r=JSON.stringify(e,t,n)}catch(e){}return r}},{key:"createId",value:function(e){return String(e).replace(b,R)}},{key:"escapeRegExp",value:function(e,t){var n=e.replace(k,"\\$&");return void 0!==t&&(n=new RegExp(n,t)),n}},{key:"joinPaths",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"/";return e.join(t).replace(new RegExp("\\"+t+"+","g"),t)}},{key:"split",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:w,n=e;return"string"==typeof n&&(n=(n=e.trim())?n.split(t):[]),n}},{key:"xss",value:function(t){for(var n=[],r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];var a=i.length;for(n[a]=t[a];a-- >0;)n[a]=t[a]+e.encodeHtml(i[a]);return n.join("")}}]),e}();function T(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return M(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return M(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function M(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}E.initHtmlEntities(),E._$name="StringHelper";var A=Object.prototype.toString,P=Object.isFrozen,I=/\[object ([^\]]+)]/,O={},F=function(){function e(){v()(this,e)}return g()(e,null,[{key:"assign",value:function(e){for(var t,n,r=0;r<(arguments.length<=1?0:arguments.length-1);r++)if(t=r+1<1||arguments.length<=r+1?void 0:arguments[r+1])for(n in t)e[n]=t[n];return e}},{key:"assignIf",value:function(e){for(var t,n,r=0;r<(arguments.length<=1?0:arguments.length-1);r++)if(t=r+1<1||arguments.length<=r+1?void 0:arguments[r+1])for(n in t)n in e&&void 0!==e[n]||(e[n]=t[n]);return e}},{key:"clone",value:function(e,t){var n,r=e;if(e&&"object"===l()(e))if(L.isObject(e))for(n in r={},e)r[n]=L.clone(e[n]);else if(Array.isArray(e))for(r=[],n=e.length;n-- >0;)r[n]=L.clone(e[n]);else L.isDate(e)?r=new Date(e.getTime()):t&&(r=t(e));return r}},{key:"createTruthyKeys",value:function(e){var t=E.split(e),n=t&&{};if(t){var r,i=T(t);try{for(i.s();!(r=i.n()).done;){var o=r.value;o&&(n[o]=!0)}}catch(e){i.e(e)}finally{i.f()}}return n}},{key:"getPath",value:function(e,t){return t.split(".").reduce((function(e,t){return(e||{})[t]}),e)}},{key:"hasPath",value:function(e,t){return t.split(".").every((function(t){return t in e&&(e=e[t],!0)}))}},{key:"getTruthyKeys",value:function(e){for(var t=Object.keys(e),n=t.length;n-- >0;)e[t[n]]||t.splice(n,1);return t}},{key:"getTruthyValues",value:function(e){for(var t=Object.keys(e),n=t.length;n-- >0;)e[t[n]]?t[n]=e[t[n]]:t.splice(n,1);return t}},{key:"isClass",value:function(e){var t;return"function"==typeof e&&(null===(t=e.prototype)||void 0===t?void 0:t.constructor)===e}},{key:"isDate",value:function(e){return Boolean(e&&e.getUTCDate)&&"date"===L.typeOf(e)}},{key:"isPromise",value:function(e){if(Promise&&Promise.resolve)return Promise.resolve(e)===e;throw new Error("Promise not supported in your environment")}},{key:"isEmpty",value:function(e){if(e&&"object"===l()(e))for(var t in e)return!1;return!0}},{key:"isObject",value:function(e){var t=e&&e.constructor;return Boolean(t?t===Object||t.getPrototypeOf&&t.prototype&&!Object.getPrototypeOf(t.prototype):e&&"object"===l()(e))}},{key:"merge",value:function(e){for(var t,n,r,i,o=0;o<(arguments.length<=1?0:arguments.length-1);o++)if(n=o+1<1||arguments.length<=o+1?void 0:arguments[o+1])for(r in n)(i=n[r])&&L.isObject(i)?(t=e[r])&&L.isObject(t)?(P(t)&&(e[r]=t=L.clone(t)),L.merge(t,i)):e[r]=P(i)?i:L.clone(i):e[r]=i;return e}},{key:"setPath",value:function(e,t,n){return t.split(".").reduce((function(e,t,r,i){return r===i.length-1?e[t]=n:(e[t]instanceof Object||(e[t]={}),e[t])}),e),e}},{key:"typeOf",value:function(e){var t,n,r=l()(e);return"object"===r?null===e?r="null":(n=A.call(e),(r=O[n])||(t=I.exec(n),O[n]=r=t?t[1].toLowerCase():n)):e!=e&&(r="nan"),r}}]),e}(),L=F;F._$name="Objects";var j=n(11),_=Reflect.defineProperty,B=Reflect.getOwnPropertyDescriptor,H=Object.prototype,$=H.hasOwnProperty,N=H.toString,V=Symbol("instanceProperties"),z=Symbol("configuring"),W=Symbol("lazyConfigValues"),G=N.call(new Date),Y=function(){function e(t){v()(this,e);var n=this,r=t[0].toUpperCase()+t.substr(1);n.base=n,n.name=t,n.field="_"+t,n.capName=r,n.changer="change"+r,n.initializing="initializing"+r,n.updater="update"+r}return g()(e,null,[{key:"get",value:function(t,n){var r,i=this.cache,o=i[t]||(i[t]=new e(t)),a=o;return n&&((a=(r=e.makeCacheKey(t,n))&&i[r])||(a=o.extend(n),r&&(i[r]=a))),a}}]),g()(e,[{key:"equal",value:function(e,t){return e===t}},{key:"extend",value:function(t){var n=Object.assign(Object.create(this),t),r=t.equal,i=t.merge,o=e.equalityMethods;return"string"==typeof r&&(r.endsWith("[]")?n.equal=e.makeArrayEquals(o[r.substr(0,r.length-2)]):n.equal=o[r]),"string"==typeof i&&(n.merge=e.mergeMethods[i]),n}},{key:"define",value:function(e){var t=B(e,this.name),n=this.descriptor;t&&t.get&&((n=Object.assign({},n)).get=t.get),_(e,this.name,n)}},{key:"defineInitter",value:function(e,t){var n,r,i=this.name,o=e[V];o[i]||!(r=B(e,i))||"value"in r||(o[i]=r),_(e,i,this.initDescriptor),this.lazy&&((n=e[W]||(e[W]={$counter_:0}))[i]=t,++n.$counter_)}},{key:"makeDescriptor",value:function(){var e=this,t=e.base,n=e.field,r=e.changer,i=e.updater,o=e.name;return t!==e&&t.equal===e.equal?t.descriptor:{get:function(){return this[n]},set:function(t){var a=this,s=a[n];if("string"==typeof t&&t.startsWith("up.")){var u=a.resolveProperty(t.substr(3));"function"!=typeof u&&(t=u)}if(a[r]){if(void 0===(t=a[r](t,s)))return;s=a[n]}(e.equal===q?s===t:e.equal(s,t))||(a[n]=t,a[i]&&a[i](t,s),a.onConfigChange.$nullFn||a.onConfigChange({name:o,value:t,was:s,config:e}))}}}},{key:"makeInitter",value:function(){return this!==this.base?this.lazy?this.makeLazyInitter():this.base.initDescriptor:this.makeBasicInitter()}},{key:"makeBasicInitter",value:function(){var e=this,t=e.initializing,n=e.name;return{configurable:!0,get:function(){var r=this;return e.removeInitter(r),r[t]=!0,r[n]=r[z][n],r[t]=!1,r.configDone[n]=!0,r[n]},set:function(t){e.removeInitter(this),this.configDone[n]=!0,this[n]=t}}}},{key:"makeLazyInitter",value:function(){var e=this,t=e.initializing,n=e.name;return{configurable:!0,get:function(){var r=this,i=r[W][n];return e.removeInitter(r),r[t]=!0,r[n]=i,r[t]=!1,r[n]},set:function(t){e.removeInitter(this),this[n]=t}}}},{key:"removeInitter",value:function(e){var t=this.name,n=e[V][t];n?_(e,t,n):delete e[t],this.lazy&&(--e[W].$counter_||delete e[W])}},{key:"merge",value:function(e,t){return t&&e&&F.isObject(t)&&F.isObject(e)&&(e=F.merge(F.clone(t),e)),e}},{key:"descriptor",get:function(){var e=this._descriptor;return e&&$.call(this,"_descriptor")||(this._descriptor=e=this.makeDescriptor()),e}},{key:"initDescriptor",get:function(){var e=this._initDescriptor;return e&&$.call(this,"_initDescriptor")||(this._initDescriptor=e=this.makeInitter()),e}}],[{key:"makeArrayEquals",value:function(e){return function(t,n){var r,i=t&&n&&t.length===(r=n.length);if(i&&Array.isArray(t)&&Array.isArray(n))if(e)for(;i&&r-- >0;)i=e(t[r],n[r]);else for(;i&&r-- >0;)i=t[r]===n[r];else i=e?e(t,n):t===n;return i}}},{key:"makeCacheKey",value:function(e,t){for(var n,r,i,o=Object.keys(t).sort(),a=o.length;a-- >0;)if(null==(i=t[n=o[a]])&&!1===i)o.splice(a,1);else{if("function"===(r=l()(i)))return null;"string"===r?o[a]="".concat(n,':"').concat(i,'"'):"number"===r&&(o[a]="".concat(n,":").concat(i))}return o.length?"".concat(e,">").concat(o.join("|")):e}}]),e}(),U=Y.prototype,q=U.equal;Y.symbols={configuring:z,instanceProperties:V},Y.cache=Object.create(null),Y.equalityMethods={array:Y.makeArrayEquals(),date:function(e,t){return e===t||!(!e||!t||N.call(e)!==G||N.call(t)!==G)&&e.getTime()===t.getTime()},strict:Y.equal=q},Y.mergeMethods={distinct:function(e,t){var n=t?t.slice():[];return null!=e&&(Array.isArray(e)?e:[e]).forEach((function(e){return!n.includes(e)&&n.push(e)})),n},merge:Y.merge=U.merge,objects:function(e,t){return!0===e?t||{}:Y.merge(e,t)},replace:function(e){return e}},Object.assign(U,{_descriptor:null,_initDescriptor:null,lazy:!1,nullify:!1,render:!1}),Y._$name="Config";var K=function(){function e(t){v()(this,e),t&&Object.assign(this,t)}return g()(e,[{key:"getInherited",value:function(e){var t;return this[e]||(this[e]=Object.create((null===(t=this.super)||void 0===t?void 0:t.getInherited(e))||null))}}]),e}(),X=Object.getPrototypeOf,Z=Reflect.defineProperty,J=Object.prototype.hasOwnProperty,Q=Symbol("classMetaData"),ee=Symbol("mixinTag"),te=Symbol("originalConfig"),ne=(Symbol("createdAt"),Y.symbols.configuring),re=Y.symbols.instanceProperties,ie={merge:"replace",simple:!0},oe=function(){},ae=function(e){return new K(e)},se={},ue=function(){function e(){v()(this,e);var t=this,n=t.constructor;t.$meta.class!==n&&n.$meta,t.construct.apply(t,arguments),t.afterConstruct()}return g()(e,[{key:"isBase",get:function(){return!0}}],[{key:"isBase",get:function(){return!0}},{key:"declarable",get:function(){return["declarable","configurable","defaultConfig","properties","prototypeProperties"]}}]),g()(e,[{key:"construct",value:function(){null!==(arguments.length<=0?void 0:arguments[0])&&this.configure.apply(this,arguments),this.afterConfigure()}},{key:"destroy",value:function(){var e=this;for(var t in e.isDestroying=!0,e.destroy=oe,e.doDestroy(),Object.setPrototypeOf(e,null),e)"destroy"!==t&&"isDestroying"!==t&&delete e[t];delete e[te],e.isDestroyed=!0}},{key:"_thisIsAUsedExpression",value:function(e){}},{key:"startConfigure",value:function(e){}},{key:"finishConfigure",value:function(e){}},{key:"afterConfigure",value:function(){}},{key:"afterConstruct",value:function(){}},{key:"callback",value:function(e,t,n){"this"===t&&(t=this);var r=this.resolveCallback(e,t),i=r.handler,o=r.thisObj;return n?i.apply(o,n):i.call(o)}},{key:"resolveProperty",value:function(e){for(var t=this;t;){if(F.hasPath(t,e))return F.getPath(t,e);t=t.owner}}},{key:"resolveCallback",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;if(e.substr){if(e.startsWith("up.")){for(e=e.substr(3),t=this.owner;t&&!t[e];t=t.owner);if(!t)return}else e.startsWith("this.")&&(e=e.substr(5),t=this);if(!(t&&t instanceof Object))return;if("function"!=typeof t[e])return;e=t[e]}return{handler:e,thisObj:t}}},{key:"bindCallback",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;if(e){var n=this.resolveCallback(e,t),r=n.handler,i=n.thisObj;if(r)return r.bind(i)}}},{key:"delay",value:function(e,t){e=this.setTimeout?e:e.bind(this),(this.setTimeout?this:window)["number"==typeof t?"setTimeout":"requestAnimationFrame"](e,t)}},{key:"doDestroy",value:function(){var e=this.$meta.nullify;if(e)for(var t=0;t<e.length;++t)this[e[t].name]=null}},{key:"destroyProperties",value:function(){for(var e,t,n=this,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];for(var a=0,s=i;a<s.length;a++)!((e=s[a])in n)||n[ne]&&n[ne][e]||((t=n[e])&&t.destroy&&t.destroy(),delete n[e])}},{key:"configure",value:function(){var e,t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=this,o=r.beforeConfigure,a=i.$meta.configs,s=i.getDefaultConfiguration();for(t in i.initialConfig=r,i.isConfiguring=!0,Object.assign(i,i.getProperties()),r)n=r[t],e=a[t],s[t]=e?e.merge(n,s[t],null):n;o&&(delete s.beforeConfigure,o(i,s)),i.setConfig(i[te]=s,!0),i.isConfiguring=!1}},{key:"getConfig",value:function(e){return this[e]}},{key:"setConfig",value:function(e,t){var n,r,i=this,o=i[ne],a=o?i.configDone:i.configDone={},s=i.$meta.configs;for(r in i[re]={},i[ne]=o?Object.setPrototypeOf(Object.assign({},e),o):e,e)null!=e[r]||J.call(e,r)?((n=s[r]||Y.get(r)).defineInitter(i,e[r]),t?n.lazy&&(a[r]=!0):a[r]=!1):a[r]=!0;for(r in t&&i.startConfigure(e),e)a[r]||(i[r]=e[r]);return o?i[ne]=o:delete i[ne],t&&i.finishConfigure(e),i}},{key:"triggerConfig",value:function(e){var t=this.configDone,n=this[ne],r=n&&(null!=n[e]||J.call(n,e))?!t[e]:null;return r&&this.getConfig(e),r}},{key:"onConfigChange",value:function(){}},{key:"getDefaultConfiguration",value:function(){return this.constructor.getDefaultConfiguration()}},{key:"getProperties",value:function(){for(var e=this.$meta.properties,t={},n=0;n<e.length;n++)Object.assign(t,e[n].properties);return t}},{key:"classHierarchy",value:function(e){var t=this.$meta.hierarchy,n=e?t.indexOf(e):0;return n>0?t.slice(n):t}},{key:"detachListeners",value:function(e){var t=this.$detachers;if(t=t&&t[e])for(;t.length;)t.pop()()}},{key:"trackDetacher",value:function(e,t){var n=this.$detachers||(this.$detachers={});(n[e]||(n[e]=[])).push(t)}},{key:"untrackDetachers",value:function(e){var t=this.$detachers;if(t)for(var n in t)for(var r=t[n],i=r.length;i-- >0;)r[i].eventer===e&&r.splice(i,1)}},{key:"$$name",get:function(){return this.constructor.$$name}},{key:"config",get:function(){var e={},t=this[te];for(var n in t)e[n]=t[n];return e}}],[{key:"destroy",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];t.forEach((function(e){e&&e.destroy&&!e.isDestroyed&&e.destroy()}))}},{key:"initClass",value:function(){return this.$meta.class}},{key:"onClassMixedIn",value:function(){}},{key:"mergeConfigs",value:function(e){for(var t,n,r,i,o=this.$meta.configs,a=F.clone(e)||{},s=arguments.length,u=new Array(s>1?s-1:0),c=1;c<s;c++)u[c-1]=arguments[c];for(n=0;n<u.length;++n)if(t=u[n])for(r in t)i=t[r],o[r]?i=o[r].merge(i,a[r]):a[r]&&i&&(i=Y.merge(i,a[r])),a[r]=i;return a}},{key:"mixin",value:function(){for(var e,t=this,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];for(e=0;e<r.length;++e){var o=r[e],a=o[ee]||(o[ee]=Symbol("mixinTag"));t[a]||((t=o(t))[a]=!0,J.call(t,"onClassMixedIn")&&t.onClassMixedIn())}return t}},{key:"setupClass",value:function(e){var t,n=e.class,r=X(n).$meta,i=n.$$name,o=r.names,a=n.prototype;if(Z(a,"$meta",{value:e}),Object.assign(e,{super:r,config:Object.create(r.config),configs:Object.create(r.configs),declarables:r.declarables,forkConfigs:r.forkConfigs,hierarchy:Object.freeze([].concat(d()(r.hierarchy),[n])),names:o.includes(i)?o:Object.freeze([].concat(d()(o),[i])),properties:r.properties,nullify:null===(t=r.nullify)||void 0===t?void 0:t.slice()}),o!==e.names){var s="is"+i;J.call(a,s)||Z(a,s,{value:!0}),J.call(n,s)||Z(n,s,{value:!0})}for(var u,c=0;c<e.declarables.length;++c)u=e.declarables[c],J.call(n,u)&&n[se[u]||(se[u]="setup".concat(E.capitalize(u)))](n,e)}},{key:"setupConfigs",value:function(e,t,n){var r,i,o,a,s,u=e.config,c=e.configs,f=e.class.prototype;for(var d in t)a=t[d],n?(r=c[d])?a=r.merge(a,u[d],e):r=Y.get(d,ie):(o=null,a&&"object"===l()(a)&&"$config"in a&&((o=a.$config)&&!F.isObject(o)&&(o=F.createTruthyKeys(o)),"default"in a&&Z(f,Y.get(d).field,{configurable:!0,writable:!0,value:a.default}),a=a.value),(r=c[d])?(s=r.nullify,o&&(r=r.extend(o)),a=r.merge(a,u[d],e)):((r=Y.get(d,o)).define(e.class.prototype),s=!1),r.nullify&&!s&&(i||(e.nullify=i=[])).push(r)),a&&(F.isObject(a)||Array.isArray(a))&&!Object.isFrozen(a)&&(e.forkConfigs=!0),c[d]=r,u[d]=a}},{key:"setupConfigurable",value:function(e,t){e.setupConfigs(t,e.configurable,!1)}},{key:"setupDefaultConfig",value:function(e,t){e.setupConfigs(t,e.defaultConfig,!0)}},{key:"setupDeclarable",value:function(e,t){var n,r,i=e.declarable,o=t.declarables;for(r=0;r<i.length;++r)o.includes(i[r])||(n||(t.declarables=n=o=o.slice()),o.push(i[r]))}},{key:"setupProperties",value:function(e,t){t.properties=t.super.properties.slice(),t.properties.push(e),Object.freeze(t.properties)}},{key:"setupPrototypeProperties",value:function(e){Object.assign(e.prototype,e.prototypeProperties)}},{key:"getDefaultConfiguration",value:function(){var t=this.$meta,n=t.forkConfigs?e.fork(t.config):Object.create(t.config);if(y.a.isTestEnv&&j.a.isBrowserEnv&&n.testConfig&&j.a.global.__applyTestConfigs)for(var r in n.testConfig)n[r]=n.testConfig[r];return n}},{key:"fork",value:function(t){var n,r,i=t;if(t&&F.isObject(t)&&!Object.isFrozen(t))for(n in i=Object.create(t),t)(r=t[n])&&(F.isObject(r)?i[n]=e.fork(r):Array.isArray(r)&&(i[n]=r.slice()));return i}},{key:"isOfTypeName",value:function(e){return this.$meta.names.includes(e)}},{key:"$$name",get:function(){return J.call(this,"$name")&&this.$name||J.call(this,"_$name")&&this._$name||this.name}},{key:"$meta",get:function(){var e=this,t=e[Q];return J.call(e,Q)||(e[Q]=t=ae(),t.class=e,e.setupClass(t)),t}},{key:"superclass",get:function(){return X(this)}}]),e}(),ce=ue.prototype;ce.onConfigChange.$nullFn=!0,ue[Q]=ce.$meta=ae({class:ue,config:Object.freeze({}),configs:Object.create(null),declarables:ue.declarable,forkConfigs:!1,hierarchy:Object.freeze([ue]),names:Object.freeze(["Base"]),nullify:null,properties:Object.freeze([]),super:null}),Object.assign(ce,{$detachers:null,isDestroyed:!1,isDestroying:!1}),y.a.setVersion("core","0.0.0"),ue._$name="Base";var le=n(2),fe=n.n(le),de=n(4),he=n.n(de),ve=n(0),pe=n.n(ve),ge=n(12),ye=n.n(ge),me=n(7),ke=n.n(me),be=n(5),we=n.n(be);function Ce(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Se(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Se(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Se(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var De=function(){function e(){v()(this,e)}return g()(e,[{key:"magnitudeCompare",value:function(e,t){return e<t?-1:e>t?1:0}},{key:"lexicalCompare",value:function(e,t){return(e=String(e))<(t=String(t))?-1:e>t?1:0}}],[{key:"clean",value:function(e){return e.reduce((function(e,t){return null==t||Array.isArray(t)&&0===t.length||""===t||e.push(t),e}),[])}},{key:"remove",value:function(e){for(var t,n,r=!1,i=0;i<(arguments.length<=1?0:arguments.length-1);i++)n=i+1<1||arguments.length<=i+1?void 0:arguments[i+1],-1!==(t=e.indexOf(n))&&(e.splice(t,1),r=!0);return r}},{key:"findInsertionIndex",value:function(e,t){var n,r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.lexicalCompare,o=arguments.length>3?arguments[3]:void 0,a=t.length;return o<a&&(n=o>0?i(t[o-1],e):0,r=o<a-1?i(e,t[o]):0,n<1&&r<1)?o:this.binarySearch(t,e,i)}},{key:"findLast",value:function(e,t,n){for(var r=e.length-1;r>=0;r--)if(t.call(n,e[r],r,e))return e[r]}},{key:"binarySearch",value:function(e,t){var n,r,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:e.length,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.lexicalCompare,s=e.length;for(i instanceof Function?(a=i,i=0):o instanceof Function&&(a=o,o=s),--o;i<=o;)(r=a(t,e[n=i+o>>1]))>=0?i=n+1:r<0&&(o=n-1);return i}},{key:"fill",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=[],i=Array.isArray(t)?t:[t],o=0;o<e;o++){var a,s=Ce(i);try{for(s.s();!(a=s.n()).done;){var u=a.value,c=Object.assign({},u);n&&n(c,o),r.push(c)}}catch(e){s.e(e)}finally{s.f()}}return r}},{key:"populate",value:function(e,t){for(var n=[],r=0;r<e;r++)n.push(t(r));return n}},{key:"include",value:function(e,t){e.includes(t)||e.push(t)}},{key:"unique",value:function(e){return d()(new Set(e))}},{key:"allowNegative",value:function(e){return new Proxy(e,{get:function(e,t,n){if("string"!=typeof t)return Reflect.get(e,t,n);var r=Number(t);return Number.isNaN(r)?Reflect.get(e,t,n):e[r<0?e.length+r:r]},set:function(e,t,n,r){if("string"!=typeof t)return Reflect.set(e,t,n,r);var i=Number(t);return Number.isNaN(i)?Reflect.set(e,t,n,r):(e[i<0?e.length+i:i]=n,!0)}})}},{key:"delta",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!t)return n?{toAdd:e,toRemove:[],toKeep:[]}:{onlyInA:e,onlyInB:[],inBoth:[]};for(var r=[],i=[],o=[],a=0;a<e.length;a++){var s=e[a];t.includes(s)?o.push(s):r.push(s)}for(var u=0;u<t.length;u++){var c=t[u];o.includes(c)||i.push(c)}return n?{toAdd:r,toRemove:i,toKeep:o}:{onlyInA:r,onlyInB:i,inBoth:o}}}]),e}();De._$name="ArrayHelper";var Re=Object.prototype.hasOwnProperty,xe=function(){function e(){v()(this,e)}return g()(e,null,[{key:"after",value:function(t,n,r,i,o){var a="string"==typeof r,s=!1!==(null==o?void 0:o.return);return e.hookMethod(t,n,(function e(){for(var n,o=arguments.length,u=new Array(o),c=0;c<o;c++)u[c]=arguments[c];var l=(n=e.$nextHook).call.apply(n,[t].concat(u)),f=(null==i?void 0:i.isDestroyed)?void 0:s?a?i[r].apply(i,[l].concat(u)):r.call.apply(r,[i,l].concat(u)):a?i[r].apply(i,u):r.call.apply(r,[i].concat(u));return void 0===f?l:f}))}},{key:"before",value:function(t,n,r,i){var o="string"==typeof r;return e.hookMethod(t,n,(function e(){for(var n,a=arguments.length,s=new Array(a),u=0;u<a;u++)s[u]=arguments[u];var c=(null==i?void 0:i.isDestroyed)?0:o?i[r].apply(i,s):r.call.apply(r,[i].concat(s));return!1===c?c:(n=e.$nextHook).call.apply(n,[t].concat(s))}))}},{key:"curry",value:function(e){return function t(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return r.length>=e.length?e.apply(this,r):function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return t.apply(this,r.concat(n))}}}},{key:"bindAll",value:function(e){for(var t in e)"function"==typeof e[t]&&(e[t]=e[t].bind(e))}},{key:"createInterceptor",value:function(e,t,n){return function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return!1!==t.call.apply(t,[n].concat(i))&&e.call.apply(e,[n].concat(i))}}},{key:"createSequence",value:function(e,t,n){return function(){for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];var a=e.call.apply(e,[n].concat(i)),s=t.call.apply(t,[n].concat(i));return void 0===s?a:s}}},{key:"createThrottled",value:function(e,t,n,r,i){var o,a,s,u=0,c=function(){a=0,u=performance.now(),o.push.apply(o,r),e.apply(n,o)};return(s=function(){for(var e=performance.now()-u,s=arguments.length,l=new Array(s),f=0;f<s;f++)l[f]=arguments[f];o=l,e>=t?(clearTimeout(a),c()):(a||(a=setTimeout(c,t-e)),i&&(o.push.apply(o,r),i.apply(n,o)))}).cancel=function(){return clearTimeout(a)},s}},{key:"createBuffered",value:function(e,t,n,r){var i,o,a,s=function(){o=0,a.isPending=!1,i.push.apply(i,r),e.apply(n,i)};return(a=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];i=n,o&&clearTimeout(o),a.isPending=!0,o=setTimeout(s,t)}).cancel=function(){a.isPending=!1,clearTimeout(o)},a}},{key:"hookMethod",value:function(e,t,n){return n.$nextHook=e[t],e[t]=n,function(){if(Re.call(e,t)){var r,i,o=e[t];if(o===n)(null===(i=Object.getPrototypeOf(e))||void 0===i?void 0:i[t])===n.$nextHook?delete e[t]:e[t]=n.$nextHook;else for(;r=null===(a=o)||void 0===a?void 0:a.$nextHook;o=r){var a;if(r===n){o.$nextHook=n.$nextHook;break}}}}}},{key:"returnTrue",value:function(){return!0}},{key:"animate",value:function(e,t,n){var r=this,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"linear",o=!1,a=new Promise((function(a){var s=performance.now();!function u(){var c=Math.min((performance.now()-s)/e,1),l=n&&n.setTimeout?n:window;o||!1===t.call(n,r.easingFunctions[i](c))&&a(),o||1===c?l.requestAnimationFrame((function(){return a()})):l.requestAnimationFrame(u)}()}));return a.cancel=function(){return o=!0,!1},a}}]),e}(),Ee=1.70158,Te=7.5625,Me=1.525,Ae=2/2.75,Pe=2.25/2.75,Ie=1/2.75,Oe=1.5/2.75,Fe=2.5/2.75,Le=2.625/2.75,je=.984375;function _e(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Be(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Be(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Be(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function He(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?He(Object(n),!0).forEach((function(t){ke()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):He(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ne(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}xe.easingFunctions={linear:function(e){return e},easeInQuad:function(e){return Math.pow(e,2)},easeOutQuad:function(e){return-(Math.pow(e-1,2)-1)},easeInOutQuad:function(e){return(e/=.5)<1?.5*Math.pow(e,2):-.5*((e-=2)*e-2)},easeInCubic:function(e){return Math.pow(e,3)},easeOutCubic:function(e){return Math.pow(e-1,3)+1},easeInOutCubic:function(e){return(e/=.5)<1?.5*Math.pow(e,3):.5*(Math.pow(e-2,3)+2)},easeInQuart:function(e){return Math.pow(e,4)},easeOutQuart:function(e){return-(Math.pow(e-1,4)-1)},easeInOutQuart:function(e){return(e/=.5)<1?.5*Math.pow(e,4):-.5*((e-=2)*Math.pow(e,3)-2)},easeInQuint:function(e){return Math.pow(e,5)},easeOutQuint:function(e){return Math.pow(e-1,5)+1},easeInOutQuint:function(e){return(e/=.5)<1?.5*Math.pow(e,5):.5*(Math.pow(e-2,5)+2)},easeInSine:function(e){return 1-Math.cos(e*(Math.PI/2))},easeOutSine:function(e){return Math.sin(e*(Math.PI/2))},easeInOutSine:function(e){return-.5*(Math.cos(Math.PI*e)-1)},easeInExpo:function(e){return 0===e?0:Math.pow(2,10*(e-1))},easeOutExpo:function(e){return 1===e?1:1-Math.pow(2,-10*e)},easeInOutExpo:function(e){return 0===e?0:1===e?1:(e/=.5)<1?.5*Math.pow(2,10*(e-1)):.5*(2-Math.pow(2,-10*--e))},easeInCirc:function(e){return-(Math.sqrt(1-e*e)-1)},easeOutCirc:function(e){return Math.sqrt(1-Math.pow(e-1,2))},easeInOutCirc:function(e){return(e/=.5)<1?-.5*(Math.sqrt(1-e*e)-1):.5*(Math.sqrt(1-(e-=2)*e)+1)},easeOutBounce:function(e){return e<Ie?Te*e*e:e<Ae?Te*(e-=Oe)*e+.75:e<Fe?Te*(e-=Pe)*e+.9375:Te*(e-=Le)*e+je},easeInBack:function(e){return e*e*((Ee+1)*e-Ee)},easeOutBack:function(e){return(e-=1)*e*((Ee+1)*e+Ee)+1},easeInOutBack:function(e){var t=1.70158;return(e/=.5)<1?e*e*((1+(t*=Me))*e-t)*.5:.5*((e-=2)*e*((1+(t*=Me))*e+t)+2)},elastic:function(e){return-1*Math.pow(4,-8*e)*Math.sin((6*e-1)*(2*Math.PI)/2)+1},swingFromTo:function(e){var t=1.70158;return(e/=.5)<1?e*e*((1+(t*=Me))*e-t)*.5:.5*((e-=2)*e*((1+(t*=Me))*e+t)+2)},swingFrom:function(e){return e*e*((Ee+1)*e-Ee)},swingTo:function(e){return(e-=1)*e*((Ee+1)*e+Ee)+1},bounce:function(e){return e<Ie?Te*e*e:e<Ae?Te*(e-=Oe)*e+.75:e<Fe?Te*(e-=Pe)*e+.9375:Te*(e-=Le)*e+je},bouncePast:function(e){return e<Ie?Te*e*e:e<Ae?2-(Te*(e-=Oe)*e+.75):e<Fe?2-(Te*(e-=Pe)*e+.9375):2-(Te*(e-=Le)*e+je)},easeFromTo:function(e){return(e/=.5)<1?.5*Math.pow(e,4):-.5*((e-=2)*Math.pow(e,3)-2)},easeFrom:function(e){return Math.pow(e,4)},easeTo:function(e){return Math.pow(e,.25)}},xe._$name="FunctionHelper";var Ve=Array.isArray,ze={thisObj:1,detachable:1,once:1,detacher:1,prio:1,args:1,expires:1,name:1,_oldDestructor:1},We=function(e,t){return t.prio-e.prio},Ge=function(e){return function(e){fe()(n,e);var t=Ne(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"destroy",value:function(){this.trigger("beforeDestroy"),we()(pe()(n.prototype),"destroy",this).call(this)}},{key:"construct",value:function(e){var t,r;(this.configuredListeners=null===(t=e)||void 0===t?void 0:t.listeners)&&delete(e=$e({},e)).listeners;for(var i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];(r=we()(pe()(n.prototype),"construct",this)).call.apply(r,[this,e].concat(o)),this.processConfiguredListeners()}},{key:"processConfiguredListeners",value:function(){if(this.configuredListeners){var e=this,t=e.isConfiguring;e.isConfiguring=!1,e.listeners=e.configuredListeners,e.configuredListeners=null,e.isConfiguring=t}}},{key:"doDestroy",value:function(){this.trigger("destroy"),this.removeAllListeners(),we()(pe()(n.prototype),"doDestroy",this).call(this)}},{key:"addListener",value:function(e,t,n){if(!Ve(e)){var r,i=this,o=i.$meta.getInherited("deprecatedEvents");if("string"==typeof e)return i.addListener((r={},ke()(r,e,t),ke()(r,"detachable",!1!==t.detachable),ke()(r,"thisObj",n),r));for(var a in t=void 0!==e.thisObj?e.thisObj:t,e)ze[a]||function(){var n=a.toLowerCase(),r=null==o?void 0:o[n],s=i.eventListeners||(i.eventListeners={}),u=e[a],c=u.expires||e.expires,f={fn:"object"===l()(u)?u.fn:u,thisObj:void 0!==u.thisObj?u.thisObj:t,args:u.args||e.args,prio:void 0!==u.prio?u.prio:void 0!==e.prio?e.prio:0,once:void 0!==u.once?u.once:void 0!==e.once&&e.once,catchAll:"catchAll"===a};if(r){var d=r.product,h=r.invalidAsOfVersion,v=r.message;y.a.deprecate(d,h,v)}if(c){var p=i.isDelayable?i:window,g=c.alt,m=g?c.delay:c;p["number"==typeof m?"setTimeout":"requestAnimationFrame"]((function(){i.un(n,f),g&&!f.called&&i.callback(g,t)}),m)}var k=s[n]||(s[n]=[]);k.$firing&&(s[n]=k=k.slice()),k.splice(De.findInsertionIndex(f,k,We,k.length),0,f),!i.onListen.$nullFn&&k.length<2&&i.onListen(n)}();e.relayAll&&i.relayAll(e.relayAll),t&&i.attachAutoDetacher(e,t);var s,u=!1!==e.detachable,c=e.name,f=e.expires||u||c?function(){i.isDestroyed||i.removeListener(e,t)}:null;return f&&(f.eventer=i,f.listenerName=c,c&&(null===(s=t)||void 0===s?void 0:s.trackDetacher)&&t.trackDetacher(c,f),e.expires&&i.delay(f,e.expires),u)?f:void 0}for(var d=0,h=e.length;d<h;d++)this.addListener(e[d],t)}},{key:"on",value:function(){return this.addListener.apply(this,arguments)}},{key:"un",value:function(){this.removeListener.apply(this,arguments)}},{key:"changeListeners",value:function(e){if(!this.isConfiguring)return e&&!("thisObj"in e)&&(e=F.assign({thisObj:this},e)),e;e&&this.on(e,this)}},{key:"updateListeners",value:function(e,t){t&&this.un(t),e&&this.on(e)}},{key:"removeListener",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.thisObj,n=arguments.length>2?arguments[2]:void 0,r=this;if("string"==typeof e)return r.removeListener(ke()({},e,t),n);Object.entries(e).forEach((function(e){var n=ye()(e,2),i=n[0],o=n[1];if(!ze[i]){i=i.toLowerCase();var a=r.eventListeners,s=r.findListener(i,o,t);if(s>=0){var u=a[i];u.length>1?(u.$firing&&(a[i]=u=u.slice()),u.splice(s,1)):(delete a[i],r.onUnlisten.$nullFn||r.onUnlisten(i))}}})),e.thisObj&&!e.thisObj.isDestroyed&&r.detachAutoDetacher(e)}},{key:"findListener",value:function(e,t,n){var r,i=null===(r=this.eventListeners)||void 0===r?void 0:r[e],o=t.fn||t,a=t.thisObj||n;if(i)for(var s,u=0,c=i.length;u<c;u++)if((s=i[u]).fn===o&&s.thisObj===a)return u;return-1}},{key:"hasListener",value:function(e){var t;return Boolean(null===(t=this.eventListeners)||void 0===t?void 0:t[null==e?void 0:e.toLowerCase()])}},{key:"relayAll",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];(this.relayAllTargets||(this.relayAllTargets=[])).push({through:e,prefix:t,transformCase:n})}},{key:"removeAllListeners",value:function(){var e,t,n=this.eventListeners;for(var r in n){var i=n[r];for(e=i.length;e-- >0;){var o,a=i[e];this.removeListener(r,a),(null===(o=t=a.thisObj)||void 0===o?void 0:o.untrackDetachers)&&t.untrackDetachers(this)}}}},{key:"relayEvents",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"",i={detachable:!0};return t.forEach((function(e){i[e]=function(e){for(var t=arguments.length,i=new Array(t>1?t-1:0),o=1;o<t;o++)i[o-1]=arguments[o];return n.trigger.apply(n,[r+e.type,e].concat(i))}})),e.on(i)}},{key:"onListen",value:function(){}},{key:"onUnlisten",value:function(){}},{key:"attachAutoDetacher",value:function(e,t){var n=this,r=e.thisObj||t,i="doDestroy"in r?"doDestroy":"destroy";if(i in r){var o=r.$autoDetachers;o||(r[i]=xe.createInterceptor(r[i],(function(){for(var e=0;e<o.length;e++){var t=o[e],n=t.dispatcher,i=t.config;n.isDestroyed||n.removeListener(i,r)}}),r),r.$autoDetachers=o=[]),o.push({config:e,dispatcher:this})}else r[i]=function(){n.removeListener(e)}}},{key:"detachAutoDetacher",value:function(e){var t=e.thisObj,n="doDestroy"in t?"doDestroy":"destroy";e._oldDestructor&&(t[n]=e._oldDestructor)}},{key:"await",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{checkLog:!0,resetLog:!0,args:null},n=this;!1===t&&(t={checkLog:!1});var r=t,i=r.args;return new Promise((function(r){var o,a;if(t.checkLog&&(null===(o=n._triggered)||void 0===o?void 0:o[e])&&(r(),t.resetLog&&n.clearLog(e)),i)var s,u=n.on((s={},ke()(s,e,(function(){for(var o=arguments.length,a=new Array(o),s=0;s<o;s++)a[s]=arguments[s];var c=Object.keys(i).every((function(e){return e in a[0]&&a[0][e]===i[e]}));c&&(r.apply(void 0,a),t.resetLog&&n.clearLog(e),u())})),ke()(s,"prio",-1e4),s));else n.on((a={},ke()(a,e,(function(){r.apply(void 0,arguments),t.resetLog&&n.clearLog(e)})),ke()(a,"prio",-1e4),ke()(a,"once",!0),a))}))}},{key:"clearLog",value:function(e){this._triggered&&(e?delete this._triggered[e]:this._triggered={})}},{key:"callPreventable",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=this;if(!i&&!1===o.trigger("before"+E.capitalize(e),t))return!1;var a=n.apply(void 0,[t].concat(d()(r)));return i||o.trigger(e,t),a}},{key:"trigger",value:function(e,t){var n,r,i,o=this,a=e.toLowerCase(),s=o.eventsSuspended,u=o.relayAllTargets,c=o.callOnFunctions,l=o.owner,f=null===(n=o.eventListeners)||void 0===n?void 0:n[a];if(o._triggered||(o._triggered={}),o._triggered[e]=!0,s)return s.shouldQueue&&s.queue.push(arguments),!0;(null===(r=o.eventListeners)||void 0===r?void 0:r.catchall)&&((i=f=f?f.slice():[]).push.apply(i,d()(o.eventListeners.catchall)),f.sort(We));if(!f&&!u&&!c)return!0;if(t?"source"in t||(Object.isExtensible(t)?t.source=o:t=Object.setPrototypeOf({source:o},t)):t={source:o},t.type!==a&&(t.constructor!==Object?Reflect.defineProperty(t,"type",{get:function(){return a}}):t.type=a),c){var h="on"+E.capitalize(e);if(h in o&&(o.callback(o[h],o,[t]),!o.isDestroyed&&Object.prototype.hasOwnProperty.call(o,h)&&(!o.pluginFunctionChain||!o.pluginFunctionChain[h]))){var v=Object.getPrototypeOf(o);if(h in v&&(v[h].call(o,t),o.isDestroyed))return}}if(f){var p,g,y,m=0;for(f.$firing=!0;m<f.length&&!o.isDestroyed&&!1!==y;m++){var k=(p=f[m]).thisObj;if(!k||!k.isDestroyed){if(p.called=!0,p.once&&o.removeListener(a,p),"string"==typeof p.fn){if(k&&(g=k[p.fn]),!g){var b=o.resolveCallback(p.fn);g=b.handler,k=b.thisObj}}else g=p.fn;var w;if(p.args)y=(w=g).call.apply(w,[k||o].concat(d()(p.args),[t]));else y=g.call(k||o,t)}}if(f.$firing=!1,!1===y)return y}return u&&u.forEach((function(n){var r=e;if(n.transformCase&&(r=E.capitalize(r)),n.prefix&&(r=n.prefix+r),!1===n.through.trigger(r,t))return!1})),!(t.bubbles&&l&&!l.isDestroyed)||l.trigger(e,t)}},{key:"suspendEvents",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.eventsSuspended||(this.eventsSuspended={shouldQueue:e,queue:[],count:0});t.count++}},{key:"resumeEvents",value:function(){var e=this.eventsSuspended;if(e&&0==--e.count&&(this.eventsSuspended=null,e.shouldQueue)){var t,n=_e(e.queue);try{for(n.s();!(t=n.n()).done;){var r=t.value;this.trigger.apply(this,d()(r))}}catch(e){n.e(e)}finally{n.f()}}return!Boolean(this.eventsSuspended)}},{key:"listeners",get:function(){return this.eventListeners}}],[{key:"setupDeprecatedEvents",value:function(e,t){var n=t.getInherited("deprecatedEvents"),r=e.deprecatedEvents;for(var i in r)n[i.toLowerCase()]=n[i]=r[i]}},{key:"setupClass",value:function(e){we()(pe()(n),"setupClass",this).call(this,e),["onListen","onUnlisten"].forEach((function(e){return n.prototype[e].$nullFn=!0}))}},{key:"$name",get:function(){return"Events"}},{key:"declarable",get:function(){return["deprecatedEvents"]}},{key:"configurable",get:function(){return{listeners:{value:null,$config:{merge:function(e,t){if(null!==e){if(!e)return t;t&&(e=e?[e]:[]).push[Ve(t)?"apply":"call"](e,t)}return e}}}}}}]),n}(e||ue)},Ye=n(19),Ue=n.n(Ye);function qe(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Ke(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ke(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Ke(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Xe=/^(\w+)=(.*)$/,Ze=j.a.queryString.__resourceRoot||"",Je=function(){function e(){v()(this,e)}return g()(e,null,[{key:"get",value:function(e,t){return this.fetch(e,t)}},{key:"post",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return t instanceof FormData||"string"==typeof t||(t=JSON.stringify(t),n.headers=n.headers||{},n.headers["Content-Type"]=n.headers["Content-Type"]||"application/json"),this.fetch(e,Object.assign({method:"POST",body:t},n))}},{key:"fetch",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=new AbortController;if(Object.assign(t,{abortController:n,signal:n.signal}),"credentials"in t||(t.credentials="include"),t.queryParams){var r=Object.entries(t.queryParams);r.length&&(e+=(e.includes("?")?"&":"?")+r.map((function(e){var t=ye()(e,2),n=t[0],r=t[1];return"".concat(n,"=").concat(encodeURIComponent(r))})).join("&"))}var i=new Promise((function(n,r){fetch(Ze+e,t).then((function(e){t.parseJson?e.json().then((function(t){e.parsedJson=t,n(e)})).catch((function(t){e.parsedJson=null,e.error=t,r(e)})):n(e)})).catch((function(e){e.stack=i.stack,"AbortError"!==e.name&&r(e)}))}));return i.stack=(new Error).stack,i.abort=function(){n.abort()},i}))},{key:"mockUrl",value:function(t,n){(this.mockAjaxMap||(this.mockAjaxMap={}))[t]=n,e.originalFetch||(e.originalFetch=e.fetch),e.fetch=this.mockAjaxFetch.bind(this)}},{key:"mockAjaxFetch",value:function(t,n){var r=t.split("?"),i=this.mockAjaxMap[r[0]],o=null;if(i){"function"==typeof i&&(i=i(r[0],r[1]&&function(e){var t,n={},r=qe(e.split("&"));try{for(r.s();!(t=r.n()).done;){var i=t.value,o=Xe.exec(i),a=ye()(o,3),s=a[0],u=a[1],c=a[2],l=decodeURIComponent(u),f=decodeURIComponent(c);if(s){var d=n[l];d?(Array.isArray(d)||(d=n[l]=[d]),d.push(f)):n[l]=f}}}catch(e){r.e(e)}finally{r.f()}return n}(r[1]),n));try{o=n.parseJson&&JSON.parse(i.responseText)}catch(e){o=null,i.error=e}return i=Object.assign({status:200,ok:!0,headers:new Headers,statusText:"OK",url:t,parsedJson:o,text:function(){return new Promise((function(e){e(i.responseText)}))},json:function(){return new Promise((function(e){e(o)}))}},i),new Promise((function(e,t){i.synchronous?e(i):setTimeout((function(){e(i)}),"delay"in i?i.delay:100)}))}return e.originalFetch(t,n)}}]),e}();function Qe(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function et(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Qe(Object(n),!0).forEach((function(t){ke()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Qe(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}Je._$name="AjaxHelper";var tt=function(){function e(){v()(this,e)}return g()(e,null,[{key:"mergeLocales",value:function(){for(var e={},t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.forEach((function(t){Object.keys(t).forEach((function(n){"object"===l()(t[n])?e[n]=et(et({},e[n]),t[n]):e[n]=t[n]}))})),e}},{key:"trimLocale",value:function(e,t){var n=function(t,n){if(!e[t])throw new Error('Key "'.concat(t,"\" doesn't exist in locale"));if(n){if(!e[t][n])throw new Error('SubKey "'.concat(t,".").concat(n,"\" doesn't exist in locale"));delete e[t][n]}else delete e[t]};Object.keys(t).forEach((function(e){Array.isArray(t[e])?t[e].forEach((function(t){return n(e,t)})):n(e)}))}},{key:"publishLocale",value:function(e,t){var n=window.bryntum=window.bryntum||{},r=n.locales=n.locales||{};r[e]=r[e]?this.mergeLocales(r[e],t):t}}]),e}();function nt(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}tt._$name="LocaleHelper";var rt=new(function(e){fe()(n,e);var t=nt(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(){for(var e,t=this,r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];(e=we()(pe()(n.prototype),"construct",this)).call.apply(e,[this].concat(i));var a=document.querySelector("script[data-default-locale]");a&&(t.defaultLocaleName=a.dataset.defaultLocale),j.a.isBrowserEnv&&window.bryntum&&window.bryntum.locales&&(Object.keys(window.bryntum.locales).forEach((function(e){if(!e.startsWith("moment")){var n=window.bryntum.locales[e];n.extends?t.extendLocale(n.extends,n):n.localeName&&t.registerLocale(n.localeName,{desc:n.localeDesc,locale:n})}})),t.locale||"En"!==t.defaultLocaleName&&t.applyLocale(t.defaultLocaleName||Object.keys(t.locales)[0]))}},{key:"registerLocale",value:function(e,t){var n=this,r=n.defaultLocaleName===e,i=n.locale&&n.locale.localeName===e,o=0===Object.keys(n.locales).length;n.locales[e]?n.locales[e].locale=tt.mergeLocales(n.locales[e].locale,t.locale):n.locales[e]=t,(r||!n.defaultLocaleName&&(o||i))&&n.internalApplyLocale(n.locales[e])}},{key:"extendLocale",value:function(e,t){var n,r=this.locales[e];return!!r&&(r.locale=tt.mergeLocales(r.locale,t),delete r.locale.extends,(null===(n=this.locale)||void 0===n?void 0:n.localeName)===e&&this.applyLocale(e),!0)}},{key:"internalApplyLocale",value:function(e){this._locale=e.locale,this.trigger("locale",e)}},{key:"applyLocale",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.locales[e];if(i&&i.locale&&r._locale===i.locale&&!t)return!0;if(!i){if(n)return!0;throw new Error("Locale ".concat(e," not registered"))}function o(){r.internalApplyLocale(i)}return i.locale?(o(),!0):new Promise((function(t,n){r.loadLocale(i.path).then((function(n){n.text().then((function(n){new Function(n)(),j.a.isBrowserEnv&&(i.locale=window.bryntum.locales[e]),o(),t(i)}))})).catch((function(e){return n(e)}))}))}},{key:"loadLocale",value:function(e){return Je.get(e)}},{key:"locales",set:function(e){this._locales=e},get:function(){return this._locales}},{key:"locale",set:function(e){"string"==typeof e?this.applyLocale(e):(e.locale||(e={locale:e,localeName:e.localeName||"custom"}),this.registerLocale(e.localeName,e),this.applyLocale(e.localeName))},get:function(){return this._locale}},{key:"throwOnMissingLocale",set:function(e){this._throwOnMissingLocale=e},get:function(){return this._throwOnMissingLocale}}],[{key:"defaultConfig",get:function(){return{locales:{},throwOnMissingLocale:y.a.isTestEnv}}}]),n}(Ge(ue)));function it(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return ot(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ot(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function ot(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function at(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var st=Object.getPrototypeOf(Object),ut=/L{.*?}/g,ct=function(e){return e.replace(/\[\[(\d+)]]/gm,"{$1}")},lt=function(e){return function(e){fe()(n,e);var t=at(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(){for(var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];(e=we()(pe()(n.prototype),"construct",this)).call.apply(e,[this,t].concat(i)),rt.on("locale",this.updateLocalization,this),this.updateLocalization()}},{key:"localizeProperty",value:function(e){var t,r=this,i=F.getPath(r,e),o=null===(t=r.$meta.configs[e])||void 0===t?void 0:t.localeKey;if(o){var a=n.localize(o,null,r.localeClass||r);a&&!(e in r.initialConfig)&&F.setPath(r,e,a)}else if("string"==typeof i){r.originalLocales=r.originalLocales||{};var s=F.getPath(r.originalLocales,e);void 0===s&&(F.setPath(r.originalLocales,e,i),s=i),s&&F.setPath(r,e,r.optionalL(s))}}},{key:"updateLocalization",value:function(){var e;null===(e=this.localizableProperties)||void 0===e||e.forEach(this.localizeProperty,this)}},{key:"L",value:function(e,t){var r=this.localeClass,i=this.constructor;return r&&n.clsName(r)!==n.clsName(i)?n.L(e,t,r,i):n.L(e,t,i)}},{key:"optionalL",value:function(e,t){var n=rt.throwOnMissingLocale;rt.throwOnMissingLocale=n&&ut.test(e);var r=this.L(e,t);return rt.throwOnMissingLocale=n,r}},{key:"localeClass",get:function(){return this._localeClass||null}},{key:"localeManager",get:function(){return rt}}],[{key:"clsName",value:function(e){var t,n;return"string"==typeof e?e:e===st?"Object":e.$$name||e.name||(null===(t=e.prototype)||void 0===t?void 0:t.$$name)||(null===(n=e.prototype)||void 0===n?void 0:n.name)}},{key:"parseLocaleString",value:function(e){var t,n,r=[];if(null===(t=e)||void 0===t?void 0:t.includes("L{")){var i=/L{(.*?)}/g;for(e=e.replace(/{(\d+)}/gm,"[[$1]]");null!=(n=i.exec(e));){var o=/((.*?)\.)?(.+)/g.exec(n[1]);r.push({match:ct(n[0]),localeKey:ct(o[3]),localeClass:o[2]})}}return r.length>0?r:[{match:e,localeKey:e,localeClass:void 0}]}},{key:"getTranslation",value:function(e,t,r){var i,o,a=rt.locale,s=null;if(a){var u,c=it(this.parseLocaleString(e));try{var f=function(){var c=u.value,f=c.match,d=c.localeKey,h=c.localeClass,v=function(n){var r,i=null===(r=a[n])||void 0===r?void 0:r[d];return i&&(s="function"==typeof i?null!=t?i(t):i:"object"===l()(i)||e===f?i:(s||e).replace(f,i)),i},p=!1;for(o=r;o&&(i=n.clsName(o))&&!(p=v(i))&&"string"!=typeof o;o=Object.getPrototypeOf(o));!p&&h&&v(h)};for(c.s();!(u=c.n()).done;)f()}catch(e){c.e(e)}finally{c.f()}}return s}},{key:"localize",value:function(e){for(var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,i=arguments.length,o=new Array(i>2?i-2:0),a=2;a<i;a++)o[a-2]=arguments[a];0===(null===(t=o)||void 0===t?void 0:t.length)&&(o=[this]);var s=null;return o.some((function(t){return null!=(s=n.getTranslation(e,r,t))})),s}},{key:"L",value:function(e){for(var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,i=arguments.length,o=new Array(i>2?i-2:0),a=2;a<i;a++)o[a-2]=arguments[a];0===(null===(t=o)||void 0===t?void 0:t.length)&&(o=[this]);var s=this.localize.apply(this,[e,r].concat(d()(o)));if(rt.throwOnMissingLocale&&rt.locale&&null==s)throw new Error("Localization is not found for '".concat(e,"' in '").concat(o.map((function(e){return n.clsName(e)})).join(", "),"'. ").concat(rt.locale.localeName?"Locale : ".concat(rt.locale.localeName):""));return null!=s?s:e}},{key:"optionalL",value:function(e){for(var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,i=arguments.length,o=new Array(i>2?i-2:0),a=2;a<i;a++)o[a-2]=arguments[a];var s=rt.throwOnMissingLocale;rt.throwOnMissingLocale=s&&ut.test(e),0===(null===(t=o)||void 0===t?void 0:t.length)&&(o=[this]);var u=n.L.apply(n,[e,r].concat(d()(o)));return rt.throwOnMissingLocale=s,u}},{key:"$name",get:function(){return"Localizable"}},{key:"configurable",get:function(){return{localeClass:null,localizableProperties:{value:[],$config:{merge:"distinct"}}}}}]),n}(e||ue)};function ft(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return dt(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return dt(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function dt(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ht(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var vt=Object.prototype.toString,pt=vt.call(new Date),gt=function(e){return e+({1:"st",2:"nd",3:"rd"}[e[e.length-1]]||"th")},yt=new RegExp("","g"),mt=function(e,t){return isNaN(e)||null==e?t:e},kt=function(e,t,n){var r=(xt[e]||(xt[e]=new Intl.DateTimeFormat(St,t))).format(n);return j.a.isIE11&&(r=r.replace(yt,"")),r},bt=function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=kt(e,t,n);return/am|pm/i.test(i)&&(i=i.replace(/^0/,""),r&&(i=i.replace(/:00/,""))),i},wt=function(e,t){return Math.floor((e.getTime()-t.getTime()-(e.getTimezoneOffset()-t.getTimezoneOffset())*_t.minute.millisecond)/_t.day.millisecond)+1},Ct=function(e){return e>=0?e:e+7},St="en-US",Dt=gt,Rt={},xt={},Et={},Tt={M:function(e){return e.getMonth()+1},Mo:function(e){return Dt(Tt.M(e).toString())},MM:function(e){return(e.getMonth()+1).toString().padStart(2,"0")},MMM:function(e){return kt("MMM",{month:"short"},e)},MMMM:function(e){return kt("MMMM",{month:"long"},e)},Q:function(e){return Math.ceil((e.getMonth()+1)/3)},Qo:function(e){return Dt(Tt.Q(e).toString())},D:function(e){return e.getDate()},Do:function(e){return Dt(Tt.D(e).toString())},DD:function(e){return e.getDate().toString().padStart(2,"0")},DDD:function(e){return Math.ceil((new Date(e.getFullYear(),e.getMonth(),e.getDate(),12,0,0)-new Date(e.getFullYear(),0,0,12,0,0))/_t.day.millisecond)},DDDo:function(e){return Dt(Tt.DDD(e).toString())},DDDD:function(e){return Tt.DDD(e).toString().padStart(3,"0")},d:function(e){return e.getDay()},do:function(e){return Dt(e.getDay().toString())},d1:function(e){return Tt.ddd(e).substring(0,1)},dd:function(e){return Tt.ddd(e).substring(0,2)},ddd:function(e){return kt("ddd",{weekday:"short"},e)},dddd:function(e){return kt("dddd",{weekday:"long"},e)},e:function(e){return e.getDay()},E:function(e){return e.getDay()+1},W:function(e){return Zt.getWeekNumber(e)[1]},Wo:function(e){return Dt(Tt.W(e).toString())},WW:function(e){return Tt.W(e).toString().padStart(2,"0")},Y:function(e){return e.getFullYear()},YY:function(e){return e.getFullYear()%100},YYYY:function(e){return e.getFullYear()},A:function(e){return e.getHours()<12?"AM":"PM"},a:function(e){return e.getHours()<12?"am":"pm"},H:function(e){return e.getHours()},HH:function(e){return e.getHours().toString().padStart(2,"0")},h:function(e){return e.getHours()%12||12},hh:function(e){return Tt.h(e).toString().padStart(2,"0")},k:function(e){return e.getHours()+1},kk:function(e){return Tt.k(e).toString().padStart(2,"0")},K:function(e){return bt("K",{hour:"numeric"},e)},KK:function(e){return bt("KK",{hour:"2-digit"},e)},m:function(e){return e.getMinutes()},mm:function(e){return Tt.m(e).toString().padStart(2,"0")},s:function(e){return e.getSeconds()},ss:function(e){return Tt.s(e).toString().padStart(2,"0")},S:function(e){return e.getMilliseconds().toString().substr(0,1)},SS:function(e){return e.getMilliseconds().toString().substr(0,2).padEnd(2,"0")},SSS:function(e){return e.getMilliseconds().toString().substr(0,3).padEnd(3,"0")},z:function(e){return kt("z",{timeZoneName:"short"},e)},zz:function(e){return kt("zz",{timeZoneName:"long"},e)},Z:function(e){return Jt.getGMTOffset(e)},LT:function(e){return bt("LT",{hour:"2-digit",minute:"2-digit"},e)},LST:function(e){return bt("LST",{hour:"numeric",minute:"2-digit"},e,!0)},LTS:function(e){return bt("LTS",{hour:"2-digit",minute:"2-digit",second:"2-digit"},e)},L:function(e){return kt("L",{year:"numeric",month:"2-digit",day:"2-digit"},e)},l:function(e){return kt("l",{year:"numeric",month:"numeric",day:"numeric"},e)},LL:function(e){return kt("LL",{year:"numeric",month:"long",day:"numeric"},e)},ll:function(e){return kt("ll",{year:"numeric",month:"short",day:"numeric"},e)},LLL:function(e){return kt("LLL",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit"},e)},lll:function(e){return kt("lll",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit"},e)},LLLL:function(e){return kt("LLLL",{year:"numeric",month:"long",day:"numeric",hour:"numeric",minute:"2-digit",weekday:"long"},e)},llll:function(e){return kt("llll",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit",weekday:"short"},e)}},Mt=Object.keys(Tt).sort((function(e,t){return t.length-e.length})),At="^(?:".concat(Mt.join("|"),")"),Pt=function(){return{}},It=function(e){return function(e){return Yt.test(e)}(e)&&{milliseconds:parseInt(e.padEnd(3,"0").substring(0,3))}},Ot={YYYY:function(e){return{year:parseInt(e)}},Y:function(e){return{year:parseInt(e)}},YY:function(e){var t=parseInt(e);return{year:t+(t>1968?1900:2e3)}},MM:function(e){return{month:parseInt(e)-1}},Mo:function(e){return{month:parseInt(e)-1}},DD:function(e){return{date:parseInt(e)}},M:function(e){return{month:parseInt(e)-1}},D:function(e){return{date:parseInt(e)}},Do:function(e){return{date:parseInt(e)}},DDD:Pt,MMM:Pt,MMMM:Pt,DDDo:Pt,DDDD:Pt,d:Pt,do:Pt,d1:Pt,dd:Pt,ddd:Pt,dddd:Pt,Q:Pt,Qo:Pt,W:Pt,Wo:Pt,WW:Pt,e:Pt,E:Pt,HH:function(e){return{hours:parseInt(e)}},hh:function(e){return{hours:parseInt(e)}},mm:function(e){return{minutes:parseInt(e)}},H:function(e){return{hours:parseInt(e)}},m:function(e){return{minutes:parseInt(e)}},ss:function(e){return{seconds:parseInt(e)}},s:function(e){return{seconds:parseInt(e)}},S:It,SS:It,SSS:It,A:function(e){return{amPm:e.toLowerCase()}},a:function(e){return{amPm:e.toLowerCase()}},L:"MM/DD/YYYY",LT:"HH:mm A",Z:function(e){if(!e||!Ut.test(e)&&"Z"!==e)return null;var t=0;if("Z"!==e){var n=Ut.exec(e);if(n)t=("+"===n[1]?1:-1)*(60*(parseInt(n[2])||0)+(parseInt(n[3])||0));else t=-1*(new Date).getTimezoneOffset()}return{timeZone:t}}},Ft=Object.keys(Ot).sort((function(e,t){return t.length-e.length})),Lt=new RegExp("(".concat(Ft.join("|"),")")),jt=new RegExp("(l|LL|ll|LLL|lll|LLLL|llll)"),_t={year:{year:1,quarter:4,month:12,week:52,day:365,hour:8760,minute:525600,second:31536e3,millisecond:31536e6},quarter:{year:1/4,quarter:1,month:3,week:4,day:91,hour:2184,minute:131040,second:7862400,millisecond:78624e5},month:{year:1/12,quarter:1/3,month:1,week:4,day:-30,hour:-720,minute:-43200,second:-2592e3,millisecond:-2592e6},week:{year:-1/52,quarter:-1/13,month:-1/4,day:7,hour:168,minute:10080,second:604800,millisecond:6048e5},day:{year:-1/365,quarter:-1/91,month:-1/30,week:1/7,hour:24,minute:1440,second:86400,millisecond:864e5},hour:{year:-1/8760,quarter:-1/2184,month:-1/720,week:1/168,day:1/24,minute:60,second:3600,millisecond:36e5},minute:{year:-1/525600,quarter:-1/131040,month:-1/43200,week:1/10080,day:1/1440,hour:1/60,second:60,millisecond:6e4},second:{year:-1/31536e3,quarter:-1/7862400,month:-1/2592e3,week:1/604800,day:1/86400,hour:1/3600,minute:1/60,millisecond:1e3},millisecond:{year:-1/31536e6,quarter:-1/78624e5,month:-1/2592e6,week:1/6048e5,day:1/864e5,hour:1/36e5,minute:1/6e4,second:.001}},Bt={ms:"millisecond",milliseconds:"millisecond",s:"second",seconds:"second",m:"minute",minutes:"minute",h:"hour",hours:"hour",d:"day",days:"day",w:"week",weeks:"week",M:"month",months:"month",q:"quarter",quarters:"quarter",y:"year",years:"year"},Ht=/^\s*([-+]?\d+(?:[.,]\d*)?|[-+]?(?:[.,]\d+))\s*([^\s]+)?/i,$t=/^\s*([-+]?\d+)(?![.,])\s*([^\s]+)?/i,Nt=["millisecond","second","minute","hour","day","week","month","quarter","year"],Vt=[["mil"],["s","sec"],["m","min"],["h","hr"],["d"],["w","wk"],["mo","mon","mnt"],["q","quar","qrt"],["y","yr"]],zt=["year","month","week","day","hour","minute","second","millisecond"],Wt=["milliseconds","seconds","minutes","hours","date","month","year"],Gt=function(e){var t=parseFloat(e);return isNaN(t)?null:t},Yt=/^[0-9]+$/,Ut=/([+-])(\d\d):*(\d\d)*$/,qt={millisecond:0,second:1,minute:2,hour:3,day:4,week:5,month:6,quarter:7,year:8},Kt={round:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Math.round(e/t)*t},floor:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Math.floor(e/t)*t},ceil:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Math.ceil(e/t)*t}},Xt={},Zt=function(e){fe()(n,e);var t=ht(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"buildParser",value:function(e){var t=this,n=e.split(Lt),r=[];return 1===n.length||jt.test(e)?[]:(n.reduce((function(n,i,o,a){if(0!==o||""!==i)if(Lt.test(i)){var s=(t.localize("L{parsers}")||{})[i]||Ot[i];if("Z"===i&&o<a.length-2)throw new Error("Invalid format ".concat(e," TimeZone (Z) must be last token"));if("string"==typeof s){var u=Jt.buildParser(s),c=u.pop();delete c.last,r.push.apply(r,d()(u)),n=c}else n.pattern=i,n.fn=Ot[i]}else n.splitter=i,r.push(n),n={};else Object.prototype.hasOwnProperty.call(n,"pattern")&&r.push(n);return n}),{}),r[r.length-1].last=!0,r)}},{key:"makeKey",value:function(e){e.getTime&&(e=e.getTime());var t=Xt[e];return t||(Xt[e]=Jt.format(new Date(e),"YYYY-MM-DD"))}},{key:"parseKey",value:function(e){return Jt.parse(e,"YYYY-MM-DD")}},{key:"parse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Jt.defaultParseFormat;if(e instanceof Date)return e;if("string"!=typeof e||!e)return null;var n={year:null,month:null,date:null,hours:null,minutes:null,seconds:null,milliseconds:null};t=t.replace(/S+/gm,"SSS");var r=Et[t];r||(r=Et[t]=Jt.buildParser(t)),r.reduce((function(e,t){if(!t.last){var r,i,o;if(-1===(r="T"===t.splitter&&-1===e.indexOf("T")?e.indexOf(" "):""!==t.splitter?e.indexOf(t.splitter):t.pattern&&t.pattern.length||-1)||"SSS"===t.pattern&&e.match(/^\d+Z$/)){var a=e.split(/([Z\-+])/);1===a.length?(i=e,o=""):(i=a[0],o="".concat(a[1]).concat(a[2]))}else i=e.substring(0,r)||e,o=e.substring(r+t.splitter.length);if(t.fn){var s=t.fn(i);s?Object.assign(n,s):o=i+o}return o}Object.assign(n,t.fn(e))}),e),n.year&&!n.date&&(n.date=1);var i=Jt.create(n);return i||new Date(e)}},{key:"create",value:function(e){var t=Object.assign({},e),n=isNaN(t.year),r=!1;if(!n){var i=!0;Wt.forEach((function(e){e in t&&!isNaN(t[e])||(t[e]=0),i=i&&null===t[e]})),n=i}if("pm"===t.amPm&&(t.hours=t.hours%12+12),"timeZone"in t&&(r=!0,t.minutes-=t.timeZone),n)return null;var o=[mt(t.year,2020),mt(t.month,0),mt(t.date,1),t.hours,t.minutes,t.seconds,t.milliseconds];return r?new Date(Date.UTC.apply(Date,o)):Ue()(Date,o)}},{key:"toUTC",value:function(e){return new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate(),e.getUTCHours(),e.getUTCMinutes(),e.getUTCSeconds(),e.getUTCMilliseconds()))}},{key:"format",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Jt.defaultFormat;if(!e||isNaN(e))return null;var n=Rt[t],r="";if(!n){n=Rt[t]=[];for(var i=0;i<t.length;i++){var o=t.substr(i).match(At),a=o&&o[0];if(a){var s=this.localize("L{formats}")||{},u=s[a]||Tt[a];n.push(u),i+=a.length-1}else if("{"===t[i]){var c=t.indexOf("}",i+1);-1===c?(n.push(t.substr(i+1)),i=t.length):(n.push(t.substring(i+1,c)),i=c)}else n.push(t[i])}}return n.forEach((function(t){r+="string"==typeof t?t:t(e)})),(j.a.isEdge||j.a.isIE11)&&(r=r.replace(/\u200E/g,"")),r}},{key:"asMilliseconds",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return"string"==typeof e&&(t=e,e=1),Jt.as("millisecond",e,t)}},{key:"asMonths",value:function(e){var t=Jt.as("ms",Jt.daysInMonth(e),"day"),n=(e.valueOf()-Jt.startOf(e,"month").valueOf())/t;return 12*e.getYear()+e.getMonth()+n}},{key:"monthsToDate",value:function(e){var t=Math.floor(e),n=e-t,r=new Date(0,t),i=Jt.as("ms",Jt.daysInMonth(r),"days");return r.setTime(r.getTime()+n*i),r}},{key:"formatDelta",value:function(e,t){var n,r;"boolean"==typeof t?n=t:t&&(n=t.abbrev);var i=this.getDelta(e,t),o=[],a=n?"":" ";for(r in i)o.push("".concat(i[r]).concat(a).concat(r));return!1===(null==t?void 0:t.asString)?o:o.join(", ")}},{key:"getDelta",value:function(e,t){var n,r,i,o,a;"boolean"==typeof t?n=t:t&&(n=t.abbrev,o=Jt.normalizeUnit(t.precision));var s,u={},c=n?Jt.getShortNameOfUnit:Jt.getLocalizedNameOfUnit,l=ft(zt);try{for(l.s();!(s=l.n()).done&&(a=s.value,r=Jt.as(a,e),i=o===a,((r=Math[i?"round":"floor"](r))||i&&!u.length)&&(u[c.call(Jt,a,1!==r)]=r,e-=Jt.as("ms",r,a)),!i&&e););}catch(e){l.e(e)}finally{l.f()}return u}},{key:"as",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"ms";return"string"==typeof t&&(t=Jt.parseDuration(t)),"object"===l()(t)&&(n=t.unit,t=t.magnitude),e===n?t:(e=Jt.normalizeUnit(e),n=Jt.normalizeUnit(n),qt[n]>qt[e]?t*Math.abs(_t[n][e]):t/Math.abs(_t[e][n]))}},{key:"formatContainsHourInfo",value:function(e){return/([HhKkmSsAa]|LT|L{3,}|l{3,})/.test(e.replace(/(\\.)/g,""))}},{key:"is24HourFormat",value:function(e){return Jt.format(Jt.getTime(13,0,0),e).includes("13")}},{key:"add",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"ms";if(n="string"==typeof e?Jt.parse(e):new Date(e.getTime()),!r||0===t)return n;switch(r=Jt.normalizeUnit(r)){case"millisecond":n=new Date(n.getTime()+t);break;case"second":n=new Date(n.getTime()+1e3*t);break;case"minute":n=new Date(n.getTime()+6e4*t);break;case"hour":n=new Date(n.getTime()+36e5*t);break;case"day":t%1==0?n.setDate(n.getDate()+t):n=new Date(n.getTime()+864e5*t),23===n.getHours()&&0===e.getHours()&&(n=Jt.add(n,1,"hour"));break;case"week":n.setDate(n.getDate()+7*t);break;case"month":var i=n.getDate();i>28&&(i=Math.min(i,Jt.getLastDateOfMonth(Jt.add(Jt.getFirstDateOfMonth(n),t,"month")).getDate())),n.setDate(i),n.setMonth(n.getMonth()+t);break;case"quarter":n=Jt.add(n,3*t,"month");break;case"year":n.setFullYear(n.getFullYear()+t)}return n}},{key:"diff",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"ms",i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];if(r=Jt.normalizeUnit(r),!e||!t)return 0;switch(r){case"year":n=Jt.diff(e,t,"month")/12;break;case"quarter":n=Jt.diff(e,t,"month")/3;break;case"month":n=12*(t.getFullYear()-e.getFullYear())+(t.getMonth()-e.getMonth());break;case"week":n=Jt.diff(e,t,"day")/7;break;case"day":var o=e.getTimezoneOffset()-t.getTimezoneOffset();n=(t-e+60*o*1e3)/864e5;break;case"hour":n=(t-e)/36e5;break;case"minute":n=(t-e)/6e4;break;case"second":n=(t-e)/1e3;break;case"millisecond":n=t-e}return i?n:Math.round(n)}},{key:"startOf",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"day",n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!e)return null;t=Jt.normalizeUnit(t),n&&(e=Jt.clone(e));for(var r={},i=qt[t],o=0;o<i;o++){var a=Nt[o];"quarter"!==a&&"week"!==a&&(r[a]="day"===a?1:0)}if("quarter"===t)r.month=3*(Jt.get(e,"quarter")-1);else if("week"===t){var s=e.getDay()-Jt.weekStartDay;r.day=e.getDate()-s}return Jt.set(e,r)}},{key:"endOf",value:function(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+1)}},{key:"clone",value:function(e){return new Date(e.getTime())}},{key:"clearTime",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Jt.startOf(e,"day",t)}},{key:"midnight",value:function(e,t){var n=Jt.clearTime(e);return t&&n<e&&(n=Jt.add(n,1,"d")),n}},{key:"getTimeOfDay",value:function(e){return e.getHours()*_t.hour.millisecond+e.getMinutes()*_t.minute.millisecond+e.getSeconds()*_t.second.millisecond+e.getMilliseconds()}},{key:"set",value:function(e,t,n){if(!t)return e;if("string"==typeof t)switch(Jt.normalizeUnit(t)){case"millisecond":(0!==n||e.getMilliseconds()>0)&&e.setMilliseconds(n);break;case"second":(0!==n||e.getSeconds()>0)&&e.setSeconds(n);break;case"minute":(0!==n||e.getMinutes()>0)&&e.setMinutes(n);break;case"hour":e.setHours(n);break;case"day":case"date":e.setDate(n);break;case"week":throw new Error("week not implemented");case"month":e.setMonth(n);break;case"quarter":e.setDate(1),e.setMonth(3*(n-1));break;case"year":e.setFullYear(n)}else Object.entries(t).sort((function(e,t){return qt[e[0]]-qt[t[0]]})).forEach((function(t){var n=ye()(t,2),r=n[0],i=n[1];Jt.set(e,r,i)}));return e}},{key:"setDateToMidday",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return Jt.set(Jt.clearTime(e,t),"hour",12)}},{key:"constrain",value:function(e,t,n){return null!=t&&(e=Jt.max(e,t)),null==n?e:Jt.min(e,n)}},{key:"getTime",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return e instanceof Date&&(r=e.getMilliseconds(),n=e.getSeconds(),t=e.getMinutes(),e=e.getHours()),new Date(2020,0,1,e,t,n,r)}},{key:"copyTimeValues",value:function(e,t){return e.setHours(t.getHours()),e.setMinutes(t.getMinutes()),e.setSeconds(t.getSeconds()),e.setMilliseconds(t.getMilliseconds()),e}},{key:"isDST",value:function(e){var t=e.getFullYear(),n=new Date(t,0,1),r=new Date(t,6,1);return e.getTimezoneOffset()<Math.max(n.getTimezoneOffset(),r.getTimezoneOffset())}},{key:"isBefore",value:function(e,t){return e<t}},{key:"isAfter",value:function(e,t){return e>t}},{key:"isEqual",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return null===n?e&&t&&e.getTime()===t.getTime():Jt.startOf(e,n)-Jt.startOf(t,n)==0}},{key:"compare",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return n&&(e=Jt.startOf(e,n),t=Jt.startOf(t,n)),Jt.isBefore(e,t)?-1:Jt.isAfter(e,t)?1:0}},{key:"isStartOf",value:function(e,t){return Jt.isEqual(e,Jt.startOf(e,t))}},{key:"betweenLesser",value:function(e,t,n){return t.getTime()<=e.getTime()&&e.getTime()<n.getTime()}},{key:"betweenLesserEqual",value:function(e,t,n){return t.getTime()<=e.getTime()&&e.getTime()<=n.getTime()}},{key:"intersectSpans",value:function(e,t,n,r){return Jt.betweenLesser(e,n,r)||Jt.betweenLesser(n,e,t)}},{key:"compareUnits",value:function(e,t){return Math.sign(qt[e]-qt[t])}},{key:"timeSpanContains",value:function(e,t,n,r){return n-e>=0&&t-r>=0}},{key:"get",value:function(e,t){switch(Jt.normalizeUnit(t)){case"millisecond":return e.getMilliseconds();case"second":return e.getSeconds();case"minute":return e.getMinutes();case"hour":return e.getHours();case"date":case"day":return e.getDate();case"week":return Tt.W(e);case"month":return e.getMonth();case"quarter":return Math.floor(e.getMonth()/3)+1;case"year":return e.getFullYear()}return null}},{key:"daysInMonth",value:function(e){var t=Jt.clone(e);return t.setDate(1),t.setMonth(e.getMonth()+1),t.setDate(0),t.getDate()}},{key:"getFirstDateOfMonth",value:function(e){return new Date(e.getFullYear(),e.getMonth(),1)}},{key:"getLastDateOfMonth",value:function(e){return new Date(e.getFullYear(),e.getMonth()+1,0)}},{key:"min",value:function(e,t){return e.getTime()<t.getTime()?e:t}},{key:"max",value:function(e,t){return e.getTime()>t.getTime()?e:t}},{key:"getNext",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:Jt.weekStartDay;if("week"===t){var i=Jt.clone(e),o=i.getDay();return i=Jt.startOf(i,"day"),(i=Jt.add(i,r-o+7*(n-(r<=o?0:1)),"day")).getDay()!==r&&Jt.add(i,1,"hour"),i}return Jt.startOf(Jt.add(e,n,t),t)}},{key:"isValidDate",value:function(e){return Jt.isDate(e)&&!isNaN(e)}},{key:"isDate",value:function(e){return e&&vt.call(e)===pt}},{key:"getStartOfNextDay",value:function(e,t,n){var r=Jt.add(n?e:Jt.clearTime(e,t),1,"day");if(r.getDate()===e.getDate()){var i=Jt.add(Jt.clearTime(e,t),2,"day").getTimezoneOffset(),o=e.getTimezoneOffset();r=Jt.add(r,o-i,"minute")}return r}},{key:"getEndOfPreviousDay",value:function(e,t){var n=t?e:Jt.clearTime(e,!0);return n-e?n:Jt.add(n,-1,"day")}},{key:"getWeekNumber",value:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:n.weekStartDay,i=new Date(e.getFullYear(),0,1),o=new Date(e.getFullYear(),11,31),a=Ct(i.getDay()-r),s=Ct(o.getDay()-r),u=wt(e,i);if(t=a<4?Math.floor((u+a-1)/7)+1:Math.floor((u+a-1)/7)){var c=e.getFullYear();return 53===t&&s<3&&(c++,t=1),[c,t]}var l=n.getWeekNumber(new Date(e.getFullYear()-1,11,31))[1];return[e.getFullYear()-1,l]}},{key:"formatCount",value:function(e,t){return t=Jt.normalizeUnit(t),1!==e&&(t+="s"),e+" "+t}},{key:"getUnitToBaseUnitRatio",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return(e=Jt.normalizeUnit(e))===(t=Jt.normalizeUnit(t))?1:_t[e]&&_t[e][t]&&(n||_t[e][t]>0)?1/Jt.as(t,1,e):_t[t]&&_t[t][e]&&(n||_t[t][e]>0)?Jt.as(e,1,t):-1}},{key:"getMeasuringUnit",value:function(e){return"week"===e?"day":e}},{key:"getShortNameOfUnit",value:function(e){return e=Jt.parseTimeUnit(e),Jt.unitLookup[e].abbrev}},{key:"getLocalizedNameOfUnit",value:function(e,t){return e=Jt.normalizeUnit(e),e=Jt.parseTimeUnit(e),Jt.unitLookup[e][t?"plural":"single"]}},{key:"normalizeUnit",value:function(e){if(!e)return null;var t=e.toLowerCase();return"date"===t||Nt.includes(t)?t:Bt[e]||Bt[t]}},{key:"getUnitByName",value:function(e){return Jt.normalizeUnit(e)||Jt.normalizeUnit(Jt.parseTimeUnit(e))}},{key:"getDurationInUnit",value:function(e,t,n,r){return Jt.diff(e,t,n,r)}},{key:"doesUnitsAlign",value:function(e,t){return!(e!==t&&"week"===t)}},{key:"getSmallerUnit",value:function(e){return Nt[qt[Jt.normalizeUnit(e)]-1]||null}},{key:"getLargerUnit",value:function(e){return Nt[qt[Jt.normalizeUnit(e)]+1]||null}},{key:"round",value:function(e,t,n){return Jt.snap("round",e,t,n)}},{key:"floor",value:function(e,t,n){return Jt.snap("floor",e,t,n)}},{key:"ceil",value:function(e,t,n){return Jt.snap("ceil",e,t,n)}},{key:"snap",value:function(e,t,n,r){var i=Kt[e];if("string"==typeof n){switch((n=Jt.parseDuration(n)).unit){case"week":var o=Jt.weekStartDay,a=t.getDay();return r=Jt.add(Jt.clearTime(t),a>=o?o-a:-(a-o+7),"day"),Jt[e](t,"".concat(7*n.magnitude," days"),r);case"month":var s;return t=Jt.asMonths(t),s=r?t+i(t-(r=Jt.asMonths(r)),n.magnitude):i(t,n.magnitude),Jt.monthsToDate(s);case"quarter":return Jt[e](t,"".concat(3*n.magnitude," months"),r);case"year":return Jt[e](t,"".concat(12*n.magnitude," months"),r)}n=Jt.as("ms",n.magnitude,n.unit)}if(r){var u=Jt.as("ms",r.getTimezoneOffset()-t.getTimezoneOffset(),"ms");return new Date(r.valueOf()+i(Jt.diff(r,t,"ms")+u,n))}var c=60*t.getTimezoneOffset()*1e3;return new Date(i(t.valueOf()-c,n)+c)}},{key:"parseDuration",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=t?Ht:$t,i=r.exec(e);if(null==e||!i)return null;var o=Gt(i[1]),a=Jt.parseTimeUnit(i[2])||n;return a?{magnitude:o,unit:a}:null}},{key:"parseTimeUnit",value:function(e){var t=null==e?null:Jt.durationRegEx.exec(e.toLowerCase());if(!t)return null;for(var n=0;n<Nt.length;n++)if(t[n+1])return Nt[n]}},{key:"getGMTOffset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date;if(e){var t=e.getTimezoneOffset();return t?(t>0?"-":"+")+Math.abs(Math.trunc(t/60)).toString().padStart(2,"0")+":"+Math.abs(t%60).toString().padStart(2,"0"):"Z"}}},{key:"fillDayNames",value:function(){var e=new Date("2000-01-01T12:00:00"),t=Jt._dayNames||[],n=Jt._dayShortNames||[];t.length=0,n.length=0;for(var r=2;r<9;r++)e.setDate(r),t.push(Jt.format(e,"dddd")),n.push(Jt.format(e,"ddd"));Jt._dayNames=t,Jt._dayShortNames=n}},{key:"getDayNames",value:function(){return Jt._dayNames}},{key:"getDayName",value:function(e){return Jt._dayNames[e]}},{key:"getDayShortNames",value:function(){return Jt._dayShortNames}},{key:"getDayShortName",value:function(e){return Jt._dayShortNames[e]}},{key:"fillMonthNames",value:function(){var e=new Date("2000-01-15T12:00:00"),t=Jt._monthNames||[],n=Jt._monthShortNames||[];t.length=0,n.length=0;for(var r=0;r<12;r++)e.setMonth(r),t.push(Jt.format(e,"MMMM")),n.push(Jt.format(e,"MMM"));Jt._monthNames=t,Jt._monthShortNames=n}},{key:"getMonthShortNames",value:function(){return Jt._monthShortNames}},{key:"getMonthShortName",value:function(e){return Jt._monthShortNames[e]}},{key:"getMonthNames",value:function(){return Jt._monthNames}},{key:"getMonthName",value:function(e){return Jt._monthNames[e]}},{key:"setupDurationRegEx",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=this,r={},i="",o=0;o<t.length;o++){var a=t[o],s=e[o];s.canonicalUnitName=Nt[o],r[s.single]=r[s.single.toUpperCase()]=r[s.canonicalUnitName]=r[s.canonicalUnitName.toUpperCase()]=s,i+="".concat(o?"|":"","(");for(var u=0;u<a.length;u++)i+="".concat(a[u],"|");if("en-US"!==(St=n.localize("L{locale}")||"en-US"))for(var c=Vt[o],l=0;l<c.length;l++)i+="".concat(c[l],"|");i+="".concat(s.single,"|").concat(s.plural,"|").concat(s.canonicalUnitName,"|").concat(s.canonicalUnitName,"s)")}n.unitLookup=r,n.durationRegEx=new RegExp("^(?:".concat(i,")$"))}},{key:"applyLocale",value:function(){var e=this,t=e.localize("L{unitAbbreviations}")||[],n=e.unitNames=e.localize("L{unitNames}");"unitNames"!==n&&(St=e.localize("L{locale}")||"en-US",Dt="en-US"===St?gt:e.localize("L{ordinalSuffix}")||Dt,Rt={},Et={},xt={},Jt.setupDurationRegEx(n,t),Jt.fillDayNames(),Jt.fillMonthNames())}},{key:"$name",get:function(){return"DateHelper"}},{key:"defaultFormat",set:function(e){Jt._defaultFormat=e},get:function(){return Jt._defaultFormat||"YYYY-MM-DDTHH:mm:ssZ"}},{key:"defaultParseFormat",set:function(e){this._defaultParseFormat=e},get:function(){return this._defaultParseFormat||this._defaultFormat||"YYYY-MM-DDTHH:mm:ss.SSSZ"}},{key:"weekStartDay",get:function(){return this.localize("L{weekStartDay}")||0}},{key:"locale",set:function(e){St=e},get:function(){return St}}]),n}(lt()),Jt=Zt;function Qt(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return en(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return en(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function en(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function tn(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Jt.useIntlFormat=kt,rt.on({locale:"applyLocale",prio:1e3,thisObj:Jt}),rt.locale&&Jt.applyLocale(),Zt._$name="DateHelper";var nn=Object.prototype.hasOwnProperty,rn=function(e){var t=l()(e);if("object"===t){if(null===e)return"null";if("[object Date]"===Object.prototype.toString.call(e))return"date"}return t},on="1.01"===1.005.toFixed(2)?null:function(e,t){var n=e.toString().split("."),r=+(n[1]?n.join(".")+"1":n[0]);return e.toFixed.call(r,t)},an=function(e){fe()(n,e);var t=tn(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"transformArrayToNamedObject",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ref",n={};return e.forEach((function(e,r){var i=null!=e[t]&&e[t].toString().length?e[t]:r;n[i]=e})),n}},{key:"transformNamedObjectToArray",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"ref";return Object.keys(e).filter((function(t){return e[t]})).map((function(n){var r=e[n];return r[t]=n,r}))}},{key:"isEqual",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(null===e&&null!==t||void 0===e&&void 0!==t||null===t&&null!==e||void 0===t&&void 0!==e)return!1;if(null==e&&null==t)return!0;if(e===t)return!0;var r=l()(e),i=l()(t);if(r===i){switch(r){case"number":case"string":case"boolean":return e===t}switch(!0){case e instanceof Date&&t instanceof Date:return e.getTime()===t.getTime();case Array.isArray(e)&&Array.isArray(t):return e.length===t.length&&e.every((function(e,r){return sn.isEqual(e,t[r],n)}));case"object"===r&&e.constructor.prototype===t.constructor.prototype:return n?sn.isDeeplyEqual(e,t,n):JSON.stringify(e)===JSON.stringify(t)}}return String(e)===String(t)}},{key:"isDeeplyEqual",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(e===t)return!0;if(!e||!t)return!1;var r=sn.keys(e,n.ignore),i=sn.keys(t,n.ignore);if(r.length!==i.length)return!1;for(var o=0;o<r.length;o++){var a=r[o],s=i[o];if(a!==s)return!1;var u=e[a],c=t[s];if(!n.shouldEvaluate||!1!==n.shouldEvaluate(a,{value:u,object:e},{value:c,object:t})){if(n.evaluate){var l=n.evaluate(a,{value:u,object:e},{value:c,object:t});if(!1===l)return!1;if(!0===l)continue}if(!sn.isEqual(u,c,n))return!1}}return!0}},{key:"isPartial",value:function(e,t){return e=String(e).toLowerCase(),t=String(t).toLowerCase(),-1!=e.indexOf(t)}},{key:"isLessThan",value:function(e,t){return e instanceof Date&&t instanceof Date?Zt.isBefore(e,t):e<t}},{key:"isMoreThan",value:function(e,t){return e instanceof Date&&t instanceof Date?Zt.isAfter(e,t):e>t}},{key:"fork",value:function(e){var t,n,r;if(e&&e.constructor===Object)for(n in t=Object.setPrototypeOf({},e),e)(r=e[n])&&(r.constructor===Object?t[n]=sn.fork(r):r instanceof Array&&(t[n]=r.slice()));else t=e;return t}},{key:"copyProperties",value:function(e,t,n){var r,i;for(i=0;i<n.length;i++)(r=n[i])in t&&(e[r]=t[r]);return e}},{key:"copyPropertiesIf",value:function(e,t,n){if(t){var r,i=Qt(n);try{for(i.s();!(r=i.n()).done;){var o=r.value;o in e||(e[o]=t[o])}}catch(e){i.e(e)}finally{i.f()}}return e}},{key:"keys",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=[];for(var r in e)t&&t[r]||n.push(r);return n}},{key:"allKeys",value:function(e){var t=[];for(var n in e)t.push(n);return t}},{key:"pathExists",value:function(e,t){return t.split(".").every((function(t){return t in e&&(e=e[t],!0)}))}},{key:"pathifyKeys",value:function(e){var t={};for(var n in e)if(Object.hasOwnProperty.call(e,n))if(e[n]instanceof Object){var r=this.pathifyKeys(e[n]);for(var i in r)t["".concat(n,".").concat(i)]=r[i]}else t[n]=e[n];return t}},{key:"deletePath",value:function(e,t){t.split(".").reduce((function(e,t,n,r){if(null==e)return null;if(Object.hasOwnProperty.call(e,t)){if(n!==r.length-1)return e[t];delete e[t]}}),e)}},{key:"coerce",value:function(e,t){var n=rn(e),r=rn(t),i="string"==typeof e;if(n!==r)switch(r){case"string":return String(e);case"number":return Number(e);case"boolean":return!(i&&(!e||"false"===e||"0"===e))&&Boolean(e);case"null":return!(!i||e&&"null"!==e)&&null;case"undefined":return!(!i||e&&"undefined"!==e)&&void 0;case"date":return i&&isNaN(e)?Zt.parse(e):Date(Number(e))}return e}},{key:"wrapProperty",value:function(e,t,n,r){for(var i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],o={},a=Object.getPrototypeOf(e),s=Object.getOwnPropertyDescriptor(a,t);!s&&a&&i;)(a=Object.getPrototypeOf(a))&&(s=Object.getOwnPropertyDescriptor(a,t));s?(s.set?o.set=function(t){s.set.call(e,t),r&&r.call(e,s.get.call(e))}:o.set=r,s.get?o.get=function(){var t=s.get.call(e);return n&&(t=n.call(e,t)),t}:o.get=n):(o.set=function(n){e["_".concat(t)]=n,r&&r.call(e,n)},o.get=function(){var r=e["_".concat(t)];return n&&(r=n.call(e,r)),r}),Object.defineProperty(e,t,o)}},{key:"getPropertyDescriptor",value:function(e,t){for(var n=null,r=e;r&&!n&&!nn.call(r,"isBase");r=Object.getPrototypeOf(r))n=Object.getOwnPropertyDescriptor(r,t);return n}},{key:"cleanupProperties",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Object.entries(e).forEach((function(n){var r=ye()(n,2),i=r[0],o=r[1];t?void 0===o&&delete e[i]:null==o&&delete e[i]})),e}},{key:"removeAllProperties",value:function(e){return Object.keys(e).forEach((function(t){return delete e[t]})),e}},{key:"assertType",value:function(e,t,n){if(null!=e&&l()(e)!==t)throw new Error('Incorrect type "'.concat(l()(e),'" for ').concat(n,', expected "').concat(t,'"'))}},{key:"assertNumber",value:function(e,t){var n=Number(e);if("number"!=typeof e||isNaN(n))throw new Error("Incorrect type for ".concat(t,', got "').concat(e,'" (expected a Number)'))}},{key:"assertBoolean",value:function(e,t){sn.assertType(e,"boolean",t)}},{key:"toFixed",value:function(e,t){return on?on(e,t):e.toFixed(t)}},{key:"roundTo",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return Math.round(e/t)*t}},{key:"round",value:function(e,t){if(null==t)return e;var n=Math.pow(10,t);return Math.round(e*n)/n}},{key:"isPromise",value:function(e){return"function"==typeof(null==e?void 0:e.then)}}]),n}(F),sn=an;an._$name="ObjectHelper";var un=["border-top-width","border-right-width","border-bottom-width","border-left-width"],cn=["padding-top","padding-right","padding-bottom","padding-left"],ln="border-top-width",fn="border-right-width",dn="border-bottom-width",hn="border-left-width",vn="padding-top",pn="padding-right",gn="padding-bottom",yn="padding-left",mn=Object.freeze({x:0,y:0}),kn=/^([trblc])(\d*)-([trblc])(\d*)$/i,bn=/^([trblc])(\d*)$/i,wn=["top","right","bottom","left"],Cn={t:0,r:1,b:2,l:3},Sn=["b-t","l-r","t-b","r-l"],Dn=Object.freeze([0,0]),Rn=["width","height"];function xn(e){return"".concat(wn[(Cn[e.myEdge]+2)%4][0]).concat(e.myOffset,"-").concat(wn[(Cn[e.targetEdge]+2)%4][0]).concat(e.targetOffset)}var En=function(){function e(t,n,r,i){v()(this,e),an.assertNumber(t,"Rectangle.x"),an.assertNumber(n,"Rectangle.y"),an.assertNumber(r,"Rectangle.width"),an.assertNumber(i,"Rectangle.height");this._x=t,this._y=n,this._width=r,this._height=i}return g()(e,[{key:"roundPx",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:window.devicePixelRatio||1,t=this;return t._x=Cr.roundPx(t._x,e),t._y=Cr.roundPx(t._y,e),t._width=Cr.roundPx(t._width,e),t._height=Cr.roundPx(t._height,e),t}},{key:"$$name",get:function(){return this.constructor.$$name}}],[{key:"from",value:function(t,n,r){var i;if(t instanceof e)return t;if(void 0===r&&"boolean"==typeof n&&(r=n,n=null),n){var o=n,a=o.scrollLeft,s=o.scrollTop;(j.a.isEdge||j.a.isSafari)&&n===document.body&&(a=s=0),n=e.from(n).translate(-a,-s)}else n=mn;var u,c,l=t===document||t===window,f=l?new e(0,0,window.innerWidth,window.innerHeight):t.getBoundingClientRect(),d=r||l?[0,0]:[window.pageXOffset,window.pageYOffset],h=0,v=0;(j.a.isIE11||j.a.isEdge&&(null===(i=t.namespaceURI)||void 0===i?void 0:i.match(/svg/)))&&(h=(null===(u=t.dataset)||void 0===u?void 0:u.scaleX)||0,v=(null===(c=t.dataset)||void 0===c?void 0:c.scaleY)||0);return new e(f.left+d[0]-n.x+h/2,f.top+d[1]-n.y+v/2,f.width-h,f.height-v)}},{key:"fromScreen",value:function(t,n){return e.from(t,n,!0)}},{key:"inner",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.from(e,t,n);if(document.body.contains(e)){var i=Cr.getStyleValue(e,un);r.x+=parseFloat(i[hn]),r.y+=parseFloat(i[ln]),r.right-=parseFloat(i[fn]),r.bottom-=parseFloat(i[dn])}return r}},{key:"content",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.from(e,t,n);if(document.body.contains(e)){var i=Cr.getStyleValue(e,un),o=Cr.getStyleValue(e,cn);r.x+=parseFloat(i[hn])+parseFloat(o[yn]),r.y+=parseFloat(i[ln])+parseFloat(o[vn]),r.right-=parseFloat(i[fn])+parseFloat(o[pn]),r.bottom-=parseFloat(i[dn])+parseFloat(o[gn])}return r}},{key:"client",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this.content(e,t,r),o=Cr.scrollBarWidth;return o&&(e.scrollHeight>e.clientHeight&&"hidden"!==Cr.getStyleValue(e,"overflow-y")&&(n=parseFloat(Cr.getStyleValue(e,"padding-right")),i.right+=n-Math.max(n,o)),e.scrollWidth>e.clientWidth&&"hidden"!==Cr.getStyleValue(e,"overflow-x")&&(n=parseFloat(Cr.getStyleValue(e,"padding-bottom")),i.bottom+=n-Math.max(n,o))),i}},{key:"union",value:function(){var t,n=arguments.length<=0?void 0:arguments[0],r=n.x,i=n.y,o=n.right,a=n.bottom;if(arguments.length>1)for(var s=1;s<arguments.length;s++)(t=s<0||arguments.length<=s?void 0:arguments[s]).x<r&&(r=t.x),t.y<i&&(i=t.y),t.right>o&&(o=t.right),t.bottom>a&&(a=t.bottom);return new e(r,i,o-r,a-i)}},{key:"$$name",get:function(){return hasOwnProperty.call(this,"$name")&&this.$name||hasOwnProperty.call(this,"_$name")&&this._$name||this.name}}]),g()(e,[{key:"clone",value:function(){var t=this,n=new e(t.x,t.y,t.width,t.height);return n.isAlignRectangle=t.isAlignRectangle,n.minHeight=t.minHeight,n.minWidth=t.minWidth,n}},{key:"contains",value:function(t){return t instanceof e&&(t._x>=this._x&&t._y>=this._y&&t.right<=this.right&&t.bottom<=this.bottom)}},{key:"intersect",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this,o=Math.max(i.y,t.y),a=Math.min(i.right,t.right),s=Math.min(i.bottom,t.bottom),u=Math.max(i.x,t.x),c=r?s>=o&&a>=u:s>o&&a>u;return!!c&&(!!n||new e(u,o,a-u,s-o))}},{key:"equals",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=n?function(e){return Math.round(e)}:function(e){return e};return t instanceof e&&r(t.x)===r(this.x)&&r(t.y)===r(this.y)&&r(t.width)===r(this.width)&&r(t.height)===r(this.height)}},{key:"translate",value:function(e,t){return this._x+=e||0,this._y+=t||0,this}},{key:"moveTo",value:function(e,t){return null!=e&&(this._x=e),null!=t&&(this._y=t),this}},{key:"getDelta",value:function(e){return[e.x-this.x,e.y-this.y]}},{key:"adjust",value:function(e,t,n,r){var i=this;return i.x+=e,i.y+=t,i.width+=n,i.height+=r,i}},{key:"inflate",value:function(e){return this.adjust(-e,-e,e,e)}},{key:"constrainTo",value:function(e,t){var n=this,r=n.height,i=n.y,o=n.minWidth||n.width,a=n.minHeight||n.height;if(n.height>=e.height){if(t&&a>e.height)return!1;n._y=e.y,n.height=e.height}if(n.width>=e.width){if(t&&o>e.width)return n.y=i,n.height=r,!1;n._x=e.x,n.width=e.width}var s=n.bottom-e.bottom;return s>0&&n.translate(0,-s),(s=n.right-e.right)>0&&n.translate(-s),(s=e.y-n.y)>0&&n.translate(0,s),(s=e.x-n.x)>0&&n.translate(s),n}},{key:"alignTo",value:function(t){var n,r,i,o,a=this.clone(),s=t.target,u=t.constrainTo;if(!s||s instanceof e||(s=e.from(s.element?s.element:s)),u&&!(u instanceof e)){o=u===window||u===document;var c="ignorePageScroll"in t?t.ignorePageScroll:!o;u=e.from(u.element?u.element:u,null,c),t.constrainPadding&&u.inflate(-t.constrainPadding)}var l,f=this,h=null==(l=t.offset)?Dn:"number"==typeof l?[l,l]:l,v=t.align,p=t.axisLock,g=t.anchorSize,y=t.anchorPosition,m=function(e){var t=kn.exec(e),n=parseInt(t[2]||50),r=parseInt(t[4]||50);return{myAlignmentPoint:t[1]+n,myEdge:t[1],myOffset:n,targetAlignmentPoint:t[3]+r,targetEdge:t[3],targetOffset:r,startZone:Cn[t[3]]}}(v),k=t.position||(s&&"Point"===s.$$name?s:null),b=u&&u.clone(),w=[],C=[{zone:r=m.startZone,align:v}],S=t.matchSize&&Rn[1&m.startZone],D=f[S];if(S&&p&&(a[S]=s[S]),u&&a.constrainTo(u),u&&null!=m.startZone)if(p)C.push({zone:r=(r+2)%4,align:xn(m)}),"flexible"===p&&(C.push({zone:r=(m.startZone+1)%4,align:Sn[r]}),C.push({zone:r=(r+2)%4,align:Sn[r]}));else for(var R=1;R<4;R++)C.push({zone:r=(r+1)%4,align:Sn[r]});if(y){var x,E=1&m.startZone?"y":"x";x={},ke()(x,E,y[E]),ke()(x,"edge",wn[(m.startZone+2)%4]),n=x}if(b&&s&&(b.adjust(-s.width,-s.height,s.width,s.height),s.constrainTo(b)),a.minWidth=f.minWidth,a.minHeight=f.minHeight,k)a.moveTo(k.x,k.y),u&&a.constrainTo(u);else{var T,M=g?[g[1]+h[0],g[1]+h[1]]:h,A=s.getAlignmentPoint(m.targetAlignmentPoint,M),P=a.getAlignmentPoint(m.myAlignmentPoint);if(a.translate(A[0]-P[0],A[1]-P[1]),a.intersect(s,!0))u&&a.constrainTo(u),i=m.startZone,(T=a).translate.apply(T,d()(M));else if(u&&!u.contains(a)){var I,O,F=a.clone(),L=[];n=null,w[0]=I=u.clone(),I.bottom=s.y-M[1],w[1]=I=u.clone(),I.x=s.right+M[0],w[2]=I=u.clone(),I.y=s.bottom+M[1],w[3]=I=u.clone(),I.right=s.x-M[0];for(var j=0;j<C.length;j++){if(S&&2==j&&(a[S]=D),I=w[i=C[j].zone],(a=a.alignTo({target:s,offsets:M,align:C[j].align})).constrainTo(I,!0)&&(L.push({result:a,zone:i}),!O||a.width<f.width||a.height<f.height)){a.align=C[j].align;break}if(!O||I.area>O.area){var _=a.clone();switch(i){case 0:_.moveTo(null,I.bottom-_.height);break;case 1:_.moveTo(I.left);break;case 2:_.moveTo(null,I.top);break;case 3:_.moveTo(I.right-_.width)}O={area:I.area,result:_,zone:i}}}L.length?(L.length>1&&!p&&L.sort((function(e,t){return Math.sqrt(Math.pow(F.x-e.result.x,2)+Math.pow(F.y-e.result.y,2))-Math.sqrt(Math.pow(F.x-t.result.x,2)+Math.pow(F.y-t.result.y,2))})),a=L[0].result,i=L[0].zone):(a=O.result,i=O.zone,o&&a.constrainTo(u))}else i=m.startZone;if(a.zone=i,g){if(!n){var B,H=1&i,$=H?"y":"x",N=H?"bottom":"right",V=Math.max(s[$],a[$]),z=V+(Math.min(s[N],a[N])-V)/2-g[0]/2,W=z+g[0];W>a[N]&&(z-=W-a[N]),z<a[$]&&(z+=a[$]-z),B={},ke()(B,$,z-a[$]),ke()(B,"edge",wn[(i+2)%4]),n=B}a.anchor=n}}return a}},{key:"getAlignmentPoint",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Dn,n=this,r=bn.exec(e),i=r[1].toLowerCase(),o=Math.min(Math.max(parseInt(r[2]||50),0),100)/100;switch(i){case"t":return[n.x+n.width*o,n.y-t[1]];case"r":return[n.right+t[0],n.y+n.height*o];case"b":return[n.x+n.width*o,n.bottom+t[1]];case"l":return[n.x-t[0],n.y+n.height*o];case"c":var a=n.center;return[a.x+t[0],a.y+t[1]]}}},{key:"highlight",value:function(){var e=Cr.createElement({parent:document.body,style:"position:absolute;z-index:9999999;pointer-events:none;\n                            left:".concat(this.x,"px;top:").concat(this.y,"px;width:").concat(this.width,"px;height:").concat(this.height,"px")});return Cr.highlight(e).then((function(){return e.remove()}))}},{key:"center",get:function(){return new e.Point(this.x+this.width/2,this.y+this.height/2)}},{key:"x",set:function(e){var t=e-this._x;this._x=e,this._width-=t},get:function(){return this._x}},{key:"left",set:function(e){this.x=e},get:function(){return this.x}},{key:"top",set:function(e){this.y=e},get:function(){return this.y}},{key:"y",set:function(e){var t=e-this._y;this._y=e,this._height-=t},get:function(){return this._y}},{key:"width",set:function(e){this._width=e},get:function(){return this._width}},{key:"height",set:function(e){this._height=e},get:function(){return this._height}},{key:"right",set:function(e){this._width=e-this._x},get:function(){return this._x+this._width}},{key:"bottom",set:function(e){this._height=e-this._y},get:function(){return this._y+this._height}},{key:"area",get:function(){return this.width*this.height}},{key:"minWidth",set:function(e){var t=this;isNaN(e)?t._minWidth=null:(t._minWidth=Number(e),t.isAlignRectangle||(t.width=Math.max(t.width,t._minWidth)))},get:function(){return this._minWidth}},{key:"minHeight",set:function(e){var t=this;isNaN(e)?t._minHeight=null:(t._minHeight=Number(e),t.isAlignRectangle||(t.height=Math.max(t.height,t._minHeight)))},get:function(){return this._minHeight}}]),e}();function Tn(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Mn(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Mn(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Mn(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}En._$name="Rectangle";var An=function(){function e(){v()(this,e);for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];"object"===l()(n[0])?Object.assign(this,n[0]):this.process(1,n),this[Fn]=!0}return g()(e,null,[{key:"change",value:function(t,n,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:"string";r=e.normalize(r,"object");var o=e.normalize(t,"array").filter((function(e){return!r[e]}));if(n){n=e.normalize(n,"array");for(var a=0;a<n.length;++a)o.includes(n[a])||o.push(n[a])}return e.normalize(o,i)}},{key:"normalize",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"string";e=e||"";var n,r=l()(e),i="array"===t,o="object"===t,a=!i&&!o,s="string"===r;if("object"===r&&(1===e.nodeType&&"function"==typeof e.getAttribute?(e=e.getAttribute("class"),s=!0):Array.isArray(e)||(e=an.getTruthyKeys(e))),s){if(a)return e;e=e.split(" ")}if(i)n=e;else if(a)n=e.join(" ");else{n=Object.create(null);var u,c=Tn(e);try{for(c.s();!(u=c.n()).done;)n[u.value]=!0}catch(e){c.e(e)}finally{c.f()}}return n}}]),g()(e,[{key:"clone",value:function(){return new e(this)}},{key:"contains",value:function(e){return!("string"!=typeof e||!e)&&Boolean(this[e])}},{key:"toString",value:function(){return this.length?"".concat(this.value," "):""}},{key:"toJSON",value:function(){return this.toString()}},{key:"trim",value:function(){return this.value}},{key:"isEqual",value:function(e){if("string"==typeof e&&(Ln.value=e,e=Ln),this.length===e.length){for(var t=an.getTruthyKeys(e),n=0,r=t.length;n<r;n++)if(!this[t[n]])return!1;return!0}return!1}},{key:"process",value:function(e,t){for(var n=t.length,r=0;r<n;r++)if(t[r])for(var i=t[r],o=i.values?Array.from(i.values()):i.item?Array.from(i):i.split(Pn),a=o.length,s=0;s<a;s++)o[s]&&(this[o[s]]=e);return this[Fn]=!0,this}},{key:"add",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.process(1,t)}},{key:"remove",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return this.process(0,t)}},{key:"split",value:function(){return an.getTruthyKeys(this)}},{key:"forEach",value:function(e){return an.getTruthyKeys(this).forEach(e)}},{key:"value",get:function(){var e=this;if(e[Fn]){var t=an.getTruthyKeys(e);e[On]=t.length,e[In]=t.join(" "),e[Fn]=!1}return e[In]},set:function(e){for(var t=Object.keys(this),n=t.length,r=0;r<n;r++)delete this[t[r]];e?this.process(1,[e]):this[Fn]=!0}},{key:"values",get:function(){return an.getTruthyKeys(this)}},{key:"length",get:function(){return this.value?this[On]:0}},{key:"isDomClassList",get:function(){return!0}}]),e}(),Pn=/\s+/,In=Symbol("value"),On=Symbol("length"),Fn=Symbol("dirty"),Ln=new An;function jn(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return _n(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return _n(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function _n(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}An._$name="DomClassList";var Bn,Hn,$n,Nn,Vn,zn,Wn={align:"t0-t0"},Gn=Node.ELEMENT_NODE,Yn=Node.TEXT_NODE,Un=null,qn=0,Kn=null,Xn=/[+-]?\d*\.?\d+[eE]?-?\d*/g,Zn=Xn.source,Jn=new RegExp("matrix\\((?:".concat(Zn,"),\\s?(?:").concat(Zn,"),\\s?(?:").concat(Zn,"),\\s?(?:").concat(Zn,"),\\s?(").concat(Zn,"),\\s?(").concat(Zn,")")),Qn=new RegExp("matrix3d\\((?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(?:-?\\d*),\\s?(-?\\d*),\\s?(-?\\d*)"),er=new RegExp("(?:".concat(Jn.source,")|(?:").concat(Qn.source,")")),tr=new RegExp("translate(3d|X)?\\((".concat(Zn,")px(?:,\\s?(").concat(Zn,")px)?")),nr=new RegExp("translate(3d|Y)?\\((".concat(Zn,")px(?:,\\s?(").concat(Zn,")px)?")),rr=/^[^a-z]+|[^\w:.-]+/gi,ir=/\s+/,or=/\s*;\s*/,ar=/\s*:\s*/,sr={tag:1,html:1,for:1,children:1,tooltip:1,style:1,dataset:1,parent:1,nextSibling:1,ns:1,reference:1,className:1,unmatched:1,_element:1,onlyChildren:1,elementData:1,listeners:1,compareHtml:1,syncOptions:1},ur={length:1,parentRule:1,style:1},cr={width:1,height:1,top:1,left:1,minWidth:1,minHeight:1,maxWidth:1,maxHeight:1,fontSize:1},lr={BUTTON:1,IFRAME:1,EMBED:1,INPUT:1,OBJECT:1,SELECT:1,TEXTAREA:1,HTML:j.a.isIE11?1:0,BODY:j.a.isIE11?0:1},fr=window,dr=document,hr={},vr=[],pr=Array.prototype.slice,gr=Promise.resolve(),yr=["font-size","font-size-adjust","font-style","font-weight","font-family","font-kerning","font-stretch","line-height","text-transform","text-decoration","letter-spacing","word-break"],mr=function(e){return e._hidden},kr=document.documentElement.getRootNode?function(e){return e.getRootNode()}:function(e){for(;e.parentNode;)e=e.parentNode;return e},br=function e(t){return t&&(document.body.contains(t)||(Bn=kr(t))&&function(e){return e.host&&e.host instanceof Element}(Bn)&&e(Bn.host))},wr=function(e){return e instanceof Node?e:"string"==typeof e?Sr.createElementFromTemplate(e):Sr.createElement(e)},Cr=function(){function e(){v()(this,e)}return g()(e,null,[{key:"isFocusable",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!t&&(!Sr.isVisible(e)||Sr.Widget.fromElement(e,mr)))return!1;var n=e.nodeName;return lr[n]||("A"===n||"LINK"===n)&&!!e.href||null!=e.getAttribute("tabIndex")||"true"===e.contentEditable}},{key:"isInView",value:function(e){for(var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=En.from(e),r=!0,i=n.height,o=n.width;r&&e.parentElement;)e=e.parentElement,r=(n=n.intersect(En.from(e)))&&(!t||n.height>=i&&n.width>=o);return r}},{key:"isVisible",value:function(e){for(var t,n,r,i=e.ownerDocument;e;e=(r=e).parentNode||r.host){if(e===i)return!0;if(1===e.nodeType&&(n=void 0,"none"===(n=(t=e).ownerDocument.defaultView.getComputedStyle(t)).getPropertyValue("display")||"hidden"===n.getPropertyValue("visibility")))return!1}return!1}},{key:"roundPx",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window.devicePixelRatio||1,n=1/t;return Math.round(e/n)*n}},{key:"isCustomElement",value:function(e){return e&&e.shadowRoot}},{key:"elementFromPoint",value:function(e,t){var n=document.elementFromPoint(e,t);return Sr.isCustomElement(n)&&(n=n.shadowRoot.elementFromPoint(e,t)||n),n}},{key:"getId",value:function(e){return e.id||(e.id="b-element-"+ ++qn)}},{key:"getCommonAncestor",value:function(e,t){if(e===t)return e;for(;e&&!(null===(n=(r=e)[e.isWidget?"owns":"contains"])||void 0===n?void 0:n.call(r,t))&&e!==t;){var n,r;e=e.owner||e.parentNode}return e}},{key:"getElement",value:function(e){return e instanceof Element?e:dr.querySelector(e)}},{key:"setAttributes",value:function(e,t){var n=Sr.getElement(e);Object.entries(t).forEach((function(e){var t=ye()(e,2),r=t[0],i=t[1];return n.setAttribute(r,i)}))}},{key:"setLength",value:function(e,t,n){return 1===arguments.length?"number"==typeof e?"".concat(e,"px"):e:(e=Sr.getElement(e)).style[t]="number"==typeof n?"".concat(n,"px"):n}},{key:"getChild",value:function(e,t){if(j.a.supportsQueryScope)t=":scope>"+t;else{var n=e.id||(e.id="b-element-"+ ++qn);t="#".concat(n," > ").concat(t)}return e.querySelector(t)}},{key:"hasChild",value:function(e,t){return null!=Sr.getChild(e,t)}},{key:"children",value:function(e,t){if(">"===t[0]||t.startsWith("# "))if("#"===t[0]&&(t=t.substr(2)),j.a.supportsQueryScope)t=":scope "+t;else{var n=e.id||(e.id="b-element-"+ ++qn);t="#".concat(n," ").concat(t)}return Array.from(e.querySelectorAll(t))}},{key:"down",value:function(e,t){if(!e)return null;if(e.matches&&e.matches(t))return e;if(j.a.supportsQueryScope)t=":scope "+t;else{var n=e.id||(e.id="b-element-"+ ++qn);t="#".concat(n," ").concat(t)}return e.querySelector(t)}},{key:"isDescendant",value:function(e,t){return e.contains||(e=e.body),e.contains(t)}},{key:"getEventElement",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"target";return Sr.isElement(e)?e:e[t]}},{key:"isElement",value:function(e){return 1===(null==e?void 0:e.nodeType)&&Sr.isNode(e)}},{key:"isNode",value:function(e){return Boolean(e)&&"number"==typeof e.nodeType&&!an.isObject(e)}},{key:"forEachSelector",value:function(e,t,n){"string"==typeof e&&(n=t,t=e,e=dr),Sr.children(e,t).forEach(n)}},{key:"forEachChild",value:function(e,t){Array.from(e.children).forEach(t)}},{key:"removeEachSelector",value:function(e,t){Sr.forEachSelector(e,t,(function(e){return e.remove()}))}},{key:"removeClsGlobally",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];n.forEach((function(t){return Sr.forEachSelector(e,"."+t,(function(e){return e.classList.remove(t)}))}))}},{key:"up",value:function(e,t){return e&&e.closest(t)}},{key:"getAncestor",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=!1,o=e;for(Array.isArray(t)||(t=[t]);o=o.parentElement;){if(t.includes(o)){i=!0;break}if(r&&o===r)break;n=o}return i?n||e:null}},{key:"getParents",value:function(e){for(var t=[];e.parentElement;)t.push(e.parentElement),e=e.parentElement;return t}},{key:"makeValidId",value:function(e){return null==e?null:String(e).replace(rr,"")}},{key:"createElement",value:function(){var e,t,n,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=arguments.length>1?arguments[1]:void 0,o=i;"boolean"==typeof o?i={returnAll:o,refs:t=arguments.length<=2?void 0:arguments[2],syncIdField:n=arguments.length<=3?void 0:arguments[3]}:i&&(e=i.refOwner,t=i.refs,o=i.returnAll,n=i.syncIdField),"string"==typeof r.parent&&(r.parent=document.getElementById(r.parent)),r.syncOptions&&(n=r.syncOptions.syncIdField||n);var a,s=r.parent||r.nextSibling&&r.nextSibling.parentNode,u=r.reference;a=r.ns?dr.createElementNS(r.ns,r.tag||"svg"):dr.createElement(r.tag||"div"),null!=r.html&&(r.html instanceof DocumentFragment?a.appendChild(r.html):a.innerHTML=r.html),r.tooltip&&Sr.Widget.attachTooltip(a,r.tooltip),r.style&&Sr.applyStyle(a,r.style),r.dataset&&Object.assign(a.dataset,r.dataset),r.for&&(a.htmlFor=r.for),s&&s.insertBefore(a,r.nextSibling),e&&(a.$refOwnerId=e.id),u&&(e?(e.byRef[a.$reference=u]=a,e.attachRef(u,a,r)):(t||((i=Object.assign({},i)).refs=t={}),t[u]=a,a.setAttribute("data-reference",u))),r.elementData&&(a.elementData=r.elementData);var c=r.className||r.class;c&&a.setAttribute("class",An.normalize(c));for(var l=0,f=Object.keys(r);l<f.length;l++){var d=f[l];sr[d]||(r.ns?a.setAttribute(d,r[d]):a[d]=r[d])}return!0===o?i.returnAll=o=[a]:Array.isArray(o)&&o.push(a),r.children&&(n&&(a.syncIdMap={}),r.children.forEach((function(t){if(t)if("string"==typeof t){var o=document.createTextNode(t);e&&(o.$refOwnerId=e.id),a.appendChild(o)}else if(isNaN(t.nodeType)){t.parent=a,!t.ns&&r.ns&&(t.ns=r.ns);var s=Sr.createElement(t,i),u=t.dataset&&t.dataset[n];null!=u&&(a.syncIdMap[u]=s),delete t.parent}else a.appendChild(t)}))),a.lastDomConfig=r,r._element=a,t||o||a}},{key:"createElementFromTemplate",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:hr,r=n.array,i=n.raw,o=n.fragment;if(Sr.supportsTemplate){if((Hn||(Hn=dr.createElement("template"))).innerHTML=e,t=Hn.content,o)return t.cloneNode(!0)}else{if(($n||($n=new DOMParser)).parseFromString(e,"text/html"),t=$n.parseFromString(e,"text/html").body,o){var a=t?t.childNodes:vr;for(t=document.createDocumentFragment();a.length;)t.appendChild(a[0]);return t}t||(t={children:[],childNodes:[]})}return 1!==(t=i?t.childNodes:t.children).length||r?pr.call(t):t[0]}},{key:"insertFirst",value:function(e,t){return t&&t.nodeType!==Gn&&t.tag&&(t=Sr.createElement(t)),e.insertBefore(t,e.firstElementChild)}},{key:"insertBefore",value:function(e,t,n){return t&&t.nodeType!==Gn&&t.tag&&(t=Sr.createElement(t)),n?e.insertBefore(t,n):Sr.insertFirst(e,t)}},{key:"insertAt",value:function(e,t,n){var r=Array.from(e.children);if(n>=r.length)return Sr.append(e,t);var i=r[n];return Sr.insertBefore(e,t,i)}},{key:"append",value:function(e,t){if(t.forEach){if(Array.isArray(t)&&(t=t.map((function(e){return wr(e)}))),e.append)e.append.apply(e,d()(t));else{var n=document.createDocumentFragment();t.forEach((function(e){n.appendChild(e)})),e.appendChild(n)}return t}return e.appendChild(wr(t))}},{key:"getTranslateX",value:function(e){var t=e.style.transform,n=tr.exec(t);return n?parseInt(n[2]):(n=er.exec(t)||er.exec(Sr.getStyleValue(Sr.getElement(e),"transform")))?parseInt(n[1]||n[3]):0}},{key:"getTranslateY",value:function(e){var t=e.style.transform,n=nr.exec(t);if(n){var r=parseInt(n["Y"===n[1]?2:3]);return isNaN(r)?0:r}return(n=er.exec(t)||er.exec(Sr.getStyleValue(Sr.getElement(e),"transform")))?parseInt(n[2]||n[4]):0}},{key:"getTranslateXY",value:function(e){return[Sr.getTranslateX(e),Sr.getTranslateY(e)]}},{key:"getOffsetX",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t?e.getBoundingClientRect().left-t.getBoundingClientRect().left:e.offsetLeft}},{key:"getOffsetY",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return t?e.getBoundingClientRect().top-t.getBoundingClientRect().top:e.offsetTop}},{key:"getOffsetXY",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return[Sr.getOffsetX(e,t),Sr.getOffsetY(e,t)]}},{key:"focusWithoutScrolling",value:function(e){function t(e){e.forEach((function(e){var t=e.element,n=e.scrollLeft,r=e.scrollTop;t.scrollLeft!==n&&(t.scrollLeft=n),t.scrollTop!==r&&(t.scrollTop=r)}))}if(j.a.chromeVersion>=64||j.a.firefoxVersion>=68)e.focus({preventScroll:!0});else{var n=Sr.getParents(e).map((function(e){return{element:e,scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}}));e.focus(),j.a.isIE11?t(n):setTimeout((function(){return t(n)}),0)}}},{key:"getPageX",value:function(e){return e.getBoundingClientRect().left+fr.pageXOffset}},{key:"getPageY",value:function(e){return e.getBoundingClientRect().top+fr.pageYOffset}},{key:"getExtremalSizePX",value:function(e,t){var n=E.hyphenate(t),r=n.split("-")[1],i=Sr.getStyleValue(e,n);return i=/%/.test(i)?e.parentElement?parseInt(Sr.getStyleValue(e.parentElement,r),10):NaN:parseInt(i,10)}},{key:"setTranslateX",value:function(t,n){var r=Sr.getStyleValue(t,"transform").split(/,\s*/);n=e.roundPx(n),r.length>1?(r[r[0].startsWith("matrix3d")?12:4]=n,t.style.transform=r.join(",")):t.style.transform="translateX(".concat(n,"px)")}},{key:"setTranslateY",value:function(t,n){var r=Sr.getStyleValue(t,"transform").split(/,\s*/);n=e.roundPx(n),r.length>1?(r[r[0].startsWith("matrix3d")?13:5]=n,t.style.transform=r.join(",")+")"):t.style.transform="translateY(".concat(n,"px)")}},{key:"setTop",value:function(e,t){Sr.setLength(e,"top",t)}},{key:"setLeft",value:function(e,t){Sr.setLength(e,"left",t)}},{key:"setTranslateXY",value:function(t,n,r){if(null==n)return Sr.setTranslateY(t,r);if(null==r)return Sr.setTranslateX(t,n);n=e.roundPx(n),r=e.roundPx(r);var i=Sr.getStyleValue(t,"transform").split(/,\s*/),o=i[0].startsWith("matrix3d");i.length>1?(i[o?12:4]=n,i[o?13:5]=r,t.style.transform=i.join(",")+")"):t.style.transform="translate(".concat(n,"px, ").concat(r,"px)")}},{key:"addTranslateX",value:function(e,t){Sr.setTranslateX(e,Sr.getTranslateX(e)+t)}},{key:"addTranslateY",value:function(e,t){Sr.setTranslateY(e,Sr.getTranslateY(e)+t)}},{key:"addLeft",value:function(e,t){Sr.setLeft(e,Sr.getOffsetX(e)+t)}},{key:"addTop",value:function(e,t){Sr.setTop(e,Sr.getOffsetY(e)+t)}},{key:"alignTo",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Wn,r=arguments.length>3?arguments[3]:void 0;t=t instanceof En?t:En.from(t,!0);var i=Sr.getTranslateXY(e),o=En.from(e,!0);r&&(o.round(),t.round());var a=o.alignTo(Object.assign(n,{target:t}));Sr.setTranslateXY(e,i[0]+a.x-o.x,i[1]+a.y-o.y)}},{key:"getStyleValue",value:function(e,t,n,r){var i=n?e.style:e.ownerDocument.defaultView.getComputedStyle(e,r);if(Array.isArray(t)){var o,a={},s=jn(t);try{for(s.s();!(o=s.n()).done;){var u=o.value;a[u]=i.getPropertyValue(E.hyphenate(u))}}catch(e){s.e(e)}finally{s.f()}return a}return i.getPropertyValue(E.hyphenate(t))}},{key:"getEdgeSize",value:function(t,n,r){for(var i="border"===n?"-width":"",o={raw:{}},a=0,s=["top","right","bottom","left"];a<s.length;a++){var u=s[a];r&&!r.includes(u[0])||(o[u]=parseFloat(o.raw[u]=e.getStyleValue(t,"".concat(n,"-").concat(u).concat(i))))}return o.width=o.left+o.right,o.height=o.top+o.bottom,o}},{key:"parseStyle",value:function(e){if("string"==typeof e){var t=e.split(or);e={};for(var n=0,r=t.length;n<r;n++){var i=t[n].split(ar);e[i[0]]=i[1]}}return e||{}}},{key:"applyStyle",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("string"==typeof t)n?(t.length||e.style.cssText.length)&&(e.style.cssText=t):e.style.cssText+=t;else for(var r in n&&(e.style.cssText=""),t.style&&("string"==typeof t.style?e.style.cssText=t.style:t=Object.assign({},t.style,t)),t)ur[r]||(cr[r]&&"number"==typeof t[r]?e.style[E.hyphenate(r)]=t[r]+"px":e.style[E.hyphenate(r)]=t[r])}},{key:"getCSSText",value:function(e){if("string"==typeof e)return e;var t="";for(var n in e)ur[n]||(t+="".concat(E.hyphenate(n),":").concat(e[n],";"));return t}},{key:"addClasses",value:function(e,t){for(var n=0;n<t.length;n++)e.classList.add(t[n])}},{key:"removeClasses",value:function(e,t){for(var n=0;n<t.length;n++)e.classList.remove(t[n])}},{key:"toggleClasses",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Array.isArray(t)||(t=[t]),!0===n?Sr.addClasses(e,t):!1===n?Sr.removeClasses(e,t):t.forEach((function(t){return e.classList.toggle(t)}))}},{key:"addTemporaryClass",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:window;n>0&&(e.classList.add(t),r.setTimeout((function(){return e.classList.remove(t)}),n))}},{key:"getPropertyTransitionDuration",value:function(e,t){var n,r=window.getComputedStyle(e),i=r.transitionProperty.split(", "),o=r.transitionDuration.split(", "),a=i.indexOf(t);return-1!==a&&(n=1e3*parseFloat(o[a])),n}},{key:"highlight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:window;return e instanceof En?e.highlight():new Promise((function(n){t.setTimeout((function(){e.classList.add("b-fx-highlight"),t.setTimeout((function(){e.classList.remove("b-fx-highlight"),n()}),1e3)}),0)}))}},{key:"resetScrollBarWidth",value:function(){Un=null}},{key:"measureText",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,i=Sr.getMeasureElement(t,r);i[n?"innerHTML":"innerText"]=e;var o=i.clientWidth;return i.className="",o}},{key:"measureSize",value:function(e,t){if(!e)return 0;if("number"==typeof e)return e;if(!e.length)return 0;if(/^\d+(px)?$/.test(e))return parseInt(e);if(t){var n=Sr.getMeasureElement(t);n.innerHTML="",n.style.width=Sr.setLength(e);var r=n.offsetWidth;return n.style.width=n.className="",r}return/^\d+em$/.test(e)?14*parseInt(e):isNaN(e)?0:parseInt(e)}},{key:"getMeasureElement",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:dr.body,n=fr.getComputedStyle(e),r=t.offScreenDiv=t.offScreenDiv||Sr.createElement({parent:t,style:"position:fixed;top:-10000px;left:-10000px;visibility:hidden;contain:strict",className:"b-measure-element",children:[{style:"white-space:nowrap;display:inline-block;will-change:contents;width:auto;contain:none"}]},!0)[1];return yr.forEach((function(e){r.style[e]!==n[e]&&(r.style[e]=n[e])})),r.className=e.className,r.parentElement.parentElement!==t&&t.appendChild(r.parentElement),r}},{key:"sync",value:function(e,t){if("string"==typeof e){if(""===e)return void(t.innerHTML="");e=Sr.createElementFromTemplate(e)}return Sr.performSync(e,t),t}},{key:"performSync",value:function(e,t){return e.outerHTML!==t.outerHTML&&(Sr.syncAttributes(e,t),Sr.syncContent(e,t),Sr.syncChildren(e,t),!0)}},{key:"getSyncAttributes",value:function(e){for(var t={},n=[],r=0;r<e.attributes.length;r++){var i=e.attributes[r];if(i.specified){var o=i.name.toLowerCase();t[o]=i.value,n.push(o)}}return{attributes:t,names:n}}},{key:"syncAttributes",value:function(e,t){var n=Sr.getSyncAttributes(e),r=n.attributes,i=n.names,o=Sr.getSyncAttributes(t),a=o.attributes,s=o.names,u=i.includes("dataset"),c=i.filter((function(e){return!s.includes(e)})),f=s.filter((function(e){return!(i.includes(e)||u&&e.startsWith("data-"))})),d=i.filter((function(e){return s.includes(e)}));if(c.length>0)for(var h=0;h<c.length;h++){var v=c[h];"style"===v?Sr.applyStyle(t,r.style,!0):"dataset"===v?Object.assign(t.dataset,r.dataset):t.setAttribute(v,r[v])}if(f.length>0)for(var p=0;p<f.length;p++)t.removeAttribute(f[p]);if(d.length>0)for(var g=0;g<d.length;g++){var y=d[g];if("style"===y)Sr.applyStyle(t,r.style,!0);else if("dataset"===y)Object.assign(t.dataset,r.dataset);else if("class"!==y||!r.class.isDomClassList&&"object"!==l()(r.class))a[y]!==r[y]&&t.setAttribute(y,r[y]);else{var m=void 0;(m=r.class.isDomClassList?r.class:new An(r.class)).isEqual(a.class)||t.setAttribute("class",m)}}}},{key:"syncContent",value:function(e,t){0===e.childElementCount&&(t.innerText=e.innerText)}},{key:"setInnerText",value:function(e,t){var n=e.firstChild;n?n.data=t:e.textContent=t}},{key:"syncChildren",value:function(e,t){for(var n=pr.call(e.childNodes),r=pr.call(t.childNodes);n.length;){var i=n.shift(),o=r.shift();if(i&&i.nodeType!==Yn&&i.nodeType!==Gn)throw new Error("Source node type ".concat(i.nodeType," not supported by DomHelper.sync()"));if(o&&o.nodeType!==Yn&&o.nodeType!==Gn)throw new Error("Target node type ".concat(o.nodeType," not supported by DomHelper.sync()"));if(o)if(i.nodeType===o.nodeType)i.nodeType===Yn?o.data=i.data:i.tagName===o.tagName?this.performSync(i,o):(t.insertBefore(i,o),o.remove());else{if(i.nodeType!==Yn||o.nodeType!==Gn)throw new Error("Currently no support for transforming nodeType");t.innerText=i.data.trim()}else t.appendChild(i)}r.forEach((function(e){e.remove()}))}},{key:"syncClassList",value:function(e,t){var n,r=e.classList,i="string"==typeof t,o=i?t.trim().split(ir):Array.isArray(t)?t:an.getTruthyKeys(t),a=o.length,s=r.length!==a;for(n=0;!s&&n<a;n++)s=!r.contains(o[n]);s&&(e.className=i?t:o.join(" "))}},{key:"setTheme",value:function(t){t=t.toLowerCase();var n=Sr.themeInfo.name.toLowerCase(),r=document.head.querySelector("#bryntum-theme:not([data-loading])")||document.head.querySelector('[href$="'.concat(n,'.css"]:not([data-loading])'));if(e.removeEachSelector(document.head,"#bryntum-theme[data-loading]"),!r||!r.href.includes("".concat(n,".css")))throw new Error("Theme link for ".concat(n," not found"));return r.href.includes("".concat(t,".css"))?gr:new Promise((function(e,n){var i=document.createElement("link"),o=r.nextSibling,a=Sr.themeInfo.name.toLowerCase(),s={theme:t,prev:a};i.rel="stylesheet",i.id="bryntum-theme",i.addEventListener("load",(function(){delete i.dataset.loading,Kn=null,r.remove(),window.bryntum.GlobalEvents.trigger("theme",s),e(s)})),i.addEventListener("error",(function(e){delete i.dataset.loading,n(e)})),i.dataset.loading="true",i.href=r.href.replace(a,t),o.parentNode.insertBefore(i,o)}))}},{key:"isOrphaned",value:function(e){return e!==document.body&&e!==document.documentElement&&e.nodeType===Node.ELEMENT_NODE&&null===e.offsetParent}},{key:"activeElement",get:function(){for(var e=document.activeElement;e.shadowRoot;)e=e.shadowRoot.activeElement;return e}},{key:"scrollBarWidth",get:function(){if(null===Un&&dr.body){var e=Sr.createElement({parent:dr.body,style:"position:absolute;top:-999px;width:100px;height:100px;overflow:scroll"});Un=e.offsetWidth-e.clientWidth,e.remove()}return Un}},{key:"scrollBarPadElement",get:function(){return{className:"b-yscroll-pad",children:[{className:"b-yscroll-pad-sizer"}]}}},{key:"themeInfo",get:function(){if(!Kn){var e=Sr.createElement({parent:document.body,className:"b-theme-info"}),t=Sr.getStyleValue(e,"content",!1,":before");if(t)try{Kn=JSON.parse(t.replace(/^["']|["']$|\\/g,""))}catch(e){Kn=null}e.remove()}return Kn}}]),e}(),Sr=Cr,Dr=function(){return Sr.isTouchEvent=!1},Rr=function(){Sr.isTouchEvent=!0,clearTimeout(Nn),Nn=setTimeout(Dr,400)};if(dr.addEventListener("touchstart",Rr,!0),dr.addEventListener("touchend",Rr,!0),Sr.supportsTemplate="content"in dr.createElement("template"),Sr.elementPropKey="$bryntum",Sr.numberRe=Xn,!("children"in Node.prototype)){var xr=function(e){return 1===e.nodeType};Object.defineProperty(Node.prototype,"children",{get:function(){return Array.prototype.filter.call(this.childNodes,xr)}})}(Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector||Element.prototype.oMatchesSelector||Element.prototype.webkitMatchesSelector||function(e){for(var t=(this.document||this.ownerDocument).querySelectorAll(e),n=t.length;--n>=0&&t.item(n)!==this;);return n>-1}),fr.Element&&!Element.prototype.closest?Node.prototype.closest=Element.prototype.closest=function(e){var t=this;if(!dr.documentElement.contains(t))return null;do{if(t.matches(e))return t;t=t.parentElement||t.parentNode}while(null!==t&&1===t.nodeType);return null}:Node.prototype.closest=function(e){var t;return null===(t=this.parentNode)||void 0===t?void 0:t.closest(e)},[Element.prototype,CharacterData.prototype,DocumentType.prototype].forEach((function(e){Object.prototype.hasOwnProperty.call(e,"remove")||Object.defineProperty(e,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode&&this.parentNode.removeChild(this)}})})),SVGElement.prototype.contains||(SVGElement.prototype.contains=function(e){do{if(this===e)return!0;e=e.parentNode}while(e);return!1}),"function"!=typeof fr.CustomEvent)&&(fr.CustomEvent=zn=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{bubbles:!1,cancelable:!1,detail:void 0};return(Vn=dr.createEvent("CustomEvent")).initCustomEvent(e,t.bubbles,t.cancelable,t.detail),Vn},zn.prototype=fr.Event.prototype,fr.MouseEvent=zn=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{bubbles:!1,cancelable:!1,detail:void 0};return(Vn=dr.createEvent("MouseEvents")).initMouseEvent(e,t.bubbles,t.cancelable,dr.defaultView||fr,t.detail,t.screenX,t.screenY,t.clientX,t.clientY,!1,!1,!1,!1,0,document),Vn},zn.prototype=fr.Event.prototype,fr.KeyboardEvent=zn=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{bubbles:!1,cancelable:!1,detail:void 0},n="".concat(t.shiftKey?"Shift ":"").concat(t.ctrlKey?"Control":"");return(Vn=dr.createEvent("KeyboardEvent")).initKeyboardEvent(e,t.bubbles,t.cancelable,dr.defaultView||fr,t.key,t.location,n,!1,""),Vn},zn.prototype=fr.Event.prototype);if(!Object.getOwnPropertyDescriptor(SVGElement.prototype,"dataset")||!Object.getOwnPropertyDescriptor(SVGElement.prototype,"dataset").get){var Er={enumerable:!0,get:function(){var e,t,n,r,i,o={},a=this.attributes,s=a.length,u=function(e){return e.charAt(1).toUpperCase()},c=function(){return this},l=function(e,t){return void 0!==t?this.setAttribute(e,t):this.removeAttribute(e)};for(e=0;e<s;e++)(i=a[e])&&i.name&&/^data-\w[\w-]*$/.test(i.name)&&(t=i.value,r=(n=i.name).substr(5).replace(/-./g,u),Object.defineProperty(o,r,{enumerable:this.enumerable,get:c.bind(t||""),set:l.bind(this,n)}));return o}};Object.defineProperty(SVGElement.prototype,"dataset",Er)}var Tr=DOMTokenList.prototype.add,Mr=DOMTokenList.prototype.remove;function Ar(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}DOMTokenList.prototype.add=function(e){var t=this;Array.isArray(e)?e.forEach((function(e){return Tr.call(t,e)})):Tr.call.apply(Tr,[this].concat(Array.prototype.slice.call(arguments)))},DOMTokenList.prototype.remove=function(e){var t=this;Array.isArray(e)?e.forEach((function(e){return Mr.call(t,e)})):Mr.call.apply(Mr,[this].concat(Array.prototype.slice.call(arguments)))},window.addEventListener("resize",(function(){return Un=null})),Cr._$name="DomHelper";var Pr,Ir,Or,Fr=(window.bryntum||(window.bryntum={})).GlobalEvents=new(function(e){fe()(n,e);var t=Ar(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"suspendFocusEvents",value:function(){jr=!0}},{key:"resumeFocusEvents",value:function(){jr=!1}},{key:"lastInteractionType",get:function(){return Ir}}]),n}(ue.mixin(Ge))),Lr=function(e){return e.isVisible&&e.isTopModal},jr=!1;function _r(e,t,n,r,i,o,a){var s=new CustomEvent(e,a);return Object.defineProperty(s,"_target",{get:function(){return t}}),Object.defineProperty(s,"relatedTarget",{get:function(){return n}}),s.fromWidget=r,s.toWidget=i,s.backwards=o,s}function Br(e,t){return Cr.getCommonAncestor(e,t)}function Hr(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document,t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r={element:e,touchstart:function(e){Pr=Pr||1!==e.changedTouches.length?null:e.changedTouches[0]},touchend:{handler:function(e){Pr&&(Pr.identifier===t.contextMenuTouchId?(e.stopImmediatePropagation(),e.preventDefault()):1===e.changedTouches.length&&e.changedTouches[0].identifier===Pr.identifier&&Fr.trigger("globaltap",{event:e}),Pr=null)},passive:!1},mousedown:{handler:function(e){Ir="mouse",Pr||Fr.trigger("globaltap",{event:e})},passive:!1},keydown:function(){Ir="key"},keypress:function(){Ir="key"},focusin:function(e){if(Fr.Widget.floatRoot.scrollTop=Fr.Widget.floatRoot.scrollLeft=0,!jr){var t=e.relatedTarget?e.relatedTarget instanceof HTMLElement?e.relatedTarget:document.body:null,n=e.target||document.body,r=Fr.Widget.fromElement(t),i=Fr.Widget.fromElement(n),o=Br(r,i),a=!!(t&&4&n.compareDocumentPosition(t)),s=Fr.Widget.query(Lr),u=Cr.activeElement;if(!s||i&&s.owns(i)){for(var c=_r("focusout",t,e.target,r,i,a),l=r;l&&l!==o;l=l.owner)if(!l.isDestroying&&l.onFocusOut&&(l.onFocusOut(c),e.target&&u!==Cr.activeElement))return;if(o&&e.target===o.element)Cr.activeElement===n&&o.focusElement&&o.focusElement!==o.element&&o.setTimeout((function(){return o.focus&&o.focus()}),0);else{c=_r("focusin",n,t,r,i,a);for(var f=i;f&&f!==o;f=f.owner)f.isDestroying||f.onFocusIn&&f.onFocusIn(c)}var d=Br(t&&1===t.nodeType?t:null,n)||n.parentNode;c=_r("focusmove",n,t,r,i,a,{bubbles:!0}),d.dispatchEvent(c)}else s.focus()}},focusout:function(e){if(!(jr||e.relatedTarget&&Fr.Widget.fromElement(e.relatedTarget))){var t=e.relatedTarget&&e.relatedTarget instanceof HTMLElement?e.relatedTarget:null;r.focusin({target:t,relatedTarget:e.target})}},capture:!0,passive:!0};n&&Or&&Or(),Or=t.on(r)}var $r=Fr,Nr=n(6),Vr=n.n(Nr),zr=n(8),Wr=n.n(zr);function Gr(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Yr(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Yr(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Yr(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ur(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var qr=function(e){fe()(n,e);var t=Ur(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"getFocusRevertTarget",value:function(){var e;return null===(e=this.client)||void 0===e?void 0:e.getFocusRevertTarget()}},{key:"construct",value:function(){for(var e=this,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];var o,a=r[0],s=r[1];1===r.length?an.isObject(a)&&(a=(s=a).client):delete(s=an.assign({},s)).client,e.client=a,we()(pe()(n.prototype),"construct",this).call(this,s),e.applyPluginConfig(a),(o=e.clientListeners)&&((o=an.assign({},o)).thisObj=e,a.on(o))}},{key:"applyPluginConfig",value:function(e){var t=this,n=t.pluginConfig||t.constructor.pluginConfig;if(n){var r=n.assign,i=n.chain,o=n.after,a=n.before,s=n.override;r&&t.applyAssign(e,r),(i||o)&&t.applyChain(e,i||o),a&&t.applyChain(e,a,!1),s&&t.applyOverride(e,s)}}},{key:"applyAssign",value:function(e,t){var n=this;t.forEach((function(t){return n.assign(e,t)}))}},{key:"applyChain",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(Array.isArray(t)){var r,i=Gr(t);try{for(i.s();!(r=i.n()).done;){var o=r.value;this.chain(e,o,o,n)}}catch(e){i.e(e)}finally{i.f()}}else for(var a in t)this.chain(e,a,t[a],n)}},{key:"applyOverride",value:function(e,t){var n=this;n.overridden||(n.overridden={}),t.forEach((function(t){if(!n[t])throw new Error("Trying to chain fn ".concat(e.$$name,"#").concat(t,", but plugin fn ").concat(n.$$name,"#").concat(t," does not exist"));"function"==typeof e[t]&&(n.overridden[t]=e[t].bind(e)),e[t]=n[t].bind(n)}))}},{key:"assign",value:function(e,t){var n=this,r=function(e,t){var n=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(e),t);return n&&(n.get||n.set)?n:null}(n,t);r?Object.defineProperty(e,t,{configurable:!0,enumerable:!0,get:r.get&&r.get.bind(n),set:r.set&&r.set.bind(n)}):e[t]=n[t].bind(n)}},{key:"chain",value:function(e,t,n){var r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],i=this,o=e.pluginFunctionChain||(e.pluginFunctionChain={}),a=i[n]&&i[n].bind(i),s=i.functionChainRunner;if(!a)throw new Error("Trying to chain fn ".concat(e.$$name,"#").concat(n,", but plugin fn ").concat(i.$$name,"#").concat(n," does not exist"));if(!o[t]){var u=e[t];u&&((u=u.bind(e)).$this=e),o[t]=u?[u]:[],e[t]=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return s(o[t],n)}}a.$this=i,o[t][r?"push":"unshift"](a)}},{key:"functionChainRunner",value:function(e,t){var n,r,i;for(r=0;r<e.length&&((n=e[r]).$this.isDestroyed||!1!==(i=n.apply(void 0,d()(t))));r++);return i}},{key:"doDisable",value:function(e){var t,n,r=this,i=r.constructor,o="featureClass"in i?i.featureClass:"b-".concat(i.$$name.toLowerCase());o&&(null===(t=r.client)||void 0===t||null===(n=t.element)||void 0===n||n.classList[e?"remove":"add"](o));r.isConfiguring||(e?r.trigger("disable"):r.trigger("enable"))}},{key:"updateDisabled",value:function(e){this.doDisable(e)}},{key:"throwOverrideIsMissing",value:function(e){throw new Error("Trying to override fn ".concat(e.plugIntoName,"#").concat(e.fnName,", but plugin fn ").concat(e.pluginName,"#").concat(e.fnName," does not exist"))}},{key:"client",get:function(){return this._client},set:function(e){this._client=e}}],[{key:"initPlugins",value:function(e){for(var t=e.plugins||(e.plugins={}),n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];for(var o=0,a=r;o<a.length;o++){var s=a[o];t[s.$$name]=new s(e)}}},{key:"configurable",get:function(){return{clientListeners:null,disabled:!1}}}]),n}(ue.mixin(Ge,lt));function Kr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}qr._$name="InstancePlugin";var Xr=function(e){return function(e){fe()(n,e);var t=Kr(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"initPlugins",value:function(){}},{key:"addPlugins",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];qr.initPlugins.apply(qr,[this].concat(t))}},{key:"hasPlugin",value:function(e){return null!=this.getPlugin(e)}},{key:"getPlugin",value:function(e){return"function"==typeof e&&(e=e.$$name),this.plugins&&this.plugins[e]}},{key:"plugins",get:function(){return this._plugins||(this._plugins={}),this._plugins},set:function(e){e&&(Array.isArray(e)||(e=[e]),qr.initPlugins.apply(qr,[this].concat(d()(e)))),this.initPlugins()}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"Pluggable"}}]),n}(e||ue)};function Zr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var Jr=function(e){return function(e){fe()(n,e);var t=Zr(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"state",get:function(){return this._state=this.getState(),this._state},set:function(e){this._state=e,this.applyState(e)}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"State"}}]),n}(e||ue)};function Qr(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var ei=Object.create(null),ti={string:1,number:1},ni=function(e){return function(e){fe()(n,e);var t=Qr(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"doDestroy",value:function(){this.constructor.unregisterInstance(this),we()(pe()(n.prototype),"doDestroy",this).call(this)}},{key:"changeId",value:function(e,t){var n=this;return t&&(n.hasGeneratedId=!1,n.constructor.unregisterInstance(n)),e=e||n.generateAutoId(),n.constructor.registerInstance(n,e),e}},{key:"generateAutoId",value:function(){return this.hasGeneratedId=!0,this.constructor.generateId("b-".concat(this.$$name.toLowerCase(),"-"))}}],[{key:"setupIdentifiable",value:function(e,t){var n=e.identifiable;n.idMap=Object.create(null),Reflect.defineProperty(e,"identifiable",{get:function(){return n}})}},{key:"generateId",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"generatedId";return e+(ei[e]=(ei[e]||0)+1)}},{key:"registerInstance",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.id,n=this,r=n.identifiable.idMap;if(t in r&&!n.disableThrow)throw new Error("Id "+t+" already in use");r[t]=e}},{key:"unregisterInstance",value:function(e){var t=this.identifiable.idMap;ti[l()(e)]?delete t[e]:t[e.id]===e&&delete t[e.id]}},{key:"getById",value:function(e){var t=this.identifiable.idMap;if(t)return t[e]}},{key:"$name",get:function(){return"Identifiable"}},{key:"declarable",get:function(){return["identifiable"]}},{key:"configurable",get:function(){return{id:""}}},{key:"registeredInstances",get:function(){var e=this.identifiable.idMap;return e?Object.values(e):[]}}]),n}(e||ue)};function ri(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var ii=Symbol("STM_PROP"),oi={parentIndex:1};function ai(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return si(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return si(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function si(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ui(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}function ci(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function li(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var fi=Reflect.defineProperty,di=Symbol("owner"),hi=/[\s,]+/,vi=function(e){return function(e){fe()(n,e);var t=li(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"register",value:function(e,t){for(var n,r,i=arguments.length>2&&void 0!==arguments[2]&&arguments[2],o=this.initClass(),a=o.factoryable,s=a.caseless,u=a.registry,c=E.split(e,hi),l=0;l<c.length;++l){if(r=c[l],n=s?r.toLowerCase():r,!i&&n in u)throw new Error('Type "'.concat(r,'" already registered with ').concat(a.class.name," factory"));u[r]=u[n]=t.initClass()}}},{key:"isA",value:function(e,t){return this.isType(e,t,!0)}},{key:"isType",value:function(e,t,n){var r=this.factoryable,i=r.caseless,o=r.registry[i?t.toLowerCase():t];return!!o&&(n?e instanceof o:e.constructor===o)}},{key:"setupAlias",value:function(e){e.register(e.alias,e)}},{key:"setupFactoryable",value:function(e,t){var n=t.super.class,r=e.factoryable;(r=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ci(Object(n),!0).forEach((function(t){ke()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ci(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({caseless:!0,defaultType:null,extends:n.factoryable?[n]:null,typeKey:"type"},r)).class=e,r.registry=Object.create(null),r.extends&&!Array.isArray(r.extends)&&(r.extends=[r.extends]),fi(e,"factoryable",{get:function(){return r}})}},{key:"setupType",value:function(e){var t=e.type;e.register(t,e),fi(e.prototype,"type",{value:t})}},{key:"create",value:function(e,t){return this.reconfigure(null,e,t)}},{key:"reconfigure",value:function(e,t,n){var r,i,o,a,s,u,c,f=this.factoryable,d=f.typeKey,h=t,v=n;if(n&&!an.isClass(n)&&(v=null,"function"===(c=l()(n))?u=n:"string"===c?v=n:an.isObject(n)?(r=n.cleanup,i=n.defaults,a=n.owner,u=n.setup,v=n.type):a=n),"string"==typeof h)t={};else if(t){if(!an.isObject(t)){var p;if(a&&t!==e&&(null==e?void 0:e[di])===a)"string"==typeof r?a[r](e):null===(p=r)||void 0===p||p(e),e.destroy();return t}h=t[d]}if(h=h&&this.resolveType(h),e){if(t&&(!h||e.constructor===h))return d in t&&delete(t=an.assign({},t))[d],e.setConfig(t),e;var g;if(a&&e[di]===a)"string"==typeof r?a[r](e):null===(g=r)||void 0===g||g(e),e.destroy()}if(t){if(i){if(!(o=h)){if(!(o=i[d]||v||f.defaultType))throw new Error("No default mergeType defined for ".concat(f.class.name," factory"));o=this.resolveType(o)}o&&(t=o.mergeConfigs(i,t))}if(u){if(null===(s="string"==typeof u?a[u](t,h,i):u(t,h,i)))return s;t=s||t}if(!h){if(!(h=t[d]||v||f.defaultType))throw new Error("No default type defined for ".concat(f.class.name," factory"));h=this.resolveType(h)}i&&!o&&(t=h.mergeConfigs(i,t)),d in t&&delete(t=an.assign({},t))[d],t=new h(t),a&&(t[di]=a)}return t||null}},{key:"resolveType",value:function(e,t){if("string"!=typeof e)return e;var n,r=this.factoryable,i=r.extends,o=r.registry[r.caseless?e.toLowerCase():e];for(n=0;!o&&i&&n<i.length;++n)o=i[n].resolveType(e,!0);if(!o&&!t)throw new Error('Invalid type name "'.concat(e,'" passed to ').concat(r.class.name," factory"));return o}},{key:"$name",get:function(){return"Factoryable"}},{key:"declarable",get:function(){return["factoryable","alias","type"]}}]),n}(e||ue)};function pi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var gi=function(e){fe()(n,e);var t=pi(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e){var t=this;e&&(t.name=e.name,Object.assign(t,e)),t.compare&&(t.compareItems=function(e,n){return t.compare(null==e?void 0:e[t.name],null==n?void 0:n[t.name])})}},{key:"defineAccessor",value:function(e,t){var n=this.name;!t&&n in e||Reflect.defineProperty(e,n,{configurable:!0,enumerable:!0,get:function(){return this.get(n)},set:function(e){var t=this.$meta.fields.map[n];t&&t.readOnly||this.set(n,e)}})}},{key:"isEqual",value:function(e,t){return an.isEqual(e,t)}},{key:"print",value:function(e){return null==e?this.nullText:this.printValue(e)}},{key:"printValue",value:function(e){return String(e)}}],[{key:"type",get:function(){return"auto"}},{key:"factoryable",get:function(){return{defaultType:"auto"}}},{key:"prototypeProperties",get:function(){return{compare:null,compareItems:null,dataSource:null,nullable:!0,nullText:null,nullValue:void 0,persist:!0,readOnly:!1}}}]),n}(ue.mixin(vi));function yi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}gi._$name="DataField";var mi=function(e){fe()(n,e);var t=yi(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"convert",value:function(e){return null==e?this.nullable?e:this.nullValue:Boolean(e)}}],[{key:"type",get:function(){return"boolean"}},{key:"alias",get:function(){return"bool"}},{key:"prototypeProperties",get:function(){return{nullValue:!1}}}]),n}(gi);function ki(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}mi.initClass(),mi._$name="BooleanDataField";var bi=function(e){fe()(n,e);var t=ki(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"convert",value:function(e){return null==e?this.nullable||(e=this.nullValue):"now"===e?e=new Date:e instanceof Date||(e=(e=Zt.parse(e,this.format||Zt.defaultParseFormat))||void 0),e}},{key:"serialize",value:function(e){return e instanceof Date&&(e=Zt.format(e,this.format||Zt.defaultFormat)),e}},{key:"printValue",value:function(e){return Zt.format(e,this.format||Zt.defaultFormat)}},{key:"dateFormat",get:function(){return this.format},set:function(e){y.a.deprecate("Core","5.0.0",'DateDataField "'.concat(this.name,'": dateFormat config has been renamed to "format"')),this.format=e}}],[{key:"type",get:function(){return"date"}},{key:"prototypeProperties",get:function(){return{format:null}}}]),n}(gi);function wi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}bi.initClass(),bi._$name="DateDataField";var Ci=function(e){fe()(n,e);var t=wi(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"convert",value:function(e){return null==e?this.nullable?e:this.nullValue:Math[this.rounding](Number(e))}}],[{key:"type",get:function(){return"integer"}},{key:"alias",get:function(){return"int"}},{key:"prototypeProperties",get:function(){return{nullValue:0,rounding:"round"}}}]),n}(gi);function Si(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Ci.initClass(),Ci._$name="IntegerDataField";var Di=function(e){fe()(n,e);var t=Si(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"type",get:function(){return"model"}},{key:"prototypeProperties",get:function(){return{complexMapping:!0}}}]),n}(gi);function Ri(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Di.initClass(),Di._$name="ModelDataField";var xi=function(e){fe()(n,e);var t=Ri(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"convert",value:function(e){if(null==e)return this.nullable?e:this.nullValue;e=Number(e);var t=this.precision;return t?(t=Math.pow(10,t),e=Math.round(e*t)/t):0===t&&(e=Math.round(e)),e}}],[{key:"type",get:function(){return"number"}},{key:"alias",get:function(){return"float"}},{key:"prototypeProperties",get:function(){return{nullValue:0,precision:null}}}]),n}(gi);function Ei(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}xi.initClass(),xi._$name="NumberDataField";var Ti=function(e){fe()(n,e);var t=Ei(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"type",get:function(){return"object"}},{key:"prototypeProperties",get:function(){return{complexMapping:!0}}}]),n}(gi);function Mi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Ti.initClass(),Ti._$name="ObjectDataField";var Ai=function(e){fe()(n,e);var t=Mi(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"convert",value:function(e){return null==e?this.nullable?e:this.nullValue:String(e)}}],[{key:"type",get:function(){return"string"}},{key:"prototypeProperties",get:function(){return{nullValue:""}}}]),n}(gi);function Pi(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ii(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Pi(Object(n),!0).forEach((function(t){ke()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Pi(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Oi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Ai.initClass(),Ai._$name="StringDataField";var Fi=Reflect.defineProperty,Li=Object.prototype.hasOwnProperty,ji={children:1,data:1,meta:1},_i=["name","title","text","label","description"],Bi=function(e){fe()(n,e);var t=Oi(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=this,a=t?Array.isArray(t)?t:[t]:[],s=o.constructor,u=o.fieldMap,c=null;if(t=a[0],o.meta=Ii(Ii({modified:{}},s.metaConfig),r),s.applyConfigs)for(var l in o.$meta.config)c||(c={},o.useRawData&&o.useRawData.enabled||(e=Ii({},e))),l in e&&(c[l]=e[l],delete e[l]);if(we()(pe()(n.prototype),"construct",this).call(this,c),i||s.exposeProperties(e),!Li.call(s,"idFieldProcessed")){var f=o.meta.idField;f||(s._assignedIdField?f=s.idField:t&&(f=t.idField)),f&&f!==u.id.dataSource&&s.addField({name:"id",dataSource:f}),s.idFieldProcessed=!0}o._internalId=n._internalIdCounter++,o.stores=[],o.unjoinedStores=[],o.originalData||(o.originalData=e),o.data=s.processData(e,!1,t),null==o.id&&o.setData("id",o.generateId(t)),o.data[s.childrenField]&&o.processChildren(a),o.generation=0}},{key:"equals",value:function(e){if(e instanceof this.constructor){for(var t=this.$meta.fields.defs,n=0,r=t.length;n<r;n++){var i=t[n],o=i.name;if("id"!==o&&!i.isEqual(this[o],e[o]))return!1}return!0}return!1}},{key:"getFieldDefinition",value:function(e){return this.$meta.fields.map[e]}},{key:"getFieldDefinitionFromDataSource",value:function(e){return this.$meta.fields.sources[e]}},{key:"getDataSource",value:function(e){var t=this.constructor.getFieldDefinition(e);return(null==t?void 0:t.dataSource)||(null==t?void 0:t.name)}},{key:"initRelations",value:function(){var e=this;e.constructor.relations&&e.stores.forEach((function(t){var n;t.modelRelations||t.initRelations();var r=[];null===(n=t.modelRelations)||void 0===n||n.forEach((function(t){r.push({related:e.initRelation(t),config:t})})),t.updateRecordRelationCache(e,r)}))}},{key:"initRelation",value:function(e){var t=this.get(e.fieldName),n=void 0!==t&&"string"!=typeof e.store&&e.store.getById(t),r={id:t,placeHolder:!0};return this.meta.relationCache||(this.meta.relationCache={}),this.meta.relationCache[e.relationName]=n||(null!=t?r:null),n}},{key:"removeRelation",value:function(e){this.meta.relationCache[e.relationName]&&(delete this.meta.relationCache[e.relationName],e.nullFieldOnRemove&&this.setData(e.fieldName,null))}},{key:"getForeign",value:function(e){var t;return null===(t=this.meta.relationCache)||void 0===t?void 0:t[e]}},{key:"setForeign",value:function(e,t,r){var i=n.asId(t);return this.set(r.fieldName,i)}},{key:"get",value:function(e){var t=this.meta.batchChanges,n=this.fieldMap,r=this.data,i=n[e],o=i?i.dataSource:e;if(t&&e in t)return t[e];if(o){var a;if(!i&&e.includes("."))i=n[e.split(".")[0]];return(null===(a=i)||void 0===a?void 0:a.complexMapping)?an.getPath(r,o):o in r?r[o]:r[e]}}},{key:"setData",value:function(e,t){var n=this.data,r=this.fieldMap;if("string"==typeof e){var i,o=r[e],a=null!==(i=null==o?void 0:o.dataSource)&&void 0!==i?i:e;(null==o?void 0:o.complexMapping)?an.setPath(n,a,t):n[a]=t}else for(var s=Object.keys(e),u=0;u<s.length;u++){var c,l=s[u],f=r[l],d=null!==(c=null==f?void 0:f.dataSource)&&void 0!==c?c:l;d&&((null==f?void 0:f.complexMapping)?an.setPath(n,d,e[l]):n[d]=e[l])}}},{key:"getData",value:function(e){var t,n=this.fieldMap[e],r=null!==(t=null==n?void 0:n.dataSource)&&void 0!==t?t:e;if(r)return(null==n?void 0:n.complexMapping)?an.getPath(this.data,r):this.data[r]}},{key:"syncId",value:function(e){var t=this.id;if(t!==e){this.setData("id",e);var n={id:{value:e,oldValue:t}};this.afterChange(n,n)}}},{key:"set",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=this;if(o.isBatchUpdating)return o.inBatchSet(e,t),null;var a,s=o.beforeSet?o.beforeSet(e,t,n,r):void 0,u=o.inSet(e,t,n,r,i);return null===(a=o.afterSet)||void 0===a||a.call(o,e,t,n,r,s,u),u}},{key:"fieldToKeys",value:function(e,t){return"string"!=typeof e?an.assign({},e):ke()({},e,t)}},{key:"inBatchSet",value:function(e,t){var n=this.meta,r=this.constructor,i=!1;"string"!=typeof e?Object.keys(this.fieldToKeys(e,t)).forEach((function(o){t=r.processField(o,e[o]),n.batchChanges[o]!==t&&(n.batchChanges[o]=t,i=!0)})):n.batchChanges[e]!==t&&(n.batchChanges[e]=t,i=!0),i&&this.generation++}},{key:"inSet",value:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4],o=this,a=o.data,s=o.meta,u=o.fieldMap,c=o.constructor,l=c.prototype,f=c.childrenField,d={},h=o.fieldToKeys(e,t),v=Object.keys(h),p=!1;if(!n&&!o.triggerBeforeUpdate(h))return null;for(var g=function(e){var t,n=v[e];if(n===f)return"continue";var g=u[n],y=g||an,m=null==g?void 0:g.readOnly,k=null!==(t=null==g?void 0:g.dataSource)&&void 0!==t?t:n,b=!i&&!g&&n in l,w=b?o[k]:(null==g?void 0:g.complexMapping)?an.getPath(a,k):a[k],C=c.processField(n,h[n]),S=h[n]={value:C},D=o.getRelationConfig(n);m||y.isEqual(w,C)||(o.generation++,S.oldValue=w,p=!0,y.isEqual(o.meta.modified[n],C)?Reflect.deleteProperty(s.modified,n):o.ignoreBag||(n in s.modified||(s.modified[n]=w),void 0===S.oldValue&&Reflect.deleteProperty(S,"oldValue")),d[n]=S,o.applyValue(b,k,C,i,g),D&&!r&&(o.initRelation(D),o.stores.forEach((function(e){return e.cacheRelatedRecord(o,C,D.relationName,S.oldValue)}))))},y=0;y<v.length;y++)g(y);return p&&o.afterChange(h,d,n,r,i),p?d:null}},{key:"applyValue",value:function(e,t,n,r,i){var o;if(e)this[t]=n;else{if(!i&&t.includes(".")){var a=t.split(".")[0];i=this.constructor.fieldMap[a]}(null===(o=i)||void 0===o?void 0:o.complexMapping)?an.setPath(this.data,t,n):this.data[t]=n}}},{key:"afterChange",value:function(e,t,n,r,i){var o=this;this.stores.forEach((function(i){i.onModelChange(o,e,t,n,r)}))}},{key:"isFieldModified",value:function(e){return this.isModified&&this.meta.modified[e]}},{key:"getFieldPersistentValue",value:function(e){var t,n="string"==typeof e?this.getFieldDefinition(e):e,r=(null==n?void 0:n.name)||e;return n&&!n.persist||(t=this[r],(null==n?void 0:n.serialize)&&(t=n.serialize(t,this))),t}},{key:"clearChanges",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this,r=n.meta;r.modified={},r.committing=!1,e&&n.stores.forEach((function(e){if(e.modified.remove(n),e.added.remove(n),t){var r=e.collectDescendants(n).all;e.added.remove(r),e.modified.remove(r)}}))}},{key:"revertChanges",value:function(){this.set(this.meta.modified)}},{key:"generateId",value:function(){return this.constructor.generateId()}},{key:"toJSON",value:function(){var e=this.children,t=this.persistableData;return e&&(t[this.constructor.childrenField]=e.map((function(e){return e.toJSON()}))),t}},{key:"toString",value:function(){var e,t=this,n=_i.find((function(e){return e in t.constructor.fieldMap})),r=n?(e={},ke()(e,t.constructor.idField,t.id),ke()(e,n,t[n]),e):t.data;return E.safeJsonStringify(r)}},{key:"beginBatch",value:function(){this.batching||(this.batching=0,this.meta.batchChanges={}),this.batching++}},{key:"endBatch",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r=n.constructor.parentIdField;if(n.batching&&(n.batching--,!(n.batching>0||an.isEmpty(n.meta.batchChanges)))){var i=Ii({},n.meta.batchChanges);n.meta.batchChanges=null,i[r]&&(n.parentId=i[r],delete i[r]),n.set(i,void 0,e,!1,t),n.cancelBatch()}}},{key:"cancelBatch",value:function(){this.batching=null,this.meta.batchChanges=null}},{key:"triggerBeforeUpdate",value:function(e){var t=this;return!this.stores.some((function(n){if(!1===n.trigger("beforeUpdate",{record:t,changes:e}))return!0}))}},{key:"copy",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1?arguments[1]:void 0,i=this,o=Ii({},i.data),a=i.constructor.idField;e=an.isObject(r)?r.deep:r,!1!==n&&delete o[a],n&&"object"===l()(n)?(t=n.id,"deep"in n?(e=n.deep,y.a.deprecate("Grid","5.0.0","`deep` attribute deprecated, in favor of a separate second parameter"),delete n.id,delete n.deep):Object.assign(o,n)):t=n,e&&i.children?o.children=i.children.map((function(e){return e.copy(void 0,r)})):(delete o.children,delete o.expanded),null==o[a]&&(o[a]=t||i.generateId(i.firstStore));var s=new i.constructor(o);return s.originalInternalId=i.internalId,s}},{key:"remove",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=this.parent;n?n.removeChild(t):t.stores.length&&(t.isSpecialRow||t.stores.forEach((function(n){return n.remove(t,e,!1,!0)})))}},{key:"getRelationConfig",value:function(e){var t,n;return null===(t=this.firstStore)||void 0===t||null===(n=t.modelRelations)||void 0===n?void 0:n.find((function(t){return t.fieldName===e}))}},{key:"joinStore",value:function(e){var t=this,r=t.stores,i=t.unjoinedStores;r.includes(e)||(we()(pe()(n.prototype),"joinStore",this)&&we()(pe()(n.prototype),"joinStore",this).call(this,e),e.register(t),r.push(e),i.includes(e)&&i.splice(i.indexOf(e),1),t.isLoaded&&t.children.forEach((function(t){return t.joinStore(e)})),t.initRelations(),e.tree&&!t.isRoot&&(t.instanceMeta(e.id).collapsed=!t.expanded))}},{key:"unJoinStore",value:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this,o=i.stores,a=i.unjoinedStores;o.includes(e)&&(e.unregister(i),null===(t=i.children)||void 0===t||t.forEach((function(t){return t.unJoinStore(e,r)})),o.splice(o.indexOf(e),1),a.push(e),we()(pe()(n.prototype),"unJoinStore",this)&&we()(pe()(n.prototype),"unJoinStore",this).call(this,e,r),e.uncacheRelatedRecord(i))}},{key:"isPartOfStore",value:function(e){return e?e.includes(this):this.stores.length>0}},{key:"instanceMeta",value:function(e){var t=this.meta,n=e.id||e;return t.map||(t.map={}),t.map[n]||(t.map[n]={})}},{key:"indexPath",get:function(){var e=[],t=this,n=t.childLevel;for(t=this;t&&!t.isRoot;t=t.parent)e[n--]=t.parentIndex+1;return e}},{key:"subclass",get:function(){return new this.constructor(Object.setPrototypeOf({id:void 0},this.data),this.stores[0],null,!0)}},{key:"fieldMap",get:function(){return this.$meta.fields.map}},{key:"fields",get:function(){return this.$meta.fields.defs}},{key:"fieldNames",get:function(){return Object.keys(this.data)}},{key:"isPersistable",get:function(){return!0}},{key:"isModified",get:function(){return Boolean(this.meta.modified&&Object.keys(this.meta.modified).length>0)}},{key:"hasPersistableChanges",get:function(){return this.isPersistable&&!an.isEmpty(this.rawModificationData)}},{key:"modifications",get:function(){var e=this.rawModifications;return e&&Object.keys(e).length&&(e[this.constructor.idField]=this.id),e}},{key:"rawModifications",get:function(){var e=this,t={};if(!e.isModified)return null;var n=!1;return Object.keys(e.meta.modified).forEach((function(r){var i=e.getFieldPersistentValue(r);void 0!==i&&(t[r]=i,n=!0)})),n?t:null}},{key:"modificationData",get:function(){var e=this.rawModificationData;return e&&Object.keys(e).length&&an.setPath(e,this.constructor.getFieldDefinition(this.constructor.idField).dataSource,this.id),e}},{key:"rawModificationData",get:function(){var e=this,t=e.constructor.fieldMap,n={};if(!e.isModified)return null;var r=!1;return Object.keys(e.meta.modified).forEach((function(i){var o=t[i];if(null==o?void 0:o.persist){var a=e.getFieldPersistentValue(i);void 0!==a&&(an.setPath(n,o.dataSource,a),r=!0)}})),r?n:null}},{key:"persistableData",get:function(){var e=this,t={};return e.fields.forEach((function(n){var r=e.getFieldPersistentValue(n);void 0!==r&&((null==n?void 0:n.complexMapping)?an.setPath(t,n.dataSource,r):t[n.dataSource]=r)})),t}},{key:"isCommitting",get:function(){return Boolean(this.meta.committing)}},{key:"internalId",get:function(){return this._internalId}},{key:"isPhantom",get:function(){return""===this.id||null==this.id||this.hasGeneratedId}},{key:"isModel",get:function(){return!0}},{key:"hasGeneratedId",get:function(){return"string"==typeof this.id&&this.id.startsWith("_generated")}},{key:"json",get:function(){return E.safeJsonStringify(this)}},{key:"isBatchUpdating",get:function(){return Boolean(this.batching)}},{key:"firstStore",get:function(){return this.stores.length>0&&this.stores[0]}},{key:"isValid",get:function(){return!0}},{key:"isRemoved",get:function(){return!this.isPartOfStore()}},{key:"isSpecialRow",get:function(){return this.meta.specialRow}}],[{key:"processData",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2?arguments[2]:void 0,i=this.fieldMap,o=this.defaultValues,a=r||{},s=a.useRawData,u=void 0===s?{enabled:!1}:s,c=u.enabled?e:Ii({},e);if(!(n=n||u.disableDefaultValue))for(t in o)void 0===c[t]&&(c[t]=o[t]);if(!u.disableTypeConversion)for(t in i){var l=i[t],f=l.name,d=l.dataSource,h=d!==f,v=h&&an.pathExists(e,d),p=f in e&&(!h||!v),g=!u.disableTypeConversion&&l.convert;if((p||g)&&(!n||p||v)){var y=p?c[f]:an.getPath(c,d);an.setPath(c,d,g?l.convert(y):y),h&&delete c[f]}}return c}},{key:"setupClass",value:function(e){we()(pe()(n),"setupClass",this).call(this,e),e.fields||this.setupFields(this,e)}},{key:"setupFields",value:function(e,t){var n,r,i,o,a,s=Li.call(e,"fields")&&e.fields,u=t.super.fields,c=t.fields={defs:null!==(n=null==u?void 0:u.defs.slice())&&void 0!==n?n:[],exposedData:!1,defaults:u?Ii({},u.defaults):{},exposed:Object.create(null!==(r=null==u?void 0:u.exposed)&&void 0!==r?r:null),ordinals:Object.create(null!==(i=null==u?void 0:u.ordinals)&&void 0!==i?i:null),map:Object.create(null!==(o=null==u?void 0:u.map)&&void 0!==o?o:null),sources:Object.create(null!==(a=null==u?void 0:u.sources)&&void 0!==a?a:null)};Li.call(e,"defaults")&&Object.assign(c.defaults,e.defaults),Li.call(e,"idField")&&(e.addField({name:"id",dataSource:e.idField}),c.exposed[e.idField]=!0),(null==s?void 0:s.length)&&s.map(e.addField,e),e.exposeRelations()}},{key:"exposeProperties",value:function(e){var t=this.$meta.fields;if(e&&this.autoExposeFields&&!t.exposedData){var n,r,i;for(n in e)t.exposed[n]||(r={name:n,dataSource:n,fromData:!0},"boolean"!==(i=l()(e[n]))&&"number"!==i||(r.type=i),this.addField(r));t.exposedData=!0}this.exposeRelations()}},{key:"addField",value:function(e){if(null!=e){"string"==typeof e&&(e={name:e});var t,n,r=this.initClass(),i=r.$meta.fields,o=i.ordinals,a=i.exposed,s=e.name,u=i.map[s],c=e.dataSource||(e.dataSource=s);if(!u||e.type&&e.type!==u.type)(t=gi.create(e)).definedBy=u?u.definedBy:r,t.ordinal=u?u.ordinal:o[s]=i.defs.length;else for(n in t=Object.create(u),e)"type"!==n&&(t[n]=e[n]);return t.owner=r,i.defs[t.ordinal]=t,i.map[s]=t,i.sources[c]||(i.sources[c]=t),c.includes(".")&&(t.complexMapping=!0),t.complexMapping?a[c.split(".")[0]]=!0:a[c]=!0,"defaultValue"in t&&(i.defaults[c]=t.defaultValue),ji[s]||t.defineAccessor(r.prototype),t}}},{key:"removeField",value:function(e){var t=this.initClass(),n=t.$meta.fields,r=n.map[e],i=n.ordinals,o=i[e];if(r){for(var a in n.defs.splice(o,1),delete i[e],delete n.defaults[e],delete n.exposed[e],delete n.map[e],delete n.sources[r.dataSource],i)i[a]>o&&--i[a];delete t.prototype[e]}}},{key:"exposeRelations",value:function(){var e=this;Li.call(e,"relationsExposed")||e.relationConfig&&(e.relationsExposed=!0,e.relations=[],e.relationConfig.forEach((function(t){e.relations.push(t);var n=t.relationName;Reflect.ownKeys(e.prototype).includes(n)||Fi(e.prototype,n,{enumerable:!0,get:function(){return this.getForeign(n)},set:function(e){this.setForeign(n,e,t)}})})))}},{key:"getFieldDefinition",value:function(e){return this.$meta.fields.map[e]}},{key:"getFieldDataSource",value:function(e){return this.getFieldDefinition(e).dataSource}},{key:"processField",value:function(e,t){var n=this.fieldMap[e];return(null==n?void 0:n.convert)?n.convert(t):t}},{key:"generateId",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.$$name;return this.generatedIdIndex||(this.generatedIdIndex=0),"_generated".concat(e).concat(++this.generatedIdIndex)}},{key:"asId",value:function(e){return(null==e?void 0:e.isModel)?e.id:e}},{key:"$name",get:function(){return"Model"}},{key:"declarable",get:function(){return["fields"]}},{key:"fields",get:function(){return[{name:"parentIndex",type:"number",persist:!1}]}},{key:"idField",set:function(e){this._assignedIdField=!0,this._idField=e},get:function(){return this._idField}},{key:"childrenField",set:function(e){this._childrenField=e},get:function(){return this._childrenField||"children"}},{key:"defaultValues",get:function(){return this.$meta.fields.defaults}},{key:"fieldMap",get:function(){return this.$meta.fields.map}},{key:"fieldDataSourceMap",get:function(){return this.$meta.fields.sources}},{key:"autoExposeFields",get:function(){return!0}}]),n}(ue.mixin((function(e){return function(e){fe()(n,e);var t=ri(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"joinStore",value:function(e){we()(pe()(n.prototype),"joinStore",this)&&we()(pe()(n.prototype),"joinStore",this).call(this,e),this.stm||(this.stm=e.stm)}},{key:"unJoinStore",value:function(e){this.stm===e.stm&&(this.stm=null),we()(pe()(n.prototype),"unJoinStore",this)&&we()(pe()(n.prototype),"unJoinStore",this).call(this,e)}},{key:"beforeSet",value:function(e,t,r,i){var o=this,a=we()(pe()(n.prototype),"beforeSet",this)?we()(pe()(n.prototype),"beforeSet",this).call(this,e,t,r,i):[],s=this.stm;if(s&&!s.disabled&&!oi[e]){var u,c;if("object"==l()(e)){var f=Object.keys(e).reduce((function(t,n){return t[0][n]=e[n],t[1][n]=o.get(n),t}),[{},{}]),d=ye()(f,2);u=d[0],c=d[1]}else u=ke()({},e,t),c=ke()({},e,this.get(e));a.push([u,c])}return a}},{key:"afterSet",value:function(e,t,r,i,o,a){var s=this.stm;if(s&&!s.disabled&&!oi[e]){var u=o.pop();if(a){var c=ye()(u,2),l=c[0],f=c[1],d=Object.keys(a).reduce((function(e,t){return e[0][t]=l[t],e[1][t]=f[t],e}),[{},{}]),h=ye()(d,2),v=h[0],p=h[1];s.onModelUpdate(this,v,p)}}we()(pe()(n.prototype),"afterSet",this)&&we()(pe()(n.prototype),"afterSet",this).call(this,e,t,r,i,o,a)}},{key:"beforeInsertChild",value:function(e){var t=this,r=we()(pe()(n.prototype),"beforeInsertChild",this)?we()(pe()(n.prototype),"beforeInsertChild",this).call(this,e):[],i=this.stm;return i&&!i.disabled&&r.push(e.reduce((function(e,n){return n.root===t.root&&e.set(n,{parent:n.parent,index:n.parent?n.parentIndex:void 0}),e}),new Map)),r}},{key:"afterInsertChild",value:function(e,t,r,i){var o=this.stm;if(o&&!o.disabled){var a=r.pop();i&&o.onModelInsertChild(this,e,i,a)}we()(pe()(n.prototype),"afterInsertChild",this)&&we()(pe()(n.prototype),"afterInsertChild",this).call(this,e,t,r,i)}},{key:"beforeRemoveChild",value:function(e,t){var r=we()(pe()(n.prototype),"beforeRemoveChild",this)?we()(pe()(n.prototype),"beforeRemoveChild",this).call(this,e,t):[],i=this.stm;return!i||i.disabled||t||r.push(e.reduce((function(e,t){return e.set(t,t.parentIndex),e}),new Map)),r}},{key:"afterRemoveChild",value:function(e,t,r){var i=this.stm;if(i&&!i.disabled&&!r){var o=t.pop();e&&e.length&&i.onModelRemoveChild(this,e,o)}we()(pe()(n.prototype),"afterRemoveChild",this)&&we()(pe()(n.prototype),"afterRemoveChild",this).call(this,e,t,r)}},{key:"stm",get:function(){return this[ii]},set:function(e){this[ii]=e}}],[{key:"$name",get:function(){return"ModelStm"}},{key:"defaultConfig",get:function(){return{stm:null}}}]),n}(e||ue)}),(function(e){return function(e){fe()(n,e);var t=ui(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"ingestChildren",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.stores,n=this.inProcessChildren,r=this.constructor,i=t[0];if(!0===e)return!!n||[];if(e){Array.isArray(e)||(e=[e]);for(var o,a=e.length,s=[],u=0;u<a;u++)o=(o=e[u]).isModel?o:i?i.createRecord(o):new r(o,null,null,!0),o=i?i.processRecord(o):o,s.push(o);return s}}},{key:"processChildren",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.stores,t=this,n=t.meta;t.inProcessChildren=!0;var r=t.ingestChildren(t.data[t.constructor.childrenField],e);r&&(r.length?(n.isLeaf=!1,!0===t.children&&(t.children=[]),t.appendChild(r)):!0===r?(n.isLeaf=!1,t.children=!0):t.isRoot||(n.isLeaf=t.constructor.convertEmptyParentToLeaf.onLoad)),t.inProcessChildren=!1}},{key:"ancestorsExpanded",value:function(e){var t=this.parent;return!t||t.isExpanded(e)&&t.ancestorsExpanded(e)}},{key:"isExpanded",value:function(e){var t=this.instanceMeta(e.id);return Object.prototype.hasOwnProperty.call(t,"collapsed")||(t.collapsed=!this.expanded),!t.collapsed}},{key:"getDescendantCount",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.firstStore,n=this.children;return!n||!Array.isArray(n)||e&&!this.isExpanded(t)?0:n.reduce((function(t,n){return t+n.getDescendantCount(e)}),n.length)}},{key:"traverse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.children;t||e.call(this,this);for(var r=0,i=n&&n.length;r<i;r++)n[r].traverse(e)}},{key:"traverseBefore",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.children,r=0,i=n&&n.length;r<i;r++)n[r].traverse(e);t||e.call(this,this)}},{key:"traverseWhile",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r=!0;return t||(r=!1!==e.call(n,n)),r&&n.isLoaded&&(r=n.children.every((function(t){return t.traverseWhile(e)}))),r}},{key:"bubble",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;for(t||e.call(n,n);n.parent;)n=n.parent,e.call(n,n)}},{key:"bubbleWhile",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r=!0;for(t||(r=e.call(n,n));r&&n.parent;)n=n.parent,r=e.call(n,n);return r}},{key:"contains",value:function(e){return e&&"object"===l()(e)&&(e=e.id),!this.traverseWhile((function(t){return t.id!=e}))}},{key:"getTopParent",value:function(e){var t;return e?(t=[],this.bubbleWhile((function(e){return t.push(e),e.parent&&!e.parent.isRoot}))):(t=null,this.bubbleWhile((function(e){return e.parent||(t=e),e.parent&&!e.parent.isRoot}))),t}},{key:"appendChild",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.insertChild(e,null,t)}},{key:"insertChild",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if("number"==typeof e){var r=e;e=t,t=this.children[r]}var i=this,o=i.isLeaf,a=Array.isArray(e);if(Array.isArray(e)||(e=[e]),!n&&!i.stores.every((function(t){return!1!==t.trigger("beforeAdd",{records:e,parent:i})})))return null;e=i.ingestChildren(e);var s=t?t.parentIndex:i.children?i.children.length:0,u=i.beforeInsertChild?i.beforeInsertChild(e):void 0,c=i.internalAppendInsert(e,t,n);return o&&c.length&&(i.meta.isLeaf=!1),i.isLeaf===o||i.root.isLoading||n||i.stores.forEach((function(e){var t={isLeaf:{value:!1,oldValue:!0}};e.trigger("update",{record:i,changes:t}),e.trigger("change",{action:"update",record:i,changes:t})})),i.afterInsertChild&&i.afterInsertChild(s,e,u,c),a||!c?c:c[0]}},{key:"tryInsertChild",value:function(){return this.insertChild.apply(this,arguments)}},{key:"internalAppendInsert",value:function(e,t,n){var r,i,o,a,s=this,u=s.stores,c=s.root,l=c.firstStore,f=s.constructor.parentIdField,d=s.isAutoRoot?null:s.id,h={};if(t&&t.parent!==s&&(t=null),s.children){var v=s.children,p=t?t.parentIndex:v.length;if(v[i=p]===e[0]||v[i=p-1]===e[0])for(r=!0,o=0;r&&o<e.length;o++)e[o]!==v[i+o]&&(r=!1)}if(r)return e;for(o=0;o<e.length;o++){var g=e[o],y=g.parent;h[g.id]=g.root===c,l&&g.traverse((function(e){e.root===c&&(h[e.id]=!0)})),y&&!1===y.removeChild(g,h[g.id])?(a||(e=e.slice(),a=!0),e.splice(o--,1)):(g.parent=s,g.data[f]=d,y&&(g.meta.oldParentId=y.id))}if(e.length){var m=s.addToChildren(s.children||(s.children=[]),t,e);s.addToChildren(s.unfilteredChildren,t,e,!0),u.forEach((function(t){t.isChained||(e.forEach((function(e){e.joinStore(t)})),t.onNodeAddChild(s,e,m,h,n),e.forEach((function(e){if(null!=e.meta.oldParentId&&!s.inProcessChildren&&!s.isLoading){var t,n=(t={},ke()(t,f,d),ke()(t,s.getDataSource("parentIndex"),e.parentIndex),t),r={},i=e.meta,o=i.modified,a=i.oldParentId,u=o.parentIndex;delete e.meta.oldParentId,s.id!==a&&(r[f]={value:d,oldValue:a}),e.parentIndex!==u&&(r.parentIndex={value:e.parentIndex,oldValue:u}),o[f]===s.id?Reflect.deleteProperty(o,f):f in o||(o[f]=a),e.afterChange(n,r)}})))}))}return e}},{key:"removeChild",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.isLeaf,o=r.children,a=r.stores;if(Array.isArray(e)||(e=[e]),e=e.filter((function(e){return e.parent===r})),!n){var s,u=ai(a);try{for(u.s();!(s=u.n()).done;){var c=s.value;if(!c.isChained&&!1===c.trigger("beforeRemove",{parent:r,records:e,isMove:t}))return!1}}catch(e){u.e(e)}finally{u.f()}}var l,f=r.beforeRemoveChild?r.beforeRemoveChild(e,t):void 0,d=ai(e);try{var h=function(){var e=l.value,i=e.constructor.parentIdField,s=e.meta.modified,u=e.parent?e.parent.id:null;i in s||(s[i]=u);var c=r.removeFromChildren(o,e);r.removeFromChildren(r.unfilteredChildren,e,!0),a.forEach((function(i){i.isChained||i.onNodeRemoveChild(r,[e],c,{isMove:t,silent:n})})),t||(e.parent=e.parentIndex=e.unfilteredIndex=e.nextSibling=e.previousSibling=null,e.data[i]=null)};for(d.s();!(l=d.n()).done;)h()}catch(e){d.e(e)}finally{d.f()}o.length||!r.constructor.convertEmptyParentToLeaf.onRemove||r.isRoot||(r.meta.isLeaf=!0),r.isLeaf===i||n||r.stores.forEach((function(e){var t={isLeaf:{value:!0,oldValue:!1}};e.trigger("update",{record:r,changes:t}),e.trigger("change",{action:"update",record:r,changes:t})})),r.afterRemoveChild&&r.afterRemoveChild(e,f,t)}},{key:"clearParentId",value:function(){var e=this;Reflect.deleteProperty(e.data,e.parentIdField),Reflect.deleteProperty(e.originalData,e.parentIdField),e.meta.modified&&Reflect.deleteProperty(e.meta.modified,e.parentIdField)}},{key:"clearChildren",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=t.children,r=t.stores;n&&(t.children=[],r.forEach((function(r){r.isChained||r.onNodeRemoveChild(t,n,0,{unfiltered:!0,silent:e})})),t.unfilteredChildren&&(t.unfilteredChildren=[]))}},{key:"clear",value:function(){var e=this,t=e.stores,n=e.children&&e.children.slice();if(e.isRoot&&n){var r,i=ai(t);try{for(i.s();!(r=i.n()).done;){var o=r.value;if(!o.isChained&&!1===o.trigger("beforeRemove",{parent:e,records:n,isMove:!1,removingAll:!0}))return!1}}catch(e){i.e(e)}finally{i.f()}e.children.length=0,t.forEach((function(e){n.forEach((function(t){t.stores.includes(e)&&t.unJoinStore(e),t.parent=t.parentIndex=t.nextSibling=t.previousSibling=null})),e.storage.suspendEvents(),e.storage.clear(),e.storage.resumeEvents(),e.added.clear(),e.modified.clear(),e.trigger("removeAll"),e.trigger("change",{action:"removeall"})}))}}},{key:"updateChildrenIndices",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t?"unfilteredIndex":"parentIndex",i=null,o=0;o<e.length;o++){var a=e[o],s=a[r];"parentIndex"===r?void 0===s||n?a.setData("parentIndex",o):s!==o&&a.set("parentIndex",o,!0):a[r]=o,t||(a.previousSibling=i,i&&(i.nextSibling=a),o===e.length-1&&(a.nextSibling=null),i=a)}}},{key:"addToChildren",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(e){var i=r?"unfilteredIndex":"parentIndex",o=t?t[i]:e.length;return e.splice.apply(e,[o,0].concat(d()(n))),this.updateChildrenIndices(e,r),o}}},{key:"removeFromChildren",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(e){var r=n?"unfilteredIndex":"parentIndex",i=t[r];return i>-1&&(e.splice(i,1),this.updateChildrenIndices(e,n)),i}}},{key:"expanded",get:function(){return this.data.expanded}},{key:"childLevel",get:function(){for(var e=this,t=-1;e&&!e.isRoot;)++t,e=e.parent;return t}},{key:"isLeaf",get:function(){return!1!==this.meta.isLeaf&&!this.isRoot}},{key:"isParent",get:function(){return!this.isLeaf}},{key:"isLoaded",get:function(){return this.isParent&&Array.isArray(this.children)}},{key:"descendantCount",get:function(){return this.getDescendantCount()}},{key:"visibleDescendantCount",get:function(){return this.getDescendantCount(!0)}},{key:"allChildren",get:function(){var e=this.children;return e?e.reduce((function(e,t){return e.push(t),e.push.apply(e,t.allChildren),e}),[]):[]}},{key:"firstChild",get:function(){var e=this.children;return e&&e.length&&e[0]||null}},{key:"lastChild",get:function(){var e=this.children;return e&&e.length&&e[e.length-1]||null}},{key:"previousSiblingsTotalCount",get:function(){for(var e=this.previousSibling,t=this.parentIndex;e;)t+=e.descendantCount,e=e.previousSibling;return t}},{key:"root",get:function(){return this.parent&&this.parent.root||this}},{key:"parentId",get:function(){return this.parent&&!this.parent.isAutoRoot?this.parent.id:null},set:function(e){var t=this,n=t.parent,r=e&&t.firstStore.getById(e);r!==n&&(n||r)&&(t.isBatchUpdating?t.meta.batchChanges.parentId=e:r?r.appendChild(t):t.parent.removeChild(t))}}],[{key:"$name",get:function(){return"TreeNode"}},{key:"convertEmptyParentToLeaf",set:function(e){!0===e?e={onLoad:!0,onRemove:!0}:!1===e&&(e={onLoad:!1,onRemove:!1}),this._convertEmptyParentToLeaf=e},get:function(){return this._convertEmptyParentToLeaf||{onLoad:!1,onRemove:!1}}},{key:"parentIdField",set:function(e){this._parentIdField=e,Object.defineProperty(this.prototype,e,{set:function(e){this.parentId=e},get:function(){return this.parentId}})},get:function(){return this._parentIdField||"parentId"}}]),n}(e||ue)})));function Hi(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return $i(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $i(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function $i(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ni(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Bi._idField="id",Bi._internalIdCounter=1,Bi._assignedIdField=!1,Bi.exposeProperties(),Bi._$name="Model";var Vi=function(e){fe()(n,e);var t=Ni(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e){"function"==typeof e&&(e={filterBy:e}),we()(pe()(n.prototype),"construct",this).call(this,e)}},{key:"onChange",value:function(e){var t=this;!t.isConfiguring&&t.owner&&!t.owner.isConfiguring&&t.owner.onFilterChanged&&t.owner.onFilterChanged(t,e)}},{key:"defaultFilterBy",value:function(e){return this[this.operator](this.convert(e[this.property]))}},{key:"convert",value:function(e){var t,n;"string"==typeof this.filterValue&&e instanceof Date||(e=null!==(t=null===(n=e)||void 0===n?void 0:n.valueOf())&&void 0!==t?t:e);return e=this.caseSensitive||"string"!=typeof e?e:e.toLowerCase()}},{key:"filter",value:function(e){return this.filterBy(e)}},{key:"startsWith",value:function(e){return String(e).startsWith(this.filterValue)}},{key:"endsWith",value:function(e){return String(e).endsWith(this.filterValue)}},{key:"=",value:function(e){return an.isEqual(e,this.filterValue)}},{key:"!=",value:function(e){return!an.isEqual(e,this.filterValue)}},{key:">",value:function(e){return an.isMoreThan(e,this.filterValue)}},{key:">=",value:function(e){return an.isMoreThan(e,this.filterValue)||an.isEqual(e,this.filterValue)}},{key:"<",value:function(e){return an.isLessThan(e,this.filterValue)}},{key:"<=",value:function(e){return an.isLessThan(e,this.filterValue)||an.isEqual(e,this.filterValue)}},{key:"*",value:function(e){return an.isPartial(e,this.filterValue)}},{key:"id",get:function(){return this._id||(this._id=this.property||n.generateId("b-filter"))},set:function(e){this._id=e}},{key:"filterBy",get:function(){return this._filterBy||this.defaultFilterBy},set:function(e){this._filterBy=e}},{key:"property",set:function(e){this._property=e,this.onChange("property")},get:function(){return this._property}},{key:"value",set:function(e){var t,n;this._value=e,e=null!==(t=null===(n=e)||void 0===n?void 0:n.valueOf())&&void 0!==t?t:e,this._filterValue=this.caseSensitive||"string"!=typeof e?e:e.toLowerCase(),this.onChange("value")},get:function(){return this._value}},{key:"filterValue",get:function(){return this._filterValue}},{key:"operator",set:function(e){this._operator=e,this.onChange("operator")},get:function(){return this._operator||("string"==typeof this.filterValue?"*":"=")}}],[{key:"generateFiltersFunction",value:function(e){return e&&(e.length||e.count)?function(t){var n,r=!0,i=Hi(e);try{for(i.s();!(n=i.n()).done;){var o=n.value;if(o.disabled||(r=o.filter(t)),!r)break}}catch(e){i.e(e)}finally{i.f()}return r}:xe.returnTrue}},{key:"defaultConfig",get:function(){return{property:null,value:null,operator:null,filterBy:null,convert:null,caseSensitive:!0,id:null}}}]),n}(ue.mixin(ni));Vi._$name="CollectionFilter";var zi=function(){function e(){v()(this,e)}return g()(e,null,[{key:"generateId",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"generatedId";return t+(e.idCounts[t]=(e.idCounts[t]||0)+1)}}]),e}();function Wi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}zi.idCounts={},zi._$name="IdHelper";var Gi=function(e){fe()(n,e);var t=Wi(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e){"function"==typeof e&&(e={sortFn:e}),we()(pe()(n.prototype),"construct",this).call(this,e)}},{key:"defaultSortFn",value:function(e,t){var n=this.convert,r=this.property,i=this.useLocaleSort,o="desc"===this.direction.toLowerCase()?-1:1;if(e=e[r],t=t[r],n&&(e=n(e),t=n(t)),i&&null!=e&&null!=t){if(!0===i)return String(e).localeCompare(t);if("string"==typeof i)return String(e).localeCompare(t,i);if("object"===l()(i))return String(e).localeCompare(t,i.locale,i)}return(e>t?1:e<t?-1:0)*o}},{key:"id",get:function(){return this._id||(this._id=this.property||zi.generateId("b-sorter"))},set:function(e){this._id=e}},{key:"sortFn",set:function(e){this._sortFn=e},get:function(){return this._sortFn?this._sortFn:this.defaultSortFn}}],[{key:"generateSortFunction",value:function(e,t){var n=e.isCollection?e.values:e,r=n.length;return function(e,i){var o,a;for(a=0;a<r;++a)if(o=n[a].sortFn(e,i))return o;return t?t(e,i):0}}},{key:"defaultConfig",get:function(){return{property:null,direction:"ASC",sortFn:null,convert:null,id:null,useLocaleSort:null}}}]),n}(ue);function Yi(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Gi._$name="CollectionSorter";var Ui=function(){return 0},qi=function(e,t){return t-e},Ki=Symbol("filteredIndicesProperty"),Xi=Object.freeze([]),Zi=Object.freeze({action:"sort",added:Xi,removed:Xi,replaced:Xi}),Ji=Object.freeze({action:"filter",added:Xi,removed:Xi,replaced:Xi}),Qi={string:1,number:1};function eo(e,t,n){if(!1!==t.unique)t.set(n,e);else{var r=t.get(n);r||(r=new Set,t.set(n,r)),r.add(e)}}function to(e,t,n,r){for(var i=0;i<e.length;i++)for(var o=e[i],a=0;a<r;a++){var s=n[a],u=o[s];eo(o,t[s],u)}}var no=function(e){fe()(n,e);var t=Yi(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e){this.generation=0,this._values=[],we()(pe()(n.prototype),"construct",this).call(this,e)}},{key:"doDestroy",value:function(){var e;we()(pe()(n.prototype),"doDestroy",this).call(this);var t=this;t._values.length=0,t.isFiltered&&(t._filteredValues.length=0,t.filters.destroy()),null===(e=t._sorters)||void 0===e||e.destroy()}},{key:"clear",value:function(){var e=this,t=e._values.slice();e.totalCount&&(e._values.length=0,e._filteredValues&&(e._filteredValues.length=0),e._indicesInvalid=!0,e.generation++,e.trigger("change",{action:"clear",removed:t}))}},{key:"replaceValues",value:function(e){var t,n,r=e.values,i=e.filteredValues,o=e.silent,a=void 0!==o&&o,s=e.isNewDataset,u=void 0!==s&&s,c=this;c.isFiltered&&!u?(Boolean(i)?r&&(t=c._values,c._values=r.slice()):(i=r.slice(),r=null),n=c._filteredValues,c._filteredValues=i.slice()):(t=c._values,c._values=r.slice(),i=null,c.isFiltered&&u&&c.autoFilter?(c._filterFunction=null,c._filteredValues=c._values.filter(c.filterFunction)):c._filteredValues&&(c._filteredValues.length=0));c._indicesInvalid=!0,c.generation++,a||c.trigger("change",{action:"replaceValues",replacedValues:t,replacedFilteredValues:n,values:r,filteredValues:i})}},{key:Symbol.iterator,value:function(){return this.values[Symbol.iterator]()}},{key:"forEach",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];(this.isFiltered&&!t?this._filteredValues:this._values).forEach(e)}},{key:"map",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(this.isFiltered&&!t?this._filteredValues:this._values).map(e)}},{key:"find",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(this.isFiltered&&!t?this._filteredValues:this._values).find(e)}},{key:"add",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];1===t.length?this.splice.apply(this,[this._values.length,null].concat(t)):this.splice(this._values.length,null,t)}},{key:"remove",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];1===t.length?this.splice.apply(this,[0].concat(t)):this.splice(0,t)}},{key:"move",value:function(e,t){var n=this._values,r=this.indexOf(e,!0),i=t?this.indexOf(t,!0):n.length;if(-1===r||-1===i)throw new Error("Collection move parameters must be present in Collection");return r!==i&&r!==i-1&&(r<i&&i--,n.splice(r,1),n.splice(i,0,e),this.trigger("change",{action:"move",item:e,from:r,to:i})),i}},{key:"splice",value:function(){for(var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1?arguments[1]:void 0,n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];var o,a,s=this,u=s.idProperty,c=s._values,l={},f=[],h=[],v=s.totalCount;if(r)if(1===r.length&&Array.isArray(r[0])&&(r=r[0]),v&&r.length){var p=s.indices[u];o=[];for(var g=0;g<r.length;g++){var y=r[g],m=y[u],k=p.get(m),b=k?c.indexOf(k):-1;l[m]=!0,-1!==b?c[b]!==y&&(h.push([c[b],y]),c[b]=y):o.push(y)}}else o=r;if(t){if("number"==typeof t)for(var w=e;t;--t){var C=c[w][u];l[C]?(e++,w++):(f.push(c[w]),c.splice(w,1),a=!0)}else{var S,D=0===o.length;Array.isArray(t)||(t=[t]);var R=t.reduce((function(e,t){var n="number"==typeof t,r=n?t:s.indexOf(t,!0);return D&&(null!=S&&r!==S+1||n)&&(D=!1),r>=0&&r<v&&e.push(r),S=r,e}),[]).sort(qi);if(D)R.length&&(f.push.apply(f,t),c.splice(R[R.length-1],R.length),a=!0);else for(var x=0;x<R.length;x++){var E=R[x];if(-1!==E){var T=c[E][u];l[T]||(f.unshift(c[E]),c.splice(E,1),a=!0)}}}f.length&&!s._indicesInvalid&&f.forEach(s.removeFromIndices,s)}if(o.length&&(c.splice.apply(c,[Math.min(e,c.length),0].concat(d()(o))),a=!0,s._indicesInvalid||o.forEach(s.addToIndices,s)),h.length&&!s._indicesInvalid&&h.forEach((function(e){s.removeFromIndices(e[0]),s.addToIndices(e[1])})),a||h.length){if(s.isSorted)s.onSortersChanged();else if(s.isFiltered){var M;if(s.autoFilter)s.onFiltersChanged();else(M=s._filteredValues).push.apply(M,d()(o))}s.generation++,s.trigger("change",{action:"splice",removed:f,added:o,replaced:h,oldCount:v})}else s.trigger("noChange",{index:e,toRemove:t,toAdd:r})}},{key:"changeId",value:function(e,t){var n=this,r=n.idProperty,i=Qi[l()(e)]?e:e[r],o=n.get(i);if(o){var a=n.get(t);if(a&&o!==a)throw new Error("Attempt to set item ".concat(i," to already existing member's id ").concat(t));n.removeIndexEntry(e,r,i),n.addIndexEntry(e,r,t),o[r]=t}}},{key:"get",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.getBy(this.idProperty,e,t)}},{key:"getAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.isFiltered&&!t?this._filteredValues[e]:this._values[e]}},{key:"getBy",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.findItem(e,t,this.isFiltered&&n)}},{key:"updateIdProperty",value:function(e){this.addIndex({property:e,unique:!0})}},{key:"changeSorters",value:function(e){return new n({values:Array.isArray(e)?e:[e],listeners:{change:"onSortersChanged",thisObj:this}})}},{key:"addSorter",value:function(e){var t=e instanceof Gi?e:new Gi(e);return this.sorters.add(t),t}},{key:"onSortersChanged",value:function(){delete this._sortFunction,this._values.sort(this.sortFunction),this.trigger("change",Zi)}},{key:"addFilter",value:function(e){var t=e instanceof Vi?e:new Vi(e);return this.filters.add(t),t}},{key:"onFiltersChanged",value:function(){var e=this;e._filterFunction=null,e._filteredValues=e._values.filter(e.filterFunction),e._indicesInvalid=!0,e.trigger("change",Ji)}},{key:"changeExtraKeys",value:function(e){return(Array.isArray(e)?e:[e]).map((function(e){return"string"==typeof e?{property:e,unique:!0}:e}))}},{key:"updateExtraKeys",value:function(e){for(var t=0;t<e.length;t++)this.addIndex(e[t])}},{key:"addIndex",value:function(e){e&&((this._indices||(this._indices={}))[e.property]=new Map,Object.assign(this._indices[e.property],e),this._indicesInvalid=!0)}},{key:"findIndex",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.findItem(e,t,n);if(!r)return-1;var i=this.isFiltered&&!n?this._filteredValues:this._values;return i.indexOf(r)}},{key:"findItem",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.isFiltered,o=i&&!n?r.indices[Ki][e]:r.indices[e];if(o){var a,s=null!==(a=o.get(t))&&void 0!==a?a:"string"==typeof t&&!isNaN(t)&&o.get(Number(t))||null;if(null!=s)return s}else for(var u=i&&!n?r._filteredValues:r._values,c=u.length,l=0;l<c;l++){var f=u[l];if(f[e]==t)return f}return null}},{key:"indexOf",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.findIndex(this.idProperty,Qi[l()(e)]?e:e[this.idProperty],t)}},{key:"includes",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Boolean(this.findItem(this.idProperty,Qi[l()(e)]?e:e[this.idProperty],t))}},{key:"rebuildIndices",value:function(){var e,t=this,n=t.isFiltered,r=t._indices||(t._indices={}),i=Object.keys(r),o=i.length,a=t._values;n&&(e=r[Ki]={});for(var s=0;s<o;s++){var u=r[i[s]];if(u.clear(),n){var c=e[i[s]];c?c.clear():(c=e[i[s]]=new Map).unique=u.unique}}to(a,r,i,o),n&&to(t._filteredValues,e,i,o),t._indicesInvalid=!1}},{key:"getIndices",value:function(e){var t=[this.indices[e]];return this.isFiltered&&t.push(this.indices[Ki][e]),t}},{key:"addToIndices",value:function(e){var t=this;Object.keys(this.indices).forEach((function(n){t.addIndexEntry(e,n,e[n])}))}},{key:"removeFromIndices",value:function(e){var t=this;Object.keys(this.indices).forEach((function(n){t.removeIndexEntry(e,n,e[n])}))}},{key:"removeIndexEntry",value:function(e,t,n){this.getIndices(t).forEach((function(t){return function(e,t,n){!1!==t.unique?t.delete(n):t.has(n)&&(t.get(n).delete(e),t.get(n).size||t.delete(n))}(e,t,n)}))}},{key:"addIndexEntry",value:function(e,t,n){this.getIndices(t).forEach((function(t){return eo(e,t,n)}))}},{key:"onItemMutation",value:function(e,t){var n=this;this.extraKeys&&!this._indicesInvalid&&Object.keys(t).forEach((function(r){if(n.indices[r]){var i=t[r],o=i.value,a=i.oldValue;n.removeIndexEntry(e,r,a),n.addIndexEntry(e,r,o)}}))}},{key:"isCollection",get:function(){return!0}},{key:"values",set:function(e){this._indicesInvalid=!0,this.splice(0,this._values.length,e)},get:function(){return this.isFiltered?this._filteredValues:this._values}},{key:"first",get:function(){return this.values[0]}},{key:"last",get:function(){return this.values[this.count-1]}},{key:"allValues",get:function(){return this._values}},{key:"count",get:function(){return this.values.length}},{key:"totalCount",get:function(){return this._values.length}},{key:"isSorted",get:function(){var e;return Boolean(null===(e=this._sorters)||void 0===e?void 0:e.count)}},{key:"sortFunction",get:function(){return this._sortFunction||(this.isSorted?this._sortFunction=Gi.generateSortFunction(this.sorters.values):this._sortFunction=Ui),this._sortFunction}},{key:"filters",get:function(){return this._filters||(this._filters=new n({listeners:{change:"onFiltersChanged",thisObj:this}})),this._filters}},{key:"isFiltered",get:function(){return Boolean(this._filters&&this._filters.count)}},{key:"filterFunction",get:function(){return this._filterFunction||(this.isFiltered?this._filterFunction=Vi.generateFiltersFunction(this.filters.values):this._filterFunction=xe.returnTrue),this._filterFunction}},{key:"indices",get:function(){return this._indicesInvalid&&this.rebuildIndices(),this._indices}}],[{key:"configurable",get:function(){return{idProperty:"id",extraKeys:null,autoFilter:!0,sorters:{$config:["lazy"],value:[]}}}}]),n}(ue.mixin(Ge));function ro(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return io(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return io(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function io(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}no._$name="Collection";var oo=new WeakMap,ao=function(e){if(e&&"object"===l()(e)){var t=oo.get(e);void 0===t&&(t=Symbol("bscik"),oo.set(e,t)),e=t}return e},so=function(){function e(t){v()(this,e);var n=this;n.generation=0,n.items=new Set,n.idMap={},n.idProperty="id",t&&(t.idProperty&&(n.idProperty=t.idProperty),t.values&&(n.values=t.values))}return g()(e,[{key:"get",value:function(e){return this.idMap[ao(e)]}},{key:"add",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];1===t.length&&Array.isArray(t[0])&&(t=t[0]);for(var r=this,i=r.items,o=r.idMap,a=r.idProperty,s=t.length,u=0;u<s;u++){var c=t[u],f=Qi[l()(c)]?c:ao(c[a]),d=o[f];null==d?(o[f]=c,i.add(c),r.generation++):d!==c&&(o[f]=c,i.delete(d),i.add(c))}}},{key:"remove",value:function(e){Array.isArray(e)||(e=[e]);for(var t=this.items,n=this.idMap,r=this.idProperty,i=e.length,o=0;o<i;o++){var a=e[o],s=Qi[l()(a)]?a:ao(a[r]),u=n[s];null!=u&&(t.delete(u),delete n[s],this.generation++)}}},{key:"clear",value:function(){this.items.clear(),this.idMap={},this.generation++}},{key:"changeId",value:function(e,t){var n=this.idMap,r=this.idProperty,i=Qi[l()(e)]?e:ao(e[r]),o=this.get(i);if(o){var a=this.get(t);if(a&&o!==a)throw new Error("Attempt to set item ".concat(i," to already existing member's id ").concat(t));o[r]=t,delete n[i],n[t]=o}}},{key:"includes",value:function(e){var t=Qi[l()(e)]?e:ao(e[this.idProperty]);return Boolean(this.idMap[t])}},{key:"map",value:function(e,t){var n=this.items,r=new Array(n.size),i=0;return n.forEach((function(o){r[i]=e.call(t,o,i++,n)})),r}},{key:"forEach",value:function(e,t){return this.items.forEach(e,t)}},{key:"find",value:function(e){var t,n=ro(this.items);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(e(r))return r}}catch(e){n.e(e)}finally{n.f()}}},{key:Symbol.iterator,value:function(){return this.items[Symbol.iterator]()}},{key:"indexOf",value:function(e){return this.values.indexOf(e)}},{key:"sort",value:function(e){this.values=this.values.sort(e)}},{key:"some",value:function(e,t){return this.values.some(e,t)}},{key:"count",get:function(){return this.items.size}},{key:"values",get:function(){return d()(this.items)},set:function(e){Array.isArray(e)||(e=[e]),this.clear(),this.add.apply(this,e),this.generation++}}]),e}();function uo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}so._$name="Bag";var co=function(e){fe()(n,e);var t=uo(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"add",value:function(){for(var e,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];return 1===r.length&&Array.isArray(r[0])&&(r=r[0]),(e=we()(pe()(n.prototype),"add",this)).call.apply(e,[this].concat(d()(r.filter((function(e){return e.isPersistable})))))}}]),n}(so);function lo(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return fo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return fo(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function fo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ho(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}co._$name="StoreBag";function vo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}function po(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var go={add:1,replace:1};function yo(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function mo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}function ko(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}function bo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}function wo(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Co(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Co(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Co(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function So(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var Do=function(e,t){return-1!==String(e).toLowerCase().indexOf(t)},Ro={string:Do,number:Do,boolean:Do,date:function(e,t){return e instanceof Date&&t instanceof Date?String(e)===String(t):-1!==String(e.getMonth()+1).indexOf(t)||-1!==String(e.getDate()).indexOf(t)||-1!==String(e.getFullYear()).indexOf(t)}};function xo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}function Eo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var To=function(){return!0};function Mo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}function Ao(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Po(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Po(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Po(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Io(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var Oo=Object.freeze([]),Fo=function(){function e(){v()(this,e)}return g()(e,null,[{key:"preWalk",value:function(e,t,n){for(var r,i,o=[e];o.length;)n(r=o.pop()),(i=t(r))&&o.push.apply(o,i.slice().reverse())}},{key:"preWalkWithParent",value:function(e,t,n){for(var r=[{node:e,parent:null}],i=function(){var e=r.pop(),i=e.parent,o=e.node;n(i,o);var a=t(o);a&&r.push.apply(r,d()(a.slice().reverse().map((function(e){return{node:e,parent:o}}))))};r.length;)i()}},{key:"preWalkUnordered",value:function(e,t,n){for(var r,i,o=[e];o.length;)n(r=o[o.length-1]),(i=t(r))?o.splice.apply(o,[o.length-1,1].concat(d()(i))):o.length=o.length-1}},{key:"postWalk",value:function(e,t,n){for(var r,i,o=new Map,a=[e];a.length;)r=a[a.length-1],o.has(r)?(n(r),a.pop()):((i=t(r))&&(a=a.concat(i.slice().reverse())),o.set(r,r))}},{key:"prePostWalk",value:function(e,t,n,r){for(var i,o,a=new Map,s=[e];s.length;)i=s[s.length-1],a.has(i)?(r(i),s.pop()):(n(i),(o=t(i))&&(s=s.concat(o.slice().reverse())),a.set(i,i))}}]),e}();function Lo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Fo._$name="WalkHelper";function jo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var _o=Symbol("STM_PROP");function Bo(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Ho(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ho(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Ho(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function $o(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var No=function(e){fe()(n,e);var t=$o(n);function n(){var e;v()(this,n);for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];return(e=t.call.apply(t,[this].concat(i))).objectify?he()(e,e.initProxy()):e}return g()(n,null,[{key:"properties",get:function(){return{relationCache:{},dependentStoreConfigs:new Map}}},{key:"defaultConfig",get:function(){return{id:!0,fields:null,autoTree:!0,modelClass:Bi,data:null,tree:!1,callOnFunctions:!0,storage:null,useRawData:!1,allowNoId:!0,preventSubClassingModel:null}}},{key:"identifiable",get:function(){return{}}}]),g()(n,[{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this;Object.assign(t,{added:new co,removed:new co,modified:new co,idRegister:{},internalIdRegister:{}}),we()(pe()(n.prototype),"construct",this).call(this,e),t.initRelations()}},{key:"doDestroy",value:function(){for(var e,t=this,r=t.registeredRecords,i=r.length-1;i>=0;i--){var o;(null===(o=e=r[i])||void 0===o?void 0:o.isDestroyed)||e.unJoinStore(t)}t.storage.destroy(),t.stm&&t.stm.removeStore(t),we()(pe()(n.prototype),"doDestroy",this).call(this)}},{key:"beginBatch",value:function(){this.suspendEvents()}},{key:"endBatch",value:function(){this.resumeEvents()&&this.trigger("refresh",{action:"batch",data:this.storage.values,records:this.storage.values})}},{key:"onDataChange",value:function(e){var t,r=e.source,i=e.action,o=e.added,a=e.removed,s=e.replaced,u=e.oldCount,c=e.item,l=e.from,f=e.to,d=this,h=null==o?void 0:o.length,v=null==a?void 0:a.length;if(d._idMap=null,h&&o.forEach((function(e){e.joinStore(d)})),null==s||s.forEach((function(e){var t=ye()(e,2),n=t[0],r=t[1];n.unJoinStore(d,!0),r.joinStore(d)})),we()(pe()(n.prototype),"onDataChange",this).apply(this,arguments),!d.isTree){if(h){var p,g=Bo(o);try{for(g.s();!(p=g.n()).done;){var y=p.value;d.removed.includes(y)?d.removed.remove(y):d.added.add(y)}}catch(e){g.e(e)}finally{g.f()}(t=!d.remoteFilter&&d.filtered&&d.reapplyFilterOnAdd)&&d.filter({silent:!0})}if(v){var m,k=Bo(a);try{for(k.s();!(m=k.n()).done;){var b=m.value;b.unJoinStore(d),d.added.includes(b)?d.added.remove(b):b._undoingInsertion||d.removed.add(b)}}catch(e){k.e(e)}finally{k.f()}d.modified.remove(a),(t=!d.remoteFilter&&d.filtered)&&d.filter({silent:!0})}}switch(i){case"clear":d.relationCache={},d.updateDependentStores("removeall"),d.trigger("removeAll"),d.trigger("change",{action:"removeall"});break;case"splice":if(h){d.updateDependentStores("add",o);var w=o.reduce((function(e,t){var n=t.meta.previousIndex;return n>-1&&n<e&&(e=n),e}),o[0].meta.previousIndex),C=r.indexOf(o[0],!r.autoFilter),S={records:o,index:C};w>-1&&(S.oldIndex=w),d.trigger("add",S),d.trigger("change",Object.assign({action:"add"},S)),t&&d.triggerFilterEvent({action:"filter",filters:d.filters,oldCount:u,records:d.storage.allValues})}a.length&&(d.updateDependentStores("remove",a),d.trigger("remove",{records:a}),d.trigger("change",{action:"remove",records:a})),s.length&&(d.trigger("replace",{records:s,all:d.records.length===s.length}),d.trigger("change",{action:"replace",replaced:s,all:d.records.length===s.length}));break;case"filter":d.isGrouped?d.group(null,null,null,null,!0):d.isSorted&&d.performSort(!0);break;case"move":for(var D=d.storage.allValues,R=Math.min(l,f);R<=Math.max(l,f);R++)D[R].setData("parentIndex",R);d.trigger("move",{record:c,from:l,to:f}),d.trigger("change",{action:i,record:c,from:l,to:f})}}},{key:"onDataReplaced",value:function(e,t){var n,r=this;if(r.storage.allValues.forEach((function(e){e.joinStore(r)})),r.prepareGroupRecords(r.storage.values),r.restoreCollapsedGroups(),!r.remoteFilter&&r.isFiltered&&r.filter({silent:!0}),r.isGrouped&&r.group(null,null,!1,!r.sorters.length,!0),!r.sortParamName&&r.sorters.length&&r.sort(null,null,!1,!0),!r.useRawData.disableDuplicateIdCheck){var i=r.idMap;if(Object.keys(i).length<r.storage.values.length){var o=[];throw r.storage.values.forEach((function(e){return i[e.id]?delete i[e.id]:o.push(e)})),new Error("Id collision on ".concat(o.map((function(e){return e.id}))))}}var a={action:e,data:t,records:r.storage.values};r.updateDependentStores(e,a.records),null===(n=r.afterLoadData)||void 0===n||n.call(r),r.trigger("refresh",a),r.trigger("change",a)}},{key:"onModelChange",value:function(e,t,n,r,i){var o=this,a=e.constructor.idField,s={record:e,changes:n,batch:null!=e.batching,fromRelationUpdate:i},u=!e.ignoreBag&&o.updateModifiedBagForRecord(e);if(this.storage.onItemMutation(e,n),!r){if(a in n){var c=t[a],l=c.oldValue,f=c.value;o.updateDependentRecordIds(l,f),o.onRecordIdChange({record:e,oldValue:l,value:f}),o.trigger("idChange",{store:o,record:e,oldValue:l,value:f})}o.onUpdateRecord(e,n),o.trigger("update",s),o.trigger("change",Object.assign({action:"update"},s))}o.autoCommit&&u&&o.doAutoCommit()}},{key:"updateModifiedBagForRecord",value:function(e){var t=this,n=!1;return e.isModified?t.modified.includes(e)||t.added.includes(e)||!e.isPartOfStore(t)||e.isAutoRoot||(e.isPhantom?t.added.add(e):t.modified.add(e),n=!0):t.modified.remove(e),n}},{key:"buildRootNode",value:function(){return{}}},{key:"setStoreData",value:function(e){var t=this;if(t.getConfig("plugins"),t.processConfiguredListeners(),e&&!Array.isArray(e)&&(e=an.transformNamedObjectToArray(e,t.modelClass.idField)),t.tree=!t.isChained&&(t.tree||Boolean(t.autoTree&&e&&e.some((function(e){return e[t.modelClass.childrenField]})))),t.syncDataOnLoad&&t._data)t.syncDataset(e);else{if(t._data=e,t.tree){var n=t.rootNode;n.clearChildren(!0),n.isLoading=!0,n.appendChild(e),t.updateDependentStores("dataset",[n]),n.isLoading=!1,0===e.length?t.trigger("refresh",{action:"dataset",data:[],records:[]}):t.isFiltered&&t.filter()}else t.loadData(e);t.added.clear(),t.removed.clear(),t.modified.clear()}}},{key:"loadData",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"dataset",n=this,r=n.storage,i=n.allowNoId,o=n.modelClass.fieldMap.id.dataSource;if(n.storeCollapsedGroups(),n.removeHeadersAndFooters(n.storage.values),n._idMap=null,e){var a=!(e[0]instanceof Bi);if(a){n.modelClass.exposeProperties(e[0]);for(var s=e.length,u=new Array(s),c=0;c<s;c++){var l=e[c];if(!i&&null==l[o])throw new Error("Id required but not found on row ".concat(c));u[c]=n.processRecord(n.createRecord(l,!0),!0),u[c].setData("parentIndex",c)}n.allCount&&n.clear(!1),r.replaceValues({values:u,isNewDataset:!0,silent:!0})}else n.allCount&&n.clear(!1),r.replaceValues({values:e.slice(),isNewDataset:!0,silent:!0});n.onDataReplaced(t,e)}else n.allCount&&n.clear(!1),n._data=null}},{key:"getRange",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return(n?this.storage.allValues:this.storage.values).slice(e,t)}},{key:"createRecord",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return new this.modelClass(e,this,null,t)}},{key:"processRecord",value:function(e){return e}},{key:"refreshData",value:function(){this.filter(),this.sort()}},{key:"onRecordIdChange",value:function(e){var t=e.record,n=e.oldValue,r=e.value,i=this,o=i._idMap,a=i.idRegister;i.storage._indicesInvalid=!0,o&&(delete o[n],o[r]=t),i.added.changeId(n,r),i.removed.changeId(n,r),i.modified.changeId(n,r),delete a[n],a[r]=t,t.index=i.storage.indexOf(t)}},{key:"onUpdateRecord",value:function(e,t){var n=t.internalId,r=this.internalIdRegister;n&&(this.storage._indicesInvalid=!0,delete r[n.oldValue],r[n.value]=e),this.reapplyFilterOnUpdate&&this.isFiltered&&this.filter()}},{key:"getCount",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return e?this.count:this.originalCount}},{key:"getAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.storage.getAt(e,t)}},{key:"register",value:function(e){var t=this.isTree&&this.idRegister[e.id];if(t&&t!==e)throw new Error("Id collision on ".concat(e.id));this.idRegister[e.id]=e,this.internalIdRegister[e.internalId]=e}},{key:"unregister",value:function(e){delete this.idRegister[e.id],delete this.internalIdRegister[e.internalId]}},{key:"getById",value:function(e){return(null==e?void 0:e.isModel)?e:this.idRegister[e]}},{key:"isAvailable",value:function(e){var t=this.getById(e);return t&&this.storage.includes(t)||!1}},{key:"getByInternalId",value:function(e){return this.internalIdRegister[e]}},{key:"includes",value:function(e){return this.isTree?null!=this.idRegister[Bi.asId(e)]:this.indexOf(e)>-1}},{key:"indexOf",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=Bi.asId(e);if(null==n)return-1;if(this.isTree)return this.storage.indexOf(n);var r=this.idMap[n];return r?r[t?"visibleIndex":"index"]:-1}},{key:"allIndexOf",value:function(e){var t=this;if(this.isTree){var n=this.getById(e),r=-1;return n&&n.bubble((function(e){e.parent?r+=e.parentIndex+1:e===t.rootNode&&t.rootVisible&&(r+=1)})),r}return this.storage.indexOf(e,!0)}},{key:"getDistinctValues",value:function(e){var t,n=[],r={};return this.forEach((function(i){i.isSpecialRow||i.isRoot||(t=i.get(e),r[t]||(n.push(t),r[t]=1))})),n}},{key:"getValueCount",value:function(e,t){var n=0;return this.forEach((function(r){an.isEqual(r.get(e),t)&&n++})),n}},{key:"toJSON",value:function(){return(this.isTree?this.rootNode.children:this).map((function(e){return e.toJSON()}))}},{key:"forEach",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,n=function(n,r){if(!n.isRoot&&!n.isSpecialRow)return e.call(t,n,r)};if(this.isTree)this.rootNode.traverseWhile(n);else for(var r=this.storage.values,i=0;i<r.length;i++)if(!1===n(r[i],i))return}},{key:"map",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;return this.storage.values.map(e,t)}},{key:"reduce",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this;return n!==this&&(e=e.bind(n)),this.storage.values.reduce(e,t,n)}},{key:Symbol.iterator,value:function(){return this.storage.values[Symbol.iterator]()}},{key:"traverse",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootNode,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t===this.rootNode,r=this;if(r.isTree){if("boolean"==typeof t&&(n=t,t=r.rootNode),r.isChained){var i=e;e=function(e){r.chainedFilterFn(e)&&i(e)}}t.traverse(e,n)}else{var o,a=Bo(r.storage);try{for(a.s();!(o=a.n()).done;){var s=o.value;s.traverse(e)}}catch(e){a.e(e)}finally{a.f()}}}},{key:"traverseWhile",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.rootNode,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t===this.rootNode,r=this;if(r.isTree){if("boolean"==typeof t&&(n=t,t=r.rootNode),r.isChained){var i=e;e=function(e){r.chainedFilterFn(e)&&i(e)}}t.traverseWhile(e,n)}else{var o,a=Bo(r.storage);try{for(a.s();!(o=a.n()).done;){var s=o.value;if(!1===s.traverse(e))break}}catch(e){a.e(e)}finally{a.f()}}}},{key:"getNext",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.storage.values,o=r.indexOf(e);if(o>=i.length-1){if(!t)return null;o=-1}var a=i[o+1];return n&&a&&a.isSpecialRow?r.getNext(i[o+1],t,!0):a}},{key:"getPrev",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.storage.values,o=r.indexOf(e);if(0===o){if(!t)return null;o=i.length}var a=i[o-1];return n&&a&&a.isSpecialRow?r.getNext(i[o+1],t,!0):a}},{key:"getAdjacent",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return t?this.getNext(e,n,r):this.getPrev(e,n,r)}},{key:"getNextLeaf",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r=n.leaves,i=n.getById(e),o=r.indexOf(i);if(o>=r.length-1){if(!t)return null;o=-1}return r[o+1]}},{key:"getPrevLeaf",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r=n.leaves,i=n.getById(e),o=r.indexOf(i);if(0===o){if(!t)return null;o=r.length}return r[o-1]}},{key:"getAdjacentLeaf",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return t?this.getNextLeaf(e,n):this.getPrevLeaf(e,n)}},{key:"makeChained",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:function(){return!0},t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return new this.constructor(Object.assign(n||{},{tree:!1,autoTree:!1,masterStore:this,modelClass:this.modelClass,chainedFilterFn:e,chainedFields:t}))}},{key:"chain",value:function(){return this.makeChained.apply(this,arguments)}},{key:"storage",set:function(e){var t=this;(null==e?void 0:e.isCollection)?t._storage=e:t._storage=new no(e),t._storage.autoFilter=t.reapplyFilterOnAdd;var n,r=Bo(t._storage);try{for(r.s();!(n=r.n()).done;){n.value.joinStore(t)}}catch(e){r.e(e)}finally{r.f()}t._storage.on({change:"onDataChange",thisObj:t})},get:function(){return this._storage||(this.storage={}),this._storage}},{key:"allRecords",get:function(){var e=this;if(e.isTree){var t=e.collectDescendants(e.rootNode,void 0,void 0,{unfiltered:!0}).all;return e.rootVisible&&t.unshift(e.rootNode),t}return e.isGrouped?e.collectGroupRecords():e.storage.allValues}},{key:"idMap",get:function(){var e=this.storage.values,t=!this._idMap,n=this._idMap||(this._idMap={});if(t)for(var r,i=0,o=0;i<e.length;i++)n[(r=e[i]).id]={index:i,visibleIndex:o,record:r},r.isSpecialRow||o++;return n}},{key:"modelClass",get:function(){return this._modelClass},set:function(e){var t=this.fields,n=null;(n=(null==t?void 0:t.length)?function(e){fe()(r,e);var n=$o(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,null,[{key:"fields",get:function(){return t}}]),r}(e):this.preventSubClassingModel?e:function(e){fe()(n,e);var t=$o(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(e)).initClass(),this._modelClass=n}},{key:"storeId",set:function(e){this.id=e},get:function(){return this.id}},{key:"id",set:function(e){if(this._id&&n.unregisterInstance(this),this._id=!0===e?e=n.generateId("store-"):e,e){var t=n.getById(e);t&&n.unregisterInstance(t),n.registerInstance(this)}},get:function(){return this._id}},{key:"tree",get:function(){return this._tree},set:function(e){this._tree=e,e&&!this.rootNode&&(this.rootNode=this.buildRootNode(),this.rootNode.isAutoRoot=!0)}},{key:"rootNode",get:function(){return this.masterStore?this.masterStore.rootNode:this._rootNode},set:function(e){var t,n=this,r=n._rootNode;e!==r&&(r&&n.clear(!1),e instanceof Bi?(e.instanceMeta(n).collapsed=!1,n._rootNode=e):n._rootNode=e=new n.modelClass(Object.assign(ke()({expanded:!0},n.modelClass.idField,"".concat(n.id,"-rootNode")),e),n,null,!0),n._tree=!0,e.isRoot=!0,e.joinStore(n),((null===(t=e.children)||void 0===t?void 0:t.length)||n.rootVisible)&&(e.isLoading=!0,n.onNodeAddChild(e,e.children||[],0),e.isLoading=!1),n.trigger("rootChange",{oldRoot:r,rootNode:e}))}},{key:"data",set:function(e){this.setStoreData(e)},get:function(){return this._data}},{key:"useRawData",get:function(){return this._useRawData},set:function(e){this._useRawData=!0===e?{enabled:!0,disableDuplicateIdCheck:!0,disableTypeConversion:!0,disableDefaultValue:!1}:e?Object.assign(e,{enabled:!0}):{enabled:!1}}},{key:"originalCount",get:function(){return this.storage.totalCount}},{key:"count",get:function(){return this.storage.count}},{key:"allCount",get:function(){return this.isTree?this.rootNode.descendantCount:this.storage.totalCount}},{key:"records",get:function(){return this.storage.values}},{key:"first",get:function(){return this.storage.values[0]}},{key:"last",get:function(){return this.storage.values[this.storage.values.length-1]}},{key:"registeredRecords",get:function(){return Object.values(this.idRegister)}},{key:"json",set:function(e){"string"==typeof e&&(e=E.safeJsonParse(e)),this.data=e},get:function(){return E.safeJsonStringify(this)}},{key:"formattedJSON",get:function(){return E.safeJsonStringify(this,null,4)}}],[{key:"getStore",value:function(e,t){if(e instanceof n)return e;if(this.getById(e))return this.getById(e);if(Array.isArray(e)){var r,i=e.map((function(e){return e instanceof Bi?r=e.constructor:"string"==typeof e&&(e={text:e}),e}));e={autoCreated:!0,data:i,modelClass:r||function(e){fe()(n,e);var t=$o(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Bi),allowNoId:!0},t||(t=n)}return t?new t(e):void 0}},{key:"stores",get:function(){return n.registeredInstances}}]),n}(ue.mixin(ni,Ge,Xr,Jr,(function(e){return function(e){fe()(n,e);var t=vo(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"traverseFilter",value:function(e){var t=this,n=!e.isRoot&&t.filtersFunction(e),r=e.unfilteredChildren||e.children;return r&&r.length?(e.unfilteredChildren||(e.unfilteredChildren=e.children.slice()),e.children=e.unfilteredChildren.filter((function(e){return t.traverseFilter(e)})),e.updateChildrenIndices(e.unfilteredChildren,!0),e.updateChildrenIndices(e.children,!1),n||Boolean(e.children.length)):n}},{key:"traverseClearFilter",value:function(e){var t=this;e.unfilteredChildren&&(e.children=e.unfilteredChildren.slice(),e.unfilteredChildren=null),e.children&&e.children.forEach((function(e){return t.traverseClearFilter(e)}))}},{key:"addFilter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return(e=e instanceof Vi?e:new Vi(e)).owner=this,this.filters.add(e),t||this.filter(),e}},{key:"filter",value:function(e){var t=this,n=t.filters,r=!1;if(e){var i=l()(e);if("object"===i&&("silent"in e||"replace"in e)&&(r=e.silent,e.replace&&n.clear(),e=e.filters,i=l()(e)),e&&(t.isConfiguring=!0,Array.isArray(e)?e.forEach((function(e){return t.addFilter(e,!0)}),t):"function"===i?t.addFilter(new Vi(e),!0):"string"===i?t.addFilter({property:e,value:arguments[1]},!0):t.addFilter(e,!0),t.isConfiguring=!1,!t.isFiltered))return}t.filtersFunction=null,t.performFilter(r)}},{key:"performFilter",value:function(e){var t=this,n=t.storage,r=t.filters,i=t.rootNode,o=t.count;t.tree?(t.isFiltered?t.traverseFilter(i):t.traverseClearFilter(i),n.replaceValues({values:t.collectDescendants(i).visible,silent:!0})):t.isFiltered?n.addFilter({id:"primary-filter",filterBy:t.filtersFunction}):n.filters.clear(),t.afterPerformFilter(e?null:{action:"filter",filters:r,oldCount:o,records:t.storage.values})}},{key:"afterPerformFilter",value:function(e){this.resetRelationCache(),e&&this.triggerFilterEvent(e)}},{key:"triggerFilterEvent",value:function(e){this.trigger("filter",e),this.remoteFilter||(this.trigger("refresh",e),this.trigger("change",e))}},{key:"filterBy",value:function(e){this.filter(e)}},{key:"removeFilter",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r=e instanceof Vi?e:n.filters.get(e);if(r)return n.filters.remove(r),n._filtersFunction=null,t||n.filter(),r}},{key:"clearFilters",value:function(){this.filters.clear(),this.filter()}},{key:"convertFilterToString",value:function(e){var t=this.filters.getBy("property",e);return t&&!t.filterBy?String(t):""}},{key:"reapplyFilterOnAdd",set:function(e){this.storage.autoFilter=e},get:function(){return this.storage.autoFilter}},{key:"filters",set:function(e){var t=this,n=t.filters;if(n.clear(),t._filtersFunction=null,e){if("Object"===e.constructor.name)for(var r=0,i=Object.entries(e);r<i.length;r++){var o=i[r];"filterBy"===o[0]&&"function"==typeof o[1]?n.add(new Vi({filterBy:o[1]})):n.add(new Vi("Object"===o[1].constructor.name?Object.assign({property:o[0]},o[1]):{property:o[0],value:o[1]}))}else Array.isArray(e)?n.add.apply(n,d()(e.map((function(e){return e instanceof Vi?e:new Vi(e)})))):e.isCollection?n.add.apply(n,d()(e.values)):n.add(new Vi({filterBy:e}));n.forEach((function(e){return e.owner=t}))}},get:function(){return this._filters||(this._filters=new no({extraKeys:["property"]}))}},{key:"filtersFunction",set:function(e){this._filtersFunction=e},get:function(){var e=this,t=e.filters,n=e.isGrouped;if(!e._filtersFunction)if(t.count){var r=Vi.generateFiltersFunction(t);e._filtersFunction=function(e){return n&&e.isSpecialRow?e.groupChildren.some(r):r(e)}}else e._filtersFunction=xe.returnTrue;return e._filtersFunction}},{key:"isFiltered",get:function(){return this.filters.values.some((function(e){return!e.disabled}))}},{key:"latestFilterField",get:function(){return this.filters.last?this.filters.last.property:null}},{key:"filtered",get:function(){return this.storage.isFiltered}},{key:"filterState",get:function(){return this.filters.values.map((function(e){return an.cleanupProperties(e.config)}))}}],[{key:"$name",get:function(){return"StoreFilter"}},{key:"defaultConfig",get:function(){return{filters:null,reapplyFilterOnAdd:!1,reapplyFilterOnUpdate:!1}}}]),n}(e||ue)}),(function(e){return function(e){fe()(n,e);var t=ho(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"remove",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r=n.storage;if(e instanceof Set&&(e=Array.from(e)),(e=(Array.isArray(e)?e:[e]).reduce((function(e,t){return(t=n.getById(t))&&e.push(t),e}),[])).length){if(n.isRemoving=!0,n.tree){for(var i=e.reduce((function(e,t){var n=t.parent;return n&&(e[n.id]||(e[n.id]=[n,[]]),e[n.id][1].push(t)),e}),{}),o=0,a=Object.values(i);o<a.length;o++){var s=a[o];s[0].removeChild(s[1],!1,t)}return n.isRemoving=!1,e}if(n.isGrouped){var u,c=r.count,l=[],f=new Set,d=lo(e);try{for(d.s();!(u=d.n()).done;){var h=u.value,v=h.instanceMeta(n),p=v.groupParent;p&&p.meta.collapsed&&l.push(h),De.remove(p.groupChildren,h),p.meta.childCount--,f.add(p)}}catch(e){d.e(e)}finally{d.f()}var g,y=lo(f);try{for(y.s();!(g=y.n()).done;){var m=g.value;n.onModelChange(m,{},{})}}catch(e){y.e(e)}finally{y.f()}l.length&&r.trigger("change",{action:"splice",removed:l,added:[],replaced:[],oldCount:c})}if(!e.length||!t&&!1===n.trigger("beforeRemove",{records:e}))return n.isRemoving=!1,null;t&&n.suspendEvents(),r.remove(e),t&&n.resumeEvents(),n.autoCommit&&n.doAutoCommit(),n.isRemoving=!1}return e}},{key:"clear",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this,n=t.storage;if(t.storage.totalCount){if(e&&!1===t.trigger("beforeRemove",{records:n.allValues,removingAll:!0}))return null;if(!e){for(var r,i=t.registeredRecords,o=i.length-1;o>=0;o--)(r=i[o])&&!r.isDestroyed&&r.unJoinStore(t);t.removed.clear()}e||n.suspendEvents(),n.clear(),e||n.resumeEvents(),t.added.clear(),t.modified.clear()}}},{key:"removeAll",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=this,r=n.storage;if(n.isRemoving=!0,t){r.suspendEvents();for(var i,o=n.registeredRecords,a=o.length-1;a>=0;a--)(i=o[a])&&!i.isDestroyed&&i.unJoinStore(n)}return e=n.tree?!1!==n.rootNode.clear():null!==n.clear(),t&&r.resumeEvents(),n.isRemoving=!1,e}},{key:"add",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r=n.storage,i=[];if(Array.isArray(e)){if(!e.length)return}else e=[e];if(n.tree=n.tree||Boolean(n.autoTree&&e[0].children),n.tree){var o=new Map,a=[];return e.forEach((function(e){var t=e[n.modelClass.parentIdField];o.has(t)||o.set(t,[]),o.get(t).push(e)})),o.forEach((function(e,r){var i=null==r?n.rootNode:n.getById(r);if(!i)throw new Error("Parent node with id ".concat(r," not found, cannot add children."));a.push.apply(a,d()(i.appendChild(e,t)))})),a}return t||!1!==n.trigger("beforeAdd",{records:e})?(n.tree=n.tree||Boolean(n.autoTree&&e[0].children),n.tree?n.rootNode.appendChild(e):(e.forEach((function(e){i.push(n.processRecord(e.isModel?e:n.createRecord(e)))})),t&&n.suspendEvents(),r.add(i),t&&n.resumeEvents(),n.autoCommit&&n.doAutoCommit(),i)):null}},{key:"insert",value:function(e,t){var n,r,i,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=this,s=a.storage,u=[],c=a.getAt(e),l=s.values,f=[];if(Array.isArray(t)||(t=[t]),!1===a.trigger("beforeAdd",{records:t}))return null;if(l[r=e]===t[0]||l[r=e-1]===t[0])for(n=!0,i=0;n&&i<t.length;i++)t[i]!==l[r+i]&&(n=!1);if(n)return null;if(t.forEach((function(t){var n=a.processRecord(t.isModel?t:a.createRecord(t)),r=s.indexOf(n);n.children&&n.children.length&&a.autoTree&&(a.tree=!0),u.push(n),r>-1&&(r<e&&c&&e--,f.push(r)),n.meta.previousIndex=r})),a.tree){var d=a.rootNode;return d.insertChild(t,d.children&&d.children[e])}return a.suspendEvents(),a.storage.remove(f),a.resumeEvents(),o&&a.suspendEvents(),s.splice.apply(s,[e,0].concat(u)),o&&a.resumeEvents(),a.autoCommit&&a.doAutoCommit(),u}},{key:"move",value:function(e,t){this.storage.move(e,t)}},{key:"setMultiple",value:function(e,t,n){var r=this,i=[],o=[];r.forEach((function(r){e(r)&&(o.push(r.set(t,n,!0)),i.push(r))})),r.trigger("updateMultiple",{records:i,all:r.records.length===i.length}),r.trigger("change",{action:"updatemultiple",records:i,all:r.records.length===i.length}),r.reapplyFilterOnUpdate&&r.isFiltered&&r.filter()}},{key:"setAll",value:function(e,t){var n=this,r=[];n.forEach((function(n){r.push(n.set(e,t,!0))})),n.trigger("updateMultiple",{records:n.records,all:!0}),n.trigger("change",{action:"updatemultiple",records:n.records,all:!0}),n.reapplyFilterOnUpdate&&n.isFiltered&&n.filter()}},{key:"acceptChanges",value:function(){var e=this;e.added.forEach((function(e){return e.clearChanges(!1)})),e.modified.forEach((function(e){return e.clearChanges(!1)})),e.added.clear(),e.modified.clear(),e.removed.clear()}},{key:"commit",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=this.changes;return this.callPreventable("commit",{changes:n},(function(){return e.acceptChanges(),n}),[],t)}},{key:"clearChanges",value:function(){var e=this,t=e.changes;e.remove(e.added.values,!0),e.modified.forEach((function(e){return e.clearChanges(!1)})),e.added.clear(),e.modified.clear(),e.removed.clear(),e.trigger("change",{action:"clearchanges",changes:t})}},{key:"suspendAutoCommit",value:function(){this.suspendCount++}},{key:"resumeAutoCommit",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];this.suspendCount--,this.autoCommit&&e&&this.doAutoCommit()}},{key:"doAutoCommit",value:function(){this.suspendCount<=0&&this.commit()}},{key:"applyChangesFromStore",value:function(e){var t=this,n=e.changes;n&&(n.added&&t.add(n.added),n.removed&&t.remove(n.removed.map((function(e){return e.id}))),n.modified&&n.modified.forEach((function(e){t.getById(e.id).set(e.modifications)})))}},{key:"changes",get:function(){var e=this,t=e.modified.values.filter((function(e){return e.rawModifications}));return e.added.count||t.length||e.removed.count?{added:e.added.values.slice(),modified:t,removed:e.removed.values.slice()}:null}},{key:"autoCommit",get:function(){return this._autoCommit},set:function(e){this._autoCommit=e,e&&this.changes&&this.commit()}}],[{key:"$name",get:function(){return"StoreCRUD"}},{key:"defaultConfig",get:function(){return{autoCommit:!1,suspendCount:0}}}]),n}(e||ue)}),(function(e){return function(e){fe()(n,e);var t=ko(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"initRelations",value:function(e){var t=this,n=t.modelClass.relations;e&&t.modelRelations&&t.modelRelations.forEach((function(e){e.storeDetacher&&e.storeDetacher()})),t.modelRelations&&0!==t.modelRelations.length&&!e||!n||(t.modelRelations=[],n&&n.forEach((function(n){var r=Object.assign({},n),i="string"==typeof r.store?t[r.store]:r.store;if(r.dependentStore=t,t.modelRelations.push(r),i){r.storeProperty=r.store,r.store=i;var o=i.dependentStoreConfigs;if(o.has(t)){var a=o.get(t);if(e){var s=a.find((function(e){return e.relationName===r.relationName}));s&&De.remove(a,s)}a.push(r)}else o.set(t,[r]);r.collectionName&&i.initRelationCollection(r,t),i.count>0&&i.updateDependentStores("dataset",i.records)}})))}},{key:"initRelationCollection",value:function(e,t){var n=this,r=e.collectionName;n.collectionStores||(n.collectionStores={}),n.collectionStores[r]={store:t,config:e},n[r+"Store"]||(n[r+"Store"]=t),n.count>0&&n.initModelRelationCollection(r,n.records)}},{key:"initModelRelationCollection",value:function(e,t){var n=this;t.forEach((function(t){t.traverse((function(t){var r=e in t?"$related".concat(E.capitalize(e)):e;Object.defineProperty(t,r,{enumerable:!0,configurable:!0,get:function(){return n.getCollection(this,e)},set:function(t){return n.setCollection(this,e,t)}})}))}))}},{key:"resetRelationCache",value:function(){this.relationCache={},this.forEach((function(e){return e.initRelations()}))}},{key:"updateRecordRelationCache",value:function(e,t){var n=this;t&&t.forEach((function(t){var r=t.related?t.related.id:e.get(t.config.fieldName);void 0!==r&&n.cacheRelatedRecord(e,r,t.config.relationName,r)}))}},{key:"getRelationCollection",value:function(e,t){var n=Bi.asId(t);return this.relationCache[e]&&this.relationCache[e][n]||[]}},{key:"getCollection",value:function(e,t){var n=this.collectionStores[t],r=n.config,i=n.store;return i.relationCache[r.relationName]&&i.relationCache[r.relationName][e.id]||[]}},{key:"setCollection",value:function(e,t,n){var r=this.collectionStores[t],i=r.config,o=r.store;o.relationCache[i.relationName]||(o.relationCache[i.relationName]={});var a=(o.relationCache[i.relationName][e.id]||[]).slice(),s=[],u=[];o.suspendEvents(),a.forEach((function(e){n.includes(e)||(e[i.fieldName]=null,o.remove(e),u.push(e))})),n.forEach((function(t){if(t instanceof Bi)t.stores.includes(o)||(o.add(t),s.push(t));else{var n=o.add(t);t=ye()(n,1)[0],s.push(t)}t[i.fieldName]=e.id})),o.resumeEvents(),u.length&&(o.trigger("remove",{records:u}),o.trigger("change",{action:"remove",records:u})),s.length&&(o.trigger("add",{records:s}),o.trigger("change",{action:"add",records:s}))}},{key:"cacheRelatedRecord",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=this,o=i.relationCache[n]||(i.relationCache[n]={});null!==r&&i.uncacheRelatedRecord(e,n,r),null!=t&&De.include(o[t]||(o[t]=[]),e)}},{key:"uncacheRelatedRecord",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this;function i(t,n){var i=r.relationCache[t],o=i&&i[n];if(o){var a=o.indexOf(e);a>=0&&o.splice(a,1),0===o.length&&delete i[n]}}null!=n?i(t,n):e.meta.relationCache&&Object.entries(e.meta.relationCache).forEach((function(e){var t=ye()(e,2),n=t[0],r=t[1];i(n,r&&r.id)}))}},{key:"updateDependentStores",value:function(e,t){var n=this;this.dependentStoreConfigs.forEach((function(r){r.forEach((function(r){var i=r.dependentStore,o=i.relationCache[r.relationName];return"dataset"===e?(r.collectionName&&n.initModelRelationCollection(r.collectionName,t),void i.forEach((function(e){var t=e.initRelation(r);t&&i.cacheRelatedRecord(e,t.id,r.relationName,t.id)}))):"removeall"===e?(i.forEach((function(e){e.removeRelation(r)})),void delete i.relationCache[r.relationName]):("add"===e&&r.collectionName&&n.initModelRelationCollection(r.collectionName,t),void("add"!==e&&"remove"!==e||t.forEach((function(t){var n=o&&o[t.id];switch(e){case"remove":n&&n.forEach((function(e){return e.removeRelation(r)}));break;case"add":i.forEach((function(e){e.get(r.fieldName)==t.id&&(e.initRelation(r),i.cacheRelatedRecord(e,t.id,r.relationName))}))}}))))}))}))}},{key:"updateDependentRecordIds",value:function(e,t){this.dependentStoreConfigs&&this.dependentStoreConfigs.forEach((function(n){n.forEach((function(n){var r=n.dependentStore,i=r.relationCache[n.relationName],o=i&&i[e]&&i[e].slice();o&&o.forEach((function(i){r.cacheRelatedRecord(i,t,n.relationName,e),i.set(n.fieldName,t,!1,!0)}))}))}))}}],[{key:"$name",get:function(){return"StoreRelation"}}]),n}(e||ue)}),(function(e){return function(e){fe()(n,e);var t=bo(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"sum",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.storage.values;return t?t.reduce((function(t,n){if(n.isSpecialRow)return t;var r=Number(n[e]);return isNaN(r)?t:t+r}),0):0}},{key:"min",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.storage.values;return t&&t.length?t.reduce((function(t,n){return"number"==typeof n[e]&&n[e]<t&&(t=n[e]),t}),t[0][e]):0}},{key:"max",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.storage.values;return t&&t.length?t.reduce((function(t,n){return"number"==typeof n[e]&&n[e]>t&&(t=n[e]),t}),t[0][e]):0}},{key:"average",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.storage.values;if(!t||!t.length)return 0;var n=0,r=t.reduce((function(t,r){if(r.isSpecialRow)return t;var i=parseFloat(r[e]);return isNaN(i)?t:(n++,t+i)}),0);return n>0?r/n:0}},{key:"groupSum",value:function(e,t){return this.sum(t,this.getGroupRecords(e))}}],[{key:"$name",get:function(){return"StoreSum"}}]),n}(e||ue)}),(function(e){return function(e){fe()(n,e);var t=So(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"search",value:function(e){var t,n,r,i,o,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,s=this.storage.values,u=s.length,c=[];if(null==e)return null;for("string"==typeof e&&(e=String(e).toLowerCase()),t=0;t<u;t++){n=s[t];var f,d=wo(a||n.fieldNames);try{for(d.s();!(f=d.n()).done;){var h=f.value;i=(r=n[h])instanceof Date?"date":l()(r),o=Ro[i],r&&o&&o(r,e)&&c.push({index:t,data:n,field:h,id:n.id})}}catch(e){d.e(e)}finally{d.f()}}return c}},{key:"findByField",value:function(e,t){var n,r,i,o=this.storage.values,a=o.length,s=[];for(null!=t&&(t=String(t).toLowerCase()),n=0;n<a;n++){r=o[n];var u=(i=r[e])instanceof Date?"date":l()(i),c={date:function(){return Boolean(i)&&i.toLocaleString().includes(t)},string:function(){return Boolean(i)&&i.toLowerCase().includes(t)},number:function(){return"number"==typeof i&&i.toString().includes(t)},object:function(){return i===t},undefined:function(){return i===t}};(null==t&&i===t||t&&c[u]())&&s.push({id:r.id,index:n,data:r})}return s}},{key:"find",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t?this.storage.allValues:this.storage.values;return this.isGrouped&&(n=this.collectGroupRecords(t,!1)),n.find(e)}},{key:"findRecord",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=function(n){return an.isEqual(n[e],t)};return this.tree?this.query(r)[0]:(n?this.storage.allValues:this.storage.values).find(r)}},{key:"query",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t?this.storage.allValues:this.storage.values;if(this.isTree){var r=[];return this.traverse((function(t){e(t)&&r.push(t)})),r}return this.isGrouped&&(n=this.collectGroupRecords(t,!1)),n.filter(e)}},{key:"some",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t?this.storage.allValues:this.storage.values;return this.isGrouped&&(n=this.collectGroupRecords(t,!1)),n.some(e)}}],[{key:"$name",get:function(){return"StoreSearch"}}]),n}(e||ue)}),(function(e){return function(e){fe()(n,e);var t=xo(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"sort",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=this,a=o.allRecords,s=o.sorters?o.sorters.slice():[],u=null;if(e)if(Array.isArray(e))o.sorters=e.map((function(e){return o.normalizeSorterConfig(e,"string"==typeof e||t)}));else{var c=o.normalizeSorterConfig(e,t);r?(n=o.getCurrentSorterByField(c.field))?(u=n.ascending,n.ascending=c.ascending):o.sorters.push(c):o.sorters=[c]}return i||!1!==o.trigger("beforeSort",{sorters:o.sorters,records:a,currentSorters:s})?o.performSort(i):(o.sorters=s,void(null!==u&&(n.ascending=u)))}},{key:"normalizeSorterConfig",value:function(e,t){var n={ascending:t};if("object"===l()(e)?(n.field=e.field,n.sortFn=e.fn||e.sortFn,n.useLocaleSort=e.useLocaleSort,n.ascending=null!=e.ascending?e.ascending:t):"function"==typeof e?n.sortFn=e:n.field=e,null==n.ascending){var r=this.getCurrentSorterByField(n.field);n.ascending=!r||!r.ascending}if(null==n.sortFn){var i,o,a=null===(i=this.modelClass)||void 0===i||null===(o=i.$meta.fields.map[n.field])||void 0===o?void 0:o.compareItems;a&&(n.sortFn=a)}return n}},{key:"getCurrentSorterByField",value:function(e){return"string"==typeof e&&this.sorters.find((function(t){return t.field===e}))||null}},{key:"addSorter",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.sort(e,t,!0)}},{key:"removeSorter",value:function(e){var t=this.sorters.findIndex((function(t){return t.field===e}));t>-1&&(this.sorters.splice(t,1),this.sort())}},{key:"clearSorters",value:function(){this.sorters.length=0,this.sort()}},{key:"createSorterFn",value:function(e){var t=this.useLocaleSort;return function(n,r){for(var i=0;i<e.length;i++){var o=e[i],a=o.field,s=o.ascending,u=void 0===s||s,c=o.useLocaleSort,f=void 0===c?t:c,d=o.fn||o.sortFn,h=u?1:-1;if(d){var v=d(n,r);if(null!==v)return v*h}var p=n[a],g=r[a];if(p!==g){if(null==p)return-h;if(null==g)return h;if(f){if(!0===f)return String(p).localeCompare(g)*h;if("string"==typeof f)return String(p).localeCompare(g,f)*h;if("object"===l()(f))return String(p).localeCompare(g,f.locale,f)*h}if(p>g)return h;if(p<g)return-h}}return 0}}},{key:"performSort",value:function(e){var t=this,n=t.rootNode,r=t.storage,i=t.sorters,o=t.createSorterFn(t.isGrouped?t.groupers.concat(i):i);t.isGrouped&&t.storeCollapsedGroups()&&r.replaceValues({values:t.removeHeadersAndFooters(r.values),silent:!0}),t.tree?(n.traverse((function(e){e.isLoaded&&e.isParent&&(e.children.sort(o),e.updateChildrenIndices(e.children,!1,!0))})),r.replaceValues({values:t.collectDescendants(n).visible,silent:!0})):r.replaceValues({values:r.values.sort(o),silent:!0}),t.afterPerformSort(e)}},{key:"afterPerformSort",value:function(e){var t=this,n=t.storage;if(t._idMap=null,t.isGrouped&&(n.replaceValues({values:t.prepareGroupRecords(n.values),silent:!0}),t.restoreCollapsedGroups()),!e){var r={action:"sort",sorters:t.sorters,records:t.allRecords};t.trigger("sort",r),t.sortParamName||t.trigger("refresh",r)}}},{key:"isSorted",get:function(){return Boolean(this.sorters.length)||this.isGrouped}}],[{key:"$name",get:function(){return"StoreSort"}},{key:"defaultConfig",get:function(){return{sorters:[],useLocaleSort:null}}}]),n}(e||ue)}),(function(e){return function(e){fe()(n,e);var t=po(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e){we()(pe()(n.prototype),"construct",this).call(this,e),this.on("change",this.onDataChanged)}},{key:"storeCollapsedGroups",value:function(){var e=this;return e.collapsedGroupsHash={},!(!e.groupRecords||!e.groupRecords.length)&&(e.groupRecords.forEach((function(t){e.expand(t)&&(e.collapsedGroupsHash[t.id]=!0)})),!0)}},{key:"restoreCollapsedGroups",value:function(){var e=this,t=e.collapsedGroupsHash;t&&Object.keys(t).forEach((function(t){return e.collapse(e.getById(t))}))}},{key:"onDataChange",value:function(e){var t=e.source,r=e.action,i=e.removed,o=this,a=o.groupers;if(a){var s=t.values;a.length?"splice"===r&&i&&i.length&&(o.storeCollapsedGroups()&&o.storage.replaceValues({values:o.removeHeadersAndFooters(s),silent:!0}),o.storage.replaceValues({values:o.prepareGroupRecords(s),silent:!0}),o.restoreCollapsedGroups()):t.replaceValues({values:o.removeHeadersAndFooters(s),silent:!0})}we()(pe()(n.prototype),"onDataChange",this)&&we()(pe()(n.prototype),"onDataChange",this).apply(this,arguments)}},{key:"collapse",value:function(e){return!(!e||e.meta.collapsed)&&(this.excludeGroupRecords(e),e.meta.collapsed=!0,!0)}},{key:"expand",value:function(e){return!(!e||!e.meta.collapsed)&&(this.includeGroupRecords(e),e.meta.collapsed=!1,!0)}},{key:"removeHeadersAndFooters",value:function(e){var t=this;return e.filter((function(e){return!e.isSpecialRow||(t.unregister(e),!1)}),!0)}},{key:"prepareGroupRecords",value:function(e){var t=this;if(e=t.removeHeadersAndFooters(e),!t.isGrouped)return e;var n=[],r=t.groupers[0].field,i=[],o=null,a=null,s=0;function u(){var e=a.meta.groupRowFor,r="group-footer-".concat("number"==typeof e?e:E.createId(e)),o=t.getById(r)||new t.modelClass({id:r},t,{specialRow:!0,groupFooterFor:e,groupRecord:a});return t.register(o),o.groupChildren=a.groupChildren,i.push(o),n.push(o),t.allRecords.push(o),a.groupChildren.push(o),s++,o}return e.forEach((function(e){var c=null==e[r]?"__novalue__":e[r],l="group-header-".concat("number"==typeof c?c:E.createId(c));!e.groupChildren||e.groupChildren.length?(an.isEqual(c,o)||(a&&(t.useGroupFooters&&u(),a.meta.childCount=s),a=t.getById(l)||new t.modelClass({id:l},t,{specialRow:!0,groupRowFor:c,groupField:r}),t.register(a),a.groupChildren=[],n.push(a),t.allRecords.push(a),i.push(a),o=c,s=0),e.instanceMeta(t.id).groupParent=a,n.push(e),a.groupChildren.push(e),s++):t.unregister(e)})),a&&(t.useGroupFooters&&u(),a.meta.childCount=s),t.groupRecords=i,n}},{key:"group",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=this;if(r?a.groupers.push(n={field:e,ascending:t,complexMapping:e.includes(".")}):e&&(null==t&&(t=!a.groupInfo||a.groupInfo.field!==e||!a.groupInfo.ascending),a.groupInfo=n={field:e,ascending:t,complexMapping:e.includes(".")},a.groupers=[a.groupInfo]),n){var s=a.modelClass.prototype;n.complexMapping&&!Object.prototype.hasOwnProperty.call(s,e)&&Object.defineProperty(s,e,{get:function(){return an.getPath(this,e)}})}!1!==i&&a.sort(null,null,!1,!0),o||(a.trigger("group",{isGrouped:a.isGrouped,groupers:a.groupers,records:a.storage.values}),a.trigger("refresh",{action:"group",isGrouped:a.isGrouped,groupers:a.groupers,records:a.storage.values}))}},{key:"addGrouper",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.group(e,t,!0)}},{key:"removeGrouper",value:function(e){var t=this,n=t.groupers.findIndex((function(t){return t.field===e}));n>-1&&(t.groupers.splice(n,1),t.groupers.length?t.group():t.clearGroupers())}},{key:"clearGroupers",value:function(){this.groupers=null}},{key:"isRecordInGroup",value:function(e,t){if(!this.isGrouped)return null;return e[this.groupers[0]&&this.groupers[0].field]===t&&!e.isSpecialRow}},{key:"isInCollapsedGroup",value:function(e){var t=e.instanceMeta(this).groupParent;return t&&t.meta.collapsed}},{key:"getGroupRecords",value:function(e){var t=this;return t.isGrouped?t.storage.values.filter((function(n){return t.isRecordInGroup(n,e)})):null}},{key:"getGroupTitles",value:function(){return this.isGrouped?this.getDistinctValues(this.groupers[0]&&this.groupers[0].field):null}},{key:"onDataChanged",value:function(e){var t=e.changes,n=e.action;this.isGrouped&&(!t&&go[n]||t&&this.groupers.some((function(e){return e.field in t})))&&this.sort()}},{key:"internalIncludeExcludeGroupRecords",value:function(e,t){var n=this,r=n.indexOf(e),i=n.id;if(-1!==r&&!(e.meta.collapsed&&!t||!e.meta.collapsed&&t)){if(e.groupChildren.forEach((function(e){return e.instanceMeta(i).hiddenByCollapse=!t})),t){var o,a=e.groupChildren.filter((function(e){return!n.isAvailable(e)}));(o=n.storage.values).splice.apply(o,[r+1,0].concat(d()(a)))}else n.storage.values.splice(r+1,e.groupChildren.length);n.storage._indicesInvalid=!0,n._idMap=null}}},{key:"excludeGroupRecords",value:function(e){this.internalIncludeExcludeGroupRecords(e,!1)}},{key:"includeGroupRecords",value:function(e){this.internalIncludeExcludeGroupRecords(e,!0)}},{key:"collectGroupRecords",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=e?this.storage.allValues:this.storage.values;return n.reduce((function(e,n){return n.isSpecialRow&&(t&&e.push(n),"groupRowFor"in n.meta&&e.push.apply(e,n.groupChildren)),e}),[])}},{key:"groupers",get:function(){return this._groupers},set:function(e){var t=this;e&&e.length?t._groupers=e:t.groupers&&(delete t._groupers,t.groupRecords.forEach((function(e){e.meta.collapsed&&t.includeGroupRecords(e)})),t.storage.replaceValues({values:t.removeHeadersAndFooters(t.storage._values),filteredValues:t.storage.isFiltered?t.removeHeadersAndFooters(t.storage._filteredValues):null,silent:!0}),t.group(null,null,null,!1),"groupRecords"in t&&delete t.groupRecords)}},{key:"isGrouped",get:function(){return Boolean(this.groupers&&this.groupers.length)}}],[{key:"$name",get:function(){return"StoreGroup"}},{key:"defaultConfig",get:function(){return{groupers:null}}}]),n}(e||ue)}),(function(e){return function(e){fe()(n,e);var t=Eo(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e){we()(pe()(n.prototype),"construct",this).call(this,e);var t=this,r=t.masterStore;r&&(t.methodNamesToRelay.forEach((function(e){return t[e]=function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return t.relayToMaster(e,r)}})),t.removeAll=function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];r.remove.apply(r,[t.getRange()].concat(n))},r.on({changePreCommit:t.onMasterDataChangedPreCommit,change:t.onMasterDataChanged,prio:1,thisObj:t}),r.chainedStores||(r.chainedStores=[]),r.chainedStores.push(t),t.fillFromMaster())}},{key:"updateChainedStores",value:function(){this.chainedStores&&this.chainedStores.forEach((function(e){return e.fillFromMaster()}))}},{key:"fillFromMaster",value:function(){var e=this,t=e.masterStore,n=e.isTree;if(!e.isChained)throw new Error("fillFromMaster only allowed on chained store");if(e.keepUncommittedChanges){if(n)throw new Error("Cannot use keepUncommittedChanges on a chained tree store");e.data=[].concat(e.added.values.filter((function(t){return!e.removed.includes(t)})),t.allRecords.filter((function(t){return!e.removed.includes(t)&&!e.added.includes(t)&&e.chainedFilterFn(t)})))}else{var r=t.allRecords.filter(e.chainedFilterFn);if(n&&(e.idRegister={},e.internalIdRegister={},r.forEach((function(t){t.stores.includes(e)?e.register(t):t.joinStore(e)})),e.excludeCollapsedRecords)){var i=e.getChildren(e.rootNode);r=e.doIncludeExclude(i,!0)}e.data=r}}},{key:"commitToMaster",value:function(){var e=this,t=e.masterStore;if(!e.isChained)throw new Error("commitToMaster only allowed on chained store");return t.beginBatch(),t.remove(e.removed.values),t.add(e.added.values),t.endBatch(),e.commit()}},{key:"relayToMaster",value:function(e,t){var n;return(n=this.masterStore)[e].apply(n,d()(t))}},{key:"onMasterDataChangedPreCommit",value:function(e){this.onMasterDataChanged(e),this.$masterEventhandled=!0}},{key:"onMasterDataChanged",value:function(e){var t,n=e.action,r=e.changes;e.$handled;this.$masterEventhandled?this.$masterEventhandled=!1:("update"!==n||(null===(t=this.chainedFields)||void 0===t?void 0:t.some((function(e){return e in r}))))&&this.fillFromMaster()}},{key:"isChained",get:function(){return Boolean(this.masterStore)}},{key:"chainedFilterFn",set:function(e){this._chainedFilterFn=this.thisObj?e.bind(this.thisObj):e},get:function(){return this._chainedFilterFn||To}},{key:"methodNamesToRelay",get:function(){var e=this,t=Array.isArray(this.doRelayToMaster),n=Array.isArray(this.dontRelayToMaster);return t&&this.doRelayToMaster.filter((function(t){return!n||!e.dontRelayToMaster.includes(t)}))||[]}}],[{key:"$name",get:function(){return"StoreChained"}},{key:"defaultConfig",get:function(){return{chainedFilterFn:null,chainedFields:null,masterStore:null,doRelayToMaster:["add","remove","insert"],dontRelayToMaster:[],keepUncommittedChanges:!1,excludeCollapsedRecords:!0}}}]),n}(e||ue)}),(function(e){return function(e){fe()(n,e);var t=Mo(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"getState",value:function(){var e=this,t={};return e.sorters&&e.sorters.length&&(t.sorters=e.sorters.slice()),e.groupers&&e.groupers.length&&(t.groupers=e.groupers.slice()),e.filters&&e.filters.values.length&&(t.filters=e.filterState),t}},{key:"applyState",value:function(e){var t=this;"sorters"in e&&(t.sorters=e.sorters.slice()),"groupers"in e&&(t.groupers=e.groupers.slice()),("sorters"in e||"groupers"in e)&&t.sort(),"filters"in e&&(t.filters=e.filters.slice(),t.filter())}}],[{key:"$name",get:function(){return"StoreState"}}]),n}(e||ue)}),(function(e){return function(e){fe()(i,e);var t,n,r=Io(i);function i(){return v()(this,i),r.apply(this,arguments)}return g()(i,[{key:"loadChildren",value:(n=Wr()(Vr.a.mark((function e(t){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})},{key:"onNodeAddChild",value:function(e,t,n,r){var i,o,a=arguments.length>4&&void 0!==arguments[4]&&arguments[4],s=this,u=e===s.rootNode&&e.isLoading,c=s.storage,l=[],f=[],d=t[0].previousSibling;if(s.collectDescendants(t,l,f,{inCollapsedBranch:!(e.isExpanded(s)&&e.ancestorsExpanded(s))}),!u&&f.length){var h,v=Ao(f);try{for(v.s();!(h=v.n()).done;){var p=h.value;s.modified.includes(p)||r[p.id]||(s.removed.includes(p)?s.removed.remove(p):s.added.add(p))}}catch(e){v.e(e)}finally{v.f()}}if(u&&s.rootVisible&&(l.unshift(e),f.unshift(e)),l.length&&(i=0!==n&&d?c.indexOf(d)+d.getDescendantCount(!0,s):c.indexOf(e),c.suspendEvents(),s.storage.splice(++i,0,l),c.resumeEvents()),s.updateDependentStores("add",t),u&&l.length){if(s.sorters.length&&s.sort(null,null,!1,!0),null===(o=s.afterLoadData)||void 0===o||o.call(s),!a){var g={action:"dataset",data:s._data,records:l};s.trigger("refresh",g),s.trigger("change",g)}}else if(!a){var y={action:"add",parent:e,isChild:!0,isMove:r,records:t,allRecords:f,index:i};s.trigger("add",y),s.trigger("change",y)}}},{key:"onNodeRemoveChild",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{isMove:!1,silent:!1,unfiltered:!1},i=this,o=i.storage,a=[],s=[],u=r.isMove,c=r.silent,l=r.unfiltered,f=l&&i.isFiltered,d=f&&e.unfilteredChildren?e.unfilteredChildren:t;if(i.collectDescendants(d,a,s,{inCollapsedBranch:!(e.isExpanded(i)&&e.ancestorsExpanded(i)),unfiltered:f}),!u){var h,v=Ao(t);try{for(v.s();!(h=v.n()).done;){var p=h.value;p.unJoinStore(i)}}catch(e){v.e(e)}finally{v.f()}if(s.length){var g,y=Ao(s);try{for(y.s();!(g=y.n()).done;){var m=g.value;m.stores.includes(i)&&m.unJoinStore(i),i.added.includes(m)?i.added.remove(m):i.removed.add(m)}}catch(e){y.e(e)}finally{y.f()}i.modified.remove(s)}}if(a.length?(n=o.indexOf(a[0]))>-1&&(o.suspendEvents(),o.splice(n,a.length),o.resumeEvents()):n=-1,!c){var k={action:"remove",parent:e,isChild:!0,isMove:u,records:t,allRecords:s,index:n};i.trigger("remove",k),i.trigger("change",k)}}},{key:"collectDescendants",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{inCollapsedBranch:!1,unfiltered:!1},i=this,o=r.inCollapsedBranch,a=r.unfiltered,s=Array.isArray(e)?e:i.getChildren(e,a);if(s)for(var u,c=0,l=s.length;c<l;c++)u=s[c],o||t.push(u),n.push(u),i.collectDescendants(u,t,n,{inCollapsedBranch:o||!u.isExpanded(i),unfiltered:a});return{visible:t,all:n}}},{key:"getChildren",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=(t||this.isChained)&&e.unfilteredChildren||e.children;return n&&n.length?this.isChained?n.filter(this.chainedFilterFn):n:Oo}},{key:"internalToggleTreeSubRecords",value:function(e,t){var n=this,r=n.storage,i=r.indexOf(e),o=n.doIncludeExclude(n.getChildren(e),t);if(o.length&&!1!==i){if(r.suspendEvents(),t){r.splice.apply(r,[i+1,0].concat(d()(o)));var a={action:"add",isExpand:!0,records:o,index:i+1};n.trigger("add",a),n.trigger("change",a)}else{r.splice(i+1,o.length);var s={action:"remove",isCollapse:!0,records:o,index:i+1};n.trigger("remove",s),n.trigger("change",s)}r.resumeEvents()}}},{key:"doIncludeExclude",value:function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],r=this,i=e&&e.length,o=0;o<i;o++){var a=e[o];if(!r.isChained||r.chainedFilterFn(a)){var s=a.instanceMeta(r.id);t?n.push(a):s.hidden||n.push(a),s.hidden=!t,a.isExpanded(r)&&r.doIncludeExclude(r.getChildren(a),t,n)}}return n}},{key:"toggleCollapse",value:(t=Wr()(Vr.a.mark((function e(t,n){var r,i,o,a;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=(r=this).getById(t),o=i.instanceMeta(r),void 0===n&&(n=!o.collapsed),o.isLoadingChildren||i.isLeaf||i.isExpanded(r)!==n){e.next=28;break}if(r.trigger("beforeToggleNode",{record:i,collapse:n}),o.collapsed=n,!o.collapsed){e.next=10;break}return r.onNodeCollapse(i),e.abrupt("return",!0);case 10:if(r.onNodeExpand(i),a=!0,i.isLoaded){e.next=27;break}return o.isLoadingChildren=!0,e.prev=14,e.next=17,r.loadChildren(i);case 17:e.next=24;break;case 19:e.prev=19,e.t0=e.catch(14),o.collapsed=!0,a=!1,r.trigger("loadChildrenException",{record:i,exception:e.t0});case 24:return e.prev=24,o.isLoadingChildren=!1,e.finish(24);case 27:return e.abrupt("return",a);case 28:case"end":return e.stop()}}),e,this,[[14,19,24,27]])}))),function(e,n){return t.apply(this,arguments)})},{key:"onNodeCollapse",value:function(e){if(e.ancestorsExpanded(this))return this.internalToggleTreeSubRecords(e,!1)}},{key:"onNodeExpand",value:function(e){if(e.ancestorsExpanded(this))return this.internalToggleTreeSubRecords(e,!0)}},{key:"isTree",get:function(){return this.tree||this.masterStore&&this.masterStore.tree}},{key:"leaves",get:function(){var e=[];return this.isTree?(this.traverse((function(t){t.isLeaf&&e.push(t)})),e):(this.allRecords.forEach((function(t){t.isLeaf&&e.push(t),t.traverse((function(t){t.isLeaf&&e.push(t)}),!0)})),e)}}],[{key:"$name",get:function(){return"StoreTree"}}]),i}(e||ue)}),(function(e){return function(e){fe()(n,e);var t=jo(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"add",value:function(e){var t,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this.stm;return this.tree||!i||i.disabled?t=we()(pe()(n.prototype),"add",this).call(this,e,r):(t=we()(pe()(n.prototype),"add",this).call(this,e,r))&&t.length&&i.onStoreModelAdd(this,t,r),t}},{key:"insert",value:function(e,t){var r,i=this,o=arguments.length>2&&void 0!==arguments[2]&&arguments[2],a=this.stm;if(this.tree||!a||a.disabled)r=we()(pe()(n.prototype),"insert",this).call(this,e,t,o);else{var s=(Array.isArray(t)?t:[t]).reduce((function(e,t){var n=t instanceof Bi?i.indexOf(t):void 0;return void 0!==n&&-1!==n&&e.set(t,n),e}),new Map);(r=we()(pe()(n.prototype),"insert",this).call(this,e,t))&&r.length&&(e=this.indexOf(r[0]),a.onStoreModelInsert(this,e,r,s,o))}return r}},{key:"remove",value:function(e){var t,r=this,i=arguments.length>1&&void 0!==arguments[1]&&arguments[1],o=arguments.length>2?arguments[2]:void 0,a=this.stm;if(this.tree||!a||a.disabled)t=we()(pe()(n.prototype),"remove",this).call(this,e,i,o);else{var s=(Array.isArray(e)?e:[e]).map((function(e){return r.getById(e)})).filter((function(e){return!!e})),u=s.reduce((function(e,t){var n=r.indexOf(t);return void 0!==n&&-1!=n&&e.set(t,n),e}),new Map);(t=we()(pe()(n.prototype),"remove",this).call(this,e,i,o))&&t.length&&a.onStoreModelRemove(this,t,u,i)}return t}},{key:"removeAll",value:function(e){var t,r=this.stm;if(r&&!r.disabled){var i=this.tree,o=this.rootNode,a=this.allRecords,s=a.length,u=i?o.children.slice():a.slice();t=we()(pe()(n.prototype),"removeAll",this).call(this,e),s&&0===this.count&&r.onStoreRemoveAll(this,u,e)}else t=we()(pe()(n.prototype),"removeAll",this).call(this,e);return t}},{key:"stm",get:function(){return this[_o]},set:function(e){var t=this;t.stm!=e&&(t.stm&&t.stm.hasStore(t)&&t.stm.removeStore(t),t[_o]=e,t.stm&&!t.stm.hasStore(t)&&t.stm.addStore(t))}}],[{key:"$name",get:function(){return"StoreStm"}},{key:"defaultConfig",get:function(){return{stm:null}}}]),n}(e||ue)}),(function(e){return function(e){fe()(n,e);var t=Lo(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"syncDataset",value:function(e){var t=this,n=t.storage,r=t.tree?t.syncTreeDataset(e):t.syncFlatDataset(e),i=r.toAdd,o=r.toRemove,a=r.updated,s=t.syncDataOnLoad.threshold,u=!1;if(s&&("string"==typeof s&&(s=parseInt(s,10)/100*t.count),u=i.length+o.length+a.length>s),t.tree){if(i.length)t.add(i,u).forEach((function(e){return e.clearParentId()}));t.remove(o,u)}else u&&n.suspendEvents(),n.splice(t.count-o.length,o,i),u&&n.resumeEvents();s&&!u&&a.forEach((function(e){var n=e.record,r=e.toSet,i=e.wasSet;return t.onModelChange(n,r,i)})),t.acceptChanges();var c={added:i,removed:o,updated:a,thresholdSurpassed:u};u&&this.trigger("refresh",{action:"batch",data:e,records:n.values,syncInfo:c}),t.isFiltered&&t.filter(),t.isGrouped?t.group():t.isSorted&&t.sort(),t.trigger("loadSync",c)}},{key:"syncFlatDataset",value:function(e){if(e){var t=this,n=t.modelClass.idField,r=[],i=[],o=[],a={},s=t.syncDataOnLoad.threshold,u=0;return e.forEach((function(e){var r=e[n],c=t.getById(r);if(c){var l=c.set(e,null,Boolean(s));l&&o.push({record:c,wasSet:l,toSet:e}),u++}else i.push(t.processRecord(t.createRecord(e)));a[r]=1})),u<t.allCount&&t.forEach((function(e){a[e.id]||r.push(e)})),{toAdd:i,toRemove:r,updated:o}}}},{key:"syncTreeDataset",value:function(e){if(e){var t=this,n=t.modelClass,r=n.idField,i=n.parentIdField,o=[],a=[],s=[],u={},c=t.syncDataOnLoad.threshold;return Fo.preWalkWithParent({isRoot:!0,children:e},(function(e){return e.children}),(function(e,n){if(e){var o=n[r],l=t.getById(o);if(l){var f=l.set(n,null,Boolean(c));f&&s.push({record:l,wasSet:f,toSet:n})}else n[i]=e[r],a.push(n);u[o]=1}})),t.traverse((function(e){u[e.id]||o.push(e)})),{toAdd:a,toRemove:o,updated:s}}}}],[{key:"$name",get:function(){return"StoreSync"}},{key:"defaultConfig",get:function(){return{syncDataOnLoad:null}}}]),n}(e||ue)}),(function(e){return function(e){fe()(n,e);var t=mo(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"initProxy",value:function(){if(!j.a.global.Proxy)throw new Error("Proxy not supported");return new Proxy(this,{get:function(e,t){if(t in e)return e[t];var n=e.getById(t);return n||isNaN(parseInt(t))||(n=e.getAt(parseInt(t))),n},set:function(e,t,n){return t in e||e.isDestroying?e[t]=n:e.add(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?yo(Object(n),!0).forEach((function(t){ke()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):yo(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}(ke()({},e.modelClass.idField,t),n)),!0},deleteProperty:function(e,t){return e.isDestroying?(delete e[t],!0):Boolean(e.remove(t).length)},has:function(e,t){if(t in e)return!0;if(t.startsWith("{")&&t.endsWith("}")){var n=E.safeJsonParse(t);t=null==n?void 0:n.id}return e.includes(t)}})}}],[{key:"configurable",get:function(){return{objectify:null}}}]),n}(e||ue)})));function Vo(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return zo(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return zo(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function zo(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Wo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}No.storeMap={},No._$name="Store";var Go=function(e,t){return Array.isArray(t[1])?t[1].forEach((function(n){return e.push(encodeURIComponent(t[0])+"="+encodeURIComponent(n))})):e.push(encodeURIComponent(t[0])+"="+encodeURIComponent(t[1])),e},Yo=Promise.resolve(),Uo=function(e){fe()(u,e);var t,n,r,i,o,a,s=Wo(u);function u(){return v()(this,u),s.apply(this,arguments)}return g()(u,[{key:"afterConstruct",value:function(e){we()(pe()(u.prototype),"afterConstruct",this).call(this,e),this.autoLoad&&this.load().catch((function(){}))}},{key:"buildQueryString",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=Object.entries(Object.assign.apply(Object,[{}].concat(t))).reduce(Go,[]).join("&");return r?"?"+r:""}},{key:"performSort",value:function(e){var t=this;if(t.sortParamName){var n=t.groupRecords,r={};return t.isGrouped&&n&&n.length&&n.forEach((function(e){e.meta.collapsed&&(t.includeGroupRecords(e),r[e.id]=!0)})),t.internalLoad({},"",(function(n){t.data=n.data,t.afterPerformSort(e,r)}))}we()(pe()(u.prototype),"performSort",this).call(this,e)}},{key:"performFilter",value:function(e){var t=this;if(t.remoteFilter){var n=t.count,r=t.filters;return t.currentPage=1,t.internalLoad({},"",(function(i){t.data=i.data,t.afterPerformFilter(e?null:{action:"filter",filters:r,oldCount:n,records:t.storage.values})}))}we()(pe()(u.prototype),"performFilter",this).call(this,e)}},{key:"encodeFilterParams",value:function(e){var t,n=[],r=Vo(e);try{for(r.s();!(t=r.n()).done;){var i=t.value,o=i.property,a=i.operator,s=i.value,u=i.caseSensitive;n.push({field:o,operator:a,value:s,caseSensitive:u})}}catch(e){r.e(e)}finally{r.f()}return JSON.stringify(n)}},{key:"encodeSorterParams",value:function(e){return JSON.stringify(e.filter((function(e){return!e.sortFn})).map((function(e){return e})))}},{key:"buildReadUrl",value:function(){var e=this.readUrl;return this.restfulFilter?(e.endsWith("/")?e:e+"/")+this.filters.first.value:e}},{key:"internalLoad",value:function(e,t,n){var r=this,i=an.assign({},r.params,e),o=r.buildReadUrl(),a={action:"read"+t,params:i,url:o};return o?new Promise((function(e,o){if(!1===r.trigger("beforeLoad"+t,a))return o(!1);if(r._isLoading=!0,r.trigger("load".concat(t,"Start"),a),r.trigger("beforeRequest",a),r.filterParamName&&r.isFiltered&&(i[r.filterParamName]=r.encodeFilterParams(r.filters.values)),r.sortParamName&&r.isSorted&&(i[r.sortParamName]=r.encodeSorterParams(r.groupers?r.groupers.concat(r.sorters):r.sorters)),r.isPaged){if(!i[r.pageParamName]&&!i[r.pageStartParamName]){var s=Math.min(r.currentPage||1,r.allCount?r.lastPage:1/0);r.pageParamName?i[r.pageParamName]=s:i[r.pageStartParamName]=(s-1)*r.pageSize}i[r.pageSizeParamName]=r.pageSize}var u={headers:r.headers,parseJson:!0};r.useRestfulMethods&&(u.method=r.httpMethods.read),Je.get(a.url+r.buildQueryString(i),an.assign(u,r.fetchOptions)).then(function(){var s=Wr()(Vr.a.mark((function s(u){var c,l,f,d,h;return Vr.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:if(c=u.parsedJson,l=Array.isArray(c),f=l||c&&!1!==an.getPath(c,r.responseSuccessProperty),d=l?null:an.getPath(c,r.responseTotalProperty),r._isLoading=!1,a.response=u,a.json=c,!f){s.next=20;break}if(null!=d&&(r.remoteTotal=parseInt(d,10)),!r.isPaged){s.next=13;break}if(!(r.remoteTotal>=0)){s.next=12;break}h=r.pageParamName?i[r.pageParamName]:i[r.pageStartParamName]/r.pageSize+1,r.currentPage=Math.min(h,r.lastPage),s.next=13;break;case 12:throw new Error("A paged store must receive its responseTotalProperty in each data packet");case 13:return a.data=l?c:an.getPath(c,r.responseDataProperty),s.next=16,n(a);case 16:r.trigger("load"+t,a),e(a),s.next=24;break;case 20:a.exception=!0,a.exceptionType="server",r.trigger("exception",a),o(a);case 24:r.trigger("afterRequest",a);case 25:case"end":return s.stop()}}),s)})));return function(e){return s.apply(this,arguments)}}()).catch((function(e){r._isLoading=!1,a.exception=!0,e instanceof Response?(a.exceptionType=e.ok?"server":"network",a.response=e,a.error=e.error):(a.exceptionType="server",a.error=e),r.trigger("exception",a),o(a),r.trigger("afterRequest",a)}))})):null}},{key:"load",value:(a=Wr()(Vr.a.mark((function e(t){var n;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(n=this).isPaged){e.next=5;break}return e.abrupt("return",n.loadPage((n.currentPage||0)+1,t));case 5:return e.abrupt("return",n.internalLoad(t,"",(function(e){n.data=e.data})));case 6:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"loadChildren",value:(o=Wr()(Vr.a.mark((function e(t){var n;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this,e.abrupt("return",n.internalLoad(ke()({},n.parentIdParamName,t.id),"Children",(function(e){e.parentRecord=t,t.data[t.constructor.childrenField]=e.data,t.processChildren(t.stores)})));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"loadPage",value:(i=Wr()(Vr.a.mark((function e(t,n){var r,i;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.allCount&&(t=Math.min(t,this.lastPage)),(i=(r=this).pageParamName?ke()({},r.pageParamName,t):ke()({},r.pageStartParamName,(t-1)*r.pageSize))[r.pageSizeParamName]=r.pageSize,e.abrupt("return",r.internalLoad(an.assign(i,n),"Page",(function(e){r.loadData(e.data,"pageLoad")})));case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"nextPage",value:(r=Wr()(Vr.a.mark((function e(t){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.isPaged&&this.currentPage!==this.lastPage?this.loadPage(this.currentPage+1,t):Yo);case 1:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"previousPage",value:(n=Wr()(Vr.a.mark((function e(t){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.isPaged&&1!==this.currentPage?this.loadPage(this.currentPage-1,t):Yo);case 1:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"commit",value:(t=Wr()(Vr.a.mark((function e(){var t,n,r,i,o;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(t=this).changes,r=[],!t.commitPromise){e.next=3;break}return e.abrupt("return",!1);case 3:if(n){e.next=6;break}return t.modified.count&&(t.modified.forEach((function(e){return e.clearChanges(!1)})),t.modified.clear()),e.abrupt("return",Yo);case 6:if([].concat(d()(n.added),d()(n.modified),d()(n.removed)).forEach((function(e){return e.meta.committing=!0})),!1===t.trigger("beforeCommit",{changes:n})){e.next=25;break}if(i={action:"commit",exception:!1,changes:n},(o=t.commitRemoved(i))&&r.push(o),(o=t.commitAdded(i))&&r.push(o),(o=t.commitModified(i))&&r.push(o),r.length){e.next=23;break}return t.modified.forEach((function(e){return e.clearChanges(!1)})),t.modified.clear(),t.added.forEach((function(e){return e.clearChanges(!1)})),t.added.clear(),t.removed.clear(),t.trigger("commit",{changes:n}),e.abrupt("return",Yo);case 23:return o=1===r.length?r[0]:Promise.all(r),e.abrupt("return",t.commitPromise=new Promise((function(e,r){o.then((function(){t.commitPromise=null,i.exception?(t.trigger("exception",i),r(i)):(t.trigger("commit",{changes:n}),e(i))})).catch((function(){t.commitPromise=null,r(i)}))})));case 25:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"doAutoCommit",value:function(){this.suspendCount<=0&&this.commit().catch((function(e){var t=e.response;if(!t||!(t.ok&&t.parsedJson||[500,404].includes(t.status)))throw e}))}},{key:"commitAdded",value:function(e){var t=this,n=t.added,r={action:"create",params:t.params};return n.count&&t.createUrl?new Promise((function(i){var o=n.values.map((function(e){return e.persistableData}));e.create=r;var a=r.body={data:o};if(t.trigger("beforeRequest",r),t.sendAsFormData){var s=new FormData;s.append("data",JSON.stringify(o)),a=s}var u={headers:t.headers,parseJson:!0};t.useRestfulMethods&&(u.method=t.httpMethods.create),Je.post(t.createUrl+t.buildQueryString(t.params),a,an.assign(u,t.fetchOptions)).then((function(o){var a=o.parsedJson,s=Array.isArray(a),u=s||a&&!1!==a.success;e.response=o,r.json=a,r.response=o,u?(t.processReturnedData(n.values,s?a:a[t.responseDataProperty]),n.clear(),t.trigger("commitAdded"),t.trigger("refresh",r),i(e)):(n.forEach((function(e){return e.meta.committing=!1})),e.exception=r.exception=!0,e.exceptionType=r.exceptionType="server",t.trigger("exception",r),i(e)),t.trigger("afterRequest",r)})).catch((function(o){n.forEach((function(e){return e.meta.committing=!1})),e.exception=r.exception=!0,o instanceof Response?(e.response=o,r.exceptionType=o.ok?"server":"network",r.response=o,r.error=o.error):(r.exceptionType="server",r.error=o),t.trigger("exception",r),i(e),t.trigger("afterRequest",r)}))})):null}},{key:"commitModified",value:function(e){var t=this,n=t.changes.modified,r={action:"update",params:t.params},i=n.length&&t.updateUrl?new Promise((function(i){var o=n.map((function(e){return t.writeAllFields?e.persistableData:e.modificationData})).filter((function(e){return!an.isEmpty(e)}));if(0===o.length)return t.modified.clear(),n.forEach((function(e){return e.meta.committing=!1})),void i();e.update=r;var a=r.body={data:o};if(t.trigger("beforeRequest",r),t.sendAsFormData){var s=new FormData;s.append("data",JSON.stringify(o)),a=s}var u={headers:t.headers,parseJson:!0};t.useRestfulMethods&&(u.method=t.httpMethods.update),Je.post(t.updateUrl+t.buildQueryString(t.params),a,an.assign(u,t.fetchOptions)).then((function(o){var a=o.parsedJson,s=Array.isArray(a),u=s||a&&!1!==a.success;e.response=o,r.json=a,r.response=o,u?(t.processReturnedData(n,s?a:a[t.responseDataProperty],!0),t.modified.clear(),t.trigger("commitModified"),t.trigger("refresh",r),i(e)):(n.forEach((function(e){return e.meta.committing=!1})),e.exception=r.exception=!0,r.exceptionType="server",t.trigger("exception",r),i(e)),t.trigger("afterRequest",r)})).catch((function(o){n.forEach((function(e){return e.meta.committing=!1})),e.exception=r.exception=!0,o instanceof Response?(e.response=o,r.exceptionType=o.ok?"server":"network",r.response=o,r.error=o.error):(r.exceptionType="server",r.error=o),t.trigger("exception",r),i(e),t.trigger("afterRequest",r)}))})):null;return!n.length&&t.modified.count&&t.modified.clear(),i}},{key:"processReturnedData",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.modelClass,o=i.fieldMap.id.dataSource;t.forEach((function(t,r){var a=e[r];a.clearChanges(!1),a.syncId(t[o]),Object.assign(e[r].data,i.processData(t,n))}))}},{key:"commitRemoved",value:function(e){var t=this,n=t.removed,r={action:"delete",params:t.params};return n.count&&t.deleteUrl?new Promise((function(i){e.delete=r;var o=r.body={ids:n.map((function(e){return e.id}))};if(t.trigger("beforeRequest",r),t.sendAsFormData){var a=new FormData;a.append("id",JSON.stringify(o.ids)),o=a}var s={headers:t.headers,parseJson:!0};t.useRestfulMethods&&(s.method=t.httpMethods.delete),Je.post(t.deleteUrl+t.buildQueryString(t.params),o,an.assign(s,t.fetchOptions)).then((function(o){var a=o.parsedJson,s=Array.isArray(a)||a&&!1!==a.success;e.response=o,r.json=a,r.response=o,s?(n.forEach((function(e){return e.meta.committing=!1})),n.clear(),t.trigger("commitRemoved"),t.trigger("refresh",r),i(e)):(n.forEach((function(e){return e.meta.committing=!1})),e.exception=r.exception=!0,r.exceptionType="server",t.trigger("exception",r),i(e)),t.trigger("afterRequest",r)})).catch((function(o){n.forEach((function(e){return e.meta.committing=!1})),e.exception=r.exception=!0,o instanceof Response?(e.response=o,r.exceptionType=o.ok?"server":"network",r.response=o,r.error=o.error):(r.exceptionType="server",r.error=o),t.trigger("exception",r),i(e),t.trigger("afterRequest",r)}))})):null}},{key:"isLoading",get:function(){return this._isLoading}},{key:"isCommitting",get:function(){return Boolean(this.commitPromise)}},{key:"pageParamName",set:function(e){if(this.tree)throw new Error("Paging cannot be supported for tree stores");if(this.pageStartParamName)throw new Error("Configs pageStartParamName and pageParamName are mutually exclusive");this._pageParamName=e},get:function(){return this._pageParamName}},{key:"pageStartParamName",set:function(e){if(this.tree)throw new Error("Paging cannot be supported for tree stores");if(this.pageParamName)throw new Error("Configs pageParamName and pageStartParamName are mutually exclusive");this._pageStartParamName=e},get:function(){return this._pageStartParamName}},{key:"isPaged",get:function(){return this.pageParamName||this.pageStartParamName}},{key:"allCount",get:function(){return"remoteTotal"in this?this.remoteTotal:we()(pe()(u.prototype),"allCount",this)}},{key:"lastPage",get:function(){if(this.isPaged)return Math.floor((this.allCount+this.pageSize-1)/this.pageSize)}},{key:"remoteFilter",get:function(){return Boolean(this.filterParamName||this.restfulFilter)}}],[{key:"defaultConfig",get:function(){return{headers:null,fetchOptions:null,sendAsFormData:!1,writeAllFields:null,parentIdParamName:"id",responseSuccessProperty:"success",responseDataProperty:"data",responseTotalProperty:"total",filterParamName:null,restfulFilter:!1,sortParamName:null,pageParamName:null,pageStartParamName:null,pageSizeParamName:"pageSize",pageSize:50,useRestfulMethods:!1,httpMethods:{create:"POST",read:"GET",update:"PUT",delete:"DELETE"}}}}]),u}(No);Uo._$name="AjaxStore";var qo=function(){function e(){v()(this,e)}return g()(e,null,[{key:"get",value:function(e,t){var n=e._domData||(e._domData={});return null!=t?n[t]:n}},{key:"remove",value:function(e,t){var n=e._domData,r=null==n?void 0:n[t];return null==n||delete n[t],r}},{key:"set",value:function(e,t,n){3===arguments.length?(e._domData||(e._domData={}))[t]=n:e._domData=t}},{key:"assign",value:function(e,t){Object.assign(e._domData||(e._domData={}),t)}}]),e}();qo._$name="DomDataStore";var Ko=function(){function e(t,n){v()(this,e),"number"==typeof t?(this._magnitude=t,this._unit=n):("string"==typeof t&&(t=Zt.parseDuration(t)),"object"===l()(t)&&Object.assign(this,t))}return g()(e,[{key:"isEqual",value:function(e){return Boolean(e&&this.milliseconds===e.milliseconds)}},{key:"toString",value:function(e){var t=this,n=t.useAbbreviation?"getShortNameOfUnit":"getLocalizedNameOfUnit";return t.isValid?"".concat(t._magnitude," ").concat(Zt[n](t._unit,1!==t._magnitude)):""}},{key:"valueOf",value:function(){return this.milliseconds}},{key:"magnitude",get:function(){return this._magnitude},set:function(e){this._magnitude="number"==typeof e&&e}},{key:"unit",get:function(){return this._unit},set:function(e){this._unit=Zt.parseTimeUnit(e)}},{key:"isValid",get:function(){return null!=this._magnitude&&this._unit}},{key:"milliseconds",get:function(){return this.isValid?Math.round(Zt.asMilliseconds(this._magnitude,this._unit)):0}}]),e}();function Xo(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Ko._$name="Duration";var Zo=function(){throw new Error("Abstract method call!")},Jo=function(){throw new Error("Method cannot be called at this state!")},Qo=function(e){fe()(n,e);var t=Xo(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"canUndo",value:function(e){Zo()}},{key:"canRedo",value:function(e){Zo()}},{key:"onUndo",value:function(e){Zo()}},{key:"onRedo",value:function(e){Zo()}},{key:"onStartTransaction",value:function(e){Zo()}},{key:"onStopTransaction",value:function(e){Zo()}},{key:"onStopTransactionDelayed",value:function(e){Zo()}},{key:"onRejectTransaction",value:function(e){Zo()}},{key:"onEnable",value:function(e){Zo()}},{key:"onDisable",value:function(e){Zo()}},{key:"onAutoRecordOn",value:function(e){Zo()}},{key:"onAutoRecordOff",value:function(e){Zo()}},{key:"onResetQueue",value:function(e){Zo()}},{key:"onModelUpdate",value:function(e){Zo()}},{key:"onStoreModelAdd",value:function(e){Zo()}},{key:"onStoreModelInsert",value:function(e){Zo()}},{key:"onStoreModelRemove",value:function(e){Zo()}},{key:"onStoreModelRemoveAll",value:function(e){Zo()}},{key:"onModelInsertChild",value:function(e){Zo()}},{key:"onModelRemoveChild",value:function(e){Zo()}}]),n}(ue);Qo._$name="StateBase";var ea=Symbol("STATE_PROP"),ta=Symbol("STORES_PROP"),na=Symbol("QUEUE_PROP"),ra=Symbol("POS_PROP"),ia=Symbol("TRANSACTION_PROP"),oa=Symbol("TRANSACTION_TIMER_PROP"),aa=Symbol("AUTO_RECORD_PROP"),sa=(Object.freeze([ea,ta,na,ra,ia,oa,aa]),new Map),ua=function(e,t){sa.set(e,t)},ca=function(e){return"string"==typeof e&&(e=sa.get(e)),e},la=function(e,t){var n,r,i=t.undo,o=t.redo;if(i&&!o)r={},ke()(r,na,e[na].slice(e.position)),ke()(r,ra,0),n=r;else if(o&&!i)n=ke()({},na,e[na].slice(0,e.position));else{var a;a={},ke()(a,na,[]),ke()(a,ra,0),n=a}return[n,function(){e.notifyStoresAboutQueueReset(t)}]};function fa(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var da=new(function(e){fe()(n,e);var t=fa(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"canUndo",value:function(){return!1}},{key:"canRedo",value:function(){return!1}},{key:"onUndo",value:function(){Jo()}},{key:"onRedo",value:function(){Jo()}},{key:"onEnable",value:function(e){return e.autoRecord?"autoreadystate":"readystate"}},{key:"onDisable",value:function(){Jo()}},{key:"onAutoRecordOn",value:function(){return ke()({},aa,!0)}},{key:"onAutoRecordOff",value:function(){return ke()({},aa,!1)}},{key:"onStartTransaction",value:function(){Jo()}},{key:"onStopTransaction",value:function(){Jo()}},{key:"onStopTransactionDelayed",value:function(){Jo()}},{key:"onRejectTransaction",value:function(){Jo()}},{key:"onResetQueue",value:function(e,t){return la(e,t)}},{key:"onModelUpdate",value:function(){}},{key:"onModelInsertChild",value:function(){}},{key:"onModelRemoveChild",value:function(){}},{key:"onStoreModelAdd",value:function(){}},{key:"onStoreModelInsert",value:function(){}},{key:"onStoreModelRemove",value:function(){}},{key:"onStoreRemoveAll",value:function(){}}]),n}(Qo)),ha=da;function va(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}ua("disabledstate",da);var pa=Symbol("ACTION_QUEUE_PROP"),ga=function(e){fe()(n,e);var t=va(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(){var e;this[pa]=[];for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];(e=we()(pe()(n.prototype),"construct",this)).call.apply(e,[this].concat(r))}},{key:"addAction",value:function(e){this[pa].push(e)}},{key:"undo",value:function(){for(var e=this[pa],t=e.length-1;t>=0;--t)e[t].undo()}},{key:"redo",value:function(){for(var e=this[pa],t=0,n=e.length;t<n;++t)e[t].redo()}},{key:"defaultConfig",get:function(){return{title:null}}},{key:"queue",get:function(){return this[pa].slice(0)}},{key:"length",get:function(){return this[pa].length}}]),n}(ue);function ya(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}ga._$name="Transaction";var ma=function(e){fe()(n,e);var t=ya(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"canUndo",value:function(e){return 0<e.position&&e.position<=e.length}},{key:"canRedo",value:function(e){return 0<=e.position&&e.position<e.length}},{key:"onUndo",value:function(e,t){var n,r=e[na],i=e.position,o=Math.max(0,i-t);return[(n={},ke()(n,ea,"restoringstate"),ke()(n,ra,o),n),function(){for(e.notifyStoresAboutStateRestoringStart();i!=o;)r[--i].undo();return[e.autoRecord?"autoreadystate":"readystate",function(){e.notifyStoresAboutStateRestoringStop()}]}]}},{key:"onRedo",value:function(e,t){var n,r=e[na],i=e.position,o=Math.min(r.length,i+t);return[(n={},ke()(n,ea,"restoringstate"),ke()(n,ra,o),n),function(){e.notifyStoresAboutStateRestoringStart();do{r[i++].redo()}while(i!=o);return[e.autoRecord?"autoreadystate":"readystate",function(){e.notifyStoresAboutStateRestoringStop()}]}]}},{key:"onEnable",value:function(){Jo()}},{key:"onDisable",value:function(){return"disabledstate"}},{key:"onAutoRecordOn",value:function(){var e;return e={},ke()(e,ea,"autoreadystate"),ke()(e,aa,!0),e}},{key:"onAutoRecordOff",value:function(){Jo()}},{key:"onStartTransaction",value:function(e,t){var n,r=new ga({title:t});return[(n={},ke()(n,ea,"recordingstate"),ke()(n,ia,r),n),function(){e.notifyStoresAboutStateRecordingStart(r)}]}},{key:"onStopTransaction",value:function(){Jo()}},{key:"onStopTransactionDelayed",value:function(){Jo()}},{key:"onRejectTransaction",value:function(){Jo()}},{key:"onResetQueue",value:function(e,t){return la(e,t)}},{key:"onModelUpdate",value:function(){}},{key:"onModelInsertChild",value:function(){}},{key:"onModelRemoveChild",value:function(){}},{key:"onStoreModelAdd",value:function(){}},{key:"onStoreModelInsert",value:function(){}},{key:"onStoreModelRemove",value:function(){}},{key:"onStoreRemoveAll",value:function(){}}]),n}(Qo),ka=new ma,ba=ka;function wa(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}ua("readystate",ka);var Ca=function(e){fe()(n,e);var t=wa(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"canUndo",value:function(){return!1}},{key:"canRedo",value:function(){return!1}},{key:"onEnable",value:function(){}},{key:"onDisable",value:function(e){var t,n=e[ia];return e.notifyStoresAboutStateRecordingStop(n,{disabled:!0}),t={},ke()(t,ea,"disabledstate"),ke()(t,ia,null),t}},{key:"onAutoRecordOn",value:function(e){var t;return[(t={},ke()(t,ea,"autorecordingstate"),ke()(t,aa,!0),t),function(){e.stopTransactionDelayed()}]}},{key:"onAutoRecordOff",value:function(){Jo()}},{key:"onStartTransaction",value:function(){Jo()}},{key:"onStopTransaction",value:function(e,t){var n,r=e[ia],i=e[ra],o=e[na];return r.length&&(r.title||t||!e.getTransactionTitle?t&&(r.title=t):r.title=e.getTransactionTitle(r),o[i]=r,o.length=++i),[(n={},ke()(n,ea,"readystate"),ke()(n,ra,i),ke()(n,ia,null),n),function(){e.notifyStoresAboutStateRecordingStop(r,{stop:!0})}]}},{key:"onRejectTransaction",value:function(e){var t,n=e[ia];return[(t={},ke()(t,ea,"restoringstate"),ke()(t,ia,null),t),function(){return n.length&&n.undo(),["readystate",function(){e.notifyStoresAboutStateRecordingStop(n,{rejected:!0})}]}]}},{key:"onStopTransactionDelayed",value:function(){Jo()}},{key:"onQueueReset",value:function(){Jo()}},{key:"onModelUpdate",value:function(e,t,n,r){e[ia].addAction(e.makeModelUpdateAction(t,n,r))}},{key:"onModelInsertChild",value:function(e,t,n,r,i,o){e[ia].addAction(e.makeModelInsertChildAction(t,n,r,i,o))}},{key:"onModelRemoveChild",value:function(e,t,n,r){e[ia].addAction(e.makeModelRemoveChildAction(t,n,r))}},{key:"onStoreModelAdd",value:function(e,t,n,r){e[ia].addAction(e.makeStoreModelAddAction(t,n,r))}},{key:"onStoreModelInsert",value:function(e,t,n,r,i,o){e[ia].addAction(e.makeStoreModelInsertAction(t,n,r,i,o))}},{key:"onStoreModelRemove",value:function(e,t,n,r,i){e[ia].addAction(e.makeStoreModelRemoveAction(t,n,r,i))}},{key:"onStoreRemoveAll",value:function(e,t,n,r){e[ia].addAction(e.makeStoreRemoveAllAction(t,n,r))}}]),n}(Qo),Sa=new Ca,Da=Sa;function Ra(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}ua("recordingstate",Sa);var xa=new(function(e){fe()(n,e);var t=Ra(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"canUndo",value:function(){return!1}},{key:"canRedo",value:function(){return!1}},{key:"onUndo",value:function(){Jo()}},{key:"onRedo",value:function(){Jo()}},{key:"onEnable",value:function(){Jo()}},{key:"onDisable",value:function(){Jo()}},{key:"onAutoRecordOn",value:function(){return ke()({},aa,!0)}},{key:"onAutoRecordOff",value:function(){return ke()({},aa,!1)}},{key:"onStartTransaction",value:function(){Jo()}},{key:"onStopTransaction",value:function(){Jo()}},{key:"onStopTransactionDelayed",value:function(){Jo()}},{key:"onRejectTransaction",value:function(){Jo()}},{key:"onQueueReset",value:function(){Jo()}},{key:"onModelUpdate",value:function(){}},{key:"onModelInsertChild",value:function(){}},{key:"onModelRemoveChild",value:function(){}},{key:"onStoreModelAdd",value:function(){}},{key:"onStoreModelInsert",value:function(){}},{key:"onStoreModelRemove",value:function(){}},{key:"onStoreRemoveAll",value:function(){}}]),n}(Qo)),Ea=xa;function Ta(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}ua("restoringstate",xa);var Ma=new(function(e){fe()(n,e);var t=Ta(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"onAutoRecordOn",value:function(){Jo()}},{key:"onAutoRecordOff",value:function(){var e;return e={},ke()(e,ea,"readystate"),ke()(e,aa,!1),e}},{key:"onStartTransaction",value:function(e,t){var n,r=new ga({title:t});return[(n={},ke()(n,ea,"autorecordingstate"),ke()(n,ia,r),n),function(){e.notifyStoresAboutStateRecordingStart(r),e.stopTransactionDelayed()}]}},{key:"onModelUpdate",value:function(e,t,n,r){e.startTransaction(),e.onModelUpdate(t,n,r)}},{key:"onModelInsertChild",value:function(e,t,n,r,i){e.startTransaction(),e.onModelInsertChild(t,n,r,i)}},{key:"onModelRemoveChild",value:function(e,t,n,r){e.startTransaction(),e.onModelRemoveChild(t,n,r)}},{key:"onStoreModelAdd",value:function(e,t,n,r){e.startTransaction(),e.onStoreModelAdd(t,n,r)}},{key:"onStoreModelInsert",value:function(e,t,n,r,i,o){e.startTransaction(),e.onStoreModelInsert(t,n,r,o)}},{key:"onStoreModelRemove",value:function(e,t,n,r,i){e.startTransaction(),e.onStoreModelRemove(t,n,r,i)}},{key:"onStoreRemoveAll",value:function(e,t,n,r){e.startTransaction(),e.onStoreRemoveAll(t,n,r)}}]),n}(ma)),Aa=Ma;function Pa(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}ua("autoreadystate",Ma);var Ia=Reflect.defineProperty,Oa=null;if(y.a.isTestEnv){var Fa=j.a.global.bryntum||(j.a.global.bryntum={});Oa=Fa.globalDelays={timeouts:new Map,intervals:new Map,animationFrames:new Map,isEmpty:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return Oa.timeouts.size+Oa.animationFrames.size+(e?Oa.intervals.size:0)===0}}}var La=function(e,t,n,r){var i="string"==typeof t,o=r&&r.appendArgs||[],a=function(){n.timerId=null,n.lastCallTime=performance.now();var r,a=n.args;(n.args=null,i)?(r=e)[t].apply(r,d()(a).concat(d()(o))):t.call.apply(t,[e].concat(d()(a),d()(o)));n.called=!0,++n.calls};return r&&(e=r.thisObj||e),n.lastCallTime=-9e9,n.calls=0,n.invoker=a,a.wrapFn=n,a},ja=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"clearTimeout";return t.cancel=function(){t.isPending&&(e[n](t.timerId),t.args=t.timerId=null)},t.flush=function(){t.isPending&&(e[n](t.timerId),t.timerId=null,t.invoker())},t.now=function(){t.cancel();for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];t.args=n,t.invoker()},t.immediate=!1,t.timerId=null,Ia(t,"isPending",{get:function(){return null!==t.timerId}}),t},_a=function(e){return function(e){fe()(r,e);var t,n=Pa(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"doDestroy",value:function(){var e=this;e.timeoutIds&&(e.timeoutIds.forEach((function(e,t){"function"==typeof e&&e(),clearTimeout(t),Oa&&Oa.timeouts.delete(t)})),e.timeoutIds=null),e.timeoutMap&&(e.timeoutMap.forEach((function(e,t){return clearTimeout(t)})),e.timeoutMap=null),e.intervalIds&&(e.intervalIds.forEach((function(e){clearInterval(e),Oa&&Oa.intervals.delete(e)})),e.intervalIds=null),e.animationFrameIds&&(e.animationFrameIds.forEach((function(e){cancelAnimationFrame(e),Oa&&Oa.animationFrames.delete(e)})),e.animationFrameIds=null),we()(pe()(r.prototype),"doDestroy",this).call(this)}},{key:"hasTimeout",value:function(e){return!(!this.timeoutMap||!this.timeoutMap.has(e))}},{key:"setTimeout",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){var t=e.fn,n=e.delay,r=e.name,i=e.runOnDestroy,o=e.cancelOutstanding,a=e.args;if(arguments.length>1||"function"==typeof arguments[0]){var s=Array.prototype.slice.call(arguments);t=s[0],n=s[1],r=s[2],i=s[3]}"string"==typeof t?r=t:r||(r=t.name),o&&this.clearTimeout(r);var u=this,c=u.timeoutIds||(u.timeoutIds=new Map),l=u.timeoutMap||(u.timeoutMap=new Map),f=setTimeout((function(){"string"==typeof t&&(t=u[r]),c&&c.delete(f),l&&l.delete(r),Oa&&Oa.timeouts.delete(f),t.apply(u,a)}),n);return c.set(f,!i||t),Oa&&Oa.timeouts.set(f,{fn:t,delay:n,name:r}),r&&l.set(r,f),f}))},{key:"clearTimeout",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){var t=e;if("string"==typeof t){if(!this.timeoutMap)return;t=this.timeoutMap.get(e),this.timeoutMap.delete(e)}clearTimeout(t),this.timeoutIds&&this.timeoutIds.delete(t),Oa&&Oa.timeouts.delete(t)}))},{key:"clearInterval",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){clearInterval(e),this.intervalIds&&this.intervalIds.delete(e),Oa&&Oa.intervals.delete(e)}))},{key:"setInterval",value:function(e){function t(t,n){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e,t){var n=setInterval(e,t);return(this.intervalIds||(this.intervalIds=new Set)).add(n),Oa&&Oa.intervals.set(n,{fn:e,delay:t}),n}))},{key:"requestAnimationFrame",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this,r=this.animationFrameIds||(this.animationFrameIds=new Set),i=requestAnimationFrame((function(){return Oa&&Oa.animationFrames.delete(i),r.delete(i),e.apply(n,t)}));return r.add(i),Oa&&Oa.animationFrames.set(i,{fn:e,extraArgs:t,thisObj:n}),i}))},{key:"createOnFrame",value:function(e){var t,n=this,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this,o=arguments.length>3?arguments[3]:void 0,a=function(){for(var a=arguments.length,s=new Array(a),u=0;u<a;u++)s[u]=arguments[u];t&&o&&(n.cancelAnimationFrame(t),t=null),t||(t=n.requestAnimationFrame((function(){"string"==typeof e&&(e=i[e]),t=null,s.push.apply(s,d()(r)),e.apply(i,s)})))};return a.cancel=function(){return n.cancelAnimationFrame(t)},a}},{key:"cancelAnimationFrame",value:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(e){cancelAnimationFrame(e),this.animationFrameIds&&this.animationFrameIds.delete(e),Oa&&Oa.animationFrames.delete(e)}))},{key:"nextAnimationFrame",value:(t=Wr()(Vr.a.mark((function e(){var t=this;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){return t.requestAnimationFrame(e)})));case 1:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})},{key:"buffer",value:function(e,t){var n=this,r=t;t&&"number"!=typeof t?r=t.delay:t=null;var i=function e(){var t=e.delay;e.cancel(),e.called=!1;for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];e.args=i,e.immediate||!t?o():e.timerId=n.setTimeout(o,t)},o=La(this,e,i,t);return i.delay=r,ja(this,i)}},{key:"raf",value:function(e,t){var n=this,r=t;t&&"boolean"!=typeof t?r=t.cancelOutstanding:t=null;var i=function e(){e.cancelOutstanding&&e.cancel(),e.called=!1;for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];e.args=r,e.immediate?o():e.isPending||(e.timerId=n.requestAnimationFrame(o))},o=La(this,e,i,t);return i.cancelOutstanding=r,ja(this,i,"cancelAnimationFrame")}},{key:"throttle",value:function(e,t){var n,r=t;t&&"number"!=typeof t?(r=t.delay,n=t.throttled):t=null;var i=this,o=function e(){for(var t=e.delay,r=performance.now()-e.lastCallTime,o=arguments.length,s=new Array(o),u=0;u<o;u++)s[u]=arguments[u];e.args=s,e.immediate||r>=t?(i.clearTimeout(e.timerId),a()):(e.isPending||(e.timerId=i.setTimeout(a,t-r),e.called=!1),n&&(n.wrapFn.args=s,n()))},a=La(i,e,o,t);return o.delay=r,n&&(n=La(i,n,(function(){}),t)),ja(i,o)}},{key:"widgetClass",get:function(){}}],[{key:"setupDelayable",value:function(e){e.setupDelayableMethods(e.delayable)}},{key:"setupDelayableMethods",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this,r=e.static,i=t||n.prototype;r&&delete e.static;var o=function(t){var n=e[t],r=t+"Now",o=l()(n);i[r]=i[t],"number"===o?n={type:"buffer",delay:n}:"string"===o&&(n={type:n}),Ia(i,t,{get:function(){var e=this,i=this[n.type]((function(){e[r].apply(e,arguments)}),n);return Ia(this,t,{value:i}),i}})};for(var a in e)o(a)}},{key:"$name",get:function(){return"Delayable"}},{key:"declarable",get:function(){return["delayable"]}}]),r}(e||ue)};function Ba(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var Ha=new(function(e){fe()(n,e);var t=Ba(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"onDisable",value:function(e){var t,n=e[ia],r=e[oa];return r&&this.clearTimeout(r),e.notifyStoresAboutStateRecordingStop(n,{disabled:!0}),t={},ke()(t,ea,"disabledstate"),ke()(t,ia,null),ke()(t,oa,null),t}},{key:"onAutoRecordOn",value:function(e){Jo()}},{key:"onAutoRecordOff",value:function(e){var t,n=e[oa];return n&&this.clearTimeout(n),t={},ke()(t,ea,"recordingstate"),ke()(t,aa,!1),ke()(t,oa,null),t}},{key:"onStopTransaction",value:function(e,t){var n,r=e[ia],i=e[oa],o=e[ra],a=e[na];return i&&this.clearTimeout(i),r.length&&(r.title||t||!e.getTransactionTitle?t&&(r.title=t):r.title=e.getTransactionTitle(r),a[o]=r,a.length=++o),[(n={},ke()(n,ea,"autoreadystate"),ke()(n,ra,o),ke()(n,ia,null),ke()(n,oa,null),n),function(){e.notifyStoresAboutStateRecordingStop(r,{stop:!0})}]}},{key:"onStopTransactionDelayed",value:function(e){var t,n=e[oa];return n&&this.clearTimeout(n),n=this.setTimeout((function(){e.stopTransaction()}),e.autoRecordTransactionStopTimeout),t={},ke()(t,ea,Ha),ke()(t,oa,n),t}},{key:"onRejectTransaction",value:function(e){var t,n=e[ia],r=e[oa];return r&&this.clearTimeout(r),[(t={},ke()(t,ea,"restoringstate"),ke()(t,ia,null),ke()(t,oa,null),t),function(){return n.length&&n.undo(),["autoreadystate",function(){e.notifyStoresAboutStateRecordingStop(n,{rejected:!0})}]}]}},{key:"onModelUpdate",value:function(e){for(var t,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];(t=we()(pe()(n.prototype),"onModelUpdate",this)).call.apply(t,[this,e].concat(i)),e.stopTransactionDelayed()}},{key:"onModelInsertChild",value:function(e){for(var t,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];(t=we()(pe()(n.prototype),"onModelInsertChild",this)).call.apply(t,[this,e].concat(i)),e.stopTransactionDelayed()}},{key:"onModelRemoveChild",value:function(e){for(var t,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];(t=we()(pe()(n.prototype),"onModelRemoveChild",this)).call.apply(t,[this,e].concat(i)),e.stopTransactionDelayed()}},{key:"onStoreModelAdd",value:function(e){for(var t,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];(t=we()(pe()(n.prototype),"onStoreModelAdd",this)).call.apply(t,[this,e].concat(i)),e.stopTransactionDelayed()}},{key:"onStoreModelInsert",value:function(e){for(var t,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];(t=we()(pe()(n.prototype),"onStoreModelInsert",this)).call.apply(t,[this,e].concat(i)),e.stopTransactionDelayed()}},{key:"onStoreModelRemove",value:function(e){for(var t,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];(t=we()(pe()(n.prototype),"onStoreModelRemove",this)).call.apply(t,[this,e].concat(i)),e.stopTransactionDelayed()}},{key:"onStoreRemoveAll",value:function(e){for(var t,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];(t=we()(pe()(n.prototype),"onStoreRemoveAll",this)).call.apply(t,[this,e].concat(i)),e.stopTransactionDelayed()}}]),n}(Ca.mixin(_a))),$a=Ha;function Na(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}ua("autorecordingstate",Ha);var Va=function(){throw new Error("Abstract method call!")},za=function(e){fe()(n,e);var t=Na(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"undo",value:function(){Va()}},{key:"redo",value:function(){Va()}},{key:"type",get:function(){return this.constructor.name}}]),n}(ue);function Wa(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}za._$name="ActionBase";var Ga=Symbol("MODEL_PROP"),Ya=Symbol("NEW_DATA_PROP"),Ua=Symbol("OLD_DATA_PROP"),qa=function(e){fe()(n,e);var t=Wa(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"undo",value:function(){this.model.set(this.oldData,null,null,null,!0),this.model.$&&Object.assign(this.model,this.oldData)}},{key:"redo",value:function(){this.model.set(this.newData,null,null,null,!0),this.model.$&&Object.assign(this.model,this.newData)}},{key:"type",get:function(){return"UpdateAction"}},{key:"model",get:function(){return this[Ga]},set:function(e){this[Ga]=e}},{key:"newData",get:function(){return this[Ya]},set:function(e){this[Ya]=Object.assign({},e)}},{key:"oldData",get:function(){return this[Ua]},set:function(e){this[Ua]=Object.assign({},e)}}],[{key:"defaultConfig",get:function(){return{model:void 0,newData:void 0,oldData:void 0}}}]),n}(za);function Ka(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}qa._$name="UpdateAction";var Xa=Symbol("PARENT_MODEL_PROP"),Za=Symbol("CHILD_MODELS_PROP"),Ja=Symbol("INSERT_INDEX_PROP"),Qa=Symbol("CONTEXT_PROP"),es=function(e){fe()(n,e);var t=Ka(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"undo",value:function(){var e=this.parentModel,t=this.context,n=this.childModels;n.sort((function(e,n){var r=t.get(e)||{},i=r.lhsParent,o=r.lhsIndex,a=t.get(n)||{},s=a.rhsParent,u=a.rhsIndex;return i&&i===s?o-u:0})),n.forEach((function(n){var r=t.get(n)||{},i=r.parent,o=r.index;if(i)if(i===e){var a;a=o>n.parentIndex?o+1:o,a=o===i.children.length-1?null:a;var s=i.children[a];i.insertChild(n,s)}else i.insertChild(n,i.children[o]);else e.removeChild(n)}))}},{key:"redo",value:function(){var e=this.parentModel,t=this.insertIndex,n=this.childModels,r=e.children[t];e.insertChild(n,r)}},{key:"type",get:function(){return"InsertChildAction"}},{key:"parentModel",get:function(){return this[Xa]},set:function(e){this[Xa]=e}},{key:"childModels",get:function(){return this[Za]},set:function(e){this[Za]=e.slice(0)}},{key:"insertIndex",get:function(){return this[Ja]},set:function(e){this[Ja]=e}},{key:"context",get:function(){return this[Qa]},set:function(e){this[Qa]=e}}],[{key:"defaultConfig",get:function(){return{parentModel:void 0,childModels:void 0,insertIndex:void 0,context:void 0}}}]),n}(za);function ts(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}es._$name="InsertChildAction";var ns=Symbol("PARENT_MODEL_PROP"),rs=Symbol("CHILD_MODELS_PROP"),is=Symbol("CONTEXT_PROP"),os=function(e){fe()(n,e);var t=ts(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"undo",value:function(){var e=this.parentModel,t=this.context,n=this.childModels;n.sort((function(e,n){return t.get(e)-t.get(n)})),n.forEach((function(n){e.insertChild(t.get(n),n)}))}},{key:"redo",value:function(){this.parentModel.removeChild(this.childModels)}},{key:"type",get:function(){return"RemoveChildAction"}},{key:"parentModel",get:function(){return this[ns]},set:function(e){this[ns]=e}},{key:"childModels",get:function(){return this[rs]},set:function(e){this[rs]=e.slice(0)}},{key:"context",get:function(){return this[is]},set:function(e){this[is]=e}}],[{key:"defaultConfig",get:function(){return{parentModel:void 0,childModels:void 0,context:void 0}}}]),n}(za);function as(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}os._$name="RemoveChildAction";var ss=Symbol("STORE_PROP"),us=Symbol("MODEL_LIST_PROP"),cs=function(e){fe()(n,e);var t=as(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"undo",value:function(){this.store.remove(this.modelList,this.silent)}},{key:"redo",value:function(){this.store.add(this.modelList,this.silent)}},{key:"type",get:function(){return"AddAction"}},{key:"store",get:function(){return this[ss]},set:function(e){this[ss]=e}},{key:"modelList",get:function(){return this[us]},set:function(e){this[us]=e.slice(0)}}],[{key:"defaultConfig",get:function(){return{store:void 0,modelList:void 0,silent:!1}}}]),n}(za);function ls(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}cs._$name="AddAction";var fs=Symbol("STORE_PROP"),ds=Symbol("MODEL_LIST_PROP"),hs=Symbol("INSERT_INDEX_PROP"),vs=Symbol("CONTEXT_PROP"),ps=function(e){fe()(n,e);var t=ls(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"undo",value:function(){var e=this.store,t=this.modelList,n=this.context,r=this.silent;t.sort((function(e,t){var r=n.get(e),i=n.get(t);return void 0!==r&&void 0!==i?r-i:0})),t.forEach((function(t){var i=n.get(t);t._undoingInsertion=!0,void 0!==i?e.insert(i,t,r):e.remove(t,r),t._undoingInsertion=!1}))}},{key:"redo",value:function(){this.store.insert(this.insertIndex,this.modelList,this.silent)}},{key:"type",get:function(){return"InsertAction"}},{key:"store",get:function(){return this[fs]},set:function(e){this[fs]=e}},{key:"modelList",get:function(){return this[ds]},set:function(e){this[ds]=e.slice(0)}},{key:"insertIndex",get:function(){return this[hs]},set:function(e){this[hs]=e}},{key:"context",get:function(){return this[vs]},set:function(e){this[vs]=e}}],[{key:"defaultConfig",get:function(){return{store:void 0,modelList:void 0,insertIndex:void 0,context:void 0,silent:!1}}}]),n}(za);function gs(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}ps._$name="InsertAction";var ys=Symbol("STORE_PROP"),ms=Symbol("MODEL_LIST_PROP"),ks=Symbol("CONTEXT_PROP"),bs=function(e){fe()(n,e);var t=gs(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"undo",value:function(){var e=this.store,t=this.context,n=this.modelList,r=this.silent;n.sort((function(e,n){return t.get(e)-t.get(n)})),n.forEach((function(n){var i=t.get(n);e.insert(i,n,r)}))}},{key:"redo",value:function(){this.store.remove(this.modelList,this.silent)}},{key:"type",get:function(){return"RemoveAction"}},{key:"store",get:function(){return this[ys]},set:function(e){this[ys]=e}},{key:"modelList",get:function(){return this[ms]},set:function(e){this[ms]=e.slice(0)}},{key:"context",get:function(){return this[ks]},set:function(e){this[ks]=e}}],[{key:"defaultConfig",get:function(){return{store:void 0,modelList:void 0,context:void 0,silent:!1}}}]),n}(za);function ws(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}bs._$name="RemoveAction";var Cs=Symbol("STORE_PROP"),Ss=Symbol("ALL_RECORDS_PROP"),Ds=function(e){fe()(n,e);var t=ws(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"undo",value:function(){var e=this.store,t=this.allRecords,n=this.silent;e.add(t,n)}},{key:"redo",value:function(){this.store.removeAll(this.silent)}},{key:"type",get:function(){return"RemoveAllAction"}},{key:"store",get:function(){return this[Cs]},set:function(e){this[Cs]=e}},{key:"allRecords",get:function(){return this[Ss]},set:function(e){this[Ss]=e.slice(0)}}],[{key:"defaultConfig",get:function(){return{store:void 0,allRecords:void 0,silent:!1}}}]),n}(za);function Rs(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Ds._$name="RemoveAllAction";var xs=function(e,t,n){return new qa({model:e,newData:t,oldData:n})},Es=function(e,t,n,r){return new es({parentModel:e,childModels:n,insertIndex:t,context:r})},Ts=function(e,t,n){return new os({parentModel:e,childModels:t,context:n})},Ms=function(e,t,n){return new cs({store:e,modelList:t,silent:n})},As=function(e,t,n,r,i){return new ps({store:e,insertIndex:t,modelList:n,context:r,silent:i})},Ps=function(e,t,n,r){return new bs({store:e,modelList:t,context:n,silent:r})},Is=function(e,t,n){return new Ds({store:e,allRecords:t,silent:n})},Os=function e(t,n){for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];var a=n.call.apply(n,[t[ea],t].concat(i));if("string"==typeof a)t[ea]=ca(a);else if(a instanceof Qo)t[ea]=a;else if(Array.isArray(a)){var s=ye()(a,2),u=s[0],c=s[1];"string"==typeof u?t[ea]=ca(u):u instanceof Qo?t[ea]=u:u&&"object"===l()(u)&&((t=Object.assign(t,u))[ea]=ca(t[ea])),"function"==typeof c&&e.apply(void 0,[t,c].concat(i))}else a&&"object"===l()(a)&&((t=Object.assign(t,a))[ea]=ca(t[ea]))},Fs=function(e){fe()(n,e);var t=Rs(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(){var e,t,r=this;Object.assign(r,(e={},ke()(e,ea,ba),ke()(e,ta,[]),ke()(e,na,[]),ke()(e,ra,0),ke()(e,ia,null),ke()(e,oa,null),ke()(e,aa,!1),e));for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];(t=we()(pe()(n.prototype),"construct",this)).call.apply(t,[this].concat(o))}},{key:"hasStore",value:function(e){return this[ta].includes(e)}},{key:"addStore",value:function(e){this.hasStore(e)||(this[ta].push(e),e.stm=this)}},{key:"removeStore",value:function(e){this.hasStore(e)&&(this[ta]=this[ta].filter((function(t){return t!==e})),e.stm=null)}},{key:"forEachStore",value:function(e){this[ta].forEach((function(t){return e(t,t.id)}))}},{key:"enable",value:function(){this.disabled=!1}},{key:"disable",value:function(){this.disabled=!0}},{key:"startTransaction",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Os(this,this.state.onStartTransaction,e)}},{key:"stopTransaction",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;Os(this,this.state.onStopTransaction,e)}},{key:"stopTransactionDelayed",value:function(){Os(this,this.state.onStopTransactionDelayed)}},{key:"rejectTransaction",value:function(){Os(this,this.state.onRejectTransaction)}},{key:"undo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;Os(this,this.state.onUndo,e)}},{key:"undoAll",value:function(){this.undo(this.length)}},{key:"redo",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;Os(this,this.state.onRedo,e)}},{key:"redoAll",value:function(){this.redo(this.length)}},{key:"resetQueue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{undo:!0,redo:!0};Os(this,this.state.onResetQueue,e)}},{key:"resetUndoQueue",value:function(){this.resetQueue({undo:!0})}},{key:"resetRedoQueue",value:function(){this.resetQueue({redo:!0})}},{key:"notifyStoresAboutStateRecordingStart",value:function(e){var t=this;this.forEachStore((function(n){n.onStmRecordingStart&&n.onStmRecordingStart(t,e)})),this.trigger("recordingStart",{stm:this,transaction:e})}},{key:"notifyStoresAboutStateRecordingStop",value:function(e,t){var n=this;this.forEachStore((function(r){r.onStmRecordingStop&&r.onStmRecordingStop(n,e,t)})),this.trigger("recordingStop",{stm:this,transaction:e,reason:t})}},{key:"notifyStoresAboutStateRestoringStart",value:function(){var e=this;this.forEachStore((function(t){t.onStmRestoringStart&&t.onStmRestoringStart(e)})),this.trigger("restoringStart",{stm:this})}},{key:"notifyStoresAboutStateRestoringStop",value:function(){var e=this;this.forEachStore((function(t){t.onStmRestoringStop&&t.onStmRestoringStop(e)})),this.trigger("restoringStop",{stm:this})}},{key:"notifyStoresAboutQueueReset",value:function(e){var t=this;this.forEachStore((function(n){n.onStmQueueReset&&n.onStmQueueReset(t,e)})),this.trigger("queueReset",{stm:this,options:e})}},{key:"onModelUpdate",value:function(e,t,n){Os(this,this.state.onModelUpdate,e,t,n)}},{key:"onModelInsertChild",value:function(e,t,n,r){Os(this,this.state.onModelInsertChild,e,t,n,r)}},{key:"onModelRemoveChild",value:function(e,t,n){Os(this,this.state.onModelRemoveChild,e,t,n)}},{key:"onStoreModelAdd",value:function(e,t,n){Os(this,this.state.onStoreModelAdd,e,t,n)}},{key:"onStoreModelInsert",value:function(e,t,n,r,i){Os(this,this.state.onStoreModelInsert,e,t,n,r,i)}},{key:"onStoreModelRemove",value:function(e,t,n,r){Os(this,this.state.onStoreModelRemove,e,t,n,r)}},{key:"onStoreRemoveAll",value:function(e,t,n){Os(this,this.state.onStoreRemoveAll,e,t,n)}},{key:"state",get:function(){return this[ea]}},{key:"position",get:function(){return this[ra]}},{key:"length",get:function(){return this[na].length}},{key:"stores",get:function(){return Array.from(this[ta])}},{key:"disabled",get:function(){return this.state===ha},set:function(e){var t=this;t.disabled!=e&&(Os(t,e?t.state.onDisable:t.state.onEnable,t),t.trigger("stmDisabled",{disabled:e}),t.trigger("disabled",{disabled:e}))}},{key:"isReady",get:function(){return this.state===ba||this.state===Aa}},{key:"isRecording",get:function(){return this.state===Da||this.state===$a}},{key:"autoRecord",get:function(){return this[aa]},set:function(e){var t=this;t.autoRecord!=e&&Os(t,e?t.state.onAutoRecordOn:t.state.onAutoRecordOff,t)}},{key:"transaction",get:function(){return this[ia]}},{key:"queue",get:function(){return this[na].map((function(e){return e.title}))}},{key:"isRestoring",get:function(){return this.state===Ea}},{key:"canUndo",get:function(){return this.state.canUndo(this)}},{key:"canRedo",get:function(){return this.state.canRedo(this)}}],[{key:"defaultConfig",get:function(){return{disabled:!0,autoRecord:!1,autoRecordTransactionStopTimeout:100,makeModelUpdateAction:xs,makeModelInsertChildAction:Es,makeModelRemoveChildAction:Ts,makeStoreModelAddAction:Ms,makeStoreModelInsertAction:As,makeStoreModelRemoveAction:Ps,makeStoreRemoveAllAction:Is,getTransactionTitle:null}}}]),n}(Ge(ue));Fs._$name="StateTrackingManager";var Ls=function(){function e(){v()(this,e)}return g()(e,null,[{key:"animationFrame",value:function(){return new Promise((function(e){requestAnimationFrame(e)}))}},{key:"sleep",value:function(e){return new Promise((function(t){setTimeout((function(){t()}),e)}))}},{key:"yield",value:function(){return Promise.resolve()}}]),e}();Ls._$name="AsyncHelper";var js=function(){function e(){v()(this,e)}return g()(e,null,[{key:"insertRule",value:function(e){var t=this.styleSheet,n=t.cssRules.length;if(t.insertRule(e,0),t.cssRules.length>n)return t.cssRules[0]}},{key:"findRule",value:function(e){var t,n="function"==typeof e;return Array.prototype.find.call(document.head.querySelectorAll("link[rel=stylesheet],style[type*=css]"),(function(r){if(t=Array.prototype.find.call(r.sheet.rules||r.sheet.cssRules,(function(t){return n?e(t):t.selectorText===e})))return!0})),t}},{key:"styleSheet",get:function(){return this._stylesheet||(this._stylesheet=Cr.createElement({tag:"style",id:"bryntum-private-styles",type:"text/css",parent:document.head}).sheet),this._stylesheet}}]),e}();function _s(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Bs(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Bs(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Bs(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}js._$name="CSSHelper";var Hs=Array.prototype.slice,$s=/[&<]/,Ns={ignore:{_element:1,parent:1,elementData:1,ns:1},evaluate:function(e,t,n){if("html"===e&&"string"!=typeof t.value&&"compareHtml"in t.object)return t.object.compareHtml===n.object.compareHtml}},Vs={tag:1,html:1,text:1,children:1,tooltip:1,parent:1,nextSibling:1,ns:1,reference:1,_element:1,elementData:1,retainElement:1,compareHtml:1,syncOptions:1,listeners:1,isReleased:1},zs={class:1,className:1,classname:1},Ws=Object.freeze([]),Gs=function(){function e(){v()(this,e)}return g()(e,null,[{key:"sync",value:function(e){var t,n,r,i,o=e.refOwner,a=o&&o.byRef,s=e.affected;if("string"==typeof s&&(s=[s]),o){if(o.byRef={},s)for(n in a)s.includes(n)||(o.byRef[n]=a[n]);e=Object.assign({refsWas:a},e)}if(this.performSync(e,e.targetElement)&&o)for(s||(s=Object.keys(a)),t=0;t<s.length;++t)(n=s[t])in o.byRef||(r=a[n])&&(i=r.lastDomConfig,r.remove(),o.detachRef(n,r,i));return e.targetElement}},{key:"performSync",value:function(e,t){var n=e.domConfig,r=e.callback;return(e.configEquality?e.configEquality(n,t.lastDomConfig,Ns):an.isDeeplyEqual(n,t.lastDomConfig,Ns))?(this.relinkElements(n,t),r&&r({action:"none",domConfig:n,targetElement:t}),!1):(n?(n.onlyChildren||(this.syncAttributes(n,t,e),this.syncContent(n,t)),this.syncChildren(e,t),n._element=t):(t.innerHTML=null,t.syncIdMap=null),t.lastDomConfig=n,!0)}},{key:"relinkElements",value:function(e,t){var n=this;e.retainElement||(e._element=t,e.children&&e.children.forEach((function(e,r){e&&"string"!=typeof e&&n.relinkElements(e,t.lastDomConfig.children[r]._element)})))}},{key:"syncDataset",value:function(e,t){for(var n=t.lastDomConfig,r=e===n,i=Object.keys(e.dataset),o=n&&n.dataset&&Object.keys(n.dataset),a=De.delta(i,o),s=0;s<a.onlyInA.length;s++){var u=a.onlyInA[s],c=e.dataset[u];void 0!==c&&t.setAttribute("data-".concat(E.hyphenate(u)),c)}for(var l=0;l<a.inBoth.length;l++){var f=a.inBoth[l];(r||e.dataset[f]!=n.dataset[f])&&t.setAttribute("data-".concat(E.hyphenate(f)),e.dataset[f])}for(var d=0;d<a.onlyInB.length;d++)t.removeAttribute("data-".concat(E.hyphenate(a.onlyInB[d])))}},{key:"syncClassList",value:function(e,t,n){var r,i,o,a,s,u,c=e.className||e.class;if(n){for(i=An.normalize(t,"array"),c=An.normalize(c,"object"),u=An.normalize(n.className||n.class,"object"),s=[],o=0,a=i.length;o<a;++o)!c[r=i[o]]&&r in u||(u[r]=1,s.push(r));for(r in c)u[r]||s.push(r);c=s.join(" ")}else c=An.normalize(c);t.setAttribute("class",c)}},{key:"getSyncAttributes",value:function(e){var t={},n=[];return e&&Object.keys(e).forEach((function(r){if(!Vs[r]){var i=r.toLowerCase();t[i]=e[r],n.push(i)}})),{attributes:t,names:n}}},{key:"syncAttributes",value:function(e,t,n){for(var r=t.lastDomConfig,i=e===r,o=this.getSyncAttributes(e),a=o.attributes,s=o.names,u=i?o:this.getSyncAttributes(r),c=u.attributes,l=u.names,f=i?{onlyInA:Ws,onlyInB:Ws,inBoth:s}:De.delta(s,l),d=f.onlyInA,h=f.onlyInB,v=f.inBoth,p=0;p<d.length;p++){var g=d[p],y=a[g];"style"===g?Cr.applyStyle(t,y,!0):"dataset"===g?this.syncDataset(e,t):zs[g]?this.syncClassList(e,t):void 0!==y&&t.setAttribute(g,y)}for(var m=0;m<h.length;m++)t.removeAttribute(h[m]);for(var k=0;k<v.length;k++){var b=v[k],w=a[b],C=c[b];null==w?t.removeAttribute(b):"style"===b?n.strict?i?this.syncStyles(t,w):an.isEqual(w,C,!0)||this.syncStyles(t,w,C):!i&&an.isEqual(w,C,!0)||Cr.applyStyle(t,w,!0):"dataset"===b?this.syncDataset(e,t):zs[b]?this.syncClassList(e,t,n.strict&&t.lastDomConfig):(i||w!==C)&&t.setAttribute(b,w)}}},{key:"syncStyles",value:function(e,t,n){var r,i,o;if(n){if(r={},t)for(i in t)o=t[i],n[i]!==o&&(r[i]=o);for(i in n)i in t||(r[i]="")}else r=t;Cr.applyStyle(e,r)}},{key:"syncContent",value:function(e,t){var n=e.html,r=e.text,i=null!=r?r:n;e.elementData&&(t.elementData=e.elementData),i instanceof DocumentFragment?1===t.childNodes.length&&0===t.childElementCount&&1===i.childNodes.length&&0===i.childElementCount?Cr.setInnerText(t,i.firstChild.data):(t.innerHTML="",t.appendChild(i)):null!=n&&$s.test(n)?t.innerHTML=String(n):null!=i&&Cr.setInnerText(t,String(i))}},{key:"insertTextNode",value:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,o=document.createTextNode(e);t.insertBefore(o,i),r&&(o.$refOwnerId=r.id),n&&n({action:"newNode",domConfig:e,targetElement:o})}},{key:"insertElement",value:function(e,t,n,r,i,o,a){var s=a.ns?document.createElementNS(a.ns,e.tag||"svg"):document.createElement(e.tag||"div");t.insertBefore(s,n),this.performSync(a,s),null!=o&&(i[o]=s),r&&(s.$refOwnerId=r.id,o&&(s.$reference=o,r.attachRef(o,s,e))),a.callback&&a.callback({action:"newElement",domConfig:e,targetElement:s,syncId:o})}},{key:"syncChildren",value:function(e,t){var n,r=e.domConfig,i=e.syncIdField,o=e.callback,a=e.releaseThreshold,s=e.configEquality,u=e.ns,c=e.refOwner,l=e.refsWas,f=e.strict;if(!(null!==(n=r.html)&&void 0!==n?n:r.text)){var h=c?c.byRef:{},v=Hs.call(r.children||[]),p=Hs.call(t.childNodes),g=l||t.syncIdMap||{},y=r.syncOptions||{},m=t.releasedIdMap||{};i=y.syncIdField||i,f=y.strict||f,o=y.callback||o,s=y.configEquality||s,a="releaseThreshold"in y?y.releaseThreshold:a;var k,b=null;i&&(t.syncIdMap=h);for(var w={refOwner:c,refsWas:l,strict:f,syncIdField:i,releaseThreshold:a,callback:o,configEquality:s};v.length;){var C=v.shift();if(k=null,C){var S="string"==typeof C;if(w.domConfig=C,w.ns=C.ns||u,!S){if(c?k=C.reference:i&&C.dataset&&(k=C.dataset[i]),null!=k&&!C.unmatched){var D=g[k]||m[k];if(D){var R=D.lastDomConfig;!D.retainElement&&this.performSync(w,D)&&o&&o({action:"reuseOwnElement",domConfig:C,lastDomConfig:R,targetElement:D,syncId:k}),C.retainElement&&(D.retainElement=!0,C._element=D),h[k]=D,De.remove(p,D),delete m[k],D.isReleased=!1,(f||D.parentNode!==t)&&t.insertBefore(D,p[0]||null)}else f?this.insertElement(C,t,p[0]||null,c,h,k,w):(v.push(C),C.unmatched=!0);continue}C.unmatched&&delete C.unmatched}for(var x=null,E=null,T=void 0;p.length&&!E;){if(T=p.shift(),c){if(T.$refOwnerId!==c.id)continue;if(T.$reference){if(!f)continue;x=T;break}E=T}else T.retainElement||(E=T);E||(b||(b=[])).push(T)}if(x||!E)S?this.insertTextNode(C,t,o,c,x):this.insertElement(C,t,x,c,h,k,w);else if(S||E.nodeType!==Node.ELEMENT_NODE||(C.tag||"div").toLowerCase()!==E.tagName.toLowerCase())S&&E.nodeType===Node.TEXT_NODE?E.data=C:(S?this.insertTextNode(C,t,o,c,E):this.insertElement(C,t,E,c,h,k,w),E.remove());else{var M,A=E.lastDomConfig,P=this.performSync(w,E);i&&(null==A||null===(M=A.dataset)||void 0===M?void 0:M[i])&&delete m[A.dataset[i]],null!=k&&(h[k]=E),E.isReleased=!1,P&&o&&o({action:"reuseElement",domConfig:C,lastDomConfig:A,targetElement:E,syncId:k})}}}var I=p.length;if(I)if(c)for(var O=0;O<I;++O){var F=p[O];F.$refOwnerId!==c.id||F.$reference||(b||(b=[])).push(F)}else if(b){var L;(L=b).push.apply(L,d()(p))}else b=p;b&&this.syncChildrenCleanup(t,b,h,o,c,a,i)}}},{key:"syncChildrenCleanup",value:function(e,t,n,r,i,o,a){var s,u,c=0,l=_s(t);try{for(l.s();!(u=l.n()).done;){var f=u.value,d=f.lastDomConfig;f.retainElement?a&&d&&(n[f.dataset[a]]=f):!i&&a&&(null==o||c<o)?(f.isReleased||(f.className="b-released",f.isReleased=!0,(null==d?void 0:d.dataset)&&(e.releasedIdMap||(e.releasedIdMap={}),e.releasedIdMap[d.dataset[a]]=f),r&&r({action:"releaseElement",domConfig:d,lastDomConfig:d,targetElement:f}),d&&(d.isReleased=!0,d.className&&(d.className="b-released"),d.style&&(d.style=null))),c++):(f.remove(),i&&(s=f.$reference)&&i.detachRef(s,f,d),e.releasedIdMap&&a&&(null==d?void 0:d.dataset)&&delete e.releasedIdMap[d.dataset[a]],r&&r({action:"removeElement",domConfig:f.lastDomConfig,lastDomConfig:f.lastDomConfig,targetElement:f}))}}catch(e){l.e(e)}finally{l.f()}}},{key:"removeChild",value:function(e,t){if(e.contains(t)){var n=e.syncIdMap;if(n){var r=Object.values(n).indexOf(t);r>-1&&delete n[Object.keys(n)[r]]}e.removeChild(t)}}},{key:"addChild",value:function(e,t,n){e.appendChild(t),e.syncIdMap[n]=t}},{key:"getChild",value:function(e,t){var n,r=_s(t.split("."));try{for(r.s();!(n=r.n()).done;){var i=n.value;e=e.syncIdMap[i]}}catch(e){r.e(e)}finally{r.f()}return e}}]),e}();function Ys(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Gs._$name="DomSync";function Us(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var qs={pageXOffset:0,pageYOffset:0};function Ks(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var Xs=function(e){fe()(n,e);var t=Ks(n);function n(e,r){return v()(this,n),t.call(this,e,r,0,0)}return g()(n,null,[{key:"from",value:function(e){var t=e.changedTouches;return new n(t?t[0].screenX:e.screenX,t?t[0].screenY:e.pageY)}}]),g()(n,[{key:"constrain",value:function(e){return this.x=Math.min(Math.max(this.x,e.x),e.right-1),this.y=Math.min(Math.max(this.y,e.y),e.bottom-1),this}},{key:"toArray",value:function(){return[this.x,this.y]}}]),n}(En);Object.getPrototypeOf(Xs).Point=Xs,Xs._$name="Point";var Zs=["clientX","clientY","pageX","pageY","screenX","screenY"],Js={element:1,thisObj:1,once:1,delegate:1,delay:1,capture:1,passive:1,throttled:1,autoDetach:1,expires:1},Qs={get:function(){return!0}},eu={Spacebar:"Space",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown"};function tu(e,t){for(var n,r;(e=Object.getPrototypeOf(e))&&!r;)r=(n=Object.getOwnPropertyDescriptor(e,t))&&n.get;return r}var nu=function(){function e(){v()(this,e)}return g()(e,null,[{key:"normalizeEvent",value:function(e){return an.copyPropertiesIf(e,e.changedTouches[0]||e.touches[0],Zs)}},{key:"getXY",value:function(e){return e.touches&&(e=e.touches[0]),[e.clientX,e.clientY]}},{key:"getDistanceBetween",value:function(e,t){var n=ru.getXY(e),r=ru.getXY(t);return Math.sqrt(Math.pow(n[0]-r[0],2)+Math.pow(n[1]-r[1],2))}},{key:"getPagePoint",value:function(e){return new En.Point(e.pageX,e.pageY)}},{key:"getClientPoint",value:function(e){return new En.Point(e.clientX,e.clientY)}},{key:"addListener",value:function(e,t,n,r){return r=e.nodeType?"string"==typeof t?Object.assign(ke()({element:e},t,n),r):Object.assign({element:e},t):e,ru.on(r)}},{key:"on",value:function(e){var t=e.element,n=e.thisObj,r=[];for(var i in e)if(!Js[i]){var o=e[i];"object"!==l()(o)&&(o={handler:o});var a=o.element||t;j.a.isTouchDevice&&!j.a.isAndroid&&"contextmenu"===i&&r.push(ru.addElementListener(a,"touchstart",{handler:ru.createContextMenuWrapper(o.handler,o.thisObj||n)},e)),r.push(ru.addElementListener(a,i,o,e))}var s=function(){for(var e,t=0;t<r.length;t++)e=r[t],ru.removeEventListener(e[0],e[1],e[2]);r.length=0};return n&&!1!==e.autoDetach&&(n.doDestroy=xe.createInterceptor(n.doDestroy,s,n)),s}},{key:"addElementListener",value:function(e,t,n,r){var i=ru.createHandler(e,t,n,r),o="passive"in n,a=n.expires||r.expires,s=n.capture||r.capture;if((o||"passive"in r)&&j.a.supportsPassive&&(s={capture:!!s,passive:o?n.passive:r.passive}),e.addEventListener(t,i,s),a){var u=n.thisObj||r.thisObj,c=(null==u?void 0:u.isDelayable)?u:window,l=a.alt,f=l?a.delay:a,d=i.spec;d.expires=a,d.timerId=c["number"==typeof f?"setTimeout":"requestAnimationFrame"]((function(){d.timerId=null,ru.removeEventListener(e,t,i),l&&!i.called&&("string"==typeof l?u[l]:l).call(u)}),f,"listener-timer-".concat(performance.now()))}return[e,t,i,s]}},{key:"fixEvent",value:function(e){var t,n,r,i,o=e.type;if(o.startsWith("key")){var a=eu[e.key];a&&Object.defineProperty(e,"key",{get:function(){return a}})," "!==e.key||e.code||Object.defineProperty(e,"code",{get:function(){return"Space"}})}if(e.metaKey&&!e.ctrlKey&&Object.defineProperty(e,"ctrlKey",Qs),(null===(t=e.target)||void 0===t?void 0:t.shadowRoot)&&e.composedPath&&!j.a.isIE11&&!j.a.isEdge){var s=e.composedPath()[0],u=e.target;e.target!==s&&(Object.defineProperty(e,"target",{get:function(){return s},configurable:!0}),Object.defineProperty(e,"originalTarget",{get:function(){return u},configurable:!0}))}if(j.a.isChrome&&e.target&&"offsetX"in e&&(Object.getOwnPropertyDescriptor(e,"offsetX")||Object.defineProperty(e,"offsetX",{get:function(){var t=tu(e,"offsetX").call(e),n=e.target.offsetWidth,r=Math.min(Math.max(t,0),n-1);return t<0||t>=n?r:t}}),Object.getOwnPropertyDescriptor(e,"offsetY")||Object.defineProperty(e,"offsetY",{get:function(){var t=tu(e,"offsetY").call(e),n=e.target.offsetHeight,r=Math.min(Math.max(t,0),n-1);return t<0||t>=n?r:t}})),9===(null===(n=e.target)||void 0===n?void 0:n.nodeType)&&"clientX"in e){var c=Cr.elementFromPoint(e.clientX,e.clientY);Object.defineProperty(e,"target",{get:function(){return c}})}if(3===(null===(r=e.target)||void 0===r?void 0:r.nodeType)){var l=e.target.parentElement;Object.defineProperty(e,"target",{get:function(){return l}})}if(3===(null===(i=e.relatedTarget)||void 0===i?void 0:i.nodeType)){var f=e.target.parentElement;Object.defineProperty(e,"relatedTarget",{get:function(){return f}})}return o.startsWith("touch")&&e.touches.length&&this.normalizeEvent(e),e}},{key:"createHandler",value:function(e,t,n,r){var i=n.delay||r.delay,o=n.throttled||r.throttled,a=n.block||r.block,s=n.once||r.once,u=n.thisObj||r.thisObj,c=n.capture||r.capture,l=n.delegate||r.delegate,f=n.handler,d=function(e){var t;if(d.called=!0,!(ru.playingDemo&&e.isTrusted||u&&u.isDestroyed)){if(e=ru.fixEvent(e),l){var n=e.target instanceof HTMLElement&&e.target.closest(l);if(!n)return;Object.defineProperty(e,"currentTarget",{get:function(){return n},configurable:!0})}for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];(t="string"==typeof f?u[f]:f).call.apply(t,[u,e].concat(i))}};if(a){var h,v,p=d;d=function(e){var t=performance.now();if(!h||e.target!==v||t-h>a){v=e.target,h=t;for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];p.apply(void 0,[e].concat(r))}}}if(null!=i){var g=d,y=u&&u.setTimeout?u:window;d=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];y.setTimeout((function(){g.apply(void 0,t)}),i)}}if(null!=o){var m,k=o;o.buffer&&(m=function(e){return o.alt.call(ru,ru.fixEvent(e))},k=o.buffer),d=u&&u.isDelayable?u.throttle(d,{delay:k,throttled:m}):xe.createThrottled(d,k,u,null,m)}if(s){var b=d;d=function(){ru.removeEventListener(e,t,d),b.apply(void 0,arguments)}}return n.thisObj&&!1!==n.autoDetach&&(u.doDestroy=xe.createInterceptor(u.doDestroy,(function(){return ru.removeEventListener(e,t,d)}),u)),d.spec={delay:i,throttled:o,block:a,once:s,thisObj:u,capture:c,delegate:l},d}},{key:"removeEventListener",value:function(e,t,n){var r=n.spec,i=r.expires,o=r.timerId,a=r.thisObj,s=r.capture;(null==i?void 0:i.alt)&&o&&((null==a?void 0:a.isDelayable)?a:window)["number"==typeof i.delay?"clearTimeout":"cancelAnimationFrame"](o);e.removeEventListener(t,n,s)}},{key:"onTransitionEnd",value:function(e){var t,n=e.element,r=e.property,i=e.handler,o=e.duration,a=void 0===o?Cr.getPropertyTransitionDuration(n,r):o,s=e.thisObj,u=void 0===s?window:s,c=u.isDelayable?u:window,l=function(){f(),u.isDestroyed||(u.callback?u.callback(i,u):i.call(u))},f=ru.on({element:n,transitionend:function(e){var i=e.propertyName,o=e.target;i===r&&o===n&&(t&&(c.clearTimeout(t),t=null),l())}});return null!=a&&(t=c.setTimeout(l,a+20)),f}},{key:"createContextMenuWrapper",value:function(e,t){return function(n){if(1===n.touches.length)var r=n.touches[0],i=setTimeout((function(){a();var i=new MouseEvent("contextmenu",r);Object.defineProperty(i,"target",{get:function(){return r.target}}),"string"==typeof e&&(e=t[e]),i.browserEvent=n,e.call(t,i),ru.contextMenuTouchId=r.identifier}),ru.longPressTime),o=function(){ru.contextMenuTouchId=null,a(),clearTimeout(i)},a=ru.on({element:document,touchmove:o,touchend:o,pointermove:o,pointerup:o,capture:!0})}}},{key:"createDblClickWrapper",value:function(e,t,n){var r,i,o;return function(){i||(i=ru.on({element:e,touchstart:function(e){r=e.changedTouches[0].identifier,e.preventDefault()},touchend:function(e){if(e.changedTouches[0].identifier===r){e.preventDefault(),clearTimeout(o),r=i=null;var a=En.from(e.changedTouches[0].target,null,!0),s=e.changedTouches[0].pageX-a.x,u=e.changedTouches[0].pageY-a.y,c=Object.assign({browserEvent:e},e),l=new MouseEvent("dblclick",c);Object.defineProperty(l,"target",{get:function(){return e.target}}),Object.defineProperty(l,"offsetX",{get:function(){return s}}),Object.defineProperty(l,"offsetY",{get:function(){return u}}),"string"==typeof t&&(t=n[t]),t.call(n,l)}},once:!0}),o=setTimeout((function(){i(),r=i=null}),ru.dblClickTime))}}},{key:"lockComposedPath",value:function(e){var t;e.composedPath&&(e.composedPath=(t=e.composedPath(),function(){return t}))}}]),e}(),ru=nu;function iu(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}ru.longPressTime=500,ru.dblClickTime=300,ru.on({element:document,mousedown:function(){Cr.isTouchEvent||(Cr.usingKeyboard=!1,document.body.classList.remove("b-using-keyboard"))},touchmove:function(){Cr.usingKeyboard=!1,document.body.classList.remove("b-using-keyboard")},keydown:function(){Cr.usingKeyboard=!0,document.body.classList.add("b-using-keyboard")}}),j.a.isTouchDevice&&ru.on({element:document,touchmove:function(e){e.target.closest(".b-dragging")&&e.preventDefault()},passive:!1,capture:!0}),Hr(document,nu),nu._$name="EventHelper";var ou="onMouseDown",au="onMouseMove",su="onMouseUp",uu="onDocumentClick",cu="onTouchStart",lu="onTouchMove",fu="onTouchEnd",du="onKeyDown",hu=function(e){fe()(n,e);var t=iu(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e){var t=this;we()(pe()(n.prototype),"construct",this).call(this,e),t.initListeners(),"container"===t.mode?t.initContainerDrag():t.mode.startsWith("translate")&&t.initTranslateDrag(),t.initialMode=t.mode}},{key:"doDestroy",value:function(){this.abort(!0),we()(pe()(n.prototype),"doDestroy",this).call(this)}},{key:"initListeners",value:function(){var e={element:this.outerElement,mousedown:ou,thisObj:this};j.a.isTouchDevice&&(e.touchstart=cu),nu.on(e)}},{key:"onPointerDown",value:function(e){var t=this,n=!1,r="touches"in e;if(t.context)t.context.awaitingFinalization||(t.onMouseUp(e),t.reset());else if(t.startEvent=e,(!t.isElementDraggable||t.isElementDraggable(e.target,e))&&(t.mode&&(n||"container"!==t.mode||(n=t.grabContainerDrag(e)),!n&&t.mode.startsWith("translate")&&(n=t.grabTranslateDrag(e))),n)){var i={element:t.listenersTarget,thisObj:t,keydown:du};if(r?(i.touchmove={handler:lu,passive:!1},i.touchend=i.pointerup=fu):(i.mousemove=au,i.mouseup=su),t.removeListeners=nu.on(i),t.dragWithin&&t.dragWithin!==t.outerElement){var o=t.dragWithin.getBoundingClientRect();t.minY=o.top,t.maxY=o.bottom,t.minX=o.left,t.maxX=o.right}}}},{key:"onTouchStart",value:function(e){var t=this;1===e.touches.length&&(t.touchStartTimer=t.setTimeout((function(){t.touchStartTimer=null}),t.touchStartDelay,"touchStartDelay"),t.onPointerDown(e))}},{key:"onMouseDown",value:function(e){0===e.button&&this.onPointerDown(e)}},{key:"internalMove",value:function(e){var t=this,n=t.context,r=nu.getDistanceBetween(t.startEvent,e);if(t.touchStartTimer&&r>t.dragThreshold)t.abort(!0);else if(!t.touchStartTimer&&n&&n.element&&e.target&&e.target.nodeType===Node.ELEMENT_NODE&&(n.started||r>=t.dragThreshold)){if(!n.started&&!1===t.callPreventable("dragStart",{context:n,event:e},(function(){"container"!==t.mode&&(t.lockY?t.mode="translateX":t.lockX?t.mode="translateY":t.mode=t.initialMode);var r=t.lockX?"vertical":t.lockY?"horizontal":"both";n.action.startsWith("translate")?t.startTranslateDrag(e):"container"===n.action&&t.startContainerDrag(e),n.started=!0,t.scrollManager&&t.scrollManager.startMonitoring({direction:r,element:t.dragWithin||t.outerElement,callback:function(e){t.context.element&&t.lastMouseMoveEvent&&(t.lastMouseMoveEvent.isScroll=!0,t.update(t.lastMouseMoveEvent,e))},thisObj:t}),document.body.classList.add("b-draghelper-active")})))return t.abort();"touchmove"===e.type&&(e.preventDefault(),e.stopImmediatePropagation()),t.update(e)}}},{key:"onTouchMove",value:function(e){this.internalMove(e)}},{key:"onMouseMove",value:function(e){this.internalMove(e)}},{key:"update",value:function(e,t){var n=this,r=n.context,i=r.dragProxy||r.element,o=e.target,a=document.scrollingElement||document.body;if("touchmove"===e.type){var s=e.changedTouches[0];o=Cr.elementFromPoint(s.clientX+a.scrollLeft,s.clientY+a.scrollTop)}r.target=o,n.dropTargetSelector?r.valid=Boolean(o.closest(n.dropTargetSelector)):r.valid=!0,r.action&&("container"===r.action&&n.updateContainerProxy(e,t),r.action.startsWith("translate")&&n.updateTranslateProxy(e,t)),n.trigger("drag",{context:r,event:e}),"container"===r.action&&n.updateContainerDrag(e,t),i.classList[r.valid?"remove":"add"](n.invalidCls),e&&(n.lastMouseMoveEvent=e)}},{key:"abort",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=t.context;t.scrollManager&&t.scrollManager.stopMonitoring(t.dragWithin||t.outerElement),n&&(n.element.getBoundingClientRect(),n.valid=!1,"container"===n.action?t.abortContainerDrag(void 0,void 0,e):t.abortTranslateDrag(void 0,void 0,e)),t.reset()}},{key:"removeListeners",value:function(){}},{key:"reset",value:function(e){document.body.classList.remove("b-draghelper-active"),this.removeListeners(),e||this.trigger("reset"),this.context=this.lastMouseMoveEvent=null}},{key:"onTouchEnd",value:function(e){this.onMouseUp(e)}},{key:"onDocumentClick",value:function(e){e.stopPropagation()}},{key:"onMouseUp",value:function(e){var t=this,n=t.context;t.removeListeners(),n&&(t.scrollManager&&t.scrollManager.stopMonitoring(t.dragWithin||t.outerElement),"container"===n.action?t.finishContainerDrag(e):n.started&&n.action.startsWith("translate")&&t.finishTranslateDrag(e),n.started?nu.on({element:document,thisObj:t,click:uu,capture:!0,expires:t.clickSwallowDuration,once:!0}):t.reset(!0))}},{key:"onKeyDown",value:function(e){"Escape"===e.key&&this.abort()}},{key:"createProxy",value:function(e){var t=e.cloneNode(!0);return t.removeAttribute("id"),t}},{key:"listenersTarget",get:function(){return document}}],[{key:"defaultConfig",get:function(){return{dragProxyCls:"b-drag-proxy",invalidCls:"b-drag-invalid",draggingCls:"b-dragging",dropPlaceholderCls:"b-drop-placeholder",dragThreshold:5,outerElement:document.body,dragWithin:null,constrain:!0,minX:null,maxX:null,minY:null,maxY:null,mode:null,isElementDraggable:null,targetSelector:null,dropTargetSelector:null,cloneTarget:!1,hideOriginalElement:!1,containers:null,ignoreSelector:null,startEvent:null,lockX:!1,lockY:!1,touchStartDelay:300,transitionDuration:300,clickSwallowDuration:50,ignoreSamePositionDrop:!0,testConfig:{transitionDuration:10,clickSwallowDuration:j.a.isEdge?300:50}}}}]),n}(ue.mixin(Ge,(function(e){return function(e){fe()(n,e);var t=Ys(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"initContainerDrag",value:function(){if(this.mode||(this.mode="container"),"container"===this.mode&&!this.containers)throw new Error("Container drag mode must specify containers")}},{key:"grabContainerDrag",value:function(e){var t=this;if(!t.ignoreSelector||!Cr.up(e.target,t.ignoreSelector)){var n=Cr.getAncestor(e.target,t.containers,t.outerElement);if(n){var r=n.getBoundingClientRect();t.context={element:n,valid:!0,action:"container",offsetX:e.pageX-r.left,offsetY:e.pageY-r.top,originalPosition:{parent:n.parentElement,prev:n.previousElementSibling,next:n.nextElementSibling}}}return!0}return!1}},{key:"startContainerDrag",value:function(e){var t=this.context,n=t.element,r=n.cloneNode(!0),i=n.getBoundingClientRect();r.classList.add(this.dragProxyCls),r.classList.add(this.draggingCls),document.body.appendChild(r),t.dragProxy=r,r.style.width=i.width+"px",r.style.height=i.height+"px",Cr.setTranslateXY(t.dragProxy,i.left,i.top),t.dragging=n,n.classList.add(this.dropPlaceholderCls)}},{key:"updateContainerDrag",value:function(e){var t=this.context;if(t.started&&t.targetElement){var n=Cr.getAncestor(t.targetElement,this.containers,"b-grid"),r=t.dragging&&t.dragging.contains(Cr.activeElement);n&&Cr.isDescendant(t.element,n)||(r&&$r.suspendFocusEvents(),n&&t.valid?this.moveNextTo(n,e):this.revertPosition(),r&&$r.resumeFocusEvents(),e.preventDefault())}}},{key:"finishContainerDrag",value:function(e){var t=this,n=this,r=n.context,i=r.dragging,o=r.dragProxy,a=r.valid,s=r.draggedTo,u=r.insertBefore,c=r.originalPosition;i&&(r.valid=a&&s&&(i!==u||c.parent!==s),r.finalize=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:r.valid;!e&&t.context&&n.revertPosition(),i.classList.remove(n.dropPlaceholderCls),o.remove(),n.reset()},r.async=!1,n.trigger("drop",{context:r,event:e}),r.async?r.awaitingFinalization=!0:r.finalize())}},{key:"abortContainerDrag",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.context;i.dragging&&(i.dragging.classList.remove(r.dropPlaceholderCls),i.dragProxy.remove(),r.context={}),n||r.trigger(e?"drop":"abort",{context:i,event:t})}},{key:"updateContainerProxy",value:function(e){var t,n=this,r=n.context,i=r.dragProxy,o=e.pageX-r.offsetX,a=e.pageY-r.offsetY;if("number"==typeof n.minX&&(o=Math.max(n.minX,o)),"number"==typeof n.maxX&&(o=Math.min(n.maxX-i.offsetWidth,o)),"number"==typeof n.minY&&(a=Math.max(n.minY,a)),"number"==typeof n.maxY&&(a=Math.min(n.maxY-i.offsetHeight,a)),n.lockX?Cr.setTranslateY(i,a):n.lockY?Cr.setTranslateX(i,o):Cr.setTranslateXY(i,o,a),"touchmove"===e.type){var s=e.changedTouches[0];t=Cr.elementFromPoint(s.clientX,s.clientY)}else t=e.target;r.targetElement=t}},{key:"moveNextTo",value:function(e,t){var n=this.context,r=n.dragging,i=e.parentElement;if(e!==r){var o=e.getBoundingClientRect().left+e.offsetWidth/2;t.pageX<o?(i.insertBefore(r,e),n.insertBefore=e):e.nextElementSibling?e.nextElementSibling!==r?(n.insertBefore=e.nextElementSibling,i.insertBefore(r,e.nextElementSibling)):n.insertBefore||r.parentElement.lastElementChild===r||(n.insertBefore=e.nextElementSibling):(i.appendChild(r),n.insertBefore=null),n.draggedTo=i}}},{key:"revertPosition",value:function(){var e=this.context,t=e.originalPosition;t.next?t.next&&t.next.previousSibling===e.dragging||!t.next&&e.dragging===t.parent.lastChild||t.parent.insertBefore(e.dragging,t.next):t.parent.appendChild(e.dragging);e.draggedTo=null}}],[{key:"$name",get:function(){return"DragHelperContainer"}}]),n}(e||ue)}),(function(e){return function(e){fe()(n,e);var t=Us(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"initTranslateDrag",value:function(){var e=this;e.mode=e.mode||"translateXY",!e.isElementDraggable&&e.targetSelector&&(e.isElementDraggable=function(t){return Cr.up(t,e.targetSelector)})}},{key:"grabTranslateDrag",value:function(e){var t=this.getTarget(e);return!!t&&(this.context={valid:!0,action:this.mode,element:t,startPageX:e.pageX,startPageY:e.pageY,startClientX:e.clientX,startClientY:e.clientY},!0)}},{key:"getTarget",value:function(e){return Cr.up(e.target,this.targetSelector)}},{key:"startTranslateDrag",value:function(e){var t=this,n=t.context,r=n.relatedElements,i=n.dragProxy||n.element;if(i&&!n.started){var o=i,a=i.parentElement,s=t.dragWithin=t.dragWithin||t.cloneTarget&&document.body,u=t.outerElement;if(t.cloneTarget){var c=Cr.getOffsetX(i,s),l=Cr.getOffsetY(i,s),f=i.offsetWidth,d=i.offsetHeight;i=t.createProxy(i),Cr.setTranslateXY(i,c,l),i.style.width="".concat(f,"px"),i.style.height="".concat(d,"px"),i.classList.add(t.dragProxyCls),s.appendChild(i),o.classList.add("b-drag-original"),t.hideOriginalElement&&o.classList.add("b-hidden")}Object.assign(t.context,{element:i,grabbed:o,grabbedParent:a,grabbedNextSibling:i.nextElementSibling,elementStartX:Cr.getTranslateX(i),elementStartY:Cr.getTranslateY(i),elementX:Cr.getOffsetX(i,s||u),elementY:Cr.getOffsetY(i,s||u),scrollX:0,scrollY:0,scrollManagerElementContainsDragProxy:!t.cloneTarget||s===u}),i.classList.add(t.draggingCls),s&&(n.parentElement=i.parentElement,s!==i.parentElement&&s.appendChild(i),t.updateTranslateProxy(e)),r&&r.forEach((function(e){e.classList.add(t.draggingCls)}))}}},{key:"applyConstraints",value:function(e,t,n){var r=this,i=r.dragWithin,o=i===document.body?window:qs,a=o.pageXOffset,s=o.pageYOffset;return i&&r.constrain&&(t<0&&(t=0),t+e.offsetWidth>i.scrollWidth&&(t=i.scrollWidth-e.offsetWidth),n<0&&(n=0),n+e.offsetHeight>i.scrollHeight&&(n=i.scrollHeight-e.offsetHeight)),"number"==typeof r.minX&&(t=Math.max(r.minX+a,t)),"number"==typeof r.maxX&&(t=Math.min(r.maxX+a,t)),"number"==typeof r.minY&&(n=Math.max(r.minY+s,n)),"number"==typeof r.maxY&&(n=Math.min(r.maxY+s,n)),{constrainedX:t,constrainedY:n}}},{key:"updateTranslateProxy",value:function(e,t){var n=this,r=n.mode,i=n.lockX,o=n.lockY,a=n.context,s=a.dragProxy||a.element,u=a.relatedElements,c=a.relatedElDragFromPos;a.scrollManagerElementContainsDragProxy&&t&&(a.scrollX=t.scrollRelativeLeft,a.scrollY=t.scrollRelativeTop),a.pageX=e.pageX,a.pageY=e.pageY,a.clientX=e.clientX,a.clientY=e.clientY;var l=a.elementStartX+e.pageX-a.startPageX+a.scrollX,f=a.elementStartY+e.pageY-a.startPageY+a.scrollY,d=n.applyConstraints(s,l,f),h=d.constrainedX,v=d.constrainedY;if("translateXY"!==r||i||o?"translateX"===r||o?Cr.setTranslateX(s,h):("translateY"===r||i)&&Cr.setTranslateY(s,v):Cr.setTranslateXY(s,h,v),u){var p=i||"translateY"===r?0:h-a.elementStartX,g=o||"translateX"===r?0:v-a.elementStartY;u.forEach((function(e,t){var n=ye()(c[t],2),r=n[0],i=n[1];Cr.setTranslateXY(e,r+p,i+g)}))}a.newX=h,a.newY=v}},{key:"finishTranslateDrag",value:function(e){var t=this,n=t.context,r=n.newX!==n.elementStartX,i=n.newY!==n.elementStartY,o=n.dragProxy||n.element,a=n.relatedElements;function s(){o.classList.remove(t.invalidCls),o.classList.remove(t.draggingCls),a&&a.forEach((function(e){e.classList.remove(t.invalidCls),e.classList.remove(t.draggingCls)})),o.classList.contains("b-aborting")||(t.hideOriginalElement&&n.grabbed.classList.remove("b-hidden"),n.grabbed.classList.remove("b-drag-original"))}if(!t.ignoreSamePositionDrop||"translateY"!==t.mode&&r||"translateX"!==t.mode&&i){if(!1===n.valid)t.abortTranslateDrag(!0,e);else{var u=En.from(t.dragWithin||t.outerElement);!t.minX&&e.pageX<u.left||!t.maxX&&e.pageX>u.right||!t.minY&&e.pageY<u.top||!t.maxY&&e.pageY>u.bottom?(n.valid=!1,t.abortTranslateDrag(!0,e)):(n.finalize=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:n.valid;n.asyncCleanup&&s(),!e&&t.context?t.abortTranslateDrag(!0,null,!0):(t.cloneTarget||n.dragProxy)&&o.remove(),t.reset()},n.async=!1,t.trigger("drop",{context:n,event:e}),n.async?n.awaitingFinalization=!0:n.finalize())}n.asyncCleanup||s()}else t.abortTranslateDrag(!1,e)}},{key:"abortTranslateDrag",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.context,o=i.relatedElements,a=i.relatedElStartPos,s=i.grabbed,u=i.dragProxy||i.element,c=r.cloneTarget&&r.hideOriginalElement?s:u,l=i.elementStartX,f=i.elementStartY;if(u&&i.started){if(!r.cloneTarget&&r.dragWithin&&r.dragWithin!==i.grabbedParent&&i.grabbedParent.insertBefore(u,i.grabbedNextSibling),s.classList.remove("b-hidden"),r.cloneTarget){if(r.hideOriginalElement){var d=Cr.getTranslateXY(s),h=ye()(d,2);l=h[0],f=h[1],Cr.alignTo(s,u),c.getBoundingClientRect()}u.remove()}c.classList.add("b-aborting"),"translateXY"!==r.mode||r.lockX||r.lockY||(Cr.setTranslateXY(c,l,f),o&&o.forEach((function(e,t){e.classList.add("b-aborting"),Cr.setTranslateXY(e,a[t][0],a[t][1])}))),("translateX"===r.mode||r.lockY)&&(Cr.setTranslateX(c,l),o&&o.forEach((function(e,t){e.classList.add("b-aborting"),Cr.setTranslateX(e,a[t][0])}))),("translateY"===r.mode||r.lockX)&&(Cr.setTranslateY(c,f),o&&o.forEach((function(e,t){e.classList.add("b-aborting"),Cr.setTranslateY(e,a[t][1])}))),r.setTimeout((function(){c.classList.remove("b-aborting"),s.classList.remove("b-dragging"),s.classList.remove("b-drag-original"),r.cloneTarget||(o&&o.forEach((function(e,t){e.classList.remove("b-aborting")})),u.classList.remove("b-aborting"),u.classList.remove(r.draggingCls),u.classList.remove(r.invalidCls))}),r.transitionDuration,void 0,!0),n||r.trigger(e?"drop":"abort",{context:i,event:t})}r.reset()}}],[{key:"$name",get:function(){return"DragHelperTranslate"}}]),n}(_a(e||ue))})));function vu(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}hu._$name="DragHelper";var pu="onMouseDown",gu="onMouseMove",yu="onMouseUp",mu="onDocumentClick",ku="onTouchStart",bu="onTouchMove",wu="onTouchEnd",Cu="onKeyDown",Su=function(e){fe()(n,e);var t=vu(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e){var t=this;we()(pe()(n.prototype),"construct",this).call(this,e),!t.handleSelector&&j.a.isTouchDevice&&(t.handleSize=t.touchHandleSize),t.handleVisibilityThreshold=t.handleVisibilityThreshold||2*t.handleSize,t.initListeners(),t.initResize()}},{key:"doDestroy",value:function(){this.abort(!0),we()(pe()(n.prototype),"doDestroy",this).call(this)}},{key:"initResize",value:function(){var e=this;if(!e.isElementResizable&&e.targetSelector&&(e.isElementResizable=function(t){return Cr.up(t,e.targetSelector)}),e.grab){var t=e.grab,n=t.edge,r=t.element,i=t.event;e.startEvent=i;var o=e.getCursorOffsetToElementEdge(i,r,n);e.context={element:r,edge:n,valid:!0,async:!1,elementStartX:Cr.getTranslateX(r)||r.offsetLeft,elementStartY:Cr.getTranslateY(r)||r.offsetTop,newX:Cr.getTranslateX(r)||r.offsetLeft,newY:Cr.getTranslateY(r)||r.offsetTop,elementWidth:r.offsetWidth,elementHeight:r.offsetHeight,cursorOffset:o,startX:i.clientX+o.x+e.scrollLeft,startY:i.clientY+o.y+e.scrollTop,finalize:function(){var t;return null===(t=e.reset)||void 0===t?void 0:t.call(e)}},r.classList.add(e.resizingCls),e.internalStartResize(e.isTouch)}}},{key:"initListeners",value:function(){var e=this,t={element:e.outerElement,mousedown:pu,thisObj:e};j.a.isTouchDevice?t.touchstart=ku:e.handleSelector||(t.mousemove={handler:gu,delegate:e.targetSelector},t.mouseleave={handler:"onMouseLeaveTarget",delegate:e.targetSelector,capture:!0}),e.removeListeners=nu.on(t)}},{key:"removeListeners",value:function(){}},{key:"internalStartResize",value:function(e){var t={element:document,keydown:Cu,thisObj:this};e?(t.touchmove=bu,t.touchend=t.pointerup=wu):(t.mousemove=gu,t.mouseup=yu),this.removeDragListeners=nu.on(t)}},{key:"removeDragListeners",value:function(){}},{key:"reset",value:function(){var e;null===(e=this.removeDragListeners)||void 0===e||e.call(this),this.context=null}},{key:"onPointerDown",value:function(e,t){var n=this;n.startEvent=t,n.isElementResizable&&!n.isElementResizable(t.target,t)||n.grabResizeHandle(e,t)&&(t.stopImmediatePropagation(),n.internalStartResize(e))}},{key:"onTouchStart",value:function(e){e.touches.length>1||this.onPointerDown(!0,e)}},{key:"onMouseDown",value:function(e){0===e.button&&this.onPointerDown(!1,e)}},{key:"internalMove",value:function(e,t){var n=this,r=n.context;r&&r.element&&(r.started||nu.getDistanceBetween(n.startEvent,t)>=n.dragThreshold)?(r.started||(n.scrollManager&&n.scrollManager.startMonitoring({direction:n.direction,element:n.dragWithin||n.outerElement,callback:function(e){return n.context&&n.context.element&&n.lastMouseMoveEvent&&n.update(n.lastMouseMoveEvent,e)},thisObj:n}),n.trigger("resizeStart",{context:r,event:t}),r.started=!0),n.update(t)):e||n.handleSelector||n.checkResizeHandles(t)}},{key:"onTouchMove",value:function(e){this.internalMove(!0,e)}},{key:"onMouseMove",value:function(e){this.internalMove(!1,e)}},{key:"onPointerUp",value:function(e,t){var n,r=this,i=r.context;if(null===(n=r.removeDragListeners)||void 0===n||n.call(r),i)r.scrollManager&&r.scrollManager.stopMonitoring(r.dragWithin||r.outerElement),i.started&&nu.on({element:document,thisObj:r,click:mu,expires:r.clickSwallowDuration,capture:!0,once:!0}),r.finishResize(t);else if(!i.async){var o;null===(o=r.reset)||void 0===o||o.call(r)}}},{key:"onTouchEnd",value:function(e){this.onPointerUp(!0,e)}},{key:"onMouseUp",value:function(e){this.onPointerUp(!1,e)}},{key:"onDocumentClick",value:function(e){e.stopPropagation()}},{key:"onKeyDown",value:function(e){"Escape"===e.key&&this.abort()}},{key:"update",value:function(e){var t=this,n=t.context,r=En.from(t.outerElement);n.currentX=Math.max(Math.min(e.clientX+n.cursorOffset.x,r.right),r.x)+t.scrollLeft,n.currentY=Math.max(Math.min(e.clientY+n.cursorOffset.y,r.bottom),r.y)+t.scrollTop,t.updateResize(e),t.trigger("resizing",{context:n,event:e}),n.element.classList[!1===n.valid?"add":"remove"](t.invalidCls),e&&(t.lastMouseMoveEvent=e)}},{key:"abort",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;t.scrollManager&&t.scrollManager.stopMonitoring(t.dragWithin||t.outerElement),t.context?t.abortResize(null,e):t.isDestroyed||t.reset()}},{key:"grabResizeHandle",value:function(e,t){var n=this;if(n.allowResize&&!n.allowResize(t.target,t))return!1;var r=n.handleSelector,i="touchstart"===t.type?t.changedTouches[0]:t,o=i.clientX,a=i.clientY,s=n.targetSelector?Cr.up(t.target,n.targetSelector):t.target;if(s){var u;if(r){if(!t.target.matches(r))return!1;u="horizontal"===n.direction?t.pageX<Cr.getPageX(s)+s.offsetWidth/2?"left":"right":t.pageY<Cr.getPageY(s)+s.offsetHeight/2?"top":"bottom"}else if("horizontal"===n.direction?n.overLeftHandle(t,s)?u="left":n.overRightHandle(t,s)&&(u="right"):n.overTopHandle(t,s)?u="top":n.overBottomHandle(t,s)&&(u="bottom"),!u)return n.context=null,!1;"touchstart"===t.type&&t.preventDefault();var c=n.getCursorOffsetToElementEdge(i,s,u);if(!1!==n.trigger("beforeResizeStart",{element:s,event:t}))return n.context={element:s,edge:u,valid:!0,async:!1,direction:n.direction,isTouch:e,elementStartX:Cr.getTranslateX(s)||s.offsetLeft,elementStartY:Cr.getTranslateY(s)||s.offsetTop,newX:Cr.getTranslateX(s)||s.offsetLeft,newY:Cr.getTranslateY(s)||s.offsetTop,elementWidth:s.offsetWidth,elementHeight:s.offsetHeight,cursorOffset:c,startX:o+c.x+n.scrollLeft,startY:a+c.y+n.scrollTop,finalize:function(){var e;return null===(e=n.reset)||void 0===e?void 0:e.call(n)}},s.classList.add(n.resizingCls),!0}return!1}},{key:"getCursorOffsetToElementEdge",value:function(e,t,n){var r=En.from(t),i=0,o=0;switch(n){case"left":i=r.x-e.clientX;break;case"right":i=r.x+r.width-e.clientX;break;case"top":o=r.y-e.clientY;break;case"bottom":o=r.y+r.height-e.clientY}return{x:i,y:o}}},{key:"checkResizeHandles",value:function(e){var t=this,n=t.targetSelector?Cr.up(e.target,t.targetSelector):e.target;if(!n||t.allowResize&&!t.allowResize(e.target,e))t.currentElement&&t.unHighlightHandle();else if(t.currentElement=t.handleContainerSelector?Cr.up(e.target,t.handleContainerSelector):e.target,t.currentElement){("horizontal"===t.direction?t.overLeftHandle(e,n)||t.overRightHandle(e,n):t.overTopHandle(e,n)||t.overBottomHandle(e,n))?t.highlightHandle():t.unHighlightHandle()}}},{key:"onMouseLeaveTarget",value:function(e){var t=this;t.currentElement=t.handleContainerSelector?Cr.up(e.target,t.handleContainerSelector):e.target,t.currentElement&&t.unHighlightHandle()}},{key:"updateResize",value:function(e){var t=this,n=t.context;t.allowEdgeSwitch&&("horizontal"===t.direction?n.edge=n.currentX>n.startX?"right":"left":n.edge=n.currentY>n.startY?"bottom":"top");var r=n.currentX-n.startX,i=n.currentY-n.startY,o=Cr.getExtremalSizePX(n.element,"minWidth")||t.minWidth,a=Cr.getExtremalSizePX(n.element,"maxWidth")||t.maxWidth,s=Cr.getExtremalSizePX(n.element,"minHeight")||t.minHeight,u=Cr.getExtremalSizePX(n.element,"maxHeight")||t.maxHeight,c="right"===n.edge||"bottom"===n.edge?1:-1,l=n.elementWidth+r*c,f=n.elementHeight+i*c,d=Math.max(o,l),h=Math.max(s,f);a>0&&(d=Math.min(d,a)),u>0&&(h=Math.min(h,u)),n.element.style.flex&&(n.element.style.flex=""),"horizontal"===t.direction?(n.element.style.width=Math.abs(d)+"px",n.newWidth=d,"left"===n.edge||d<0?(n.newX=Math.max(Math.min(n.elementStartX+n.elementWidth-t.minWidth,n.elementStartX+r),0),t.skipTranslate||Cr.setTranslateX(n.element,n.newX)):"right"===n.edge&&t.allowEdgeSwitch&&!t.skipTranslate&&Cr.setTranslateX(n.element,n.elementStartX)):(n.element.style.height=Math.abs(h)+"px",n.newHeight=h,"top"===n.edge||h<0?(n.newY=Math.max(Math.min(n.elementStartY+n.elementHeight-t.minHeight,n.elementStartY+i),0),t.skipTranslate||Cr.setTranslateY(n.element,n.newY)):"bottom"===n.edge&&t.allowEdgeSwitch&&!t.skipTranslate&&Cr.setTranslateY(n.element,n.elementStartY))}},{key:"finishResize",value:function(e){var t=this,n=t.context,r={context:n,event:e};if(n.element.classList.remove(t.resizingCls),n.started){var i=!1;i="horizontal"===t.direction?n.newWidth&&n.newWidth!==n.elementWidth:n.newHeight&&n.newHeight!==n.elementHeight,t.trigger(i?"resize":"cancel",r),n.async||n.finalize()}else{var o;null===(o=t.reset)||void 0===o||o.call(t)}}},{key:"abortResize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r=n.context;r.element.classList.remove(n.resizingCls),"horizontal"===n.direction?(Cr.setTranslateX(r.element,r.elementStartX),r.element.style.width=r.elementWidth+"px"):(Cr.setTranslateY(r.element,r.elementStartY),r.element.style.height=r.elementHeight+"px"),!t&&n.trigger("cancel",{context:r,event:e}),n.isDestroyed||n.reset()}},{key:"highlightHandle",value:function(){var e=this,t=e.targetSelector?Cr.up(e.currentElement,e.targetSelector):e.currentElement;e.currentElement.classList.add("b-resize-handle"),t.classList.add("b-over-resize-handle")}},{key:"unHighlightHandle",value:function(){var e=this,t=e.targetSelector?Cr.up(e.currentElement,e.targetSelector):e.currentElement;t&&t.classList.remove("b-over-resize-handle"),e.currentElement.classList.remove("b-resize-handle"),e.currentElement=null}},{key:"overAnyHandle",value:function(e,t){return this.overStartHandle(e,t)||this.overEndHandle(e,t)}},{key:"overStartHandle",value:function(e,t){return"horizontal"===this.direction?this.overLeftHandle(e,t):this.overTopHandle(e,t)}},{key:"overEndHandle",value:function(e,t){return"horizontal"===this.direction?this.overRightHandle(e,t):this.overBottomHandle(e,t)}},{key:"getDynamicHandleSize",value:function(e,t){var n=e?2:1,r=this.handleSize;return this.dynamicHandleSize&&r*n>t-this.reservedSpace?Math.max(Math.floor((t-this.reservedSpace)/n),0):r}},{key:"overLeftHandle",value:function(e,t){var n=this,r=t.offsetWidth;if(n.leftHandle&&(r>=n.handleVisibilityThreshold||n.dynamicHandleSize)){var i=En.from(t);return i.width=n.getDynamicHandleSize(n.rightHandle,r),i.width>0&&i.contains(nu.getPagePoint(e))}return!1}},{key:"overRightHandle",value:function(e,t){var n=this,r=t.offsetWidth;if(n.rightHandle&&(r>=n.handleVisibilityThreshold||n.dynamicHandleSize)){var i=En.from(t);return i.x=i.right-n.getDynamicHandleSize(n.leftHandle,r),i.width>0&&i.contains(nu.getPagePoint(e))}return!1}},{key:"overTopHandle",value:function(e,t){var n=this,r=t.offsetHeight;if(n.topHandle&&(r>=n.handleVisibilityThreshold||n.dynamicHandleSize)){var i=En.from(t);return i.height=n.getDynamicHandleSize(n.bottomHandle,r),i.height>0&&i.contains(nu.getPagePoint(e))}return!1}},{key:"overBottomHandle",value:function(e,t){var n=this,r=t.offsetHeight;if(n.bottomHandle&&(r>=n.handleVisibilityThreshold||n.dynamicHandleSize)){var i=En.from(t);return i.y=i.bottom-n.getDynamicHandleSize(n.bottomHandle,r),i.height>0&&i.contains(nu.getPagePoint(e))}return!1}},{key:"scrollLeft",get:function(){return this.scroller?this.scroller.x:this.outerElement.scrollLeft}},{key:"scrollTop",get:function(){return this.scroller?this.scroller.y:this.outerElement.scrollTop}}],[{key:"defaultConfig",get:function(){return{resizingCls:"b-resizing",dragThreshold:5,handleSize:10,dynamicHandleSize:null,reservedSpace:10,touchHandleSize:30,minWidth:1,maxWidth:0,minHeight:1,maxHeight:0,outerElement:document.body,scroller:null,allowResize:null,dragWithin:null,isElementResizable:null,targetSelector:null,leftHandle:!0,rightHandle:!0,topHandle:!0,bottomHandle:!0,handleSelector:null,handleContainerSelector:null,startEvent:null,grab:null,invalidCls:"b-resize-invalid",handleVisibilityThreshold:null,skipTranslate:!1,direction:"horizontal",clickSwallowDuration:50}}}]),n}(Ge(ue));function Du(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Ru(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ru(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Ru(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}Su._$name="ResizeHelper";var xu=null,Eu=[],Tu=function(e){var t;return 1===e.nodeType&&"absolute"===(null===(t=e.ownerDocument.defaultView)||void 0===t?void 0:t.getComputedStyle(e).getPropertyValue("position"))},Mu=function(){function e(){v()(this,e)}return g()(e,null,[{key:"addResizeListener",value:function(e,t){var n=this;if(e!==document&&e!==window||(e=document.body),e.classList.contains("b-resize-monitored")||(e.classList.add("b-resize-monitored"),e._bResizemonitor={handlers:[]}),e===document.body)n.hasWindowResizeListener||(window.addEventListener("resize",n.onWindowResize),n.hasWindowResizeListener=!0);else if(window.ResizeObserver)n.resizeObserver||(n.resizeObserver=new ResizeObserver(n.onElementResize)),n.resizeObserver.observe(e);else{e.classList.add("b-no-resizeobserver");var r=Cr.createElement({parent:e,className:"b-resize-monitors",children:[{className:"b-resize-monitor-expand"},{className:"b-resize-monitor-shrink"}]},!0),i=ye()(r,3),o=i[0],a=i[1],s=i[2];a.scrollLeft=a.scrollTop=s.scrollLeft=s.scrollTop=1e6,a.addEventListener("scroll",n.onSizeMonitorScroll,!0),s.addEventListener("scroll",n.onSizeMonitorScroll,!0),(t.targetMutationMonitor=new MutationObserver((function(e){var t,n=[],r=Du(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;"childList"===i.type&&(n.push.apply(n,i.removedNodes),n.push.apply(n,i.addedNodes))}}catch(e){r.e(e)}finally{r.f()}n.length>0&&n.every(Tu)||(!j.a.isEdge&&!j.a.isIE11||a.classList.contains("b-resize-monitor-expand"))&&a.dispatchEvent(new CustomEvent("scroll",{bubbles:!1}))}))).observe(e,{childList:!0,subtree:!0}),t.monitorElement=o}e._bResizemonitor.handlers.push(t)}},{key:"removeResizeListener",value:function(e,t){if(e){e!==document&&e!==window||(e=document.body);var n=e._bResizemonitor,r=0;n&&n.handlers&&(De.remove(n.handlers,t),r=n.handlers.length),r||(e.classList.remove("b-resize-monitored"),this.resizeObserver?this.resizeObserver.unobserve(e):(t.monitorElement&&(t.monitorElement.remove(),t.monitorElement=null),t.targetMutationMonitor&&t.targetMutationMonitor.disconnect()))}}},{key:"onElementResize",value:function(e){var t,n=Du(e);try{for(n.s();!(t=n.n()).done;){var r=t.value,i=r.target,o=i._bResizemonitor,a=r.contentRect||i.getBoundingClientRect();if(i.offsetParent&&(!o.rectangle||a.width!==o.rectangle.width||a.height!==o.rectangle.height)){var s=o.rectangle;o.rectangle=a;var u,c=Du(o.handlers);try{for(c.s();!(u=c.n()).done;){(0,u.value)(i,s,a)}}catch(e){c.e(e)}finally{c.f()}}}}catch(e){n.e(e)}finally{n.f()}}},{key:"onSizeMonitorScroll",value:function(t){var n;if(null===(n=document.body)||void 0===n?void 0:n.contains(t.target)){t.stopImmediatePropagation();var r=t.target.parentNode,i=r.parentNode,o=i._bResizemonitor,a=i.getBoundingClientRect();o.rectangle&&a.width===o.rectangle.width&&a.height===o.rectangle.height||(Eu.push([i,o.rectangle,a]),o.rectangle=a,xu||(xu=requestAnimationFrame(e.fireResizeEvents))),r.firstChild.scrollLeft=r.firstChild.scrollTop=r.childNodes[1].scrollTop=r.childNodes[1].scrollLeft=1e6}}},{key:"onWindowResize",value:function(e){var t=document.body,n=t._bResizemonitor,r=n.rectangle;n.rectangle=document.documentElement.getBoundingClientRect();var i,o=Du(n.handlers);try{for(o.s();!(i=o.n()).done;){(0,i.value)(t,r,n.rectangle)}}catch(e){o.e(e)}finally{o.f()}}},{key:"fireResizeEvents",value:function(){var e,t=Du(Eu);try{for(t.s();!(e=t.n()).done;){var n,r=e.value,i=Du(r[0]._bResizemonitor.handlers);try{for(i.s();!(n=i.n()).done;){var o=n.value;r[0].offsetParent&&o.apply(this,r)}}catch(e){i.e(e)}finally{i.f()}}}catch(e){t.e(e)}finally{t.f()}xu=null,Eu.length=0}}]),e}();Mu._$name="ResizeMonitor";var Au=/>[ \t\r\n]+</g,Pu=/\s\s+/g,Iu=function(){function e(){v()(this,e)}return g()(e,null,[{key:"tpl",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=0,o=n.map((function(t,n){var r=e[n];return Array.isArray(t)?r+=t.reduce((function(e,t){return e+(("string"==typeof t?t.trim():t)+"\n")}),""):(void 0===t&&(t=""),r+="string"==typeof t?t.trim():t),i++,r})).join("");return i<=e.length&&(o+=e[e.length-1]),o.replace(Au,"><").replace(Pu," ").trim()}},{key:"docsTpl",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=0,o=n.map((function(t,n){var r=e[n];return Array.isArray(t)?r+=t.reduce((function(e,t){return e+(("string"==typeof t?t.trim():t)+"\n")}),""):(void 0===t&&(t=""),r+="string"==typeof t?t.trim():t),i++,r})).join("");return i<=e.length&&(o+=e[e.length-1]),o.replace(Au,"><").trim()}},{key:"repeat",value:function(t){return function(){return e.tpl.apply(e,arguments).repeat(t)}}},{key:"loop",value:function(e){}}]),e}();function Ou(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Iu._$name="TemplateHelper";var Fu={true:"auto",false:"hidden","hidden-scroll":"auto"},Lu={block:"nearest"},ju=Promise.resolve(),_u=function(e){return new Promise((function(t){return nu.on({element:e,scroll:t,once:!0})}))},Bu={x:1},Hu=function(e){fe()(n,e);var t=Ou(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"syncOverflowState",value:function(){var e=this.element,t=e.classList;j.a.isEdge?t[e.scrollWidth-e.clientWidth>1?"add":"remove"]("b-horizontal-overflow"):t[e.scrollWidth>e.clientWidth?"add":"remove"]("b-horizontal-overflow"),t[e.scrollHeight>e.clientHeight?"add":"remove"]("b-vertical-overflow")}},{key:"hasScrollbar",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"y",t=this.element;if(t&&Cr.scrollBarWidth){var n="y"===e,r=n?"Width":"Height",i=t["client".concat(r)],o=parseInt(Cr.getStyleValue(t,"border".concat(n?"Left":"Top","Width")))+parseInt(Cr.getStyleValue(t,"border".concat(n?"Right":"Bottom","Width"))),a=t["offset".concat(r)]-o-i;return Math.abs(a-Cr.scrollBarWidth)<2}}},{key:"addPartner",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Bu;"string"==typeof t&&(t=ke()({},t,1)),(this.partners||(this.partners=new no)).add({id:e.id,scroller:e,axes:t}),e.partners&&e.partners.includes(this.id)||e.addPartner(this,t)}},{key:"removePartner",value:function(e){this.partners&&this.partners.includes(e)&&(this.partners.remove(e),e.removePartner(this))}},{key:"scrollIntoView",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Lu,n=this,r=e instanceof En,i=r?e:En.from(e),o=n.getDeltaTo(e,t),a=o.xDelta,s=o.yDelta,u=n.scrollBy(a,s,t);return(t.highlight||t.focus)&&u.then((function(){r&&(e=i.translate(-a,-s)),t.highlight&&(isNaN(t.highlight)?(n.widget||n).callback(t.highlight,null,[e]):Cr.highlight(e,n)),t.focus&&e.focus()})),u}},{key:"scrollBy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Lu,r=this,i="object"===l()(n)?n.animate:n,o=Math.abs(e),a=Math.abs(t);r.scrollAnimation&&(r.scrollAnimation.cancel(),r.scrollAnimation=null),(e||t)&&(r.silent=n.silent);var s=i&&("number"==typeof i?i:"number"==typeof i.duration?i.duration:300);if(s&&(o>10||a>10)){var u=r.x,c=r.y,f=u,d=c;return Math.max(o,a)<50&&(s=Math.min(s,500)),r.scrollAnimation=xe.animate(s,(function(i){var o=1===i;if(e){if(r.x!==f&&!n.force)return r.scrollAnimation&&r.scrollAnimation.cancel();r.x=Math.max(u+(o?e:Math.round(e*i)),0)}if(t){if(r.y!==d&&!n.force)return r.scrollAnimation&&r.scrollAnimation.cancel();r.y=Math.max(c+(o?t:Math.round(t*i)),0)}f=r.x,d=r.y}),r,i.easing),r.element.classList.add("b-scrolling"),r.scrollAnimation.then((function(){r.isDestroyed||(r.element.classList.remove("b-scrolling"),r.scrollAnimation=null)})),r.scrollAnimation}return e|t?(r.x+=e,r.y+=t,_u(r.element)):ju}},{key:"scrollTo",value:function(e,t,n){var r=this.x,i=this.y,o=null==e?0:e-r,a=null==t?0:t-i;return this.scrollBy(o,a,n)}},{key:"doDestroy",value:function(){var e=this;e._element&&(e._element.removeEventListener("scroll",e.scrollHandler),e.wheelListenerRemover&&e.wheelListenerRemover()),e.scrollAnimation&&e.scrollAnimation.cancel(),e.partners&&e.partners.forEach((function(t){return t.scroller.removePartner(e)})),we()(pe()(n.prototype),"doDestroy",this).call(this)}},{key:"onElMutation",value:function(e){var t=this,n=Cr.getTranslateXY(t.element),r=ye()(n,2),i=r[0],o=r[1];if(t._x!==-i||t.y!==-o){var a=new CustomEvent("scroll",{bubbles:!0});Object.defineProperty(a,"target",{get:function(){return t.element}}),t.onScroll(a)}}},{key:"onScroll",value:function(e){var t=this;t.widget&&t.widget.isDestroyed||(t.positionDirty=!0,t.element.classList.contains("b-scrolling")||t.element.classList.add("b-scrolling"),e.widget=t.widget,t.silent||t.trigger("scroll",e),t.syncPartners(),t.controllingPartner=null,t.scrollEndHandler(e))}},{key:"syncPartners",value:function(){var e=this;e.partners&&e.partners.forEach((function(t){var n=t.axes,r=t.scroller;r!==e.controllingPartner&&r.sync(e,n)}))}},{key:"onScrollEnd",value:function(e){this.silent&&(this.silent=!1),this.trigger("scrollEnd",e),this.controllingPartner=null,this.element.classList.remove("b-scrolling")}},{key:"getDeltaTo",value:function(e,t){var n=this;if(!n.viewport)return{xDelta:0,yDelta:0};var r=e instanceof En?e:En.from(e),i=t.block||"nearest",o=n.viewport,a=t.edgeOffset||0,s=o.width>=r.width+2*a?a:0,u=o.height>=r.height+2*a?a:0,c=r.clone().adjust(-s,-u,s,u).constrainTo(new En(o.x-n.x,o.y-n.y,n.scrollWidth,n.scrollHeight)),l=c.clone(),f=0,d=0;if("start"===i)l.moveTo(o.x,o.y),f=c.x-l.x,d=c.y-l.y;else if("end"===i)l.translate(o.right-l.right,o.bottom-l.bottom),f=c.x-l.x,d=c.y-l.y;else if("center"===i){var h=o.center;l.moveTo(h.x-l.width/2,h.y-l.height/2),f=f||c.x-l.x,d=d||c.y-l.y}else l.width>o.width?f=l.x-o.x:l.right>o.right?f=l.right-o.right:l.x<o.x&&(f=l.x-o.x),l.height>o.height?d=l.y-o.y:l.bottom>o.bottom?d=l.bottom-o.bottom:l.y<o.y&&(d=l.y-o.y);return{xDelta:!1===t.x?0:Math.round(Math.max(Math.min(f,n.maxX-n.x),-n.x)),yDelta:!1===t.y?0:Math.round(Math.max(Math.min(d,n.maxY-n.y),-n.y))}}},{key:"updateElement",value:function(e,t){var n=this,r=n.scrollHandler||(n.scrollHandler=n.onScroll.bind(n));if(n.scrollEndHandler||(n.scrollEndHandler=n.buffer(n.onScrollEnd,n.scrollEndBuffer)),t&&(n.translate?n.mutationObserver&&n.mutationObserver.disconnect(t):(t.removeEventListener("scroll",r),t.classList.remove("b-widget-scroller"))),n.translate){if(n.mutationObserver||(n.mutationObserver=new MutationObserver((function(e){return n.onElMutation(e)}))),n.mutationObserver.observe(e,{attributes:!0}),n._x=n._y=0,document.contains(e)){var i=Cr.getTranslateXY(e),o=ye()(i,2),a=o[0],s=o[1];n._x=-a,n._y=-s}}else e.addEventListener("scroll",r),e.classList.add("b-widget-scroller");n.positionDirty&&(n.updateOverflowX(n.overflowX),n.updateOverflowY(n.overflowY)),n.isConfiguring&&(n._x&&n.updateX(n._x),n._y&&n.updateY(n._y)),n.positionDirty=!0}},{key:"changeX",value:function(e){if(!this.isConfiguring||e)return e;this._x=e}},{key:"updateX",value:function(e){var t=this.element,n=this.widget;t&&!(null==n?void 0:n.isConfiguring)&&(this.trigger("scrollStart",{x:e}),this.translate?Cr.setTranslateX(t,-e):t.scrollLeft=e),this.positionDirty=!0}},{key:"sync",value:function(e,t){var n=t.x,r=t.y;null!=n&&this.x!==e.x&&(this.controllingPartner=e,this.x=e.x),null!=r&&this.y!==e.y&&(this.controllingPartner=e,this.y=e.y)}},{key:"changeY",value:function(e){if(!this.isConfiguring||e)return e;this._y=e}},{key:"updateY",value:function(e){var t=this.element,n=this.widget;t&&!(null==n?void 0:n.isConfiguring)&&(this.trigger("scrollStart",{y:e}),this.translate?Cr.setTranslateY(t,-e):t.scrollTop=e),this.positionDirty=!0}},{key:"updateOverflowX",value:function(e){var t=this.element,n=this.translate;t&&("hidden-scroll"!==e||n||(t.classList.add("b-hide-scroll"),this.enableWheel()),n||(t.style.overflowX=Fu[e]||e)),this.positionDirty=!this.isConfiguring}},{key:"updateOverflowY",value:function(e){var t=this.element,n=this.translate;t&&("hidden-scroll"!==e||n||(t.classList.add("b-hide-scroll"),this.enableWheel()),n||(t.style.overflowY=Fu[e]||e)),this.positionDirty=!this.isConfiguring}},{key:"enableWheel",value:function(){j.a.isChrome||j.a.isSafari||this.wheelListenerRemover||(this.wheelListenerRemover=nu.on({element:this.element,wheel:"onWheel",thisObj:this}))}},{key:"onWheel",value:function(e){Math.abs(e.deltaX)>Math.abs(e.deltaY)&&!1!==this.overflowX?(this.x+=e.deltaX,e.stopPropagation()):!1!==this.overflowY&&(this.y+=e.deltaY,e.stopPropagation())}},{key:"viewport",get:function(){return En.client(this.element)}},{key:"x",get:function(){var e=this,t=e.element;if(t&&e.positionDirty){if(e.translate){var n=Cr.getTranslateXY(t),r=ye()(n,2),i=r[0],o=r[1];e._x=-i,e._y=-o}else e._x=t.scrollLeft,e._y=t.scrollTop;e.positionDirty=!1}return e._x}},{key:"y",get:function(){var e=this,t=e.element;if(t&&e.positionDirty){if(e.translate){var n=Cr.getTranslateXY(t),r=ye()(n,2),i=r[0],o=r[1];e._x=-i,e._y=-o}else e._x=t.scrollLeft,e._y=t.scrollTop;e.positionDirty=!1}return e._y}},{key:"maxX",get:function(){return this.scrollWidth-this.clientWidth}},{key:"maxY",get:function(){return this.scrollHeight-this.clientHeight}},{key:"scrollWidth",get:function(){return this.element?this.element.scrollWidth:0},set:function(e){var t=this,n=t.widthStretcher;n&&null==e?(n.remove(),t.widthStretcher=null):e&&(n||(n=t.widthStretcher=Cr.createElement({className:"b-scroller-stretcher"})),n.style.transform="translateX(".concat(e-1,"px)"),t.element&&t.element.lastChild!==n&&t.element.appendChild(n)),t.syncOverflowState()}},{key:"scrollHeight",get:function(){return this.element?this.element.scrollHeight:0},set:function(e){var t=this,n=t.stretcher||(t.stretcher=Cr.createElement({className:"b-scroller-stretcher"}));n.style.transform="translateY(".concat(e-1,"px)"),t.element&&t.element.lastChild!==n&&t.element.appendChild(n)}},{key:"clientWidth",get:function(){return this.element?this.element.clientWidth:0}},{key:"clientHeight",get:function(){return this.element?this.element.clientHeight:0}},{key:"id",get:function(){return this._id||(this.widget?this._id="".concat(this.widget.id,"-scroller"):this._id=zi.generateId("scroller-")),this._id}}],[{key:"configurable",get:function(){return{widget:null,element:null,overflowX:null,overflowY:null,translate:null,x:0,y:0,scrollEndBuffer:100}}}]),n}(_a(Ge(ue)));Hu._$name="Scroller";var $u={localeName:"En",localeDesc:"English",Object:{Yes:"Yes",No:"No",Cancel:"Cancel"},Combo:{noResults:"No results"},FilePicker:{file:"File"},Field:{badInput:"Invalid field value",patternMismatch:"Value should match a specific pattern",rangeOverflow:function(e){return"Value must be less than or equal to ".concat(e.max)},rangeUnderflow:function(e){return"Value must be greater than or equal to ".concat(e.min)},stepMismatch:"Value should fit the step",tooLong:"Value should be shorter",tooShort:"Value should be longer",typeMismatch:"Value is required to be in a special format",valueMissing:"This field is required",invalidValue:"Invalid field value",minimumValueViolation:"Minimum value violation",maximumValueViolation:"Maximum value violation",fieldRequired:"This field is required",validateFilter:"Value must be selected from the list"},DateField:{invalidDate:"Invalid date input"},NumberFormat:{locale:"en-US",currency:"USD"},TimeField:{invalidTime:"Invalid time input"},List:{loading:"Loading..."},PagingToolbar:{firstPage:"Go to first page",prevPage:"Go to previous page",page:"Page",nextPage:"Go to next page",lastPage:"Go to last page",reload:"Reload current page",noRecords:"No records to display",pageCountTemplate:function(e){return"of ".concat(e.lastPage)},summaryTemplate:function(e){return"Displaying records ".concat(e.start," - ").concat(e.end," of ").concat(e.allCount)}},DateHelper:{locale:"en-US",weekStartDay:0,unitNames:[{single:"millisecond",plural:"ms",abbrev:"ms"},{single:"second",plural:"seconds",abbrev:"s"},{single:"minute",plural:"minutes",abbrev:"min"},{single:"hour",plural:"hours",abbrev:"h"},{single:"day",plural:"days",abbrev:"d"},{single:"week",plural:"weeks",abbrev:"w"},{single:"month",plural:"months",abbrev:"mon"},{single:"quarter",plural:"quarters",abbrev:"q"},{single:"year",plural:"years",abbrev:"yr"}],unitAbbreviations:[["mil"],["s","sec"],["m","min"],["h","hr"],["d"],["w","wk"],["mo","mon","mnt"],["q","quar","qrt"],["y","yr"]],parsers:{L:"MM/DD/YYYY",LT:"HH:mm A"},ordinalSuffix:function(e){return e+({1:"st",2:"nd",3:"rd"}[e[e.length-1]]||"th")}}},Nu=$u;rt.registerLocale("En",{desc:"English",locale:$u});var Vu=function e(t){var n=this;v()(this,e),this.promise=new Promise((function(e,t){n.resolve=e,n.reject=t})),t&&t(this)};function zu(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Wu(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Wu(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Wu(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Gu(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Vu._$name="Promissory";var Yu=Reflect.defineProperty,Uu=function(e){fe()(n,e);var t=Gu(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(){var e;this.$iid=++n.$idSeed,this.byRef={};for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];(e=we()(pe()(n.prototype),"construct",this)).call.apply(e,[this].concat(r)),this.onDraw!==n.prototype.onDraw&&this.initDrawable()}},{key:"startConfigure",value:function(e){this.element=this.renderContext.renderDom(),we()(pe()(n.prototype),"startConfigure",this).call(this,e)}},{key:"changeElement",value:function(e,t){return t&&t.remove(),e&&(e.id=this.id,e=Cr.createElement(e,{refOwner:this})),e}},{key:"updateId",value:function(e,t){if(t){var n=this.element;n.id=e,this.fixRefOwnerId(n,e,t)}}},{key:"fixRefOwnerId",value:function(e,t,n){if(e.$refOwnerId===n){e.$refOwnerId=t;var r=e.$reference;r&&(e.id="".concat(t,"-").concat(r));var i,o=zu(e.childNodes);try{for(o.s();!(i=o.n()).done;){var a=i.value;this.fixRefOwnerId(a,t,n)}}catch(e){o.e(e)}finally{o.f()}}}},{key:"onConfigChange",value:function(e){var t=e.name;!this.isConfiguring&&this.$renderConfigs.has(t)&&this.refreshDom()}},{key:"attachRef",value:function(e,t,n){var r=this,i="_"+e,o=n.listeners;i in r||Yu(r,e,{get:function(){return r.refreshDom.flush(),r[i]},set:function(e){r[i]=e}}),t.id="".concat(r.id,"-").concat(e),r[e]=t,o&&(n.listeners={on:o,un:nu.on(Object.assign({element:t,thisObj:r},o))})}},{key:"detachRef",value:function(e,t,n){n.listeners&&(n.listeners.un(),n.listeners=null),this[e]=null}},{key:"renderDom",value:function(){return{}}},{key:"refreshDom",value:function(){Gs.sync({targetElement:this.element,domConfig:this.renderContext.renderDom(),refOwner:this,strict:!0})}},{key:"onListen",value:function(e){"draw"===e&&this.initDrawable()}},{key:"initDrawable",value:function(){var e=this;if(!e.intersector){var t=Object.values(e.byRef).find((function(e){return e.classList.contains("b-drawable")}));t||(t=e.element).classList.add("b-drawable"),e.intersector=!0,nu.on({element:Cr.createElement({parent:t,class:"b-drawable-el"}),animationend:function(t){"b-drawable-anim"===t.animationName&&e.onDraw({count:++e.drawCounter})}})}}},{key:"onDraw",value:function(e){this.trigger("draw",e)}},{key:"element",get:function(){return this.refreshDom.flush(),this._element}},{key:"classes",get:function(){return this.element.classList}},{key:"renderContext",get:function(){var e=this,t=e.$meta,n=e.constructor,r=t.renderConfigs||n.renderConfigs,i=e;if(!r){i=Object.create(e),r=new Set;var o=function(t){Yu(i,t,{get:function(){return r.add(t),e[t]}})};for(var a in t.configs)o(a);i.renderDom=function(){return e.renderDom.call(i)},e.$renderConfigs=r}return Yu(e,"renderContext",{value:i}),i}}],[{key:"configurable",get:function(){return{element:null}}},{key:"delayable",get:function(){return{refreshDom:"raf"}}},{key:"identifiable",get:function(){return{}}},{key:"renderConfigs",get:function(){var e,t,n=this.$meta,r=n.renderConfigs;if(void 0===r){for(t in r=null,e=n.configs)e[t].render&&(r||(r=new Set)).add(t);n.renderConfigs=this.prototype.$renderConfigs=r}return r}}]),n}(ue.mixin(lt,Ge,_a,ni));function qu(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Uu.$idSeed=0,Object.assign(Uu.prototype,{drawCounter:0,hasGeneratedId:!1,intersector:null}),Uu._$name="Renderable";var Ku=function(e){fe()(n,e);var t=qu(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e){if(e){var t,r=e.element;r&&(y.a.deprecate("Core","4.0.0",'Mask "element" config has been renamed to "target"'),e=t=Object.assign({},e),delete t.element,t.target=r),"string"==typeof(r=e.target)&&(e=t=t||Object.assign({},e),t.target=e.owner[r])}we()(pe()(n.prototype),"construct",this).call(this,e),this.target||(this.target=document.body),this.show()}},{key:"doDestroy",value:function(){var e=this,t=e.element;t&&(e.element=null,e.mode.endsWith("blur")&&Cr.forEachChild(t,(function(t){t.classList.remove("b-masked-".concat(e.mode))})),e.target.classList.remove("b-masked"),e.target[e.maskName]=null),we()(pe()(n.prototype),"doDestroy",this).call(this)}},{key:"renderDom",value:function(){var e,t=this,n=t.maxProgress;return{class:(e={"b-mask":1,"b-delayed-show":t.showDelay,"b-widget":1},ke()(e,"b-mask-".concat(t.mode),1),ke()(e,"b-progress",n),ke()(e,"b-prevent-transitions",!t.useTransition),e),children:[{reference:"maskContent",class:"b-mask-content b-drawable",children:[n?{reference:"progressElement",class:"b-mask-progress-bar",style:{width:"".concat(Math.max(0,Math.min(100,Math.round(t.progress/n*100))),"%")}}:null,{reference:"maskText",class:"b-mask-text",html:(t.icon?'<i class="b-mask-icon '.concat(t.icon,'"></i>'):"")+t.text}]}]}}},{key:"updateAutoClose",value:function(e){this.deferredClose.cancel(),e&&(this.deferredClose.delay=e,this.deferredClose())}},{key:"updateCover",value:function(){var e=this.owner;e&&e.syncMaskCover&&e.syncMaskCover(this)}},{key:"updateShowDelay",value:function(e){var t=this.delayedShow;t.delay=e,e||t.flush()}},{key:"deferredClose",value:function(){var e=this,t=this.owner;this.close().then((function(){t&&t.onMaskAutoClose&&t.onMaskAutoClose(e)})),t&&t.onMaskAutoClosing&&t.onMaskAutoClosing(this)}},{key:"delayedShow",value:function(){this.classes.remove("b-delayed-show")}},{key:"show",value:function(){var e=this,t=e.element,n=e.target,r=e.hiding,i=e.maskName;r&&(r.resolve(),e.hiding=null,e.clearTimeout("hide")),e.showDelay&&(t.classList.add("b-delayed-show"),e.delayedShow()),t.classList.add("b-visible"),t.classList.remove("b-hidden"),n.classList.add("b-masked"),n[i]||(n[i]=e,n.appendChild(t)),e.shown=!0,e.mode.endsWith("blur")&&Cr.forEachChild(n,(function(n){n!==t&&n.classList.add("b-masked-".concat(e.mode))}))}},{key:"hide",value:function(){var e=this,t=e.target,n=e.element,r=e.hiding;if(!r){if(!e.shown)return Promise.resolve();e.hiding=r=new Vu,e.shown=!1,n.classList.remove("b-visible"),n.classList.add("b-hidden"),t.classList.remove("b-masked"),e.mode.endsWith("blur")&&Cr.forEachChild(t,(function(t){t!==n&&t.classList.remove("b-masked-".concat(e.mode))})),r.promise=r.promise.then((function(){e.hiding===r&&(e.hiding=null)})),e.setTimeout((function(){return r.resolve()}),500,"hide")}return r.promise}},{key:"close",value:function(){var e=this;return this.hide().then((function(){e.destroy()}))}},{key:"maskElement",get:function(){return this.element}},{key:"maskName",get:function(){var e=this.type;return"mask".concat("string"==typeof e?e.trim():"")}},{key:"error",set:function(e){this.setConfig(this.errorDefaults),this.text=e}}],[{key:"mergeConfigs",value:function(){for(var e={},t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,o=n;i<o.length;i++){var a=o[i];"string"==typeof a?e.text=a:an.assign(e,a)}return e}},{key:"mask",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:document.body;return new n("string"!=typeof e?Object.assign({target:t},e):{target:t,text:e})}},{key:"unmask",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:document.body;return e.mask&&e.mask.close()}},{key:"$name",get:function(){return"Mask"}},{key:"type",get:function(){return"mask"}},{key:"configurable",get:function(){return{autoClose:null,cover:null,icon:"b-icon b-icon-spinner",errorDefaults:{icon:"b-icon b-icon-warning",autoClose:3e3,showDelay:0},maxProgress:null,mode:"dark",progress:null,owner:null,target:null,text:null,type:null,showDelay:null,useTransition:!1}}},{key:"delayable",get:function(){return{deferredClose:0,delayedShow:0}}}]),n}(Uu);function Xu(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Ku._$name="Mask";var Zu=/transparent|rgba\(0,\s*0,\s*0,\s*0\)/,Ju={INPUT:1,TEXTAREA:1},Qu=function(e,t){return e&&t&&t[an.keys(e)[0]]?Y.merge(e,t):e},ec=function(e){e.isVisible&&e.triggerPaint()},tc=/^:not\((.+)\)$/,nc=function(e){return null!=e.scale},rc=Object.prototype.hasOwnProperty,ic=function(e){return parseFloat(e)*(e.endsWith("ms")?1:1e3)},oc=function(e){fe()(n,e);var t=Xu(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this;t.alignConstrained=0,t.byRef=Object.create(null),t.callRealign=t.realign.bind(t),t.doHideOrRealign=t.doHideOrRealign.bind(t),t.initialRender=!0,t._isUserAction=!1;for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];we()(pe()(n.prototype),"construct",this).call(this,e,i),t.finalizeInit()}},{key:"isType",value:function(e,t){return n.isType(this,e,t)}},{key:"startConfigure",value:function(e){var t=this,r=t.adopt,i=t.element;if(r){var o="string"==typeof r?document.getElementById(r):r,a=n.fromElement(o);if(a&&a.adopt&&a!==t)("string"==typeof a.adopt?document.getElementById(a.adopt):a.adopt)===o&&a.destroy();t.preExistingElements=Array.from(o.childNodes),t.adoptedElementClassName=o.className,t.adoptedElementCssText=o.style.cssText,o.id&&!e.id&&(t.id=i.id=o.id),Cr.syncAttributes(i,o);for(var s=0,u=i.childNodes.length;s<u;s++)o.appendChild(i.childNodes[0]);t._element=o,delete t._contentRange}t.scaleToFitWidth||t.getConfig("monitorResize"),we()(pe()(n.prototype),"startConfigure",this).call(this,e)}},{key:"updateTitle",value:function(e){this.titleElement&&(this.titleElement.innerHTML=e)}},{key:"attachRef",value:function(e,t,n){var r=n&&n.listeners;this[e]=this.byRef[e]=t,t.dataset&&(t.dataset.ownerCmp=this.id),r&&(n.listeners={on:r,un:nu.on(Object.assign({element:t,thisObj:this},r))})}},{key:"detachRef",value:function(e,t,n){n.listeners&&(n.listeners.un(),n.listeners=null),this[e]=null,delete this.byRef[e]}},{key:"changeElement",value:function(e){var t,r,i=this;"string"==typeof e?e=Cr.createElementFromTemplate(e):an.isObject(e)?e=Cr.createElement(e,{refOwner:i}):1!==e.nodeType&&(e=Cr.createElementFromTemplate(i.template(i))),i._element=e;var o=e.classList;e.id=i.id,e.className+=" "+i.widgetClassList.join(" "),i.contentElementCls&&(i.contentElement.className+=" "+i.contentElementCls),i._hidden&&o.add("b-hidden"),i._readOnly&&o.add("b-readonly"),i.parent||(o.add("b-outer"),Cr.addClasses(e,n.outerCls));var a=e.querySelectorAll("[data-reference]");for(r=0;r<a.length;++r)t=a[r],i.attachRef(t.getAttribute("data-reference"),t),t.removeAttribute("data-reference");return e}},{key:"updateCentered",value:function(e){var t=this.element;if(e&&!this.floating&&!this.positioned)throw new Error("`centered` is only relevant when a Widget is `floating` or `positioned`");e?(t.classList.add("b-centered"),t.style.transform=t.style.left=t.style.top=""):t.classList.remove("b-centered")}},{key:"updateId",value:function(e,t){if(t){for(var n=this.element,r=n.querySelectorAll('[data-owner-cmp="'.concat(t,'"]')),i=0,o=r.length;i<o;i++)r[i].dataset.ownerCmp=e;n.id=e}}},{key:"updateStyle",value:function(e){this.element&&Cr.applyStyle(this.element,e)}},{key:"changeDataset",value:function(e){Object.assign(this.dataset,e)}},{key:"finalizeInit",value:function(){(this.insertBefore||this.appendTo||this.insertFirst||this.adopt)&&this.render()}},{key:"doDestroy",value:function(){var e=this,t=e.tooltip,r=e.preExistingElements,i=e.element;if(e.scrollable&&e.scrollable.destroy(),t&&(e._tooltip?t.destroy():t.hide()),e.unmask(),i){var o,a;if(e.clearTimeout(e.scrollListenerTimeout),e.clearTimeout(e.resizeListenerTimeout),e.removeTransientListeners(),e.floating||e.positioned?e.hide():e.revertFocus(),Mu.removeResizeListener(i.parentElement,e.onParentElementResize),Mu.removeResizeListener(i,e.onElementResize),e.adopt){for(var s=Array.from(i.childNodes),u=0,c=s.length;u<c;u++){var l=s[u];r.includes(l)||l===n.floatRoot||l.remove()}i.className=e.adoptedElementClassName,i.style.cssText=e.adoptedElementCssText}else i.remove();null===(o=e.dragEventDetacher)||void 0===o||o.call(e),null===(a=e.dragOverEventDetacher)||void 0===a||a.call(e),e.dragGhost.remove()}we()(pe()(n.prototype),"doDestroy",this).call(this)}},{key:"render",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this,r=n.element;n.emptyCache(),n.syncElement&&n.currentElement?Cr.sync(r,n.currentElement):(e?(n.appendTo="string"==typeof e?document.getElementById(e):e,n.appendTo.appendChild(r)):n.insertBefore?(n.insertBefore="string"==typeof n.insertBefore?document.getElementById(n.insertBefore):n.insertBefore,n.insertBefore.parentElement.insertBefore(r,n.insertBefore)):n.insertFirst?(n.insertFirst="string"==typeof n.insertFirst?document.getElementById(n.insertFirst):n.insertFirst,n.insertFirst.firstChild?n.insertFirst.insertBefore(r,n.insertFirst.firstChild):n.insertFirst.appendChild(r)):n.appendTo&&(n.appendTo="string"==typeof n.appendTo?document.getElementById(n.appendTo):n.appendTo,n.appendTo.appendChild(r)),n.currentElement=r),n.rendered=!0,t&&(n.getConfig("contentRange"),n.triggerPaint())}},{key:"template",value:function(e){return"<".concat(e.tag,' class="').concat(e.html?e.htmlCls:"",'" ').concat(e.name?'data-name="'.concat(e.name,'"'):"",">").concat(e.html||"","</").concat(e.tag,">")}},{key:"alignTo",value:function(e){(1===e.nodeType||e instanceof n||"Point"===e.$$name)&&(e={target:e}),this.releaseSizeConstraints();var t=this,r=t.scrollable,i=t.element,o=t.constrainTo,a=t.scale||1,s=e.target,u=s&&(s instanceof En?s:s.element||s),c=En.from(i,t.positioned?i.offsetParent:null,!0),l=u&&1===u.nodeType,f=(e=an.assign({constrainTo:o,align:"b-t",axisLock:t.axisLock,anchor:t.anchor},t.align,e)).minWidth||t.minWidth,d=e.minHeight||t.minHeight;if(c.isAlignRectangle=!0,f&&(c.minWidth=f*a),d&&(c.minHeight=d*a),t.lastAlignSpec=e,l&&u.offsetParent){(e=Object.setPrototypeOf({},e)).target=En.from(u,t.positioned?i.offsetParent:null,!t.positioned),e.target.height=Math.max(e.target.height,1),e.target.width=Math.max(e.target.width,1);var h=t.clippedBy;if(h){var v=e.target.intersect(h);if(!v){var p=t.hide();return t.lastAlignSpec.targetHidden=!0,p}e.target=v}t.anchoredTo=u}else t.anchoredTo=null;if(e.anchor&&(e.anchorSize=t.anchorSize,i.appendChild(t.anchorElement)),o&&!o.isRectangle&&t.positioned){var g=o===document||o===window;e.constrainTo=En.from(g?document.body:e.constrainTo,i.offsetParent)}t.isAligning=!0,t.trigger("beforeAlign",e),t.isAligning=!1;var y=c.alignTo(e),m=y.align,k=y.anchor,b=y.x,w=y.y,C=y.width,S=y.height,D=y.bottom,R=y.right;if(t.lastAlignSpec.zone=y.zone,S!==c.height&&("configuredHeight"in t||(t.configuredHeight=i.style.height),t.height=S/a,t.alignConstrained=1|t.alignConstrained,r&&(r.overflowY=!0)),C!==c.width&&("configuredWidth"in t||(t.configuredWidth=i.style.width),t.width=C/a,t.alignConstrained=2|t.alignConstrained,r&&(r.overflowX=r.clientWidth>r.scrollWidth)),m&&t.alignConstrained){e.align=m;var x=En.from(i,t.positioned?i.offsetParent:null,!0).alignTo(e);k=x.anchor,b=x.x,w=x.y,C=x.width,S=x.height,D=x.bottom,R=x.right}if(t.setXY(b,w),k){var E=k.edge,T=t.anchorElement,M=En.from(i,null,!0),A=[],P=i.style.pointerEvents;i.style.pointerEvents="all","top"===E||"bottom"===E?(A[0]=M.x+k.x,A[1]="top"===E?M.y+1:D-1):(A[0]="left"===E?M.x+1:R-1,A[1]=M.y+k.y);var I=Cr.elementFromPoint.apply(Cr,A);if(i.style.pointerEvents=P||null,I){var O=Cr.getStyleValue(I,"background-color");O.match(Zu)?t.anchorPathElement.setAttribute("fill",t.defaultAnchorBackgroundColor):t.anchorPathElement.setAttribute("fill",O)}T.classList.remove("b-hide-display"),T.style.transform="",T.className="b-anchor b-anchor-".concat(E),k.x&&(k.x/=a),k.y&&(k.y/=a),Cr.setTranslateXY(T,k.x,k.y),i.classList.add("b-anchored")}else t._anchorElement&&(t.anchorElement.classList.add("b-hide-display"),i.classList.remove("b-anchored"));"hide"!==t.scrollAction||l||(i.style.pointerEvents="none",t.anchoredTo=Cr.elementFromPoint(b,w),i.style.pointerEvents=""),("realign"===t.scrollAction&&l||"hide"===t.scrollAction)&&!t.documentScrollListener&&(t.clearTimeout(t.scrollListenerTimeout),t.scrollListenerTimeout=t.setTimeout((function(){t.documentScrollListener=!0,document.addEventListener("scroll",t.doHideOrRealign,!0)}),"hide"===t.scrollAction?t.ignoreScrollDuration:0)),l&&e.monitorResize&&!t.targetResizeListener&&(Mu.addResizeListener(u,t.callRealign),t.targetResizeListener=!0),j.a.isAndroid||t.constrainListeners||o instanceof En||(t.clearTimeout(t.resizeListenerTimeout),t.resizeListenerTimeout=t.setTimeout((function(){t.constrainListeners=!0,Mu.addResizeListener(o||window,t.callRealign)}),t.ignoreScrollDuration))}},{key:"realign",value:function(e){var t=this;if(t.isVisible&&(t.floating||t.positioned)&&t.lastAlignSpec){var r=t.lastAlignSpec.target;if(r&&1===r.nodeType){if(j.a.isIE11&&!br(r))return t.hide();var i=n.fromElement(r),o=En.from(r),a=(!i||i.isVisible)&&Cr.isVisible(r);if(o.minHeight=o.minWidth=1,r!==document.body&&!a||e&&1===e.nodeType&&e.contains(r)&&!En.from(e).intersect(o))return t.hide()}t.alignTo(t.lastAlignSpec)}}},{key:"releaseSizeConstraints",value:function(){var e=this,t=e.scrollable;1&e.alignConstrained&&(e.height=e.configuredHeight,t&&(t.overflowY=t.config.overflowY)),2&e.alignConstrained&&(e.width=e.configuredWidth,t&&(t.overflowX=t.config.overflowX)),e.alignConstrained=0}},{key:"toFront",value:function(){var e=this.element,t=this.floating?n.floatRoot:this.positioned?null==e?void 0:e.parentNode:null;if(e&&e.nextSibling){var r=this._toFrontRange||(this._toFrontRange=document.createRange());r.setStartBefore(e.nextSibling),r.setEndAfter(t.lastElementChild),t.insertBefore(r.extractContents(),e)}}},{key:"updateRef",value:function(e){this.element.dataset.ref=e}},{key:"changeAlign",value:function(e){return"string"==typeof e?{align:e}:e}},{key:"changeScrollable",value:function(e,t){var n;return"boolean"==typeof e&&(e={overflowX:e,overflowY:e}),e.element=this.overflowElement,e.widget=this,t?!e||e.isScroller?t.destroy():(t.setConfig(e),e=t):e=new this.scrollerClass(e),null===(n=e)||void 0===n||n.syncOverflowState(),e}},{key:"updateHtml",value:function(e){var t=this,n=null==e,r=t.element,i=t.contentElement,o=t.htmlCls;if(r){var a=i===r&&t._anchorElement;o&&r.classList[n?"remove":"add"](o),a&&t.element.removeChild(a),e&&"object"===l()(e)?Gs.sync({domConfig:e,targetElement:t.contentElement,onlyChildren:!0}):t.contentElement.innerHTML=n?"":e,a&&r.appendChild(a),(t.floating||t.positioned)&&(t.isAligning||t.realign())}}},{key:"updateContent",value:function(e){var t=this,n=null==e,r=t.element,i=t.htmlCls;if(r){var o=t.contentRange;i&&r.classList[n?"remove":"add"](i),br(r)?(o.deleteContents(),n||o.insertNode(Cr.createElementFromTemplate(e,{fragment:!0}))):t.contentElement.innerHTML=e,t.contentRangeStartOffset=o.startOffset,t.contentRangeEndOffset=o.endOffset,!t.floating&&!t.positioned||t.isAligning||t.realign()}}},{key:"onThemeChange",value:function(){var e;(null===(e=this.anchorElement)||void 0===e?void 0:e.offsetParent)&&(this._anchorSize=null,this.realign())}},{key:"updateAnchor",value:function(e){this._anchorElement&&this._anchorElement.classList[e?"remove":"add"]("b-hide-display")}},{key:"updateDraggable",value:function(e){var t,n,r,i=this,o=i.element;(j.a.isFirefox||o.setAttribute("draggable",Boolean(e)),e)?(i.dragEventDetacher=nu.addListener({element:o,dragstart:"onWidgetDragStart",dragend:"onWidgetDragEnd",thisObj:i}),j.a.isFirefox&&(i.ffDragDetacher=nu.on({element:o,mousedown:function(e){Cr.up(e.target,".b-field-inner")||o.setAttribute("draggable","true")},thisObj:i}))):(null===(t=i.dragEventDetacher)||void 0===t||t.call(i),null===(n=i.dragOverEventDetacher)||void 0===n||n.call(i),null===(r=i.ffDragDetacher)||void 0===r||r.call(i))}},{key:"onWidgetDragStart",value:function(e){var t=this,n=t.element,r=Cr.elementFromPoint(e.clientX,e.clientY),i=t.draggable.handleSelector;if(i){var o=tc.exec(i)[1];if(o){if(r.closest("#".concat(n.id," ").concat(o)))return void e.preventDefault()}else if(!r.closest("#".concat(n.id," ").concat(i)))return void e.preventDefault()}t.removeTransientListeners();var a=e.clientX,s=e.clientY,u=document.scrollingElement||document.body,c=t.getXY()[0],l=t.getXY()[1];document.body.appendChild(t.dragGhost),t.setDragImage(e),e.dataTransfer.effectAllowed="none",t.dragOverEventDetacher=nu.addListener({element:document.body,dragover:function(e){n.classList.remove("b-centered"),Cr.setTranslateXY(n,c+e.clientX-a-u.scrollLeft,l+e.clientY-s-u.scrollTop)}}),t.anchor=null}},{key:"setDragImage",value:function(e){e.dataTransfer.setDragImage&&(e.dataTransfer.setData("application/node type",""),e.dataTransfer.setDragImage(this.dragGhost,0,0))}},{key:"onWidgetDragEnd",value:function(){this.dragGhost.remove(),this.dragOverEventDetacher(),j.a.isFirefox&&this.element.removeAttribute("draggable")}},{key:"changeFloating",value:function(e){return Boolean(e)}},{key:"changePositioned",value:function(e){return Boolean(e)}},{key:"updatePositioned",value:function(e){this.element.classList[e?"add":"remove"]("b-positioned")}},{key:"getXY",value:function(){return[Cr.getPageX(this.element),Cr.getPageY(this.element)]}},{key:"setXY",value:function(e,t){var n=this;(n.floating||n.positioned)&&(null!=e&&(n._x=e,n.centered=!1),null!=t&&(n._y=t,n.centered=!1),Cr.setTranslateXY(n.element,n._x||0,n._y||0))}},{key:"changeX",value:function(e){this.setXY(e)}},{key:"changeY",value:function(e){this.setXY(null,e)}},{key:"changeWidth",value:function(e){Cr.setLength(this.element,"width",e),this._width=null,this._flex=null,this.element.style.flex=""}},{key:"updateMaxWidth",value:function(e){Cr.setLength(this.element,"maxWidth",e)}},{key:"updateMinWidth",value:function(e){Cr.setLength(this.element,"minWidth",e)}},{key:"updateFlex",value:function(e){"number"!=typeof e&&isNaN(e)||(e="".concat(e," ").concat(e)),this.element.style.flex=e,this.element.style.width=j.a.isIE11?"":null}},{key:"updateAlignSelf",value:function(e){this.element.style.alignSelf=e}},{key:"updateMargin",value:function(e){this.element.style.margin=this.parseTRBL(e).join(" ")}},{key:"updateTextAlign",value:function(e,t){t&&this.element.classList.remove("b-text-align-".concat(t)),this.element.classList.add("b-text-align-".concat(e))}},{key:"changeHeight",value:function(e){Cr.setLength(this.element,"height",e),this._height=null}},{key:"updateMaxHeight",value:function(e){var t=this,n=t.element;Cr.setLength(t.maxHeightElement,"maxHeight",e),j.a.isIE11&&t.contentElement!==n&&(null==e?Mu.removeResizeListener(n,t.boundMaxHeightBugHandler):(Mu.addResizeListener(n,t.boundMaxHeightBugHandler||(t.boundMaxHeightBugHandler=t.fixIEMaxHeightBug.bind(t))),document.body.contains(n)&&t.fixIEMaxHeightBug()))}},{key:"fixIEMaxHeightBug",value:function(){var e=this.element,t=this.contentElement;if("column"===Cr.getStyleValue(e,"flex-direction")){t.style.maxHeight="";for(var n=En.client(e).height,r=e.childNodes,i=r.length,o=0;o<i;o++){var a=r[o];a===t||a.classList.contains("b-resize-monitors")||(n-=a.offsetHeight)}this.contentElement.style.maxHeight="".concat(n,"px")}}},{key:"updateMinHeight",value:function(e){Cr.setLength(this.element,"minHeight",e)}},{key:"updateDisabled",value:function(e){var t=this.element,n=this.focusElement;e&&this.revertFocus(),t&&(t.classList[e?"add":"remove"]("b-disabled"),n&&(n.disabled=e)),this.onDisabled(e)}},{key:"onDisabled",value:function(e){}},{key:"disable",value:function(){this.disabled=!0}},{key:"enable",value:function(){this.disabled=!1}},{key:"changeTooltip",value:function(e,t){var r=this,i=null;return t&&t.destroy(),delete r.element.dataset.btip,e&&(r.preventTooltipOnTouch&&j.a.isTouchDevice||("Object"!==e.constructor.name&&(e={html:"string"==typeof e?e:r.placeholder,textContent:!0}),e.newInstance?(e.type="tooltip",e.forElement||(e.forElement=r.element),"showOnHover"in e||e.forSelector||(e.showOnHover=!0),"autoClose"in e||(e.autoClose=!0),i=n.create(e)):(r.element.dataset.btip=!0,r.tipConfig=e))),i}},{key:"focus",value:function(){this.isFocusable&&Cr.focusWithoutScrolling(this.focusElement)}},{key:"show",value:function(){var e=this;return new Promise((function(t){var r,i,o=e,a=o.showAnimation,s=o.element,u=n.floatRoot,c=s.style;if(o.isVisible||!1===o.trigger("beforeShow")||o.internalBeforeShow&&!1===o.internalBeforeShow())t();else{if(o.cancelHideShowAnimation(),o.updateCentered(o._centered),o.floating){u.contains(s)||(o.rendered?u.appendChild(o.element):o.render(u,!1)),c.transform.includes("scale")&&(o.scale=null,c.transform=c.transformOrigin="");var l=o.closest(nc);if(l){var f=l.scale;o.scale=f,c.transform="scale(".concat(f,")"),c.transformOrigin="0 0"}}o._hidden=!1,s.classList.remove("b-hidden"),a&&(i=a[r=Object.keys(a)[0]],o.currentAnimation={styleProp:r,resolve:t},o.isAnimating=!0,o.currentAnimation.detacher=nu.onTransitionEnd({element:s,property:r,duration:ic(i.duration)+20,handler:"afterHideShowAnimate",thisObj:o}),c[r]=i.from,Cr.getStyleValue(s,r),c.transition="".concat(r," ").concat(i.duration," ease ").concat(i.delay),c[r]=i.to),o.afterShow(!a&&t),o.inShowBy||!o.floating||!o.forElement||o.centered||o.hidden||o.alignTo(o.forElement)}}))}},{key:"showBy",value:function(e){var t=this;t.inShowBy=!0;var n=t.show();return t.inShowBy=!1,t.isVisible&&t.alignTo(e),n}},{key:"showByPoint",value:function(e,t,n){var r=1===arguments.length?e:[e,t];return this.showBy(Object.assign({target:new En(r[0],r[1],1,1),matchSize:!1,align:"t-b"},n))}},{key:"afterShow",value:function(e){var t;this.boundMaxHeightBugHandler&&this.boundMaxHeightBugHandler(),this.trigger("show"),null===(t=this.parent)||void 0===t||t.onChildShow(),this.triggerPaint(),e&&e()}},{key:"triggerPaint",value:function(){var e=this,t=e.element,n=!e.isPainted;e.isVisible&&(n&&e.scaleToFitWidth&&!e.monitorResize&&(e.onParentElementResize=e.onParentElementResize.bind(e),Mu.addResizeListener(t.parentElement,e.onParentElementResize),e.updateScale()),e.eachWidget(ec,!1),e.trigger("paint",{firstPaint:n}),n&&e.monitorResize&&!e.scaleToFitWidth&&Mu.onElementResize([{target:t}]),e.isPainted=!0)}},{key:"cancelHideShowAnimation",value:function(){var e=this.currentAnimation,t=this.element,n=t.style;e&&(this.isAnimating=!1,t.classList.remove("b-hiding"),e.detacher(),n.transition=n[e.styleProp]="",this.currentAnimation=null)}},{key:"afterHideShowAnimate",value:function(){if(!this.isDestroyed&&this.currentAnimation){var e=this,t=e.element,n=t.style,r=e.currentAnimation,i=r.styleProp,o=r.resolve;t.classList.remove("b-hiding"),e.isAnimating=!1,e.currentAnimation=null,n.transition=n[i]="",e._hidden&&e.afterHideAnimation(),o()}}},{key:"hide",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return new Promise((function(n){var r=e,i=r.element,o=i.style,a=t&&r.hideAnimation;if(r.clearTimeout(r.scrollListenerTimeout),r.clearTimeout(r.resizeListenerTimeout),!r._hidden&&!1!==r.trigger("beforeHide")){if(r._hidden=!0,!i)return void n();if(r.revertFocus(),(j.a.isSafari||j.a.isFirefox)&&i.contains(document.activeElement)&&r.revertFocus(!0),r.isDestroyed)return void n();if(r.cancelHideShowAnimation(),a){var s=Object.keys(a)[0],u=a[s];Number(getComputedStyle(r.element)[s])!==u.to?(r.currentAnimation={styleProp:s,resolve:n},i.classList.add("b-hiding"),r.isAnimating=!0,r.currentAnimation.detacher=nu.onTransitionEnd({element:i,property:s,duration:ic(u.duration)+20,handler:"afterHideShowAnimate",thisObj:r}),o[s]=u.from,Cr.getStyleValue(i,s),o.transition="".concat(s," ").concat(u.duration," ease ").concat(u.delay),o[s]=u.to):i.classList.add("b-hidden")}else i.classList.add("b-hidden");r.afterHide(!a&&n,a)}}))}},{key:"doHideOrRealign",value:function(e){var t,n=this,r=n.anchoredTo,i=n.lastAlignSpec,o=i&&i.target,a=Cr.activeElement,s=n.getXY(),u=ye()(s,2),c=u[0],l=u[1];if(!n.element.contains(e.target)&&e.isTrusted&&!(9===(null===(t=e.target)||void 0===t?void 0:t.nodeType)&&n.element.contains(a)&&Ju[a]&&window.innerHeight<document.body.offsetHeight)&&(n.realign(e.target),!n.isDestroyed&&"hide"===n.scrollAction)){var f=n.getXY(),d=ye()(f,2),h=d[0],v=d[1];(h!==c||v!==l||"Point"===(null==o?void 0:o.$$name))&&(!r||e.target&&Cr.isDescendant(e.target,r))&&n.hide()}}},{key:"afterHide",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.hideAnimation,r=this,i=r.lastAlignSpec;i&&(i.targetHidden=null),r.removeTransientListeners(),n||r.afterHideAnimation(),r.trigger("hide"),null===(e=r.parent)||void 0===e||e.onChildHide(),t&&t()}},{key:"removeTransientListeners",value:function(){var e=this;e.documentScrollListener&&(document.removeEventListener("scroll",e.doHideOrRealign,!0),e.documentScrollListener=!1),e.targetResizeListener&&(Mu.removeResizeListener(e.lastAlignSpec.target,e.callRealign),e.targetResizeListener=!1),e.constrainListeners&&(Mu.removeResizeListener(e.lastAlignSpec.constrainTo||window,e.callRealign),e.constrainMutationMonitor&&e.constrainMutationMonitor.disconnect(),e.constrainListeners=!1)}},{key:"afterHideAnimation",value:function(){var e=this,t=e.element;e.floating&&n.floatRoot.contains(t)?t.remove():t.classList.add("b-hidden"),e.defaultAnchorBackgroundColor&&e.anchorPathElement.setAttribute("fill",e.defaultAnchorBackgroundColor)}},{key:"changeHidden",value:function(e){var t;return this.isConfiguring?(t=Boolean(e),this.element.classList[e?"add":"remove"]("b-hidden")):e?this.hide():this.show(),t}},{key:"getSibling",value:function(e){var t=this.parent,r=t?t.childItems:Array.from(this.element.parentElement.querySelectorAll(".b-widget"));return t?r[r.indexOf(this)+e]:n.fromElement(r[r.indexOf(this.element)+e])}},{key:"up",value:function(){var e=this.owner;if(e)return e.closest.apply(e,arguments)}},{key:"closest",value:function(e,t,r){for(var i=l()(r),o="number"===i,a="string"===i,s=this,u=1;s;s=s.owner,u++){if(n.widgetMatches(s,e,t))return s;if(o&&u>=r)return;if(a&&n.widgetMatches(s,r,t))return;if(s===r)return}}},{key:"owns",value:function(e){if(e){if(e.eventPhase&&(e=e.target),1===e.nodeType){if(this.element.contains(e))return!0;e=n.fromElement(e)}for(;e;){if(e===this)return!0;e=e.owner}}return!1}},{key:"eachAncestor",value:function(e){for(var t=this.owner;t;){if(!1===e(t))return!1;t=t.owner}return!0}},{key:"changeMonitorResize",value:function(e){return!this.scaleToFitWidth&&e}},{key:"updateMonitorResize",value:function(e){var t=this;rc.call(t,"onElementResize")||(t.onElementResize=t.onElementResize.bind(t)),Mu[e?"addResizeListener":"removeResizeListener"](t.element,t.onElementResize)}},{key:"changeReadOnly",value:function(e){if(e=Boolean(e),Boolean(this._readOnly)!==e)return e}},{key:"updateReadOnly",value:function(e){var t;null===(t=this.element)||void 0===t||t.classList[e?"add":"remove"]("b-readonly"),this.isConfiguring||(this.eachWidget((function(t){"_originalReadOnly"in t||(t._originalReadOnly=t.config.readOnly||!1),t.readOnly=e||t._originalReadOnly}),!1),this.trigger("readOnly",{readOnly:e}))}},{key:"eachWidget",value:function(e){for(var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.childItems,r=n?n.length:0,i=0;i<r;i++){var o=n[i];if(!1===e(o))return!1;if(t&&o.eachWidget&&!1===o.eachWidget(e,t))return!1}return!0}},{key:"queryAll",value:function(e){var t=[];return this.eachWidget((function(n){e(n)&&t.push(n)})),t}},{key:"query",value:function(e){var t=null;return this.eachWidget((function(n){if(e(n))return t=n,!1})),t}},{key:"getWidgetByRef",value:function(e){var t,r;return e instanceof n?e:(null==this||null===(t=this.widgetMap)||void 0===t?void 0:t[e])||(null==this||null===(r=this.owner)||void 0===r?void 0:r.getWidgetByRef(e))}},{key:"onFocusIn",value:function(e){var t=this,n=t.element;t.containsFocus=!0,t.focusInEvent=e,n.classList.add("b-contains-focus"),n.contains(e._target)&&t.onInternalKeyDown&&!t.keyDownListenerRemover&&(t.keyDownListenerRemover=nu.on({element:n,keydown:"onInternalKeyDown",thisObj:t})),t.trigger("focusin",e)}},{key:"onFocusOut",value:function(e){var t=this;t.keyDownListenerRemover&&(t.keyDownListenerRemover(),t.keyDownListenerRemover=null),t.isDestroyed||(e.relatedTarget||t.revertFocus(!t.isVisible),t.containsFocus=!1,t.element.classList.remove("b-contains-focus"),t.trigger("focusout",e))}},{key:"revertFocus",value:function(e){var t=this.focusInEvent&&this.focusInEvent.relatedTarget;(e||this.containsFocus&&t&&1===t.nodeType&&this.element.contains(Cr.activeElement))&&(t&&Cr.isFocusable(t)||(t=this.getFocusRevertTarget()),t&&Cr.isFocusable(t)&&Cr.focusWithoutScrolling(t))}},{key:"getFocusRevertTarget",value:function(){var e=this,t=e.owner,r=e.focusInEvent,i=r&&r.backwards?1:-1,o=r&&r.relatedTarget,a=o&&n.fromElement(o);if(t&&!t.isDestroyed&&(!o||!Cr.isFocusable(o)||a&&!a.isFocusable)){if(o=null,t.eachWidget){var s=[];if(t.eachWidget((function(t){(t===e||t.isFocusable)&&s.push(t)}),!1),s.length>1){var u=s.indexOf(e);o=s[u+i]||s[u-i]}}!o&&t.isFocusable&&(o=t),o=o?o.focusElement:t.getFocusRevertTarget()}return o}},{key:"changeCls",value:function(e){return new An(e)}},{key:"changeContentCls",value:function(e){return new An(e)}},{key:"fromCache",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.element;if(!n)return null;var r=this;return r.cache[e]||(r.cache[e]=t?Cr.children(n,e):Cr.down(n,e)),r.cache[e]}},{key:"emptyCache",value:function(){this.cache={}}},{key:"changeMasked",value:function(e,t){if(!0!==e&&""!==e||(e=""),t)"string"==typeof e?(t.text=e,e=t):e?(t.setConfig(e),e=t):t.destroy();else if(e){var r=n.resolveType("mask");(e=r.mergeConfigs(this.maskDefaults,e)).owner=this,e=r.mask(e)}return e||null}},{key:"onMaskAutoClose",value:function(e){e.isDestroyed&&e===this.masked&&(this.masked=null)}},{key:"mask",value:function(e){return this.masked=e,this.masked}},{key:"unmask",value:function(){this.masked=null}},{key:"onInternalResize",value:function(e,t,n,r,i){this._width=e.offsetWidth,this._height=e.offsetHeight}},{key:"onElementResize",value:function(e){var t,n=this,r=n.element,i=n.scrollable,o=n._width,a=n._height,s=r.offsetWidth,u=r.offsetHeight;(n.floating&&n.onFloatingWidgetResize.apply(n,arguments),i)&&(null===(t=i.syncOverflowState)||void 0===t||t.call(i));n.suspendResizeMonitor||o===s&&a===u||(n.onInternalResize(r,s,u,o,a),n.trigger("resize",{width:s,height:u,oldWidth:o,oldHeight:a}))}},{key:"onFloatingWidgetResize",value:function(e,t,n){var r=this,i=r.lastAlignSpec,o=r.constrainTo;if(r.isVisible&&i&&i.target){var a=!t||n.height!==t.height,s=!t||n.width!==t.width,u=o&&!En.from(o).contains(En.from(r.element,null,!0));(a&&2!==i.zone||s&&1!==i.zone||u)&&r.requestAnimationFrame((function(){return r.realign()}))}}},{key:"updateScale",value:function(){var e=this,t=e.element,n=t.parentElement;e.configuredWidth||(e.configuredWidth=e.width),t.style.display="none";var r=En.client(n).width/e.configuredWidth,i=e.scale=e.allowGrowWidth?Math.min(r,1):r;t.style.transform="scale(".concat(i,")"),t.style.transformOrigin="top left",t.style.display="",e.allowGrowWidth&&r>1&&(e.width=e.configuredWidth*r)}},{key:"onParentElementResize",value:function(e){this.updateScale()}},{key:"parseTRBL",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"px";if("number"==typeof(e=e||0))return["".concat(e).concat(t),"".concat(e).concat(t),"".concat(e).concat(t),"".concat(e).concat(t)];var n=e.split(" "),r=n.length;return 1===r?n[1]=n[2]=n[3]=n[0]:2===r?(n[2]=n[0],n[3]=n[1]):3===r&&(n[3]=n[1]),[isFinite(n[0])?"".concat(n[0]).concat(t):n[0],isFinite(n[1])?"".concat(n[1]).concat(t):n[2],isFinite(n[2])?"".concat(n[2]).concat(t):n[3],isFinite(n[3])?"".concat(n[3]).concat(t):n[4]]}},{key:"triggerFieldChange",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t&&this.trigger("change",e),this.eachAncestor((function(t){t.onFieldChange&&t.onFieldChange(e)}))}},{key:"parent",set:function(e){this._parent=e,this._element&&this._element.classList[e?"remove":"add"]("b-outer")},get:function(){return this._parent}},{key:"constrainTo",get:function(){var e=this._constrainTo;return void 0===e?window:e}},{key:"contentElement",get:function(){return this.element}},{key:"contentRange",get:function(){var e=this,t=e.contentElement,n=e._contentRange||(e._contentRange=j.a.isIE11?document.createRange():new Range);return n.collapsed&&(n.setStart(t,e.contentRangeStartOffset||0),n.setEnd(t,e.contentRangeEndOffset||t.childNodes.length)),n}},{key:"style",get:function(){return this.element?this.element.ownerDocument.defaultView.getComputedStyle(this.element):this._style}},{key:"dataset",get:function(){return this.element.dataset}},{key:"dragGhost",get:function(){return this.constructor._dragGhost||(this.constructor._dragGhost=Cr.createElement({html:"",style:"position:absolute;top:-10000em;left:-10000em"}))}},{key:"clippedBy",set:function(e){this._clippedBy=Array.isArray(e)?e:e?[e]:null},get:function(){var e=this._clippedBy;if((null==e?void 0:e.length)>0){var t,n=En.from(null==e?void 0:e[0],null,!0);for(t=1;t<e.length;t++)n=n.intersect(En.from(null==e?void 0:e[t],null,!0));return n}}},{key:"overflowElement",get:function(){return this.contentElement}},{key:"maxHeightElement",get:function(){return this.element}},{key:"html",get:function(){return this.initializingElement||!this.element?this.content||this._html:this.contentElement.innerHTML}},{key:"anchorSize",get:function(){var e=this,t=this._anchorSize;if(!t){var n=parseFloat(Cr.getStyleValue(e.element,"border-top-width")),r=Cr.getStyleValue(e.element,"border-top-color"),i=e.anchorElement,o=i.firstElementChild,a=e.anchorPathElement=o.lastElementChild,s=e._hidden,u=Cr.getStyleValue(e.contentElement,"background-color");u.match(Zu)&&(u=Cr.getStyleValue(e.element,"background-color")),e.defaultAnchorBackgroundColor=u,t=i.getBoundingClientRect();var c=t=e._anchorSize=[t.width,t.height],l=ye()(c,2),f=l[0],d=l[1];o.setAttribute("height",d+n),o.setAttribute("width",f),a.setAttribute("d","M0,".concat(d,"L").concat(f/2,",0.5L").concat(f,",").concat(d)),n&&(a.setAttribute("stroke-width",n),a.setAttribute("stroke",r)),t[1]-=n,s&&e.element.classList.add("b-hidden"),e.themeChangeListener||(e.themeChangeListener=$r.on({theme:"onThemeChange",thisObj:e})),e.anchorPathElement.setAttribute("fill",e.defaultAnchorBackgroundColor)}return t}},{key:"anchorElement",get:function(){var e=this._anchorElement;if(!e){var t=this.floating&&!(j.a.isIE11||j.a.isEdge);e=this._anchorElement=Cr.createElement({parent:this.element,className:"b-anchor b-anchor-top",children:[{tag:"svg",ns:"http://www.w3.org/2000/svg",version:"1.1",class:"b-pointer-el",children:[t?{tag:"defs",children:[{tag:"filter",id:"shadow-filter",children:[{tag:"feDropShadow",dx:0,dy:-1,stdDeviation:2,"flood-opacity":.05}]}]}:null,ke()({tag:"path"},null!=t?t:"filter","url(#shadow-filter)")]}]})}return e}},{key:"x",get:function(){return this.getXY()[0]}},{key:"y",get:function(){return this.getXY()[1]}},{key:"width",get:function(){var e=this,t=e.element;return e.monitorResize?(null==e._width&&(e._width=t.offsetWidth),e._width):t.offsetWidth}},{key:"maxWidth",get:function(){return Cr.measureSize(this.element.style.maxWidth,this.element)}},{key:"minWidth",get:function(){return Cr.measureSize(this.element.style.minWidth,this.element)}},{key:"height",get:function(){var e=this,t=e.element;return e.monitorResize?(null==e._height&&(e._height=t.offsetHeight),e._height):t.offsetHeight}},{key:"maxHeight",get:function(){return Cr.measureSize(this.maxHeightElement.style.maxHeight,this.element)}},{key:"minHeight",get:function(){return Cr.measureSize(this.element.style.minHeight,this.element)}},{key:"tooltip",get:function(){if(this._tooltip)return this._tooltip;var e=n.tooltip;return e&&e.activeTarget===this._element&&e.isVisible?e:void 0}},{key:"isVisible",get:function(){var e=this,t=e.element;return Boolean(t&&!e._hidden&&!e.isDestroying&&br(t)&&(!e.requireSize||function e(t){return t&&(t===document.body||("offsetParent"in t?t.offsetParent:e(t.parentNode)))}(t))&&(!e.owner||e.owner.isVisible))}},{key:"focusElement",get:function(){}},{key:"isFocusable",get:function(){var e=this.focusElement;return e&&this.isVisible&&!this.disabled&&(e===document.body||e.offsetParent)}},{key:"assignedId",get:function(){return this.hasGeneratedId?null:this.id}},{key:"owner",get:function(){var e,t,r=1===(null===(e=this.forElement)||void 0===e?void 0:e.nodeType)?this.forElement:null===(t=this.element)||void 0===t?void 0:t.parentNode;return this.parent||this._owner||(null==r?void 0:r.closest(".b-widget"))&&n.fromElement(r)}},{key:"previousSibling",get:function(){return this.getSibling(-1)}},{key:"nextSibling",get:function(){return this.getSibling(1)}},{key:"readOnly",get:function(){return this._readOnly||!1}},{key:"widgetClassList",get:function(){var e=this,t=e.cls,r=e.classHierarchy(n).reduce((function(t,n){var r,i=Reflect.getOwnPropertyDescriptor(n.prototype,"widgetClass");if(i&&i.get)r=i.get.call(e);else{var o=rc.call(n,"$$name")||rc.call(n,"$name")||rc.call(n,"_$name")?n.$$name:n.name;(o.length<3||o.includes("$"))&&console.warn('Class "'.concat(o,'" which extends "').concat(n.$name,'" should have "$name" static getter with no less than 3 chars.')),r="b-".concat(o.toLowerCase())}return r&&t.push.apply(t,d()(r.split(" "))),t}),(null==t?void 0:t.values)||[]);return e.floating&&r.push("b-floating"),j.a.isTouchDevice&&r.push("b-touch"),r}},{key:"isAnimating",get:function(){return this._animating},set:function(e){e!==this.isAnimating&&(this.element.classList[e?"add":"remove"]("b-animating"),this._animating=e)}}],[{key:"query",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=n.identifiable.idMap;for(var i in r)if(n.widgetMatches(r[i],e,t))return r[i];return null}},{key:"queryAll",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=n.identifiable.idMap,i=[];for(var o in r)n.widgetMatches(r[o],e,t)&&i.push(r[o]);return i}},{key:"fromElement",value:function(e,t,r){var i=l()(t);e&&e instanceof Event&&(e=e.target),("number"===i||t&&1===t.nodeType)&&(r=t,t=null);var o,a,s,u=e,c=0;for("number"!=typeof r&&(o=r,r=Number.MAX_VALUE),"string"===i&&(t=t.toLowerCase());u&&1===u.nodeType&&c<r&&u!==o;){if(a=u.dataset&&u.dataset.ownerCmp||u.id){if(s=n.getById(a)){if(!t)return s;if("function"===i){if(t(s))return s}else if(n.widgetMatches(s,t,!0))return s}c++}u=u.parentNode}return null}},{key:"widgetMatches",value:function(e,t,r){return"*"===t||("function"==typeof t?t(e):n.isType(e,t,r))}},{key:"attachTooltip",value:function(e,t){return"string"==typeof t&&(t={html:t}),n.create(Object.assign({forElement:e},t),"tooltip"),e}},{key:"$name",get:function(){return"Widget"}},{key:"type",get:function(){return"widget"}},{key:"configurable",get:function(){return{element:!0,callOnFunctions:!0,id:"",html:null,content:null,hasGeneratedId:null,cls:null,contentElementCls:null,htmlCls:"b-html",style:null,disabled:null,readOnly:null,adopt:null,appendTo:null,insertBefore:null,insertFirst:null,dataset:null,tooltip:null,preventTooltipOnTouch:null,monitorResize:{$config:["lazy"],value:null},masked:null,maskDefaults:{target:"element"},cache:{},floating:null,positioned:null,draggable:null,align:"t-b",centered:null,constrainTo:void 0,anchor:null,owner:null,scrollAction:null,hideAnimation:{$config:{merge:Qu},value:null},showAnimation:{$config:{merge:Qu},value:null},x:null,y:null,scrollable:null,scrollerClass:Hu,defaultBindProperty:"html",defaultAction:null,width:null,height:null,maxHeight:null,maxWidth:null,minWidth:null,minHeight:null,scaleToFitWidth:null,allowGrowWidth:!0,margin:null,flex:null,weight:null,alignSelf:null,ripple:null,title:null,localizableProperties:["title"],requireSize:!1,ref:null,hidden:null,textAlign:null,ignoreScrollDuration:500,tag:"div"}}},{key:"factoryable",get:function(){return{defaultType:"widget"}}},{key:"identifiable",get:function(){return{}}},{key:"floatRoot",get:function(){var e=this;if(e._floatRoot||(e._floatRoot=document.querySelector(".b-float-root")),e._floatRoot)document.body.contains(e._floatRoot)||document.body.appendChild(e._floatRoot);else{var t,n=e.outerCls,r=null===(t=Cr.themeInfo)||void 0===t?void 0:t.name;r&&n.push("b-theme-".concat(r.toLowerCase())),e._floatRoot=Cr.createElement({className:"b-float-root ".concat(n.join(" ")),parent:document.body}),j.a.isAndroid&&(e._floatRoot.style.height="".concat(screen.height,"px"),nu.on({element:window,orientationchange:function(){return e._floatRoot.style.height="".concat(screen.height,"px")}})),$r.on({theme:function(t){var n=t.theme,r=t.prev;e.floatRoot.classList.add("b-theme-".concat(n.toLowerCase())),e.floatRoot.classList.remove("b-theme-".concat(r.toLowerCase()))}})}return e._floatRoot}},{key:"outerCls",get:function(){var e=[];return j.a.isTouchDevice&&e.push("b-touch-events"),Cr.scrollBarWidth?e.push("b-visible-scrollbar"):e.push("b-overlay-scrollbar"),j.a.isChrome?e.push("b-chrome"):j.a.isSafari?e.push("b-safari"):j.a.isFirefox?e.push("b-firefox"):j.a.isIE11?e.push("b-ie"):j.a.isEdge&&e.push("b-edge"),window.ResizeObserver||e.push("b-no-resizeobserver"),e}}]),n}(ue.mixin(lt,Ge,_a,ni,vi));oc.initClass(),oc.register("mask",Ku),Cr.Widget=oc,$r.Widget=oc,Ku.identifiable.idMap=oc.identifiable.idMap,(window.bryntum||(window.bryntum={})).get=oc.getById.bind(oc),window.bryntum.Widget=oc,window.bryntum.query=oc.query,window.bryntum.queryAll=oc.queryAll,window.bryntum.fromElement=oc.fromElement,oc._$name="Widget";var ac=n(13),sc=n.n(ac);function uc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var cc=function(e){fe()(n,e);var t=uc(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"doDestroy",value:function(){var e=n.toasts.indexOf(this);e>-1&&n.toasts.splice(e,1),we()(pe()(n.prototype),"doDestroy",this).call(this)}},{key:"show",value:function(){we()(pe()(n.prototype),"show",this).call(this),this.timeout>0&&(this.hideTimeout=this.setTimeout("hide",this.timeout))}},{key:"hide",value:function(){var e=this;e.destroyTimer||(e.element.classList.add("b-toast-hide"),e.element.style.bottom="",e.destroyTimer=e.setTimeout("destroy",e.destroyTimeout))}},{key:"element",set:function(e){},get:function(){if(!this._element&&!this.isConfiguring){var e=this,t=n.toasts.length&&n.toasts[0].element,r=t?t._nextBottom:e.bottomMargin,i=sc()(pe()(n.prototype),"element",Cr.createElement({parent:e.appendTo||oc.floatRoot,children:e.showProgress?[{className:"b-toast-progress",style:"animation-duration:".concat(e.timeout/1e3,"s;")}]:null,html:e._html,className:e.color||"",style:e._style||""}),this,!0);nu.on({element:i,click:"hide",thisObj:e}),n.toasts.unshift(e),i._nextBottom=r+i.offsetHeight+e.bottomMargin,i.style.cssText+=";bottom:".concat(r,"px;transform:translateY(0)")}return we()(pe()(n.prototype),"element",this)}}],[{key:"hideAll",value:function(){n.toasts.reverse().forEach((function(e){return e.hide()}))}},{key:"show",value:function(e){var t=new n("string"==typeof e?{html:e}:e);return t.show(),t}},{key:"$name",get:function(){return"Toast"}},{key:"type",get:function(){return"toast"}},{key:"defaultConfig",get:function(){return{testConfig:{timeout:100,destroyTimeout:1},floating:!0,timeout:2500,destroyTimeout:200,showProgress:!0,color:null,bottomMargin:20}}}]),n}(oc);cc.toasts=[],cc.initClass(),cc._$name="Toast";var lc=function(){function e(){v()(this,e)}return g()(e,null,[{key:"getById",value:function(e){return oc.getById(e)}},{key:"fromElement",value:function(e,t,n){return oc.fromElement(e,t,n)}},{key:"createWidget",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.isWidget?e:oc.create(e)}},{key:"append",value:function(e,t){if(e=Array.isArray(e)&&e||[e],(t instanceof HTMLElement||"string"==typeof t)&&(t={appendTo:t}),t.insertFirst){var n="string"==typeof t.insertFirst?document.getElementById(t.insertFirst):t.insertFirst;n.firstChild?t.insertBefore=n.firstChild:t.appendTo=n}return e.map((function(e){return oc.create(an.assign({},t||{},e))}))}},{key:"openPopup",value:function(e,t){return oc.create(an.assign({forElement:e},"string"==typeof t?{html:t}:t),"popup")}},{key:"showContextMenu",value:function(e,t){var n=this;return n.currentContextMenu&&n.currentContextMenu.destroy(),e instanceof HTMLElement?t.forElement=e:Array.isArray(e)?t.forElement={target:Ue()(Xs,d()(e))}:e instanceof Xs&&(t.forElement={target:e}),n.currentContextMenu=oc.create(t,"menu"),n.currentContextMenu.on("destroy",(function(){n.currentContextMenu=null})),n.currentContextMenu}},{key:"attachTooltip",value:function(e,t){return oc.attachTooltip(e,t)}},{key:"hasTooltipAttached",value:function(e){return oc.resolveType("tooltip").hasTooltipAttached(e)}},{key:"destroyTooltipAttached",value:function(e){return oc.resolveType("tooltip").destroyTooltipAttached(e)}},{key:"mask",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Loading";if(e)return e instanceof HTMLElement&&(e={target:e,text:t}),Ku.mask(e,e.target)}},{key:"unmask",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e.mask&&(t?e.mask.close():e.mask.hide())}},{key:"toast",value:function(e){return cc.show(e)}}]),e}();lc._$name="WidgetHelper";var fc=function(){function e(){v()(this,e),this.random100=[46,2,36,46,54,59,18,20,71,55,88,98,13,61,61,40,2,15,3,32,51,45,64,25,81,85,54,13,57,49,64,22,81,94,0,62,17,7,11,2,33,99,85,26,83,83,96,26,20,89,91,38,26,13,11,79,32,30,5,51,70,7,5,56,58,77,37,89,40,80,78,59,26,36,8,51,60,23,86,5,11,96,64,94,87,64,4,78,17,85,35,0,90,86,23,55,53,9,35,59,29,2,64,42,8,49,43,73,6,53,38,9,39,31,32,40,49,13,78,68,20,99,24,78,35,91,73,46,67,76,89,69,30,69,25,3,4,55,1,65,66,76,83,19,67,1,95,24,54,45,56,40,67,92,72,4,69,8,47,50,27,2,38,9,14,83,12,14,62,95,22,47,35,18,38,14,86,64,68,61,52,69,39,93,20,73,32,52,74,6,56,68,99,29,24,92,40,67,6,72,31,41,91,53,80,55,33,97,97,99,18,20,5,27,82,84,61,78,27,67,7,42,75,95,91,25,63,21,70,36,46,0,1,45,84,6,86,15,10,62,96,94,10,23,93,83,94,47,5,29,29,52,51,37,77,96,43,72,43,14,54,14,72,52,4,39,15,26,68,28,25,76,60,50,22,40,72,74,68,58,8,48,40,62,52,24,9,26,47,44,49,96,7,77,90,45,76,47,5,86,1,36,18,42,19,90,34,23,70,32,69,79,0,99,57,80,72,21,19,72,85,68,4,40,86,62,0,63,4,11,69,31,78,31,21,78,29,84,13,53,57,10,26,50,24,30,90,42,51,96,93,21,99,23,81,0,89,43,86,63,93,19,54,71,92,36,4,95,37,99,60,29,23,50,68,95,57,95,77,53,99,78,75,12,92,47,23,14,0,41,98,11,34,64,26,90,50,23,38,31,74,76,16,76,66,23,22,72,48,50,20,36,37,58,5,43,49,64,81,30,8,21,98,75,60,17,50,42,27,38,90,74,45,68,67,27,31,15,58,76,41,99,23,98,53,98,56,19,79,2,4,38,96,24,65,51,43,42,41,60,46,7,90,65,3,27,63,99,51,44,86,1,54,40,15,74,3,81,51,63,87,79,84,72,22,38,96,95,33,41,21,99,21,69,7,49,40,52,41,6,91,19,76,40,54,17,33,11,11,0,1,32,94,33,13,18,45,7,85,61,42,54,45,72,78,96,17,9,80,87,41,96,66,0,8,59,18,21,2,28,64,75,97,32,80,86,97,97,55,2,73,75,11,89,67,58,70,76,12,46,64,17,22,97,25,35,93,57,82,46,57,61,31,74,27,4,32,85,53,86,53,53,42,5,28,50,65,63,70,61,73,37,13,80,7,34,22,3,26,6,62,78,12,56,87,41,58,64,31,27,45,35,18,66,62,43,89,69,94,93,33,74,2,43,85,37,82,41,74,9,15,44,33,42,65,19,1,49,78,12,29,9,78,7,55,12,45,40,33,16,86,14,52,16,73,76,0,98,75,91,78,46,99,95,90,69,78,45,62,55,37,88,49,77,27,83,38,73,39,1,75,40,65,83,54,95,7,73,4,30,26,36,89,21,5,95,11,14,87,45,36,21,77,55,5,66,51,98,48,62,74,58,23,82,30,28,19,53,89,76,98,8,34,70,28,54,16,52,35,93,54,54,72,49,18,93,72,90,71,73,15,60,38,80,76,53,70,39,69,25,5,31,61,46,6,54,34,31,52,33,36,79,76,44,29,28,38,1,66,2,90,91,1,76,78,31,55,37,71,2,3,38,85,0,95,42,2,39,57,87,61,77,98,2,24,80,48,27,47,71,15,7,49,60,86,3,2,29,38,54,36,59,83,27,47,9,36,42,8,73,85,9,16,73,60,39,12,43,25,23,29,28,47,40,77,20,89,22,30,41,59,96,19,56,20,76,73,39,46,72,40,47,37,52,29,79,37,39,50,41,87,66,17,75,31,45,26,88,70,11,90,40,74,9,32,65,72,61,6,93,54,15,84,22,99,47,10,96,4,84,19,85,73,45,25,16,8,94,99,39,28,26,68,87,48,1,65,86,46,86,7,60,82,45,75,38,56,41,35,30,86,91,97,85,45,5,14,69,85,96,37,18,26,16,38,16,1,44,94,85,58,60,20,5,47,52,41,50,71,43,42,67,64,38,65,83,99,78,96,33,20,98,24,6,2,25,16,16,44,63,24,68,56,49,91,15,59,99,27,43,34,28,36,45,1,10,19,54,26,75,17,88,96,63,24,71,93,72,97,66,87,18,86],this.randomCache={},this.rndIndex=0}return g()(e,[{key:"nextRandom",value:function(e){var t,n=this.randomCache;return n[e]?t=n[e]:(t=this.random100.filter((function(t){return t<e})),n[e]=t),t[this.rndIndex++%t.length]}},{key:"reset",value:function(){this.rndIndex=0}},{key:"fromArray",value:function(e){return e[this.nextRandom(e.length)]}}]),e}();fc._$name="RandomGenerator";var dc=function(){function e(){v()(this,e)}return g()(e,null,[{key:"reset",value:function(){this.rnd.reset(),this.rndTime.reset(),this.rndRating.reset()}},{key:"generate",value:Vr.a.mark((function e(t){var n,r,i,o,a,s,u,c,l,f,d,h,v,p,g,y,m,k,b,w,C=arguments;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=C.length>1&&void 0!==C[1]&&C[1],r=C.length>2&&void 0!==C[2]?C[2]:1,o=(i=this).rnd,a=i.rndTime,s=i.rndRating,u=i.firstNames,c=i.surNames,l=i.teams,f=i.foods,d=i.colors,h=i.cities,v=0;case 4:if(!(v<t)){e.next=12;break}return p=o.fromArray(u),g=o.fromArray(c),y="".concat(p," ").concat(String.fromCharCode(65+v%25)," ").concat(g),m=o.nextRandom(60)+1,k=new Date(2019,0,m),b=new Date(2019,0,m+o.nextRandom(30)+2),w={id:v+r,title:"Row "+v,name:y,firstName:p,surName:g,city:o.fromArray(h),team:o.fromArray(h)+" "+o.fromArray(l),age:10+o.nextRandom(80),food:o.fromArray(f),color:o.fromArray(d),score:10*o.nextRandom(100),rank:o.nextRandom(100)+1,start:k,finish:b,time:Zt.getTime(a.nextRandom(24),5*a.nextRandom(12)),percent:o.nextRandom(100),done:o.nextRandom(100)<50,rating:s.nextRandom(5),relatedTo:Math.min(t-1,v+r+o.nextRandom(10))},n&&(w.rowHeight=5*o.nextRandom(!0===n?20:n)+20),e.next=9,w;case 9:v++,e.next=4;break;case 12:case"end":return e.stop()}}),e,this)}))},{key:"generateData",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];i&&this.reset();for(var o=[],a=e.overrideRowCount?e.overrideRowCount:t,s=this.generate(a,n,r),u=0;u<a;u++)o.push(s.next().value);return o}}]),e}();function hc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Object.assign(dc,{rnd:new fc,rndTime:new fc,rndRating:new fc,cities:["Stockholm","Barcelona","Paris","Dubai","New York","San Francisco","Washington","Moscow"],firstNames:["Mike","Linda","Don","Karen","Doug","Jenny","Daniel","Melissa","John","Jane","Theo","Lisa","Adam","Mary","Barbara","James","David"],surNames:["McGregor","Ewans","Scott","Smith","Johnson","Adams","Williams","Brown","Jones","Miller","Davis","More","Wilson","Taylor","Anderson","Thomas","Jackson"],teams:["Lions","Eagles","Tigers","Horses","Dogs","Cats","Panthers","Rats","Ducks","Cougars","Hens","Roosters"],foods:["Pancake","Burger","Fish n chips","Carbonara","Taco","Salad","Bolognese","Mac n cheese","Waffles"],colors:["Blue","Green","Red","Yellow","Pink","Purple","Orange","Teal","Black"]}),dc._$name="DataGenerator";var vc=["action","target","to","deltaX","deltaY","x","y","text"],pc=function(e){fe()(n,e);var t=hc(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e){we()(pe()(n.prototype),"construct",this).call(this,e);var t=this;t.widget&&(t.outerElement=t.widget.element,t.widget.playingDemo=!0),nu.playingDemo=!0,Object.assign(t,{prevTarget:null,currentStep:0,mouse:Cr.createElement({parent:t.outerElement,tag:"div",className:"simulated-mouse"}),timeoutId:null,innerIntervalId:null,mouseOutElements:[]}),t.intervalId=t.setInterval(t.nextStep.bind(t),1e3),t.outerElement.classList.add("b-playing-demo"),t.outerElement.addEventListener("click",(function(e){e.isTrusted&&t.abort()}))}},{key:"doDestroy",value:function(){this.abort()}},{key:"abort",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;t.mouse.style.top="-100px",t.clearInterval(t.intervalId),t.timeoutId&&t.clearTimeout(t.timeoutId),t.innerIntervalId&&t.clearInterval(t.innerIntervalId),t.outerElement.classList.remove("b-playing-demo"),t.widget&&(t.widget.playingDemo=!1),nu.playingDemo=!1,t.trigger(e?"done":"abort")}},{key:"triggerEvent",value:function(e,t,n){if(!e)return null;var r;if(t.startsWith("mouse")){var i=this.mouse.getBoundingClientRect();r=new MouseEvent(t,Object.assign({view:window,bubbles:!0,cancelable:!0,clientX:i.left,clientY:i.top},n||{}))}else(r=document.createEvent("Event")).initEvent(t,!0,!1);return e.dispatchEvent(r),r}},{key:"handleMouseMove",value:function(e,t){var n=this,r=n.mouse;r.classList.add("quick"),n.mouseDown&&r.classList.add("drag");var i=En.from(r,n.outerElement),o=i.x,a=i.y,s=0,u=0;if(e.to)if("string"==typeof e.to){var c=n.outerElement.querySelector(e.to);if(c){var l=En.from(c,n.outerElement),f=l.x+l.width/2,d=l.y+l.height/2;s=(f-o)/10,u=(d-a)/10}}else e.to.x?s=(e.to.x-o)/10:(s=e.to[0]/10,u=e.to[1]/10);else e.deltaX?s=e.deltaX/10:e.x&&(s=(e.x-o)/10);e.deltaY&&(u=e.deltaY/10);var h=0;n.innerIntervalId=n.setInterval((function(){if(!n.shouldPause){9==h++&&(clearInterval(n.innerIntervalId),e.then&&e.then());var t=o+s*h,i=a+u*h;r.style.left=t+"px",r.style.top=i+"px";var c=r.getBoundingClientRect(),l=c.left,f=c.top,d=Cr.elementFromPoint(l,f);d!==n.prevTarget&&(n.prevTarget&&(n.mouseOutElements.push(n.prevTarget),Cr.isDescendant(n.mouseOutElements[0],d)||(n.mouseOutElements.forEach((function(e){return n.triggerEvent(e,"mouseout")})),n.mouseOutElements.length=0)),n.prevTarget=d,n.triggerEvent(d,"mouseover")),n.triggerEvent(d,e.action,{clientX:l,clientY:f})}}),50)}},{key:"getTarget",value:function(e){var t=e.target;return t?"function"==typeof t?t(e):document.querySelector(t):this.prevTarget||this.outerElement}},{key:"normalizeStep",value:function(e){if(e.action)return"function"==typeof e.action?e.action(e):e;if("function"==typeof e)return e(),e;for(var t in e)Object.hasOwnProperty.call(e,t)&&!vc.includes(t)&&(e.action=t.toLowerCase(),e.to=e[t]);return e.target||"string"!=typeof e.to&&"function"!=typeof e.to||(e.target=e.to),e}},{key:"nextStep",value:function(){var e=this;if(!e.shouldPause){if(e.currentStep===e.steps.length){if(!e.repeat)return e.abort(!0);e.currentStep=0}0===e.currentStep&&e.trigger("initialize");var t=e.mouse,n=e.normalizeStep(e.steps[e.currentStep++]),r=e.getTarget(n),i=n.action;if(r&&i)if(t.className="simulated-mouse","mousemove"===i)e.handleMouseMove(n,r);else{if(r!==e.prevTarget){var o=En.from(r,e.outerElement);t.style.left=o.x+o.width/2+"px",t.style.top=o.y+o.height/2+"px"}"mousedown"===i&&(e.mouseDown=!0),"mouseup"===i&&(e.mouseDown=!1),e.timeoutId=e.setTimeout((function(){if(e.prevTarget=r,t.classList.add(i),"type"===i){var o=oc.fromElement(r),a=n.text.split("|");o.value=a[1===a.length||o.value!=a[0]?0:1]}else e.triggerEvent(r,i)}),"type"===i?100:550)}}}},{key:"isScrolling",get:function(){var e=this.outerElement.getBoundingClientRect(),t=this.lastTop&&e.top!==this.lastTop;return this.lastTop=e.top,t}},{key:"isInView",get:function(){var e=this.outerElement.getBoundingClientRect();return e.top<window.innerHeight&&e.bottom>0}},{key:"shouldPause",get:function(){return!this.isInView||this.isScrolling||document.hidden||!document.hasFocus()}}],[{key:"defaultConfig",get:function(){return{repeat:!0,outerElement:document.body,callOnFunctions:!0}}}]),n}(Ge(_a()));pc._$name="DemoBot";var gc=Object.prototype.hasOwnProperty,yc=null;function mc(e,t){return Object.defineProperty(e,"parser",{value:t}),t}var kc=function(){function e(t){v()(this,e),this.formatter=t}return g()(e,[{key:"format",value:function(e){return this.formatter.defaultFormat(e)}},{key:"parse",value:function(e,t){return this.formatter.defaultParse(e,t)}},{key:"resolvedOptions",value:function(){return null}}]),e}(),bc=function(){function e(t){v()(this,e);var n=this;if(n.cacheKey=yc,yc=null,n.initialize(),null===t)mc(n,n.formatter=new kc(n));else{n.configure(t);for(var r=0,i=Object.entries(n.resolvedOptions());r<i.length;r++){var o=ye()(i[r],2),a=o[0],s=o[1];null!=s&&a in n.defaults&&(n[a]=s)}}}return g()(e,null,[{key:"get",value:function(e){if(null==e)return this.NULL;var t="string"==typeof e?e:JSON.stringify(e),n=this.cache,r=n.get(t);return r||(yc=t,r=new this(e),n.set(t,r)),r}},{key:"cache",get:function(){return gc.call(this,"_cache")&&this._cache||(this._cache=new Map)}},{key:"NULL",get:function(){return gc.call(this,"_null")?this._null:this._null=new this(null)}}]),g()(e,[{key:"defaultFormat",value:function(e){return null==e?e:String(e)}},{key:"defaultParse",value:function(e){return e}},{key:"format",value:function(e){return null==e?e:this.formatter.format(e)}},{key:"parse",value:function(e,t){return null==e?e:this.parser.parse(e,t)}},{key:"parseStrict",value:function(e){return this.parse(e,!0)}},{key:"resolvedOptions",value:function(){return this.formatter.resolvedOptions()}},{key:"parser",get:function(){return mc(this,new this.constructor.Parser(this))}}]),e}();bc._$name="Formatter";var wc=function(){function e(){v()(this,e)}return g()(e,null,[{key:"init",value:function(){var e=["fullscreenEnabled","requestFullscreen","exitFullscreen","fullscreenElement"],t=function(t){return e.map((function(e){var n=t+E.capitalize(e);return"moz"===t&&(n=n.replace("screen","Screen"),"mozCancelFullScreen"in document&&"exitFullscreen"===e&&(n="mozCancelFullScreen")),n}))};this.functions="fullscreenEnabled"in document&&e||"webkitFullscreenEnabled"in document&&t("webkit")||"mozFullScreenEnabled"in document&&t("moz")||"msFullscreenEnabled"in document&&t("ms")||[];var n=["fullscreenchange","fullscreenerror"],r=function(e){return n.map((function(t){return e+E.capitalize(t)}))};this.events="fullscreenEnabled"in document&&n||"webkitFullscreenEnabled"in document&&r("webkit")||"mozFullscreenEnabled"in document&&r("moz")||"msFullscreenEnabled"in document&&["MSFullscreenChange","MSFullscreenError"]||[]}},{key:"request",value:function(e){return e[this.functions[1]]()}},{key:"exit",value:function(){return document[this.functions[2]]()}},{key:"onFullscreenChange",value:function(e){document.addEventListener(this.events[0],e)}},{key:"unFullscreenChange",value:function(e){document.removeEventListener(this.events[0],e)}},{key:"enabled",get:function(){return document[this.functions[0]]}},{key:"isFullscreen",get:function(){return!!document[this.functions[3]]}}]),e}();function Cc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}wc.init(),wc._$name="Fullscreen";var Sc=E.escapeRegExp,Dc=/[\d+-]/g,Rc=function(e,t){return new Intl.NumberFormat(e||void 0,t)},xc=/^(?:([$])\s*)?(?:(\d+)>)?\d+(,\d+)?(?:\.((\d*)(?:#*)|[*]))?(?:\s*([%])?)?$/,Ec=function(){function e(t){v()(this,e);var n=this,r=t.locale,i=Rc(r,{maximumFractionDigits:3}),o=t.is.currency?n._decodeStyle(r,{style:"currency",currency:t.currency,currencyDisplay:t.currencyDisplay}):null,a=t.is.percent?n._decodeStyle(r,{style:"percent"}):null,s=i.format(1.2).replace(Dc,"")[0],u=i.format(1e9).replace(Dc,"")[0];Object.assign(n,{currency:o,decimal:s,formatter:t,grouper:u,percent:a}),n.decimal=s,n.decimalRe=Sc(s,"g"),n.grouper=u,n.stripRe=new RegExp("(?:\\s+|".concat(Sc(u),")")+(o?"|(?:".concat(Sc(o.text),")"):"")+(a?"|(?:".concat(Sc(a.text),")"):""),"g")}return g()(e,[{key:"parse",value:function(e,t){return"string"==typeof e&&(e=e.replace(this.stripRe,"").replace(this.decimalRe,"."),e=t?Number(e):parseFloat(e),this.formatter.is.percent&&(e/=100)),e}},{key:"_decodeStyle",value:function(e,t){var n=Rc(e,t),r=Rc(e,Object.assign(n.resolvedOptions(),{style:"decimal"})),i=n.format(0),o=r.format(0);return{suffix:i.startsWith(o),text:i.replace(o,"").trim()}}}]),e}(),Tc=function(e){fe()(n,e);var t=Cc(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"initialize",value:function(){this._as={},this.is={decimal:!1,currency:!1,percent:!1,null:!0,from:null}}},{key:"configure",value:function(e){var t=this;"string"!=typeof e?Object.assign(t,e):t.template=e;var n={},r=t.locale?rt.locales[t.locale]:rt.locale,i=r&&r.NumberFormat,o=t.template;if(i)for(var a in i)null==t[a]&&"function"!=typeof i[a]&&(t[a]=i[a]);if(o){var s=xc.exec(o),u=s[2],c=s[4];t.useGrouping=!!s[3],t.style=s[1]?"currency":s[6]?"percent":"decimal",u&&(t.integer=+u),"*"===c?t.fraction=[0,20]:null!=c&&(t.fraction=[s[5].length,c.length])}for(var l in t._minMax("fraction",!0,!0),t._minMax("integer",!0,!1),t._minMax("significant",!1,!0),t.defaults)null!=t[l]&&(n[l]=t[l]);t.is.from=t.from&&t.from.is,t.is[t.style]=!(t.is.null=!1),t.formatter=Rc(t.locale,n)}},{key:"as",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.resolvedOptions()||{template:"9.*"},i=this._as,o=t&&i[t];return o||("string"==typeof e?r.style=e:Object.assign(r,e),r.from=this,o=new n(r)),t&&(i[t]=o),o}},{key:"defaultParse",value:function(e,t){return null==e?e:t?Number(e):parseFloat(e)}},{key:"format",value:function(e){if("string"==typeof e){var t=Number(e);e=isNaN(t)?this.parse(e):t}return we()(pe()(n.prototype),"format",this).call(this,e)}},{key:"round",value:function(e){return this.parse(this.format(e))}},{key:"truncate",value:function(e){var t,n,r=this.maximumFractionDigits,i=this.parse(e);return null!=r&&((t=(i=(n=this.as({style:"decimal",maximumFractionDigits:Math.min(20,r+1)},"truncator")).format(i)).indexOf(n.parser.decimal))>-1&&i.length-t-1>r&&(i=i.substr(0,t+r+1)),i=n.parse(i)),i}},{key:"resolvedOptions",value:function(){var e=we()(pe()(n.prototype),"resolvedOptions",this).call(this);for(var t in e)void 0===e[t]&&(e[t]=this[t]);return e}},{key:"_minMax",value:function(e,t,n){var r=this,i=r[e];if(null!=i){var o=E.capitalize(e),a="maximum".concat(o,"Digits"),s="minimum".concat(o,"Digits");"number"==typeof i?(t&&(r[s]=i),n&&(r[a]=i)):(r[s]=i[0],r[a]=i[1])}}}],[{key:"$name",get:function(){return"NumberFormat"}}]),n}(bc);function Mc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Tc.Parser=Ec,Object.assign(Tc.prototype,{defaults:{style:"decimal",currency:null,currencyDisplay:"symbol",locale:null,maximumFractionDigits:null,minimumFractionDigits:null,minimumIntegerDigits:null,maximumSignificantDigits:null,minimumSignificantDigits:null,useGrouping:!0},fraction:null,from:null,integer:null,significant:null,template:null}),Object.assign(Tc.prototype,Tc.prototype.defaults),bc.number=function(e,t){return Tc.format(e,t)},Tc._$name="NumberFormat";var Ac=function(e){return function(e){fe()(r,e);var t,n=Mc(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"construct",value:function(){for(var e,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];(e=we()(pe()(r.prototype),"construct",this)).call.apply(e,[this].concat(n)),this.finalizer=null,this.finalizing=null,this.isFinalized=!1,this.isFinalizing=!1}},{key:"doFinalize",value:function(){this.destroy()}},{key:"finalize",value:function(){var e=this,t=e.finalizing;return t||e.isFinalized||(e.isFinalizing=!0,e.finalizing=t=e._awaitFinalizer()),t}},{key:"_awaitFinalizer",value:(t=Wr()(Vr.a.mark((function e(){var t;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this,e.prev=1,e.next=4,t.finalizer;case 4:return e.prev=4,t.finalizing=null,t.isFinalized=!0,t.doFinalize(),e.finish(4);case 9:case"end":return e.stop()}}),e,this,[[1,,4,9]])}))),function(){return t.apply(this,arguments)})}],[{key:"$name",get:function(){return"Finalizable"}}]),r}(e||ue)};function Pc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var Ic=Symbol("dragAbort"),Oc=Symbol("dragInit"),Fc=Symbol("dragDrag"),Lc=Symbol("dragDrop"),jc={x:"horizontal",y:"vertical"},_c=function(e){fe()(r,e);var t,n=Pc(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"construct",value:function(){for(var e,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];(e=we()(pe()(r.prototype),"construct",this)).call.apply(e,[this].concat(n));var o=this,a=o.event;Object.assign(o,{altKey:null,cleaners:[],ctrlKey:null,data:new Map,element:a.target,endEvent:null,lastMoveEvent:null,metaKey:null,scrollerAction:null,shiftKey:null,state:Oc,startEvent:a,touchStartTimer:null,_valid:!0}),"touches"in a&&(o.touchStartTimer=o.setTimeout((function(){return o.touchStartTimer=null}),o.touchStartDelay,"touchStartDelay"))}},{key:"doDestroy",value:function(){var e=this,t=e.source,n=e.target;e.cleanup(),(null==n?void 0:n.dropping)===e&&(n.dropping=null),(null==t?void 0:t.dragging)===e&&(t.dragging=null),we()(pe()(r.prototype),"doDestroy",this).call(this)}},{key:"get",value:(t=Wr()(Vr.a.mark((function e(t){var n,r=this;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.aborted){e.next=2;break}throw new Error("Data is not available on aborted drag");case 2:if(this.completed){e.next=4;break}throw new Error("Data is not available until drag completion");case 4:if(!Array.isArray(t)){e.next=6;break}return e.abrupt("return",Promise.all(t.map((function(e){return r.get(e)}))));case 6:if("function"!=typeof(n=this.data.get(t))){e.next=12;break}return e.next=10,n();case 10:n=e.sent,this.data.set(t,n);case 12:return e.abrupt("return",n);case 13:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"has",value:function(e){return this.data.has(e)}},{key:"peek",value:function(e){var t=this;if(this.aborted)throw new Error("Data is not available on aborted drag");if(Array.isArray(e))return e.map((function(e){return t.peek(e)}));var n=this.data.get(e);return"function"==typeof n&&(n=!0),n}},{key:"set",value:function(e,t){this.data.set(e,t)}},{key:"changeTarget",value:function(e,t){if(e!==t){var n=this;n._target=e,t&&(t.dropping=null),e&&(e.dropping=n,e.dropping!==n&&(e=null,n.valid=!1)),n._target=t}return e}},{key:"updateTarget",value:function(e,t){var n=this;t&&n.source.dragLeaveTarget(n,t),e&&(n.valid=!0,e.dragMove(n),n.source.dragEnterTarget(n))}},{key:"updateTargetElement",value:function(e){var t=null==e?void 0:e.closest(".b-droppable");t&&t.compareDocumentPosition(e)&Node.DOCUMENT_POSITION_CONTAINED_BY&&(this.target=qo.get(t,"droppable")||null)}},{key:"abort",value:function(){var e=this,t=e.element,n=e.source;null==t||t.getBoundingClientRect(),e.state!==Lc&&(e.state=Ic,e.cleanup()),null==n||n.endDrag(e)}},{key:"begin",value:function(){var e=this.source;!1!==e.beforeDrag(this)&&(e.dragging=this)}},{key:"cleanup",value:function(){for(var e;e=this.cleaners.pop();)e()}},{key:"end",value:function(e){var t=this,n=t.lastMoveEvent,r=t.target,i=t.source.dragSwallowClickTime;t.event=t.endEvent=e,t.syncFlags(),t.started&&((null==n?void 0:n.clientX)===e.clientX&&(null==n?void 0:n.clientY)===e.clientY&&(null==n?void 0:n.target)===e.target||t.track(),i&&nu.on({element:document,capture:!0,expires:i,once:!0,click:function(e){e.stopPropagation()}}),t.state=Lc,r!==t.source&&(null==r||r.dragDrop(t)))}},{key:"fakeKey",value:function(e,t){var n,r=this,i=r.lastMoveEvent;i&&r.element&&(i.isKey=!0,"Alt"===e.key?r.altKey!==t&&(r.altKey=t,n=!0):"Control"===e.key&&r.ctrlKey!==t&&(r.ctrlKey=t,n=!0),n&&(r.event=i,r.track()))}},{key:"keyDown",value:function(e){this.completed||("Escape"===e.key?this.abort():this.isDragToggleKey(e.key)&&this.fakeKey(e,!0))}},{key:"keyUp",value:function(e){!this.completed&&this.isDragToggleKey(e.key)&&this.fakeKey(e,!1)}},{key:"getDistance",value:function(e){return nu.getDistanceBetween(this.startEvent,e)}},{key:"isDragToggleKey",value:function(e){return"Control"===e||"Alt"===e}},{key:"move",value:function(e){var t=this,n=e.target,r=t.getDistance(e)>=t.threshold;if(t.syncFlags(),t.touchStartTimer)r&&t.abort();else if(n&&n.nodeType===Node.ELEMENT_NODE){if(r&&!t.started&&(t.event=e,!1===t.start()))return void t.abort();t.started&&(t.lastMoveEvent=t.event=e,"touchmove"===e.type&&(e.preventDefault(),e.stopImmediatePropagation()),t.track())}}},{key:"start",value:function(){var e=this,t=e.scrollManager,n=e.source,r=n.draggingBodyCls,i=n.dragLock,o=n.dragRootElement;if(e.state=Fc,t&&(t.startMonitoring({thisObj:n,direction:jc[i]||i||"both",element:o,callback:function(t){var n=e.lastMoveEvent;n&&e.element&&(n.isScroll=!0,e.event=n,e.scrollerAction=t,e.track(),e.scrollerAction=null)}}),e.cleaners.push((function(){return t.stopMonitoring(o)}))),document.body.classList.add(r),e.cleaners.push((function(){return document.body.classList.remove(r)})),!1===n.startDrag(e))return e.cleanup(),!1}},{key:"syncFlags",value:function(){var e=this,t=e.event;e.altKey=t.altKey,e.ctrlKey=t.ctrlKey,e.metaKey=t.metaKey,e.shiftKey=t.shiftKey}},{key:"track",value:function(){var e,t=this,n=t.event,r=t.source,i=t.target,o=n.target;"touchmove"===n.type&&(e=n.changedTouches[0],o=Cr.elementFromPoint(e.clientX,e.clientY)),t.targetElement=o,i===t.target&&(null==i||i.dragMove(t)),r.trackDrag(t)}},{key:"aborted",get:function(){return this.state===Ic}},{key:"completed",get:function(){return this.aborted||null!==this.endEvent}},{key:"started",get:function(){return this.state!==Oc&&!this.aborted}},{key:"valid",get:function(){return this.started&&null!=this.targetElement&&this._valid},set:function(e){this._valid=e}}],[{key:"configurable",get:function(){return{itemElement:null,scrollManager:null,source:null,target:null,targetElement:null,threshold:5,touchStartDelay:300}}}]),r}(ue.mixin(Ac,_a));function Bc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}_c.prototype.STATE=_c.STATE=Object.freeze({ABORTED:Ic,INIT:Oc,DRAGGING:Fc,DROPPED:Lc}),_c._$name="DragContext";var Hc=function(e){fe()(n,e);var t=Bc(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"updateDragging",value:function(e,t){t&&this.close(t),e&&this.open(e)}},{key:"close",value:function(e){}},{key:"open",value:function(e){}},{key:"dragStart",value:function(e){this.dragging=e}},{key:"dragMove",value:function(e){}},{key:"dragEnd",value:function(e){this.dragging=null}}],[{key:"type",get:function(){return"default"}},{key:"configurable",get:function(){return{dragging:null}}},{key:"factoryable",get:function(){return{defaultType:n}}}]),n}(ue.mixin(vi));function $c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Hc.initClass(),Hc._$name="DragProxy";var Nc=function(e){return function(e){fe()(i,e);var t,n,r=$c(i);function i(){return v()(this,i),r.apply(this,arguments)}return g()(i,[{key:"dragStart",value:function(e){}},{key:"dragOver",value:function(e){}},{key:"dragEnterTarget",value:function(e){}},{key:"dragLeaveTarget",value:function(e,t){}},{key:"dragDrop",value:function(e){}},{key:"dragEnd",value:function(e){}},{key:"beforeDrag",value:function(e){var t=this.dragSelector;return!t||e.element.matches(t)}},{key:"beginDrag",value:function(e){var t=this.draggingCls,n=this.draggingClassElement;t&&n&&(n.classList.add(t),e.cleaners.push((function(){return n.classList.remove(t)})))}},{key:"endDrag",value:(n=Wr()(Vr.a.mark((function e(t){var n,r,i;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(n=this).dragEventer,i=n.dragProxy,n.dragEnd(t),!t.valid){e.next=5;break}return e.next=5,n.dragDrop(t);case 5:null==i||i.dragEnd(t),null==r||r.trigger(t.valid?"drop":"dragCancel",{drag:t,event:t.event}),n.finalizeDrag(t);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"finalizeDrag",value:(t=Wr()(Vr.a.mark((function e(t){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.finalize();case 2:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"moveDrag",value:function(e){if(!1!==this.dragOver(e)){var t=this.dragEventer,n=this.dragProxy;null==n||n.dragMove(e),null==t||t.trigger("drag",{drag:e,event:e.event})}}},{key:"setupDragContext",value:function(e){var t=this.dragItemSelector,n=e.target;return{event:e,itemElement:t?n.closest(t):n,touchStartDelay:this.dragTouchStartDelay,source:this,threshold:this.dragThreshold}}},{key:"startDrag",value:function(e){var t=this.draggingStartedCls,n=this.draggingClassElement,r=this.draggingItemCls,i=this.dragEventer,o=this.dragProxy,a=e.itemElement;if(!1===(null==i?void 0:i.trigger("beforeDragStart",{drag:e,event:e.event})))return!1;t&&n&&(n.classList.add(t),e.cleaners.push((function(){return n.classList.remove(t)}))),r&&a&&(a.classList.add(r),e.cleaners.push((function(){return a.classList.remove(r)}))),null==o||o.dragStart(e),this.dragStart(e),null==i||i.trigger("dragStart",{drag:e,event:e.event})}},{key:"trackDrag",value:function(e){var t,n=this.dropTargetSelector;e.valid=!(n&&!(null===(t=e.targetElement)||void 0===t?void 0:t.closest(n))),this.moveDrag(e)}},{key:"updateDragging",value:function(e){if(e){var t=an.assign({thisObj:this},this.dragDocumentListeners);"touches"in e.startEvent?(delete t.mousemove,delete t.mouseup):(delete t.contextmenu,delete t.touchmove,delete t.touchend,delete t.pointerup),e.cleaners.push(nu.on(t)),this.beginDrag(e)}}},{key:"changeDragProxy",value:function(e,t){return Hc.reconfigure(t,e,{owner:this,defaults:{owner:this}})}},{key:"updateDragRootElement",value:function(e){var t;null===(t=this._dragRootDetacher)||void 0===t||t.call(this),this._dragRootDetacher=e&&nu.on({thisObj:this,element:e,mousedown:"onDragMouseDown",touchstart:"onDragTouchStart"})}},{key:"onDragContextMenu",value:function(e){e.preventDefault()}},{key:"onDragKeyDown",value:function(e){this.dragging.keyDown(e)}},{key:"onDragKeyUp",value:function(e){this.dragging.keyUp(e)}},{key:"onDragMouseDown",value:function(e){0===e.button&&this.onDragPointerDown(e)}},{key:"onDragPointerDown",value:function(e){var t=this.dragging;t?t.isFinalizing||t.abort():(t=new _c(this.setupDragContext(e))).begin()}},{key:"onDragPointerMove",value:function(e){var t=this.dragging;t&&!t.completed&&(null==t||t.move(e))}},{key:"onDragPointerUp",value:function(e){var t=this.dragging;t&&!t.completed&&(t.end(e),this.endDrag(t))}},{key:"onDragTouchStart",value:function(e){1===e.touches.length&&this.onDragPointerDown(e)}},{key:"activeDrag",get:function(){var e=this.dragging;return(null==e?void 0:e.started)&&!e.completed?e:null}},{key:"dragEventer",get:function(){return this.callPreventable?this:null}},{key:"draggingClassElement",get:function(){var e=this.draggingClsSelector,t=this.dragRootElement;return e?null==t?void 0:t.closest(e):t}}],[{key:"$name",get:function(){return"Draggable"}},{key:"configurable",get:function(){return{dragging:null,draggingClsSelector:null,dragDocumentListeners:{element:document,keydown:"onDragKeyDown",keyup:"onDragKeyUp",contextmenu:"onDragContextMenu",mousemove:"onDragPointerMove",mouseup:"onDragPointerUp",pointerup:"onDragPointerUp",touchend:"onDragPointerUp",touchmove:{handler:"onDragPointerMove",passive:!1}},dragItemSelector:null,dragLock:null,dragMinDistance:1,dragProxy:{$config:["lazy","nullify"],value:null},dragRootElement:{$config:"nullify",value:null},dragSameTargetDrop:!1,dragSelector:null,dragSwallowClickTime:50,dragThreshold:5,dragTouchStartDelay:300,dropTargetSelector:null,testConfig:{dragSwallowClickTime:j.a.isEdge?300:50}}}},{key:"properties",get:function(){return{draggingCls:"b-draggable-active",draggingBodyCls:"b-draghelper-active",draggingItemCls:"b-dragging-item",draggingStartedCls:"b-draggable-started"}}}]),i}(e||ue)};function Vc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var zc=function(e){return function(e){fe()(n,e);var t=Vc(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"dragEnter",value:function(e){}},{key:"dragMove",value:function(e){}},{key:"dragDrop",value:function(e){}},{key:"dragLeave",value:function(e){}},{key:"changeDropping",value:function(e,t){if(e!==t){t&&(!t.aborted&&t.completed||this.dragLeave(t)),e&&(this._dropping=e,!1===this.dragEnter(e)&&(e=null),this._dropping=t)}return e}},{key:"updateDropRootElement",value:function(e,t){var n=this.droppableCls;t&&(t.classList.remove(n),qo.get(t,"droppable")===this&&qo.remove(t,"droppable")),e&&(e.classList.add(n),qo.set(e,"droppable",this))}},{key:"droppableCls",get:function(){return"b-droppable"}}],[{key:"$name",get:function(){return"Droppable"}},{key:"configurable",get:function(){return{dropping:null,dropRootElement:{$config:"nullify",value:null}}}}]),n}(e||ue)};function Wc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var Gc=Symbol("pendingCreate"),Yc=function(e){fe()(n,e);var t=Wc(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"define",value:function(e,t){this.instances[e]=Gc,this.setDefaults(e,t),this.defineProp(e,!0)}},{key:"defineProp",value:function(e,t){var n=this,r=n.object;n.proxy||Reflect.defineProperty(t?Object.getPrototypeOf(r):r,e,{configurable:!t,enumerable:!t,get:function(){return n.get(e)},set:function(t){return n.set(e,t)}})}},{key:"flush",value:function(){for(var e in this.defaults)this.get(e)}},{key:"get",value:function(e){var t=this.defaults,n=this.instances;return n[e]===Gc&&this.set(e,Gc),n[e]||t[e]&&null}},{key:"set",value:function(e,t){var n,r=this,i=r.defaults,o=r.factory,a=r.instances,s=r.setup,u=a[e]===Gc?null:a[e],c=o.reconfigure(u,t===Gc?{}:t||null,{defaults:i[e]||r.setDefaults(e,{}),owner:r.owner,setup:s&&function(t,n,r){return s(t,e,n,r)}});c!==u&&(a[e]=c,c?(r.defineProp(e),null===(n=r.created)||void 0===n||n.call(r,c,e)):(delete r.object[e],delete a[e]))}},{key:"setDefaults",value:function(e,t){var n=this.defaults,r=this.factory,i=this.inferType,o=this.instances,a=this.owner,s=this.ownerName,u=r.factoryable.typeKey;return t=!0===t?{}:an.assign({},t),("name"===i||!0===i&&!t[u])&&(t[u]=e),s&&(t[s]=a),t.beforeConfigure=function(t){o[e]=t},n[e]=t}},{key:"update",value:function(e){var t,n,r=this;if(e)for(t in e)n=e[t],r.defaults[t]?r.set(t,n):n&&r.define(t,n);else for(t in r.instances)r.set(t,null)}},{key:"proxy",get:function(){var e=this,t=null;return e.proxyable&&(t=new Proxy(e.instances,{get:function(t,n){return e.get(n)},set:function(t,n,r){return e.set(n,r),!0},deleteProperty:function(t,n){return e.set(n,null),!0}})),Reflect.defineProperty(e,"proxy",{configurable:!0,value:t}),t}},{key:"target",get:function(){return this.proxy||this.object}}],[{key:"prototypeProperties",get:function(){return{created:null,factory:null,inferType:"name",owner:null,ownerName:null,proxyable:"undefined"!=typeof Proxy,setup:null}}},{key:"properties",get:function(){return{defaults:{},instances:{},object:Object.create({})}}}]),n}(ue);function Uc(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function qc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Yc.initClass(),Yc._$name="DynamicObject";var Kc,Xc=function(e){return function(e){fe()(n,e);var t=qc(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"afterConfigure",value:function(){var e;we()(pe()(n.prototype),"afterConfigure",this).call(this),null===(e=this.$features)||void 0===e||e.flush()}},{key:"doDestroy",value:function(){this.features=null,we()(pe()(n.prototype),"doDestroy",this).call(this)}},{key:"hasFeature",value:function(e){var t;return Boolean(null===(t=this.features)||void 0===t?void 0:t[e])}},{key:"changeFeatures",value:function(e){var t=this,n=t.constructor.featureable,r=t.$features||(t.$features=new Yc({factory:n.factory,owner:t,ownerName:n.ownerName}));return r.update(e),t.isConfiguring||r.flush(),r.target}},{key:"widgetClass",get:function(){}}],[{key:"setupFeatureable",value:function(e){var t=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Uc(Object(n),!0).forEach((function(t){ke()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Uc(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({ownerName:"client"},e.featureable);t.factory.initClass(),Reflect.defineProperty(e,"featureable",{get:function(){return t}})}},{key:"$name",get:function(){return"Featureable"}},{key:"configurable",get:function(){return{features:null}}},{key:"declarable",get:function(){return["featureable"]}}]),n}(e||ue)};function Zc(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var Jc="b-hover-edge",Qc="b-hover-top",el="b-hover-right",tl="b-hover-bottom",nl="b-hover-left",rl=(Kc={},ke()(Kc,Jc,1),ke()(Kc,Qc,1),ke()(Kc,el,1),ke()(Kc,tl,1),ke()(Kc,nl,1),Kc),il={t:[Jc,Qc],r:[Jc,el],b:[Jc,tl],l:[Jc,nl],tr:[Jc,Qc,el],bl:[Jc,tl,nl],tl:[Jc,Qc,nl],br:[Jc,tl,el]},ol=function(e){return function(e){fe()(n,e);var t=Zc(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"hoverEnter",value:function(e){}},{key:"hoverIgnore",value:function(e){var t;return null===(t=this.hoverIgnoreElement)||void 0===t?void 0:t.contains(e)}},{key:"hoverLeave",value:function(e){}},{key:"hoverMove",value:function(e){}},{key:"onHoverMouseMove",value:function(e){var t=this,n=t.hoverEdges,r=t.hoverEdgeSize,i=t.hoverTarget;if(i){if(n){var o=i.getBoundingClientRect(),a=o.top,s=o.left,u=o.width,c=o.height,l=o.right,f=o.bottom,d=e.clientX,h=e.clientY,v=s+u/2,p=a+c/2,g=h<(r?a+r:p),y=d>=(r?l-r:v),m=g||h>=(r?f-r:p)?g?"t":"b":"",k=y||d<(r?s+r:v)?y?"r":"l":"";t.hoverZone=(n.includes(m)?m:"")+(n.includes(k)?k:"")}t.hoverEvent=e,t.hoverTrack&&t.hoverMove(e)}}},{key:"onHoverMouseOver",value:function(e){this.hoverEvent=e,this.hoverElement=e.target}},{key:"onHoverMouseOut",value:function(e){this.hoverEvent=e,this.hoverElement=e.relatedTarget}},{key:"updateHoverDelay",value:function(e){this.setHoverTarget.delay=e}},{key:"changeHoverEdges",value:function(e){return!0===e?"trbl":(e||"").replace("v","tb").replace("h","lr")}},{key:"updateHoverEdges",value:function(){this.syncHoverListeners()}},{key:"changeHoverElement",value:function(e){if(!this.hoverIgnore(e))return e}},{key:"updateHoverElement",value:function(e){var t,n=this.hoverSelector;n&&(e=null===(t=e)||void 0===t?void 0:t.closest(n));this.setHoverTarget(e)}},{key:"updateHoverRootElement",value:function(e,t){var n=this.hoverRootCls;n&&(null==t||t.classList.remove(n),null==e||e.classList.add(n)),this.syncHoverListeners()}},{key:"changeHoverTarget",value:function(e,t){return t&&(this.hoverZone=null),e}},{key:"updateHoverTarget",value:function(e,t){var n=this,r=n.hoverCls,i=n.hoverAnimationCls,o=n.hoverRootActiveCls,a=n.hoverRootElement;o&&(null==a||a.classList[e?"add":"remove"](o)),t&&(r&&t.classList.remove(r),i&&t.classList.remove(i),n.hoverLeave(t)),e&&(r&&e.classList.add(r),n.hoverEnter(t),n.hoverTrack&&n.hoverMove(n.hoverEvent),i&&(e.getBoundingClientRect(),e.classList.add(i)))}},{key:"updateHoverTrack",value:function(){this.syncHoverListeners()}},{key:"updateHoverZone",value:function(e){var t=this.hoverAnimationCls,n=this.hoverTarget;if(n){var r=n.className,i=An.change(r,e?il[e]:null,rl);r!==i&&(n.className=i,e&&t&&(n.classList.remove(t),n.getBoundingClientRect(),n.classList.add(t)))}}},{key:"setHoverTarget",value:function(e){this.hoverTarget=e}},{key:"syncHoverListeners",value:function(){var e,t=this,n=t.hoverRootElement,r={element:n,thisObj:t,mouseover:"onHoverMouseOver",mouseout:"onHoverMouseOut"};(t.hoverTrack||t.hoverEdges)&&(r.mousemove="onHoverMouseMove"),null===(e=t._hoverRootDetacher)||void 0===e||e.call(t),t._hoverRootDetacher=n&&nu.on(r)}}],[{key:"$name",get:function(){return"Hoverable"}},{key:"configurable",get:function(){return{hoverCls:null,hoverAnimationCls:null,hoverRootCls:null,hoverRootActiveCls:null,hoverDelay:null,hoverElement:null,hoverIgnoreElement:null,hoverEdges:null,hoverEdgeSize:10,hoverRootElement:{$config:"nullify",value:null},hoverSelector:null,hoverTarget:{$config:"nullify",value:null},hoverTrack:null,hoverZone:null}}},{key:"delayable",get:function(){return{setHoverTarget:0}}}]),n}(e.mixin(_a))},al={constructor:1,prototype:1,name:1,length:1,arguments:1,caller:1,callee:1,__proto__:1},sl=function(){function e(){v()(this,e)}return g()(e,null,[{key:"apply",value:function(e){if(!e.target)throw new Error("Override must specify what it overrides, using static getter target");if(!e.target.class)throw new Error("Override must specify which class it overrides, using target.class");if(!this.shouldApplyOverride(e))return!1;var t=Object.getOwnPropertyNames(e),n=Object.getOwnPropertyNames(e.prototype);return t.splice(t.indexOf("target"),1),this.internalOverrideAll(e.target.class,t,e),this.internalOverrideAll(e.target.class.prototype,n,e.prototype),!0}},{key:"internalOverrideAll",value:function(e,t,n){var r=this;Reflect.ownKeys(n).forEach((function(i){if(t.includes(i)&&!al[i]){for(var o=Object.getOwnPropertyDescriptor(n,i),a=e,s=null;!s&&a;)(s=Object.getOwnPropertyDescriptor(a,i))||(a=Object.getPrototypeOf(a));s&&r.internalOverride(a,i,o,s)}}))}},{key:"internalOverride",value:function(e,t,n,r){(e._overridden=e._overridden||{})[t]=e[t],r.get?Object.defineProperty(e,t,{enumerable:!1,configurable:!0,get:n.get}):e[t]=n.value}},{key:"shouldApplyOverride",value:function(e){var t=e.target;if(!t.maxVersion&&!t.minVersion)return!0;if(!t.product)throw new Error("Override must specify product when using versioning");return(!t.maxVersion||!y.a[t.product].isNewerThan(t.maxVersion))&&(!t.minVersion||!y.a[t.product].isOlderThan(t.minVersion))}}]),e}();function ul(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}sl._$name="Override";var cl=function(e){fe()(n,e);var t=ul(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"doDestroy",value:function(){this.mousedownRemover&&this.mousedownRemover(),we()(pe()(n.prototype),"doDestroy",this).call(this)}},{key:"onMouseDown",value:function(e){var t=this,n=t.delegate?e.target.closest(t.delegate):t.element;n&&(t.triggerEvent=e,nu.lockComposedPath(t.triggerEvent),t.activeListenerRemover=nu.on({mouseup:{element:document,handler:"onMouseUp"},mousemove:{element:n,handler:"onTargetMouseMove"},mouseleave:{element:n,handler:"onTargetMouseLeave"},mouseenter:{element:n,handler:"onTargetMouseEnter"},thisObj:t}),t.setTimeout("startAutoRepeat",t.delay))}},{key:"onMouseUp",value:function(e){var t=this;t.acceleration&&t.acceleration.cancel(),t.activeListenerRemover&&t.activeListenerRemover(),t.clearTimeout("startAutoRepeat"),t.clearTimeout(t.repeatTimer)}},{key:"onTargetMouseLeave",value:function(){this.clearInterval(this.repeatTimer)}},{key:"onTargetMouseEnter",value:function(e){this.triggerEvent=e,this.fireClick()}},{key:"onTargetMouseMove",value:function(e){this.triggerEvent=e}},{key:"startAutoRepeat",value:function(){var e=this;e.interval=e.startInterval=1e3/e.startRate,e.accelerationDelta=e.startInterval-1e3/e.endRate,e.fireClick(),e.acceleration=xe.animate(e.accelerateDuration,e.nextTick,e,"easeOutQuad")}},{key:"nextTick",value:function(e){this.interval=this.startInterval-this.accelerationDelta*e}},{key:"fireClick",value:function(){var e=this,t=new MouseEvent("click",e.triggerEvent);e.triggerEvent.target.dispatchEvent(t),e.repeatTimer=e.setTimeout(e.fireClick,e.interval)}},{key:"element",set:function(e){this._element=e,this.mousedownRemover=nu.on({element:e,mousedown:"onMouseDown",thisObj:this})},get:function(){return this._element}}],[{key:"defaultConfig",get:function(){return{element:null,delegate:null,delay:500,startRate:2,endRate:20,accelerateDuration:4e3}}}]),n}(_a(ue));function ll(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}cl._$name="ClickRepeater";var fl=function(e){fe()(n,e);var t=ll(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"changeAlign",value:function(e){return e}},{key:"template",value:function(){return'<button class="b-icon b-align-'.concat(this.align||"end",'"></button>')}},{key:"construct",value:function(e){we()(pe()(n.prototype),"construct",this).call(this,e),nu.on({element:this.element,click:"onClick",thisObj:this})}},{key:"onClick",value:function(e){var t=this.handler,n=this.panel;!1!==n.trigger("toolclick",{domEvent:e,tool:this})&&t&&this.callback(t,n,[e])}},{key:"onInternalKeyDown",value:function(e){"Enter"===(e.key.trim()||e.code)&&(e.cancelBubble=!0,e.stopPropagation())}},{key:"focusElement",get:function(){return this.element}},{key:"panel",get:function(){return this.parent}}],[{key:"$name",get:function(){return"Tool"}},{key:"type",get:function(){return"tool"}},{key:"configurable",get:function(){return{align:{value:null,$config:{merge:"replace"}}}}}]),n}(oc);function dl(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}fl.initClass(),fl._$name="Tool";var hl=function(e){fe()(n,e);var t=dl(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"onChildAdd",value:function(e){}},{key:"onChildRemove",value:function(e){}},{key:"renderChildren",value:function(){var e=this.owner,t=this.containerCls,n=this.itemCls,r=e.contentElement,i=e.items,o=e.itemCls,a=i&&i.length;if(r.classList.add("b-content-element"),t&&r.classList.add(t),a){e.textContent=!1;for(var s=0;s<a;s++){var u=i[s],c=u.element;c.dataset.itemIndex=s,n&&c.classList.add(n),o&&c.classList.add(o),c.classList.remove("b-outer"),u.render(r,Boolean(e.isPainted))}}this.syncChildCount()}},{key:"removeChild",value:function(e){var t=e.element,n=this.owner,r=this.itemCls,i=n.contentElement,o=n.itemCls;i.removeChild(t),delete t.dataset.itemIndex,r&&t.classList.remove(r),o&&t.classList.remove(o),this.fixChildIndices(),this.syncChildCount()}},{key:"appendChild",value:function(e){var t=e.element,n=this.owner.indexOfChild(e),r=this.owner,i=this.itemCls,o=r.contentElement,a=r.itemCls;t.dataset.itemIndex=n,r.textContent=!1,i&&t.classList.add(i),a&&t.classList.add(a),e.render(o,Boolean(r.isPainted)),this.syncChildCount()}},{key:"insertChild",value:function(e,t){var n=e.element,r=this.owner,i=this.itemCls,o=r.contentElement,a=o.querySelector('[data-item-index="'.concat(t,'"]')),s=r.itemCls;r.textContent=!1,i&&n.classList.add(i),s&&n.classList.add(s),o.insertBefore(n,a),e.render(null,Boolean(r.isPainted)),this.fixChildIndices(),this.syncChildCount()}},{key:"fixChildIndices",value:function(){this.owner.items.forEach((function(e,t){e.element.dataset.itemIndex=t}))}},{key:"syncChildCount",value:function(){var e=this.owner,t=e.items.length;e.contentElement.classList[1===t?"add":"remove"]("b-single-child")}}],[{key:"getLayout",value:function(e,t){if(e instanceof n)return e.owner=this,e;var r={owner:t};return"string"==typeof e?r.type=e:an.assign(r,e),new vl[r.type||"default"](r)}},{key:"registerLayout",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.$$name.toLowerCase();vl[t]=e}},{key:"configurable",get:function(){return{containerCls:"b-auto-container",itemCls:null}}}]),n}(Ge(ue)),vl={default:hl};function pl(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}hl._$name="Layout";var gl=0,yl=function(e){return e.ripple},ml=window.Ripple=new(function(e){fe()(n,e);var t=pl(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"afterConstruct",value:function(){we()(pe()(n.prototype),"afterConstruct",this).call(this),nu.on({element:document,mousedown:"onRippleControllingEvent",thisObj:this,capture:!0,once:!0})}},{key:"onRippleControllingEvent",value:function(e){var t=this;t.show();var n=Cr.getStyleValue(t.circleElement,"animationName");t.hide(),t.listenerDetacher&&t.listenerDetacher(),n&&"none"!==n&&(t.listenerDetacher=nu.on({mousedown:{element:document,capture:!0,handler:"onDocumentMousedown"},touchstart:{element:document,capture:!0,handler:"onDocumentTouchStart"},animationend:{element:t.circleElement,handler:"onAnimationEnd"},thisObj:t}),"mousedown"===e.type&&(t.onDocumentMousedown(e),$r.on({theme:"onRippleControllingEvent",thisObj:this})))}},{key:"onDocumentTouchStart",value:function(e){gl=performance.now(),this.handleTriggerEvent(e)}},{key:"onDocumentMousedown",value:function(e){performance.now()-gl>200&&this.handleTriggerEvent(e)}},{key:"handleTriggerEvent",value:function(e){var t=oc.fromElement(e.target,yl);if(t){var n=t.ripple,r=n.delegate?e.target.closest(n.delegate):t.focusElement||t.element;if(r){var i=an.assign({event:e,target:r,radius:this.radius},n);if("string"==typeof i.clip&&(i.clip=t[i.clip]||e.target.closest(i.clip),!i.clip))return;this.ripple(i)}}}},{key:"ripple",value:function(e){var t=e.event,n=e.point,r=void 0===n?nu.getClientPoint(t):n,i=e.target,o=void 0===i?t.target:i,a=e.clip,s=void 0===a?o:a,u=e.radius,c=void 0===u?this.radius:u,l=e.color,f=void 0===l?this.color:l;this.clip=s,s=En.from(s,null,!0);var d=this,h=s.getDelta(r),v=d.rippleElement.style,p=d.circleElement;d.hide(),d.alignTo(s),v.transform="translateX(".concat(h[0],"px) translateY(").concat(h[1],"px)"),v.height=v.width="".concat(c,"px"),p.setAttribute("r",c),p.setAttribute("fill",f),d.show(),d.requestAnimationFrame((function(){document.addEventListener("scroll",d.callRealign,!0),d.documentScrollListener=!0}))}},{key:"alignTo",value:function(e){1===e.nodeType&&(e=En.from(e,null,!0));var t=e,n=t.x,r=t.y,i=t.width,o=t.height;this.x=n,this.y=r,this.height=o,this.width=i}},{key:"onAnimationEnd",value:function(e){"b-ripple-expand"===e.animationName&&this.hide()}},{key:"realign",value:function(){this.isVisible&&this.alignTo(this.clip)}}],[{key:"defaultConfig",get:function(){return{id:"bryntum-ripple",old_element:{children:[{className:"b-ripple-inner",reference:"rippleElement"}]},element:{children:[{tag:"svg",class:"b-ripple-inner",reference:"rippleElement",ns:"http://www.w3.org/2000/svg",version:"1.1",viewBox:"0 0 100 100",children:[{reference:"circleElement",tag:"circle",cx:"0",cy:"0",r:10}]}]},floating:!0,hideAnimation:!1,showAnimation:!1,scrollAction:"realign",color:"rgba(0,0,0,.3)",startRadius:10,radius:100}}},{key:"$name",get:function(){return"Ripple"}}]),n}(oc));function kl(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var bl=Object.freeze({}),wl=Object.freeze([]),Cl=function(e){return e.weight},Sl=function(e,t){var n=e.weight,r=t.weight;return"string"==typeof n||"string"==typeof r?String(n).localeCompare(String(r)):(null!=n?n:Number.MAX_SAFE_INTEGER)-(null!=r?r:Number.MAX_SAFE_INTEGER)},Dl=function(e){return!e.hidden},Rl=function(e){fe()(n,e);var t=kl(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"startConfigure",value:function(e){var t=e.items||e.lazyItems;this.hasItems=Boolean(t&&(Array.isArray(t)?t:Object.keys(t)).length),we()(pe()(n.prototype),"startConfigure",this).call(this,e)}},{key:"remove",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=!0;1===t.length&&(Array.isArray(t[0])?t=t[0]:r=!1);for(var i=this,o=i._items,a=[],s=0;s<t.length;s++){var u=t[s];o.includes(u)&&(o.remove(u),i.layout.removeChild(u),a.push(u),i.onChildRemove(u))}return r?a:a[0]}},{key:"removeAll",value:function(){return this.remove(this.items)}},{key:"add",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];var r=!0;1===t.length&&(Array.isArray(t[0])?t=t[0]:r=!1),this.items||(this.items=[]);for(var i=this,o=i._items,a=[],s=0;s<t.length;s++){var u=t[s];if(null!=u.weight){var c=De.findInsertionIndex(u,i._items.values,Sl);a.push(i.insert(u,c))}else u instanceof oc?u.parent=i:u=i.createWidget(u),o.includes(u)||(o.add(u),i.onChildAdd(u),i.layout.appendChild(u),a.push(u))}return r?a:a[0]}},{key:"insert",value:function(e,t){this.items||(this.items=[]);var n=this,r=n._items;e instanceof oc?e.parent=n:e=n.createWidget(e),r.includes(t)&&(t=n.indexOfChild(t)),t=Math.min(t,r.count);var i=r.values;return i.splice(t,0,e),r.values=i,n.onChildAdd(e),n.layout.insertChild(e,t),e}},{key:"indexOfChild",value:function(e){return this.items.indexOf(e)}},{key:"changeLazyItems",value:function(e){this.items=e,this.layout.renderChildren()}},{key:"changeItems",value:function(e){var t=[],n=new so;return Array.isArray(e)?this.processItemsArray(e,t):e&&this.processItemsObject(e,this.namedItems,t),t.some(Cl)&&t.sort(Sl),n.add(t),n}},{key:"updateItems",value:function(e){e.forEach(this.onChildAdd,this)}},{key:"updateHideWhenEmpty",value:function(){this.syncChildCount()}},{key:"processItemsArray",value:function(e,t){var n,r,i=e.length;for(n=0;n<i;n++)(r=e[n])instanceof oc?(r.parent=this,Cr.removeClasses(r.element,oc.outerCls)):r=this.createWidget(r),r&&t.push(r)}},{key:"processItemsObject",value:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:bl,i=arguments.length>2?arguments[2]:void 0;for(n in e)(t=e[n])&&(n in r&&(t="object"===l()(t)?an.merge(an.clone(r[n]),t):r[n]),t&&(t instanceof oc?t.parent=this:(t instanceof Object&&(t.ref=n),t=this.createWidget(t)),t&&(t.ref=n,i.push(t))))}},{key:"onChildAdd",value:function(e){var t=e.ref||e.id;if(this.readOnly&&(e.readOnly=!0),this.layout.onChildAdd(e),t)for(var n=this;n;n=n.parent)n.addDescendant(e,t);this.syncChildCount()}},{key:"onChildHide",value:function(){this.syncChildCount()}},{key:"onChildShow",value:function(){this.syncChildCount()}},{key:"syncChildCount",value:function(){if(!this.isConfiguring){var e=this,t=e.childItems,n=t.length,r=t.filter(Dl).length;if(e.hideWhenEmpty){var i=Boolean(!r);Boolean(e._hidden)!==i&&(e.hidden=i)}e.hasItems=Boolean(n),e.contentElement.classList[r?"remove":"add"]("b-no-visible-children"),e.updateTextContent(e._textContent)}}},{key:"addDescendant",value:function(e,t){var n=this._widgetMap||(this._widgetMap={});n[t]||(n[t]=e)}},{key:"onChildRemove",value:function(e){var t=e.ref||e.id;if(t)for(var n=this;n;n=n.parent)n.widgetMap[t]===e&&delete n.widgetMap[t];this.layout.onChildRemove(e),this.syncChildCount()}},{key:"changeRecord",value:function(e){return this._record=null==e?bl:null,e}},{key:"updateRecord",value:function(e){this.trigger("beforeSetRecord",{record:e}),this.setValues(e,!0,!this.$highlight)}},{key:"setRecord",value:function(e,t){this.$highlight=t,this.record=e,this.$highlight=!1}},{key:"onFieldChange",value:function(e){var t=e.source,n=e.userAction;if(this.autoUpdateRecord){var r=this.record,i=t.name,o=t.isValid,a=t.value;r&&n&&i&&o&&(r[i]=a)}}},{key:"getValues",value:function(e){for(var t=this.queryAll((function(e){return e.name})),n=t.length,r={},i=0;i<n;i++){var o=t[i],a=o.name;e&&!e(o)||(r[a]=o.value)}return r}},{key:"updateTextContent",value:function(e){this.contentElement.classList[e&&this.hasNoChildren?"add":"remove"]("b-text-content"),this.rendered&&this.realign()}},{key:"updateLayoutStyle",value:function(e){Cr.applyStyle(this.contentElement,e)}},{key:"changeLayout",value:function(e){return hl.getLayout(e,this)}},{key:"getWidgetById",value:function(e){return this.widgetMap[e]}},{key:"processWidgetConfig",value:function(e){}},{key:"setupWidgetConfig",value:function(e,t){"string"==typeof e?e={html:e}:1===e.nodeType&&(e={element:e,id:e.id}),("string"==typeof t||!t&&(t=e.type))&&(t=oc.resolveType(t,!0));for(var n=(e=(t||oc).mergeConfigs(this.defaults,e,{parent:this})).parent;n;n=n.parent)if(!1===n.processWidgetConfig(e))return null;return!1===this.trigger("beforeWidgetCreate",{widgetConfig:e})?null:e}},{key:"createWidget",value:function(e){return oc.create(this.setupWidgetConfig(e),this.defaultType)}},{key:"updateDefaults",value:function(e,t){if(!this.isConfiguring){var n=Object.entries(e);this.eachWidget((function(e){n.forEach((function(n){var r=ye()(n,2),i=r[0],o=r[1];e[i]===t[i]&&(e[i]=o)}))}),!1)}}},{key:"render",value:function(){this.getConfig("lazyItems"),this.layout.renderChildren(),this.syncChildCount(),we()(pe()(n.prototype),"render",this).apply(this,arguments)}},{key:"doDestroy",value:function(){var e=this._items;e&&e.forEach((function(e){return e.destroy&&e.destroy()})),we()(pe()(n.prototype),"doDestroy",this).call(this)}},{key:"setValues",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this._isSettingValues={preventHighlight:n},this.eachWidget((function(r){var i=r.highlightExternalChange,o=t?r.name:r.name||r.ref||r.id;"value"in r&&o&&(n&&(r.highlightExternalChange=!1),r.value=e&&o in e?e[o]:null,r.highlightExternalChange=i)}),!0),this._isSettingValues=!1}},{key:"items",get:function(){if(this.getConfig("lazyItems"),!this._items){if(this.initializingItems)return[];this.items=wl}return this._items.values}},{key:"widgetMap",get:function(){return this._widgetMap||(this._widgetMap={}),this.initializingItems||this.getConfig("items"),this._widgetMap}},{key:"hasNoChildren",get:function(){var e=this.initialConfig.lazyItems,t=e&&(Array.isArray(e)?e:Object.values(e));return!(t&&!this._items?t:this.items).filter(Dl).length}},{key:"childItems",get:function(){return this.items}},{key:"focusElement",get:function(){var e=this.query(this.defaultFocus||function(e){return e.isFocusable&&"close"!==e.ref});return e?e.focusElement:we()(pe()(n.prototype),"focusElement",this)}},{key:"isValid",get:function(){var e=!0;return this.eachWidget((function(t){"isValid"in t&&!t.isValid&&(e=!1)}),!0),e}},{key:"values",get:function(){var e={};return this.eachWidget((function(t){"value"in t&&(e[t.name||t.ref||t.id]=t.value)}),!0),e},set:function(e){this.setValues(e)}},{key:"isSettingValues",get:function(){var e;return Boolean(this._isSettingValues||(null===(e=this.parent)||void 0===e?void 0:e.isSettingValues))}}],[{key:"$name",get:function(){return"Container"}},{key:"type",get:function(){return"container"}},{key:"configurable",get:function(){return{items:null,lazyItems:{$config:["lazy"],value:null},defaults:null,defaultType:"widget",layoutStyle:null,itemCls:null,layout:"default",namedItems:null,textContent:!0,record:null,autoUpdateRecord:null,hideWhenEmpty:null}}}]),n}(oc);Rl.initClass(),Rl._$name="Container";var xl=n(15),El=n.n(xl);function Tl(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var Ml=function(e){return function(e){fe()(n,e);var t=Tl(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"updateBadge",value:function(e){var t=this.element;t&&(null!=e&&""!==e?(t.dataset.badge=e,t.classList.add("b-badge")):(t.dataset.badge&&delete t.dataset.badge,t.classList.remove("b-badge")))}},{key:"widgetClass",get:function(){if(this.badge)return"b-badge"}}],[{key:"$name",get:function(){return"Badge"}},{key:"configurable",get:function(){return{badge:null}}}]),n}(e||ue)};function Al(){var e=El()(["\n            <"," "," ",' class="'," ",'" ','>\n                <label data-reference="label"></label>\n            </',">\n        "],["\n            <"," "," ",' class="'," ",'" ','>\n                <label data-reference="label">\\xa0</label>\n            </',">\n        "]);return Al=function(){return e},e}function Pl(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var Il=/^b-icon-/,Ol=/^b-fa-/,Fl=function(e){fe()(n,e);var t=Pl(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"template",value:function(){var e=this,t=e.href?"a":"button";return Iu.tpl(Al(),t,"a"===t?'href="'.concat(e.href,'"'):"","a"===t&&e.target?'target="'.concat(e.target,'"'):"",e.color||"",e.toggleable&&e.pressed?"b-pressed":"",e.toggleGroup?'data-group="'.concat(e.toggleGroup,'"'):"",t)}},{key:"construct",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};(t.toggleGroup||t.menu)&&(t.toggleable=!0);for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];(e=we()(pe()(n.prototype),"construct",this)).call.apply(e,[this,t].concat(i)),nu.on({element:this.element,click:"onInternalClick",thisObj:this})}},{key:"onFocusOut",value:function(e){we()(pe()(n.prototype),"onFocusOut",this).call(this,e),this.menu&&this.menu.hide()}},{key:"changeText",value:function(e){return null==e?"":e}},{key:"updateText",value:function(e){var t=this.element;this.label.innerText=e,t.classList[String(e).length?"add":"remove"]("b-text")}},{key:"changeMenu",value:function(e,t){var n=this;if(e){var r=function(){return!n.isDestroying&&n.setTimeout((function(){return n.toggle(!1)}),n.onMenuHideTimeout)};e.isWidget?(e.forElement=n.element,e.on("hide",r)):("object"!==l()(e)||"type"in e||"items"in e||"widgets"in e||"html"in e||(e={lazyItems:e}),e=oc.reconfigure(t,e?F.merge({constrainTo:n.menuContainerElement,forElement:n.element,owner:n,onHide:r},n.menuDefaults,e):null,n))}else t&&t.destroy();return e}},{key:"updateMenu",value:function(e){this.toggleable=Boolean(e)}},{key:"updatePressed",value:function(e){var t=this;e&&t.toggleGroup&&Cr.forEachSelector("button[data-group=".concat(t.toggleGroup,"]"),(function(e){e!==t.element&&oc.getById(e.id).toggle(!1)})),t.element&&t.element.classList[e?"add":"remove"]("b-pressed")}},{key:"updateIcon",value:function(){this.syncIconCls()}},{key:"updatePressedIcon",value:function(){this.syncIconCls()}},{key:"updateIconAlign",value:function(e,t){var n=this.element.classList;t&&n.remove("b-icon-align-".concat(t)),this.icon&&n.add("b-icon-align-".concat(e))}},{key:"onInternalClick",value:function(e){var t=this,n={event:e};if(t.toggleable){if(t.toggleGroup&&t.pressed)return;if(t.toggle(!t.pressed),t.isDestroyed)return}t.trigger("click",n),t.isDestroyed||t.trigger("action",n),this.href||(e.preventDefault(),e.stopPropagation())}},{key:"toggle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this,n=t.menu;t.toggleable&&(null===e&&(e=!t.pressed),t.pressed=e,t.toggling=!0,n&&(n.minWidth=t.width,n[e?"show":"hide"]()),t.syncIconCls(),t.trigger("toggle",{pressed:e}),t.toggling=!1)}},{key:"syncIconCls",value:function(){var e=this,t=e._iconEl;if(e.icon){t||(t=e._iconEl=Cr.createElement({tag:"i",nextSibling:e.element.firstChild}));var n=e.pressed&&e.pressedIcon?e.pressedIcon:e.icon;e._iconEl.className=n,Il.test(n)?t.classList.add("b-icon"):Ol.test(n)&&t.classList.add("b-fa")}else t&&t.remove()}},{key:"childItems",get:function(){if(this._menu)return[this.menu]}},{key:"focusElement",get:function(){return this.element}},{key:"menuContainerElement",get:function(){return document.body}}],[{key:"$name",get:function(){return"Button"}},{key:"type",get:function(){return"button"}},{key:"configurable",get:function(){return{icon:null,pressedIcon:null,iconAlign:"start",text:"",color:null,toggleable:!1,pressed:!1,toggleGroup:null,ripple:{radius:75},defaultBindProperty:"text",localizableProperties:["text"],menu:{$config:["lazy","nullify"],value:null},menuDefaults:{type:"menu",autoShow:!1,autoClose:!0,floating:!0,scrollAction:"realign",align:"t0-b0"},href:null,target:null,onMenuHideTimeout:300,testConfig:{onMenuHideTimeout:0}}}}]),n}(Ml(oc));function Ll(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Fl.initClass(),Fl._$name="Button";var jl=function(e){fe()(n,e);var t=Ll(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"createWidget",value:function(e){"->"===e?e={type:"widget",cls:"b-toolbar-fill"}:"|"===e?e={type:"widget",cls:"b-toolbar-separator"}:"string"==typeof e&&(e={type:"widget",cls:"b-toolbar-text",html:e});var t=we()(pe()(n.prototype),"createWidget",this).call(this,e);return this.widgetCls&&t.element.classList.add(this.widgetCls),t}}],[{key:"$name",get:function(){return"Toolbar"}},{key:"type",get:function(){return"toolbar"}},{key:"configurable",get:function(){return{defaultType:"button",widgetCls:null,layout:"default"}}}]),n}(Rl);function _l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}jl.initClass(),jl._$name="Toolbar";var Bl=function(e){return!e.classList.contains("b-focus-trap")&&Cr.isFocusable(e)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP},Hl=function(e,t){return(e.weight||0)-(t.weight||0)},$l=function(e,t){return(t.weight||0)-(e.weight||0)};Bl.acceptNode=Bl;var Nl=function(e){fe()(n,e);var t=_l(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"changeTbar",value:function(e,t){return e?(Array.isArray(e)&&(e={items:e}),e.isWidget?e.parent=this:e=jl.reconfigure(t,jl.mergeConfigs({type:"toolbar",parent:this},e)),e&&(this.hasItems=this.hasItems||e.hasItems,Cr.addClasses(e.element,["b-top-toolbar","b-dock-".concat(e.dock||"top")]))):t&&t.destroy(),e}},{key:"changeBbar",value:function(e,t){return e?(Array.isArray(e)&&(e={items:e}),e.isWidget?e.parent=this:e=jl.reconfigure(t,jl.mergeConfigs({type:"toolbar",parent:this},e)),e&&(this.hasItems=this.hasItems||e.hasItems,Cr.addClasses(e.element,["b-bottom-toolbar","b-dock-".concat(e.dock||"bottom")]))):t&&t.destroy(),e}},{key:"updateTitle",value:function(e){var t=this.tools;this.headerElement&&(this.titleElement.innerHTML=e,this.headerElement.classList[e||t&&Object.values(t).some((function(e){return!e.hidden}))?"remove":"add"]("b-hide-display"))}},{key:"changeTools",value:function(e,t){var r={};if(e){for(var i in e)if(e[i]){var o=r[i]=n.create(an.assign({type:"tool",ref:i,parent:this},e[i]),this.defaultToolType||"tool");this.onChildAdd(o)}}else if(t)for(var a=0,s=Object.values(t);a<s.length;a++){s[a].destroy()}return r}},{key:"updateTrapFocus",value:function(e){var t=this;t.element.classList[e?"add":"remove"]("b-focus-trapped"),e?(t.focusTrapListener=nu.on({element:t.element,focusin:"onFocusTrapped",delegate:".b-focus-trap",thisObj:t}),t.treeWalker||(t.treeWalker=this.setupTreeWalker(t.element,NodeFilter.SHOW_ELEMENT,Bl,!1))):t.focusTrapListener&&(t.focusTrapListener(),t.focusTrapListener=null)}},{key:"setupTreeWalker",value:function(e,t,n,r){return document.createTreeWalker(e,t,n,r)}},{key:"onFocusTrapped",value:function(e){var t=this,n=t.treeWalker;e.target===t.bottomFocusTrap?(n.currentNode=t.topFocusTrap,n.nextNode()):(n.currentNode=t.bottomFocusTrap,n.previousNode()),t.requestAnimationFrame((function(){return n.currentNode.focus()}))}},{key:"element",set:function(e){var t=this,r=t.title&&(!t.parent||!t.parent.suppressChildHeaders),i=t.tools,o=t.footer,a=t.tbar,s=t.header||(i||r?{}:null),u=t.bbar||t.buttons,c=[{reference:"topFocusTrap",className:"b-focus-trap",tabIndex:0}],l=[],f=[],h={children:c};if((t.hasItems&&!1!==t.focusable||t.focusable)&&(h.tabIndex=0),s){var v="string"==typeof s?s:t.title||s.title,p=s.titleAlign||"start",g=t.classHierarchy(n).reduce((function(e,t){return e["b-".concat(t.$$name.toLowerCase(),"-header")]=1,e}),"string"==typeof s.cls?ke()({},s.cls,1):s.cls||{}),y=[{reference:"titleElement",className:"b-header-title b-align-".concat(p),html:v}];for(var m in i){var k=i[m];"start"===k.align?l.unshift(k):f.push(k)}l.sort(Hl),f.sort($l),y.unshift.apply(y,d()(l.map((function(e){return e.element})))),y.push.apply(y,d()(f.map((function(e){return e.element})))),g["b-hide-display"]=!(v||i&&Object.values(i).some((function(e){return!e.hidden}))),g["b-dock-".concat(s.dock||"top")]=1,c.push({tag:"header",reference:"headerElement",className:g,children:y})}a&&(a.layout.renderChildren(),c.push(a.element)),c.push(t.bodyConfig),u&&(u.layout.renderChildren(),c.push(u.element)),o&&c.push({tag:"footer",reference:"footerElement",className:"b-dock-".concat(o.dock||"bottom"," ").concat(o.cls||"")}),c.push({reference:"bottomFocusTrap",className:"b-focus-trap",tabIndex:0}),sc()(pe()(n.prototype),"element",h,this,!0)},get:function(){return we()(pe()(n.prototype),"element",this)}},{key:"bodyConfig",set:function(e){this._bodyConfig=e},get:function(){return an.merge({},this._bodyConfig,{reference:"bodyElement",className:this.classHierarchy(n).reduce((function(e,t){return e["b-".concat(t.$$name.toLowerCase(),"-content")]=1,e}),{}),html:this.html})}},{key:"childItems",get:function(){var e=this,t=e.items?e.items.slice():[];return e.tools&&t.unshift.apply(t,d()(Object.values(e.tools))),e.tbar&&t.unshift(e.tbar),e.bbar&&t.push(e.bbar),t}},{key:"focusElement",get:function(){return this.hasItems&&(we()(pe()(n.prototype),"focusElement",this)||this.element)}},{key:"contentElement",get:function(){return this.element&&this.bodyElement}},{key:"widgetClassList",get:function(){var e=this,t=we()(pe()(n.prototype),"widgetClassList",this),r=e.header;return(r||e.title||e.tools)&&t.push("b-panel-has-header b-header-dock-".concat(r&&r.dock||"top")),e.tbar&&t.push("b-panel-has-top-toolbar"),e.bbar&&t.push("b-panel-has-bottom-toolbar"),t}}],[{key:"$name",get:function(){return"Panel"}},{key:"type",get:function(){return"panel"}},{key:"configurable",get:function(){return{localizableProperties:["title"],trapFocus:null,title:null,header:null,footer:null,tools:{$config:{nullify:!0},value:null},tbar:{$config:{nullify:!0,merge:"objects"},value:null},bbar:{$config:{nullify:!0,merge:"objects"},value:null}}}}]),n}(Rl);function Vl(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Nl.initClass(),Nl._$name="Panel";var zl=function(e){fe()(n,e);var t=Vl(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"finalizeInit",value:function(){var e=this;e.anchoredTo=e.forElement,e.initialAnchor=e.anchor,e.forElement&&e.showOnClick&&(e.initialConfig.autoShow||(e.autoShow=!1),nu.on({element:e.forElement,click:"onElementUserAction",thisObj:e})),we()(pe()(n.prototype),"finalizeInit",this).call(this),e.autoShow&&(!0===e.autoShow?e.show():e.setTimeout((function(){return e.show()}),e.autoShow))}},{key:"doDestroy",value:function(){this.syncModalMask(),we()(pe()(n.prototype),"doDestroy",this).call(this)}},{key:"close",value:function(){var e=this;if(!e._hidden&&!1!==e.trigger("beforeClose")||e._hidden&&"destroy"===e.closeAction)return e.containsFocus&&e.highlightReturnedFocus&&e.setTimeout((function(){return document.body.classList.add("b-using-keyboard")}),0),e[e.closeAction]()}},{key:"onInternalKeyDown",value:function(e){"Escape"===e.key&&(e.stopImmediatePropagation(),this.close(!0))}},{key:"onDocumentMouseDown",value:function(e){var t=e.event,r=this;r.modal&&t.target===n.modalMask?(t.preventDefault(),r.modal.closeOnMaskTap?r.close():r.containsFocus||r.focus()):r.owns(t.target)||!r.autoClose||r.containsFocus||r.close()}},{key:"onFocusIn",value:function(e){var t=Cr.activeElement;we()(pe()(n.prototype),"onFocusIn",this).call(this,e),Cr.activeElement===t&&e.target===this.element&&this.focus()}},{key:"onFocusOut",value:function(e){!this.modal&&this.autoClose&&this.close(),we()(pe()(n.prototype),"onFocusOut",this).call(this,e)}},{key:"onShow",value:function(){var e=this;e.autoClose&&e.addDocumentMouseDownListener(),e.focusOnToFront&&e.focus(),we()(pe()(n.prototype),"onShow",this)&&we()(pe()(n.prototype),"onShow",this).call(this),e.syncModalMask()}},{key:"addDocumentMouseDownListener",value:function(){this.mouseDownRemover||(this.mouseDownRemover=$r.on({globaltap:"onDocumentMouseDown",thisObj:this}))}},{key:"syncModalMask",value:function(){var e=this;if(e.modal&&e.isVisible)e._x||e._y||(e.centered=!0),e.modalMask.classList.remove("b-hide-display"),e.element.classList.add("b-modal");else{e.element.classList.remove("b-modal");var t=e.constructor.floatRoot.querySelectorAll(".b-modal"),r=t.length?n.fromElement(t[t.length-1],"popup"):null;r?r.syncModalMask():n.modalMask.classList.add("b-hide-display")}}},{key:"onHide",value:function(){this.mouseDownRemover&&(this.mouseDownRemover(),this.mouseDownRemover=null),we()(pe()(n.prototype),"onHide",this)&&we()(pe()(n.prototype),"onHide",this).call(this),this.syncModalMask()}},{key:"onElementUserAction",value:function(){this.show()}},{key:"updateClosable",value:function(e){this.tools.close[e?"show":"hide"](),this.title||this.headerElement.classList[Object.values(this.tools).some((function(e){return!e.hidden}))?"remove":"add"]("b-hide-display")}},{key:"updateTextContent",value:function(e){this.element.classList[e&&this.hasNoChildren?"add":"remove"]("b-text-popup"),we()(pe()(n.prototype),"updateTextContent",this).call(this,e)}},{key:"isTopModal",get:function(){return Cr.isVisible(n.modalMask)&&this.element.previousElementSibling===n.modalMask}},{key:"modalMask",get:function(){var e=n.modalMask;return e.nextElementSibling!==this.element&&n.floatRoot.insertBefore(e,this.element),e}}],[{key:"$name",get:function(){return"Popup"}},{key:"type",get:function(){return"popup"}},{key:"configurable",get:function(){return{autoShow:!0,autoClose:!0,showOnClick:!1,forElement:null,monitorResize:!0,floating:!0,hidden:!0,axisLock:!0,hideAnimation:j.a.isIE11?null:{opacity:{from:1,to:0,duration:".3s",delay:"0s"}},showAnimation:j.a.isIE11?null:{opacity:{from:0,to:1,duration:".4s",delay:"0s"}},testConfig:{hideAnimation:null,showAnimation:null},closeAction:"hide",trapFocus:!0,focusOnToFront:!0,closable:null,modal:null,tools:{close:{cls:"b-popup-close",handler:"close",weight:-1e3,hidden:!0}},highlightReturnedFocus:!0}}},{key:"modalMask",get:function(){return this._modalMask||(this._modalMask=Cr.createElement({className:"b-modal-mask b-hide-display"}))}}]),n}(Nl);function Wl(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}zl.initClass(),zl._$name="Popup";var Gl,Yl,Ul={left:!0,right:!0,top:!0,bottom:!0,transform:!0},ql={true:1,false:1},Kl=function(e){fe()(o,e);var t,n,r,i=Wl(o);function o(){return v()(this,o),i.apply(this,arguments)}return g()(o,[{key:"afterConstruct",value:function(){var e=this;e.forSelector&&(e.showOnHover=!0,e.forElement||(e.trackMouse=!0,e.forElement=o.listenersTarget)),we()(pe()(o.prototype),"afterConstruct",this).call(this),e.forElement&&e.showOnHover&&(e.pointerOverOutDetacher=nu.on({element:e.forElement,mouseover:"internalOnPointerOver",mouseout:"internalOnPointerOut",thisObj:e})),e.autoShow&&e.show(),e.allowOver&&nu.on({element:e.element,mouseenter:"onOwnElementMouseEnter",mouseleave:"internalOnPointerOut",thisObj:e})}},{key:"doDestroy",value:function(){this.pointerOverOutDetacher&&this.pointerOverOutDetacher(),we()(pe()(o.prototype),"doDestroy",this).call(this)}},{key:"updateAnchorToTarget",value:function(e){e||(this.anchor=!1)}},{key:"onDocumentMouseDown",value:function(e){var t=e.event,n=this.triggeredByEvent;n&&Cr.isTouchEvent&&t.pageX===n.pageX&&t.pageY===n.pageY&&this.activeTarget.contains(t.target)&&performance.now()-n.timeStamp<500||(this.abortDelayedShow(),we()(pe()(o.prototype),"onDocumentMouseDown",this).call(this,{event:t}))}},{key:"internalOnPointerOver",value:function(e){var t,n=this,r=n.forElement,i=n.forSelector,o=n.activeTarget;if(!(n.disabled||n.allowOver&&n.element.contains(e.target))){if(i){if(o&&o.contains(e.target)&&o.contains(e.relatedTarget))return;if((t=e.target.closest(i))&&e.relatedTarget&&e.relatedTarget.closest(i)===t)return}else{if(r.contains(e.relatedTarget))return;t=r}t?n.handleForElementOver(e,t):o&&n.handleForElementOut()}}},{key:"onTransitionEnd",value:function(e){var t=this,n=o.currentOverElement;if(Ul[e.propertyName]){if(t.allowOver&&t.element.contains(n))return;t.activeTarget&&t.activeTarget.contains(n)&&!t.trackMouse&&t.realign()}}},{key:"handleForElementOver",value:(r=Wr()(Vr.a.mark((function e(t,n){var r,i;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!1!==(r=this).trigger("pointerOver",{event:t,target:n})){e.next=5;break}r.internalOnPointerOut(t),e.next=24;break;case 5:if(r.triggeredByEvent=t,r.abortDelayedHide(),!r.hideOnDelegateChange&&r.element.classList.contains("b-hiding")&&(r.element.classList.remove("b-hiding"),r.show(!1)),!r.isVisible||r.hideOnDelegateChange){e.next=21;break}if(r.updateActiveTarget(n),!1!==r.trigger("beforeShow")){e.next=12;break}return e.abrupt("return",r.hide());case 12:if(i=r.updateContent(),!an.isPromise(i)||r.loadingMsg){e.next=16;break}return e.next=16,i;case 16:r.alignTo({target:r.anchorToTarget?n:new Xs(r.triggeredByEvent.pageX-window.pageXOffset+r.mouseOffsetX,r.triggeredByEvent.pageY-window.pageYOffset+r.mouseOffsetY),overlap:!(r.anchorToTarget&&r.anchor)}),r.trigger("show"),r.afterShowByTarget(),e.next=24;break;case 21:r.hideOnDelegateChange&&r.hide(),r.updateActiveTarget(n),r.delayShow(n);case 24:case"end":return e.stop()}}),e,this)}))),function(e,t){return r.apply(this,arguments)})},{key:"delayShow",value:(n=Wr()(Vr.a.mark((function e(t){var n,r;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=this).currentAnimation&&(n.cancelHideShowAnimation(),n._hidden=!0),n.isVisible||n.hasTimeout("show")){e.next=16;break}if(n.hoverDelay&&!(n.forSelector&&Date.now()-n.lastHidden<n.quickShowInterval)){e.next=11;break}if(r=n.updateContent(),!an.isPromise(r)||n.loadingMsg){e.next=8;break}return e.next=8,r;case 8:n.showByTarget(t),e.next=14;break;case 11:n.addDocumentMouseDownListener(),n.listeningForMouseMove||n.anchorToTarget||(n.mouseMoveRemover=nu.on({element:o.listenersTarget,mousemove:"onMouseMove",thisObj:n})),n.setTimeout(Wr()(Vr.a.mark((function e(){var r;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Cr.isOrphaned(t)){e.next=6;break}if(r=n.updateContent(),!an.isPromise(r)||n.loadingMsg){e.next=5;break}return e.next=5,r;case 5:n.showByTarget(t);case 6:case"end":return e.stop()}}),e)}))),n.triggeredByEvent&&"mouseover"!==n.triggeredByEvent.type?0:n.hoverDelay,"show");case 14:e.next=17;break;case 16:n.isVisible&&n.showByTarget(t);case 17:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"updateContent",value:(t=Wr()(Vr.a.mark((function e(){var t,n;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this).getHtml){e.next=5;break}return n=t.getHtml({tip:t,element:t.element,activeTarget:t.activeTarget,event:t.triggeredByEvent}),t.html=n,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"internalBeforeShow",value:function(){return this.updateContentOnMouseMove||this.hasContent}},{key:"showAsyncMessage",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.optionalL(this.loadingMsg);e&&(this.html='\n                <div class="b-tooltip-loading">\n                    <i class="b-icon b-icon-spinner"></i>\n                    '.concat(e,"\n                </div>\n            "))}},{key:"showByTarget",value:function(e){var t=this;t.mouseMoveRemover&&(t.mouseMoveRemover(),t.mouseMoveRemover=null),t.showBy({target:t.anchorToTarget?e:new Xs(t.triggeredByEvent.pageX-window.pageXOffset+t.mouseOffsetX,t.triggeredByEvent.pageY-window.pageYOffset+t.mouseOffsetY),overlap:!(t.anchorToTarget&&t.anchor)})}},{key:"afterShowByTarget",value:function(){var e=this.dismissDelay;this.abortDelayedShow(),e&&this.setTimeout("hide",e),this.toFront()}},{key:"updateActiveTarget",value:function(e){var t=this.activeTarget;this.activeTarget=e,this.isConfiguring||this.trigger("overtarget",{newTarget:e,lastTarget:t})}},{key:"internalOnPointerOut",value:function(e){var t=this,n=e.relatedTarget;t.allowOver&&t.element.contains(n)||t.element.contains(e.target)&&t.activeTarget&&t.activeTarget.contains(n)||t.activeTarget&&!t.activeTarget.contains(e.relatedTarget)&&t.handleForElementOut()}},{key:"handleForElementOut",value:function(){var e=this,t=e.hideDelay;!1!==e.trigger("pointerOut")?(e.abortDelayedShow(),e.isVisible&&!1!==t&&(e.abortDelayedHide(),t>0?e.setTimeout("hide",t):e.hide())):e.activeTarget=null}},{key:"show",value:function(){var e,t=this;(t.forElement&&t.anchorToTarget&&!t.forSelector&&!t.inShowBy?t.showByTarget(t.forElement):(t.inShowBy&&(t.y=-1e4),we()(pe()(o.prototype),"show",this).call(this)),t.afterShowByTarget(),t.mouseMoveRemover||t._hidden||!t.trackMouse&&!t.updateContentOnMouseMove)||(t.mouseMoveRemover=nu.on((e={element:o.listenersTarget},ke()(e,j.a.supportsPointerEvents?"pointermove":"touchmove","onMouseMove"),ke()(e,"thisObj",t),e)));!t.forElement||t.transitionEndDetacher||t._hidden||(t.transitionEndDetacher=nu.on({element:t.forElement,transitionend:"onTransitionEnd",thisObj:t}))}},{key:"hide",value:function(){var e=this;if(e.abortDelayedShow(),e.isVisible){var t;e.abortDelayedHide();for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];(t=we()(pe()(o.prototype),"hide",this)).call.apply(t,[this].concat(r)),e.lastHidden=Date.now(),e.activeTarget=null,e.mouseMoveRemover&&(e.mouseMoveRemover(),e.mouseMoveRemover=null),e.transitionEndDetacher&&(e.transitionEndDetacher(),e.transitionEndDetacher=null),e.listeningForMouseMove=!1}}},{key:"abortDelayedShow",value:function(){var e=this;e.hasTimeout("show")&&(e.mouseDownRemover&&(e.mouseDownRemover(),e.mouseDownRemover=null),e.clearTimeout("show"),e.mouseMoveRemover&&(e.mouseMoveRemover(),e.mouseMoveRemover=null),e.transitionEndDetacher&&(e.transitionEndDetacher(),e.transitionEndDetacher=null))}},{key:"abortDelayedHide",value:function(){this.clearTimeout("hide")}},{key:"realign",value:function(e){var t=this,n=t.lastAlignSpec,r=t.clippedBy;!t.isConfiguring&&r&&!t.isVisible&&n&&n.targetHidden&&(En.from(n.target,t.positioned?t.element.offsetParent:null,!t.positioned).intersect(r)&&(t.show(),n.targetHidden=!1));we()(pe()(o.prototype),"realign",this).call(this,e)}},{key:"alignTo",value:function(e){this.isVisible&&(this.triggeredByEvent&&this.element.contains(this.triggeredByEvent.target)||1===e.nodeType&&(e={target:e}),we()(pe()(o.prototype),"alignTo",this).call(this,e))}},{key:"changeHtml",value:function(e){var t=this;return!1===e?(y.a.deprecate("Grid","5.0.0","Setting false to indicate loading is deprecated, in favor of `showAsyncMessage`. Please see https://bryntum.com/docs/grid/#guides/upgrades/3.0.1.md for more information"),void this.showAsyncMessage()):an.isPromise(e)?(t.showAsyncMessage(),e.target=t.activeTarget,void e.then((function(n){e.target===t.activeTarget&&(t.html=n)}))):("object"!==l()(e)&&(e=null!=e?t.optionalL(String(e)):""),e)}},{key:"updateHtml",value:function(e,t){var n=this;we()(pe()(o.prototype),"updateHtml",this).call(this,e,t),n.hasContent?(n.isVisible&&n.realign(),an.isPromise(e)||n.trigger("innerHtmlUpdate")):n.hide()}},{key:"onMouseMove",value:function(e){var t=this,n=t.forElement,r=e.pageX-window.pageXOffset+t.mouseOffsetX,i=e.pageY-window.pageYOffset+t.mouseOffsetY,o=t.hasTimeout("hide"),a=e.target;if(t.triggeredByEvent=e,!t._hidden){var s,u=t.forSelector&&t.activeTarget&&!o&&1===a.nodeType&&!a.matches(t.forSelector)&&!(t.allowOver&&t.element.contains(a)),c=(null==n?void 0:n.document)?n.document.documentElement:n,l=c&&(c.contains?c.contains(a):16&c.compareDocumentPosition(a));u&&(s=t.handleForElementOut()),(s||!o||l)&&(t.dismissDelay&&!o&&t.setTimeout("hide",t.dismissDelay),t.updateContentOnMouseMove&&t.getHtml&&(t.html=t.getHtml({tip:t,element:t.element,forElement:t.activeTarget,event:e})),t.trackMouse&&t.alignTo({position:new Xs(r,i),ignorePageScroll:!0}))}}},{key:"onOwnElementMouseEnter",value:function(e){this.abortDelayedHide()}},{key:"focusOnToFront",set:function(e){sc()(pe()(o.prototype),"focusOnToFront",e,this,!0)},get:function(){return we()(pe()(o.prototype),"focusOnToFront",this)&&Cr.usingKeyboard}},{key:"focusElement",get:function(){var e=we()(pe()(o.prototype),"focusElement",this);if(e!==this.element)return e}},{key:"trackMouse",get:function(){return this._trackMouse&&!this.anchorToTarget}},{key:"hasContent",get:function(){return Boolean("string"==typeof this.html&&this.html.length||this.items.length)}}],[{key:"$name",get:function(){return"Tooltip"}},{key:"listenersTarget",get:function(){return document.body}},{key:"type",get:function(){return"tooltip"}},{key:"configurable",get:function(){return{mouseOffsetX:15,mouseOffsetY:15,floating:!0,getHtml:null,forElement:null,trackMouse:null,updateContentOnMouseMove:!1,forSelector:null,hideOnDelegateChange:null,anchorToTarget:!0,showOnHover:!1,hoverDelay:500,autoShow:!1,dismissDelay:0,hideDelay:500,loadingMsg:"Loading...",allowOver:!1,anchor:!0,align:"b-t",axisLock:!0,testConfig:{hideDelay:100,hoverDelay:100,showAnimation:null,hideAnimation:null}}}}]),o}(zl);function Xl(){nu.on({element:Kl.listenersTarget,mouseenter:function(e){return Kl.currentOverElement=e.target},capture:!0})}function Zl(){Gl=new Kl({id:"bryntum-tooltip",forElement:Kl.listenersTarget,forSelector:"[data-btip]",header:!0,resetCfg:{},listeners:{pointerOver:function(e){var t=e.source,n=e.target;for(var r in t.resetCfg)"listeners"===r?t.un(t.resetCfg[r].set):"html"!==r&&(t[r]=t.resetCfg[r].was);t.resetCfg={};var i=oc.getById(n.id),o=(null==i?void 0:i.tipConfig)||t.gatherDataConfigs(n.dataset);for(var a in o)t.resetCfg[a]={set:o[a],was:t[a]},"listeners"===a?t.on(o[a]):t[a]=o[a];t.headerElement.style.display=t.title?"":"none"}},gatherDataConfigs:function(e){var t={};for(var n in e)if(n.startsWith("btip"))if(n.length>4){var r=E.uncapitalize(n.substr(4));if(r in this.getDefaultConfiguration()){var i=e[n];t[r]=ql[i]?"true"===i:isNaN(i)?i:parseInt(i,10)}}else t.html=e[n];return t}})}function Jl(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;Yl&&clearTimeout(Yl),0===e?Zl():Yl=setTimeout(Zl,e)}function Ql(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Kl.listenersTarget?Xl():document.addEventListener("DOMContentLoaded",Xl),Kl.initClass(),Object.defineProperty(oc,"tooltip",{get:function(){return Gl||(clearTimeout(Yl),Zl()),Gl}}),Kl.listenersTarget?Jl(y.a.isTestEnv?0:1e3):document.addEventListener("DOMContentLoaded",(function(){return Jl(y.a.isTestEnv?0:1e3)})),Kl._$name="Tooltip";var ef=function(e){fe()(n,e);var t=Ql(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"open",value:function(){this.getConfig("tooltip")}},{key:"close",value:function(){var e;null===(e=this.tooltip)||void 0===e||e.hide()}},{key:"dragMove",value:function(e){var t=this.offset,n=this.tooltip,r=e.event;n&&(n.isVisible||n.show(),n.alignTo({align:this.align,target:new En(r.clientX-t,r.clientY-t,2*t,2*t)}))}},{key:"changeTooltip",value:function(e,t){return oc.reconfigure(t,e,this)}}],[{key:"type",get:function(){return"tip"}},{key:"configurable",get:function(){return{align:"t10-b50",offset:20,tooltip:{$config:["lazy","nullify"],value:{type:"tooltip"}}}}}]),n}(Hc);function tf(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}ef.initClass(),ef._$name="DragTipProxy";var nf={0:!0,6:!0},rf=function(e){fe()(n,e);var t=tf(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"configure",value:function(e){we()(pe()(n.prototype),"configure",this).call(this,e),e.date&&(this.date=e.date)}},{key:"changeDate",value:function(e){if(!this.isConfiguring){if(e="string"==typeof e?Zt.parse(e,"YYYY-MM-DD"):new Date(e),isNaN(e))throw new Error("Month date ingestion must be passed a Date, or a valid YYYY-MM-DD date string");return e}}},{key:"updateDate",value:function(e,t){var n=this,r=n.dayColumnIndex,i=Zt.getFirstDateOfMonth(e),o=Zt.getLastDateOfMonth(i),a=r[i.getDay()],s=r[o.getDay()],u=!t||e.getFullYear()!==t.getFullYear(),c=n.eventListeners&&(t?e.getDate()!==t.getDate()|(n.getWeekId(e)!==n.getWeekId(t))<<1|(e.getMonth()!==t.getMonth())<<2|u<<3:15);if(n._year=e.getFullYear(),n._month=e.getMonth(),n.startDayOfMonth=1-a,n.endDayOfMonth=o.getDate()+(6-s),n.sixWeeks&&(n.endDayOfMonth+=7*(6-n.weekCount)),n.weekBase&&!u||n.calculateWeekBase(),c){var l={newDate:e,oldDate:t,changes:{d:!0,w:Boolean(2&c),m:Boolean(12&c),y:Boolean(8&c)}};n.trigger("dateChange",l),2&c&&n.trigger("weekChange",l),12&c&&n.trigger("monthChange",l),8&c&&n.trigger("yearChange",l)}}},{key:"calculateWeekBase",value:function(){var e=this,t=e.dayColumnIndex,n=new Date(e.year,0,1),r=new Date(e.year,11,31),i=e.month?e.getOtherMonth(n):e;e.dayColumnIndex[n.getDay()]>3?e.weekBase=i.startDate:e.weekBase=new Date(e.year,0,i.startDayOfMonth-7);var o=Math.floor(Zt.diff(e.weekBase,r,"day")/7);e.has53weeks=53===o&&t[r.getDay()]>2}},{key:"getWeekStart",value:function(e){if("number"==typeof e)return Zt.add(this.weekBase,7*Math.max(e,1),"day");var t=ye()(e,2),n=t[0],r=t[1];return n===this.year?this.getWeekStart(r):this.getOtherMonth(new Date(n,0,1)).getWeekStart(r)}},{key:"getOtherMonth",value:function(e){var t=this,r=t===of?new n(null):of;return r.configure({weekBase:null,weekStartDay:t.weekStartDay,nonWorkingDays:t.nonWorkingDays,hideNonWorkingDays:t.hideNonWorkingDays,sixWeeks:t.sixWeeks}),r.date=e,r.date!==e&&r.updateDate(r.date,r.date),r}},{key:"changeYear",value:function(e){var t=new Date(this.date);t.setFullYear(e),this.date=t}},{key:"changeMonth",value:function(e){var t=new Date(this.date);t.setMonth(e),this.date=t}},{key:"changeWeekStartDay",value:function(e){return null==e?Zt.weekStartDay:e}},{key:"updateWeekStartDay",value:function(){var e=this;e.updateDayNumbers(),e.calculateWeekBase(),e.isConfiguring||e.updateDate(e.date,e.date)}},{key:"updateNonWorkingDays",value:function(){this.updateDayNumbers()}},{key:"updateHideNonWorkingDays",value:function(){this.updateDayNumbers()}},{key:"updateSixWeeks",value:function(){this.isConfiguring||this.updateDate(this.date)}},{key:"eachDay",value:function(e){for(var t=this.startDayOfMonth;t<=this.endDayOfMonth;t++)e(new Date(this.year,this.month,t))}},{key:"eachWeek",value:function(e){for(var t=this,n=t.weekCount,r=t.startDayOfMonth,i=0;i<n;i++){for(var o=[],a=t.getWeekNumber(new Date(t.year,t.month,r)),s=0;s<7;s++,r++)o.push(new Date(t.year,t.month,r));e(a,o)}}},{key:"getWeekNumber",value:function(e){var t=this;if((e=Zt.clearTime(e)).getFullYear()!==t.year)return t.getOtherMonth(new Date(e.getFullYear(),0,1)).getWeekNumber(e);var n=Math.floor(Zt.diff(t.weekBase,e,"day")/7),r=e.getFullYear();return n?(53!==n||t.has53weeks?n>53&&(n%=52):(n=1,r++),[r,n]):t.getOtherMonth(new Date(t.year-1,0,1)).getWeekNumber(new Date(t.year,0,0))}},{key:"getWeekId",value:function(e){var t=this.getWeekNumber(e);return 100*t[0]+t[1]}},{key:"getCellData",value:function(e){var t=this,n=e.getDay(),r=t.visibleDayColumnIndex[n],i=t.nonWorkingDays[n],o=t.hideNonWorkingDays&&i;return(e<t.startDate||e>t.endDate)&&(t.month=e.getMonth()),{day:n,visibleColumnIndex:r,isNonWorking:i,week:t.getWeekNumber(e),key:Zt.format(e,"YYYY-MM-DD"),columnIndex:t.dayColumnIndex[n],date:new Date(e),isOtherMonth:Math.sign(e.getMonth()+12*e.getFullYear()-(t.month+12*t.year)),visible:!o&&e>=t.startDate&&e<Zt.add(t.endDate,1,"day"),tomorrow:Zt.add(e,1,"day"),isRowStart:0===r,isRowEnd:r===t.visibleColumnCount-1}}},{key:"updateDayNumbers",value:function(){for(var e=this,t=e.weekStartDay,n=e.nonWorkingDays,r=e.hideNonWorkingDays,i=e.dayColumnIndex=[],o=e.canonicalDayNumbers=[],a=e.visibleDayColumnIndex=[],s=0,u=0;u<7;u++){var c=(t+u)%7;o[u]=c,i[c]=u,r&&n[c]||(a[c]=s++)}e.visibleColumnCount=s,e.weekLength=r?7-an.keys(n).length:7}},{key:"dayCount",get:function(){return this.endDayOfMonth+1-this.startDayOfMonth}},{key:"weekCount",get:function(){return this.dayCount/7}},{key:"startDate",get:function(){var e=this;if(null!=e.year&&null!=e.month&&null!=e.startDayOfMonth)return new Date(e.year,e.month,e.startDayOfMonth)}},{key:"endDate",get:function(){var e=this;if(null!=e.year&&null!=e.month&&null!=e.startDayOfMonth)return new Date(e.year,e.month,e.endDayOfMonth)}}],[{key:"configurable",get:function(){return{date:{$config:{equal:"date"},value:Zt.clearTime(new Date)},month:null,year:null,weekStartDay:Zt.weekStartDay,hideNonWorkingDays:null,nonWorkingDays:nf,sixWeeks:null}}}]),n}(Ge(ue)),of=new rf(null);rf._$name="Month";var af=0,sf=new WeakMap,uf=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return t.map((function(e){var t;return e&&"object"==l()(e)||"function"==typeof e?void 0===(t=sf.get(e))&&(t=++af,sf.set(e,t)):t=String(e),t})).join("-")},cf=function(e){var t=new Map;return function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];var o=uf(r),a=t.get(o);return void 0===a&&(a=e.apply(void 0,r),t.set(o,a)),a}},lf=function(e){var t=new Map,n=function(e){return e[0]},r=function(e){return e[1]},i=function(e,t){return n(e).push(t)};return function(o,a){var s=function(e){var n=t.get(e);return void 0===n&&(n=[[],[]],t.set(e,n)),n}(o);!function(e){return!r(e).length&&!n(e).length}(s)?(i(s,a),r(s).forEach((function(e){return a(e)}))):(i(s,a),e(o,(function(e){(function(e,t){return r(e).some((function(e){return an.isEqual(e,t)}))})(s,e)||(!function(e,t){r(e).push(t)}(s,e),n(s).forEach((function(t){return t(e)})))})))}},ff=Symbol("success"),df=Symbol("failure"),hf=function(e,t){return[ff,e,t]},vf=function(e){return[df,e]},pf=function(e){return e.length&&e[0]===ff},gf=function(e){return"function"!=typeof e||e.length?e:e()},yf=cf((function(e){return lf((function(t,n){return n(hf(e,t))}))})),mf=cf((function(e){return lf((function(t,n){var r=Math.min(e.length,t.length),i=t.substr(0,r),o=t.substr(r);n(i===e?hf(i,o):vf(o))}))})),kf=function(e,t){return function(n,r){return gf(e)(n,(function(e){if(pf(e)){var n=ye()(e,3),i=n[1],o=n[2];t(i)(o,r)}else r(e)}))}},bf=cf((function(){for(var e=cf((function(e,t){return lf(kf(e,(function(e){return kf(t,(function(t){return yf([].concat(e,t))}))})))})),t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return n.reduce(e,yf([]))})),wf=cf((function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return lf((function(e,n){return t.forEach((function(t){return gf(t)(e,n)}))}))})),Cf=cf((function(e){return function(t,n){var r=new RegExp("^".concat(e)).exec(t);if(r){var i=r[0],o=t.substr(i.length);n(hf(i,o))}else n(vf(t))}})),Sf=cf((function(e,t){return kf(e,(function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];return yf(t.apply(void 0,d()([].concat.apply([],n))))}))})),Df=function(e,t){var n=[];return e(t,(function(e){pf(e)&&(""===ye()(e,3)[2]&&n.push(e))})),n},Rf={memo:cf,memoCps:lf,success:hf,failure:vf,isSuccess:pf,resolveParser:gf,succeed:yf,string:mf,bind:kf,seq:bf,alt:wf,regexp:Cf,red:Sf,runParser:Df,defineParser:function(e){return function(t,n){return n?gf(e)(t,n):Df(gf(e),t)}}};function xf(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var Ef;function Tf(e){Ef&&clearTimeout(Ef),void 0===e&&(e=y.a.isTestEnv?0:1e3),0===e?Pf.errorTip:Ef=setTimeout((function(){return Pf.errorTip}),e)}var Mf=function(e,t){return(e.weight||0)-(t.weight||0)},Af=function(e,t){return(t.weight||0)-(e.weight||0)},Pf=function(e){fe()(n,e);var t=xf(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"doDestroy",value:function(){var e,t,r=this,i=r.triggers,o=n._errorTip;if(null===(e=r.inputListenerRemover)||void 0===e||e.call(r),null===(t=r.keyListenerRemover)||void 0===t||t.call(r),we()(pe()(n.prototype),"doDestroy",this).call(this),i)for(var a=0,s=Object.values(i);a<s.length;a++){s[a].destroy()}(null==o?void 0:o.field)===r&&o.hide()}},{key:"construct",value:function(e){we()(pe()(n.prototype),"construct",this).call(this,e);var t=this;Kl.listenersTarget?Tf():document.addEventListener("DOMContentLoaded",Tf),t.keyStrokeChangeDelay&&(t.changeOnKeyStroke=t.buffer(t.internalOnChange,t.keyStrokeChangeDelay))}},{key:"onFocusIn",value:function(e){this.valueOnFocus=an.clone(this.value),we()(pe()(n.prototype),"onFocusIn",this).call(this,e)}},{key:"onFocusOut",value:function(e){we()(pe()(n.prototype),"onFocusOut",this).call(this,e),this.syncRequired(),this.onEditComplete()}},{key:"onEditComplete",value:function(){}},{key:"setInputAttributes",value:function(e){var t=this;if(!(e instanceof HTMLElement)){var n=e.reference;e=Cr.createElement(e),n&&(e=e[n])}return t.attributes.forEach((function(n){var r=t[n];null!=r&&e.setAttribute(n,r)})),t.inputAttributes&&Object.entries(t.inputAttributes).forEach((function(t){var n=ye()(t,2),r=n[0],i=n[1];null!=i&&e.setAttribute(r,i)})),e}},{key:"getAfterValue",value:function(e){var t=ye()(this.textSelection,2),n=t[0],r=t[1],i=this.input.value;return"".concat(i.substr(0,n)).concat(e).concat(i.substr(r||n))}},{key:"select",value:function(e,t){var n=this.focusElement;if(n.value.length){if(0===arguments.length)return void this.selectAll();if(!this.supportsTextSelection)return;j.a.isIE11?(n.focus(),n.setSelectionRange(e,t)):n.setSelectionRange(e,t)}}},{key:"moveCaretToEnd",value:function(){var e=this.input;if(e.createTextRange){var t=e.createTextRange();t.collapse(!1),t.select()}else this.supportsTextSelection&&this.select(e.value.length,e.value.length)}},{key:"selectAll",value:function(){this.focusElement.select()}},{key:"syncEmpty",value:function(){var e=this.isEmptyInput,t=this.isEmpty,n=this.element,r=this.clearIcon,i=e&&t;n&&(r&&r.classList[i?"add":"remove"]("b-icon-hidden"),n.classList[i?"add":"remove"]("b-empty"))}},{key:"updateHint",value:function(){this.syncHint()}},{key:"updateHintHtml",value:function(){this.syncHint()}},{key:"syncHint",value:function(){var e=this,t=e.input,n=e.hint,r=e.hintHtml,i=null==t?void 0:t.parentElement;if(t){var o=r||n,a=e.hintElement||o&&(e.hintElement=Cr.createElement({parent:i,className:"b-field-hint",nextSibling:t.nextSibling,children:[{className:"b-field-hint-content"}]}));a&&("function"==typeof o&&(o=o({source:e,value:e.value})),a.firstChild[r?"innerHTML":"textContent"]=o||""),e.element.classList[o?"remove":"add"]("b-field-no-hint")}}},{key:"syncInvalid",value:function(){this.updatingInvalid=!0;var e=this.isValid,t=this.element,n=this.inputWrap,r=Kl.listenersTarget&&this.errorTip;t&&(t.classList[e?"remove":"add"]("b-invalid"),e?(null==r?void 0:r.isVisible)&&r.field===this&&r.hide():r&&n.contains(Kl.currentOverElement)&&(r.activeTarget===n&&r.isVisible?r.onBeforeShow():(r.activeTarget=n,r.showBy(n)))),this.updatingInvalid=!1}},{key:"updateEditable",value:function(){this.syncInputReadOnly()}},{key:"syncInputReadOnly",value:function(){this.getConfig("readOnly"),this.inputReadOnly=this._readOnly||!1===this.editable}},{key:"updateInputReadOnly",value:function(e){var t=this,n=t.input,r=t.inputListenerRemover;n&&(n.readOnly=e?"readOnly":null,e?t.inputListenerRemover=null==r?void 0:r():r||(t.inputListenerRemover=nu.on({element:n,thisObj:t,focus:"internalOnInputFocus",change:"internalOnChange",input:"internalOnInput"})))}},{key:"changeReadOnly",value:function(e){return Boolean(e)}},{key:"updateReadOnly",value:function(e){var t;null===(t=this.element)||void 0===t||t.classList[e?"add":"remove"]("b-readonly"),this.syncInputReadOnly()}},{key:"updateClearable",value:function(e){var t=this;t.getConfig("triggers"),t.triggers={clear:e&&an.assign({cls:"b-icon-remove",weight:1e3,handler:function(){t._isUserAction=!0,t.clear(),t._isUserAction=!1}},e)||null}}},{key:"changeTriggers",value:function(e){var t=this,r=t.$triggers||(t.$triggers=new Yc({factory:n.Trigger,inferType:!1,owner:t,setup:function(e,n){e.reference=n,e.parent=t}}));return!1===t.stepTriggers&&(e.back||e.forward)&&(delete(e=an.assign({},e)).back,delete e.forward),r.update(e),r.flush(),r.target}},{key:"updateLabelWidth",value:function(e){this.labelElement&&(this.labelElement.style.flex="0 0 ".concat(Cr.setLength(e)),this.inputWrap.style.flexBasis=null==e?"":0)}},{key:"updateInputWidth",value:function(e){this.input.style.width=Cr.setLength(e),j.a.isIE11&&(this.input.parentElement.style.flexBasis=this.input.style.width),this.element.classList.add("b-has-width")}},{key:"updateInputAlign",value:function(e){this.input.style.textAlign=e}},{key:"changeLabel",value:function(e){return null==e?"":e}},{key:"updateLabel",value:function(e){this.labelElement&&(this.labelElement.innerHTML=e)}},{key:"changeValue",value:function(e,t){return null==e&&(e=this.nullValue),this.hasChanged(t,e)?e:(""===e&&this.syncRequired(),t)}},{key:"updateValue",value:function(e,t){var n=this;n.isConfiguring||(n.syncRequired(),n.inputting||n.triggerChange()),n.inputting||(n._lastValue=e),n.syncInputFieldValue()}},{key:"hasChanged",value:function(e,t){return t!==e}},{key:"syncInputFieldValue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=t.input,r=t.parent;n&&!t.inputting&&(t.input[t.inputValueAttr]=t.inputValue,t.isConfiguring||t.containsFocus||!t.highlightExternalChange||(n.classList.remove("b-field-updated"),t.clearTimeout("removeUpdatedCls"),e||r&&r.isSettingValues&&r._isSettingValues.preventHighlight||t.highlightChanged())),t.syncEmpty(),t.syncInvalid()}},{key:"highlightChanged",value:function(){this.input.classList.add("b-field-updated"),this.setTimeout("removeUpdatedCls",this.updatedClsDuration)}},{key:"removeUpdatedCls",value:function(){this.input.classList.remove("b-field-updated")}},{key:"internalOnInputFocus",value:function(){var e=this.input.value.length;j.a.isIE11&&e&&!this.autoSelect&&this.select(e,e)}},{key:"internalOnChange",value:function(e){var t=this;t.isValid&&t.hasChanged(t._lastValue,t.value)&&(t.triggerChange(e,!0),t._lastValue=t.value)}},{key:"triggerChange",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Boolean(this._isUserAction),n=this,r=n.value,i=n._lastValue,o=n.isValid;n.syncHint(),n.triggerFieldChange({value:r,oldValue:i,event:e,userAction:t,valid:o}),"change"===n.defaultAction&&n.trigger("action",{value:r,oldValue:i,event:e,userAction:t,valid:o})}},{key:"internalOnInput",value:function(e){var t=this;t.inputting=!0,t.value=t.input.value,t.inputting=!1,t.trigger("input",{value:t.value,event:e}),t.changeOnKeyStroke&&t.changeOnKeyStroke(e)}},{key:"internalOnKeyEvent",value:function(e){var t=this,n=t.value,r=!1;if("keydown"===e.type)if("Escape"!==e.key||t.readOnly||t.disabled)"Enter"===e.key&&j.a.isIE11&&t.internalOnChange(e);else{var i="initialValue"in t?t.initialValue:t.valueOnFocus,o=t.hasChanged(i,n),a=t.input.value!==String(t.inputValue);t.revertOnEscape&&(!t.isValid||o||a)?(o&&(t.value=i),a&&t.syncInputFieldValue(!0),t.clearError(),r=o&&t.isValid):t.clearable&&(n||t.input.value)&&t.clear()}t.isDestroyed||(r&&e.stopImmediatePropagation(),t.trigger(e.type,{event:e}))}},{key:"clear",value:function(){this.value=this.nullValue,this.trigger("clear")}},{key:"onDisabled",value:function(){this.syncInvalid()}},{key:"syncRequired",value:function(){var e,t=this;!t.isConfiguring&&t.required&&t.isEmpty&&!(null===(e=t.parent)||void 0===e?void 0:e.isSettingValues)?t.setError("L{fieldRequired}",t.updatingInvalid):t.clearError("L{fieldRequired}",t.updatingInvalid)}},{key:"setError",value:function(e,t){(this.errors||(this.errors={}))[this.L(e)]=1,t||this.syncInvalid()}},{key:"clearError",value:function(e,t){this.errors&&(e?delete this.errors[this.L(e)]:this.errors={}),t||this.syncInvalid()}},{key:"getErrors",value:function(){var e=this;if(!e.isValid){var t,n=e.input.validity,r=an.allKeys(n).find((function(e){return"valid"!==e&&"customError"!==e&&n[e]}));if((t=e.errors?Object.keys(e.errors):n.customError?[e.input.validationMessage]:r?[e.L(r,{min:e.min,max:e.max})]:[e.L(e.invalidValueError)])&&t.length>0)return t}}},{key:"invalidValueError",get:function(){return"L{invalidValue}"}},{key:"errorTip",get:function(){return this.constructor.errorTip}},{key:"element",set:function(e){var t,r=this,i=r.initialConfig.value,o=r.innerElements,a=[{className:"b-field-inner",reference:"inputWrap",children:o}],s=[],u=[],c=r.labels||[];for(var l in r.label&&c.push({reference:"labelElement",className:r.labelCls,html:r.label}),c&&c.forEach((function(e){var t=Object.assign({tag:"label",htmlFor:"".concat(r.id,"-input"),className:"b-align-".concat(e.align||"start")},e);e.align&&"start"!==e.align?a.push(t):a.unshift(t)})),r.getConfig("clearable"),r.triggers){var f=r.triggers[l];"start"===f.align?(s.unshift(f),t=!0):u.push(f)}s.sort(Mf),u.sort(Af),o.unshift.apply(o,d()(s.map((function(e){return e.element})))),o.push.apply(o,d()(u.map((function(e){return e.element})))),sc()(pe()(n.prototype),"element",{children:a,className:{"b-has-label":c.length,"b-has-start-trigger":t,"b-readonly":r.readOnly}},this,!0),null!=i&&(r.value=i),r.syncEmpty(),r.updateInputReadOnly(r.inputReadOnly),r.syncInvalid();var h=r.input||r.focusElement;h&&(r.keyListenerRemover=nu.on({element:h,thisObj:r,keydown:"internalOnKeyEvent",keypress:"internalOnKeyEvent",keyup:"internalOnKeyEvent"}))},get:function(){return we()(pe()(n.prototype),"element",this)}},{key:"innerElements",get:function(){return[this.setInputAttributes(this.inputElement)]}},{key:"inputElement",get:function(){var e=this,t={tag:"input",reference:"input",class:e.inputCls||"",value:e._value||"",name:e.name||e.id,id:"".concat(e.id,"-input")};return e.inputType&&(t.type=e.inputType),t}},{key:"caretPos",get:function(){return this.textSelection[0]},set:function(e){this.textSelection=e}},{key:"focusElement",get:function(){return this.input}},{key:"textSelection",get:function(){var e,t=this.input;try{e=[t.selectionStart,t.selectionEnd,t.selectionDirection]}catch(n){e=[e=(e=t.value)?e.length:0,e]}return e},set:function(e){"number"==typeof e?this.select(e,e):this.select.apply(this,d()(e))}},{key:"hasTextSelection",get:function(){var e=ye()(this.textSelection,2),t=e[0],n=e[1];return t&&n-t>0}},{key:"isValid",get:function(){var e=this;if(!e.disabled){if(e.syncRequired(),e.errors&&Object.keys(e.errors).length)return!1;var t=e.validity;if(t)return t.valid}return!0}},{key:"isEmpty",get:function(){return null==this.value||""===this.value}},{key:"isEmptyInput",get:function(){return!this.input||null==this.input.value||""===this.input.value}},{key:"validity",get:function(){var e=this.input;return e&&e.validity}},{key:"inputValue",get:function(){return null==this.value?"":this.value}},{key:"inputValueAttr",get:function(){return"value"}},{key:"supportsTextSelection",get:function(){var e=this.focusElement;return e&&("textarea"===e.tagName.toLowerCase()||e.type&&(/text|search|password|tel|url/.test(e.type)||j.a.isEdge))}}],[{key:"$name",get:function(){return"Field"}},{key:"type",get:function(){return"field"}},{key:"configurable",get:function(){return{placeholder:null,value:"",name:null,label:null,labelCls:null,labels:null,labelWidth:{value:null,$config:{localeKey:"L{labelWidth}"}},required:null,clearable:null,revertOnEscape:null,hint:null,hintHtml:null,inputWidth:null,keyStrokeChangeDelay:0,readOnly:null,editable:!0,defaultAction:"change",triggers:null,highlightExternalChange:!0,localizableProperties:["label","title","placeholder","labelWidth"],autoSelect:!1,autoComplete:"off",inputAttributes:null,inputType:null,inputAlign:null,attributes:{value:["placeholder","autoComplete","minLength","maxLength","pattern","tabIndex","min","max"],$config:{merge:"distinct"}},nullValue:{$config:null,value:null,default:null},updatedClsDuration:500,inputReadOnly:!1,testConfig:{updatedClsDuration:10}}}},{key:"delayable",get:function(){return{highlightChanged:"raf"}}},{key:"errorTip",get:function(){return n._errorTip||(n._errorTip=new Kl({id:"bryntum-field-errortip",cls:"b-field-error-tip",forSelector:".b-field.b-invalid .b-field-inner",align:"l-r",scrollAction:"realign",onBeforeShow:function(){var e=oc.fromElement(this.activeTarget);if(e){var t=e.getErrors();if(t)return this.html=t.join("<br>"),this.field=e,!0}return!1}}))}}]),n}(Ml(oc));function If(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Pf.Trigger=function(e){fe()(n,e);var t=xf(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"template",value:function(){return'<div class="b-icon b-align-'.concat(this.align||"end",'"></div>')}},{key:"construct",value:function(e){we()(pe()(n.prototype),"construct",this).call(this,e),nu.on({element:this.element,click:{handler:"onClick",thisObj:this},mousedown:{handler:"onMousedown",thisObj:this}})}},{key:"changeAlign",value:function(e){return e}},{key:"onClick",value:function(e){var t=this,n=t.field,r="function"==typeof t.handler?t.handler:n[t.handler];n.disabled||n.readOnly||r&&!1!==n.trigger("trigger",{trigger:t})&&r.call(n,e)}},{key:"onMousedown",value:function(e){var t=this.field;!("key"in e)&&Cr.isTouchEvent&&t.editable&&(t.editable=!1,t.setTimeout((function(){return t.editable=!0}),500)),e.preventDefault(),Cr.activeElement!==t.input&&t.focus()}},{key:"field",get:function(){return this.parent}}],[{key:"$name",get:function(){return"FieldTrigger"}},{key:"factoryable",get:function(){return{defaultType:Pf.Trigger,extends:null}}},{key:"type",get:function(){return"trigger"}},{key:"configurable",get:function(){return{align:null}}}]),n}(oc),Pf.SpinTrigger=function(e){fe()(n,e);var t=xf(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"doDestroy",value:function(){this.clickRepeater&&this.clickRepeater.destroy(),we()(pe()(n.prototype),"doDestroy",this).call(this)}},{key:"template",value:function(){return'<div class="b-icon b-align-'.concat(this.align||"end",'">\n                    <div data-reference="upButton" class="b-icon b-spin-up"></div>\n                    <div data-reference="downButton" class="b-icon b-spin-down"></div>\n                </div>')}},{key:"updateRepeat",value:function(e){var t=this;e?t.clickRepeater=new cl(Object.assign({element:t.element},e)):t.clickrepeater&&(t.clickRepeater.destroy(),t.clickrepeater=null)}},{key:"onClick",value:function(e){var t=this.field;t.disabled||t.readOnly||(e.target===this.upButton?t.doSpinUp(e.shiftKey):e.target===this.downButton&&t.doSpinDown(e.shiftKey))}}],[{key:"$name",get:function(){return"SpinTrigger"}},{key:"type",get:function(){return"spintrigger"}},{key:"configurable",get:function(){return{repeat:!0}}}]),n}(Pf.Trigger),Pf.Trigger.initClass(),Pf.SpinTrigger.initClass(),oc.register(Pf.Trigger,"trigger"),oc.register(Pf.SpinTrigger,"spintrigger"),Pf._$name="Field";var Of=function(e){fe()(n,e);var t=If(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e){"hidden"===e.inputType&&(e.hidden=!0),we()(pe()(n.prototype),"construct",this).apply(this,arguments)}},{key:"updatePlaceholder",value:function(e){this.input&&(this.input.placeholder=null!=e?e:"")}}],[{key:"type",get:function(){return"textfield"}},{key:"alias",get:function(){return"text"}},{key:"configurable",get:function(){return{nullValue:""}}},{key:"$name",get:function(){return"TextField"}}]),n}(Pf);function Ff(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Of.initClass(),Of._$name="TextField";var Lf=function(e){fe()(n,e);var t=Ff(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"doDestroy",value:function(){this.globalTapListener&&this.globalTapListener(),this.picker=null,we()(pe()(n.prototype),"doDestroy",this).call(this)}},{key:"finalizeInit",value:function(){we()(pe()(n.prototype),"finalizeInit",this).call(this);var e=this,t=e.element;!1===e.editable?(t.classList.add("b-not-editable"),nu.on({element:e.input,click:"onTriggerClick",thisObj:e})):e.globalTapListener=$r.on({globaltap:"showKeyboard",thisObj:e})}},{key:"changePicker",value:function(e,t){throw new Error("changePicker(oldPicker, newPicker) must be implemented in PickerField subclass implementations")}},{key:"onEditComplete",value:function(){we()(pe()(n.prototype),"onEditComplete",this).call(this),this.autoClosePicker()}},{key:"onElementResize",value:function(e){this.pickerVisible&&this.picker.requestAnimationFrame(this.picker.realign,null,this.picker),we()(pe()(n.prototype),"onElementResize",this).call(this,e)}},{key:"internalOnKeyEvent",value:function(e){var t=this,r=!0;if("keydown"===e.type&&!t.disabled)if(t.pickerVisible){var i=t.picker;"Escape"===e.key?(e.stopImmediatePropagation(),t.hidePicker(),r=!1):i.onInternalKeyDown?i.onInternalKeyDown(e):"ArrowDown"===e.key&&i.focusable&&i.focus()}else"ArrowDown"===e.key&&(e.stopImmediatePropagation(),e.preventDefault(),t.onTriggerClick(e));r&&we()(pe()(n.prototype),"internalOnKeyEvent",this).call(this,e)}},{key:"onFocusIn",value:function(e){we()(pe()(n.prototype),"onFocusIn",this).call(this,e),this.autoExpand&&(this.minChars=0,this.onTriggerClick(e))}},{key:"onFocusOut",value:function(e){this.autoClosePicker(),we()(pe()(n.prototype),"onFocusOut",this).call(this,e)}},{key:"onTriggerClick",value:function(e){this.disabled||this.togglePicker("key"in e)}},{key:"showKeyboard",value:function(e){var t=e.event,n=this.input;Cr.isTouchEvent&&Cr.activeElement===n&&t.target===n&&($r.suspendFocusEvents(),n.blur(),n.focus(),$r.resumeFocusEvents())}},{key:"togglePicker",value:function(e){this.pickerVisible?this.hidePicker():this.showPicker(e)}},{key:"showPicker",value:function(e){var t=this,n=t.picker;t.pickerHideShowListenersAdded||(n.on({show:"onPickerShow",hide:"onPickerHide",thisObj:t}),t.pickerHideShowListenersAdded=!0),n.autoClose=t.autoClose,n.show(),n.isVisible&&e&&t.focusPicker()}},{key:"onPickerShow",value:function(){var e=this;e.pickerVisible=!0,e.element.classList.add("b-open"),e.trigger("togglePicker",{show:!0}),e.pickerTapOutRemover=$r.on({globaltap:"onPickerTapOut",thisObj:e}),e.pickerKeyDownRemover=nu.on({element:e.picker.element,keydown:"onPickerKeyDown",thisObj:e})}},{key:"onPickerHide",value:function(){var e=this;e.pickerVisible=!1,e.element.classList.remove("b-open"),e.trigger("togglePicker",{show:!1}),e.pickerTapOutRemover&&e.pickerTapOutRemover(),e.pickerKeyDownRemover&&e.pickerKeyDownRemover()}},{key:"onPickerTapOut",value:function(e){var t=e.event;this.owns(t.target)||this.autoClosePicker()}},{key:"onPickerKeyDown",value:function(e){if("Tab"===e.key){var t=Cr.activeElement,n=new KeyboardEvent("keydown",e);this.input.dispatchEvent(n),n.defaultPrevented&&e.preventDefault(),Cr.activeElement===t?this.input.focus():e.preventDefault(),this.isDestroyed||this.hidePicker()}}},{key:"autoClosePicker",value:function(){this.autoClose&&this.hidePicker()}},{key:"hidePicker",value:function(){this.pickerVisible&&this.picker.hide()}},{key:"focusPicker",value:function(){}},{key:"focus",value:function(){var e=this.input;Cr.isTouchEvent&&this.editable&&(e.readOnly=!0,this.setTimeout((function(){return e.readOnly=!1}),500)),we()(pe()(n.prototype),"focus",this).call(this)}},{key:"childItems",get:function(){if(this._picker)return[this.picker]}}],[{key:"$name",get:function(){return"PickerField"}},{key:"type",get:function(){return"pickerfield"}},{key:"configurable",get:function(){return{editable:!0,pickerAlignElement:"inputWrap",value:null,triggers:{expand:{cls:"bars"}},autoClose:!0,autoExpand:null,picker:{value:{floating:!0},$config:"lazy"},inputType:"text",monitorResize:!0,nullValue:null}}}]),n}(Of);function jf(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Lf._$name="PickerField";var _f=function(e){fe()(n,e);var t=jf(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"updateOwnerCmp",value:function(e){this.itemSelector||(this.itemSelector=".".concat(this.ownerCmp.itemCls))}},{key:"onKeyDown",value:function(e){var t=this,n=t.ownerCmp,r=t.itemSelector,i=t.activeItem,o=t.itemsTabbable,a=e.target,s=t.target.querySelector(r),u=(e.key||"").trim()||e.code,c="".concat(e.ctrlKey?"CTRL+":"").concat(e.shiftKey?"SHIFT+":"").concat(e.altKey?"ALT+":"").concat(u),l=a.matches(r)||a===t.keyEventTarget;if(!t.disabled&&s&&t.target.offsetParent&&l){if(!o){if(null==t.inlineFlow){var f=s.parentNode,d=Cr.getStyleValue(s,"position"),h=Cr.getStyleValue(s,"display"),v=Cr.getStyleValue(s,"float");t.inlineFlow="absolute"===d||"inline"===h||"inline-block"===h||"left"===v||"right"===v||"flex"===Cr.getStyleValue(f,"display")&&"row"===Cr.getStyleValue(f,"flex-direction")}t.prevKey||(t.inlineFlow?(t.prevKey="ArrowLeft",t.nextKey="ArrowRight"):(t.prevKey="ArrowUp",t.nextKey="ArrowDown"))}if(t.processEvent&&!(e=t.processEvent.call(n,e)))return;if(i)switch(u){case t.prevKey:if(t.disabled||e.ctrlKey&&!t.allowCtrlKey)return;if(e.shiftKey&&!t.allowShiftKey)return;e.preventDefault(),t.navigatePrevious(e);break;case t.nextKey:if(t.disabled||e.ctrlKey&&!t.allowCtrlKey)return;if(e.shiftKey&&!t.allowShiftKey)return;e.preventDefault(),t.navigateNext(e);break;default:var p=t.keys&&t.keys[c];if(p&&!t.disabled?t.callback(p,t.thisObj||n,[e]):n.onInternalKeyDown&&n.onInternalKeyDown(e),Cr.activeElement!==a&&e.preventDefault(),o)return}else{if(o)return;t.activeItem=t.previousActiveItem||t.getDefaultNavigationItem(e)}t.activeItem!==i&&t.triggerNavigate(e)}}},{key:"getDefaultNavigationItem",value:function(e){var t=this.target,n=this.itemSelector,r=this.prevKey,i=this.nextKey;return 4&t.compareDocumentPosition(e.target)&&e.key===r?t.querySelector("".concat(n,":last-of-type")):2&t.compareDocumentPosition(e.target)&&e.key===i?t.querySelector("".concat(n)):void 0}},{key:"navigatePrevious",value:function(e){var t=this,n=t.previous;e.preventDefault(),n&&t.ownerCmp.scrollable.scrollIntoView(n,{animate:t.scrollDuration}).then((function(){t.activeItem=n,t.triggerNavigate(e)}))}},{key:"navigateNext",value:function(e){var t=this,n=t.next;e.preventDefault(),n&&t.ownerCmp.scrollable.scrollIntoView(n,{animate:t.scrollDuration}).then((function(){t.activeItem=n,t.triggerNavigate(e)}))}},{key:"getAdjacent",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.activeItem,n=this.treeWalker;if(n.currentNode=t,n[e<0?"previousNode":"nextNode"](),n.currentNode!==this.activeItem)return n.currentNode}},{key:"onTargetFocusIn",value:function(e){var t,n,r=this,i=e.target,o=r.itemsTabbable,a=r.skipScrollIntoView;if(!i.matches(".b-focus-trap"))if(i.matches(r.itemSelector))r.skipScrollIntoView=!0,r.activeItem=i,r.skipScrollIntoView=a,r.activeItem&&o&&r.triggerNavigate(e);else if(!o&&(null===(t=e.relatedTarget)||void 0===t||null===(n=t.matches)||void 0===n?void 0:n.call(t,r.itemSelector))){var s;null===(s=r.owner.previousSibling)||void 0===s||s.focus()}}},{key:"onTargetFocusOut",value:function(e){var t=this,n=e.relatedTarget;(null==n?void 0:n.matches(".b-focus-trap"))||n&&t.target.contains(n)&&n.matches(t.itemSelector)||t.activeItem&&(t.activeItem=null,t.itemsTabbable&&t.triggerNavigate(e))}},{key:"onTargetMouseDown",value:function(e){if(!1===this.ownerCmp.itemsFocusable)this.onFocusGesture(e);else{var t=e.target.closest(this.itemSelector);t&&(e.preventDefault(),Cr.focusWithoutScrolling(t))}}},{key:"onTargetClick",value:function(e){var t=this,n=t.skipScrollIntoView;t.disabled||(t.skipScrollIntoView=!0,t.processEvent&&(e=t.processEvent.call(t.ownerCmp,e)),e&&(t.activeItem=e.target.closest(t.itemSelector),t.triggerNavigate(e)),t.skipScrollIntoView=n)}},{key:"onFocusGesture",value:function(e){(e.target===this.ownerCmp.contentElement||e.target.closest(this.itemSelector)&&!1===this.ownerCmp.itemsFocusable)&&e.preventDefault()}},{key:"acceptNode",value:function(e){return e.offsetParent&&e.matches&&e.matches(this.itemSelector)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}},{key:"changeActiveItem",value:function(e){return null!=e&&this.ownerCmp.getItem&&(e=this.ownerCmp.getItem(e)),e}},{key:"updateActiveItem",value:function(e,t){var n=this,r=n.ownerCmp,i=t&&n.target.contains(t);if(i&&(n.previousActiveItem=t),null!=e){if(n.skipScrollIntoView||r.scrollable.scrollIntoView(e,{block:"nearest",focus:Cr.isFocusable(e)&&e!==Cr.activeElement,silent:n.scrollSilently}),e===t&&i)return;t&&t.classList.remove(n.focusCls),e.classList.add(n.focusCls),n._activeItem=e}else t&&(t.classList.remove(n.focusCls),t===Cr.activeElement&&r.revertFocus()),n._activeItem=null}},{key:"updateTarget",value:function(e,t){var n=this,r={element:e,thisObj:n,focusin:"onTargetFocusIn",focusout:"onTargetFocusOut"};n.itemsTabbable||(r.mousedown="onTargetMouseDown",r.click="onTargetClick"),Object.prototype.hasOwnProperty.call(n,"acceptNode")||(n.acceptNode=n.acceptNode.bind(n),n.acceptNode.acceptNode=n.acceptNode),nu.on(r),n.treeWalker=n.setupTreeWalker(e,NodeFilter.SHOW_ELEMENT,n.acceptNode,!1),n.keyEventTarget||(n.keyEventTarget=e),(n.targetMutationMonitor=new MutationObserver(n.onTargetChildListChange.bind(n))).observe(e,{childList:!0,subtree:!0})}},{key:"setupTreeWalker",value:function(e,t,n,r){return document.createTreeWalker(e,t,n,r)}},{key:"onTargetChildListChange",value:function(){var e=this.activeItem;e&&(this.target.contains(e)?e.classList.add(this.focusCls):this.activeItem=this.target.querySelector("".concat(this.itemSelector,'[data-id="').concat(e.dataset.id,'"]'))||null)}},{key:"changeKeyEventTarget",value:function(e){this._keyEventTarget=e,nu.on({element:e,keydown:"onKeyDown",thisObj:this})}},{key:"triggerNavigate",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.activeItem,r={event:e,item:n,oldItem:this.previousActiveItem};this.trigger("navigate",r),null===(t=this.ownerCmp)||void 0===t||t.trigger("navigate",r)}},{key:"owner",get:function(){return this.ownerCmp}},{key:"previous",get:function(){return this.getAdjacent(-1)}},{key:"next",get:function(){return this.getAdjacent(1)}}],[{key:"configurable",get:function(){return{ownerCmp:null,target:null,keyEventTarget:null,processEvent:null,itemSelector:null,activeItem:null,focusCls:"b-active",keys:null,allowCtrlKey:null,allowShiftKey:null,scrollDuration:50,disabled:null,testConfig:{scrollDuration:1}}}}]),n}(Ge(ue));function Bf(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Hf(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Hf(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Hf(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function $f(){var e=El()(['<div class="','" data-index="','" data-id="','" ',">\n            ","\n            </div>"]);return $f=function(){return e},e}function Nf(){var e=El()(["",""]);return Nf=function(){return e},e}function Vf(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}_f._$name="Navigator";var zf=document.createRange(),Wf=function(e){fe()(n,e);var t=Vf(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e){var t,r=this;Array.isArray(e)&&(e={items:e});for(var i=arguments.length,o=new Array(i>1?i-1:0),a=1;a<i;a++)o[a-1]=arguments[a];(t=we()(pe()(n.prototype),"construct",this)).call.apply(t,[this,e].concat(o));var s=r.element,u=s.classList;r.multiSelect&&u.add("b-multiselect"),r.store&&r.store.count?r.refresh():u.add("b-empty"),nu.on({element:s,delegate:r.itemSelector,mouseover:"onMouseOver",click:"onClick",thisObj:r})}},{key:"doDestroy",value:function(){var e;this.detachListeners("store"),null===(e=this.navigator)||void 0===e||e.destroy(),we()(pe()(n.prototype),"doDestroy",this).call(this)}},{key:"onFocusIn",value:function(e){var t=e._target.classList.contains(this.itemCls)?e._target.dataset.id:0;this.restoreActiveItem(this.navigator.previousActiveItem||this.getItem(t)),we()(pe()(n.prototype),"onFocusIn",this).call(this,e)}},{key:"contentTpl",value:function(){var e=this;return Iu.tpl(Nf(),this.store.records.map((function(t,n){return e.itemWrapperTpl(t,n)})))}},{key:"itemWrapperTpl",value:function(e,t){return Iu.tpl($f(),this.getItemClasses(e,t),t,e.id,this.itemsFocusable?'tabindex="-1"':"",this.itemContentTpl(e,t))}},{key:"itemContentTpl",value:function(e,t){return"".concat(this.itemIconTpl(e,t)).concat(this.itemTpl(e,t))}},{key:"itemIconTpl",value:function(e,t){return this.multiSelect?'<div class="b-selected-icon b-icon '.concat(this.selectIconCls,'"></div>'):""}},{key:"getItemClasses",value:function(e){var t,n=this,r=null===(t=n._navigator)||void 0===t?void 0:t.activeItem,i=(null==r?void 0:r.dataset.id)==e.id,o=n.selected.includes(e);return"".concat(n.itemCls," ").concat(e.cls||""," ").concat(o?n.selectedCls:""," ").concat(i?n.navigator.focusCls:"")}},{key:"onBeforeStoreLoad",value:function(){this.mask(this.L("L{loading}"))}},{key:"onAfterStoreRequest",value:function(){this.unmask()}},{key:"onStoreChange",value:function(e){e.source;var t=e.action,n=e.records,r=e.record;switch(t){case"remove":this.selected.remove(n);break;case"clear":this.selected.clear();break;case"update":return void this.refreshItem(r)}this.refresh()}},{key:"onStoreRefresh",value:function(){this.refresh()}},{key:"refresh",value:function(){var e=this;if(e.isVisible){var t=e.navigator.activeItem;e.paintListener=null,e.clearItems().insertNode(Cr.createElementFromTemplate(e.contentTpl(),{fragment:!0})),t&&e.restoreActiveItem(t),e.refreshCount=(e.refreshCount||0)+1,e.element.classList[e.store.count>0?"remove":"add"]("b-empty")}else e.paintListener||(e.paintListener=e.on({paint:"refresh",thisObj:e,once:!0}))}},{key:"clearItems",value:function(){var e=this,t=e.contentElement.querySelector(e.itemSelector),n=e.contentElement.lastChild;if(t){var r=e.contentElement.querySelectorAll("".concat(e.itemSelector,":not(.b-mask)"));zf.setStartBefore(t),zf.setEndAfter(r[r.length-1]),zf.deleteContents()}else n?(zf.setStartAfter(n),zf.setEndAfter(n)):(zf.setStart(e.contentElement,0),zf.setEnd(e.contentElement,0));return zf}},{key:"refreshItem",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];for(var r=0,i=t;r<i.length;r++){var o=i[r],a=this.getItem(o);if(a){var s=this.store.indexOf(o),u=Cr.createElementFromTemplate(this.itemWrapperTpl(o,s));Cr.sync(u,a)}}}},{key:"getItem",value:function(e){if(null!=e)return"number"==typeof e?this.contentElement.querySelector('[data-index="'.concat(e,'"]')):(1===e.nodeType&&(e=e.dataset.id),null!=e.id&&(e=e.id),this.contentElement.querySelector('[data-id="'.concat(e,'"]')))}},{key:"getRecord",value:function(e){return e.target&&(e=e.target),e=e.closest(this.itemSelector),this.store.getAt(parseInt(e.dataset.index))}},{key:"updateItems",value:function(e){this.store&&this.store.autoCreated&&this.store.destroy(),this.store=No.getStore(e)}},{key:"updateSelected",value:function(e){e&&e instanceof no||(e=new no(e)),this._selected=e,e.on({change:"onSelectionChange",thisObj:this})}},{key:"changeStore",value:function(e){if(e instanceof No||(e=new No(e)),this.detachListeners("store"),e){var t={name:"store",change:"onStoreChange",refresh:"onStoreRefresh",thisObj:this};e.readUrl&&(t.beforeLoad="onBeforeStoreLoad",t.afterRequest="onAfterStoreRequest"),e.on(t)}return e}},{key:"updateStore",value:function(){this.refresh()}},{key:"changeNavigator",value:function(e){var t=this.element;return t&&(e=new(e.class||_f)(Object.assign({ownerCmp:this,target:t,keyEventTarget:t},e))).keyEventTarget===t&&(t.tabIndex=0),e}},{key:"alignTo",value:function(){var e;sc()(pe()(n.prototype),"minHeight",this.minAlignHeight,this,!0);for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];(e=we()(pe()(n.prototype),"alignTo",this)).call.apply(e,[this].concat(r))}},{key:"hide",value:function(){var e;this.navigator.activeItem=null;for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];(e=we()(pe()(n.prototype),"hide",this)).call.apply(e,[this].concat(r))}},{key:"show",value:function(){var e=this.refreshCount,t=this.navigator.previousActiveItem;sc()(pe()(n.prototype),"minHeight",this._minHeight,this,!0),we()(pe()(n.prototype),"show",this).call(this),this.refreshCount===e&&this.restoreActiveItem(t,!0)}},{key:"restoreActiveItem",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.navigator.previousActiveItem,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"nearest",n=this,r=n.navigator,i=n.lastAlignSpec;if(null!=e){if("string"!=typeof t){var o=i?i.zone:1;t=1&o?"nearest":o?"start":"end"}(e=n.getItem(e))&&(n.scrollable.scrollIntoView(e,{block:t}),r.activeItem=e)}}},{key:"onMouseOver",value:function(e){var t=e.currentTarget;!Cr.isTouchEvent&&t&&this.navigator&&this.activateOnMouseover&&this.setTimeout({fn:"handleMouseOver",delay:30,args:[t],cancelOutstanding:!0})}},{key:"handleMouseOver",value:function(e){this.navigator.activeItem=e}},{key:"onClick",value:function(e){var t=e.target.closest(this.itemSelector);t&&this.onItemClick(t,e)}},{key:"onInternalKeyDown",value:function(e){var t=this.navigator.activeItem;switch(e.key){case" ":if("INPUT"===e.target.nodeName.toUpperCase()&&!e.target.readOnly)break;case"Enter":t&&(this.onItemClick(t,e),e.stopImmediatePropagation(),e.preventDefault())}}},{key:"onItemClick",value:function(e,t){var n=this,r=parseInt(e.dataset.index),i=n.store.getAt(r);if(n._isUserAction=!0,n.trigger("item",{item:e,record:i,index:r,event:t,userAction:!0}),!e.contains(t.target.closest("[data-noselect]"))){var o=n.selected,a=o.includes(i);n.multiSelect?(n.toggleAllIfCtrlPressed&&t.ctrlKey&&(i=n.store.getRange()),o[a?"remove":"add"](i)):o.splice(0,o.count,i)}n.lastClicked=i,n._isUserAction=!1}},{key:"onSelectionChange",value:function(e){var t,n,r=e.action,i=e.removed,o=e.added,a=(e.replaced,this),s=a.selectedCls,u=a.unselectedCls;if("clear"===r){var c,l=Bf(a.element.querySelectorAll(".".concat(s)));try{for(l.s();!(c=l.n()).done;)(n=c.value).classList.remove(s),u&&n.classList.remove(u)}catch(e){l.e(e)}finally{l.f()}}else{var f,d=Bf(i);try{for(d.s();!(f=d.n()).done;)t=f.value,(n=a.getItem(t))&&n.classList.remove(s)}catch(e){d.e(e)}finally{d.f()}var h,v=Bf(o);try{for(v.s();!(h=v.n()).done;)t=h.value,(n=a.getItem(t))&&n.classList.add(s)}catch(e){v.e(e)}finally{v.f()}}}},{key:"itemSelector",get:function(){return".".concat(this.itemCls)}},{key:"selected",get:function(){return this._selected}},{key:"store",get:function(){return this._thisIsAUsedExpression(this.items),this._store}},{key:"minAlignHeight",get:function(){var e=this.element.lastElementChild,t=this.minHeight;if(null!=t)return this.store.count?Math.min(e.offsetTop+e.offsetHeight,t):0}}],[{key:"$name",get:function(){return"List"}},{key:"type",get:function(){return"list"}},{key:"configurable",get:function(){return{itemCls:"b-list-item",selectedCls:"b-selected",selectIconCls:"b-icon-check",items:null,store:null,navigator:!0,scrollable:{x:!1,y:!0},itemsFocusable:!0,multiSelect:!1,toggleAllIfCtrlPressed:!1,itemTpl:function(e){return e.text},selected:{},activateOnMouseover:null}}}]),n}(oc);function Gf(){var e=El()(["","\n            ","\n            ",""]);return Gf=function(){return e},e}function Yf(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Wf.initClass(),Wf.prototype.navigatorClass=_f,Wf._$name="List";var Uf=function(e){fe()(n,e);var t=Yf(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"itemContentTpl",value:function(e,t){return Iu.tpl(Gf(),this.iconTpl?this.iconTpl(e):"",this.itemTpl(e,t),this.closable?'<div class="b-icon b-close-icon b-icon-clear" data-noselect></div>':"")}},{key:"onInternalKeyDown",value:function(e){this.closable&&this.selected.count&&("Delete"===e.key||"Backspace"===e.key)?this.callback(this.closeHandler,this.owner,[this.selected.values,{isKeyEvent:!0}]):we()(pe()(n.prototype),"onInternalKeyDown",this).call(this,e)}},{key:"updateClosable",value:function(e){this.element.classList[e?"add":"remove"]("b-chips-closable"),this.navigator.disabled=!e,this.isConfiguring||this.refresh()}},{key:"onClick",value:function(e){var t=this,r=e.target.closest(".".concat(t.itemCls));if(t.closable&&e.target.classList.contains("b-close-icon")){var i=t.store.getAt(parseInt(r.dataset.index));t.callback(t.closeHandler,t.owner,[[i]])}else we()(pe()(n.prototype),"onClick",this).call(this,e)}}],[{key:"$name",get:function(){return"ChipView"}},{key:"type",get:function(){return"chipview"}},{key:"configurable",get:function(){return{itemCls:"b-chip",closable:!0,iconTpl:null,closeHandler:null}}}]),n}(Wf);function qf(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Kf(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Uf.initClass(),Uf._$name="ChipView";var Xf=function(e){fe()(n,e);var t=Kf(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e){we()(pe()(n.prototype),"construct",this).apply(this,arguments),this.store||(this.items=[]),this.filterOnEnter&&(this.hideTrigger=!0)}},{key:"startConfigure",value:function(e){this.usingRecordAsValue=null===e.valueField,we()(pe()(n.prototype),"startConfigure",this).apply(this,arguments)}},{key:"afterConfigure",value:function(){we()(pe()(n.prototype),"afterConfigure",this).call(this),"_value"in this||(this._value=this.valueField===this.displayField?"":null)}},{key:"changeChipStore",value:function(e){return!e||e instanceof No||(e=new No(No.mergeConfigs({storage:this.valueCollection},e))),e}},{key:"updateChipStore",value:function(e,t){null==t||t.destroy()}},{key:"changeChipView",value:function(e,t){var n,r=this,i=r.input;return e&&!(n=r.chipStore)&&(r.chipStore={},n=r.chipStore),e||!r.multiSelect||r.isDestroying||(e={}),Zf.reconfigure(t,e,{defaults:{parent:r,insertBefore:i,store:n,closable:!r.readOnly,navigator:{class:Jf,keyEventTarget:i}}})}},{key:"updateChipView",value:function(e){var t,n=this;n._chipViewEventDetacher=null===(t=n._chipViewEventDetacher)||void 0===t?void 0:t.call(n),n.chipStore=null==e?void 0:e.store,e&&(e.element.appendChild(n.input),n._chipViewEventDetacher=nu.on({element:e.element,mousedown:"onChipViewMousedown",thisObj:n}))}},{key:"updateMultiSelect",value:function(e){var t,n=this,r=e?n.chipView:n._chipView,i=n.input,o=i.parentNode,a=!n.isConfiguring,s=n.value;n.element.classList[e?"add":"remove"]("b-multiselect"),e?(r||(n.chipView={type:"combochipview"}),(t=n.chipView.element)!==o&&(o.insertBefore(t,i),t.appendChild(i),n.chipView.refresh()),i.value="",a&&!Array.isArray(s)&&(s=s?[s]:null)):((t=null==r?void 0:r.element)===o&&(t.parentNode.insertBefore(i,t),t.remove()),a&&"string"!=typeof s&&(s=s&&s.length?s[0]:null)),a&&(n.value=s)}},{key:"onChipViewMousedown",value:function(e){e.preventDefault(),this.containsFocus||this.focus()}},{key:"onChipClose",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(t.isKeyEvent&&""===this.input.value||!t.isKeyEvent)&&(this._isUserAction=!0,this.valueCollection.remove(e),this._isUserAction=!1)}},{key:"updateFilterParamName",value:function(e){!1!==this.hideTrigger&&(this.hideTrigger=Boolean(e))}},{key:"updateHideTrigger",value:function(e){this.element.classList[e?"add":"remove"]("b-hide-trigger")}},{key:"updateKeyStrokeFilterDelay",value:function(e){e&&(this.filterList=this.buffer(this.doFilter,e))}},{key:"updateReadOnly",value:function(e){we()(pe()(n.prototype),"updateReadOnly",this).apply(this,arguments),this._chipView&&(this._chipView.closable=!e)}},{key:"changeItems",value:function(e){var t=this;if(null==e){if(t.store&&!t.store.isItemStore)return;e=[]}if(e instanceof No)t.store=e;else{var n,r,i=t.displayField,o=t.valueField;if(Array.isArray(e)?r=e.map((function(e){var r,a,s=e;e instanceof Bi?(n=e.constructor,o||(t.valueField=o=n.idField)):"string"==typeof e||"number"==typeof e?(o||(t.valueField=o=t.displayField),r={},ke()(r,o,e),ke()(r,i,e),s=r):(o||(t.valueField=o="value"),Array.isArray(e)&&(a={},ke()(a,o,e[0]),ke()(a,i,e[1]),s=a));return s.selected&&(t.value=s),s})):(o||(t.valueField=o="value"),r=[],Object.entries(e).forEach((function(e){var t,n=ye()(e,2),a=n[0],s=n[1];r.push((t={},ke()(t,o,a),ke()(t,i,s),t))}))),t.store)t.store.data=r;else{var a=o===i?{name:"value",dataSource:i}:o;t.store=new No({isItemStore:!0,data:r,idField:o,modelClass:n||function(e){fe()(r,e);var n=Kf(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,null,[{key:"idField",get:function(){return t.valueField},set:function(e){sc()(pe()(r),"idField",e,this,!0)}},{key:"fields",get:function(){return[a,i]}}]),r}(Bi)})}}}},{key:"changeValue",value:function(e,t){var n=this;if(e!==t){if(!n.multiSelect&&Array.isArray(e)&&e.length>1)throw new Error("Multiple values cannot be set to a non-multiSelect Combo");n.triggerConfig("items");var r,i=n.valueField,o=n.displayField,a=n.store,s=n.valueCollection;if(n.remoteFilter){if(null!=e){if("object"!==l()(e)){var u=n.isConfiguring;return n.primaryFilter.setConfig({value:e,disabled:!1}),void a.performFilter(!0).then((function(){var e=n.isConfiguring;n.isConfiguring=u,s.splice(0,s.count,a.allRecords),n.isConfiguring=e}))}this.store.data=[e],this.valueCollection.splice(0,this.valueCollection.count,this.store.first)}}else a.filtered&&(n.primaryFilter.disabled=!0,a.filter());if(null!=e){for(var c=Array.isArray(e),f=c?e.slice():[e],d=0,h=f.length;d<h;d++){var v=f[d];if(v instanceof Bi)a.storage.includes(v)||a.add(v);else{var p=an.isObject(v);p&&(v=v[i]),(r=a.storage.getBy(o,v)||a.storage.getBy(i,v))?(p&&r.set(f[d]),f[d]=r):(f.splice(d,1),h--,d--)}}var g=s.generation;s.splice(0,s.count,f),s.generation===g&&n.syncInputFieldValue(),f.length||(n._value=c?f[0]||null:e)}else if(s.count)s.clear();else{var y=n._value;n._value=null,n.syncInputFieldValue(),n.syncEmpty(),n.isConfiguring||n.triggerFieldChange({value:e,oldValue:y,userAction:n._isUserAction,valid:n.isValid})}n._lastValue=n.value}else n.syncInputFieldValue(!0)}},{key:"onComboStoreChange",value:function(e){"filter"!==e.action&&this.syncInputFieldValue(!0)}},{key:"syncInputFieldValue",value:function(e){this.multiSelect||we()(pe()(n.prototype),"syncInputFieldValue",this).call(this,e)}},{key:"changePrimaryFilter",value:function(e){return e instanceof Vi||("function"==typeof e&&(e={filterBy:e}),e=new Vi(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?qf(Object(n),!0).forEach((function(t){ke()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):qf(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({id:"primary",disabled:!0,property:this.displayField,operator:this.filterOperator,caseSensitive:this.caseSensitive},e))),e}},{key:"changeStore",value:function(e){if(!Array.isArray(e)){if(e){"string"==typeof e?e=No.getStore(e):an.isObject(e)&&(e=new(e.readUrl?Uo:No)(e));var t=this,n=t.remoteFilter||e.restfulFilter,r=t.filterParamName,i=[];n&&r&&(e.filterParamName=r,t.encodeFilterParams&&(e.encodeFilterParams=t.encodeFilterParams)),t.valueField||t.usingRecordAsValue||(t.valueField=e.modelClass.idField),i.push(t.primaryFilter),n?t.filterSelected&&(e.storage.autoFilter=!0,e.storage.addFilter({id:"".concat(t.id,"-selected-filter"),filterBy:function(e){return!t.valueCollection.includes(e)}})):t.filterSelected&&(t.selectedItemsFilter=function(e){return!t.valueCollection.includes(e)},i.push(t.selectedItemsFilter),e.reapplyFilterOnAdd=!0),e.filter(i)}return e}this.items=e}},{key:"updateStore",value:function(e){var t,n=this,r=n._picker;r&&(r.store=e),e.storage.addIndex(n.displayField),e.storage.addIndex(n.valueField),n.remoteFilter&&(t={filter:"onRemoteFilter"}),n.displayValueRenderer&&((t||(t={})).change="onComboStoreChange",n.syncInputFieldValue()),n.detachListeners("store"),t&&(t.name="store",t.thisObj=n,e.on(t))}},{key:"onEditComplete",value:function(){var e=this,t=e.valueCollection.count;we()(pe()(n.prototype),"onEditComplete",this).call(this),t&&(e.clearError("L{Field.validateFilter}"),e.syncInputFieldValue()),e.required&&!t&&e.setError("L{Field.fieldRequired}")}},{key:"onTriggerClick",value:function(){var e,t=this;if(!t.remoteFilter||!t.filterOnEnter)if(t.pickerVisible)t.hidePicker();else if(!t.readOnly&&!t.disabled)switch(null===(e=t.triggerAction)||void 0===e?void 0:e.toLowerCase()){case"all":t.doFilter(null);break;case"last":t.doFilter(t.lastQuery);break;default:t.doFilter(t.input.value)}}},{key:"internalOnInput",value:function(e){var t=this,n=t.input.value,r=n.length;t.editable&&(t.syncEmpty(),t.syncInputWidth(),t.inputting=!0,r>=t.minChars&&!t.filterOnEnter?t.filterList(n):(t.validateFilter&&!t.remoteFilter&&t[r?"setError":"clearError"]("L{Field.validateFilter}"),t.hidePicker()),t.inputting=!1,t.trigger("input",{value:n,event:e}))}},{key:"syncInputWidth",value:function(){var e=this;if(e.multiSelect){var t=e.input,n=e._inputPadding||(e._inputPadding=Cr.getEdgeSize(t,"padding","lr")),r=t.value||"",i=Cr.measureText(r+"W",t,!1,e.element)+n.width;t.style.flex="1 1 ".concat(Math.ceil(i),"px")}}},{key:"filterList",value:function(e){this.doFilter(e)}},{key:"doFilter",value:function(e){var t=this,n=t.store,r=t._picker,i=null==e||""===e;t.lastQuery=e,t.primaryFilter.setConfig({value:e,disabled:i}),t.remoteFilter&&n.clear(!0),t.getConfig("picker"),n.filter(),(null==r?void 0:r.isVisible)?0===r.lastAlignSpec.zone&&r.realign():t.showPicker(),n.count?i||(t.picker.navigator.activeItem=0):t.remoteFilter||i||!t.validateFilter||t.setError("L{Field.validateFilter}")}},{key:"onRemoteFilter",value:function(){var e=this,t=e._picker;e.store.count?t&&(t.navigator.activeItem=0):e.validateFilter&&e.setError("L{Field.validateFilter}"),e.filterSelected&&e.valueCollection.count&&(e.store.storage.onFiltersChanged(),t&&t.refresh())}},{key:"onValueCollectionChange",value:function(e){var t,n=e.source,r=this,i=r.multiSelect,o=r._picker,a=null!==(t=r.hidePickerOnSelect)&&void 0!==t?t:!i,s=i?n.values.slice():n.first,u=n.values.slice(),c=r._isUserAction||(null==o?void 0:o._isUserAction)||a&&r.pickerVisible||!1,l=r._value;a&&r.hidePicker(),!n.count&&r.required?r.setError("L{Field.fieldRequired}"):(r.clearError("L{Field.fieldRequired}"),r.clearError("L{Field.validateFilter}")),r.validateFilter&&s&&r.clearError("L{Field.validateFilter}"),r.filterSelected&&(r.remoteFilter?(r.store.storage.onFiltersChanged(),r._picker&&r._picker.refresh()):r.store.filter()),r._value=null;var f=r._value=r.value;r.syncInputFieldValue(),r.syncEmpty(),r.isConfiguring||(r.triggerFieldChange({value:f,oldValue:l,userAction:c,valid:r.isValid}),r.trigger("select",{record:s,records:u,userAction:c}),"select"===r.defaultAction&&r.trigger("action",{value:f,record:s,records:u,userAction:c}))}},{key:"onValueCollectionNoChange",value:function(e){var t=e.toAdd;!this.multiSelect&&t.length&&this.pickerVisible&&this.picker.hide()}},{key:"showPicker",value:function(){var e=this,t=e.picker;e.readOnly||(t.multiSelect=e.multiSelect,we()(pe()(n.prototype),"showPicker",this).call(this),e.overlayAnchor&&!t.align.offset&&(t.align.offset=-t.anchorSize[1],t.realign()),!e.multiSelect&&e.selected&&t.restoreActiveItem(e.selected,!0),e.input.focus())}},{key:"changePicker",value:function(e,t){var n,r=this,i=r.pickerWidth||(null===(n=e)||void 0===n?void 0:n.width);return(e=Wf.reconfigure(t,e?Wf.mergeConfigs({owner:r,store:r.store,selected:r.valueCollection,multiSelect:r.multiSelect,cls:r.listCls,itemTpl:r.listItemTpl||function(e){return e[r.displayField]},forElement:r[r.pickerAlignElement],align:{matchSize:null==i,anchor:r.overlayAnchor,target:r[r.pickerAlignElement],minHeight:40*Math.min(3,r.store.count)},width:i,navigator:{keyEventTarget:r.input}},e):null,r))&&(e.element.dataset.emptyText=r.emptyText||r.L("L{noResults}")),e}},{key:"onPickerHide",value:function(){we()(pe()(n.prototype),"onPickerHide",this).call(this),this.multiSelect&&this.clearTextOnPickerHide&&(this.input.value="")}},{key:"internalOnKeyEvent",value:function(e){var t=this,r=t.input.value,i=r.length;we()(pe()(n.prototype),"internalOnKeyEvent",this).apply(this,arguments),"keydown"===e.type&&"Enter"===e.key&&t.filterOnEnter&&i>=t.minChars&&(e.stopPropagation(),t.filterList(r))}},{key:"childItems",get:function(){var e=this._chipView,t=this._picker,n=[];return e&&n.push(e),t&&n.push(t),n}},{key:"minChars",get:function(){var e=this._minChars;return null!=e?e:this.remoteFilter?4:1}},{key:"items",get:function(){return this.store.allRecords}},{key:"value",get:function(){var e=this.valueCollection,t=this.valueField;return null==t?this.multiSelect?e.values.slice():e.first:this.multiSelect?e.map((function(e){return e[t]})):e.count?e.first[t]:this._value},set:function(e){sc()(pe()(n.prototype),"value",e,this,!0)}},{key:"isEmpty",get:function(){return 0===this.valueCollection.count}},{key:"inputValue",get:function(){var e=this,t=e.value;return t=e.selected?e.selected[e.displayField]:t,e.displayValueRenderer&&(t=e.callback(e.displayValueRenderer,e,[e.selected,e])),null==t?"":t}},{key:"valueCollection",get:function(){var e=this._valueCollection;return e||(this._valueCollection=e=new no({listeners:{noChange:"onValueCollectionNoChange",change:"onValueCollectionChange",prio:-1e3,thisObj:this}})),e}},{key:"remoteFilter",get:function(){var e;return Boolean(this.filterParamName||(null===(e=this._store)||void 0===e?void 0:e.restfulFilter))}},{key:"record",get:function(){return this.selected}},{key:"records",get:function(){return this.valueCollection.values.slice()}},{key:"selected",get:function(){return this.valueCollection.first}}],[{key:"$name",get:function(){return"Combo"}},{key:"type",get:function(){return"combo"}},{key:"alias",get:function(){return"combobox,dropdown"}},{key:"configurable",get:function(){return{primaryFilter:{},picker:{type:"list",floating:!0,scrollAction:"realign",itemsFocusable:!1,activateOnMouseover:!0,align:{align:"t0-b0",axisLock:!0},maxHeight:324,scrollable:{overflowY:!0},autoShow:!1,focusOnHover:!1},multiSelect:null,items:null,store:null,valueField:void 0,displayField:"text",pickerWidth:null,minChars:null,selected:null,listItemTpl:null,displayValueRenderer:null,listCls:null,triggers:{expand:{cls:"b-icon-picker",handler:"onTriggerClick"}},filterParamName:null,encodeFilterParams:function(e){return e.map((function(e){return e.value}))},filterOnEnter:!1,hideTrigger:null,overlayAnchor:null,keyStrokeFilterDelay:null,defaultAction:"select",triggerAction:"all",filterOperator:"startsWith",caseSensitive:!1,hidePickerOnSelect:null,chipView:{$config:["lazy","nullify"],value:{type:"combochipview"}},chipStore:{$config:["lazy","nullify"],value:{}},filterSelected:null,emptyText:null,value:null,validateFilter:!0,clearTextOnPickerHide:!0}}},{key:"queryLast",get:function(){return"last"}}]),n}(Lf),Zf=function(e){fe()(n,e);var t=Kf(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"$name",get:function(){return"ComboChipView"}},{key:"type",get:function(){return"combochipview"}},{key:"defaultConfig",get:function(){return{closeHandler:"up.onChipClose",itemsFocusable:!1,multiSelect:!0,itemTpl:function(e){return e[this.owner.displayField]},scrollable:{overflowY:"auto"}}}}]),n}(Uf),Jf=function(e){fe()(n,e);var t=Kf(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"onTargetClick",value:function(e){var t=e.target.closest(this.itemSelector);!t||e.shiftKey||t.contains(e.target.closest("[data-noselect]"))||this.ownerCmp.selected.clear(),this.inClickHandler=!0,this.activeItem=t,this.inClickHandler=!1}},{key:"onKeyDown",value:function(e){"Enter"!==e.key&&we()(pe()(n.prototype),"onKeyDown",this).call(this,e)}},{key:"updateActiveItem",value:function(e,t){var r=this.ownerCmp;we()(pe()(n.prototype),"updateActiveItem",this).call(this,e,t),e&&!this.inClickHandler&&r.selected.add(r.getRecord(e))}},{key:"navigatePrevious",value:function(e){var t=this.ownerCmp;t.navigator.activeItem&&!e.shiftKey&&t.selected.clear(),this.previous?we()(pe()(n.prototype),"navigatePrevious",this).call(this,e):this.activeItem=null}},{key:"navigateNext",value:function(e){var t=this.ownerCmp;t.navigator.activeItem&&!e.shiftKey&&t.selected.clear(),this.next?we()(pe()(n.prototype),"navigateNext",this).call(this,e):this.activeItem=null}}],[{key:"defaultConfig",get:function(){return{allowShiftKey:!0}}}]),n}(_f);function Qf(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Xf.initClass(),Zf.initClass(),Xf._$name="Combo";var ed=function(e){fe()(n,e);var t=Qf(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"changeStore",value:function(e,t){var r=this;return we()(pe()(n.prototype),"changeStore",this).call(this,new No({data:[{id:r.positiveValue,text:r.positiveText||r.L("L{Object.Yes}")},{id:r.negativeValue,text:r.negativeText||r.L("L{Object.No}")}]}),t)}}],[{key:"$name",get:function(){return"BooleanCombo"}},{key:"type",get:function(){return"booleancombo"}},{key:"configurable",get:function(){return{positiveValue:!0,positiveText:null,negativeValue:!1,negativeText:null,store:{value:[],$config:"lazy"},value:!1}}}]),n}(lt(Xf));function td(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}ed.initClass(),ed._$name="BooleanCombo";var nd=function(e){fe()(n,e);var t=td(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"updateReadOnly",value:function(e){this.element.style.pointerEvents=e?"none":""}},{key:"onChildAdd",value:function(e){we()(pe()(n.prototype),"onChildAdd",this).call(this,e),e.on({click:"onItemClick",thisObj:this})}},{key:"onChildRemove",value:function(e){e.un({click:"onItemClick",thisObj:this}),we()(pe()(n.prototype),"onChildAdd",this).call(this,e)}},{key:"onItemClick",value:function(){this._value=null}},{key:"createWidget",value:function(e){var t=this;return t.constructor.resolveType(e.type||"button").isButton&&(t.color&&!e.color&&(e.color=t.color),t.toggleGroup&&!e.toggleGroup&&("boolean"==typeof t.toggleGroup&&(t.toggleGroup=n.generateId("toggleGroup")),e.toggleGroup=t.toggleGroup)),t.columns&&(e.width="".concat(100/t.columns,"%")),we()(pe()(n.prototype),"createWidget",this).call(this,e)}},{key:"value",get:function(){if(!this._value){var e=[];this.items.forEach((function(t){t.pressed&&void 0!==t.value&&e.push(t.value)})),this._value=e.join(this.valueSeparator)}return this._value},set:function(e){Array.isArray(e)||(e=null==e?[]:"string"==typeof e?e.split(this.valueSeparator):[e]),this._value=e,this.items.forEach((function(t){void 0!==t.value&&(t.pressed=e.indexOf(t.value)>-1)}))}},{key:"disabled",get:function(){return we()(pe()(n.prototype),"disabled",this)},set:function(e){sc()(pe()(n.prototype),"disabled",e,this,!0),this.items.forEach((function(t){return t.disabled=e}))}},{key:"widgetClassList",get:function(){var e=we()(pe()(n.prototype),"widgetClassList",this);return this.columns&&e.push("b-columned"),e}}],[{key:"$name",get:function(){return"ButtonGroup"}},{key:"type",get:function(){return"buttongroup"}},{key:"configurable",get:function(){return{defaultType:"button",cls:null,items:null,color:null,toggleGroup:null,valueSeparator:",",columns:null}}}]),n}(Rl);function rd(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}nd.initClass(),nd._$name="ButtonGroup";var id=function(e){fe()(n,e);var t=rd(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e){we()(pe()(n.prototype),"construct",this).call(this,e),this.refreshCount||this.refresh()}},{key:"onPaint",value:function(e){e.firstPaint&&(this.refreshCount||this.refresh(),this.getConfig("minColumnWidth"),this.getConfig("minRowHeight"))}},{key:"doDestroy",value:function(){this.tip&&this.tip.destroy(),we()(pe()(n.prototype),"doDestroy",this).call(this)}},{key:"changeMinRowHeight",value:function(e){var t=parseInt(Cr.getStyleValue(this.element,"--min-row-height"),10)||75;return null==e?e:Math.max(parseInt(e)||0,t)}},{key:"updateMinRowHeight",value:function(e){this.weekElements.forEach((function(t){return Cr.setLength(t,"flexBasis",e)})),this.scrollable={overflowY:!!e&&"auto"}}},{key:"changeMinColumnWidth",value:function(e){var t=parseInt(Cr.getStyleValue(this.element,"--min-column-width"),10)||75;return null==e?e:Math.max(parseInt(e)||0,t)}},{key:"updateMinColumnWidth",value:function(e){var t=this;t.weekdayCells.forEach((function(t){return Cr.setLength(t,"minWidth",e)})),t.cellElements.forEach((function(n){return n.matches(".".concat(t.dayCellCls))&&Cr.setLength(n,"minWidth",e)})),t.scrollable={overflowX:!!e&&"auto"},t.overflowElement.classList[e?"add":"remove"]("b-min-columnwidth")}},{key:"getDateFromEvent",value:function(e){var t=(1===e.nodeType?e:e.target).closest("#".concat(this.id," [data-date]"));if(t)return Zt.parseKey(t.dataset.date)}},{key:"changeTip",value:function(e,t){var n={pointerOver:"onTipOverCell",thisObj:this};return t&&t.un(n),e&&(e instanceof oc||(e=oc.create(Object.assign({owner:this,type:"tooltip",id:"".concat(this.id,"-cell-tip"),forElement:this.bodyElement,forSelector:".".concat(this.dayCellCls)},e))),e.on(n)),e}},{key:"changeElement",value:function(e){var t=this;e=we()(pe()(n.prototype),"changeElement",this).apply(this,arguments),t.updateHideNonWorkingDays(t.hideNonWorkingDays),t.weekElements=Array.from(e.querySelectorAll(".b-calendar-week")),t.weekDayElements=Array.from(e.querySelectorAll(".b-calendar-days")),t.cellElements=[];for(var r=0,i=t.weekDayElements.length;r<i;r++){var o;(o=t.cellElements).push.apply(o,[t.weekDayElements[r].previousSibling].concat(d()(t.weekDayElements[r].children)))}return e}},{key:"changeDate",value:function(e){if(e="string"==typeof e?Zt.parse(e):new Date(e),isNaN(e))throw new Error("CalendarPanel date ingestion must be passed a Date, or a YYYY-MM-DD date string");return Zt.clearTime(e)}},{key:"updateDate",value:function(e){this.month.date=e}},{key:"updateDayNameFormat",value:function(){var e=new Date("2000-06-04T12:00:00");this.shortDayNames=[];for(var t=4;t<11;t++)e.setDate(t),this.shortDayNames.push(Zt.format(e,this.dayNameFormat))}},{key:"updateWeekStartDay",value:function(e){var t=this;if(t._month){t.month.weekStartDay=e,t.dayNames=[];for(var n=0;n<7;n++)t.dayNames[n]=t.shortDayNames[t.canonicalDayNumbers[n]];t.refresh()}}},{key:"updateHideNonWorkingDays",value:function(e){var t;this.contentElement.classList[e?"add":"remove"](this.hideNonWorkingDaysCls),null===(t=this.scrollable)||void 0===t||t.syncOverflowState(),this._month&&(this.month.hideNonWorkingDays=e)}},{key:"changeNonWorkingDays",value:function(e){return an.assign({},e)}},{key:"updateNonWorkingDays",value:function(e){var t;this._month&&(this.month.nonWorkingDays=e,this.refresh(),null===(t=this.scrollable)||void 0===t||t.syncOverflowState())}},{key:"changeMonth",value:function(e,t){var n=this;if(!(e instanceof rf)){if("number"==typeof e){if(t)return void(t.month=e);var r=n.date||Zt.clearTime(new Date);r.setMonth(e),e={date:r}}e=new rf(an.assign({weekStartDay:n.weekStartDay,nonWorkingDays:n.nonWorkingDays,hideNonWorkingDays:n.hideNonWorkingDays,sixWeeks:n.sixWeeks},e))}return e.on({dateChange:"onMonthDateChange",thisObj:n}),e}},{key:"onMonthDateChange",value:function(e){var t=e.source,n=e.newDate,r=e.oldDate;this.year=t.year,this.isConfiguring||(this.refresh(),r-n&&this.trigger("dateChange",{value:n,oldValue:r}))}},{key:"updateYear",value:function(e){this.month.year=e}},{key:"updateShowWeekNumber",value:function(e){this.updateShowWeekColumn(e)}},{key:"updateShowWeekColumn",value:function(e){this.element.classList[e?"add":"remove"]("b-show-week-column"),this.floating&&(this.isAligning||this.realign())}},{key:"refresh",value:function(){this.doRefresh()}},{key:"doRefresh",value:function(){this.getConfig("element");var e=this,t=Zt.clearTime(new Date),n=e.cellElements,r=e.weekElements,i=e.weekDayElements,o=e.date,a=e.month,s=e.dayCellCls,u=e.disabledCls,c=e.otherMonthCls,l=e.weekendCls,f=e.todayCls,h=e.nonWorkingDayCls,v=e.canonicalDayNumbers;o||(e.date=t),e.getConfig("dayNameFormat");for(var p=0,g=n.length;p<g;p++)n[p].lastDomConfig=null,n[p].className=s;for(var y=0;y<7;y++){var m=e.weekdayCells[y],k=e.canonicalDayNumbers[y],b=m.classList;m.className=m.innerHTML="",e.headerRenderer?e.headerRenderer(m,y,k):m.innerHTML=e.shortDayNames[k],b.add("b-calendar-day-header"),0!==k&&6!==k||b.add(l),e.nonWorkingDays[k]&&b.add(h),m.dataset.columnIndex=y,m.dataset.cellDay=k}for(var w=0,C=0,S=6,D=6;D>=0;D--)if(!e.nonWorkingDays[v[D]]){S=D;break}a.eachWeek((function(n,o){var s=i[w],v=[s.previousSibling].concat(d()(s.children));r[w].dataset.week="".concat(n[0],",").concat(n[1]),v[0].className="b-week-number-cell",e.weekRenderer?e.weekRenderer(v[0],n):v[0].innerHTML=n[1];for(var p=0;p<7;p++){var g=o[p],y=g.getDay(),m=v[p+1],k=m.classList;e.isDisabledDate(g)&&k.add(u),g.getMonth()!==a.month&&k.add(c),0!==y&&6!==y||k.add(l),g.getTime()===t.getTime()&&k.add(f),e.nonWorkingDays[y]&&k.add(h),k[p===S?"add":"remove"]("b-last-working-day"),m.dataset.date=Zt.makeKey(g),m.dataset.cellIndex=C,m.dataset.columnIndex=p,e.cellRenderer?e.cellRenderer({cell:m,date:g,day:y,cellIndex:C,columnIndex:p,visibleColumnIndex:e.visibleDayColumnIndex[y],week:n}):m.innerHTML=g.getDate(),C++}w++})),e.floating&&(e.isAligning||e.realign()),e.refreshCount=(e.refreshCount||0)+1,e.trigger("refresh")}},{key:"isDisabledDate",value:function(e){var t=e.getDay(),n=this.disabledDates;if(this.disableWeekends&&(0===t||6===t))return!0;if(n){if("function"==typeof n)return n(e);if(Array.isArray(n))return e=Zt.clearTime(e,!0),n.some((function(t){return!(Zt.clearTime(t,!0)-e)}))}}},{key:"getCell",value:function(e){return"string"!=typeof e&&(e=Zt.makeKey(e)),this.weeksElement.querySelector('[data-date="'.concat(e,'"]'))}},{key:"onTipOverCell",value:function(e){var t=e.source,n=e.target;t.date=Zt.parseKey(n.dataset.date)}},{key:"updateLocalization",value:function(){this.updateDayNameFormat(),this.updateWeekStartDay(this.weekStartDay),we()(pe()(n.prototype),"updateLocalization",this).call(this)}},{key:"overflowElement",get:function(){return this.weeksElement}},{key:"weekStartDay",get:function(){return"number"==typeof this._weekStartDay?this._weekStartDay:Zt.weekStartDay}},{key:"visibleDayColumnIndex",get:function(){return this.month.visibleDayColumnIndex}},{key:"dayColumnIndex",get:function(){return this.month.dayColumnIndex}},{key:"canonicalDayNumbers",get:function(){return this.month.canonicalDayNumbers}},{key:"visibleColumnCount",get:function(){return this.month.visibleColumnCount}},{key:"weekLength",get:function(){return this.month.weekLength}},{key:"startDate",get:function(){return this.month.startDate}},{key:"duration",get:function(){return Zt.diff(this.month.startDate,this.month.endDate,"day")+1}},{key:"endDate",get:function(){var e=this.month.endDate;if(e)return Zt.add(e,1,"day")}},{key:"bodyConfig",get:function(){var e=we()(pe()(n.prototype),"bodyConfig",this),t=[];e.children=[{tag:"div",className:"b-calendar-row b-calendar-weekdays",reference:"weekdaysHeader",children:this.dayNameCells},{className:"b-weeks-container notranslate",reference:"weeksElement",children:t}];for(var r=0;r<6;r++){for(var i={className:"b-calendar-row b-calendar-week",children:[{},{className:"b-calendar-days",children:[]}]},o=0;o<7;o++)i.children[1].children.push({});t.push(i)}return e}},{key:"dayNameCells",get:function(){var e=document.createElement("div"),t=[e];this.weekdayCells=[],e.className="b-week-number-cell";for(var n=0;n<7;n++){var r=document.createElement("div");t.push(r),this.weekdayCells.push(r)}return t}},{key:"firstVisibleDate",get:function(){for(var e=this.month.startDate;;e.setDate(e.getDate()+1))if(!this.hideNonWorkingDays||!this.nonWorkingDays[e.getDay()])return e}}],[{key:"$name",get:function(){return"CalendarPanel"}},{key:"type",get:function(){return"calendarpanel"}},{key:"configurable",get:function(){return{textContent:!1,date:{$config:{equal:"date"},value:null},month:{},year:null,weekStartDay:!1,sixWeeks:!0,showWeekNumber:null,showWeekColumn:null,disabledDates:null,headerRenderer:null,weekRenderer:null,cellRenderer:null,disableWeekends:null,hideNonWorkingDays:null,hideNonWorkingDaysCls:"b-hide-nonworking-days",nonWorkingDays:{0:!0,6:!0},tip:null,dayCellCls:"b-calendar-cell",disabledCls:"b-disabled-date",otherMonthCls:"b-other-month",weekendCls:"b-weekend",todayCls:"b-today",nonWorkingDayCls:"b-nonworking-day",dayNameFormat:"ddd",minRowHeight:{$config:["lazy"],value:null},minColumnWidth:{$config:["lazy"],value:null}}}}]),n}(Nl);function od(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}id.initClass(),id._$name="CalendarPanel";var ad=function(e){fe()(n,e);var t=od(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e){"checked"in e&&((e=an.assign({},e)).value=e.checked,delete e.checked),we()(pe()(n.prototype),"construct",this).call(this,e),this.syncHasText()}},{key:"syncHasText",value:function(){this.element.classList[this.text?"add":"remove"]("b-text")}},{key:"updateText",value:function(e){this.textLabel&&(this.syncHasText(),this.textLabel.innerHTML=e)}},{key:"changeValue",value:function(e){return"false"!==e&&Boolean(e)}},{key:"updateValue",value:function(e){var t=this;t.inputting||(t.inputting=!0,t.input.checked=e,t.inputting=!1,t.uncheckToggleGroupMembers(),t.isConfiguring||t.triggerChange(!1))}},{key:"updateColor",value:function(e,t){var n=this.element.classList;t&&n.remove(t),e&&n.add(e)}},{key:"getToggleGroupMembers",value:function(){var e=this.checked,t=this.toggleGroup,n=this.input,r=[];return e&&t&&Cr.forEachSelector("input[type=checkbox][data-group=".concat(t,"]"),(function(e){if(e!==n){var t=oc.fromElement(e);t&&r.push(t)}})),r}},{key:"uncheckToggleGroupMembers",value:function(){this.checked&&this.toggleGroup&&this.getToggleGroupMembers().forEach((function(e){return e.checked=!1}))}},{key:"updateReadOnly",value:function(e){this.input.disabled=e,we()(pe()(n.prototype),"updateReadOnly",this).call(this,e)}},{key:"check",value:function(){this.checked=!0}},{key:"uncheck",value:function(){this.checked=!1}},{key:"toggle",value:function(){this.checked=!this.checked}},{key:"internalOnChange",value:function(e){var t=this;t.inputting||(t.inputting=!0,t.value=t.input.checked,t.triggerChange(!0),t.inputting=!1)}},{key:"triggerChange",value:function(e){var t=this,n=t.input.checked;(!n&&e&&t.toggleGroup&&t.getToggleGroupMembers().filter((function(e){return e.isVisible&&!e.disabled})).length||!t.callPreventable("change",{checked:n,value:n,userAction:e,valid:!0},(function(n){return t.triggerFieldChange(n,!1),e&&t.uncheckToggleGroupMembers(),t.trigger("action",n),!0})))&&(t.input.checked=t._value=!n)}},{key:"innerElements",get:function(){return[this.inputElement,{tag:"label",class:"b-checkbox-label",for:"".concat(this.id,"-input"),reference:"textLabel",html:this.text||""}]}},{key:"inputElement",get:function(){var e=we()(pe()(n.prototype),"inputElement",this);return this.toggleGroup&&(e.dataset={group:this.toggleGroup}),e}},{key:"checked",get:function(){return this.value},set:function(e){this.value=e}},{key:"inputValueAttr",get:function(){return"checked"}}],[{key:"$name",get:function(){return"Checkbox"}},{key:"type",get:function(){return"checkbox"}},{key:"alias",get:function(){return"check"}},{key:"configurable",get:function(){return{inputType:"checkbox",text:"",color:null,value:"",toggleGroup:null,defaultBindProperty:"value",localizableProperties:["label","text"]}}}]),n}(Pf);function sd(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}ad.initClass(),ad._$name="Checkbox";var ud=function(e){fe()(n,e);var t=sd(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"$name",get:function(){return"Fit"}},{key:"configurable",get:function(){return{containerCls:"b-fit-container",itemCls:"b-fit-item"}}}]),n}(hl);function cd(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ld(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}ud._$name="Fit",hl.registerLayout(ud);var fd=function(e){fe()(r,e);var t,n=ld(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"afterConfigure",value:function(){var e=this;we()(pe()(r.prototype),"afterConfigure",this).call(this),e.onTargetSizeChange=e.onTargetSizeChange.bind(e),(e.completeKey||e.cancelKey)&&nu.on({element:e.element,keydown:"onKeyDown",thisObj:e}),e.on({hide:"afterEditorHide",thisObj:e}),rt.on({locale:"onLocaleChange",thisObj:e})}},{key:"onLocaleChange",value:function(){var e=this.inputField;e&&!e.isDestroyed&&e.syncInputFieldValue&&e.syncInputFieldValue(!0)}},{key:"startEdit",value:function(e){var t=e.target,n=e.align,r=void 0===n?this.align:n,i=e.hideTarget,o=void 0!==i&&i,a=e.matchSize,s=void 0===a||a,u=e.matchFont,c=void 0===u||u,l=e.fitTargetContent,f=void 0!==l&&l,d=e.value,h=e.record,v=e.field,p=void 0===v?this.inputField.name:v,g=e.focus,y=void 0===g||g,m=this,k=m.inputField,b=Cr.getStyleValue(t,"font-size"),w=Cr.getStyleValue(t,"font-family");if(!1!==m.trigger("beforestart",{value:d})){if(h&&p&&void 0===d&&(m.record=h,m.dataField=p,d=h[p]),s&&(t instanceof HTMLElement&&m.updateSize(t),t instanceof HTMLElement&&Mu.addResizeListener(t,m.onTargetSizeChange)),k.input&&(c?(k.input.style.fontSize=b,k.input.style.fontFamily=w):k.input.style.fontSize=k.input.style.fontFamily=""),k.clearError&&k.clearError(),k.value=d,k.initialValue=k.value,m.showBy(function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?cd(Object(n),!0).forEach((function(t){ke()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):cd(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({target:t},r)),f){var C=k.input.scrollWidth-k.input.clientWidth;C>0&&(m.width+=C+Cr.scrollBarWidth)}return y&&m.inputField.focus&&m.inputField.focus(),1===t.nodeType&&(t.classList.add("b-editing"),o&&t.classList.add("b-hide-visibility")),m.editing=!0,m.trigger("start",{value:k.value}),m.oldValue=k.value,Array.isArray(m.oldValue)&&(m.oldValue=m.oldValue.slice()),!0}return!1}},{key:"refreshEdit",value:function(){if(this.isVisible){var e=this.record,t=this.dataField,n=this.inputField;if(e&&t){var r=e[t];an.isEqual(n.value,r)||(n.value=r)}}}},{key:"finishEdit",value:function(){var e=this.lastAlignSpec.target;1===e.nodeType&&(e.classList.remove("b-editing"),e.classList.remove("b-hide-visibility")),this.editing=!1}},{key:"onKeyDown",value:function(e){var t=this;switch(e.key){case t.completeKey:t.completeEdit(),e.stopImmediatePropagation();break;case t.cancelKey:t.cancelEdit(),e.stopImmediatePropagation()}t.trigger("keydown",{event:e})}},{key:"onFocusOut",value:function(e){if(we()(pe()(r.prototype),"onFocusOut",this).call(this,e),!this.isFinishing&&this.editing){var t=this["".concat(this.blurAction,"Edit")];t&&t.call(this)}}},{key:"completeEdit",value:(t=Wr()(Vr.a.mark((function e(t){var n,r,i,o,a,s,u,c,l,f,d;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(n=this).inputField,i=n.oldValue,o=n.record,a=r.invalidAction||(!1===r.allowInvalid?"block":n.invalidAction),s=r.value,n.isVisible){e.next=3;break}return e.abrupt("return");case 3:if(r.isValid){e.next=14;break}if("block"!==a){e.next=9;break}return r.focus&&r.focus(),e.abrupt("return",!1);case 9:if("revert"!==a){e.next=12;break}return n.cancelEdit(),e.abrupt("return",!0);case 12:e.next=35;break;case 14:if(!an.isEqual(s,i)){e.next=19;break}return n.cancelEdit(),e.abrupt("return",!0);case 19:if(u={inputField:r,record:o,value:s,oldValue:i},!1!==n.trigger("beforeComplete",u)){e.next=24;break}r.focus&&r.focus(),e.next=35;break;case 24:if(t||(t=u.finalize||u.editorContext&&u.editorContext.finalize),!t){e.next=33;break}return e.next=28,t(u);case 28:return!0===(c=e.sent)?n.onEditComplete():(r.setError&&(l=c||r.invalidValueError,f=function(){d(),r.clearError(l)},d=r.on({change:f,input:f}),r.setError(l)),"block"===a?r.focus&&r.focus():"revert"===a&&(r.value=i,c=!0),c=!1),e.abrupt("return",c);case 33:return n.onEditComplete(),e.abrupt("return",!0);case 35:return e.abrupt("return",!1);case 36:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"cancelEdit",value:function(){var e=this,t=e.inputField,n=e.oldValue,r=t.value;e.isVisible&&!e.isFinishing&&!1!==e.trigger("beforeCancel",{value:r,oldValue:n})&&(e.isFinishing=!0,e.hide(),e.trigger("cancel",{value:r,oldValue:n}),e.finishEdit(),e.isFinishing=!1)}},{key:"onEditComplete",value:function(){var e=this,t=e.record,n=e.dataField,r=e.inputField,i=e.oldValue,o=r.value;if(!e.isFinishing){if(e.isFinishing=!0,e.hide(),t){var a="set".concat(E.capitalize(n));t[a]?t[a](o):t[n]=o}e.trigger("complete",{value:o,oldValue:i}),e.finishEdit(),e.isFinishing=!1}}},{key:"doDestroy",value:function(){this.createdInputField&&this.inputField.destroy(),we()(pe()(r.prototype),"doDestroy",this).call(this)}},{key:"changeInputField",value:function(e,t){return t&&t.destroy(),"string"==typeof e&&(e={type:e}),e instanceof oc||(e=oc.create(e),this.createdInputField=!0),this.completeOnChange&&e.on({change:"onInputFieldChange",thisObj:this}),e.parent=this,e}},{key:"updateInputField",value:function(e){this.removeAll(),this.add(e)}},{key:"onInputFieldChange",value:function(){this.containsFocus&&this.completeEdit()}},{key:"onTargetSizeChange",value:function(e,t,n){t&&n&&this.updateSize(e)}},{key:"updateSize",value:function(e){var t=e.getBoundingClientRect();this.width=t.width-this.align.offset[0],this.height=t.height}},{key:"afterEditorHide",value:function(){Mu.removeResizeListener(this.lastAlignSpec.target,this.onTargetSizeChange)}},{key:"owner",set:function(e){this._owner=e},get:function(){return this._owner||oc.fromElement(this.element.parentNode)}},{key:"inputField",get:function(){return this.items[0]}}],[{key:"$name",get:function(){return"Editor"}},{key:"type",get:function(){return"editor"}},{key:"configurable",get:function(){return{positioned:!0,hidden:!0,layout:"fit",align:{align:"t0-t0",offset:[0,0]},inputField:"textfield",blurAction:"complete",completeKey:"Enter",cancelKey:"Escape",invalidAction:"block",completeOnChange:null}}}]),r}(Rl);function dd(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}fd.initClass(),fd._$name="Editor";var hd=function(e){fe()(n,e);var t=dd(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e){var t=this;t.selection=[],we()(pe()(n.prototype),"construct",this).call(this,e),t.element.setAttribute("aria-activedescendant","".concat(t.id,"-active-day")),nu.on({element:t.element,mouseover:"onPickerMouseover",click:"onPickerClick",thisObj:t})}},{key:"doDestroy",value:function(){this._yearEditor&&this._yearEditor.destroy(),this._monthEditor&&this._monthEditor.destroy(),we()(pe()(n.prototype),"doDestroy",this).call(this)}},{key:"refresh",value:function(){var e=this,t=Cr.scrollBarWidth;we()(pe()(n.prototype),"refresh",this).call(this),e.monthElement.innerHTML=Zt.format(e.month.date,"MMMM"),e.yearElement.innerHTML=Zt.format(e.month.date,"YYYY"),e.editMonth&&(e.monthElement.style.minWidth="calc(".concat(e.maxMonthLength+1,"ch + ").concat(t,"px)"),e.yearElement.style.minWidth=t?"calc(3ch + ".concat(t,"px"):"7ch")}},{key:"cellRenderer",value:function(e){var t=e.cell,n=e.date,r=this,i=r.activeCls,o=r.selectedCls,a=t.classList;t.innerHTML=n.getDate(),t.setAttribute("aria-label",Zt.format(n,"MMMM D, YYYY")),r.isActiveDate(n)?(a.add(i),t.id="".concat(r.id,"-active-day")):t.removeAttribute("id"),r.isSelectedDate(n)&&a.add(o),(r.minDate&&n<r.minDate||r.maxDate&&n>r.maxDate)&&a.add(r.outOfRangeCls)}},{key:"onPickerMouseover",value:function(e){if(this.editOnHover&&(this.editMonth&&Cr.up(e.target,".b-editable")))return this.onEditGesture(e)}},{key:"onPickerClick",value:function(e){var t=this,n=e.target,r=Cr.up(n,".".concat(t.dayCellCls,":not(.").concat(t.disabledCls,"):not(.").concat(t.outOfRangeCls,")")),i=t.editMonth&&Cr.up(n,".b-editable");return r?t.onCellClick(e):t.editOnHover&&!Cr.isTouchEvent||!i?(t._monthEditor&&!t._monthEditor.owns(e)&&t._monthEditor.cancelEdit(),void(t._yearEditor&&!t._yearEditor.owns(e)&&t._yearEditor.cancelEdit())):t.onEditGesture(e)}},{key:"onCellClick",value:function(e){this.onUIDateSelect(Zt.parseKey(e.target.dataset.date),e)}},{key:"onEditGesture",value:function(e){var t=this,n=t.month,r=e.target;r===t.monthElement?t.monthEditor.startEdit({target:r,value:n.month,fitTargetContent:!1,hideTarget:!0}):r===t.yearElement&&(t.yearEditor.minWidth="".concat(Cr.scrollBarWidth+50,"px)"),t.yearEditor.startEdit({target:r,value:n.year,fitTargetContent:!0,hideTarget:!0}))}},{key:"onUIDateSelect",value:function(e,t){var n=this,r=n.lastClickedDate,i=n.selection;n.activeDate=e,n.lastClickedDate=e,n.isDisabledDate(e)||(n.activatingEvent=t,n.multiSelect?n.multiRange||r&&e.getTime()===r.getTime()||(r&&t.shiftKey?(i[1]=e,i.sort()):(i.length=0,i[0]=e),n.trigger("selectionChange",{selection:i,userAction:Boolean(t)})):n.value&&n.value.getTime()===e.getTime()?n.floating&&n.hide():n.value=e,n.activatingEvent=null),n.refresh()}},{key:"onInternalKeyDown",value:function(e){var t=this,n=e.key.trim()||e.code,r=t.activeDate,i=new Date(r);if("Escape"===n&&t.floating)return t.hide();if(r&&e.target===t.focusElement){do{switch(n){case"ArrowLeft":e.preventDefault(),e.ctrlKey?i.setMonth(i.getMonth()-1):i.setDate(i.getDate()-1);break;case"ArrowUp":e.preventDefault(),i.setDate(i.getDate()-7);break;case"ArrowRight":e.preventDefault(),e.ctrlKey?i.setMonth(i.getMonth()+1):i.setDate(i.getDate()+1);break;case"ArrowDown":e.preventDefault(),i.setDate(i.getDate()+7);break;case"Enter":return t.onUIDateSelect(r,e)}}while(t.isDisabledDate(i)&&!t.focusDisabledDates);if(t.minDate&&i<t.minDate)return;if(t.maxDate&&i>t.maxDate)return;t.activeDate=i}}},{key:"updateDate",value:function(e){we()(pe()(n.prototype),"updateDate",this).call(this,e),this.activeDate=e}},{key:"changeActiveDate",value:function(e){if(e=e?this.changeDate(e):this.date||(this.date=Zt.clearTime(new Date)),isNaN(e))throw new Error("DatePicker date ingestion must be passed a Date, or a YYYY-MM-DD date string");return e}},{key:"updateActiveDate",value:function(e){this.month.date=e,this.refresh()}},{key:"gotoPrevMonth",value:function(){var e=this.activeDate,t=e&&this.getCell(e)?e:this.date,n=new Date(t);n.setMonth(n.getMonth()-1),this.date=n}},{key:"gotoNextMonth",value:function(){var e=this.activeDate,t=e&&this.getCell(e)?e:this.date,n=new Date(t);n.setMonth(n.getMonth()+1),this.date=n}},{key:"isActiveDate",value:function(e){return this.activeDate&&this.changeDate(e).getTime()===this.activeDate.getTime()}},{key:"isSelectedDate",value:function(e){return this.selection.some((function(t){return t.getTime()===e.getTime()}))}},{key:"onMonthPicked",value:function(e){var t=e.value,n=e.oldValue;this.activeDate=Zt.add(this.activeDate,t-n,"month")}},{key:"onYearPicked",value:function(e){var t=e.value,n=new Date(this.activeDate);n.setFullYear(t),this.activeDate=n}},{key:"onBeforeEditorCancel",value:function(e){if(e.source.containsFocus)return this.element.focus(),!1}},{key:"updateLocalization",value:function(){this._monthEditor&&(this._monthEditor.doDestroy(),this._monthEditor=null),this._yearEditor&&(this._yearEditor.doDestroy(),this._yearEditor=null),this._maxMonthLength=0,we()(pe()(n.prototype),"updateLocalization",this).call(this)}},{key:"focusElement",get:function(){return this.element}},{key:"childItems",get:function(){var e=we()(pe()(n.prototype),"childItems",this);return this._yearEditor&&e.unshift(this._yearEditor),this._monthEditor&&e.unshift(this._monthEditor),e}},{key:"minDate",set:function(e){this._minDate=e?this.changeDate(e):null,this.refresh()},get:function(){return this._minDate}},{key:"maxDate",set:function(e){this._maxDate=e?this.changeDate(e):null,this.refresh()},get:function(){return this._maxDate}},{key:"value",set:function(e){var t,n=this,r=n.selection;if(e){if(void 0===(e=n.changeDate(e,n.value)))return;n.value&&e.getTime()===n.value.getTime()||(r.length=0,r[0]=e,t=!0),n.date=e}else t=r.length,r.length=0,n.date=new Date;t&&n.trigger("selectionChange",{selection:r,userAction:Boolean(n.activatingEvent)})},get:function(){return this.selection[this.selection.length-1]}},{key:"monthEditor",get:function(){var e=this;return e._monthEditor||(e._monthEditor=new fd({owner:e,appendTo:e.element,inputField:e.monthInput=new Xf({editable:!1,autoExpand:!e.editOnHover,items:e.monthItems,highlightExternalChange:!1,picker:{align:{align:"t0-b0"},cls:"b-month-picker-list",scrollable:{overflowX:!1}}}),completeOnChange:!0,listeners:{complete:"onMonthPicked",beforeCancel:"onBeforeEditorCancel",thisObj:e}})),e._monthEditor}},{key:"yearEditor",get:function(){var e=this;return e._yearEditor||(e._yearEditor=new fd({owner:e,appendTo:e.element,inputField:e.yearInput=new Xf({editable:!1,autoExpand:!e.editOnHover,items:e.yearItems,highlightExternalChange:!1,picker:{cls:"b-year-picker-list",scrollable:{overflowX:!1}}}),completeOnChange:!0,listeners:{complete:"onYearPicked",beforeCancel:"onBeforeEditorCancel",thisObj:e}})),e._yearEditor}},{key:"monthItems",get:function(){return Zt.getMonthNames().map((function(e,t){return[t,e]}))}},{key:"yearItems",get:function(){for(var e=[],t=(new Date).getFullYear(),n=t-20;n<t+21;n++)e.push(n);return e}},{key:"maxMonthLength",get:function(){if(!this._maxMonthLength){this._maxMonthLength=0;for(var e=0,t=this.monthItems;e<12;e++)this._maxMonthLength=Math.max(this._maxMonthLength,t[e][1].length)}return this._maxMonthLength}}],[{key:"$name",get:function(){return"DatePicker"}},{key:"type",get:function(){return"datepicker"}},{key:"delayable",get:function(){return{refresh:"raf"}}},{key:"configurable",get:function(){return{activeDate:{$config:{equal:"date"},value:null}}}},{key:"defaultConfig",get:function(){return{focusable:!0,textContent:!1,tools:{prevMonth:{align:"start",cls:"b-icon b-icon-angle-left",handler:"gotoPrevMonth"},nextMonth:{align:"end",cls:"b-icon b-icon-angle-right",handler:"gotoNextMonth"}},header:{title:'<div class="b-editable b-datepicker-month" data-reference="monthElement"></div> <div class="b-editable b-datepicker-year" data-reference="yearElement"></div>',titleAlign:"center"},minDate:null,maxDate:null,outOfRangeCls:"b-out-of-range",activeCls:"b-active-date",selectedCls:"b-selected-date",focusDisabledDates:null,multiSelect:!1,editOnHover:!0,editMonth:!0}}}]),n}(id);function vd(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}hd.initClass(),hd._$name="DatePicker";var pd=function(e){fe()(n,e);var t=vd(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"changePicker",value:function(e,t){var n=this,r={owner:n,forElement:n[n.pickerAlignElement],minDate:n.min,maxDate:n.max,weekStartDay:n._weekStartDay,align:{anchor:n.overlayAnchor,target:n[n.pickerAlignElement]},onSelectionChange:function(e){var t=e.selection,r=e.source;r.isVisible&&(n._isUserAction=!0,n.value=t[0],n._isUserAction=!1,r.hide())}};return n.value?r.value=n.value:r.date=new Date,(e=hd.reconfigure(t,e,{owner:n,defaults:r}))&&n.calendarContainerCls&&e.element.classList.add(n.calendarContainerCls),e}},{key:"onBackClick",value:function(){var e=this,t=e.min;if(!e.readOnly&&e.value){var n=e.backShiftDate;(!t||t.getTime()<=n)&&(e._isUserAction=!0,e.value=n,e._isUserAction=!1)}}},{key:"onForwardClick",value:function(){var e=this,t=e.max;if(!e.readOnly&&e.value){var n=e.forwardShiftDate;(!t||t.getTime()>=n)&&(e._isUserAction=!0,e.value=n,e._isUserAction=!1)}}},{key:"showPicker",value:function(e){if(!this.readOnly){var t=this._picker;t&&(t.value=this.value),we()(pe()(n.prototype),"showPicker",this).call(this,e)}}},{key:"focusPicker",value:function(){this.picker.focus()}},{key:"transformDateValue",value:function(e){return null!=e&&(Zt.isDate(e)||(e="string"==typeof e?Zt.parse(e,this.format)||Zt.parse(e,this.fallbackFormat):new Date(e)),Zt.isValidDate(e))?this.transformTimeValue(e):null}},{key:"transformTimeValue",value:function(e){var t=this.keepTime;if(e=Zt.clone(e),t){var n=Zt.parse(t,this.timeFormat);Zt.isValidDate(n)?Zt.copyTimeValues(e,n):Zt.isValidDate(this.value)&&Zt.copyTimeValues(e,this.value)}else Zt.clearTime(e,!1);return e}},{key:"changeMin",value:function(e){return this.transformDateValue(e)}},{key:"updateMin",value:function(e){var t=this.input,n=this._picker;t&&(t.min=e),n&&(n.minDate=e),this.syncInvalid()}},{key:"changeMax",value:function(e){return this.transformDateValue(e)}},{key:"updateMax",value:function(e){var t=this.input,n=this._picker;t&&(t.max=e),n&&(n.maxDate=e),this.syncInvalid()}},{key:"updateWeekStartDay",value:function(e){this._picker&&(this._picker.weekStartDay=e)}},{key:"changeValue",value:function(e,t){var r=this,i=r.transformDateValue(e);if(!e||i){if(r.clearError("L{invalidDate}"),r.hasChanged(t,i))return we()(pe()(n.prototype),"changeValue",this).call(this,i,t);r.inputting||r.syncInputFieldValue()}else r.setError("L{invalidDate}")}},{key:"updateValue",value:function(e,t){var r=this._picker;r&&!this.inputting&&(r.value=e),we()(pe()(n.prototype),"updateValue",this).call(this,e,t)}},{key:"changeStep",value:function(e,t){var n=l()(e);return e?("number"===n?e={magnitude:Math.abs(e),unit:t?t.unit:"day"}:"string"===n&&(e=Zt.parseDuration(e)),e&&e.unit&&e.magnitude?(e.magnitude<0&&(e={magnitude:-e.magnitude,unit:e.unit}),e):void 0):null}},{key:"updateStep",value:function(e){this.element.classList[e?"remove":"add"]("b-no-steppers"),this.syncInvalid()}},{key:"hasChanged",value:function(e,t){return e&&e.getTime&&t&&t.getTime?!Zt.isEqual(Zt.clearTime(e),Zt.clearTime(t)):we()(pe()(n.prototype),"hasChanged",this).call(this,e,t)}},{key:"updateFormat",value:function(){this.syncInputFieldValue(!0)}},{key:"updateLocalization",value:function(){we()(pe()(n.prototype),"updateLocalization",this).call(this),this.syncInputFieldValue(!0)}},{key:"internalOnKeyEvent",value:function(e){we()(pe()(n.prototype),"internalOnKeyEvent",this).call(this,e),"Enter"===e.key&&this.isValid&&this.picker.hide()}},{key:"backShiftDate",get:function(){return Zt.add(this.value,-1*this._step.magnitude,this._step.unit)}},{key:"forwardShiftDate",get:function(){return Zt.add(this.value,this._step.magnitude,this._step.unit)}},{key:"isValid",get:function(){var e=this,t=e.min,r=e.max;e.clearError("L{Field.minimumValueViolation}",!0),e.clearError("L{Field.maximumValueViolation}",!0);var i=e.value;if(i){if(i=i.getTime(),t&&t.getTime()>i)return e.setError("L{Field.minimumValueViolation}",!0),!1;if(r&&r.getTime()<i)return e.setError("L{Field.maximumValueViolation}",!0),!1}return we()(pe()(n.prototype),"isValid",this)}},{key:"weekStartDay",get:function(){return"number"==typeof this._weekStartDay?this._weekStartDay:Zt.weekStartDay}},{key:"inputValue",get:function(){var e=this.value;return e?Zt.format(e,this.format):""}}],[{key:"$name",get:function(){return"DateField"}},{key:"type",get:function(){return"datefield"}},{key:"alias",get:function(){return"date"}},{key:"configurable",get:function(){return{format:"L",fallbackFormat:"YYYY-MM-DD",timeFormat:"HH:mm:ss:SSS",keepTime:!1,pickerFormat:null,triggers:{expand:{cls:"b-icon-calendar",handler:"onTriggerClick",weight:200},back:{cls:"b-icon b-icon-angle-left b-step-trigger",handler:"onBackClick",align:"start",weight:100},forward:{cls:"b-icon b-icon-angle-right b-step-trigger",handler:"onForwardClick",align:"end",weight:100}},calendarContainerCls:"",min:null,max:null,step:!1,stepTriggers:null,weekStartDay:null,picker:{type:"datepicker",floating:!0,scrollAction:"realign",align:{align:"t0-b0",axisLock:!0}},value:null}}}]),n}(Lf);function gd(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}pd.initClass(),pd._$name="DateField";var yd=function(e){fe()(n,e);var t=gd(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e){var t=this;we()(pe()(n.prototype),"construct",this).call(this,e),t._pm=!1,t.fieldHours.on("change",t.onFieldChange,t),t.fieldMinutes.on("change",t.onFieldChange,t),t.buttonAM.on("click",t.onButtonAMClick,t),t.buttonPM.on("click",t.onButtonPMClick,t),nu.on({element:t.element,keydown:"onPickerKeyDown",thisObj:t}),nu.on({element:t.fieldHours.element,keydown:"onPickerKeyDown",thisObj:t}),nu.on({element:t.fieldMinutes.element,keydown:"onPickerKeyDown",thisObj:t}),t.refresh()}},{key:"onFieldChange",value:function(){this._time&&(this.value=this.pickerToTime())}},{key:"onButtonAMClick",value:function(){this._pm=!1,this._time&&(this.value=this.pickerToTime())}},{key:"onButtonPMClick",value:function(){this._pm=!0,this._time&&(this.value=this.pickerToTime())}},{key:"onPickerKeyDown",value:function(e){var t=this;switch(e.key&&e.key.trim()||e.code){case"Escape":t.triggerTimeChange(t._initialValue),t.hide(),e.preventDefault();break;case"Enter":t.value=t.pickerToTime(),t.hide(),e.preventDefault()}}},{key:"pickerToTime",value:function(){var e=this,t=e._pm;e.fieldHours.format=e._is24Hour?"2>9":null;var n=e.fieldHours.value,r=new Date(e._time);return e._is24Hour||(t&&n<12&&(n+=12),t||12!==n||(n=0)),r.setHours(n),r.setMinutes(e.fieldMinutes.value),e._min&&(r=Zt.max(e._min,r)),e._max&&(r=Zt.min(e._max,r)),r}},{key:"triggerTimeChange",value:function(e){this.trigger("timeChange",{time:e})}},{key:"refresh",value:function(){var e=this;if(!e.isConfiguring){var t=e._time,n=e._is24Hour,r=t.getHours(),i=e._pm=r>=12,o=e.fieldHours;e.element.classList[n?"add":"remove"]("b-24h"),o.min=n?0:1,o.max=n?23:12,o.value=n?r:r%12||12,e.fieldMinutes.value=t.getMinutes(),e.buttonAM.pressed=!i,e.buttonPM.pressed=i,e.buttonAM.hidden=e.buttonPM.hidden=n}}},{key:"value",set:function(e){var t=this,r=!1;e&&t._time?e.getTime()!==t._time.getTime()&&(t._time=e,r=!0):(t._time=n.defaultConfig.value,r=!0),r&&(t.isVisible&&t.triggerTimeChange(t.value),t.refresh())},get:function(){return this._time}},{key:"format",set:function(e){this._format=e,this._is24Hour=Zt.is24HourFormat(this._format),this.refresh()},get:function(){return this._format}},{key:"min",set:function(e){this._min=e},get:function(){return this._min}},{key:"max",set:function(e){this._max=e},get:function(){return this._max}},{key:"initialValue",set:function(e){this.value=e,this._initialValue=e},get:function(){return this._initialValue}},{key:"buttonAM",get:function(){return this.widgetMap.buttonAM}},{key:"buttonPM",get:function(){return this.widgetMap.buttonPM}},{key:"fieldHours",get:function(){return this.widgetMap.fieldHours}},{key:"fieldMinutes",get:function(){return this.widgetMap.fieldMinutes}}],[{key:"$name",get:function(){return"TimePicker"}},{key:"type",get:function(){return"timepicker"}},{key:"defaultConfig",get:function(){return{items:[{type:"number",ref:"fieldHours",min:0,max:23,highlightExternalChange:!1,format:"2>9"},{html:"<label>:</label>"},{type:"number",ref:"fieldMinutes",min:0,max:59,highlightExternalChange:!1,format:"2>9"},{type:"button",text:"AM",toggleGroup:"am-pm",ref:"buttonAM",cls:"b-blue"},{type:"button",text:"PM",toggleGroup:"am-pm",ref:"buttonPM",cls:"b-blue"}],float:"1",autoShow:!1,trapFocus:!0,value:Zt.getTime(0),format:null}}}]),n}(zl);function md(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}yd.initClass(),yd._$name="TimePicker";var kd=function(e){fe()(n,e);var t=md(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"changePicker",value:function(e,t){var n=this;return yd.reconfigure(t,e,{owner:n,defaults:{forElement:n[n.pickerAlignElement],owner:n,align:{anchor:n.overlayAnchor,target:n[n.pickerAlignElement]},onTimeChange:function(e){var t=e.time;n._isUserAction=!0,n.value=t,n._isUserAction=!1}}})}},{key:"onBackClick",value:function(){var e=this,t=e.min;if(!e.readOnly&&e.value){var n=Zt.add(e.value,-1*e.step.magnitude,e.step.unit);(!t||t.getTime()<=n)&&(e._isUserAction=!0,e.value=n,e._isUserAction=!1)}}},{key:"onForwardClick",value:function(){var e=this,t=e.max;if(!e.readOnly&&e.value){var n=Zt.add(e.value,e.step.magnitude,e.step.unit);(!t||t.getTime()>=n)&&(e._isUserAction=!0,e.value=n,e._isUserAction=!1)}}},{key:"hasChanged",value:function(e,t){return e&&e.getTime&&t&&t.getTime?e.getHours()!==t.getHours()||e.getMinutes()!==t.getMinutes()||e.getSeconds()!==t.getSeconds()||e.getMilliseconds()!==t.getMilliseconds():we()(pe()(n.prototype),"hasChanged",this).call(this,e,t)}},{key:"showPicker",value:function(e){var t=this,r=t.picker;t.readOnly||(r.initialValue=t.value,r.format=t.format,r.maxTime=t.max,r.minTime=t.min,t.value=r.value,we()(pe()(n.prototype),"showPicker",this).call(this,e))}},{key:"onPickerShow",value:function(){we()(pe()(n.prototype),"onPickerShow",this).call(this),this.pickerKeyDownRemover&&this.pickerKeyDownRemover()}},{key:"focusPicker",value:function(){this.picker.focus()}},{key:"transformTimeValue",value:function(e){return null!=e&&(Zt.isDate(e)||(e="string"==typeof e?Zt.parse(e,this.format):new Date(e)),Zt.isValidDate(e))?Zt.getTime(e):null}},{key:"changeMin",value:function(e){return this.transformTimeValue(e)}},{key:"updateMin",value:function(e){var t=this.input;t&&(t.min=e),this.syncInvalid()}},{key:"changeMax",value:function(e){return this.transformTimeValue(e)}},{key:"updateMax",value:function(e){var t=this.input;t&&(t.max=e),this.syncInvalid()}},{key:"changeValue",value:function(e,t){var r=this,i=r.transformTimeValue(e);if(e&&!i||r.isRequired&&""===e)r.setError("L{invalidTime}");else{if(r.clearError("L{invalidTime}"),r.hasChanged(t,i))return we()(pe()(n.prototype),"changeValue",this).call(this,i,t);r.inputting||r.syncInputFieldValue(!0)}}},{key:"updateValue",value:function(e,t){var r=this.triggers.expand;r&&e&&(r.element.firstElementChild.style.animationDelay=-(60*e.getHours()+e.getMinutes())/10+"s"),we()(pe()(n.prototype),"updateValue",this).call(this,e,t)}},{key:"changeStep",value:function(e,t){var n=l()(e);return e?("number"===n?e={magnitude:Math.abs(e),unit:t?t.unit:"day"}:"string"===n&&(e=Zt.parseDuration(e)),e&&e.unit&&e.magnitude?(e.magnitude<0&&(e={magnitude:-e.magnitude,unit:e.unit}),e):void 0):null}},{key:"updateStep",value:function(e){this.element.classList[e?"remove":"add"]("b-no-steppers"),this.syncInvalid()}},{key:"updateFormat",value:function(){this.syncInputFieldValue(!0)}},{key:"updateLocalization",value:function(){we()(pe()(n.prototype),"updateLocalization",this).call(this),this.syncInputFieldValue(!0)}},{key:"isValid",get:function(){var e=this;e.clearError("L{Field.minimumValueViolation}",!0),e.clearError("L{Field.maximumValueViolation}",!0);var t=e.value;if(t){if(t=t.getTime(),e._min&&e._min.getTime()>t)return e.setError("L{Field.minimumValueViolation}",!0),!1;if(e._max&&e._max.getTime()<t)return e.setError("L{Field.maximumValueViolation}",!0),!1}return we()(pe()(n.prototype),"isValid",this)}},{key:"inputValue",get:function(){return Zt.format(this.value,this.format)}}],[{key:"$name",get:function(){return"TimeField"}},{key:"type",get:function(){return"timefield"}},{key:"alias",get:function(){return"time"}},{key:"configurable",get:function(){var e=this;return{picker:{type:"timepicker",floating:!0,align:{align:"t0-b0",axisLock:!0}},format:"LT",triggers:{expand:{template:function(){return'<div class="b-align-'.concat(e.align||"end",'"><div class="b-icon-clock-live"></div></div>')},handler:"onTriggerClick",align:"end"},back:{cls:"b-icon b-icon-angle-left b-step-trigger",handler:"onBackClick",align:"start"},forward:{cls:"b-icon b-icon-angle-right b-step-trigger",handler:"onForwardClick",align:"end"}},min:null,max:null,step:"5m",stepTriggers:null,value:null}}}]),n}(Lf);function bd(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}kd.initClass(),kd._$name="TimeField";var wd=function(e){fe()(n,e);var t=bd(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"changeTimeField",value:function(e){var t=this,n=new kd(an.assign({syncInvalid:function(){for(var e=t.updatingInvalid,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];kd.prototype.syncInvalid.apply(this,r),t.timeField&&!e&&t.syncInvalid()}},e));return t.readOnly&&(n.readOnly=!0),n}},{key:"updateTimeField",value:function(e){var t=this;e.on({change:function(e){var n=e.userAction,r=e.value;if(n&&!t.$settingValue){var i=t.dateField.value;t._isUserAction=!0,t.value=i?Zt.copyTimeValues(i,r):null,t._isUserAction=!1}},thisObj:t})}},{key:"changeDateField",value:function(e){var t=this,n=(null==e?void 0:e.type)||"datefield",r=oc.resolveType(e.type||"datefield"),i=oc.create(an.assign({type:n,syncInvalid:function(){for(var e=t.updatingInvalid,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];r.prototype.syncInvalid.apply(this,i),t.dateField&&!e&&t.syncInvalid()}},e));return t.readOnly&&(i.readOnly=!0),i}},{key:"updateDateField",value:function(e){var t=this;e.on({change:function(e){var n=e.userAction,r=e.value;n&&!t.$isInternalChange&&(t._isUserAction=!0,t.value=r,t._isUserAction=!1)},thisObj:t})}},{key:"updateWeekStartDay",value:function(e){this.dateField&&(this.dateField.weekStartDay=e)}},{key:"changeWeekStartDay",value:function(e){var t,n;return"number"==typeof e?e:null!==(t=null===(n=this.dateField)||void 0===n?void 0:n.weekStartDay)&&void 0!==t?t:Zt.weekStartDay}},{key:"syncInputFieldValue",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.isConfiguring;we()(pe()(n.prototype),"syncInputFieldValue",this).call(this,!0),e||this.highlightExternalChange||(e=!0);var t=this,r=t.dateField.highlightExternalChange,i=t.timeField.highlightExternalChange;t.$isInternalChange=!0,t.dateField.highlightExternalChange=!1,t.dateField.value=null,t.dateField.highlightExternalChange=r,e&&(t.timeField.highlightExternalChange=t.dateField.highlightExternalChange=!1),t.timeField.value=t.dateField.value=t.inputValue,t.dateField.highlightExternalChange=r,t.timeField.highlightExternalChange=i,t.$isInternalChange=!1,t.syncInvalid()}},{key:"updateRequired",value:function(e,t){this.timeField.required=this.dateField.required=e}},{key:"updateReadOnly",value:function(e,t){we()(pe()(n.prototype),"updateReadOnly",this).call(this,e,t),this.isConfiguring||(this.timeField.readOnly=this.dateField.readOnly=e)}},{key:"onDisabled",value:function(e){this.timeField.disabled=this.dateField.disabled=e}},{key:"hasChanged",value:function(e,t){return!Zt.isEqual(e,t)}},{key:"setError",value:function(e,t){[this.dateField,this.timeField].forEach((function(n){return n.setError(e,t)}))}},{key:"getErrors",value:function(){var e=[].concat(d()(this.dateField.getErrors()||[]),d()(this.timeField.getErrors()||[]));return e.length?e:null}},{key:"clearError",value:function(e,t){[this.dateField,this.timeField].forEach((function(n){return n.clearError(e,t)}))}},{key:"updateInvalid",value:function(){this.updatingInvalid=!0,[this.dateField,this.timeField].forEach((function(e){return e.updateInvalid()})),this.updatingInvalid=!1}},{key:"innerElements",get:function(){return[this.dateField.element,this.timeField.element]}},{key:"childItems",get:function(){return[this.dateField,this.timeField]}},{key:"isValid",get:function(){return this.timeField.isValid&&this.dateField.isValid}}],[{key:"configurable",get:function(){return{timeField:{flex:"0 0 45%"},dateField:{keepTime:!0,flex:1,step:"1 d"},weekStartDay:null,inputTemplate:function(){return""}}}},{key:"$name",get:function(){return"DateTimeField"}},{key:"type",get:function(){return"datetimefield"}},{key:"alias",get:function(){return"datetime"}}]),n}(Pf);function Cd(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}wd.initClass(),wd._$name="DateTimeField";var Sd=function(e){fe()(n,e);var t=Cd(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"changeReadOnly",value:function(){return!0}},{key:"changeEditable",value:function(){return!1}},{key:"focusElement",get:function(){}}],[{key:"$name",get:function(){return"DisplayField"}},{key:"type",get:function(){return"displayfield"}},{key:"alias",get:function(){return"display"}},{key:"configurable",get:function(){return{readOnly:!0,editable:!1,cls:"b-display-field"}}}]),n}(Of);function Dd(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Sd.initClass(),Sd._$name="DisplayField";var Rd=function(e){fe()(n,e);var t=Dd(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"roundMagnitude",value:function(e){return e&&null!=this.decimalPrecision?an.round(e,this.decimalPrecision):e}},{key:"internalOnChange",value:function(e){var t=this,n=t.value,r=t._lastValue;t.hasChanged(r,n)&&(t._lastValue=n,t.triggerFieldChange({value:n,event:e,userAction:!0,valid:t.isValid}))}},{key:"onFocusOut",value:function(e){return this.syncInputFieldValue(!0),we()(pe()(n.prototype),"onFocusOut",this).call(this,e)}},{key:"calcValue",value:function(){var e=this;return e._unit&&null!=e._magnitude||!e.clearable?new Ko(e._magnitude,e._unit||n.defaultConfig.defaultUnit):null}},{key:"hasChanged",value:function(e,t){return t&&!e||!t&&e||t&&e&&!e.isEqual(t)}},{key:"onInternalKeyDown",value:function(e){"ArrowUp"===e.key?this.doSpinUp():"ArrowDown"===e.key&&this.doSpinDown()}},{key:"doSpinUp",value:function(){var e=this;e._isUserAction=!0,e.magnitude=(e.magnitude||0)+e.step,e._isUserAction=!1}},{key:"doSpinDown",value:function(){var e=this;(e.allowNegative||(e.magnitude||0)>0)&&(e._isUserAction=!0,e.magnitude=(e.magnitude||0)-e.step,e._isUserAction=!1)}},{key:"inputValue",get:function(){return null==this.value?"":this.value.toString(this.useAbbreviation)}},{key:"unit",set:function(e){this._unit=e,sc()(pe()(n.prototype),"value",this.calcValue(),this,!0)},get:function(){return this._unit}},{key:"magnitude",set:function(e){this._magnitude=this.roundMagnitude(e),sc()(pe()(n.prototype),"value",this.calcValue(),this,!0)},get:function(){return this._magnitude}},{key:"allowDecimals",get:function(){return 0!==this.decimalPrecision}},{key:"isValid",get:function(){var e=this,t=null==e.value||e.value&&null==e.value.magnitude;return we()(pe()(n.prototype),"isValid",this)&&(t&&!e.required||!t&&(e.allowNegative||e.value.magnitude>=0))}},{key:"value",set:function(e){var t,r,i=this;if("number"==typeof e)t=i.roundMagnitude(e),r=i._unit;else if("string"==typeof e){var o=Zt.parseDuration(e,i.allowDecimals,i._unit||n.defaultConfig.defaultUnit);o&&(r=o.unit,t=i.roundMagnitude(o.magnitude))}else e&&"unit"in e&&"magnitude"in e?(r=e.unit,t=i.roundMagnitude(e.magnitude)):(r=null,t=null);i._magnitude===t&&i._unit===r||(i._magnitude=t,i._unit=r,sc()(pe()(n.prototype),"value",i.calcValue(),this,!0))},get:function(){return we()(pe()(n.prototype),"value",this)}},{key:"milliseconds",get:function(){return this.value?this.value.milliseconds:0}}],[{key:"$name",get:function(){return"DurationField"}},{key:"type",get:function(){return"durationfield"}},{key:"alias",get:function(){return"duration"}},{key:"defaultConfig",get:function(){return{value:null,step:1,unit:null,defaultUnit:"day",magnitude:null,useAbbreviation:!1,allowNegative:!1,decimalPrecision:null,triggers:{spin:{type:"spintrigger"}},nullValue:null}}}]),n}(Of);function xd(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Rd.initClass(),Rd._$name="DurationField";var Ed=function(e){fe()(n,e);var t=xd(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"internalOnChange",value:function(e){we()(pe()(n.prototype),"internalOnInput",this).call(this,e),we()(pe()(n.prototype),"internalOnChange",this).call(this,e)}},{key:"internalOnInput",value:function(){}},{key:"pickFile",value:function(){this.input.click()}},{key:"clear",value:function(){this.input.value=null}},{key:"triggerChange",value:function(e){this.triggerFieldChange({event:e,value:this.input.value,oldValue:this._lastValue,userAction:!0,valid:!0})}},{key:"files",get:function(){return this.input.files}},{key:"multiple",get:function(){return this._multiple?"":null}}],[{key:"$name",get:function(){return"FileField"}},{key:"type",get:function(){return"filefield"}},{key:"configurable",get:function(){return{multiple:null,accept:null,inputType:"file",attributes:["multiple","accept"]}}}]),n}(Pf);function Td(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Ed.initClass(),Ed._$name="FileField";var Md=function(e){fe()(n,e);var t=Td(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this;e.items=[Object.assign({type:"button",ref:"fileButton",text:"L{FilePicker.file}",localeClass:this},e.buttonConfig),Object.assign({type:"filefield",ref:"fileField",style:"display: none"},e.fileFieldConfig)].concat(e.items||[]),we()(pe()(n.prototype),"construct",this).call(this,e),t.button.on({click:t.onButtonClick,thisObj:t}),t.fileField.on({change:t.onFileFieldChange,thisObj:t}),t._thisIsAUsedExpression(t.fileTip)}},{key:"clear",value:function(){this.fileField.clear(),this.button.badge="",this.trigger("clear")}},{key:"onButtonClick",value:function(e){var t=e.event;this.fileField.pickFile(),t.preventDefault()}},{key:"onFileFieldChange",value:function(e){var t=e.valid;this.button.badge=this.files.length||"",this.triggerFieldChange({files:this.files,valid:t})}},{key:"button",get:function(){return this.widgetMap.fileButton}},{key:"fileField",get:function(){return this.widgetMap.fileField}},{key:"files",get:function(){return this.fileField.files}},{key:"fileTip",get:function(){var e=this;return e._fileTip||(e._fileTip=new Kl({cls:"b-file-tip",forElement:e.button.element,showOnHover:!0,align:"b-t",scrollAction:"realign",listeners:{beforeshow:function(){var t=e.files;return!(!t||!t.length)&&(this.html="".concat(Array.from(t).map((function(e){return e.name})).join("<br>")),!0)}}}))}}],[{key:"$name",get:function(){return"FilePicker"}},{key:"type",get:function(){return"filepicker"}},{key:"defaultConfig",get:function(){return{defaultBindProperty:"value",buttonConfig:null,fileFieldConfig:null}}}]),n}(Rl);function Ad(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Md.initClass(),Md._$name="FilePicker";var Pd=function(e){fe()(n,e);var t=Ad(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"$name",get:function(){return"FilterField"}},{key:"type",get:function(){return"filterfield"}},{key:"configurable",get:function(){return{field:null,store:null,filterFunction:null,clearable:!0,keyStrokeChangeDelay:100,onChange:function(e){var t=e.value,n=this.store,r=this.field,i=this.filterFunction;if(n){var o,a="".concat(r||this.id,"-Filter");if(0===t.length)n.removeFilter(a);else i?o=function(e){return i(e,t)}:(t=t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&"),o=function(e){return e.get(r).match(new RegExp(t,"i"))}),n.filter({id:a,filterBy:o})}}}}}]),n}(Of);function Id(){var e=El()(["\n            <"," "," ",' class="','" ',' tabIndex="-1">\n                ','\n                <span class="b-menu-text" data-reference="textElement">',"</span>\n                ","\n            </",">"]);return Id=function(){return e},e}function Od(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Pd.initClass(),Pd._$name="FilterField";var Fd=/^b-icon-/,Ld=/^b-fa-/,jd=function(e){fe()(n,e);var t=Od(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"doAction",value:function(e){var t=this.parent,n={menu:t,item:this,element:this.element,bubbles:!0};"boolean"==typeof this.checked&&(this.checked=!this.checked),this.trigger("beforeItem",n),this.trigger("item",n),this.closeParent&&t&&(t.rootMenu.close(),e&&!this.href&&e.preventDefault())}},{key:"doDestroy",value:function(){var e=this._menu;e instanceof oc&&e.destroy(),we()(pe()(n.prototype),"doDestroy",this).call(this)}},{key:"template",value:function(e){var t=e.icon||("boolean"==typeof e.checked?"b-fw-icon b-icon-".concat(e.checked?"":"un","checked"):""),n=Fd.test(t)?" b-icon":Ld.test(t)?" b-fa":"",r=e.href?"a":"div";return Iu.tpl(Id(),r,"a"===r?'href="'.concat(e.href,'"'):"","a"===r&&e.target?'target="'.concat(e.target,'"'):"",e.hasMenu?"b-has-submenu":"",e.name?'data-name="'.concat(e.name,'"'):"",t?'<i class="b-menuitem-icon '.concat(t).concat(n,'" data-reference="iconElement"></i>'):"",e.text,e.hasMenu?'<i class="b-fw-icon b-icon-sub-menu" data-reference="subMenuIcon"></i>':"",r)}},{key:"onFocusIn",value:function(e){we()(pe()(n.prototype),"onFocusIn",this).call(this,e),!this.disabled&&this.menu&&this.openMenu()}},{key:"onFocusOut",value:function(e){we()(pe()(n.prototype),"onFocusOut",this).call(this,e),this.closeMenu()}},{key:"openMenu",value:function(e){var t=this.menu;!this.disabled&&t&&(t.focusOnToFront=e,t.show(),this.owner.currentSubMenu=t)}},{key:"closeMenu",value:function(){this._menu instanceof oc&&this.menu.close()}},{key:"changeChecked",value:function(e,t){if(this.isConfiguring||"boolean"==typeof t)return Boolean(e)}},{key:"updateChecked",value:function(e){var t=this;t.isConfiguring||(t.iconElement.classList[e?"add":"remove"]("b-icon-checked"),t.iconElement.classList[e?"remove":"add"]("b-icon-unchecked"),t.trigger("toggle",{menu:t.owner,item:t,checked:e,element:t.element,bubbles:!0}))}},{key:"focusElement",get:function(){return this.element}},{key:"contentElement",get:function(){return this.textElement}},{key:"isFocusable",get:function(){var e=this.focusElement;return e&&this.isVisible&&(e===document.body||e.offsetParent)}},{key:"menu",set:function(e){this._menu=e},get:function(){var e=this,t=e._menu;return t&&t.isDestroyed&&(t=e._menu=null),!t||t instanceof oc||("object"!==l()(t)||"items"in t||"widgets"in t||"html"in t||(t={lazyItems:t}),t=e.menu=oc.create(Object.assign({type:"menu",autoShow:!1,autoClose:!0,scrollAction:e.owner.scrollAction,constrainTo:e.owner.constrainTo,forElement:e.element,align:"l0-r0",anchor:!0,owner:e,cls:"b-sub-menu"},t))),t}},{key:"text",get:function(){return this.html},set:function(e){this.html=e}},{key:"closeParent",set:function(e){this._closeParent=e},get:function(){return("boolean"==typeof this.checked?this._closeParent:!1!==this._closeParent)&&!this.hasMenu}},{key:"hasMenu",get:function(){var e=this.isConfiguring?this.initialConfig.menu:this._menu;return e&&(e instanceof oc||"object"===l()(e)||e.length>0)}},{key:"childItems",get:function(){var e=this.menu;return e?[e]:[]}}],[{key:"$name",get:function(){return"MenuItem"}},{key:"type",get:function(){return"menuitem"}},{key:"configurable",get:function(){return{checked:null}}},{key:"defaultConfig",get:function(){return{menu:null,icon:null,text:null,closeParent:null,href:null,target:null,localizableProperties:["text"]}}}]),n}(oc);function _d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}jd.initClass(),jd._$name="MenuItem";var Bd={ArrowUp:1,ArrowDown:1,ArrowRight:1,ArrowLeft:1,Enter:1,Escape:1},Hd=function(e){fe()(n,e);var t=_d(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e){Array.isArray(e)&&(e={lazyItems:e}),we()(pe()(n.prototype),"construct",this).call(this,e),nu.on({element:this.element,click:"onMouseClick",mouseover:"onMouseOver",mouseleave:"onMouseLeave",thisObj:this})}},{key:"afterShow",value:function(e){this.items.some((function(e){return Boolean(e._menu)}))&&this.element.classList.add("b-menu-with-submenu"),this.items.some((function(e){return e.icon}))&&this.element.classList.add("b-menu-with-icon"),we()(pe()(n.prototype),"afterShow",this).call(this,e)}},{key:"createWidget",value:function(e){return"string"==typeof e&&(e={text:e}),we()(pe()(n.prototype),"createWidget",this).call(this,e)}},{key:"onDocumentMouseDown",value:function(e){this.parentMenu&&this.parentMenu.owns(e.event.target)||we()(pe()(n.prototype),"onDocumentMouseDown",this).call(this,e)}},{key:"hide",value:function(e){we()(pe()(n.prototype),"hide",this).call(this,e),this.currentSubMenu&&!this.currentSubMenu.isDestroyed&&this.currentSubMenu.hide(e),this.parentMenu&&(this.parentMenu.currentSubMenu=null)}},{key:"onMouseClick",value:function(e){var t=e.target.closest(".b-menuitem");t&&(this.triggerElement(t,e),e.stopImmediatePropagation())}},{key:"onMouseOver",value:function(e){if(!1!==this.focusOnHover){var t=Cr.up(e.relatedTarget,".b-widget"),n=Cr.up(e.target,".b-widget"),r=oc.fromElement(n);!Cr.isTouchEvent&&n&&n!==t&&r.parent===this&&this.setTimeout({fn:"handleMouseOver",delay:30,args:[r],cancelOutstanding:!0})}}},{key:"handleMouseOver",value:function(e){e.focus()}},{key:"onMouseLeave",value:function(e){var t=this,n=e.relatedTarget,r=n&&t.owns(n),i=n&&n instanceof HTMLElement&&oc.fromElement(n),o=!r;if(i){for(;i.ownerCmp;)i=i.ownerCmp;o&=!Cr.getAncestor(i.element,[e.target])}!r&&o&&(t.currentSubMenu&&t.currentSubMenu.hide(),t.currentSubMenu=t.selectedElement=null,t.element.contains(Cr.activeElement)&&Cr.activeElement.matches(".b-menuitem")&&t.focusElement.focus())}},{key:"onInternalKeyDown",value:function(e){var t=oc.fromElement(e),r=t&&t!==this&&!(t instanceof jd);if("Escape"!==e.key){if(we()(pe()(n.prototype),"onInternalKeyDown",this).call(this,e),!r){Bd[e.key]&&e.preventDefault();var i=Cr.activeElement,o=this.element;this.navigateFrom(i!==o&&o.contains(i)?i:null,e.key,e)}}else(r?this:this.rootMenu).close()}},{key:"navigateFrom",value:function(e,t,n){var r,i=this,o=i.treeWalker,a=e&&i.getItem(e);switch(t){case"ArrowUp":o.currentNode=e||(e=i.bottomFocusTrap),o.previousNode(),r=o.currentNode;break;case"ArrowDown":o.currentNode=e||(e=i.topFocusTrap),o.nextNode(),r=o.currentNode;break;case" ":e&&!e.classList.contains("b-disabled")&&(a&&a.menu?i.openSubMenu(e,a):i.triggerElement(e,n));break;case"ArrowRight":if(e&&a&&a.menu&&!e.classList.contains("b-disabled")){var s=i.openSubMenu(e,a);s&&s.focus()}else o.currentNode=e||(e=i.topFocusTrap),o.nextNode(),r=o.currentNode;break;case"ArrowLeft":i.isSubMenu?i.hide():e||(o.currentNode=e||(e=i.topFocusTrap),o.nextNode(),r=o.currentNode);break;case"Enter":e&&!e.classList.contains("b-disabled")&&i.triggerElement(e,n)}r&&(r===i.element?i.navigateFrom(i.bottomFocusTrap,"ArrowUp",n):r===e?i.navigateFrom(i.topFocusTrap,"ArrowDown",n):r.focus())}},{key:"getItem",value:function(e){if(null!=e)return"number"==typeof e?this.items[e]:1===e.nodeType?oc.fromElement(e,"menuitem",this.contentElement):this.items.find((function(t){return t.id==e}))}},{key:"triggerElement",value:function(e,t){var n=this.getItem(e);n&&!n.disabled&&n.doAction(t)}},{key:"openSubMenu",value:function(e,t){var n=t.menu;if(n){if(!n.isVisible){var r={item:t,element:e};if(!1===this.trigger("beforeSubMenu",r))return;if(t.onBeforeSubMenu&&!1===t.onBeforeSubMenu(r))return;n.show()}return this.currentSubMenu=n}}},{key:"selectFirst",value:function(){var e=this.treeWalker;e.currentNode=this.topFocusTrap,e.nextNode(),this.requestAnimationFrame((function(){return e.currentNode.focus()}))}},{key:"focusElement",get:function(){var e,t=null===(e=this.parentMenu)||void 0===e?void 0:e.element.contains(Cr.activeElement),r=this.items[0];return!t&&r instanceof jd?this.element:we()(pe()(n.prototype),"focusElement",this)}},{key:"isSubMenu",get:function(){return this.owner&&this===this.owner.menu}},{key:"selectedElement",set:function(e){var t=this._selectedElement;if(t){var n=this.getItem(t),r=n&&n.menu;r&&r.hide(),t.classList.remove("b-active")}if(this._selectedElement=e,e){var i=Cr.isFocusable(e);e.classList.add("b-active"),this.scrollable.scrollIntoView(e,{animate:!i,focus:i})}},get:function(){return this._selectedElement}},{key:"parentMenu",get:function(){var e=this.owner;if(e instanceof jd&&(e=e.owner),e instanceof n)return e}},{key:"rootMenu",get:function(){for(var e=this;e.parentMenu&&e.parentMenu instanceof this.constructor;)e=e.parentMenu;return e}}],[{key:"$name",get:function(){return"Menu"}},{key:"type",get:function(){return"menu"}},{key:"configurable",get:function(){return{align:"t-b",scrollAction:"hide",focusOnHover:null,scrollable:!1,defaultType:"menuitem",tools:{close:!1}}}}]),n}(zl);function $d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Hd.initClass(),Hd._$name="Menu";var Nd=function(e){fe()(r,e);var t,n=$d(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"construct",value:function(){this.noButton=0,this.yesButton=1,this.cancelButton=3,we()(pe()(r.prototype),"construct",this).apply(this,arguments)}},{key:"confirm",value:(t=Wr()(Vr.a.mark((function e(t){var n,r,i,o;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.message,r=t.title,i=void 0===r?"":r,(o=this).getConfig("lazyItems"),o.title=o.optionalL(i),o.element.classList.remove(o.showClass),n?(o.showClass="b-show-message-yes-no",o.widgetMap.message.html=o.optionalL(n)):o.showClass="b-show-yes-no",o.element.classList.add(o.showClass),o.show(),e.abrupt("return",o.promise=new Promise((function(e){o.resolve=e})));case 9:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"doResolve",value:function(e){var t=this,n=t.resolve;n&&(t.resolve=t.reject=t.promise=null,n(e),t.hide())}},{key:"onInternalKeyDown",value:function(e){"Escape"===e.key&&(e.stopImmediatePropagation(),this.widgetMap.cancelButton.isVisible?this.onCancelClick():this.onNoClick()),we()(pe()(r.prototype),"onInternalKeyDown",this).call(this,e)}},{key:"onYesClick",value:function(){this.doResolve(Vd.yesButton)}},{key:"onNoClick",value:function(){this.doResolve(Vd.noButton)}},{key:"onCancelClick",value:function(){this.doResolve(Vd.cancelButton)}}],[{key:"$name",get:function(){return"MessageDialog"}},{key:"type",get:function(){return"messagedialog"}},{key:"configurable",get:function(){return{id:"bryntum-msgdialog",centered:!0,modal:!0,hidden:!0,autoShow:!1,closeAction:"hide",title:"",lazyItems:{$config:["lazy"],value:[{type:"widget",id:"bryntum-msgdialog-message",cls:"b-msgdialog-message",ref:"message"},{type:"textfield",id:"bryntum-msgdialog-input",cls:"b-msgdialog-input",ref:"input"}]},bbar:{id:"bryntum-msgdialog-bbar",items:[{ref:"yesButton",id:"bryntum-msgdialog-yesbutton",cls:"b-msgdialog-yesbutton b-green",text:"L{Object.Yes}",onClick:"up.onYesClick"},{ref:"noButton",id:"bryntum-msgdialog-nobutton",cls:"b-msgdialog-nobutton b-gray",text:"L{Object.No}",onClick:"up.onNoClick"},{ref:"cancelButton",id:"bryntum-msgdialog-cancelbutton",cls:"b-msgdialog-cancelbutton b-gray",text:"L{Object.Cancel}",onClick:"up.onCancelClick"}]}}}}]),r}(zl);Nd.initClass();var Vd=new Nd,zd=Vd;function Wd(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var Gd=/\d/,Yd=function(e){fe()(n,e);var t=Wd(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e){we()(pe()(n.prototype),"construct",this).call(this,e);var t=this;t.input.addEventListener("dblclick",(function(){t.select()})),"number"==typeof t.changeOnSpin&&(t.bufferedSpinChange=t.buffer(t.triggerChange,t.changeOnSpin))}},{key:"acceptValue",value:function(e){var t=!isNaN(e);if(t&&!this.hasTextSelection){t=!1;var n=this.input.value;n!=e&&(t=!this.acceptValue(n))}return t}},{key:"okMax",value:function(e){return isNaN(this.max)||e<=this.max}},{key:"okMin",value:function(e){return isNaN(this.min)||e>=this.min}},{key:"internalOnKeyEvent",value:function(e){if("keydown"===e.type){var t,r=this,i=e.key;if("ArrowUp"===i)r.doSpinUp(e.shiftKey),t=!0;else if("ArrowDown"===i)r.doSpinDown(e.shiftKey),t=!0;else if(!e.altKey&&!e.ctrlKey&&i&&1===i.length){var o=r.getAfterValue(i),a=r.formatter.parseStrict(o);t=!r.acceptValue(a)}"Enter"===i&&r._changedBySilentSpin&&(r.triggerChange(e,!0),r._changedBySilentSpin=!1),t&&e.preventDefault()}we()(pe()(n.prototype),"internalOnKeyEvent",this).call(this,e)}},{key:"doSpinUp",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=(t.value||0)+(e?t.largeStep:t.step);t.okMin(n)||(n=t.min),t.okMax(n)&&t.applySpinChange(n)}},{key:"doSpinDown",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=(t.value||0)-(e?t.largeStep:t.step);t.okMax(n)||(n=t.max),t.okMin(n)&&t.applySpinChange(n)}},{key:"applySpinChange",value:function(e){var t=this;t._isUserAction=!0,!0!==t.changeOnSpin&&(t._changedBySilentSpin=!0,t.silenceChange=!0,t.bufferedSpinChange&&t.bufferedSpinChange(null,!0)),t.value=e,t._isUserAction=!1,t.silenceChange=!1}},{key:"triggerChange",value:function(){this.silenceChange||we()(pe()(n.prototype),"triggerChange",this).apply(this,arguments)}},{key:"onFocusOut",value:function(e){we()(pe()(n.prototype),"onFocusOut",this).apply(this,arguments),this._changedBySilentSpin&&(this.triggerChange(e,!0),this._changedBySilentSpin=!1)}},{key:"internalOnInput",value:function(e){var t=this,r=t.input,i=r.value,o=t.formatter.truncate(i),a=isNaN(o)?"":t.formatValue(o);if(i!==a&&Gd.test(i[i.length-1])){var s=i.length-t.caretPos;r.value=a,t.caretPos=a.length-s}we()(pe()(n.prototype),"internalOnInput",this).call(this,e)}},{key:"formatValue",value:function(e){return this.formatter.format(e)}},{key:"changeFormat",value:function(e){if(""===e){var t=this.leadingZeroes,n=this.decimalPrecision;e=t?"".concat(t,">9"):null,null!=n?e="".concat(e||"","9.").concat("#".repeat(n)):e&&(e+=".*")}return e}},{key:"updateStep",value:function(e){this.element.classList[e?"remove":"add"]("b-hide-spinner"),this._step=e}},{key:"changeLargeStep",value:function(e){return e||10*this.step}},{key:"changeValue",value:function(e,t){var r;e||0===e?("number"!=typeof e&&(e="string"==typeof e?this.formatter.parse(e):Number(e),(r=isNaN(e))&&(e="")),!r&&this.format&&(e=this.formatter.round(e))):e=void 0;return we()(pe()(n.prototype),"changeValue",this).call(this,e,t)}},{key:"formatter",get:function(){var e=this,t=e.format,n=e._formatter;return n&&e._lastFormat===t||(n=Tc.get(e._lastFormat=t),e._formatter=n),n}},{key:"validity",get:function(){var e=this.value,t={};return null!=e&&(t.rangeUnderflow=!this.okMin(e),t.rangeOverflow=!this.okMax(e)),t.valid=!t.rangeUnderflow&&!t.rangeOverflow,t}},{key:"inputValue",get:function(){var e=this.value;return null!=e&&this.format&&(e=this.formatValue(e)),e}}],[{key:"$name",get:function(){return"NumberField"}},{key:"type",get:function(){return"numberfield"}},{key:"alias",get:function(){return"number"}},{key:"configurable",get:function(){return{min:null,max:null,step:1,largeStep:0,value:0,format:"",decimalPrecision:null,leadingZeroes:null,triggers:{spin:{type:"spintrigger"}},changeOnSpin:!0,inputType:null}}}]),n}(Pf);function Ud(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Yd.initClass(),Yd._$name="NumberField";var qd=function(e){fe()(n,e);var t=Ud(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"onStoreBeforeRequest",value:function(){this.eachWidget((function(e){return e.disable()}))}},{key:"updateLocalization",value:function(){var e=this,t=e.widgetMap,r=t.reloadButton,i=t.firstPageButton,o=t.previousPageButton,a=t.nextPageButton,s=t.lastPageButton;i.tooltip=e.L("L{firstPage}"),o.tooltip=e.L("L{prevPage}"),a.tooltip=e.L("L{nextPage}"),s.tooltip=e.L("L{lastPage}"),r.tooltip=e.L("L{reload}"),e.updateSummary(),we()(pe()(n.prototype),"updateLocalization",this).call(this)}},{key:"updateSummary",value:function(){var e,t,n,r,i,o=this,a=o.widgetMap,s=a.pageCount,u=a.dataSummary;if(e=t=n=r=i=0,o.store){var c=o.store,l=c.pageSize,f=c.currentPage;e=c.count,t=c.lastPage,i=c.allCount,n=Math.max(0,(f-1)*l+1),r=Math.min(i,n+l-1)}s.html=o.L("L{pageCountTemplate}")({lastPage:t}),u.html=e?o.L("L{summaryTemplate}")({start:n,end:r,allCount:i}):o.L("L{noRecords}")}},{key:"onStoreChange",value:function(){var e=this.widgetMap,t=this.store,n=t.count,r=t.lastPage,i=t.currentPage,o=e.pageNumber,a=e.pageCount,s=e.firstPageButton,u=e.previousPageButton,c=e.nextPageButton,l=e.lastPageButton,f=e.dataSummary;this.eachWidget((function(e){return e.enable()})),o.value=i,o.max=r,f.disabled=o.disabled=a.disabled=!n,s.disabled=u.disabled=i<=1||!n,c.disabled=l.disabled=i>=r||!n,this.updateSummary()}},{key:"onPageNumberChange",value:function(e){var t=e.value;this.store.currentPage!==t&&this.store.loadPage(t)}},{key:"onFirstPageClick",value:function(){this.store.loadPage(1)}},{key:"onPreviousPageClick",value:function(){this.store.previousPage()}},{key:"onNextPageClick",value:function(){this.store.nextPage()}},{key:"onLastPageClick",value:function(){this.store.loadPage(this.store.lastPage)}},{key:"onReloadClick",value:function(){this.store.loadPage(this.store.currentPage)}},{key:"parent",set:function(e){sc()(pe()(n.prototype),"parent",e,this,!0),this.store||(this.store=e.store)},get:function(){return we()(pe()(n.prototype),"parent",this)}},{key:"store",set:function(e){var t=this,n={beforerequest:"onStoreBeforeRequest",afterrequest:"onStoreChange",change:"onStoreChange",thisObj:t};t.store&&t.store.un(n),t._store=e,e&&(e.on(n),e.isLoading&&t.onStoreBeforeRequest())},get:function(){return this._store}}],[{key:"$name",get:function(){return"PagingToolbar"}},{key:"type",get:function(){return"pagingtoolbar"}},{key:"defaultConfig",get:function(){return{store:null,defaults:{localeClass:this},items:{firstPageButton:{onClick:"up.onFirstPageClick",icon:"b-fa-angle-double-left"},previousPageButton:{onClick:"up.onPreviousPageClick",icon:"b-fa-angle-left"},pageNumber:{type:"numberfield",label:"L{page}",min:1,max:1,triggers:null,onChange:"up.onPageNumberChange",highlightExternalChange:!1},pageCount:{type:"widget",cls:"b-pagecount b-toolbar-text"},nextPageButton:{onClick:"up.onNextPageClick",icon:"b-fa-angle-right"},lastPageButton:{onClick:"up.onLastPageClick",icon:"b-fa-angle-double-right"},separator:{type:"widget",cls:"b-toolbar-separator"},reloadButton:{onClick:"up.onReloadClick",icon:"b-fa-redo"},spacer:{type:"widget",cls:"b-toolbar-fill"},dataSummary:{type:"widget",cls:"b-toolbar-text"}}}}}]),n}(jl);function Kd(){var e=El()(['\n            <div class="','">\n                <input type="range"\n                   data-reference="input"\n                   id="','-input"\n                   min="','"\n                   max="','"\n                   step="','"\n                   value="','">\n                <label data-reference="label" for="','-input">',"</label>\n            </div>\n        "]);return Kd=function(){return e},e}function Xd(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}qd.initClass(),qd._$name="PagingToolbar";var Zd=function(e){fe()(n,e);var t=Xd(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e){var t=this;we()(pe()(n.prototype),"construct",this).call(this,e),t.updateLabel(),t.showTooltip&&(t.tip=new Kl({forElement:t.input,anchor:!1,align:"b-t",axisLock:!0})),t.input.addEventListener("input",t.onInternalInput.bind(t)),t.input.addEventListener("change",t.onInternalChange.bind(t)),t.input.addEventListener("mouseover",t.onInternalMouseOver.bind(t)),t.input.addEventListener("mouseout",t.onInternalMouseOut.bind(t))}},{key:"template",value:function(e){return Iu.tpl(Kd(),e.text?"b-text b-has-label":"",e.id,e.min,e.max,e.step,e.value,e.id,e.text)}},{key:"onInternalInput",value:function(e){var t=this;t._value=parseInt(t.input.value),t.updateUI(),t.trigger("input",{value:t.value})}},{key:"onInternalChange",value:function(e){this.updateUI(),this.triggerChange(!0),this.trigger("action",{value:this.value})}},{key:"onInternalMouseOver",value:function(e){this.updateLabel(),this.tip&&this.tip.showBy({target:this.calcThumbPosition(),offset:5})}},{key:"onInternalMouseOut",value:function(e){this.tip&&this.tip.hide()}},{key:"triggerChange",value:function(e){this.triggerFieldChange({value:this.value,valid:!0,userAction:e})}},{key:"updateLabel",value:function(){this.text=this._text}},{key:"updateTooltipPosition",value:function(){this.tip&&this.tip.alignTo({target:this.calcThumbPosition(),offset:5})}},{key:"updateUI",value:function(){this.updateLabel(),this.updateTooltipPosition()}},{key:"calcThumbPosition",value:function(){var e=this,t=En.from(e.input),n=(t.width-e.thumbSize)*e.calcPercentProgress()/100;return new En(t.x+n,t.y+t.height/2-e.thumbSize/2,e.thumbSize,e.thumbSize)}},{key:"calcPercentProgress",value:function(){return(this.value-this.min)/(this.max-this.min)*100}},{key:"focusElement",get:function(){return this.input}},{key:"text",get:function(){return this._text},set:function(e){var t=this;t._text=e,t.label&&(t.showValue&&(e=e?"".concat(e," (").concat(t.value,")"):t.value),t.label.innerHTML=e),t.tip&&(t.tip.html=t.value)}},{key:"value",get:function(){return this.input?parseInt(this.input.value):this._value},set:function(e){var t=this;t._value!==e&&(t.input&&(t.input.value=e,t.updateUI(),t.triggerChange(!1)),t._value=e)}},{key:"min",get:function(){return this.input?this.input.min:this._min},set:function(e){var t=this;t.input&&(t.input.min=e,t._value<e&&(t.value=e,t.trigger("input",{value:t.value}))),t._min=e}},{key:"max",get:function(){return this.input?this.input.max:this._max},set:function(e){var t=this;t.input&&(t.input.max=e,t._value>e&&(t.value=e,t.trigger("input",{value:t.value}))),t._max=e}},{key:"step",get:function(){return this.input?this.input.step:this._step},set:function(e){this.input&&(this.input.step=e),this._step=e}}],[{key:"$name",get:function(){return"Slider"}},{key:"type",get:function(){return"slider"}},{key:"defaultConfig",get:function(){return{text:"",showValue:!0,showTooltip:!1,min:0,max:100,step:1,value:null,thumbSize:20,localizableProperties:["text"]}}}]),n}(oc);function Jd(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Qd(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Qd(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Qd(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function eh(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Zd.initClass(),Zd._$name="Slider";var th=function(e){return parseInt(Cr.getStyleValue(e,"flex-basis"),10)||parseInt(Cr.getStyleValue(e,"flex-grow"),10)},nh=function(e){fe()(n,e);var t=eh(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"doDestroy",value:function(){this.mouseDetacher&&this.mouseDetacher(),we()(pe()(n.prototype),"doDestroy",this).call(this)}},{key:"template",value:function(){return'<div class="b-splitter"></div>'}},{key:"updateOrientation",value:function(){var e=this,t=this.element;if(e._prevOrientation&&t.classList.remove(e._prevOrientation),!e._currentOrientation&&e.rendered&&t.offsetParent){var n=Cr.getStyleValue(t.parentElement,"flex-direction");if(n)e._currentOrientation=n.startsWith("column")?"horizontal":"vertical";else{var r=t.previousElementSibling,i=t.nextElementSibling;if(!r||!i)return;var o=r.getBoundingClientRect(),a=i.getBoundingClientRect(),s=o.top<a.top?o:a,u=s===a?o:a;e._currentOrientation=s.top!==u.top?"horizontal":"vertical"}}e._currentOrientation&&t.classList.add("b-".concat(e._currentOrientation)),e._prevOrientation=e._currentOrientation}},{key:"onMouseDown",value:function(e){e.preventDefault(),e.touches&&(e=e.touches[0]);var t=this,n=t.element,r=n.previousElementSibling,i=n.nextElementSibling,o=th(r),a=th(i),s=[];t.mouseDetacher&&t.mouseDetacher();var u,c=Jd(n.parentElement.children);try{for(c.s();!(u=c.n()).done;){var l=u.value;th(l)&&l!==n&&s.push({element:l,width:l.offsetWidth,height:l.offsetHeight})}}catch(e){c.e(e)}finally{c.f()}t.context={startX:e.pageX,startY:e.pageY,prevWidth:r.offsetWidth,prevHeight:r.offsetHeight,nextWidth:i.offsetWidth,nextHeight:i.offsetHeight,prevHasFlex:o,nextHasFlex:a,flexed:s,prev:r,next:i};var f={element:document,pointermove:"onMouseMove",pointerup:"onMouseUp",thisObj:t};j.a.supportsPointerEvents||(f.mousemove="onMouseMove",f.touchmove="onMouseMove",f.mouseup=f.touchend="onMouseUp"),t.mouseDetacher=nu.on(f)}},{key:"onMouseMove",value:function(e){var t=this,n=t.context,r=e.pageX-n.startX,i=e.pageY-n.startY;if(e.preventDefault(),Object.assign(n,{deltaX:r,deltaY:i}),n.started||(n.started=!0,t.trigger("start",{context:n,event:e}),n.flexed.forEach((function(e){"vertical"===t.currentOrientation?e.element.style.flexGrow=e.width:e.element.style.flexGrow=e.height,e.element.style.flexBasis="0"}))),"vertical"===t.currentOrientation){var o=n.prevWidth+r,a=n.nextWidth-r;n.prevHasFlex?n.prev.style.flexGrow=o:n.prev.style.width="".concat(o,"px"),n.nextHasFlex?n.next.style.flexGrow=a:n.next.style.width="".concat(a,"px")}else{var s=n.prevHeight+i,u=n.nextHeight-i;n.prevHasFlex?n.prev.style.flexGrow=s:n.prev.style.height="".concat(s,"px"),n.nextHasFlex?n.next.style.flexGrow=u:n.next.style.height="".concat(u,"px")}t.trigger("move",{context:n,event:e})}},{key:"onMouseUp",value:function(e){var t=this;t.mouseDetacher&&t.mouseDetacher(),t.mouseDetacher=null,t.context.started&&t.trigger("end",{context:t.context,event:e}),t.context=null}},{key:"render",value:function(){we()(pe()(n.prototype),"render",this).apply(this,arguments);var e=this;e._currentOrientation||(e.updateOrientation(),e._currentOrientation||e.requestAnimationFrame((function(){return e.updateOrientation()})))}},{key:"element",get:function(){return we()(pe()(n.prototype),"element",this)},set:function(e){sc()(pe()(n.prototype),"element",e,this,!0);var t={element:this.element,pointerdown:"onMouseDown",thisObj:this};j.a.supportsPointerEvents||(t.mousedown="onMouseDown",t.touchstart="onMouseDown"),nu.on(t)}},{key:"currentOrientation",get:function(){return this._currentOrientation}},{key:"orientation",get:function(){return this._orientation},set:function(e){this._orientation=e,this._currentOrientation="auto"===e?null:e,this.updateOrientation()}}],[{key:"type",get:function(){return"splitter"}},{key:"defaultConfig",get:function(){return{orientation:"auto"}}}]),n}(oc);function rh(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}nh.initClass(),nh._$name="Splitter";var ih=["b-slide-out-left","b-slide-out-right","b-slide-in-left","b-slide-in-right"],oh=function(e){fe()(n,e);var t=rh(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"onChildAdd",value:function(e){we()(pe()(n.prototype),"onChildAdd",this).call(this,e),e.on({beforeHide:"onBeforeChildHide",beforeShow:"onBeforeChildShow",thisObj:this});var t=this.activeItem,r=this.owner,i=null!=r.activeIndex?r.activeIndex:this.activeIndex||0,o=r.items.indexOf(e);(null!=t?e===t:o===i)?(e.show(),this._activeIndex=o,this._activeItem=e):e.hide()}},{key:"onChildRemove",value:function(e){we()(pe()(n.prototype),"onChildRemove",this).call(this,e),this._activeItem===e&&this.activateSiblingOf(e),e.un({beforeHide:"onBeforeChildHide",beforeShow:"onBeforeChildShow",thisObj:this})}},{key:"onBeforeChildShow",value:function(e){var t=e.source;if(!this.owner.isConfiguring&&!t.$isActivating)return this.activeItem=t,!1}},{key:"onBeforeChildHide",value:function(e){var t=e.source;if(!this.owner.isConfiguring&&!t.$isDeactivating)return this.activateSiblingOf(t),!1}},{key:"activateSiblingOf",value:function(e){var t=this.owner.items.slice(),n=t.indexOf(e);t.splice(n,1),this.activeIndex=Math.min(n,t.length-1)}},{key:"setActiveItem",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.activeIndex,n=this,r=n.owner,i=r.items,o=e instanceof oc,a=i[t],s=r.items[e=o?e=i.indexOf(e):parseInt(e)],u={prevActiveIndex:t,prevActiveItem:a};if(s&&!s.$isActivating&&s!==a){var c=a&&a.element,l=s&&s.element;if(u.activeIndex=e,u.activeItem=s,!1===r.trigger("beforeActiveItemChange",u))return null;if(n.animateDetacher){var f=n.animateDetacher.event;n.animateDetacher(),Cr.removeClasses(f.prevActiveItem.element,ih),Cr.removeClasses(f.activeItem.element,ih),n.animateDetacher=null}u.promise=new Promise((function(i,o){if(c&&r.isVisible&&n.animateCardChange){var f=a.monitorResize;a.monitorResize=!1,a._hidden=!0,s.$isActivating=!0,s.show(),s.$isActivating=!1,c.classList.add(e>t?"b-slide-out-left":"b-slide-out-right"),l.classList.add(e<t?"b-slide-in-left":"b-slide-in-right"),r.isAnimating=!0,n.animateDetacher=nu.on({element:l,animationend:function(){n.animateDetacher=null,r.isAnimating=!1,Cr.removeClasses(l,ih),c&&(Cr.removeClasses(c,ih),a.$isDeactivating=!0,a._hidden=!1,a.hide(),a.monitorResize=f,a.$isDeactivating=!1),n.onActiveItemChange(u,i)},once:!0}),n.animateDetacher.reject=o,n.animateDetacher.event=u}else s.$isActivating=!0,s.show(),s.$isActivating=!1,a&&(a.$isDeactivating=!0,a.hide(),a.$isDeactivating=!1),n.onActiveItemChange(u,i)}))}return u}},{key:"onActiveItemChange",value:function(e,t){this._activeItem=e.activeItem,this._activeIndex=e.activeIndex,this.owner.trigger("activeItemChange",e),e.activeItem.focus(),t(e)}},{key:"renderChildren",value:function(){var e=this.owner;j.a.isIE11&&(this.animateCardChange=!1),e.contentElement.classList[e.suppressChildHeaders?"add":"remove"](this.hideChildHeaderCls),we()(pe()(n.prototype),"renderChildren",this).call(this)}},{key:"changeActiveIndex",value:function(e){var t=this.owner;return t.isConfiguring&&!t._items?e:Math.min(e,t.items.length-1)}},{key:"updateActiveIndex",value:function(e,t){this.owner.isConfiguring||this.setActiveItem(e,t)}},{key:"updateActiveItem",value:function(e){this.owner.isConfiguring||this.setActiveItem(e,this.activeIndex)}}],[{key:"$name",get:function(){return"Card"}},{key:"configurable",get:function(){return{containerCls:"b-card-container",itemCls:"b-card-item",hideChildHeaderCls:"b-hide-child-headers",animateCardChange:!0,activeItem:null,activeIndex:null}}}]),n}(hl);function ah(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}oh._$name="Card",hl.registerLayout(oh);var sh=function(e){fe()(n,e);var t=ah(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e){var t=this;we()(pe()(n.prototype),"construct",this).call(this,e),t.items.forEach((function(e,n){e.titleElement=t.element.querySelector('div.b-tabpanel-tab[data-index="'.concat(n,'"] span'))})),nu.on({element:t.tabStrip,delegate:".b-tabpanel-tab",click:"onTabElementClick",thisObj:this})}},{key:"changeElement",value:function(){var e=this;return we()(pe()(n.prototype),"changeElement",this).call(this,{children:[{className:"b-tabpanel-tabs",reference:"tabStrip",children:e.items.map((function(t,n){var r;return{className:(r={"b-tabpanel-tab":1,"b-active":n===e.activeTab},ke()(r,t.cls,t.cls),ke()(r,"b-hidden",t.$hideTab),r),style:{minWidth:Cr.setLength(e.tabMinWidth),maxWidth:Cr.setLength(e.tabMaxWidth)},tabindex:-1,dataset:{index:n},children:[{tag:"span",className:"b-tabpanel-tab-title",html:t.title}]}}))},{className:{"b-tabpanel-body":1},reference:"tabPanelBody"}]})}},{key:"onChildAdd",value:function(e){e.hidden&&(e.$hideTab=!0),we()(pe()(n.prototype),"onChildAdd",this).call(this,e),e.on({beforeHide:"onBeforeChildHide",thisObj:this,prio:1e3})}},{key:"onChildRemove",value:function(e){we()(pe()(n.prototype),"onChildRemove",this).call(this,e),e.un({beforeHide:"onBeforeChildHide",thisObj:this})}},{key:"updateTabMinWidth",value:function(e){this.element&&Cr.forEachSelector(this.element,".b-tabpanel-tab",(function(t){Cr.setLength(t,"minWidth",e||null)}))}},{key:"updateTabMaxWidth",value:function(e){this.element&&Cr.forEachSelector(this.element,".b-tabpanel-tab",(function(t){Cr.setLength(t,"maxWidth",e||null)}))}},{key:"changeLayout",value:function(e){return(e=we()(pe()(n.prototype),"changeLayout",this).call(this,e)).activeIndex=this.activeTab,e.animateCardChange=this.animateTabChange,e}},{key:"changeActiveTab",value:function(e){return parseInt(e,10)}},{key:"updateActiveTab",value:function(e){if("number"==typeof e){if(e<0||e>=this.items.length)throw new Error("Invalid tab index: "+e)}else-1===this.items.indexOf(e)&&(e=this.add(e));this.isConfiguring||(this.layout.activeItem=e)}},{key:"onActiveItemChange",value:function(e){var t=this.tabStrip,n=e.prevActiveIndex,r=e.activeIndex,i=t.children[n];this.activeTab=r,i&&i.classList.remove("b-active"),t.children[r].classList.add("b-active"),t.children[r].classList.remove("b-hidden"),this.trigger("tabChange",e)}},{key:"onTabElementClick",value:function(e){this.activeTab=e.currentTarget.dataset.index}},{key:"onBeforeChildHide",value:function(e){var t=e.source;t.$isDeactivating||this.element.querySelector('div.b-tabpanel-tab[data-index="'.concat(this.items.indexOf(t),'"]')).classList.add("b-hidden")}},{key:"contentElement",get:function(){return this.tabPanelBody}},{key:"focusElement",get:function(){var e=this.items[this.activeTab||0];return e&&e.focusElement||this.tabStrip.children[this.activeTab]}},{key:"activeIndex",get:function(){return this.layout.activeIndex}},{key:"activeItem",get:function(){return this.layout.activeItem}}],[{key:"$name",get:function(){return"TabPanel"}},{key:"type",get:function(){return"tabpanel"}},{key:"alias",get:function(){return"tabs"}},{key:"configurable",get:function(){return{suppressChildHeaders:!0,activeTab:0,tabMinWidth:null,tabMaxWidth:null,animateTabChange:!0}}},{key:"defaultConfig",get:function(){return{itemCls:"b-tabpanel-item",defaultType:"container",layout:"card"}}}]),n}(Rl);function uh(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}sh.initClass(),sh._$name="TabPanel";var ch=function(e){fe()(n,e);var t=uh(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"startConfigure",value:function(e){this.getConfig("inline"),we()(pe()(n.prototype),"startConfigure",this).call(this,e)}},{key:"showPicker",value:function(){this.inline||(this.picker.width=this.pickerWidth||this[this.pickerAlignElement].offsetWidth,we()(pe()(n.prototype),"showPicker",this).call(this,!0))}},{key:"focusPicker",value:function(){this.input.focus()}},{key:"onPickerKeyDown",value:function(e){var t=this,r=t.input;switch(e.key.trim()||e.code){case"Escape":return void t.picker.hide();case"Enter":e.ctrlKey&&(t.syncInputFieldValue(),t.picker.hide())}t.input=t.displayElement;var i=we()(pe()(n.prototype),"onPickerKeyDown",this).call(this,e);return t.input=r,i}},{key:"syncInputFieldValue",value:function(e){this.displayElement&&(this.displayElement.value=this.inputValue),we()(pe()(n.prototype),"syncInputFieldValue",this).call(this,e)}},{key:"changeValue",value:function(e){return null==e?"":e}},{key:"updateInline",value:function(e){e||this.triggers||(this.triggers={})}},{key:"changeTriggers",value:function(e,t){return this.inline||((e||(e={})).expand={cls:"b-icon-picker",handler:"onTriggerClick"}),we()(pe()(n.prototype),"changeTriggers",this).call(this,e,t)}},{key:"changePicker",value:function(e,t){var r,i=this,o=i.pickerWidth||(null===(r=e)||void 0===r?void 0:r.width);if(e=n.reconfigure(t,e?F.merge({owner:i,forElement:i[i.pickerAlignElement],align:{matchSize:null==o,anchor:i.overlayAnchor,target:i[i.pickerAlignElement]},html:'<textarea id="'.concat(i.id+"-input",'" style="resize:').concat(i.resize,'">').concat(i.value,"</textarea>")},e):null,i)){var a=i.input=e.element.querySelector("#".concat(i.id,"-input"));i.inputListenerRemover=nu.on({element:a,thisObj:i,focus:"internalOnInputFocus",change:"internalOnChange",input:"internalOnInput",keydown:"internalOnKeyEvent",keypress:"internalOnKeyEvent",keyup:"internalOnKeyEvent"})}return e}},{key:"inputElement",get:function(){var e=we()(pe()(n.prototype),"inputElement",this);return this.inline?(e.tag="textarea",e.style=(e.style||"")+";resize:".concat(this.resize)):(e.readOnly="readonly",e.reference="displayElement"),e}},{key:"focusElement",get:function(){return this.inline||this._picker&&this._picker.isVisible?this.input:this.displayElement}}],[{key:"$name",get:function(){return"TextAreaField"}},{key:"type",get:function(){return"textareafield"}},{key:"alias",get:function(){return"textarea"}},{key:"configurable",get:function(){return{picker:{type:"widget",cls:"b-textareafield-picker",floating:!0,scrollAction:"realign",align:{align:"t-b",axisLock:!0},autoShow:!1},triggers:null,inline:!0,resize:"none",inputType:null}}}]),n}(Lf);function lh(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}ch.initClass(),ch._$name="TextAreaField";var fh="http://www.w3.org/2000/svg",dh={bar:1,outline:2,text:3},hh=function(e,t){return parseInt(e.dataset.order,10)-parseInt(t.dataset.order,10)},vh=function(e){return e.field},ph=function(){return!1},gh=function(e){fe()(n,e);var t=lh(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e){we()(pe()(n.prototype),"construct",this).call(this,e),this.scheduleRefresh=this.createOnFrame(this.refresh,[],this,!0),this.refresh()}},{key:"onElementResize",value:function(){we()(pe()(n.prototype),"onElementResize",this).apply(this,arguments);var e=this.svgElement.getBoundingClientRect();this.scaledSvgGroup.setAttribute("transform","scale(".concat(e.width," ").concat(e.height,")"))}},{key:"onBeforeTipShow",value:function(e){var t=e.source,n=parseInt(t.activeTarget.dataset.index);t.html=t.contentTemplate({histogram:this,index:n})}},{key:"scheduleRefresh",value:function(){}},{key:"refresh",value:function(){var e=this,t=e.series,n=e._tip,r=[];for(var i in t){var o=t[i],a=e["draw".concat(E.capitalize(o.type))](o);Array.isArray(a)?r.push.apply(r,a):r.push(a)}r.sort(hh),Gs.syncChildren({domConfig:{children:r},configEquality:ph},e.scaledSvgGroup),Gs.syncChildren({domConfig:{children:e.drawText()}},e.unscaledSvgGroup),n&&n.isVisible&&e.onBeforeTipShow({source:n})}},{key:"drawBar",value:function(e){for(var t,n=this,r=n.topValue,i=n.data,o=n.omitZeroHeightBars,a=n.barStyle,s=e.field,u=e.order,c=1/i.length,l=[],f=0,d=0,h=i.length;f<h;f++,d+=t){var v=i[f],p=v[s],g=(p>r?r:p)/r,y=1-g,m=v.rectConfig={ns:fh,tag:"rect",dataset:{}};if(t=v.width||c,j.a.isEdge||j.a.isIE11){var k=n.svgElement.getBoundingClientRect();m.dataset.scaleX=k.width,m.dataset.scaleY=k.height}a?m.style=a:delete m.style,Object.assign(m.dataset,{index:f,order:u}),Object.assign(m,{x:d,y:y,width:t,height:g,class:n.callback("getRectClass",n,[e,m,v,f])});var b=n.callback("getBarTip",n,[e,m,v,f]);b?m.dataset.btip=b:delete m.dataset.btip,!g&&o||l.push(m)}return l}},{key:"drawOutline",value:function(e){var t=this.topValue,n=this.data,r=e.field,i=e.order,o=1/n.length,a=["M 0,1"],s=e.outlineElement||(e.outlineElement={ns:fh,tag:"path",dataset:{order:i}});if(j.a.isEdge||j.a.isIE11){var u=this.svgElement.getBoundingClientRect();s.style="stroke-width: ".concat(1/Math.min(u.width,u.height),"px")}for(var c,l="M",f="L",d=0,h=0,v=n.length;d<v;d++){var p=1-n[d][r]/t;c=n[d].width||o,a.push("".concat(l," ").concat(h,",").concat(p," ").concat(f," ").concat(h+=c,",").concat(p)),l=f=""}return s.d=a.join(" "),s}},{key:"drawText",value:function(){for(var e,t=this,n=t.data,r=1/n.length,i=[],o=0,a=0,s=n.length;o<s;o++,a+=e){e=n[o].width||r,t.callback("getBarText",t,[n[o],o])&&i.push({ns:fh,tag:"text",className:"b-bar-legend",html:t.callback("getBarText",t,[n[o],o]),x:"".concat(100*(a+e/2),"%"),y:"100%",dataset:{index:o}})}return i}},{key:"getBarText",value:function(e,t){return""}},{key:"getBarTip",value:function(e,t,n,r){}},{key:"getRectClass",value:function(e,t,n,r){return""}},{key:"tip",set:function(e){this.tip&&this.tip.destroy(),this._tip=e?new Kl(Object.assign({owner:this,forElement:this.svgElement,forSelector:"rect",listeners:{beforeShow:"up.onBeforeTipShow"}},e)):null}},{key:"series",set:function(e){var t=this._series={};for(var n in e)if(!1!==e[n]){var r=t[n]=Object.assign({},e[n]);!r.type&&e[n].type&&(r.type=e[n].type),!r.field&&e[n].field&&(r.field=e[n].field),"order"in t||(r.order=dh[r.type]),r.id=n}this.scheduleRefresh()},get:function(){return this._series}},{key:"data",set:function(e){var t=this;if(t._data=e,!t.topValue)for(var n=Object.values(t.series).map(vh),r=0,i=e.length;r<i;r++)for(var o=0,a=n.length;o<a;o++)t.topValue=Math.max(t.topValue||0,e[r][n[o]]);t.scheduleRefresh()},get:function(){return this._data}},{key:"topValue",set:function(e){this._topValue=e,this.scheduleRefresh()},get:function(){return this._topValue}}],[{key:"type",get:function(){return"histogram"}},{key:"$name",get:function(){return"Histogram"}},{key:"defaultConfig",get:function(){return{data:null,values:null,series:null,topValue:null,element:{children:[{ns:fh,tag:"svg",reference:"svgElement",width:"100%",height:"100%",preserveAspectRatio:"none",children:[{ns:fh,tag:"g",reference:"scaledSvgGroup"},{ns:fh,tag:"g",reference:"unscaledSvgGroup"}]}]},omitZeroHeightBars:null,monitorResize:!0,getRectClass:null,getBarTip:null,getBarText:null}}}]),n}(oc);function yh(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return mh(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return mh(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function mh(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function kh(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}gh.initClass(),gh._$name="Histogram";var bh="http://www.w3.org/2000/svg",wh=function(e){fe()(n,e);var t=kh(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e){we()(pe()(n.prototype),"construct",this).call(this,e),this.scheduleRefresh=this.createOnFrame(this.refresh,[],this,!0),this.refresh()}},{key:"changeAlign",value:function(e){return e||(e=this.horizontal?"bottom":"right"),e}},{key:"updateAlign",value:function(e,t){this.element.classList.remove("b-align-".concat(t)),this.element.classList.add("b-align-".concat(e))}},{key:"updateHorizontal",value:function(e,t){this.element.classList.remove("b-scale-".concat(t?"horizontal":"vertical")),this.element.classList.add("b-scale-".concat(e?"horizontal":"vertical"))}},{key:"onElementResize",value:function(){we()(pe()(n.prototype),"onElementResize",this).apply(this,arguments),this.scheduleRefresh()}},{key:"scheduleRefresh",value:function(){}},{key:"refresh",value:function(){var e=this,t=e.horizontal,n=e.width,r=e.height,i=e.align,o=e.scalePoints,a=e.scaleMaxPadding,s=o[o.length-1].value,u=[],c=[],l=1/(s+a*s);e.scaledSvgGroup.setAttribute("transform","scale(".concat(t?n:1," ").concat(t?1:r,")"));var f,d=yh(o);try{for(d.s();!(f=d.n()).done;){var h=f.value,v=Boolean(h.text),p=l*h.value;if(v){var g={ns:bh,tag:"text",className:"b-scale-tick-label",html:h.text,dataset:{tick:h.value}};t?(g.x="".concat(100*p,"%"),g.y="top"===i?"1.6em":r-12):(g.x="left"===i?"12":"".concat(n-12),g.y="".concat(100*(1-p),"%")),c.push(g)}t?"top"===i?u.push("M".concat(p,",0 L").concat(p,",").concat(v?10:5)):u.push("M".concat(p,",").concat(r," L").concat(p,",").concat(r-(v?10:5))):"left"===i?u.push("M0,".concat(1-p," L").concat(v?10:5,",").concat(1-p)):u.push("M".concat(n,",").concat(1-p," L").concat(n-(v?10:5),",").concat(1-p))}}catch(e){d.e(e)}finally{d.f()}e.pathElement.setAttribute("d",u.join("")),Gs.syncChildren({domConfig:{children:c}},e.unscaledSvgGroup)}}],[{key:"type",get:function(){return"scale"}},{key:"$name",get:function(){return"Scale"}},{key:"configurable",get:function(){return{scalePoints:null,scaleMaxPadding:.1,horizontal:!1,align:{value:!1,$config:{merge:"replace"}},element:{children:[{ns:bh,tag:"svg",reference:"svgElement",width:"100%",height:"100%",preserveAspectRatio:"none",children:[{ns:bh,tag:"g",reference:"scaledSvgGroup",children:[{ns:bh,tag:"path",reference:"pathElement"}]},{ns:bh,tag:"g",reference:"unscaledSvgGroup"}]}]},monitorResize:!0}}}]),n}(oc);function Ch(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}wh._$name="Scale";var Sh=function(e){return"number"==typeof e||(null==e?void 0:e.endsWith("px"))},Dh=function(e){fe()(n,e);var t=Ch(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e,t){var r=this;r.masterStore=t,t&&(r._grid=Array.isArray(t)?t[0].grid:t.grid),r.localizableProperties=e.localizableProperties||["text"],e.localeClass&&(r.localeClass=e.localeClass),we()(pe()(n.prototype),"construct",this).call(this,e,t,null,!1),"field"in r.data||(r.field="_"+(r.type||"")+ ++n.emptyCount,r.noFieldSpecified=!0),r.hasComplexMapping=r.field&&r.field.includes("."),r.width||r.flex||r.children||r.set({width:n.defaultWidth,flex:null},null,!0)}},{key:"remove",value:function(){var e=this.subGrid,t=this.grid,r=e&&t&&t.focusedCell;r&&r.columnId===this.id&&(Cr.activeElement===t?t.navigateRight():r.columnId=e.columns.getAdjacentVisibleLeafColumn(this.id,!0,!0).id),we()(pe()(n.prototype),"remove",this).call(this)}},{key:"getRawValue",value:function(e){return this.hasComplexMapping?an.getPath(e,this.field):e[this.field]}},{key:"hide",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=t.parent;if(!t.hidden){if(t.hidden=!0,n&&!n.isRoot){var r=n.children.some((function(e){return!0!==e.hidden}));r||n.hidden||(e=!0,n.hide())}t.children&&t.children.forEach((function(e){return e.hide(!0)})),e||t.stores.forEach((function(e){return e.trigger("columnHide",{column:t})}))}}},{key:"show",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=t.parent;t.hidden&&(t.hidden=!1,n&&n.hidden&&n.show(),t.children&&t.children.forEach((function(e){return e.show(!0)})),e||t.stores.forEach((function(e){return e.trigger("columnShow",{column:t})})))}},{key:"toggle",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return this.hidden&&void 0===e||!0===e?this.show():!this.hidden&&void 0===e||!1===e?this.hide():void 0}},{key:"generateId",value:function(){return n.generatedIdIndex||(n.generatedIdIndex=0),(this.field?this.field.replace(/\./g,"-"):"col")+ ++n.generatedIdIndex}},{key:"measureSize",value:function(e){return Cr.measureSize(e,this.subGrid?this.subGrid.element:void 0)}},{key:"calculateMinWidth",value:function(){var e=this,t=e.measureSize(e.width),n=e.measureSize(e.minWidth),r=0;return e.children&&(r=e.children.reduce((function(e,t){return e+t.calculateMinWidth()}),0)),Math.max(t,n,r)}},{key:"resizeToFitContent",value:function(e,t){var n=this,r=n.grid,i=n.renderer,o=n.defaultRenderer,a=n.element,s=r.rowManager,u=r.store,c=u.count,l=i||o;if(!(c<=0)){var f,d,h,v,p,g=r.element.querySelector('.b-grid-cell[data-column-id="'.concat(n.id,'"]')),y=g.cssText,m=g.className,k=0;if(r.resizeToFitIncludesHeader){var b=window.getComputedStyle(a);k=Cr.measureText(a.innerText,a,!1,a.parentElement)+parseInt(b.paddingLeft),a.parentElement.offScreenDiv.parentElement.remove()}for(c>1e3?d=(f=Math.max(Math.min(s.topIndex+s.rowCount/2-500,c-1e3),0))+1e3:(f=0,d=c),h=f;h<d;h++)v=u.getAt(h),p=n.getRawValue(v),l&&(p=null==(p=l.call(n,{cellElement:g,rowElement:g.parentNode,value:p,record:v,column:n,size:{height:v.rowHeight||0},grid:r,row:{},updatingSingleRow:!1}))?g.innerHTML:String(p)),p&&(k=Math.max(k,Cr.measureText(p,g,!(n.htmlEncode&&!n.disableHtmlEncode),n.subGrid.element)));if(Array.isArray(e)){var w=e,C=ye()(w,2);e=C[0],t=C[1]}return k=Math.max(k,e||0),k=Math.min(k,t||1e6),g.className=m,g.cssText=y,n.width=k}}},{key:"getState",value:function(){var e,t=this,n=(e={},ke()(e,t.flex?"flex":"width",t.flex?t.flex:t.width),ke()(e,"id",t.id),ke()(e,"hidden",t.hidden),ke()(e,"index",t.allIndex),ke()(e,"region",t.region),ke()(e,"filterable",t.filterable),ke()(e,"text",t.text),ke()(e,"locked",t.locked),e);return t.children&&(n.children=t.children.map((function(e){return e.getState()}))),n}},{key:"applyState",value:function(e){var t=this;t.beginBatch(),"locked"in e&&(t.locked=e.locked),"minWidth"in e&&(t.minWidth=e.minWidth),"width"in e&&(t.width=e.width),"flex"in e&&(t.flex=e.flex),"width"in e&&t.flex?t.flex=void 0:"flex"in e&&t.width&&(t.width=void 0),"text"in e&&(t.text=e.text),"region"in e&&(t.region=e.region),"renderer"in e&&(t.renderer=e.renderer),"filterable"in e&&(t.filterable=e.filterable),t.endBatch(),"hidden"in e&&t.toggle(!0!==e.hidden)}},{key:"refreshCell",value:function(e){this.grid.rowManager.refreshCell(e,this.id)}},{key:"clearCell",value:function(e){e.innerHTML=""}},{key:"canEdit",value:function(e){return!0}},{key:"owner",get:function(){return this._owner||this.subGrid},set:function(e){this._owner=e}},{key:"nextVisibleSibling",get:function(){for(var e=this.region,t=this.nextSibling;t&&(t.hidden||t.region!==e);)t=t.nextSibling;return t}},{key:"isLastInSubGrid",get:function(){return!this.nextVisibleSibling&&(!this.parent||this.parent.isLastInSubGrid)}},{key:"element",get:function(){return this.grid.getHeaderElement(this)}},{key:"textWrapper",get:function(){return Cr.getChild(this.element,".b-grid-header-text")}},{key:"textElement",get:function(){return Cr.down(this.element,".b-grid-header-text-content")}},{key:"contentElement",get:function(){return Cr.down(this.element,".b-grid-header-children")}},{key:"editor",get:function(){var e=this.data.editor;if(e&&!(e instanceof oc)){var t=this.grid.processCellEditor({editor:e,field:this.field});t?e=this.data.editor=t.editor:("string"==typeof e&&(e={type:e}),e=this.data.editor=oc.create(Object.assign(this.defaultEditor,e,{owner:this.grid})))}return e},set:function(e){this.data.editor=e}},{key:"defaultEditor",get:function(){return{type:"textfield",name:this.field}}},{key:"isFocusable",get:function(){return this.isLeaf}},{key:"grid",get:function(){return this._grid||this.parent&&this.parent.grid}},{key:"locked",get:function(){return"locked"===this.data.region},set:function(e){this.region=e?"locked":"normal"}},{key:"sortable",get:function(){return this.isLeaf&&this.data.sortable},set:function(e){this.set("sortable",e)}},{key:"groupable",get:function(){return this.isLeaf&&this.data.groupable},set:function(e){this.set("groupable",e)}},{key:"allIndex",get:function(){return this.masterStore.indexOf(this)}},{key:"calcMinWidth",get:function(){var e=this.data,t=e.width,n=e.minWidth;return Sh(t)&&Sh(n)?Math.max(parseInt(t)||0,parseInt(n)||0):t}},{key:"width",get:function(){return this.data.width},set:function(e){var t={width:e};e&&"flex"in this.data&&(t.flex=null),this.set(t)}},{key:"flex",set:function(e){var t={flex:e};e&&"width"in this.data&&(t.width=null),this.set(t)},get:function(){return this.data.flex}},{key:"subGrid",set:function(e){this._subGrid=e},get:function(){return this._subGrid||(this.grid?this.grid.getSubGridFromColumn(this):void 0)}},{key:"subGridElement",get:function(){return this.subGrid.element}}],[{key:"fields",get:function(){return["text","field","renderer","width","flex","autoWidth",{name:"editor",defaultValue:{}},"finalizeCellEdit",{name:"revertOnEscape",defaultValue:!0},{name:"invalidAction",defaultValue:"block"},{name:"sortable",defaultValue:!0},{name:"searchable",defaultValue:!0},{name:"filterable",defaultValue:!0},{name:"hideable",defaultValue:!0},{name:"draggable",defaultValue:!0},{name:"groupable",defaultValue:!0},{name:"resizable",defaultValue:!0},"groupRenderer","headerRenderer","tooltipRenderer","cellCls","cls","icon","align",{name:"minWidth",defaultValue:60},{name:"hidden",defaultValue:!1},{name:"locked"},{name:"region"},{name:"showColumnPicker",defaultValue:!0},{name:"enableHeaderContextMenu",defaultValue:!0},{name:"enableCellContextMenu",defaultValue:!0},"headerMenuItems","cellMenuItems","sum","summaries","summaryRenderer","responsiveLevels","tags","touchConfig","tree","filterType",{name:"htmlEncode",defaultValue:!0},{name:"autoSyncHtml",defaultValue:!1},"type",{name:"instantUpdate",defaultValue:!1},{name:"repaintOnResize",defaultValue:!1},"editTargetSelector",{name:"exportable",defaultValue:!0},{name:"exportedType"}]}},{key:"autoExposeFields",get:function(){return!1}},{key:"type",get:function(){return"column"}},{key:"text",get:function(){return this.$meta.fields.defaults.text}}]),n}(Ge(lt(Bi)));function Rh(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return xh(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return xh(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function xh(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Eh(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Dh.emptyCount=0,Dh.defaultWidth=100,Dh.exposeProperties(),Dh._$name="Column";var Th=function(e){fe()(n,e);var t=Eh(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e){var t=this;e.grid&&(e.grid._columnStore=t,t.id="".concat(e.grid.id,"-columns"),e.grid.on({subGridCollapse:"clearSubGridCaches",subGridExpand:"clearSubGridCaches",thisObj:t})),we()(pe()(n.prototype),"construct",this).call(this,e),t.on({change:t.clearCaches,thisObj:t,prio:1})}},{key:"doDestroy",value:function(){var e=[];this.traverse((function(t){return e.push(t)})),we()(pe()(n.prototype),"doDestroy",this).call(this),e.forEach((function(e){return e.destroy()}))}},{key:"getById",value:function(e){return we()(pe()(n.prototype),"getById",this).call(this,e)||this.idRegister[e]}},{key:"forEach",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;this.traverseWhile((function(n,r){return e.call(t,n,r)}),!0)}},{key:"calculateFixedWidth",value:function(e){return e.flex?e.measureSize(Dh.defaultWidth):Math.max(e.measureSize(e.width),e.measureSize(e.minWidth))}},{key:"clearSubGridCaches",value:function(e){e.columns.clearCaches(),this.clearCaches()}},{key:"clearCaches",value:function(){this._visibleColumns=null}},{key:"onMasterDataChanged",value:function(e){we()(pe()(n.prototype),"onMasterDataChanged",this).call(this,e),this.clearCaches()}},{key:"getAdjacentVisibleLeafColumn",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.visibleColumns,i=e instanceof Dh?e:this.getById(e),o=r.indexOf(i)+(t?1:-1);if(!r[o]){if(!n)return null;o=t?0:r.length-1}return r[o]}},{key:"get",value:function(e){return this.findRecord("field",e,!0)}},{key:"createRecord",value:function(e){var t=this.grid,r=void 0===t?{}:t,i=r.store,o=this.modelClass;if(e.type&&!(o=n.getColumnClass(e.type)))throw new Error("Column type '".concat(e.type,"' not registered"));e.locked&&(e.region="locked",delete e.locked);var a=new o(e,this);if(a.data.region||(a.data.region=r.defaultRegion||"normal"),this.autoAddField&&!a.noFieldSpecified&&i&&!i.modelClass.getFieldDefinition(a.field)){var s=a.field;a.constructor.fieldType&&(s={name:a.field,type:a.constructor.fieldType}),i.modelClass.addField(s)}return a}},{key:"indexOf",value:function(e){var t=we()(pe()(n.prototype),"indexOf",this).call(this,e);return t>-1?t:this.records.findIndex((function(t){return t.field===e}))}},{key:"modelClass",get:function(){return this._modelClass},set:function(e){this._modelClass=e}},{key:"totalFixedWidth",get:function(){var e,t=this,n=0,r=Rh(this);try{for(r.s();!(e=r.n()).done;){var i=e.value;i.hidden||(i.children?i.children.forEach((function(e){return n+=t.calculateFixedWidth(e)})):n+=this.calculateFixedWidth(i))}}catch(e){r.e(e)}finally{r.f()}return n}},{key:"topColumns",get:function(){return this.isChained?this.masterStore.rootNode.children.filter(this.chainedFilterFn):this.rootNode.children}},{key:"visibleColumns",get:function(){return this._visibleColumns||(this._visibleColumns=this.leaves.filter((function(e){return!(e.hidden||e.subGrid&&e.subGrid.collapsed)}))),this._visibleColumns}},{key:"bottomColumns",get:function(){return this.leaves}}],[{key:"registerColumnType",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];n.columnTypes||(n.columnTypes={}),e.simpleRenderer=t,n.columnTypes[e.type]=e}},{key:"getColumnClass",value:function(e){return n.columnTypes&&n.columnTypes[e]}},{key:"defaultConfig",get:function(){return{modelClass:Dh,tree:!0,autoAddField:!1}}}]),n}(lt(No));function Mh(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Ah(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Th.registerColumnType(Dh,!0),Th._$name="ColumnStore";var Ph=function(e){fe()(n,e);var t=Ah(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e,t){this.internalCellCls="b-action-cell",we()(pe()(n.prototype),"construct",this).apply(this,arguments),e.width||e.flex||this.grid.on("paint",this.updateAutoWidth,this)}},{key:"renderer",value:function(e){var t=e.column,n=e.record,r=n&&"groupRowFor"in n.meta;return{className:{"b-action-ct":1},children:t.actions.map((function(e,i){if("visible"in e){if("function"==typeof e.visible&&!1===e.visible({record:n}))return"";if(!1===e.visible)return""}if(r&&!e.showForGroup||!r&&e.showForGroup)return"";var o;if(o="function"==typeof e.tooltip?e.tooltip({record:n}):e.tooltip||"",e.renderer&&"function"==typeof e.renderer){var a=e.renderer({index:i,record:n,column:t,tooltip:o,action:e});return"string"==typeof a?{tag:"span",dataset:{index:i},html:a}:(a.dataset=a.dataset||{},a.dataset.index=i,a)}return{tag:"i",dataset:{index:i,btip:o},className:ke()({"b-action-item":1},e.cls,1)}}))}}},{key:"onCellClick",value:function(e){var t=e.grid,n=e.column,r=e.record,i=e.target;if(i.classList.contains("b-action-item")&&!t.readOnly){var o=i.dataset.index;o||(o=i.parentElement.dataset&&i.parentElement.dataset.index);var a=n.actions[o],s=a&&a.onClick;s&&this.callback(s,n,[{record:r,action:a}])}}},{key:"updateAutoWidth",value:function(){var e=this,t=[],n=[];e.actions.forEach((function(e){var r=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Mh(Object(n),!0).forEach((function(t){ke()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Mh(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e);delete r.visible,r.showForGroup?(delete r.showForGroup,t.push(r)):n.push(r)})),t.length>n.length&&(n=t);var r=Cr.createElement(e.renderer({column:{actions:n}})).outerHTML;e.width=Cr.measureText(r,e.element,!0,e.element.parentElement)}}],[{key:"type",get:function(){return"action"}},{key:"fields",get:function(){return["actions"]}},{key:"defaults",get:function(){return{filterable:!1,groupable:!1,sortable:!1,editor:!1,searchable:!1,htmlEncode:!1,resizable:!1,minWidth:30}}}]),n}(Dh);function Ih(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Th.registerColumnType(Ph),Ph.exposeProperties(),Ph._$name="ActionColumn";var Oh=function(e){fe()(n,e);var t=Ih(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e,t){this.configuredAlign="align"in e,this.configuredEditor="editor"in e,we()(pe()(n.prototype),"construct",this).apply(this,arguments);var r=t.grid;r&&(this.owner=r,r.on({paint:"onGridPaint",thisObj:this,prio:1e3}))}},{key:"onGridPaint",value:function(e){var t=e.source;this.store=t.store}},{key:"canEdit",value:function(e){return e.isLeaf}},{key:"sum",value:function(){for(var e=0,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=0,o=n.length;i<o;i++)e+=parseInt(n[i]||0,10);return e}},{key:"avg",value:function(){for(var e=0,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];for(var i=n.length,o=0;o<i;o++)e+=parseInt(n[o]||0,10);return e/i}},{key:"onRecordUpdate",value:function(e){var t=e.record,n=e.changes,r=this,i=r.grid.rowManager;r.field in n&&t.isLeaf&&t.bubble((function(e){var t=i.getRowFor(e);if(t){var n=t.getCell(r.field);n&&t.renderCell(n,e)}}),!0)}},{key:"getRawValue",value:function(e){var t=0;if(e.children){for(var n=this.function,r="string"==typeof n&&"function"==typeof Math[n]?{handler:Math[n],thisObj:Math}:this.resolveCallback(n),i=r.handler,o=r.thisObj,a=0,s=e.children.length;a<s;a++)t=i.call(o,t,this.getRawValue(e.children[a]));e.setData(this.field,t)}else t=e[this.field];return t}},{key:"store",set:function(e){var t=this,n={update:"onRecordUpdate",thisObj:t,prio:1e3},r=t._store;if(e!==r){r&&r.un(n),t._store=e;var i=e.modelClass.fieldMap[t.field];i&&"number"===i.type&&(t.configuredAlign||(t.align="end"),t.configuredEditor||(t.editor="number")),e.on(n)}},get:function(){return this._store}}],[{key:"type",get:function(){return"aggregate"}},{key:"fields",get:function(){return["function"]}},{key:"defaults",get:function(){return{function:"sum"}}}]),n}(Dh);Th.registerColumnType(Oh,!0),Oh.exposeProperties(),Oh._$name="AggregateColumn";var Fh=n(17),Lh=n.n(Fh);function jh(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var _h=function(e){fe()(n,e);var t=jh(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e,t){this.widgetMap={},this.internalCellCls="b-widget-cell",we()(pe()(n.prototype),"construct",this).apply(this,arguments)}},{key:"doDestroy",value:function(){for(var e=0,t=Object.values(this.widgetMap);e<t.length;e++){var r=t[e];r.destroy&&r.destroy()}we()(pe()(n.prototype),"doDestroy",this).call(this)}},{key:"renderer",value:function(e){var t=this,n=e.cellElement,r=e.column,i=e.value,o=e.record,a=e.isExport,s=r.widgets;if(!a&&s&&(n.widgets||t.clearCell(n),n.widgets=s.map((function(a,s){var u,c;return n.widgets&&(c=(u=n.widgets[s]).element.nextElementSibling,a.recreate&&u&&(delete t.widgetMap[u.id],u.destroy(),n.widgets[s]=null)),u||(t.onBeforeWidgetCreate(a,e),u=lc.append(a,c?{insertBefore:c}:n)[0],t.widgetMap[u.id]=u,t.onAfterWidgetCreate(u,e)),u.cellInfo={cellElement:n,value:i,record:o,column:r},t.grid&&(u.readOnly=t.grid.readOnly),!1!==t.onBeforeWidgetSetValue(u,e)&&(a.noValueOnRender||(a.valueProperty?u[a.valueProperty]=i:u.defaultBindProperty?u[u.defaultBindProperty]=i:u.text=u.value=i)),t.onAfterWidgetSetValue(u,e),u}))),a)return null}},{key:"onBeforeWidgetCreate",value:function(e,t){}},{key:"onAfterWidgetCreate",value:function(e,t){}},{key:"onBeforeWidgetSetValue",value:function(e,t){}},{key:"onAfterWidgetSetValue",value:function(e,t){}},{key:"clearCell",value:function(e){var t=this;e.widgets&&(e.widgets.forEach((function(e){delete t.widgetMap[e.id],e.destroy()})),e.widgets=null),we()(pe()(n.prototype),"clearCell",this).call(this,e)}},{key:"resizeToFitContent",value:function(){}}],[{key:"type",get:function(){return"widget"}},{key:"fields",get:function(){return["widgets"]}},{key:"defaults",get:function(){return{filterable:!1,sortable:!1,editor:!1,searchable:!1}}}]),n}(Dh);function Bh(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Th.registerColumnType(_h),_h.exposeProperties(),_h._$name="WidgetColumn";var Hh=function(e){fe()(n,e);var t=Bh(n);function n(e,r){var i,o;v()(this,n),o=t.apply(this,arguments);var a=Lh()(o);return a.internalCellCls="b-check-cell",null===(i=a.grid)||void 0===i||i.on({destroy:function(){var e;return null===(e=a.headerCheckbox)||void 0===e?void 0:e.destroy()},thisObj:a}),o}return g()(n,null,[{key:"type",get:function(){return"check"}},{key:"fields",get:function(){return["checkCls","showCheckAll"]}},{key:"defaults",get:function(){return{align:"center",checkCls:null,showCheckAll:!1,widgets:[{type:"checkbox",valueProperty:"checked"}]}}}]),g()(n,[{key:"headerRenderer",value:function(e){var t=e.headerElement,n=e.column;if(t.classList.add("b-check-header"),!n.showCheckAll)return n.text;t.classList.add("b-check-header-with-checkbox"),n.headerCheckbox&&n.headerCheckbox.destroy(),n.headerCheckbox=new ad({appendTo:t,owner:this.grid,listeners:{change:function(e){var t=e.checked;n.trigger("toggleAll",{checked:t})}}})}},{key:"renderer",value:function(e){var t=e.value,r=e.isExport;if(r)return null==t?"":t;we()(pe()(n.prototype),"renderer",this).apply(this,arguments)}},{key:"onBeforeWidgetCreate",value:function(e,t){e.cls=this.checkCls}},{key:"onAfterWidgetCreate",value:function(e,t){t.cellElement.widget=e,e.on({beforeChange:"onBeforeCheckboxChange",change:"onCheckboxChange",thisObj:this})}},{key:"onBeforeWidgetSetValue",value:function(e){e.record=e.cellInfo.record,this.isInitialSet=!0}},{key:"onAfterWidgetSetValue",value:function(e){this.isInitialSet=!1}},{key:"onBeforeCheckboxChange",value:function(e){var t=e.source,n=e.checked;if(!this.isInitialSet)return this.trigger("beforeToggle",{record:t.cellInfo.record,checked:n})}},{key:"onCheckboxChange",value:function(e){var t=e.source,n=e.checked;if(!this.isInitialSet){var r=t.cellInfo.record,i=this.field;if(i){var o="set".concat(E.capitalize(i));r[o]?r[o](n):r.set(i,n)}this.trigger("toggle",{record:r,checked:n})}}},{key:"onCellKeyDown",value:function(e){var t=e.event,n=e.cellElement;if(" "===t.key){var r=n.widget;null==r||r.toggle(),t.preventDefault()}}}]),n}(_h);function $h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Th.registerColumnType(Hh,!0),Hh._$name="CheckColumn";var Nh=function(e){fe()(n,e);var t=$h(n);function n(e,r){var i;return v()(this,n),(i=t.apply(this,arguments)).internalCellCls="b-date-cell",i}return g()(n,null,[{key:"$name",get:function(){return"DateColumn"}},{key:"type",get:function(){return"date"}},{key:"fieldType",get:function(){return"date"}},{key:"fields",get:function(){return["format","pickerFormat","step"]}},{key:"defaults",get:function(){return{format:"L",step:1,minWidth:85,filterType:"date"}}}]),g()(n,[{key:"defaultRenderer",value:function(e){var t=e.value;return t?this.formatValue(t):""}},{key:"groupRenderer",value:function(e){var t=e.cellElement,n=e.groupRowFor;t.innerHTML=this.formatValue(n)}},{key:"formatValue",value:function(e){return"string"==typeof e&&(e=Zt.parse(e,this.format||void 0)),Zt.format(e,this.format||void 0)}},{key:"format",set:function(e){var t=this.editor;this.set("format",e),t&&(t.format=this.format)},get:function(){return this.get("format")}},{key:"defaultEditor",get:function(){return{name:this.field,type:"date",calendarContainerCls:"b-grid-cell-editor-related",weekStartDay:this.grid.weekStartDay,format:this.format,step:this.step}}}]),n}(Dh);function Vh(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Th.registerColumnType(Nh,!0),Nh.exposeProperties(),Nh._$name="DateColumn";var zh=function(e){fe()(n,e);var t=Vh(n);function n(e,r){var i;return v()(this,n),(i=t.apply(this,arguments)).internalCellCls="b-percent-bar-cell",i}return g()(n,null,[{key:"type",get:function(){return"percent"}},{key:"fieldType",get:function(){return"number"}},{key:"fields",get:function(){return["lowThreshold"]}},{key:"defaults",get:function(){return{editor:{type:"number",min:0,max:100},showValue:!0,lowThreshold:20,filterType:"number",htmlEncode:!1,searchable:!1,summaryRenderer:function(e){return"".concat(e,"%")}}}}]),g()(n,[{key:"defaultRenderer",value:function(e){var t=e.value;return{className:"b-percent-bar-outer",children:[{tag:"div",className:{"b-percent-bar":1,"b-zero":0===(t=t||0),"b-low":t<this.lowThreshold},style:{width:t+"%"},text:this.showValue?t+"%":void 0}]}}},{key:"resizeToFitContent",value:function(){}}]),n}(Dh);function Wh(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}zh.sum="average",Th.registerColumnType(zh,!0),zh._$name="PercentColumn";var Gh=function(e){fe()(n,e);var t=Wh(n);function n(e,r){var i;return v()(this,n),(i=t.apply(this,arguments)).internalCellCls="b-number-cell",i}return g()(n,null,[{key:"type",get:function(){return"number"}},{key:"fieldType",get:function(){return"number"}},{key:"fields",get:function(){return["format","min","max","step","largeStep","unit"]}},{key:"defaults",get:function(){return{filterType:"number",format:""}}}]),g()(n,[{key:"defaultRenderer",value:function(e){var t=e.value;return null!=t&&(t=this.formatter.format(t),this.unit&&(t="".concat(t).concat(this.unit))),t}},{key:"defaultEditor",get:function(){var e=this.format,t=this.name,n=this.max,r=this.min,i=this.step,o=this.largeStep,a=this.align;return an.cleanupProperties({type:"numberfield",format:e,name:t,max:n,min:r,step:i,largeStep:o,textAlign:a})}},{key:"formatter",get:function(){var e=this,t=e.format,n=e._formatter;return n&&e._lastFormat===t||(e._formatter=n=Tc.get(e._lastFormat=t)),n}}]),n}(Dh);function Yh(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Th.registerColumnType(Gh,!0),Gh.exposeProperties(),Gh._$name="NumberColumn";var Uh=function(e){fe()(n,e);var t=Yh(n);function n(e,r){var i;return v()(this,n),(i=t.apply(this,arguments)).internalCellCls="b-rating-cell",i}return g()(n,null,[{key:"type",get:function(){return"rating"}},{key:"fieldType",get:function(){return"number"}},{key:"fields",get:function(){return["emptyIcon","filledIcon","editable"]}},{key:"defaults",get:function(){return{min:0,max:5,emptyIcon:"b-icon b-icon-star",filledIcon:"b-icon b-icon-star",editable:!0,filterType:"number",searchable:!1,width:"11.2em",htmlEncode:!1,minWidth:"11.2em",editor:!1}}}]),g()(n,[{key:"renderer",value:function(e){var t=this,n=e.value;return{className:{"b-rating-cell-inner":1,"b-not-editable":!this.editable},children:De.populate(this.max,(function(e){var r=e<n;return{tag:"i",className:ke()({"b-rating-icon":!0,"b-filled":r,"b-empty":!r},r?t.filledIcon:t.emptyIcon,!0)}}))}}},{key:"onCellClick",value:function(e){var t=e.grid,n=e.column,r=e.record,i=e.target,o=e.event;if(i.classList.contains("b-rating-icon")&&!t.readOnly&&n.editable){var a=[].indexOf.call(i.parentNode.childNodes,i);i.classList.contains("b-filled")&&(o.metaKey||o.shiftKey)&&(a-=1),1===r.get(n.field)&&0===a&&(a=-1),r.set(n.field,a+1)}}}]),n}(Gh);function qh(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Th.registerColumnType(Uh,!0),Uh.exposeProperties(),Uh._$name="RatingColumn";var Kh=function(e){fe()(n,e);var t=qh(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e,t){var r=this;we()(pe()(n.prototype),"construct",this).apply(this,arguments);var i,o=r.grid;o&&(o.store.on((i={},ke()(i,"change".concat(o.asyncEventSuffix),"onStoreChange"),ke()(i,"thisObj",r),i)),o.store.count&&o.on({render:"resizeToFitContent",thisObj:r,once:!0}));r.internalCellCls="b-row-number-cell"}},{key:"onStoreChange",value:function(e){var t=e.action;"dataset"!==t&&"add"!==t&&"remove"!==t&&"removeall"!==t||this.resizeToFitContent()}},{key:"renderer",value:function(e){var t=e.record,n=e.grid;return t.isSpecialRow?"":n.store.indexOf(t,!0)+1}},{key:"resizeToFitContent",value:function(){var e=this.grid,t=e.store.count;if(t&&!this.hidden){var n=e.element.querySelector('.b-grid-cell[data-column-id="'.concat(this.id,'"]'));if(n){var r=parseInt(Cr.getStyleValue(n,"padding-left")),i=Cr.measureText(t,n);this.width=i+2*r}}}},{key:"flex",set:function(e){}}],[{key:"defaults",get:function(){return{groupable:!1,sortable:!1,filterable:!1,searchable:!1,resizable:!1,minWidth:50,width:50,align:"right",text:"#",editor:!1}}},{key:"type",get:function(){return"rownumber"}}]),n}(Dh);function Xh(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Th.registerColumnType(Kh,!0),Kh._$name="RowNumberColumn";var Zh=function(e){fe()(n,e);var t=Xh(n);function n(e,r){var i;v()(this,n),i=t.apply(this,arguments);var o=Lh()(i);if(!o.template)throw new Error("TemplateColumn needs a template");if("function"!=typeof o.template)throw new Error("TemplateColumn.template must be a function");return i}return g()(n,null,[{key:"fields",get:function(){return["template"]}},{key:"defaults",get:function(){return{htmlEncode:!1}}}]),g()(n,[{key:"renderer",value:function(e){if(!e.record.isSpecialRow)return this.template({value:e.value,record:e.record,field:e.column.field})}}],[{key:"type",get:function(){return"template"}}]),n}(Dh);function Jh(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Th.registerColumnType(Zh,!0),Zh.exposeProperties(),Zh._$name="TemplateColumn";var Qh=function(e){fe()(n,e);var t=Jh(n);function n(e,r){var i;return v()(this,n),(i=t.apply(this,arguments)).internalCellCls="b-time-cell",i}return g()(n,null,[{key:"type",get:function(){return"time"}},{key:"fieldType",get:function(){return"date"}},{key:"fields",get:function(){return["format"]}},{key:"defaults",get:function(){return{format:"LT",minWidth:140,filterType:"time"}}}]),g()(n,[{key:"defaultRenderer",value:function(e){var t=e.value;return t?this.formatValue(t):""}},{key:"groupRenderer",value:function(e){var t=e.cellElement,n=e.groupRowFor;t.innerHTML=this.formatValue(n)}},{key:"formatValue",value:function(e){return"string"==typeof e&&(e=Zt.parse(e,this.format)),Zt.format(e,this.format)}},{key:"format",set:function(e){var t=this.editor;this.set("format",e),t&&(t.format=this.format)},get:function(){return this.get("format")}},{key:"defaultEditor",get:function(){return{name:this.field,type:"time",format:this.format}}}]),n}(Dh);function ev(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Th.registerColumnType(Qh,!0),Qh.exposeProperties(),Qh._$name="TimeColumn";var tv=!1,nv=function(e){fe()(n,e);var t=ev(n);function n(e,r){var i;v()(this,n),i=t.apply(this,arguments);var o=Lh()(i);return o.internalCellCls="b-tree-cell",o.shouldHtmlEncode=o.htmlEncode,o.tempDiv=document.createElement("div"),o.setData("htmlEncode",!1),o.renderer&&(o.originalRenderer=o.renderer),o.renderer=o.treeRenderer.bind(o),i}return g()(n,null,[{key:"defaults",get:function(){return{tree:!0,hideable:!1,minWidth:150}}},{key:"fields",get:function(){return[{name:"expandIconCls",defaultValue:"b-icon b-icon-tree-expand"},{name:"collapseIconCls",defaultValue:"b-icon b-icon-tree-collapse"},{name:"collapsedFolderIconCls"},{name:"expandedFolderIconCls"},{name:"indentSize",defaultValue:1.7},{name:"leafIconCls",defaultValue:"b-icon b-icon-tree-leaf"},{name:"editTargetSelector",defaultValue:".b-tree-cell-value"}]}},{key:"type",get:function(){return"tree"}}]),g()(n,[{key:"treeRenderer",value:function(e){var t,n=this,r=e.cellElement,i=e.row,o=e.record,a=e.isExport,s=o.instanceMeta(e.grid.store),u=o.href?"a":"div",c=e.value;if(n.originalRenderer){var l=n.originalRenderer(e);c=!1===l?r.innerHTML:l}if(a)t=null!=c?c:"";else{var f,d="";if(o.isLeaf)r.classList.add("b-tree-leaf-cell"),f=e.iconCls||o.iconCls||n.leafIconCls;else{var h=s.collapsed,v=h?n.expandIconCls:n.collapseIconCls,p=h?n.collapsedFolderIconCls:n.expandedFolderIconCls;if("Row"===i.$$name){var g=["b-tree-parent-row"],y=[];s.isLoadingChildren?g.push("b-loading-children"):y.push("b-loading-children"),h?(g.push("b-tree-collapsed"),y.push("b-tree-expanded")):(g.push("b-tree-expanded"),y.push("b-tree-collapsed")),i.removeCls.apply(i,y),i.addCls.apply(i,g)}r.classList.add("b-tree-parent-cell"),d+='<div class="b-tree-expander">'.concat(v?'<i class="'.concat(v,'"></i>'):"","</div>"),tv=f=e.iconCls||o.iconCls||p}c=null!=c?c:"",n.shouldHtmlEncode&&(n.tempDiv.innerText=c,c=n.tempDiv.innerHTML),d+='<div class="b-tree-cell-value">'.concat(f?'<i class="b-tree-icon '.concat(f,'"></i>'):"").concat(c,"</div>");var m=o.childLevel*n.indentSize+(o.isLeaf?tv?2:f?.5:.4:0);t="<".concat(u," ").concat(o.href?'href="'.concat(o.href,'"'):""," ").concat("a"===u&&o.target?'target="'.concat(o.target,'"'):"",' class="b-tree-cell-inner" style="padding-left:').concat(m,'em;">').concat(d,"</").concat(u,">")}return t}}]),n}(Dh);function rv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Th.registerColumnType(nv,!0),nv.exposeProperties(),nv._$name="TreeColumn";var iv=function(e){fe()(n,e);var t=rv(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"fields",get:function(){return["iconCls","expanded","cls","rowHeight","href","target"]}}]),n}(Bi);function ov(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}iv.exposeProperties(),iv._$name="GridRowModel";var av=function(e){fe()(n,e);var t=ov(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(){if(we()(pe()(n.prototype),"construct",this).apply(this,arguments),!this.type||!this.type.length)throw new Error("Config 'type' is required to be specified for context menu")}},{key:"doDestroy",value:function(){var e;null===(e=this.menu)||void 0===e||e.destroy(),we()(pe()(n.prototype),"doDestroy",this).call(this)}},{key:"onElementContextMenu",value:function(e){"contextmenu"===this.triggerEvent&&this.internalShowContextMenu(e)}},{key:"onElementClick",value:function(e){"click"===this.triggerEvent&&this.internalShowContextMenu(e)}},{key:"onElementDblClick",value:function(e){"dblclick"===this.triggerEvent&&this.internalShowContextMenu(e)}},{key:"onElementKeyDown",value:function(e){}},{key:"internalShowContextMenu",value:function(e){if(!this.disabled){var t=this.getDataFromEvent(e);this.shouldShowMenu(t)&&this.showContextMenu(t)}}},{key:"getDataFromEvent",value:function(e){return{event:e,targetElement:this.getTargetElementFromEvent(e)}}},{key:"getTargetElementFromEvent",value:function(e){return e.target}},{key:"showContextMenu",value:function(e){var t=this;if(!t.disabled){var n=t.type,r=t.client,i=t.processItems,o=t.items,a=e.event,s=e.targetElement,u=a?[a.clientX+1,a.clientY+1]:En.from(s).center;for(var c in an.assign(e,{items:{},selection:r.selectedRecords}),t.callChainablePopulateMenuMethod(e),o)!0===o[c]&&Reflect.deleteProperty(o,c);an.merge(e.items,o),i&&!1===i(e)||!t.hasActiveMenuItems(e)||(t.populateItemsWithData(e),t.preventDefaultEvent(e),!1!==t.beforeContextMenuShow(e)&&!1!==r.trigger("".concat(n,"MenuBeforeShow"),e)&&!1!==r.trigger("".concat(n,"ContextMenuBeforeShow"),e)&&(t.menu=lc.showContextMenu(u,an.merge({items:e.items,owner:r,scrollAction:"hide",constrainTo:window,onBeforeItem:function(t){Object.assign(t,e)},onItem:function(e){r.trigger("".concat(n,"MenuItem"),e),r.trigger("contextMenuItem",e),r.trigger("".concat(n,"ContextMenuItem"),e)},onToggle:function(e){r.trigger("".concat(n,"MenuToggleItem"),e),r.trigger("contextMenuToggleItem",e)},onDestroy:function(){t.menu=null},onShow:function(t){var i=t.source;e.menu=i,r.trigger("".concat(n,"MenuShow"),e),r.trigger("".concat(n,"ContextMenuShow"),e)}},t.menuConfig))))}}},{key:"hideContextMenu",value:function(e){var t;null===(t=this.menu)||void 0===t||t.hide(e)}},{key:"callChainablePopulateMenuMethod",value:function(e){var t="populate".concat(E.capitalize(this.type),"Menu");this.client[t]&&this.client[t](e)}},{key:"createContextMenuEventForElement",value:function(e){var t=En.from(e).center,n=new MouseEvent(this.triggerEvent,{clientX:t.x,clientY:t.y});return Object.defineProperty(n,"target",{get:function(){return e}}),n}},{key:"hasActiveMenuItems",value:function(e){return Object.values(e.items).some((function(e){return e}))}},{key:"shouldShowMenu",value:function(){return!0}},{key:"beforeContextMenuShow",value:function(e){}},{key:"populateItemsWithData",value:function(e){}},{key:"preventDefaultEvent",value:function(e){var t;null===(t=e.event)||void 0===t||t.preventDefault()}},{key:"triggerEvent",set:function(e){this._triggerEvent=e},get:function(){return this._triggerEvent||this.client.contextMenuTriggerEvent}},{key:"type",set:function(e){this._type=e},get:function(){return this._type}},{key:"menuConfig",set:function(e){this._menuConfig=e},get:function(){return this._menuConfig}}],[{key:"$name",get:function(){return"ContextMenuBase"}},{key:"defaultConfig",get:function(){return{type:null,menuConfig:null,items:null,processItems:null,triggerEvent:null}}},{key:"pluginConfig",get:function(){return{assign:["showContextMenu"],chain:["onElementContextMenu","onElementClick","onElementDblClick","onElementKeyDown"]}}}]),n}(qr);av._$name="ContextMenuBase";var sv=new Map,uv=new Map,cv={Grid:"GridBase",Scheduler:"SchedulerBase",Gantt:"GanttBase"},lv=/\$\d+$/,fv=function(){function e(){v()(this,e)}return g()(e,null,[{key:"registerFeature",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;r=(r=E.uncapitalize(r||Object.prototype.hasOwnProperty.call(e,"$name")&&e.$$name||e.name)).replace(lv,""),Array.isArray(n)||(n=[n||"Grid"]),n.forEach((function(n){var i=cv[n]||n,o=sv.get(i)||new Map,a=uv.get(i)||new Map;o.set(r,e),a.set(e,t),sv.set(i,o),uv.set(i,a)}))}},{key:"getTypeNameFeatures",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Grid",t=cv[e]||e,n=sv.get(t),r={};return n&&n.forEach((function(e,t){return r[t]=e})),r}},{key:"getTypeNameDefaultFeatures",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"Grid",t=cv[e]||e,n=sv.get(t),r=uv.get(t),i={};return n&&r&&n.forEach((function(e,t){r.get(e)&&(i[t]=e)})),i}},{key:"getInstanceFeatures",value:function(e){var t=this;return e.$meta.names.reduce((function(e,n){return Object.assign(e,t.getTypeNameFeatures(n))}),{})}},{key:"getInstanceDefaultFeatures",value:function(e){var t=this;return e.$meta.names.reduce((function(e,n){return Object.entries(t.getTypeNameFeatures(n)).reduce((function(e,r){var i=ye()(r,2),o=i[0],a=i[1];return t.isDefaultFeatureForTypeName(a,n)?e[o]=a:delete e[o],e}),e)}),{})}},{key:"isDefaultFeatureForTypeName",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"Grid",n=cv[t]||t,r=uv.get(n);return r&&r.get(e)||!1}},{key:"isDefaultFeatureForInstance",value:function(e,t){for(var n=t.$meta.names.slice().reverse(),r=null,i=0,o=n.length;i<o&&null===r;++i){var a=uv.get(n[i]);a&&a.has(e)&&(r=a.get(e))}return r||!1}},{key:"reset",value:function(){sv.clear(),uv.clear()}}]),e}();function dv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}fv._$name="GridFeatureManager";var hv=function(e){fe()(n,e);var t=dv(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"showContextMenu",value:function(e){var t=e.cellSelector,r=e.id,i=e.event;this.client.focusCell(t,{doSelect:!this.client.isSelected(r),event:i}),we()(pe()(n.prototype),"showContextMenu",this).call(this,e)}},{key:"shouldShowMenu",value:function(e){var t=e.column;return t&&!1!==t.enableCellContextMenu}},{key:"getDataFromEvent",value:function(e){return an.assign(we()(pe()(n.prototype),"getDataFromEvent",this).call(this,e),this.client.getCellDataFromEvent(e))}},{key:"beforeContextMenuShow",value:function(e){e.record&&!e.record.isSpecialRow||(e.items.removeRow=!1)}},{key:"populateCellMenu",value:function(e){var t=e.items,n=e.column,r=this.client;(null==n?void 0:n.cellMenuItems)&&(Array.isArray(n.cellMenuItems)&&y.a.deprecate("Grid","5.0.0","`cellMenuItems` column config specified as an array is deprecated, need to specify the config as a named object. Please see https://bryntum.com/docs/grid/#guides/upgrades/4.0.0.md for more information."),an.merge(t,n.cellMenuItems)),r.readOnly||(t.removeRow={text:r.selectedRecords.length>1?"L{removeRows}":"L{removeRow}",localeClass:this,icon:"b-fw-icon b-icon-trash",name:"removeRow",cls:"b-separator",weight:100,onItem:function(){return r.store.remove(r.selectedRecords)}},r.showRemoveRowInContextMenu||(y.a.deprecate("Grid","5.0.0","`showRemoveRowInContextMenu` config is deprecated, in favor of `CellMenu` feature configuration. Please see https://bryntum.com/docs/grid/#guides/upgrades/4.0.0.md for more information."),t.removeRow=!1))}},{key:"showMenu",get:function(){return!0}}],[{key:"$name",get:function(){return"CellMenu"}},{key:"defaultConfig",get:function(){return{type:"cell"}}},{key:"pluginConfig",get:function(){var e=we()(pe()(n),"pluginConfig",this);return e.chain.push("populateCellMenu"),e}}]),n}(av);function vv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}hv.featureClass="",hv._$name="CellMenu",fv.registerFeature(hv,!0,["Grid","Scheduler"]),fv.registerFeature(hv,!1,["Gantt"]);var pv=function(e){fe()(n,e);var t=vv(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e,t){we()(pe()(n.prototype),"construct",this).call(this,e,this.processConfig(t))}},{key:"initTip",value:function(){var e=this;e.tip=new Kl(Object.assign({forElement:e.client.element,forSelector:".b-grid-cell",hoverDelay:1e3,trackMouse:!1,cls:"b-celltooltip-tip",getHtml:e.getTooltipContent.bind(e),listeners:{pointerOver:"onPointerOver",thisObj:e}},e.initialConfig)),e.relayEvents(e.tip,["beforeshow","show"])}},{key:"onPointerOver",value:function(e){var t=e.target;return!1!==this.client.getColumnFromElement(t).tooltipRenderer}},{key:"processConfig",value:function(e){return"function"==typeof e?{tooltipRenderer:e}:e}},{key:"setConfig",value:function(e){we()(pe()(n.prototype),"setConfig",this).call(this,this.processConfig(e))}},{key:"doDestroy",value:function(){this.tip&&this.tip.destroy(),we()(pe()(n.prototype),"doDestroy",this).call(this)}},{key:"doDisable",value:function(e){e?this.tip&&(this.tip.destroy(),this.tip=null):this.initTip(),we()(pe()(n.prototype),"doDisable",this).call(this,e)}},{key:"getTooltipContent",value:function(e){var t,n=e.tip,r=e.activeTarget,i=e.event,o=this,a=o.client.getRecordFromElement(r),s=o.client.getColumnFromElement(r);return o.forSelector||a!==o.lastRecord||s!==o.lastColumn?(o.lastRecord=a,o.lastColumn=s,s.tooltipRenderer?!1===(t=s.tooltipRenderer({cellElement:r,record:a,column:s,event:i,tip:n,cellTooltip:o}))&&y.a.deprecate("Grid","5.0.0","Returning false to indicate loading is deprecated. Please see https://bryntum.com/docs/grid/#guides/upgrades/3.0.1.md for more information"):o.tooltipRenderer&&!1!==s.tooltipRenderer&&!1===(t=o.tooltipRenderer({cellElement:r,record:a,column:s,event:i,tip:n,cellTooltip:o}))&&y.a.deprecate("Grid","5.0.0","Returning false to indicate loading is deprecated. Please see https://bryntum.com/docs/grid/#guides/upgrades/3.0.1.md for more information"),t):o.tip._html}}],[{key:"$name",get:function(){return"CellTooltip"}},{key:"defaultConfig",get:function(){return{tooltipRenderer:null}}}]),n}(qr);function gv(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return yv(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return yv(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function yv(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function mv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}pv._$name="CellTooltip",fv.registerFeature(pv);var kv=function(e){fe()(n,e);var t=mv(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e){var t;we()(pe()(n.prototype),"construct",this).call(this,e);var r=null===(t=this.client)||void 0===t?void 0:t.store;r&&this.bindStore(r)}},{key:"doDestroy",value:function(){this.unbindStore(),we()(pe()(n.prototype),"doDestroy",this).call(this)}},{key:"bindStore",value:function(e){this.lastSync=null,e.on(ke()({name:"store"},"change".concat(this.client.asyncEventSuffix),"onStoreChange"),this)}},{key:"unbindStore",value:function(){this.detachListeners("store")}},{key:"onStoreChange",value:function(e){"move"!==e.action&&(++this.storeGeneration,this.hasTimeout("syncAutoWidthColumns")||this.setTimeout("syncAutoWidthColumns",this.delay))}},{key:"syncAutoWidthColumns",value:function(){var e=this,t=e.client,n=e.storeGeneration;if(e.lastSync!==n){var r,i;e.lastSync=n;var o,a=gv(t.columns.visibleColumns);try{for(a.s();!(o=a.n()).done;){var s=o.value;(r=s.autoWidth)&&(!0===r&&(r=e.default),t.resizingColumns=i=!0,s.resizeToFitContent(r))}}catch(e){a.e(e)}finally{a.f()}i&&(t.resizingColumns=!1,t.afterColumnsResized())}e.hasTimeout("syncAutoWidthColumns")&&e.clearTimeout("syncAutoWidthColumns")}},{key:"columnAutoWidthPending",get:function(){return null===this.lastSync||this.hasTimeout("syncAutoWidthColumns")}}],[{key:"$name",get:function(){return"ColumnAutoWidth"}},{key:"defaultConfig",get:function(){return{default:null,delay:0}}},{key:"pluginConfig",get:function(){return{after:{bindStore:"bindStore",unbindStore:"unbindStore",renderRows:"syncAutoWidthColumns"},assign:["columnAutoWidthPending","syncAutoWidthColumns"]}}}]),n}(_a(qr));function bv(){var e=El()(['\n                        <div class="b-target-button" data-name="','" data-disabled="','">\n                            <i class="','"></i>\n                            ',"\n                        </div>\n                    "]);return bv=function(){return e},e}function wv(){var e=El()(['\n                <div class="b-group">\n                    <div class="b-buttons">\n                    ','\n                    </div>\n                    <div class="b-title">',"</div>\n                </div>\n            "]);return wv=function(){return e},e}function Cv(){var e=El()(['\n            <div class="b-columndragtoolbar">     \n            <div class="b-title"></div>          \n            ',"\n            </div>"]);return Cv=function(){return e},e}function Sv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}kv.prototype.storeGeneration=0,kv._$name="ColumnAutoWidth",fv.registerFeature(kv,!0);var Dv=function(e){fe()(n,e);var t=Sv(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e,t){e.features.columnReorder&&e.features.columnReorder.on("beforedestroy",this.onColumnReorderBeforeDestroy,this),this.grid=e,we()(pe()(n.prototype),"construct",this).call(this,e,t)}},{key:"doDestroy",value:function(){var e=this;e.grid.features.columnReorder&&!e.grid.features.columnReorder.isDestroyed&&e.detachFromColumnReorder(),e.element&&e.element.remove(),e.element=null,we()(pe()(n.prototype),"doDestroy",this).call(this)}},{key:"doDisable",value:function(e){this.initialized&&(e?this.detachFromColumnReorder():this.init()),we()(pe()(n.prototype),"doDisable",this).call(this,e)}},{key:"init",value:function(){var e=this,t=e.grid;t.features.columnReorder&&(e.reorderDetacher=t.features.columnReorder.on({gridheaderdragstart:function(n){var r=n.context,i=t.columns.getById(r.element.dataset.columnId);e.showToolbar(i)},gridheaderdrag:function(t){var n=t.context;return e.onDrag(n)},gridheaderabort:function(){e.hideToolbar()},gridheaderdrop:function(t){var n=t.context;n.valid?e.hideToolbar():e.onDrop(n)},thisObj:e}),e.initialized=!0)}},{key:"onColumnReorderBeforeDestroy",value:function(){this.detachFromColumnReorder()}},{key:"detachFromColumnReorder",value:function(){var e=this;e.grid.features.columnReorder.un("beforedestroy",e.onColumnReorderBeforeDestroy,e),e.reorderDetacher&&e.reorderDetacher(),e.reorderDetacher=null}},{key:"render",value:function(){this.initialized||this.init()}},{key:"showToolbar",value:function(e){var t=this,n=t.grid.getColumnDragToolbarItems(e,[]),r=[];t.clearTimeout(t.buttonHideTimer),t.clearTimeout(t.toolbarHideTimer),n.forEach((function(e){e.text=e.localeClass.L(e.text);var t=r.find((function(t){return t.text===e.group}));t||(t={text:e.localeClass.L(e.group),buttons:[]},r.push(t)),t.buttons.push(e)})),t.element=Cr.append(t.grid.element,t.template(r)),t.groups=r,t.buttons=n,t.column=e}},{key:"hideToolbar",value:function(){var e=this;return new Promise((function(t){e.element&&!e.toolbarHideTimer&&(e.element.classList.add("b-remove"),e.toolbarHideTimer=e.setTimeout((function(){e.toolbarHideTimer=null,e.element&&e.element.remove(),e.element=null,t()}),200))}))}},{key:"onDrag",value:function(e){var t=this;if(e.dragProxy.getBoundingClientRect().top-t.grid.element.getBoundingClientRect().top>100?t.element.classList.add("b-closer"):t.element.classList.remove("b-closer"),t.hoveringButton&&(t.hoveringButton.classList.remove("b-hover"),t.hoveringButton=null),e.targetElement&&e.targetElement.closest(".b-columndragtoolbar")){t.element.classList.add("b-hover");var n=e.targetElement.closest(".b-columndragtoolbar  .b-target-button:not([data-disabled=true])");n&&(n.classList.add("b-hover"),t.hoveringButton=n)}else t.element.classList.remove("b-hover")}},{key:"onDrop",value:function(e){var t=this;if(e.targetElement&&e.targetElement.matches(".b-columndragtoolbar .b-target-button:not([data-disabled=true])")){var n=e.targetElement,r=t.buttons.find((function(e){return e.name===n.dataset.name}));r&&(n.classList.add("b-activate"),t.buttonHideTimer=t.setTimeout((function(){t.hideToolbar(),r.onDrop({column:t.column})}),100))}else t.hideToolbar()}},{key:"template",value:function(e){return Iu.tpl(Cv(),e.map((function(e){return Iu.tpl(wv(),e.buttons.map((function(e){return Iu.tpl(bv(),e.name,e.disabled,e.icon,e.text)})),e.text)})))}}],[{key:"$name",get:function(){return"ColumnDragToolbar"}},{key:"pluginConfig",get:function(){return{after:["render"]}}}]),n}(_a(qr));function Rv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Dv.featureClass="b-hascolumndragtoolbar",Dv._$name="ColumnDragToolbar",fv.registerFeature(Dv,j.a.isTouchDevice);var xv=function(e){fe()(n,e);var t=Rv(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e,t){this.grid=e,we()(pe()(n.prototype),"construct",this).call(this,e,t)}},{key:"getColumnPickerItems",value:function(e){var t=this;if(t.groupByRegion)return t.grid.regions.map((function(e){var n=t.grid.getSubGrid(e).columns.topColumns;return{text:E.capitalize(e),menu:t.buildColumnMenu(n),disabled:0===n.length,region:e}}));if(t.groupByTag){var n={};return e.topColumns.forEach((function(e){e.tags&&e.hideable&&e.tags.forEach((function(e){n[e]||(n[e]=1)}))})),Object.keys(n).sort().map((function(e){return{text:E.capitalize(e),menu:t.buildColumnMenu(t.getColumnsForTag(e)),tag:e,onBeforeSubMenu:function(e){var n=e.item,r=e.itemEl;t.refreshTagMenu(n,r)}}}))}return t.buildColumnMenu(e.topColumns)}},{key:"getColumnsForTag",value:function(e){return this.grid.columns.records.filter((function(t){return t.tags&&t.tags.includes(e)&&!1!==t.hideable}))}},{key:"refreshTagMenu",value:function(e,t){this.getColumnsForTag(e.tag).forEach((function(t){var n=e.items.find((function(e){return e.column===t}));n&&(n.checked=!0!==t.hidden)}))}},{key:"buildColumnMenu",value:function(e){var t=this,n=e.length>0&&e[0].region,r=this.grid;return e.reduce((function(e,i){var o=t.grid.columns.visibleColumns.filter((function(e){return e.region===i.region}));if(!1!==i.hideable){var a={grid:r,text:i.text,column:i,name:i.id,checked:!0!==i.hidden,disabled:!0!==i.hidden&&1===o.length,cls:i.region!==n?"b-separator":""};n=i.region,i.children&&(a.menu=t.buildColumnMenu(i.children)),e.push(a)}return e}),[])}},{key:"populateHeaderMenu",value:function(e){var t=e.column,n=e.items,r=this,i=r.grid.columns;if(!1!==t.showColumnPicker&&i.some((function(e){return e.hideable}))&&(n.columnPicker={text:"L{columnsMenu}",localeClass:r,name:"columnPicker",icon:"b-fw-icon b-icon-columns",cls:"b-separator",weight:200,menu:r.getColumnPickerItems(i),onToggle:r.onColumnToggle,disabled:r.disabled}),!1!==t.hideable){var o=i.visibleColumns.filter((function(e){return e.region===t.region}));n.hideColumn={text:"L{hideColumn}",localeClass:r,icon:"b-fw-icon b-icon-hide-column",weight:210,name:"hideColumn",disabled:1===o.length||r.disabled,onItem:function(){return t.hide()}}}}},{key:"onColumnToggle",value:function(e){var t=e.menu,n=e.item,r=e.checked;if(!!n.column.hidden!=!r){n.column[r?"show":"hide"]();var i=n.grid,o=n.column,a=i.columns,s=i.features,u=t.items,c=a.visibleColumns.filter((function(e){return e.region===n.column.region})),l=s.contextMenu,f=s.headerMenu,d=l&&!l.disabled,h=d?l:f,v=h&&h[d?"currentMenu":"menu"],p=d?v.items.find((function(e){return"hideColumn"===e.name})):v.widgetMap.hideColumn;if(1===c.length){var g=u.find((function(e){return e.name===c[0].id}));g&&(g.disabled=!0),p&&o.region===n.column.region&&(p.disabled=!0)}else c.forEach((function(e){var t=u.find((function(t){return t.column===e}));t&&(t.disabled=!1)})),p&&o.region===n.column.region&&(p.disabled=!1);n.menu&&n.menu.eachWidget((function(e){e.checked=r}));var y=t.owner;y&&y.column===o.parent&&(y.checked=u.some((function(e){return!0===e.checked})))}}},{key:"getColumnDragToolbarItems",value:function(e,t){var n=this.grid.columns.visibleColumns.filter((function(t){return t.region===e.region}));return!1!==e.hideable&&n.length>1&&t.push({text:"L{hideColumnShort}",group:"L{column}",localeClass:this,icon:"b-fw-icon b-icon-hide-column",weight:101,name:"hideColumn",onDrop:function(e){return e.column.hide()}}),t}}],[{key:"$name",get:function(){return"ColumnPicker"}},{key:"defaultConfig",get:function(){return{groupByRegion:!1,groupByTag:!1}}},{key:"pluginConfig",get:function(){return{chain:["populateHeaderMenu","getColumnDragToolbarItems"]}}}]),n}(qr);function Ev(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}xv._$name="ColumnPicker",fv.registerFeature(xv,!0);var Tv=function(e){fe()(n,e);var t=Ev(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e,t){this.ignoreSelectors=[".b-grid-header-resize-handle",".b-field"],this.grid=e,we()(pe()(n.prototype),"construct",this).call(this,e,t)}},{key:"doDestroy",value:function(){this.dragHelper&&this.dragHelper.destroy(),we()(pe()(n.prototype),"doDestroy",this).call(this)}},{key:"init",value:function(){var e=this,t=e.grid,n=t.element,r=Cr.children(n,".b-grid-headers");r.push.apply(r,d()(Cr.children(n,".b-grid-header-children"))),e.dragHelper?e.dragHelper.containers=r:(e.dragHelper=new hu({name:"columnReorder",mode:"container",dragThreshold:10,targetSelector:".b-grid-header",outerElement:n.querySelector("header.b-grid-header-container"),containers:r,isElementDraggable:function(n){if(Boolean(Cr.up(n,e.ignoreSelectors.join(",")))||e.disabled)return!1;var r=Cr.up(n,this.targetSelector),i=r&&t.columns.getById(r.dataset.columnId),o=i&&0===i.childLevel&&1===t.subGrids[i.region].columns.count;return Boolean(i)&&!1!==i.draggable&&!o},ignoreSelector:".b-filter-icon,.b-grid-header-resize-handle",listeners:{dragstart:e.onDragStart,drag:e.onDrag,drop:e.onDrop,thisObj:e}}),e.relayEvents(e.dragHelper,["dragStart","drag","drop","abort"],"gridHeader"))}},{key:"onDrag",value:function(e){var t=e.context,n=e.event,r=oc.fromElement(n.target,"gridheader");r&&r.subGrid.sealedColumns?t.valid=!1:this.grid.features.columnDragToolbar||(t.valid=Boolean(n.target.closest(".b-grid-headers")))}},{key:"onDragStart",value:function(){if(!this.grid.features.columnDragToolbar){var e=this.grid.element.querySelector(".b-grid-header-container").getBoundingClientRect();this.dragHelper.minY=e.top,this.dragHelper.maxY=e.bottom}this.grid.headerContainer.classList.add("b-dragging-header")}},{key:"onDrop",value:function(e){var t=e.context;if(!t.valid)return this.onInvalidDrop({context:t});var n=this.grid,r=t.dragging,i=Cr.up(t.target,".b-grid-header"),o=n.columns.get(i.dataset.column),a=t.draggedTo.dataset.region||o.region,s=t.insertBefore,u=n.columns.getById(r.dataset.columnId),c=s?n.columns.getById(s.dataset.columnId):n.subGrids[a].columns.last.nextSibling,l=c?c.parent:n.columns.rootNode;if(n.headerContainer.classList.remove("b-dragging-header"),a!==u.region||o!==u.previousSibling&&c!==u.nextSibling){var f=u.parent&&1===u.parent.children.length&&u.parent;f&&f.parent.removeChild(f),r.remove(),u.region=a,l.insertChild(u,c)}else this.dragHelper.abort()}},{key:"onInvalidDrop",value:function(){this.grid.headerContainer.classList.remove("b-dragging-header")}},{key:"renderContents",value:function(){this.init()}},{key:"render",value:function(){this.init()}}],[{key:"$name",get:function(){return"ColumnReorder"}},{key:"pluginConfig",get:function(){return{after:["render","renderContents"]}}}]),n}(_a(qr));function Mv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Tv.featureClass="b-column-reorder",Tv._$name="ColumnReorder",fv.registerFeature(Tv,!0);var Av=function(e){fe()(n,e);var t=Mv(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e,t){var r=this;r.grid=e,we()(pe()(n.prototype),"construct",this).call(this,e,t),r.resizer=new Su({name:"columnResize",targetSelector:".b-grid-header",handleSelector:".b-grid-header-resize-handle",outerElement:e.element,listeners:{beforeresizestart:r.onBeforeResizeStart,resizestart:r.onResizeStart,resizing:r.onResizing,resize:r.onResize,thisObj:r}})}},{key:"doDestroy",value:function(){this.resizer&&this.resizer.destroy(),we()(pe()(n.prototype),"doDestroy",this).call(this)}},{key:"onBeforeResizeStart",value:function(){return!this.disabled}},{key:"onResizeStart",value:function(e){var t=e.context,n=this.grid,r=this.resizer,i=t.column=n.columns.getById(t.element.dataset.columnId);r.minWidth=i.minWidth,t.element.style.minWidth="",n.element.classList.add("b-column-resizing")}},{key:"onResizing",value:function(e){var t=e.context;t.valid&&this.liveResize&&(this.grid.resizingColumns=!0,t.column.width=t.newWidth)}},{key:"onResize",value:function(e){var t=e.context,n=this.grid,r=t.column;if(n.element.classList.remove("b-column-resizing"),t.valid&&(this.liveResize?(n.resizingColumns=!1,n.afterColumnsResized()):r.width=t.newWidth,j.a.isIE11&&r.parent&&r.parent.flex)){var i=r.parent;n.getHeaderElement(i.id).style.flexBasis=i.children.reduce((function(e,t){return e+n.getHeaderElement(t.id).offsetWidth}),0)+"px"}}},{key:"liveResize",set:function(e){"auto"===e&&(e=!j.a.isMobileSafari),this._liveResize=e},get:function(){return this._liveResize}}],[{key:"$name",get:function(){return"ColumnResize"}},{key:"defaultConfig",get:function(){return{liveResize:"auto"}}},{key:"pluginConfig",get:function(){return[]}}]),n}(qr);function Pv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Av._$name="ColumnResize",fv.registerFeature(Av,!0);var Iv=function(e){fe()(n,e);var t=Pv(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e,t){we()(pe()(n.prototype),"construct",this).call(this,e,t),this.grid=e,y.a.deprecate("Grid","5.0.0","`ContextMenu` feature is deprecated, in favor of `CellMenu` and `HeaderMenu` features. Please see https://bryntum.com/docs/grid/#guides/upgrades/3.1.0.md for more information."),e.features.cellMenu&&(e.features.cellMenu.disabled=!0),e.features.headerMenu&&(e.features.headerMenu.disabled=!0)}},{key:"doDestroy",value:function(){this.currentMenu&&this.currentMenu.destroy(),we()(pe()(n.prototype),"doDestroy",this).call(this)}},{key:"onElementContextMenu",value:function(e){"contextmenu"===this.triggerEvent&&this.showContextMenu(e)}},{key:"onElementClick",value:function(e){"click"===this.triggerEvent&&this.showContextMenu(e)}},{key:"onElementDblClick",value:function(e){"dblclick"===this.triggerEvent&&this.showContextMenu(e)}},{key:"onElementKeyDown",value:function(e){if(!e.handled&&e.target.matches(".b-grid-header.b-depth-0"))switch(e.key){case" ":case"ArrowDown":this.showContextMenu(e)}}},{key:"showContextMenu",value:function(e){if(!this.disabled){var t=Cr.up(e.target,".b-grid-header"),n=this.grid.getCellDataFromEvent(e);t?this.handleHeaderContextMenu(t,e):n&&!this.disableCellContextMenu&&this.handleCellContextMenu(n,e)}}},{key:"handleHeaderContextMenu",value:function(e,t){if(e.dataset.column){var n=this,r=n.grid,i=r.columns.getById(e.dataset.columnId);if(!1!==i.enableHeaderContextMenu){var o=[].concat(d()(n.headerItems),d()(i.headerMenuItems||[])),a=an.transformArrayToNamedObject(o),s={owner:n.client,constrainTo:document,cls:"b-context-menu",scrollAction:"hide",onItem:function(e){var t=e.item,n=e.element;r.trigger("contextMenuItem",{source:r,item:t,column:i,element:n})},onToggle:function(e){var t=e.item,n=e.checked,o=e.element;r.trigger("contextMenuToggleItem",{source:r,item:t,column:i,checked:n,element:o})},onDestroy:function(){n.currentMenu=null},listeners:{show:function(e){var t=e.source;l.menu=t,r.trigger("headerContextMenuShow",l)}}};r.populateHeaderMenu({column:i,items:a,menu:s});var u=an.transformNamedObjectToArray(a),c=n.processHeaderItems,l={items:u,column:i,event:t,element:e};an.merge(s,{items:u}),(!c||!1!==c(l))&&u.length>0&&(t.preventDefault(),u.sort((function(e,t){return(e.weight||150)-(t.weight||150)})),!1!==r.trigger("headerContextMenuBeforeShow",l)&&(n.currentMenu=lc.showContextMenu("keydown"===t.type?e:[t.clientX+1,t.clientY+1],s),n.currentMenu.eachWidget((function(e){!e.column&&e instanceof jd&&(e.column=i)}),!0)))}}}},{key:"handleCellContextMenu",value:function(e,t){var n=this,r=n.grid,i=r.columns.getById(e.columnId);if(!1!==i.enableCellContextMenu){r.focusCell(e.cellSelector,{doSelect:!r.isSelected(e.id),event:t});var o=e.record,a=[].concat(d()(n.cellItems||[]),d()(i.cellMenuItems||[])),s=an.transformArrayToNamedObject(a);r.populateCellMenu({column:i,record:o,items:s});var u=an.transformNamedObjectToArray(s),c=n.processCellItems,l=e.cellElement,f={items:u,column:i,event:t,record:o,element:l},h={owner:n.client,items:u,onBeforeItem:function(e){Object.assign(e,f)},onItem:function(e){var t=e.item;r.trigger("contextMenuItem",{source:r,item:t,column:i,record:o,cell:l})},onClose:function(e){"outside"!==e.reason&&r.focus()},onDestroy:function(){n.currentMenu=null},listeners:{show:function(e){var t=e.source;f.menu=t,r.trigger("cellContextMenuShow",f)}}};(!c||!1!==c(f))&&u.length>0&&(u.forEach((function(e){e.column=i,e.record=o})),t.preventDefault(),u.sort((function(e,t){return(e.weight||150)-(t.weight||150)})),!1!==r.trigger("cellContextMenuBeforeShow",f)&&(n.currentMenu=lc.showContextMenu([t.clientX+1,t.clientY+1],h)))}}},{key:"hideContextMenu",value:function(e){this.currentMenu&&this.currentMenu.hide(e)}},{key:"triggerEvent",get:function(){return this._triggerEvent||this.client.contextMenuTriggerEvent},set:function(e){this._triggerEvent=e}}],[{key:"$name",get:function(){return"ContextMenu"}},{key:"defaultConfig",get:function(){return{headerItems:[],processHeaderItems:null,cellItems:[],processCellItems:null,triggerEvent:null,disableCellContextMenu:null}}},{key:"pluginConfig",get:function(){return{assign:["showContextMenu"],chain:["onElementContextMenu","onElementClick","onElementDblClick","onElementKeyDown"]}}}]),n}(qr);function Ov(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Fv(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Fv(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Fv(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Lv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Iv.featureClass="",Iv._$name="ContextMenu",fv.registerFeature(Iv);var jv={date:"date",integer:"number",number:"number",string:"text",duration:"duration"},_v=function(e){fe()(n,e);var t=Lv(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e,t){if(e.features.filterBar)throw new Error("Grid.feature.Filter feature may not be used together with Grid.feature.FilterBar. These features are mutually exclusive.");var r=this;r.grid=e,r.closeFilterEditor=r.closeFilterEditor.bind(r),we()(pe()(n.prototype),"construct",this).call(this,e,t),r.bindStore(e.store),t&&"object"===l()(t)&&e.store.filter(t,null,e.isConfiguring)}},{key:"doDestroy",value:function(){var e,t;null===(e=this.filterTip)||void 0===e||e.destroy(),null===(t=this.filterEditorPopup)||void 0===t||t.destroy(),we()(pe()(n.prototype),"doDestroy",this).call(this)}},{key:"bindStore",value:function(e){this.detachListeners("name"),e.on({name:"store",filter:"onStoreFilter",thisObj:this})}},{key:"refreshHeaders",value:function(e){var t=this,n=t.grid,r=n.headerContainer;if(r){Cr.children(r,".b-filter-icon.b-latest").forEach((function(e){return e.classList.remove("b-latest")})),t.filterTip||(t.filterTip=new Kl({forElement:r,forSelector:".b-filter-icon",getHtml:function(e){return e.activeTarget.dataset.filterText}}));var i,o=Ov(n.columns);try{for(o.s();!(i=o.n()).done;){var a=i.value;if(!1!==a.filterable){var s=t.store.filters.getBy("property",a.field),u=a.element;if(u){var c=a.textWrapper,l=null==c?void 0:c.querySelector(".b-filter-icon"),f=void 0;f=s?t.L("L{filter}")+": "+("string"==typeof s?s:"".concat(s.operator," ").concat(s.displayValue||s.value||"")):t.L("L{applyFilter}"),l?l.dataset.filterText=f:(l=Cr.createElement({parent:c,tag:"div",className:"b-filter-icon",dataset:{filterText:f}}),u.classList.add("b-filterable")),a.field===t.store.latestFilterField&&l.classList.add("b-latest"),u.classList[s?"add":"remove"]("b-filter")}a.meta.isFiltered=!!s}}}catch(e){o.e(e)}finally{o.f()}e&&n.refreshRows()}}},{key:"applyFilter",value:function(e){var t=this.store,n=this.grid.columns.get(e.property);"function"==typeof n.filterable?t.filter({filterBy:function(t){return n.filterable(Object.assign({},e,{record:t}))},value:e.value,property:e.property,operator:e.operator,displayValue:e.displayValue}):t.filter(e)}},{key:"getPopupDateItems",value:function(e,t,n,r,i,o,a){var s=this,u=o;function c(){s.store.removeFilter(r)}function l(e){"Enter"===e.event.key&&o()}function f(e){var t=e.source,n=e.value;null==n?c():(s.clearSiblingsFields(t),s.applyFilter({property:r,operator:t.operator,value:n,displayValue:t._value}))}return[{type:"date",ref:"on",placeholder:"L{on}",localeClass:s,clearable:!0,label:'<i class="b-fw-icon b-icon-filter-equal"></i>',value:"="===(null==t?void 0:t.operator)?t.value:n,operator:"=",onKeydown:l,onChange:f,onClose:u,onClear:c},{type:"date",ref:"before",placeholder:"L{before}",localeClass:s,clearable:!0,label:'<i class="b-fw-icon b-icon-filter-before"></i>',value:"<"===(null==t?void 0:t.operator)?t.value:null,operator:"<",onKeydown:l,onChange:f,onClose:u,onClear:c},{type:"date",ref:"after",cls:"b-last-row",placeholder:"L{after}",localeClass:s,clearable:!0,label:'<i class="b-fw-icon b-icon-filter-after"></i>',value:">"===(null==t?void 0:t.operator)?t.value:null,operator:">",onKeydown:l,onChange:f,onClose:u,onClear:c}]}},{key:"getPopupNumberItems",value:function(e,t,n,r,i,o,a){var s=this,u=o;function c(){s.store.removeFilter(r)}function l(e){"Enter"===e.event.key&&o()}function f(e){var t=e.source,n=e.value;null==n?c():(s.clearSiblingsFields(t),s.applyFilter({property:r,operator:t.operator,value:n}))}return[{type:"number",placeholder:"L{Filter.equals}",localeClass:s,clearable:!0,label:'<i class="b-fw-icon b-icon-filter-equal"></i>',value:"="===(null==t?void 0:t.operator)?t.value:n,onKeydown:l,operator:"=",onChange:f,onEsc:u,onClear:c},{type:"number",placeholder:"L{lessThan}",localeClass:s,clearable:!0,label:'<i class="b-fw-icon b-icon-filter-less"></i>',value:"<"===(null==t?void 0:t.operator)?t.value:null,onKeydown:l,operator:"<",onChange:f,onEsc:u,onClear:c},{type:"number",cls:"b-last-row",placeholder:"L{moreThan}",localeClass:s,clearable:!0,label:'<i class="b-fw-icon b-icon-filter-more"></i>',value:">"===(null==t?void 0:t.operator)?t.value:null,onKeydown:l,operator:">",onChange:f,onEsc:u,onClear:c}]}},{key:"clearSiblingsFields",value:function(e){var t;null===(t=this.filterEditorPopup)||void 0===t||t.items.forEach((function(t){t!==e&&(null==t||t.clear())}))}},{key:"getPopupDurationItems",value:function(e,t,n,r,i,o,a){var s=this,u=o,c=a;function l(e){var t=e.source,n=e.value;null==n?a():(s.applyFilter({property:r,operator:t.operator,value:n}),o())}return[{type:"duration",placeholder:"L{Filter.equals}",localeClass:s,clearable:!0,label:'<i class="b-fw-icon b-icon-filter-equal"></i>',value:"="===(null==t?void 0:t.operator)?t.value:n,operator:"=",onChange:l,onEsc:u,onClear:c},{type:"duration",placeholder:"L{lessThan}",localeClass:s,clearable:!0,label:'<i class="b-fw-icon b-icon-filter-less"></i>',value:"<"===(null==t?void 0:t.operator)?t.value:null,operator:"<",onChange:l,onEsc:u,onClear:c},{type:"duration",cls:"b-last-row",placeholder:"L{moreThan}",localeClass:s,clearable:!0,label:'<i class="b-fw-icon b-icon-filter-more"></i>',value:">"===(null==t?void 0:t.operator)?t.value:null,operator:">",onChange:l,onEsc:u,onClear:c}]}},{key:"getPopupStringItems",value:function(e,t,n,r,i,o,a,s){var u=this;return[an.assign({type:e,cls:"b-last-row",placeholder:"L{filter}",localeClass:u,clearable:!0,label:'<i class="b-fw-icon b-icon-filter-equal"></i>',value:t?t.value||t:n,onChange:function(e){var t=e.value;""===t?a():(u.applyFilter({property:r,value:t}),o())},onClose:o,onClear:a},s)]}},{key:"getPopupItems",value:function(e,t,n,r,i,o,a,s){switch(e){case"date":return this.getPopupDateItems.apply(this,arguments);case"number":return this.getPopupNumberItems.apply(this,arguments);case"duration":return this.getPopupDurationItems.apply(this,arguments);default:return this.getPopupStringItems.apply(this,arguments)}}},{key:"showFilterEditor",value:function(e,t){var n=this,r=this,i=r.store,o="string"==typeof e?r.grid.columns.getById(e):e,a=o.element,s=i.modelClass.fieldMap[o.field],u=i.filters.getBy("property",o.field),c=o.filterType,l=c?jv[c]:jv[o.type]||s&&jv[s.type]||"text";if(!1!==o.filterable){r.closeFilterEditor();var f=r.getPopupItems(l,u,t,o.field,r.store,r.closeFilterEditor,(function(){r.store.removeFilter(o.field),r.closeFilterEditor()}),o.filterable.filterField);f.forEach((function(e){return e.placeholder=n.L(e.placeholder)})),r.filterEditorPopup=lc.openPopup(a,{owner:this.grid,width:"16em",cls:"b-filter-popup",scrollAction:"realign",items:f})}}},{key:"closeFilterEditor",value:function(){var e;null===(e=this.filterEditorPopup)||void 0===e||e.setTimeout(this.filterEditorPopup.destroy),this.filterEditorPopup=null}},{key:"populateCellMenuWithDateItems",value:function(e){var t=e.column,n=e.record,r=e.items,i=t.field,o=n.getFieldDefinition(i);if("date"===(t.filterType||(null==o?void 0:o.type)||t.type)){var a=this,s=n[i],u=function(e){a.applyFilter({property:i,operator:e,value:s,displayValue:t.formatValue?t.formatValue(s):s})};r.filterDateEquals={text:"L{on}",localeClass:a,icon:"b-fw-icon b-icon-filter-equal",cls:"b-separator",name:"filterDateEquals",weight:300,disabled:a.disabled,onItem:function(){return u("=")}},r.filterDateBefore={text:"L{before}",localeClass:a,icon:"b-fw-icon b-icon-filter-before",name:"filterDateBefore",weight:310,disabled:a.disabled,onItem:function(){return u("<")}},r.filterDateAfter={text:"L{after}",localeClass:a,icon:"b-fw-icon b-icon-filter-after",name:"filterDateAfter",weight:320,disabled:a.disabled,onItem:function(){return u(">")}}}}},{key:"populateCellMenuWithNumberItems",value:function(e){var t=e.column,n=e.record,r=e.items,i=t.field,o=n.getFieldDefinition(i);if("number"===(t.filterType||t.type||(null==o?void 0:o.type))){var a=this,s=n[i],u=function(e){a.applyFilter({property:i,operator:e,value:s})};r.filterNumberEquals={text:"L{equals}",localeClass:a,icon:"b-fw-icon b-icon-filter-equal",cls:"b-separator",name:"filterNumberEquals",weight:300,disabled:a.disabled,onItem:function(){return u("=")}},r.filterNumberLess={text:"L{lessThan}",localeClass:a,icon:"b-fw-icon b-icon-filter-less",name:"filterNumberLess",weight:310,disabled:a.disabled,onItem:function(){return u("<")}},r.filterNumberMore={text:"L{moreThan}",localeClass:a,icon:"b-fw-icon b-icon-filter-more",name:"filterNumberMore",weight:320,disabled:a.disabled,onItem:function(){return u(">")}}}}},{key:"populateCellMenuWithDurationItems",value:function(e){var t=e.column,n=e.record,r=e.items,i=t.field,o=n.getFieldDefinition(i);if("duration"===(t.filterType||(null==o?void 0:o.type)||t.type)){var a=this,s=n[i],u=function(e){a.applyFilter({property:i,operator:e,value:s})};r.filterDurationEquals={text:"L{equals}",localeClass:a,icon:"b-fw-icon b-icon-filter-equal",cls:"b-separator",name:"filterDurationEquals",weight:300,disabled:a.disabled,onItem:function(){return u("=")}},r.filterDurationLess={text:"L{lessThan}",localeClass:a,icon:"b-fw-icon b-icon-filter-less",name:"filterDurationLess",weight:310,disabled:a.disabled,onItem:function(){return u("<")}},r.filterDurationMore={text:"L{moreThan}",localeClass:a,icon:"b-fw-icon b-icon-filter-more",name:"filterDurationMore",weight:320,disabled:a.disabled,onItem:function(){return u(">")}}}}},{key:"populateCellMenuWithStringItems",value:function(e){var t=e.column,n=e.record,r=e.items,i=t.field,o=n.getFieldDefinition(i),a=t.filterType||(null==o?void 0:o.type)||t.type;if(!/(date|number|duration)/.test(a)){var s=this,u=n[i];r.filterStringEquals={text:"L{equals}",localeClass:s,icon:"b-fw-icon b-icon-filter-equal",cls:"b-separator",name:"filterStringEquals",weight:300,disabled:s.disabled,onItem:function(){return s.applyFilter({property:i,value:u})}}}}},{key:"populateCellMenu",value:function(e){var t=e.column,n=(e.record,e.items),r=this;!1!==t.filterable&&(r.populateCellMenuWithDateItems.apply(r,arguments),r.populateCellMenuWithNumberItems.apply(r,arguments),r.populateCellMenuWithDurationItems.apply(r,arguments),r.populateCellMenuWithStringItems.apply(r,arguments),t.meta.isFiltered&&(n.filterRemove={text:"L{removeFilter}",localeClass:r,icon:"b-fw-icon b-icon-clear",cls:"b-separator",weight:400,name:"filterRemove",disabled:r.disabled,onItem:function(){return r.store.removeFilter(t.field)}}))}},{key:"populateHeaderMenu",value:function(e){var t=e.column,n=e.items,r=this;t.meta.isFiltered?(n.editFilter={text:"L{editFilter}",localeClass:r,name:"editFilter",weight:100,icon:"b-fw-icon b-icon-filter",cls:"b-separator",disabled:r.disabled,onItem:function(){return r.showFilterEditor(t)}},n.removeFilter={text:"L{removeFilter}",localeClass:r,name:"removeFilter",weight:110,icon:"b-fw-icon b-icon-remove",disabled:r.disabled,onItem:function(){return r.store.removeFilter(t.field)}}):!1!==t.filterable&&(n.filter={text:"L{filter}",localeClass:r,name:"filter",weight:100,icon:"b-fw-icon b-icon-filter",cls:"b-separator",disabled:r.disabled,onItem:function(){return r.showFilterEditor(t)}})}},{key:"onStoreFilter",value:function(){this.refreshHeaders(!1)}},{key:"renderHeader",value:function(){this.refreshHeaders(!1)}},{key:"onElementClick",value:function(e){var t=e.target;if(this.filterEditorPopup&&this.closeFilterEditor(),t.classList.contains("b-filter-icon")){var n=Cr.up(t,".b-grid-header");return this.showFilterEditor(n.dataset.columnId),!1}}},{key:"store",get:function(){return this.grid.store}}],[{key:"$name",get:function(){return"Filter"}},{key:"pluginConfig",get:function(){return{chain:["renderHeader","populateCellMenu","populateHeaderMenu","onElementClick","bindStore"]}}}]),n}(qr);function Bv(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Hv(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Hv(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Hv(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function $v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}_v._$name="Filter",fv.registerFeature(_v);var Nv=function(e){fe()(n,e);var t=$v(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e,t){if(e.features.filter)throw new Error("Grid.feature.FilterBar feature may not be used together with Grid.feature.Filter, These features are mutually exclusive.");var r=this;Object.assign(r,{filterFieldCls:"b-filter-bar-field",filterFieldInputCls:"b-filter-bar-field-input",filterableColumnCls:"b-filter-bar-enabled",filterFieldInputSelector:".b-filter-bar-field-input",filterableColumnSelector:".b-filter-bar-enabled",filterParseRegExp:/^\s*([<>=*])?(.*)$/,storeTrackingSupended:0,grid:e}),r.onColumnFilterFieldChange=r.onColumnFilterFieldChange.bind(r),we()(pe()(n.prototype),"construct",this).call(this,e,Array.isArray(t)?{filter:t}:t),r.bindStore(e.store),r.filter&&e.store.filter(r.filter),r.gridDetacher=e.on("beforeelementclick",r.onBeforeElementClick,r)}},{key:"bindStore",value:function(e){this.detachListeners("store"),e.on({name:"store",filter:"onStoreFilter",thisObj:this})}},{key:"doDestroy",value:function(){var e;this.destroyFilterBar(),null===(e=this.gridDetacher)||void 0===e||e.call(this),we()(pe()(n.prototype),"doDestroy",this).call(this)}},{key:"doDisable",value:function(e){var t=this,r=this.grid.columns;null==r||r.forEach((function(n){var r=t.getColumnFilterField(n);r&&(r.disabled=e)})),we()(pe()(n.prototype),"doDisable",this).call(this,e)}},{key:"destroyFilterBar",value:function(){var e;null===(e=this.grid.columns)||void 0===e||e.forEach(this.destroyColumnFilterField,this)}},{key:"hideFilterBar",value:function(){var e,t=this;t.clearStoreFiltersOnHide&&t.suspendStoreTracking(),null===(e=t.grid.columns)||void 0===e||e.forEach((function(e){return t.hideColumnFilterField(e,!0)})),t.grid.store.filter(),t.clearStoreFiltersOnHide&&t.resumeStoreTracking(),t.hidden=!0}},{key:"showFilterBar",value:function(){this.renderFilterBar(),this.hidden=!1}},{key:"toggleFilterBar",value:function(){this.hidden?this.showFilterBar():this.hideFilterBar()}},{key:"renderFilterBar",value:function(){var e=this;this.grid.columns.visibleColumns.forEach((function(t){return e.renderColumnFilterField(t)})),this.rendered=!0}},{key:"renderColumnFilterField",value:function(e){var t=this,n=t.grid,r=t.getColumnFilterable(e);if(r&&!e.hidden){var i=e.element,o=t.getColumnFilterField(e);if(o)t.onColumnFilterFieldChange({source:o,value:o.value}),o.render(i),o.show();else{var a=n.store.filters.getBy("property",e.field),s="".concat(e.filterType||"text","field");o=lc.append(Object.assign({type:s,owner:t.grid,clearable:!0,column:e,name:e.field,value:a&&!a._filterBy&&t.buildFilterString(a),cls:t.filterFieldCls,inputCls:t.filterFieldInputCls,keyStrokeChangeDelay:t.keyStrokeFilterDelay,onChange:t.onColumnFilterFieldChange,onClear:t.onColumnFilterFieldChange,disabled:t.disabled},r.filterField),i)[0],t.setColumnFilterField(e,o)}i.classList.add(t.filterableColumnCls)}}},{key:"updateColumnFilterFields",value:function(){var e,t,n,r=this.grid,i=r.columns,o=r.store,a=Bv(i);try{for(a.s();!(n=a.n()).done;){var s=n.value;(e=this.getColumnFilterField(s))&&((t=o.filters.getBy("property",s.field))?t._filterBy||(e.value=this.buildFilterString(t)):e.value="")}}catch(e){a.e(e)}finally{a.f()}}},{key:"getColumnFilterable",value:function(e){if(!e.isRoot&&!1!==e.filterable&&e.field)return"function"==typeof e.filterable&&(e.filterable={filterFn:e.filterable}),e.filterable}},{key:"destroyColumnFilterField",value:function(e){var t=this.getColumnFilterField(e);t&&(this.hideColumnFilterField(e),t.destroy(),this.setColumnFilterField(e,void 0))}},{key:"hideColumnFilterField",value:function(e,t){var n=this.grid.store,r=e.element,i=this.getColumnFilterField(e);i&&(i.hide(),this.clearStoreFiltersOnHide&&e.field&&n.removeFilter(e.field,t),null==r||r.classList.remove(this.filterableColumnCls))}},{key:"getColumnFilterField",value:function(e){var t;return null===(t=this._columnFilters)||void 0===t?void 0:t[e.data.id]}},{key:"setColumnFilterField",value:function(e,t){this._columnFilters=this._columnFilters||{},this._columnFilters[e.data.id]=t}},{key:"parseFilterValue",value:function(e){var t=String(e).match(this.filterParseRegExp);return{operator:t[1]||"*",value:t[2]}}},{key:"buildFilterString",value:function(e){return("*"===e.operator?"":e.operator)+e.value}},{key:"onStoreFilter",value:function(){!this.storeTrackingSupended&&this.rendered&&this.updateColumnFilterFields()}},{key:"suspendStoreTracking",value:function(){this.storeTrackingSupended++}},{key:"resumeStoreTracking",value:function(){this.storeTrackingSupended--}},{key:"renderHeader",value:function(){this.hidden||this.renderFilterBar()}},{key:"onElementKeyDown",value:function(e){if(!e.handled&&e.target.matches(this.filterFieldInputSelector))switch(e.key){case"ArrowLeft":case"ArrowRight":e.handled=!0}}},{key:"onBeforeElementClick",value:function(e){if(e.event.target.closest(".".concat(this.filterFieldCls)))return!1}},{key:"onColumnFilterFieldChange",value:function(e){var t=e.source,n=e.value,r=this,i=r.grid.store,o=r.getColumnFilterable(t.column);r.suspendStoreTracking(),null==n||""===n||Array.isArray(n)&&0===n.length?i.removeFilter(t.name):o.filterFn?i.filter({filterBy:function(e){return o.filterFn({property:t.name,value:n,record:e})},property:t.name}):i.filter(Object.assign({property:t.name},r.parseFilterValue(n))),r.resumeStoreTracking()}},{key:"populateHeaderMenu",value:function(e){var t=this;e.items.toggleFilterBar={text:this.hidden?"L{enableFilterBar}":"L{disableFilterBar}",localeClass:this,name:"toggleFilterBar",weight:120,icon:"b-fw-icon b-icon-filter",cls:"b-separator",onItem:function(){return t.toggleFilterBar()}}}}],[{key:"$name",get:function(){return"FilterBar"}},{key:"defaultConfig",get:function(){return{keyStrokeFilterDelay:300,clearStoreFiltersOnHide:!0}}},{key:"pluginConfig",get:function(){return{before:["onElementKeyDown"],chain:["renderHeader","populateHeaderMenu","bindStore"]}}}]),n}(qr);function Vv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Nv.featureClass="b-filter-bar",Nv._$name="FilterBar",fv.registerFeature(Nv);var zv=function(e){return function(e){fe()(n,e);var t=Vv(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"generateHtml",value:function(e,t,n){var r=this.store,i=e.summaries||(e.sum?[{sum:e.sum,renderer:e.summaryRenderer}]:[]),o='<table class="'.concat(n,'">');return i.forEach((function(n){var i=n.sum,a=null;switch(!0===i&&(i="sum"),i){case"sum":case"add":a=r.sum(e.field,t);break;case"max":a=r.max(e.field,t);break;case"min":a=r.min(e.field,t);break;case"average":case"avg":a=r.average(e.field,t);break;case"count":a=t.length;break;case"countNotEmpty":a=t.reduce((function(t,n){return t+(null!=n[e.field]?1:0)}),0)}if("function"==typeof i&&(a=t.reduce(i,"seed"in n?n.seed:0)),null!==a){var s,u=n.label?'<td class="b-grid-summary-label">'.concat(n.label,"</td>"):"",c=n.renderer?n.renderer({config:n,sum:a}):a;null==c&&(c=""),s=String(c).includes("<td>")?c:u?"".concat(u,'<td class="').concat("b-grid-summary-value",'">').concat(c,"</td>"):'<td colspan="2" class="'.concat("b-grid-summary-value",'">').concat(c,"</td>"),o+="<tr>".concat(s,"</tr>")}})),o+"</table>"}}],[{key:"$name",get:function(){return"SummaryFormatter"}}]),n}(e||ue)};function Wv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var Gv=function(e){fe()(n,e);var t=Wv(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e,t){if(this.grid=e,we()(pe()(n.prototype),"construct",this).call(this,e,t),!e.features.group)throw new Error("Requires Group feature to work, please enable");this.bindStore(e.store),e.rowManager.on({beforeRenderRow:"onBeforeRenderRow",renderCell:"renderCell",prio:1e3,thisObj:this})}},{key:"bindStore",value:function(e){this.detachListeners("store"),e.on({name:"store",update:"onStoreUpdate",prio:1,thisObj:this})}},{key:"doDisable",value:function(e){this.store.useGroupFooters=!e,this.isConfiguring||this.store.group(),we()(pe()(n.prototype),"doDisable",this).call(this,e)}},{key:"onBeforeRenderRow",value:function(e){var t=e.row,n=e.record;t.isGroupFooter&&!("groupFooterFor"in n.meta)?(t.isGroupFooter=!1,t.removeCls("b-group-footer"),t.forceInnerHTML=!0):t.isGroupHeader&&!n.meta.collapsed&&(t.removeCls("b-header-summary"),t.eachElement(this.removeSummaryElements))}},{key:"removeSummaryElements",value:function(e){var t=e.querySelector(".b-timeaxis-group-summary");null==t||t.remove()}},{key:"renderCell",value:function(e){var t=e.column,n=e.cellElement,r=e.rowElement,i=e.row,o=e.record,a=e.size,s=e.isFirstColumn,u=this,c=o.meta,l="groupRowFor"in c,f="groupFooterFor"in c;if(u.store.isGrouped&&(f||u.collapseToHeader&&l&&c.collapsed&&!s)){var d=l?o:c.groupRecord;i.isGroupFooter=f,i.isGroupHeader=l,f?r.classList.add("b-group-footer"):r.classList.add("b-header-summary");var h=u.updateSummaryHtml(n,t,d),v="number"==typeof h?h:h.count;v>1&&(a.height=u.grid.rowHeight+v*u.grid.rowHeight*.1),h.height&&(a.height+=h.height)}}},{key:"updateSummaryHtml",value:function(e,t,n){var r=n.groupChildren.slice();r.pop();var i=this.generateHtml(t,r,"b-grid-group-summary");return e.children.length?Cr.sync(i,e.firstElementChild):e.innerHTML=i,t.summaries?t.summaries.length:t.sum?1:0}},{key:"onStoreUpdate",value:function(e){var t=this,n=e.source,r=e.changes;if(!this.disabled&&n.isGrouped){if(r&&n.groupers.find((function(e){return e.field in r})))return;Object.keys(r).some((function(e){var n=t.grid.columns.get(e);return Boolean(n)&&(Boolean(n.sum)||Boolean(n.summaries))}))&&(this.grid.forceFullRefresh=!0)}}},{key:"store",get:function(){return this.grid.store}}],[{key:"$name",get:function(){return"GroupSummary"}},{key:"configurable",get:function(){return{collapseToHeader:null}}},{key:"pluginConfig",get:function(){return{chain:["bindStore"]}}}]),n}(zv(qr));function Yv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Gv.featureClass="b-group-summary",Gv._$name="GroupSummary",fv.registerFeature(Gv);var Uv=function(e){fe()(n,e);var t=Yv(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e,t){this.grid=e,we()(pe()(n.prototype),"construct",this).call(this,e,t),this.bindStore(e.store),e.hideFooters=!1}},{key:"bindStore",value:function(e){this.detachListeners("store"),e.on({name:"store",change:"onStoreChange",thisObj:this})}},{key:"doDestroy",value:function(){we()(pe()(n.prototype),"doDestroy",this).call(this)}},{key:"doDisable",value:function(e){we()(pe()(n.prototype),"doDisable",this).call(this,e),e?this.grid.element.classList.add("b-summary-disabled"):(this.updateSummaries(),this.grid.element.classList.remove("b-summary-disabled"))}},{key:"renderRows",value:function(){this.updateSummaries()}},{key:"updateSummaries",value:function(){var e=this,t=e.grid,n=e.store,r=Cr.children(t.element,".b-grid-footer"),i=n.storage.values.filter((function(e){return!e.isSpecialRow}));t.columns.forEach((function(e){e.summaries&&e.summaries.forEach((function(e){"seed"in e&&("initialSeed"in e||(e.initialSeed=e.seed),["number","string","date"].includes(l()(e.initialSeed))?e.seed=e.initialSeed:e.seed=Object.assign({},e.initialSeed))}))})),r.forEach((function(n){if(n.dataset.column){var r=t.columns.get(n.dataset.column),o=e.generateHtml(r,i,"b-grid-footer-summary");(r.summaries?r.summaries.length:!!r.sum)&&(n.children.length?Cr.sync(o,n.firstElementChild):n.innerHTML=o)}}))}},{key:"onStoreChange",value:function(e){var t=this,n=e.action,r=e.changes,i=!0;this.disabled||("update"===n&&(i=Object.keys(r).some((function(e){var n=t.grid.columns.get(e);return Boolean(n)&&(Boolean(n.sum)||Boolean(n.summaries))}))),i&&this.updateSummaries())}},{key:"store",get:function(){return this.grid.store}}],[{key:"$name",get:function(){return"Summary"}},{key:"pluginConfig",get:function(){return{chain:["renderRows"]}}}]),n}(zv(qr));function qv(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Kv(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Kv(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Kv(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Xv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Uv.featureClass="b-summary",Uv._$name="Summary",fv.registerFeature(Uv);var Zv=function(e){fe()(n,e);var t=Xv(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e,t){var r=this;e.features.tree||(r._thisIsAUsedExpression(e.features.groupSummary),t=r.processConfig(t),r.grid=e,r.rowManager=e.rowManager,we()(pe()(n.prototype),"construct",this).call(this,e,t),r.bindStore(e.store),r.rowManager.on({beforeRenderRow:"onBeforeRenderRow",renderCell:"renderCell",prio:1100,thisObj:r}))}},{key:"processConfig",value:function(e){return"string"==typeof e?{field:e,ascending:null}:e}},{key:"setConfig",value:function(e){null===e?this.store.clearGroupers():we()(pe()(n.prototype),"setConfig",this).call(this,this.processConfig(e))}},{key:"bindStore",value:function(e){this.detachListeners("store"),e.on({name:"store",group:"onStoreGroup",thisObj:this})}},{key:"doDestroy",value:function(){we()(pe()(n.prototype),"doDestroy",this).call(this)}},{key:"doDisable",value:function(e){var t=this.store;if(e&&t.isGrouped){var r=t.sorters;r.unshift.apply(r,d()(t.groupers)),t.clearGroupers(),t.sort(r)}we()(pe()(n.prototype),"doDisable",this).call(this,e)}},{key:"toggleCollapse",value:function(e,t){this.internalToggleCollapse(e,t)}},{key:"internalToggleCollapse",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.store,o=i.getById(e),a=o.meta;void 0!==a.groupRowFor&&((t=void 0===t?!a.collapsed:t)?i.excludeGroupRecords(o):i.includeGroupRecords(o),a.collapsed=t,r.grid.trigger("toggleGroup",{groupRecord:o,collapse:t}),n||r.rowManager.renderFromRecord(o))}},{key:"collapseAll",value:function(){var e=this;e.store.isGrouped&&!e.disabled&&(e.store.groupRecords.forEach((function(t){return e.internalToggleCollapse(t,!0,!0)})),e.grid.refreshRows(!0))}},{key:"expandAll",value:function(){var e=this;e.store.isGrouped&&!e.disabled&&(e.store.groupRecords.forEach((function(t){return e.internalToggleCollapse(t,!1,!0)})),e.grid.refreshRows())}},{key:"onBeforeRenderRow",value:function(e){var t=e.row,n=(e.record,t.grid.store.getById(t.id));t.forceInnerHTML=t.forceInnerHTML||n&&"groupRowFor"in n.meta}},{key:"renderCell",value:function(e){if(this.store.isGrouped&&!this.disabled){var t=e.cellElement,n=e.rowElement,r=e.column,i=this.grid,o=e.record.meta,a=i.columns.visibleColumns[0],s=i.subGrids[i.regions[0]].columns.visibleColumns;if("groupRowFor"in o){if("action"===r.type)return;r.clearCell(t),n.classList[o.collapsed?"add":"remove"]("b-grid-group-collapsed"),n.classList.add("b-group-row"),("rownumber"===a.type&&r===s[1]||"rownumber"!==a.type&&r===s[0])&&t.classList.add("b-group-title"),this.buildGroupHeader(e)}else t===n.firstElementChild&&(n.classList.remove("b-group-row"),n.classList.remove("b-grid-group-collapsed"),t.classList.remove("b-group-title"))}}},{key:"buildGroupHeader",value:function(e){var t=this,n=e.record,r=e.cellElement,i=e.column,o=e.persist,a=t.grid,s=n.meta,u=s.childCount-(a.features.groupSummary?1:0),c=a.columns.visibleColumns[0],f=i&&a.subGrids[a.regions[0]].columns.visibleColumns,d=e.isFirstColumn="rownumber"===c.type&&i===f[1]||"rownumber"!==c.type&&i===f[0],h=null,v=!0;if(o||i){var p=a.columns.get(s.groupField);(null==p?void 0:p.groupRenderer)?d&&(h=p.groupRenderer(Object.assign({},e,{groupRowFor:s.groupRowFor,groupRecords:n.groupChildren,groupColumn:p,count:u})),v=!1):t.groupRenderer&&(h=t.groupRenderer(Object.assign({},e,{groupRowFor:s.groupRowFor,groupRecords:n.groupChildren,groupColumn:p,count:u,isFirstColumn:d}))),d&&null==h&&v&&(h="".concat("__novalue__"===s.groupRowFor?"":s.groupRowFor," (").concat(u,")"))}else t.groupRenderer&&(h=t.groupRenderer(e));return"string"==typeof h?r.innerHTML=h:"object"===l()(h)&&Gs.sync({targetElement:r,domConfig:{onlyChildren:!0,children:Array.isArray(h)?h:[h]}}),r.childElementCount>0&&(r._hasHtml=!0),r.innerHTML}},{key:"renderHeader",value:function(e){var t=this.store,n=this.grid;if(t.isGrouped){var r,i=qv(t.groupers);try{for(i.s();!(r=i.n()).done;){var o=r.value,a=n.columns.get(o.field),s=a&&n.getHeaderElement(a.id);s&&(s.classList.add("b-group"),s.classList.add(o.ascending?"b-asc":"b-desc"))}}catch(e){i.e(e)}finally{i.f()}}}},{key:"populateHeaderMenu",value:function(e){var t=e.column,n=e.items,r=this;!1!==t.groupable&&(n.groupAsc={text:"L{groupAscending}",localeClass:r,icon:"b-fw-icon b-icon-group-asc",name:"groupAsc",cls:"b-separator",weight:400,disabled:r.disabled,onItem:function(){return r.store.group(t.field,!0)}},n.groupDesc={text:"L{groupDescending}",localeClass:r,icon:"b-fw-icon b-icon-group-desc",name:"groupDesc",weight:410,disabled:r.disabled,onItem:function(){return r.store.group(t.field,!1)}}),r.store.isGrouped&&(n.groupRemove={text:"L{stopGrouping}",localeClass:r,icon:"b-fw-icon b-icon-clear",name:"groupRemove",cls:t.groupable?"":"b-separator",weight:420,disabled:r.disabled,onItem:function(){return r.store.clearGroupers()}})}},{key:"getColumnDragToolbarItems",value:function(e,t){var n,r=this,i=r.store;t.push({text:"L{groupAscendingShort}",group:"L{group}",localeClass:r,icon:"b-icon b-icon-group-asc",name:"groupAsc",cls:"b-separator",weight:110,disabled:r.disabled,onDrop:function(e){var t=e.column;return i.group(t.field,!0)}}),t.push({text:"L{groupDescendingShort}",group:"L{group}",localeClass:r,icon:"b-icon b-icon-group-desc",name:"groupDesc",weight:110,disabled:r.disabled,onDrop:function(e){var t=e.column;return i.group(t.field,!1)}});var o=(null===(n=i.groupers)||void 0===n?void 0:n.some((function(t){return t.field===e.field})))&&!r.disabled;return t.push({text:"L{stopGroupingShort}",group:"L{group}",localeClass:r,icon:"b-icon b-icon-clear",name:"groupRemove",disabled:!o,weight:110,onDrop:function(e){var t=e.column;return i.removeGrouper(t.field)}}),t}},{key:"onStoreGroup",value:function(e){var t=e.groupers,n=this.grid,r=n.element,i=r&&Cr.children(r,".b-grid-header.b-group");if(r){var o,a=qv(i);try{for(a.s();!(o=a.n()).done;){var s=o.value;Cr.removeClasses(s,["b-group","b-asc","b-desc"])}}catch(e){a.e(e)}finally{a.f()}if(t){var u,c=qv(t);try{for(c.s();!(u=c.n()).done;){var l=u.value,f=n.getHeaderElementByField(l.field);f&&Cr.addClasses(f,["b-group",l.ascending?"b-asc":"b-desc"])}}catch(e){c.e(e)}finally{c.f()}}}}},{key:"onElementTouchStart",value:function(e){var t=e.target,n=Cr.up(t,".b-grid-header"),r=n&&this.grid.getColumnFromElement(n);e.touches.length>1&&r&&!1!==r.groupable&&!this.disabled&&this.store.group(r.field)}},{key:"onElementClick",value:function(e){var t=this.store,n=e.target,r=Cr.up(n,".b-group-row"),i=Cr.up(n,".b-grid-header"),o=null==i?void 0:i.dataset.column;if(!(n.classList.contains("b-resizer")||this.disabled||n.classList.contains("b-action-item"))){if(i&&o){var a,s=null===(a=t.groupers)||void 0===a?void 0:a.find((function(e){return e.field===o}));if(s&&!e.shiftKey)return t.group(o,!s.ascending),!1;e.shiftKey&&!1!==this.grid.columns.get(o).groupable&&(e.altKey?t.removeGrouper(o):t.group(o)),e.preventDefault()}return r?(this.internalToggleCollapse(qo.get(r).id),!1):void 0}}},{key:"onElementKeyDown",value:function(e){var t=this;!t.disabled&&t.store.isGrouped&&e.target===t.grid.focusElement&&" "===e.key&&t.grid.focusedCell&&(e.preventDefault(),t.internalToggleCollapse(t.grid.focusedCell.id))}},{key:"renderer",set:function(e){this.groupRenderer=e}},{key:"field",set:function(e){this._field=e,this.store.group(e,this.ascending)},get:function(){return this._field}},{key:"store",get:function(){return this.grid.store}}],[{key:"$name",get:function(){return"Group"}},{key:"defaultConfig",get:function(){return{field:null,renderer:null}}},{key:"pluginConfig",get:function(){return{assign:["collapseAll","expandAll"],chain:["renderHeader","populateHeaderMenu","getColumnDragToolbarItems","onElementTouchStart","onElementClick","onElementKeyDown","bindStore"]}}}]),n}(qr);function Jv(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Zv._$name="Group",fv.registerFeature(Zv,!0,["Grid","Scheduler"]);var Qv=function(e){fe()(n,e);var t=Jv(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"onElementKeyDown",value:function(e){if(!e.handled&&e.target.matches(".b-grid-header.b-depth-0"))switch(e.key){case" ":this.internalShowContextMenu(this.createContextMenuEventForElement(e.target))}}},{key:"shouldShowMenu",value:function(e){var t=e.column;return t&&!1!==t.enableHeaderContextMenu&&(this._showForTimeAxis||t!==this.client.timeAxisColumn)}},{key:"showContextMenu",value:function(e){var t=e.column;we()(pe()(n.prototype),"showContextMenu",this).apply(this,arguments),t===this.client.timeAxisColumn&&this.menu&&(this.menu.scrollAction="realign")}},{key:"getDataFromEvent",value:function(e){return an.assign(we()(pe()(n.prototype),"getDataFromEvent",this).call(this,e),this.client.getHeaderDataFromEvent(e))}},{key:"populateHeaderMenu",value:function(e){var t=e.items,n=e.column;return(null==n?void 0:n.headerMenuItems)&&(Array.isArray(n.headerMenuItems)&&y.a.deprecate("Grid","5.0.0","`headerMenuItems` column config specified as an array is deprecated, need to specify the config as a named object. Please see https://bryntum.com/docs/grid/#guides/upgrades/4.0.0.md for more information."),an.merge(t,n.headerMenuItems)),t}}],[{key:"$name",get:function(){return"HeaderMenu"}},{key:"defaultConfig",get:function(){return{type:"header",_showForTimeAxis:!1}}},{key:"pluginConfig",get:function(){var e=we()(pe()(n),"pluginConfig",this);return e.chain.push("populateHeaderMenu"),e}}]),n}(av);function ep(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return tp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tp(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function tp(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function np(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Qv.featureClass="",Qv._$name="HeaderMenu",fv.registerFeature(Qv,!0);var rp=function(e){fe()(n,e);var t=np(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e,t){this.grid=e,we()(pe()(n.prototype),"construct",this).call(this,e,t)}},{key:"doDisable",value:function(e){e&&this.clear(),we()(pe()(n.prototype),"doDisable",this).call(this,e)}},{key:"showQuickFind",value:function(){var e=this,t=e.grid.getHeaderElement(e.columnId);if(t){if(!e.headerField){var n=Cr.createElement({tag:"div",className:"b-quick-hit-header",children:[{tag:"div",className:"b-quick-hit-field"},{tag:"div",className:"b-quick-hit-badge"}]},!0),r=ye()(n,3),i=r[0],o=r[1],a=r[2];"header"===e.mode?t.appendChild(i):(i.className+=" b-quick-hit-mode-grid",e.grid.element.appendChild(i)),e.headerField={header:i,field:o,badge:a,colHeader:t}}e.headerField.field.innerHTML=e.find,e.headerField.badge.innerHTML=e.found.length,t.classList.add("b-quick-find-header"),e.renderListenerInitialized||(e.grid.rowManager.on({rendercell:e.renderCell,thisObj:e}),e.renderListenerInitialized=!0)}}},{key:"hideQuickFind",value:function(){var e,t=this,n=t.grid,r=t.headerField,i=ep(t.prevFound||t.found);try{for(i.s();!(e=i.n()).done;){var o=e.value,a=n.getRowById(o.id);if(a){var s=a.getCell(t.columnId);s._content=null,a.renderCell(s,o.data)}}}catch(e){i.e(e)}finally{i.f()}r&&(r.header.parentNode.removeChild(r.header),r.colHeader.classList.remove("b-quick-find-header"),t.headerField=null),t.renderListenerInitialized&&(n.rowManager.un({rendercell:t.renderCell},t),t.renderListenerInitialized=!1),n.trigger("hideQuickFind")}},{key:"search",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.columnId,n=this,r=n.grid,i=n.currentColumn,o=r.columns.getById(t)||r.columns.get(t),a=n.store.findByField(o.field,e),s=1;Object.assign(n,{foundMap:{},prevFound:n.found,found:a,find:e,columnId:o.id}),e?n.showQuickFind():n.hideQuickFind(),i&&i!==o&&(i.disableHtmlEncode=!1);var u,c=ep(Cr.children(r.element,".b-quick-hit"));try{for(c.s();!(u=c.n()).done;){var l=u.value;l.classList.remove("b-quick-hit"),l.classList.remove("b-quick-hit-cell");var f=qo.get(l).row;l._content=null,f.renderCell(l)}}catch(e){c.e(e)}finally{c.f()}if(o.disableHtmlEncode=!0,n.currentColumn=o,a){a.length>0&&n.gotoClosestHit(r.focusedCell,a);var d,h=ep(a);try{for(h.s();!(d=h.n()).done;){var v=d.value;n.foundMap[v.id]=s++;var p=r.getRowById(v.data.id);if(p&&p.renderCell(p.getCell(o.id)),s>1e3)break}}catch(e){h.e(e)}finally{h.f()}r.trigger("quickFind",{find:e,found:a})}}},{key:"clear",value:function(){var e;(null===(e=this.found)||void 0===e?void 0:e.length)&&this.search("")}},{key:"gotoHit",value:function(e){var t=this.found[e];return t&&this.grid.focusCell({columnId:this.columnId,id:t.id}),!!t}},{key:"gotoClosestHit",value:function(e,t){var n=e?this.grid.store.indexOf(e.id):0,r=t.slice().sort((function(e,t){return Math.abs(e.index-n)-Math.abs(t.index-n)}));this.gotoHit(t.indexOf(r[0]))}},{key:"gotoFirstHit",value:function(){this.gotoHit(0)}},{key:"gotoLastHit",value:function(){this.gotoHit(this.found.length-1)}},{key:"gotoNextHit",value:function(){var e,t=this.grid,n=t._focusedCell?t._focusedCell.id:null===(e=t.lastFocusedCell)||void 0===e?void 0:e.id,r=t.store.indexOf(n)||0,i=this.found.find((function(e){return e.index>r}));i?t.focusCell({columnId:this.columnId,id:i.id}):this.gotoFirstHit()}},{key:"gotoPrevHit",value:function(){var e,t,n=this.grid,r=this.found,i=n._focusedCell?n._focusedCell.id:null===(e=n.lastFocusedCell)||void 0===e?void 0:e.id,o=n.store.indexOf(i)||0;if(r.length){for(var a=r.length-1;a--;a>=0)if(r[a].index<o){t=r[a];break}t?n.focusCell({columnId:this.columnId,id:t.id}):this.gotoLastHit()}}},{key:"renderCell",value:function(e){var t,n=e.cellElement,r=this.columnId===e.column.id&&(null===(t=this.foundMap)||void 0===t?void 0:t[e.record.id]);if(r){var i=e.column.htmlEncode||e.column.shouldHtmlEncode;if(n.classList.add("b-quick-hit"),i){var o,a=Cr.down(n,".b-grid-cell-value,.b-tree-cell-value")||n,s=a.innerText,u=null===(o=s)||void 0===o?void 0:o.toLowerCase().indexOf(this.find.toLowerCase());if(u>-1){var c=u+this.find.length,l=s.slice(u,c),f="";" "===s[u-1]&&(f="&nbsp;"),s=s.slice(0,u)+'<span class="b-quick-hit-text">'.concat(f).concat(l,"</span>")+s.slice(c),a.innerHTML=s+'<div class="b-quick-hit-cell-badge">'.concat(r,"</div>")}else n.classList.add("b-quick-hit-cell")}else n.classList.add("b-quick-hit-cell")}}},{key:"onElementKeyDown",value:function(e){var t=this,n=t.grid.features.filter;t.disabled||Cr.up(e.target,j.a.isIE11?".b-widget:not(.b-grid-subgrid):not(.b-grid)":".b-widget:not(.b-grid)")||t.find.length>0&&("Backspace"===e.key?(e.preventDefault(),t.find=t.find.substr(0,t.find.length-1),t.search(t.find)):"Escape"===e.key?(e.preventDefault(),t.find="",t.search(t.find)):"F3"===e.key||"g"===e.key.toLowerCase()&&(e.ctrlKey||e.metaKey)?(e.preventDefault(),e.shiftKey?t.gotoPrevHit():t.gotoNextHit()):n&&t.columnId&&t.foundCount&&e.ctrlKey&&e.shiftKey&&"F"===e.key&&(t.clear(),n.showFilterEditor(t.grid.columns.getById(t.columnId),t.find)))}},{key:"onElementKeyPress",value:function(e){var t=this,n=t.grid;if(!t.disabled&&!Cr.up(e.target,j.a.isIE11?".b-widget:not(.b-grid-subgrid):not(.b-grid)":".b-widget:not(.b-grid)")&&"Enter"!==e.key&&n._focusedCell){var r,i=n.columns.getById(n._focusedCell.columnId);if(i&&!1!==i.searchable)t.columnId=n._focusedCell.columnId,1===(null===(r=e.key)||void 0===r?void 0:r.length)&&(t.find+=e.key,t.search(t.find))}}},{key:"onCellNavigate",value:function(e,t,n){!(this.prevFound||this.found)||n&&n.columnId===this.columnId||this.clear()}},{key:"store",get:function(){return this.grid.store}},{key:"foundCount",get:function(){var e,t;return null!==(e=null===(t=this.found)||void 0===t?void 0:t.length)&&void 0!==e?e:0}}],[{key:"$name",get:function(){return"QuickFind"}},{key:"defaultConfig",get:function(){return{mode:"header",find:""}}},{key:"pluginConfig",get:function(){return{chain:["onElementKeyDown","onElementKeyPress","onCellNavigate"]}}}]),n}(qr);function ip(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}rp._$name="QuickFind",fv.registerFeature(rp);var op=function(e){fe()(n,e);var t=ip(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e,t){this.grid=e,we()(pe()(n.prototype),"construct",this).call(this,e,t)}},{key:"doDestroy",value:function(){we()(pe()(n.prototype),"doDestroy",this).call(this)}},{key:"onElementDblClick",value:function(e){var t=this,n=t.grid,r=Cr.up(e.target,".b-grid-splitter-collapsed");if(r&&!t.expanding){t.expanding=!0;var i=r.dataset.region,o=n.getSubGrid(i);o.collapsed||(i=n.getLastRegions()[1],o=n.getSubGrid(i)),o.expand().then((function(){return t.expanding=!1}))}}},{key:"startMove",value:function(e,t){var n=this.grid,r=e.dataset.region,i=n.element,o=n.regions[n.regions.indexOf(r)+1],a=n.getSubGrid(o),s=n.getSubGrid(r),u=s,c=1;if(null!=u.flex&&null==a.flex&&(u=a,c=-1),!e.classList.contains("b-grid-splitter-collapsed")){var l=u.element.offsetWidth+a.element.offsetWidth;this.dragContext={element:e,headerEl:u.header.element,subGridEl:u.element,subGrid:u,splitterSubGrid:s,originalWidth:u.element.offsetWidth,originalX:t,minWidth:u.minWidth||0,maxWidth:Math.min(l,u.maxWidth||l),flip:c},i.classList.add("b-moving-splitter"),s.toggleSplitterCls("b-moving")}}},{key:"endMove",value:function(){var e=this.dragContext;e&&(this.grid.element.classList.remove("b-moving-splitter"),e.splitterSubGrid.toggleSplitterCls("b-moving",!1),this.dragContext=null)}},{key:"onCollapseClick",value:function(e,t){var n=this.grid,r=t.dataset.region,i=n.getLastRegions();if(i[0]===r){var o=n.getSubGrid(i[1]);if(o.collapsed)return void o.expand()}e.collapse()}},{key:"onExpandClick",value:function(e,t){var n=this.grid,r=t.dataset.region,i=n.getLastRegions();if(i[0]===r&&!e.collapsed)return void n.getSubGrid(i[1]).collapse();e.expand()}},{key:"updateMove",value:function(e){var t=this.dragContext;if(t){var n=e-t.originalX,r=Math.min(t.maxWidth,t.originalWidth+n*t.flip);t.subGrid.width=Math.max(r,t.minWidth)}}},{key:"onElementTouchStart",value:function(e){var t=e.target.closest(".b-grid-splitter");t&&this.startMove(t,e.touches[0].clientX)}},{key:"onElementTouchMove",value:function(e){this.dragContext&&(this.updateMove(e.touches[0].clientX),e.preventDefault())}},{key:"onElementTouchEnd",value:function(e){this.dragContext&&(this.endMove(),e.preventDefault())}},{key:"onElementMouseDown",value:function(e){var t=e.target,n=t.closest(":not(.b-row-reordering):not(.b-dragging-event):not(.b-dragging-task):not(.b-dragging-header):not(.b-dragselecting) .b-grid-splitter"),r=n&&this.grid.getSubGrid(n.dataset.region);0===e.button&&(t.classList.contains("b-grid-splitter")||t.classList.contains("b-grid-splitter-inner")?this.startMove(n,e.clientX):t.classList.contains("b-icon-collapse-gridregion")?this.onCollapseClick(r,n):t.classList.contains("b-icon-expand-gridregion")&&this.onExpandClick(r,n))}},{key:"onElementMouseMove",value:function(e){this.dragContext&&(this.updateMove(e.clientX),e.preventDefault())}},{key:"onElementMouseUp",value:function(e){this.dragContext&&(this.endMove(),e.preventDefault())}},{key:"onSubGridCollapse",value:function(e){var t=this.grid.resolveSplitter(e);this.grid.getLastRegions()[1]===e.region&&t.classList.add("b-grid-splitter-allow-collapse")}},{key:"onSubGridExpand",value:function(e){this.grid.resolveSplitter(e).classList.remove("b-grid-splitter-allow-collapse")}},{key:"render",value:function(){var e=this.grid,t=e.regions,n=e.subGrids;t.length>2&&(n[t[0]].splitterElement.classList.add("b-left-only"),n[t[1]].splitterElement.classList.add("b-right-only"))}}],[{key:"$name",get:function(){return"RegionResize"}},{key:"pluginConfig",get:function(){return{chain:["onElementTouchStart","onElementTouchMove","onElementTouchEnd","onElementMouseDown","onElementMouseMove","onElementDblClick","onElementMouseUp","onSubGridCollapse","onSubGridExpand","render"]}}}]),n}(qr);function ap(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}op.featureClass="b-split",op._$name="RegionResize",fv.registerFeature(op);var sp=function(e){fe()(i,e);var t,n,r=ap(i);function i(){return v()(this,i),r.apply(this,arguments)}return g()(i,[{key:"construct",value:function(e,t){this.grid=e,we()(pe()(i.prototype),"construct",this).apply(this,arguments)}},{key:"doDestroy",value:function(){var e;null===(e=this.dragHelper)||void 0===e||e.destroy(),we()(pe()(i.prototype),"doDestroy",this).call(this)}},{key:"init",value:function(){var e=this,t=e.grid;e.dragHelper=new hu({name:"rowReorder",mode:"translateXY",cloneTarget:!0,dragThreshold:10,targetSelector:".b-grid-row",lockX:!0,transitionDuration:t.transitionDuration,scrollManager:t.scrollManager,dragWithin:t.verticalScroller,outerElement:t.verticalScroller,ignoreSamePositionDrop:!1,createProxy:function(e){var n=e.cloneNode(!0),r=document.createElement("div");if(n.removeAttribute("id"),n.style.transform="",r.appendChild(n),t.selectedRecords.length>1){var i=n.cloneNode(!0);i.classList.add("b-row-dragging-multiple"),r.appendChild(i)}return Cr.removeClsGlobally(r,"b-selected","b-hover","b-focused"),r},listeners:{beforedragstart:e.onBeforeDragStart,dragstart:e.onDragStart,drag:e.onDrag,drop:e.onDrop,reset:e.onReset,prio:1e4,thisObj:e}}),e.dropIndicator=Cr.createElement({parent:t.bodyContainer,className:"b-row-drop-indicator"}),e.relayEvents(e.dragHelper,["beforeDragStart","dragStart","drag","abort"],"gridRow")}},{key:"onBeforeDragStart",value:function(e){var t=e.context,n=this.grid,r=n.regions[0],i=n.subGrids[r].element;if(this.disabled||n.readOnly||!i.contains(t.element))return!1;var o=t.records=n.selectedRecords.slice().sort((function(e,t){return n.store.indexOf(e)-n.store.indexOf(t)}));return t.startRecord=n.getRecordFromElement(t.element),t.record=t.startRecord,o.length>0&&!o.some((function(e){return e.isSpecialRow}))}},{key:"onDragStart",value:function(e){var t=e.context,n=this.grid.features,r=n.cellEdit,i=n.contextMenu,o=n.cellMenu,a=n.headerMenu;r&&(this.cellEditDisabledState=r.disabled,r.disabled=!0),null==i||i.hideContextMenu(!1),null==o||o.hideContextMenu(!1),null==a||a.hideContextMenu(!1),this.grid.element.classList.add("b-row-reordering");var s=t.element.querySelector(".b-focused");null==s||s.classList.remove("b-focused"),Cr.removeClasses(t.element.firstElementChild,["b-selected","b-hover"])}},{key:"onDrag",value:function(e){var t=e.context,n=e.event,r=this,i=r.grid,o=i.store,a=i.rowManager,s=r.dragHelper.outerElement;if(s.contains(n.target)&&n.target.closest(".b-grid-subgrid")){if(!j.a.isChrome||En.from(s).contains(nu.getPagePoint(n))){var u,c,l,f,d=t.valid,h=i.rowManager.getRowAt(n.clientY);if(h){var v=h.top+i._bodyRectangle.y-i.scrollable.y+h.height/2;c=h.dataIndex,u=h&&o.getAt(c),l=n.clientY>v}else c=o.count-1,u=o.last,h=i.rowManager.getRow(c),l=!0;if(u===t.startRecord&&(d=!1),o.tree){if(Cr.removeClsGlobally(i.element,"b-row-reordering-target-parent"),f=l?u.nextSibling:u,t.records.some((function(e){return e.contains(u)}))&&(d=!1),t.parent=u.parent,!t.parent.isRoot){var p=a.getRowById(t.parent);p&&p.addCls("b-row-reordering-target-parent")}r.clearTimeout(r.hoverTimer),u&&u.isParent&&!u.isExpanded(o)&&(r.hoverTimer=r.setTimeout((function(){return i.expand(u)}),r.hoverExpandTimeout))}else f=l?o.getAt(c+1):u;Cr.setTranslateY(r.dropIndicator,h.top+(l?h.height:0)),t.insertBefore=f,t.valid=d}}else t.valid=!1}},{key:"onDrop",value:(n=Wr()(Vr.a.mark((function e(t){var n,r;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this,r=t.context,n.trigger("gridRowBeforeDropFinalize",t),r.valid?(r.asyncCleanup=r.async=!0,r.element.classList.add("b-dropping"),n.setTimeout((function(){return n.finalizeReorder(r).then((function(){return n.trigger("gridRowDrop",t)}))}),n.finalizeDelay)):n.trigger("gridRowDrop",t);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"finalizeReorder",value:(t=Wr()(Vr.a.mark((function e(t){var n,r,i,o;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.grid,r=n.store,i=t.records,t.valid=t.valid&&!i.some((function(e){return!r.includes(e)})),!t.valid){e.next=14;break}if(!r.tree){e.next=12;break}return i=i.filter((function(e){return!e.parent||!i.includes(e.parent)})),e.next=8,t.parent.tryInsertChild(i,t.insertBefore);case 8:o=e.sent,t.valid=!1!==o,e.next=13;break;case 12:r.insert(t.insertBefore?r.indexOf(t.insertBefore):r.count,i);case 13:r.clearSorters();case 14:t.finalize(t.valid),n.element.classList.remove("b-row-reordering");case 16:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"onReset",value:function(){var e=this.grid.features.cellEdit;this.grid.element.classList.remove("b-row-reordering"),e&&(e.disabled=this.cellEditDisabledState),Cr.removeClsGlobally(this.grid.element,"b-row-reordering-target-parent")}},{key:"render",value:function(){this.init()}}],[{key:"$name",get:function(){return"RowReorder"}},{key:"defaultConfig",get:function(){return{hoverExpandTimeout:1e3,finalizeDelay:300}}},{key:"pluginConfig",get:function(){return{after:["render"]}}}]),i}(_a(qr));function up(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return cp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return cp(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function cp(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function lp(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}sp.featureClass="",sp._$name="RowReorder",fv.registerFeature(sp,!1),fv.registerFeature(sp,!0,"Gantt");var fp=function(e){fe()(n,e);var t=lp(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e,t){we()(pe()(n.prototype),"construct",this).call(this,e,t),Object.assign(this,{grid:e,find:"",hitEls:[]})}},{key:"doDestroy",value:function(){this.clear(!0),we()(pe()(n.prototype),"doDestroy",this).call(this)}},{key:"doDisable",value:function(e){e&&this.clear(),we()(pe()(n.prototype),"doDisable",this).call(this,e)}},{key:"search",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this;if(!e)return i.clear();if((r||e!==i.find)&&!i.disabled){var o=i.grid,a=i.store,s=o.columns.visibleColumns.filter((function(e){return!1!==e.searchable})),u=s.map((function(e){return e.field})),c=a.search(e,u),l=1;if(Object.assign(i,{foundMap:{},prevFound:i.found,found:c,find:e}),i.clearHits(),c){null===(t=i.hitColumns)||void 0===t||t.forEach((function(e){return e.disableHtmlEncode=!1})),i.hitColumns=[];var f,d=up(c);try{for(d.s();!(f=d.n()).done;){var h=f.value;i.foundMap[h.field+"-"+h.id]=l++;var v=o.columns.get(h.field);if(v&&(v.disableHtmlEncode=!0,i.hitColumns.push(v)),l>1e3)break}}catch(e){d.e(e)}finally{d.f()}return i.listenersInitialized||(o.rowManager.on({rendercell:i.renderCell},i),a.on(ke()({},"refresh".concat(o.asyncEventSuffix),i.onStoreRefresh),i),i.listenersInitialized=!0),o.refreshRows(),o.trigger("search",{grid:o,find:e,found:c}),n&&!i.isHitFocused&&i.gotoNextHit(!0),c}}}},{key:"clearHits",value:function(){var e,t=up(Cr.children(this.grid.element,".b-search-hit"));try{for(t.s();!(e=t.n()).done;){var n=e.value;n.classList.remove("b-search-hit"),n.classList.remove("b-search-hit-cell");var r=qo.get(n).row;n._content=null,r.renderCell(n)}}catch(e){t.e(e)}finally{t.f()}}},{key:"clear",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=t.grid;t.foundMap&&delete t.foundMap,delete t.find,t.clearHits(),t.listenersInitialized&&(n.rowManager.un({rendercell:t.renderCell},t),t.store.un({refresh:t.onStoreRefresh},t),t.listenersInitialized=!1),e||n.trigger("clearSearch",{grid:n})}},{key:"gotoNextHit",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=this;if(null===(e=n.found)||void 0===e?void 0:e.length){var r=n.grid,i=r.focusedCell||r.lastFocusedCell,o=i&&!t?r.store.indexOf(i.id):-1,a=n.found.findIndex((function(e){return e.index>o}));-1!==a&&n.gotoHit(a)}}},{key:"gotoPrevHit",value:function(){var e;if(null===(e=this.found)||void 0===e?void 0:e.length)for(var t=this.grid,n=this.found,r=t.focusedCell||t.lastFocusedCell,i=r?t.store.indexOf(r.id):0,o=n.length-1;o--;o>=0){if(n[o].index<i){this.gotoHit(o);break}}}},{key:"gotoHit",value:function(e){var t=this.grid,n=this.found[e];return n&&t.focusCell({field:n.field,id:n.id}),Boolean(n)}},{key:"gotoFirstHit",value:function(){this.gotoHit(0)}},{key:"gotoLastHit",value:function(){this.gotoHit(this.found.length-1)}},{key:"renderCell",value:function(e){var t,n=e.cellElement,r=e.column,i=e.record,o=e.value,a=e.cellContent,s=null===(t=this.foundMap)||void 0===t?void 0:t[r.field+"-"+i.id];if(s){n.classList.add("b-search-hit");var u=Cr.down(n,".b-grid-cell-value")||n,c=String(this.find).toLowerCase();if(String(o).toLowerCase()===c)u.innerHTML='<span class="b-search-hit-text">'.concat(a,'</span><div class="b-search-hit-cell-badge">').concat(s,"</div>");else{var l=String(this.find).toLowerCase(),f=a&&a.toLowerCase().indexOf(l);if(f>-1){var d=f+l.length,h=a.slice(f,d);u.innerHTML="".concat(a.slice(0,f),'<span class="b-search-hit-text">').concat(h,"</span>").concat(a.slice(d),'<div class="b-search-hit-cell-badge">').concat(s,"</div>")}else n.classList.add("b-search-hit-cell")}this.hitEls.push(n)}}},{key:"populateCellMenu",value:function(e){var t=e.column,n=e.record,r=e.items,i=this;t.searchable&&(r.search={text:"L{searchForValue}",localeClass:i,icon:"b-fw-icon b-icon-search",cls:"b-separator",name:"search",weight:200,disabled:i.disabled,onItem:function(){var e=window.getSelection().toString();e||(e=n[t.field]),i.search(e)}})}},{key:"onElementKeyDown",value:function(e){this.find&&""!==this.find&&("F3"===e.key||"g"===e.key.toLowerCase()&&(e.ctrlKey||e.metaKey))&&(e.preventDefault(),e.shiftKey?this.gotoPrevHit():this.gotoNextHit())}},{key:"onStoreRefresh",value:function(){this.search(this.find,!1,!0)}},{key:"store",get:function(){return this.grid.store}},{key:"foundCount",get:function(){var e,t;return null!==(e=null===(t=this.found)||void 0===t?void 0:t.length)&&void 0!==e?e:0}},{key:"isHitFocused",get:function(){var e=this.grid,t=e.focusedCell?e.store.indexOf(e.focusedCell.id):-1,n=e.focusedCell?e.columns.getById(e.focusedCell.columnId):null;return-1!==t&&this.found.some((function(e){return e.index===t&&n&&e.field===n.field}))}}],[{key:"$name",get:function(){return"Search"}},{key:"pluginConfig",get:function(){return{chain:["populateCellMenu","onElementKeyDown"]}}}]),n}(qr);function dp(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return hp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return hp(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function hp(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function vp(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}fp.featureClass="b-search",fp._$name="Search",fv.registerFeature(fp);var pp=function(e){fe()(n,e);var t=vp(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e,t){t=this.processConfig(t),this.grid=e,this.bindStore(e.store),we()(pe()(n.prototype),"construct",this).call(this,e,t)}},{key:"processConfig",value:function(e){return"string"==typeof e||Array.isArray(e)?{field:e,ascending:null}:e}},{key:"setConfig",value:function(e){we()(pe()(n.prototype),"setConfig",this).call(this,this.processConfig(e))}},{key:"bindStore",value:function(e){this.detachListeners("store"),e.on({name:"store",sort:"syncHeaderSortState",thisObj:this})}},{key:"doDestroy",value:function(){we()(pe()(n.prototype),"doDestroy",this).call(this)}},{key:"syncHeaderSortState",value:function(){var e=this,t={};if(!e.grid.isConfiguring){for(var n,r=e.store.sorters,i=r.length,o=new An,a=0;a<i;a++){var s=r[a];s.field&&(t[s.field]={ascending:s.ascending,sortIndex:a+1})}var u,c=dp(e.grid.columns.bottomColumns);try{for(c.s();!(u=c.n()).done;){var l=u.value,f=l.element;if(f){var d,h=null===(d=l.textWrapper)||void 0===d?void 0:d.dataset;(null==h?void 0:h.sortIndex)&&delete h.sortIndex,o.value=f.classList,!1!==l.sortable?(o.add(e.sortableCls),(n=t[l.field])?(i>1&&h&&(h.sortIndex=n.sortIndex),o.add(e.sortedCls),n.ascending?(o.add(e.sortedAscCls),o.remove(e.sortedDescCls)):(o.add(e.sortedDescCls),o.remove(e.sortedAscCls))):(o.remove(e.sortedCls),o["b-group"]||(o.remove(e.sortedAscCls),o.remove(e.sortedDescCls)))):o.remove(e.sortableCls),Cr.syncClassList(f,o)}}}catch(e){c.e(e)}finally{c.f()}}}},{key:"populateHeaderMenu",value:function(e){var t=e.column,n=e.items,r=this,i=r.store,o="function"==typeof t.sortable?t.sortable:t.field;if(!1!==t.sortable&&(n.sortAsc={text:"L{sortAscending}",localeClass:r,icon:"b-fw-icon b-icon-sort-asc",name:"sortAsc",cls:"b-separator",weight:300,disabled:r.disabled,onItem:function(){return i.sort(o,!0)}},n.sortDesc={text:"L{sortDescending}",localeClass:r,icon:"b-fw-icon b-icon-sort-desc",name:"sortDesc",weight:310,disabled:r.disabled,onItem:function(){return i.sort(o,!1)}},r.multiSort&&r.grid.columns.records.some((function(e){return e.sortable})))){var a=i.sorters.find((function(e){return e.field===t.field}));n.multiSort={text:"L{multiSort}",localeClass:r,icon:"b-fw-icon b-icon-sort",name:"multiSort",weight:320,disabled:r.disabled,menu:{addSortAsc:{text:a?"L{toggleSortAscending}":"L{addSortAscending}",localeClass:r,icon:"b-fw-icon b-icon-sort-asc",name:"addSortAsc",disabled:a&&(null==a?void 0:a.ascending),weight:330,onItem:function(){return i.addSorter(o,!0)}},addSortDesc:{text:a?"L{toggleSortDescending}":"L{addSortDescending}",localeClass:r,icon:"b-fw-icon b-icon-sort-desc",name:"addSortDesc",disabled:a&&!a.ascending,weight:340,onItem:function(){return i.addSorter(o,!1)}},removeSorter:{text:"L{removeSorter}",localeClass:r,icon:"b-fw-icon b-icon-remove",name:"removeSorter",weight:350,disabled:!a,onItem:function(){return i.removeSorter(o)}}}}}}},{key:"getColumnDragToolbarItems",value:function(e,t){var n=this,r=n.store,i=n.disabled;if(!1!==e.sortable){t.push({text:"L{sortAscendingShort}",group:"L{sort}",localeClass:n,icon:"b-icon b-icon-sort-asc",name:"sortAsc",cls:"b-separator",weight:105,disabled:i,onDrop:function(e){var t=e.column;return r.sort(t.field,!0)}}),t.push({text:"L{sortDescendingShort}",group:"L{sort}",localeClass:n,icon:"b-icon b-icon-sort-desc",name:"sortDesc",weight:105,disabled:i,onDrop:function(e){var t=e.column;return r.sort(t.field,!1)}});var o=r.sorters.find((function(t){return t.field===e.field}));Array.prototype.push.apply(t,[{text:"L{addSortAscendingShort}",group:"L{multiSort}",localeClass:n,icon:"b-icon b-icon-sort-asc",name:"multisortAddAsc",disabled:i||o&&o.ascending,weight:105,onDrop:function(e){var t=e.column;return r.addSorter(t.field,!0)}},{text:"L{addSortDescendingShort}",group:"L{multiSort}",localeClass:n,icon:"b-icon b-icon-sort-desc",name:"multisortAddDesc",disabled:i||o&&!o.ascending,weight:105,onDrop:function(e){var t=e.column;return r.addSorter(t.field,!1)}},{text:"L{removeSorterShort}",group:"L{multiSort}",localeClass:n,icon:"b-icon b-icon-remove",name:"multisortRemove",weight:105,disabled:i||!o,onDrop:function(e){var t=e.column;return r.removeSorter(t.field)}}])}return t}},{key:"onElementClick",value:function(e){var t=this.store,n=e.target,r=Cr.up(n,".b-grid-header.b-sortable"),i=null==r?void 0:r.dataset.column;if(!this.ignoreRe.test(n.className)&&!this.disabled&&r&&i){var o=this.grid.columns.getById(r.dataset.columnId);if(t.isGrouped&&t.groupers.find((function(e){return e.field===i}))&&!e.shiftKey)return;if(o.sortable&&!e.shiftKey)if(e.ctrlKey&&e.altKey)t.removeSorter(o.field);else{var a=o.field;"function"==typeof o.sortable?a={field:o.field,fn:o.sortable}:"object"===l()(o.sortable)&&((a=o.sortable).field||(a.field=a.property||o.field)),t.sort(a,null,e.ctrlKey)}}}},{key:"renderHeader",value:function(){this.syncHeaderSortState()}},{key:"field",set:function(e){var t=this.grid.columns.get(e);t&&"object"===l()(t.sortable)&&(t.sortable.field=t.sortable.property||e,e=t.sortable),this.store.sort(e,this.ascending)}},{key:"store",get:function(){return this.grid.store}}],[{key:"$name",get:function(){return"Sort"}},{key:"defaultConfig",get:function(){return{multiSort:!0,ignoreRe:new RegExp(["b-grid-header-resize-handle","b-filter-icon"].join("|")),sortableCls:"b-sortable",sortedCls:"b-sort",sortedAscCls:"b-asc",sortedDescCls:"b-desc"}}},{key:"pluginConfig",get:function(){return{chain:["onElementClick","populateHeaderMenu","getColumnDragToolbarItems","renderHeader"]}}}]),n}(qr);function gp(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}pp.featureClass="b-sort",pp._$name="Sort",fv.registerFeature(pp,!0);var yp=function(e){fe()(n,e);var t=gp(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e,t){we()(pe()(n.prototype),"construct",this).call(this,e,t),e.rowManager.on({renderrow:"onRenderRow",thisObj:this})}},{key:"doDisable",value:function(e){this.isConfiguring||this.client.refreshRows(),we()(pe()(n.prototype),"doDisable",this).call(this,e)}},{key:"onRenderRow",value:function(e){var t=e.row;this.disabled||t.addCls(t.dataIndex%2==0?"b-even":"b-odd")}}],[{key:"$name",get:function(){return"Stripe"}}]),n}(qr);function mp(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}yp._$name="Stripe",fv.registerFeature(yp);var kp=Promise.resolve(),bp=function(e){fe()(u,e);var t,n,r,i,o,a,s=mp(u);function u(){return v()(this,u),s.apply(this,arguments)}return g()(u,[{key:"construct",value:function(e,t){we()(pe()(u.prototype),"construct",this).call(this,e,t);var n=e.columns.find((function(e){return e instanceof nv}));Object.assign(this,{grid:e,rowManager:e.rowManager,treeColumn:n}),this.bindStore(e.store)}},{key:"doDisable",value:function(e){}},{key:"bindStore",value:function(e){this.detachListeners("store"),e.on({name:"store",beforeLoadChildren:"onBeforeLoadChildren",loadChildren:"onLoadChildren",loadChildrenException:"onLoadChildrenException",beforeToggleNode:"onBeforeToggleNode",thisObj:this})}},{key:"toggleCollapse",value:(a=Wr()(Vr.a.mark((function e(t,n){var r,i,o,a,s,u,c,l,f=arguments;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return f.length>2&&void 0!==f[2]&&f[2],i=(r=this).store,o=r.grid,a=o.rowManager,s=i.getById(t),u=s.instanceMeta(i),e.next=4,i.toggleCollapse(s,n);case 4:if(!e.sent){e.next=10;break}(c=a.getRowFor(s))&&(l=c.getCell(r.treeColumn.id))&&c.renderCell(l,s),r.isTogglingNode||(o.element.classList.add("b-toggling-node"),r.isTogglingNode=!0,r.requestAnimationFrame((function(){o.element.classList.remove("b-toggling-node"),r.isTogglingNode=!1}))),o.trigger(u.collapsed?"collapseNode":"expandNode",{source:o,record:s}),o.trigger("toggleNode",{source:o,record:s,collapse:n});case 10:case"end":return e.stop()}}),e,this)}))),function(e,t){return a.apply(this,arguments)})},{key:"collapse",value:(o=Wr()(Vr.a.mark((function e(t){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.toggleCollapse(t,!0));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"expand",value:(i=Wr()(Vr.a.mark((function e(t){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.toggleCollapse(t,!1));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"onBeforeToggleNode",value:function(e){var t=e.record,n=e.collapse;this.grid.trigger("beforeToggleNode",{record:t,collapse:n})}},{key:"onBeforeLoadChildren",value:function(e){var t=e.source,n=e.params,r=t.getById(n[t.modelClass.idField]),i=this.grid.rowManager.getRowFor(r);i&&i.addCls("b-loading-children")}},{key:"onLoadChildren",value:function(e){var t=e.source,n=e.params,r=t.getById(n[t.modelClass.idField]),i=this.grid.rowManager.getRowFor(r);i&&i.removeCls("b-loading-children")}},{key:"onLoadChildrenException",value:function(e){var t=e.record,n=this.grid.rowManager.getRowFor(t);n&&n.removeCls("b-loading-children")}},{key:"expandOrCollapseAll",value:function(){var e=this,t=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.store.rootNode,r=this.grid,i=this.store,o=[],a=[];return r.trigger("beforeToggleAllNodes",{source:r,collapse:t}),i.suspendEvents(),i.traverse((function(n){var r=n.instanceMeta(i);n.isLeaf||(t&&!r.collapsed?(e.toggleCollapse(n,!0,!0),a.push.apply(a,d()(n.children))):!t&&r.collapsed&&(Array.isArray(n.children)&&a.push.apply(a,d()(n.children)),o.push(e.toggleCollapse(n,!1,!0))))}),n,n===i.rootNode),i.resumeEvents(),(t?kp:Promise.all(o)).then((function(){r.refreshRows(t),a.length&&(t?i.trigger("remove",{records:a,isCollapse:!0,isCollapseAll:!0}):i.trigger("add",{records:a,isExpand:!0,isExpandAll:!0})),r.trigger("toggleAllNodes",{source:r,collapse:t})}))}},{key:"collapseAll",value:(r=Wr()(Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.expandOrCollapseAll(!0));case 1:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"expandAll",value:(n=Wr()(Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.expandOrCollapseAll(!1));case 1:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"expandTo",value:(t=Wr()(Vr.a.mark((function e(t){var n,r,i,o,a;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!1!==(r=(n=this).store.getById(t)).instanceMeta(n.store).hiddenByCollapse){e.next=3;break}return e.abrupt("return");case 3:for(i=!1,o=r.parent,a=[];o&&!o.isRoot;)a.push(o),o=o.parent;return e.next=8,a.reverse().forEach(function(){var e=Wr()(Vr.a.mark((function e(t){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.instanceMeta(n.store).collapsed&&(i=!0),e.next=3,n.toggleCollapse(t,!1,!0);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 8:return i&&n.grid.refreshRows(),e.next=11,n.grid.scrollRowIntoView(r);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"onElementClick",value:function(e){var t=e.target,n=this.grid.getCellDataFromEvent(e),r=t.closest(".b-tree-expander");(r||this.expandOnCellClick&&n&&n.record.isParent)&&(r&&e.preventDefault(),this.toggleCollapse(n.record))}},{key:"onElementKeyDown",value:function(e){e.target===this.client.focusElement&&" "===e.key&&(e.preventDefault(),this.toggleCollapse(this.grid.focusedCell.id))}},{key:"navigateRight",value:function(e){var t=this.grid,n=t.focusedCell;if(n){var r=t.store.getById(n.id);if(t.columns.getById(n.columnId).tree&&(e.shiftKey||1===t.columns.count))return r.isParent&&r.instanceMeta(t.store).collapsed?this.expand(r):t.navigateDown(e),!1}}},{key:"navigateLeft",value:function(e){var t=this.grid,n=t.focusedCell;if(n){var r=t.store.getById(n.id);if(t.columns.getById(n.columnId).tree&&(e.shiftKey||1===t.columns.count))return r.isParent&&!r.instanceMeta(t.store).collapsed?this.collapse(r):r.parent&&t.focusCell({id:r.parent.id,columnId:n.columnId}),!1}}},{key:"store",get:function(){return this.grid.store}}],[{key:"$name",get:function(){return"Tree"}},{key:"defaultConfig",get:function(){return{expandOnCellClick:!1}}},{key:"pluginConfig",get:function(){return{assign:["collapseAll","expandAll","collapse","expand","expandTo","toggleCollapse"],before:["navigateRight","navigateLeft"],chain:["onElementClick","onElementKeyDown","bindStore"]}}}]),u}(qr.mixin(_a));bp.featureClass="b-tree",bp._$name="Tree",fv.registerFeature(bp,!1,"Grid"),fv.registerFeature(bp,!0,"TreeGrid");var wp={all:"all",visible:"visible"},Cp={A6:{width:4.13,height:5.81},A5:{width:5.81,height:8.25},A4:{width:8.25,height:11.69},A3:{width:11.69,height:16.49},Legal:{width:8.5,height:14},Letter:{width:8.5,height:11}},Sp={portrait:"portrait",landscape:"landscape"},Dp={pdf:"pdf",png:"png"};function Rp(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var xp=function(e){return function(e){fe()(n,e);var t=Rp(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(){var e;this.inConstruct=!0;for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];(e=we()(pe()(n.prototype),"construct",this)).call.apply(e,[this].concat(r)),this.inConstruct=!1}},{key:"buildLocalizedItems",value:function(){return[]}},{key:"updateLocalizedItems",value:function(){var e=this;if(e.store&&!e.inConstruct){var t=e.value;e.store.data=e.buildLocalizedItems(),e.value=null,e.value=t,e.syncInputFieldValue(!0)}}},{key:"updateLocalization",value:function(){this.updateLocalizedItems(),we()(pe()(n.prototype),"updateLocalization",this).call(this)}},{key:"items",set:function(e){!0===e&&(e=this.buildLocalizedItems()),sc()(pe()(n.prototype),"items",e,this,!0)},get:function(){return we()(pe()(n.prototype),"items",this)}}],[{key:"$name",get:function(){return"LocalizableComboItems"}},{key:"defaultConfig",get:function(){return{items:!0}}}]),n}(e||Xf)};function Ep(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var Tp=function(e){fe()(n,e);var t=Ep(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"$name",get:function(){return"LocalizableCombo"}},{key:"type",get:function(){return"localizablecombo"}}]),n}(xp(Xf));function Mp(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Tp.initClass(),Tp._$name="LocalizableCombo";var Ap=function(e){fe()(n,e);var t=Mp(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"buildLocalizedItems",value:function(){return[{id:wp.all,text:this.L("L{all}")},{id:wp.visible,text:this.L("L{visible}")}]}}],[{key:"$name",get:function(){return"ExportRowsCombo"}},{key:"type",get:function(){return"ExportRowsCombo"}},{key:"defaultConfig",get:function(){return{editable:!1}}}]),n}(Tp);function Pp(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Ap.initClass(),Ap._$name="ExportRowsCombo";var Ip=function(e){fe()(n,e);var t=Pp(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"buildLocalizedItems",value:function(){return[{id:Sp.portrait,text:this.L("L{portrait}")},{id:Sp.landscape,text:this.L("L{landscape}")}]}}],[{key:"$name",get:function(){return"ExportOrientationCombo"}},{key:"type",get:function(){return"ExportOrientationCombo"}},{key:"defaultConfig",get:function(){return{editable:!1}}}]),n}(Tp);function Op(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Ip.initClass(),Ip._$name="ExportOrientationCombo";var Fp=function(e){fe()(n,e);var t=Op(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this,r=e.client;if(!r)throw new Error("`client` config is required");var i,o=t.buildDialogItems(e);e.items?Array.isArray(e.items)?(i=e.items).push.apply(i,d()(o)):o.forEach((function(t){e.items[t.ref]=t,delete t.ref})):e.items=o;e.width=e.width||t.L("L{width}"),we()(pe()(n.prototype),"construct",this).call(this,e),t.widgetMap.exportButton.on("click",t.onExportClick,t),t.widgetMap.cancelButton.on("click",t.onCancelClick,t),rt.on({locale:"onLocaleChange",prio:-1,thisObj:t})}},{key:"getDefaultFieldValues",value:function(e){var t=an.copyProperties({},e,this.fieldProperties);return an.copyPropertiesIf(t,this.getDefaultConfiguration(),this.fieldProperties)}},{key:"buildDialogItems",value:function(e){var t=this,n=this,r=e.exporters,i=e.client,o=n.getDefaultFieldValues(e),a=o.exporterType,s=o.orientation,u=o.paperFormat,c=o.fileFormat,l=o.alignRows,f=o.rowsRange,d=o.repeatHeader,h=n.L("L{ExportDialog.labelWidth}");function v(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(e){return e};return Object.keys(e).map((function(e){return{id:e,text:t(e)}}))}return n.columnsStore=i.columns.chain((function(e){return e.isLeaf&&e.exportable})),[{labelWidth:h,type:"combo",ref:"columnsField",label:"L{ExportDialog.columns}",store:n.columnsStore,value:n.columnsStore.allRecords,valueField:"id",displayField:"text",multiSelect:!0},{labelWidth:h,type:"exportrowscombo",ref:"rowsRangeField",label:"L{ExportDialog.rows}",value:f},{labelWidth:h,type:"localizablecombo",ref:"exporterTypeField",label:"L{ExportDialog.exporterType}",editable:!1,value:a,buildLocalizedItems:function(){return r.map((function(e){return{id:e.type,text:n.optionalL(e.title,t)}}))},onChange:function(e){var t=e.value;this.owner.widgetMap.alignRowsField.hidden="singlepage"===t,this.owner.widgetMap.repeatHeaderField.hidden="multipagevertical"!==t}},{labelWidth:h,type:"checkbox",ref:"alignRowsField",label:"L{ExportDialog.alignRows}",checked:l,hidden:"singlepage"===a},{labelWidth:h,type:"checkbox",ref:"repeatHeaderField",label:"L{ExportDialog.repeatHeader}",localeClass:this,value:d,hidden:"multipagevertical"!==a},{labelWidth:h,type:"combo",ref:"fileFormatField",label:"L{ExportDialog.fileFormat}",localeClass:this,editable:!1,value:c,items:v(Dp,(function(e){return e.toUpperCase()})),onChange:function(e){var t=e.value,r=e.oldValue;if(n.hidePNGMultipageOption){var i=n.widgetMap.exporterTypeField,o=i.store.find((function(e){return"singlepage"===e.id}));t===Dp.png&&o?(this._previousDisabled=i.disabled,i.disabled=!0,this._previousValue=i.value,i.value="singlepage"):r===Dp.png&&this._previousValue&&(i.disabled=this._previousDisabled,i.value=this._previousValue)}}},{labelWidth:h,type:"combo",ref:"paperFormatField",label:"L{ExportDialog.paperFormat}",editable:!1,value:u,items:v(Cp)},{labelWidth:h,type:"exportorientationcombo",ref:"orientationField",label:"L{ExportDialog.orientation}",value:s}]}},{key:"onLocaleChange",value:function(){var e=this.L("L{labelWidth}");this.width=this.L("L{width}"),this.eachWidget((function(t){t instanceof Pf&&(t.labelWidth=e)}))}},{key:"onExportClick",value:function(){var e=this.values;this.trigger("export",{values:e})}},{key:"onCancelClick",value:function(){this.trigger("cancel"),this.hide()}},{key:"fieldProperties",get:function(){return["exporterType","orientation","fileFormat","paperFormat","alignRows","rowsRange","repeatHeader"]}},{key:"values",get:function(){var e=/field/i,t={};return this.eachWidget((function(n){e.test(n.ref)&&(t[n.ref.replace(e,"")]=n instanceof ad?n.checked:n.value)})),t}}],[{key:"$name",get:function(){return"ExportDialog"}},{key:"defaultConfig",get:function(){return{autoShow:!1,autoClose:!1,closable:!0,centered:!0,client:null,hidePNGMultipageOption:!0,exporterType:"singlepage",orientation:"portrait",paperFormat:"A4",fileFormat:"pdf",alignRows:!1,rowsRange:"all",title:"L{exportSettings}",defaults:{localeClass:this},bbar:{defaults:{type:"button",localeClass:this},items:{exportButton:{color:"b-green",text:"L{ExportDialog.export}",weight:100},cancelButton:{color:"b-gray",text:"L{ExportDialog.cancel}",weight:200}}}}}}]),n}(zl);Fp._$name="ExportDialog";var Lp=n(16),jp=n.n(Lp),_p=n(18),Bp=n.n(_p);function Hp(){var e=El()(['\n            <!DOCTYPE html>\n            <html class="','" style="width: ',"in; height: ",'in;">\n                <head>\n                    <meta content="text/html; charset=UTF-8" http-equiv="Content-Type" />\n                    <title>',"</title>\n                    ",'\n                </head>\n                <body class="b-export ','" style="width: ',"in; height: ","in; ",'">\n                    <div class="b-export-content">\n                        ','\n                        <div class="b-export-body"><div class="b-export-viewport">',"</div></div>\n                        ","\n                    </div>\n                </body>\n            </html>"]);return Hp=function(){return e},e}function $p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var Np=function(e){fe()(u,e);var t,n,r,i,o,a,s=$p(u);function u(){return v()(this,u),s.apply(this,arguments)}return g()(u,[{key:"pageTpl",value:function(e){var t=e.title,n=e.header,r=e.footer,i=e.styles,o=e.htmlClasses,a=e.bodyStyle,s=e.bodyClasses,u=void 0===s?[]:s,c=e.paperHeight,l=e.paperWidth,f=e.html;return u.push("b-".concat(this.constructor.type)),Cr.scrollBarWidth?u.push("b-visible-scrollbar"):u.push("b-overlay-scrollbar"),j.a.isChrome?u.push("b-chrome"):j.a.isSafari?u.push("b-safari"):j.a.isFirefox?u.push("b-firefox"):j.a.isIE11?u.push("b-ie"):j.a.isEdge&&u.push("b-edge"),Iu.tpl(Hp(),o,l,c,t,i.join(""),u.join(" "),l,c,a,n&&'<div class="b-export-header" style="width: 100%">'.concat(n,"</div>"),f,r&&'<div class="b-export-footer" style="width: 100%">'.concat(r,"</div>"))}},{key:"getStyleTagURLConverter",value:function(e){return function(t,n){var r;try{var i;/^#/.test(n)?r=t:(i=!0===e?window.location.href:this.keepPathName?window.location.href.replace(window.location.origin,e):e,r="url('".concat(new URL(n,i).href,"')"))}catch(e){r=t}return r}.bind(this)}},{key:"saveState",value:function(e){var t=e.client;this.state=t.state;var n=t.tbar,r=t.bbar;n&&(this.state.tbar_hidden=n.hidden,n.hide(!1)),r&&(this.state.bbar_hidden=r.hidden,r.hide(!1))}},{key:"restoreState",value:(a=Wr()(Vr.a.mark((function e(t){var n,r,i,o,a;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.client,r=[],i=new Set,o=n.tbar,a=n.bbar,i.add(n.scrollable.on({scrollStart:function(){r.push(n.scrollable.await("scrollEnd"))}})),n.eachSubGrid((function(e){var t=e.header,n=e.scrollable;i.add(n.on({scrollStart:function(){r.push(n.await("scrollEnd"))}})),i.add(t.scrollable.on({scrollStart:function(){r.push(t.scrollable.await("scrollEnd"))}}))})),o&&(o.hidden=this.state.tbar_hidden,delete this.state.tbar_hidden),a&&(a.hidden=this.state.bbar_hidden,delete this.state.bbar_hidden),n.state=this.state,e.next=9,Promise.all(r);case 9:i.forEach((function(e){return e()}));case 10:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"beforeExport",value:function(){this.element=document.createElement("div")}},{key:"cloneElement",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.element,n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];n&&(t.innerHTML=""),j.a.isChrome?t.appendChild(e.cloneNode(!0)):t.innerHTML=e.outerHTML,Cr.removeEachSelector(t,".b-grid-row");var r=t.querySelector(".b-gridbase > .b-mask");r&&r.remove()}},{key:"measureElement",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";e instanceof HTMLElement&&(e=e.outerHTML);var t=Cr.createElement({parent:document.body,style:{visibility:"hidden",position:"absolute"},html:'<div style="height: 1px"></div>'.concat(e,'<div style="height: 1px"></div>')}),n=t.offsetHeight-2;return t.remove(),n}},{key:"prepareHTML",value:function(e){e instanceof HTMLElement&&(e=e.outerHTML);for(var t=Cr.createElement({parent:document.body,style:{visibility:"hidden",position:"absolute"},html:e}),n=t.querySelectorAll("img"),r=0,i=n.length;r<i;r++)n[r].setAttribute("src",n[r].src);var o=t.innerHTML;return t.remove(),o}},{key:"createPlaceholder",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return t&&(e.innerHTML=""),Cr.createElement({parent:e,id:zi.generateId("export")})}},{key:"getVirtualScrollerHeight",value:function(e){var t=0;return e.eachSubGrid((function(e){e.overflowingHorizontally&&(t=Cr.scrollBarWidth)})),0===t?t:t+1}},{key:"inchToPx",value:function(e){return 96*e}},{key:"getScaleValue",value:function(e,t){return Math.floor(1e4*e/t)/1e4}},{key:"getVisibleRowsCount",value:function(e){var t=e.rowManager,n=t.rows.indexOf(t.firstVisibleRow),r=t.rows.indexOf(t.lastVisibleRow);return-1!==n?-1===r?e.store.count-n:r-n+1:e.store.count}},{key:"export",value:(o=Wr()(Vr.a.mark((function e(t){var n,r;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=this).beforeExport(),n.saveState(t),e.next=5,n.prepareComponent(t);case 5:return e.prev=5,e.next=8,n.getPages(t);case 8:r=e.sent;case 9:return e.prev=9,e.next=12,n.restoreComponent(t);case 12:return n.stylesheets=null,e.next=15,new Promise((function(e){return n.requestAnimationFrame(e)}));case 15:return e.next=17,n.restoreState(t);case 17:return e.finish(9);case 18:return e.abrupt("return",r);case 19:case"end":return e.stop()}}),e,this,[[5,,9,18]])}))),function(e){return o.apply(this,arguments)})},{key:"getPages",value:(i=Wr()(Vr.a.mark((function e(t){var n,r,i;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.pagesExtractor(t),r=[];case 1:return e.next=3,n.next();case 3:if(e.t0=i=e.sent,!e.t0){e.next=6;break}e.t0=!i.done;case 6:if(!e.t0){e.next=10;break}r.push(i.value),e.next=1;break;case 10:return e.abrupt("return",r);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"adjustRowBuffer",value:function(e){var t=this.exportMeta.contentHeight,n=e.rowManager;this.oldRowManagerConfig={prependRowBuffer:n.prependRowBuffer,appendRowBuffer:n.appendRowBuffer};var r=Math.ceil(t/n.rowOffsetHeight);n.prependRowBuffer=r,n.appendRowBuffer=r,e.renderRows(!1),e.rowManager.jumpToPosition(e.scrollable.y)}},{key:"restoreRowBuffer",value:function(e){e.rowManager.prependRowBuffer=this.oldRowManagerConfig.prependRowBuffer,e.rowManager.appendRowBuffer=this.oldRowManagerConfig.appendRowBuffer}},{key:"prepareComponent",value:(r=Wr()(Vr.a.mark((function e(t){var n,r,i,o,a,s,u,c;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this,r=t.client,i=t.columns,o=t.rowsRange,a=t.keepRegionSizes,s=n.exportMeta={totalWidth:0,totalHeight:0-n.getVirtualScrollerHeight(r),subGrids:{}},r.columns.forEach((function(e){i.includes(e.id)?e.show():e.hide()})),!(r.rowManager.rowCount>0)){e.next=13;break}if(o!==wp.all){e.next=9;break}return s.firstVisibleDataIndex=r.rowManager.rows[0].dataIndex,e.next=7,r.scrollRowIntoView(r.store.first,{block:"start"});case 7:e.next=13;break;case 9:return u=s.firstVisibleDataIndex=r.rowManager.rows.find((function(e){return e.bottom>r.scrollable.y})).dataIndex,e.next=12,r.scrollRowIntoView(r.store.getAt(u),{block:"start"});case 12:t.alignRows=!0;case 13:this.cloneElement(r.element),c=n.element,r.eachSubGrid((function(e){var t,i,o=n.createPlaceholder(c.querySelector('[id="'.concat(e.id,'"]')),!1);i=(null==a?void 0:a[e.region])?e.element.offsetWidth:e.columns.visibleColumns.reduce((function(e,t){return"number"==typeof t.width?e+=t.width:e+=r.getHeaderElement(t.id).offsetWidth,e}),0),s.totalWidth+=i;var u=(null===(t=e.splitterElement)||void 0===t?void 0:t.offsetWidth)||0;s.totalWidth+=u,s.subGrids[e.region]={id:e.id,headerId:e.header&&e.header.id||null,footerId:e.footer&&e.footer.id||null,rows:[],splitterWidth:u,placeHolder:o,width:i}}));case 16:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"prepareExportElement",value:function(){var e=this.element,t=this.exportMeta;return Object.values(t.subGrids).forEach((function(t){var n=t.width;[t.id,t.headerId,t.footerId].forEach((function(t){if(t){var r=e.querySelector('[id="'.concat(t,'"]'));r&&(r.style.width="".concat(n,"px"),r.style.flex="")}}))})),e.innerHTML}},{key:"restoreComponent",value:(n=Wr()(Vr.a.mark((function e(t){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return n.apply(this,arguments)})},{key:"scrollRowIntoView",value:(t=Wr()(Vr.a.mark((function e(t,n){var r=this;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.scrollRowIntoView(t.store.getAt(n),{block:"start"});case 2:return e.next=4,new Promise((function(e){return r.requestAnimationFrame(e)}));case 4:case"end":return e.stop()}}),e)}))),function(e,n){return t.apply(this,arguments)})},{key:"stylesheets",get:function(){var e=this,t=this;if(t._stylesheets)return t._stylesheets;var n=t.translateURLsToAbsolute,r=window.origin,i=Array.from(document.querySelectorAll('link[rel="stylesheet"], style')),o=[];return i.forEach((function(i){var a,s;(i=i.cloneNode(!0),n&&i.href)&&(a=!0===n?i.href:e.keepPathName?i.href.replace(r,n):new URL(i.getAttribute("href"),n),i.setAttribute("href",a));if(s=j.a.isIE11&&i.styleSheet&&/style/i.test(i.tagName)?'<style type="text/css">'.concat(i.styleSheet.cssText,"</style>"):i.outerHTML,n&&/style/i.test(i.tagName)){var u=t.getStyleTagURLConverter(n);s=s.replace(/url\(['"]?(.+?)['"]?\)/g,u)}o.push(s)})),o.push("<style>\n                body, html {\n                    overflow: auto;\n                }\n\n                body {\n                    position: relative;\n                    margin: 0;\n                }\n            </style>"),t._stylesheets=o},set:function(e){this._stylesheets=e}}],[{key:"defaultConfig",get:function(){return{translateURLsToAbsolute:!0,keepPathName:!0}}}]),u}(_a(Ge(lt(ue))));function Vp(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Np.prototype.pagesExtractor=function(){var e=Bp()(Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,"";case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),Np._$name="Exporter";var zp=function(e){fe()(s,e);var t,n,r,i,o,a=Vp(s);function s(){return v()(this,s),a.apply(this,arguments)}return g()(s,[{key:"stateNextPage",value:(o=Wr()(Vr.a.mark((function e(t){var n,r;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.client,++(r=this.exportMeta).currentPage,++r.verticalPosition,delete r.lastExportedRowBottom,!(r.verticalPosition>=r.verticalPages)){e.next=10;break}return r.verticalPosition=r.currentPageTopMargin=0,++r.horizontalPosition,e.next=10,this.scrollRowIntoView(n,r.firstVisibleDataIndex,{block:"start"});case 10:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"prepareComponent",value:(i=Wr()(Vr.a.mark((function e(t){var n,r,i,o,a,u,c,l,f,d,h,v,p,g,y,m,k,b,w,C,S,D,R;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,we()(pe()(s.prototype),"prepareComponent",this).call(this,t);case 2:r=(n=this).exportMeta,i=t.client,o=t.headerTpl,a=t.footerTpl,u=t.alignRows,c=t.rowsRange,l=Cp[t.paperFormat],f=t.orientation===Sp.portrait,d=f?l.width:l.height,h=f?l.height:l.width,v=n.inchToPx(d),p=n.inchToPx(h),g=Math.ceil(r.totalWidth/v),y=r.totalHeight+i.height-i.bodyHeight+i.scrollable.scrollHeight,m=p,o&&(m-=n.measureElement(o({totalWidth:r.totalWidth,totalPages:-1,currentPage:-1}))),a&&(m-=n.measureElement(a({totalWidth:r.totalWidth,totalPages:-1,currentPage:-1}))),b=i.store.count,c===wp.visible&&(b=n.getVisibleRowsCount(i),w=i.rowManager.rows[b-1].bottom,y=y-i.scrollable.scrollHeight+w),u&&c!==wp.visible?(C=i.rowManager.rowOffsetHeight,S=Math.floor((m-i.headerHeight)/C),D=Math.floor(m/C),R=b-S,k=1+Math.ceil(R/D)):k=Math.ceil(y/m),Object.assign(r,{paperWidth:d,paperHeight:h,pageWidth:v,pageHeight:p,horizontalPages:g,verticalPages:k,totalHeight:y,contentHeight:m,totalRows:b,totalPages:g*k,currentPage:0,verticalPosition:0,horizontalPosition:0,currentPageTopMargin:0}),this.adjustRowBuffer(i);case 11:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"restoreComponent",value:(r=Wr()(Vr.a.mark((function e(t){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,we()(pe()(s.prototype),"restoreComponent",this).call(this,t);case 2:this.restoreRowBuffer(t.client);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"buildPage",value:(n=Wr()(Vr.a.mark((function e(t){var n,r,i,o,a,s,u,c,l,f,d,h,v,p,g,y,m,k,b,w,C,S,D,R,x,E,T,M,A;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=(n=this).exportMeta,i=t.client,o=t.headerTpl,a=t.footerTpl,s=t.alignRows,u=r.totalWidth,c=r.totalPages,l=r.currentPage,f=r.subGrids,d=r.currentPageTopMargin,h=r.verticalPosition,v=r.totalRows,p=i.rowManager,g=p.rows,Object.values(f).forEach((function(e){return e.rows=[]})),t.rowsRange===wp.all&&(r.totalHeight=i.height-i.bodyHeight+i.scrollable.scrollHeight-n.getVirtualScrollerHeight(i)),y=0,m=0,k=t.rowsRange===wp.visible?g.findIndex((function(e){return e.bottom>i.scrollable.y})):g.findIndex((function(e){return e.bottom+d+i.headerHeight>0})),S=k,D=0===h?0:g[k].top+d+i.headerHeight,o&&(w=n.prepareHTML(o({totalWidth:u,totalPages:c,currentPage:l})),y=n.measureElement(w)),a&&(C=n.prepareHTML(a({totalWidth:u,totalPages:c,currentPage:l})),m=n.measureElement(C)),b=r.pageHeight-y-m-D,0===h&&(b-=i.headerHeight),x=0;b>0;)E=g[k],s&&b<E.offsetHeight?(x=-b,b=0,n.exportMeta.lastExportedRowBottom=g[k-1].bottom):(n.collectRow(E),b-=E.offsetHeight,R=E.dataIndex,(++k===g.length&&b>0||t.rowsRange===wp.visible&&k-S===v)&&(b=0));return(T=g[k-1])&&(r.exactGridHeight=T.bottom+i.footerContainer.offsetHeight+i.headerContainer.offsetHeight),e.next=15,n.onRowsCollected(g.slice(S,k),t);case 15:if(t.rowsRange!==wp.visible){e.next=19;break}r.exactGridHeight-=r.scrollableTopMargin=i.scrollable.y,e.next=23;break;case 19:return M=p.on("offsetrows",(function(e){var t=e.offset;return x+=t})),e.next=22,n.scrollRowIntoView(i,R+1);case 22:M();case 23:return A=n.buildPageHtml(),e.abrupt("return",{html:A,header:w,footer:C,offset:x});case 25:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"onRowsCollected",value:(t=Wr()(Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})},{key:"collectRow",value:function(e){var t=this.exportMeta.subGrids;Object.entries(e.elements).forEach((function(e){var n=ye()(e,2),r=n[0],i=n[1];t[r].rows.push(i.outerHTML)}))}},{key:"buildPageHtml",value:function(){var e=this.exportMeta.subGrids,t=this.prepareExportElement();return Object.values(e).forEach((function(e){var n=e.placeHolder,r=e.rows,i=n.outerHTML;t=t.replace(i,r.join(""))})),t}},{key:"prepareExportElement",value:function(){var e=this.element,t=this.exportMeta;return t.scrollableTopMargin&&(e.querySelector(".b-grid-vertical-scroller").style.marginTop="-".concat(t.scrollableTopMargin,"px")),we()(pe()(s.prototype),"prepareExportElement",this).call(this)}}],[{key:"$name",get:function(){return"MultiPageExporter"}},{key:"type",get:function(){return"multipage"}},{key:"title",get:function(){return this.L("L{multipage}")}},{key:"exportingPageText",get:function(){return"L{exportingPage}"}}]),s}(Np);function Wp(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}zp.prototype.pagesExtractor=function(){var e=Bp()(Vr.a.mark((function e(t){var n,r,i,o,a,s,u,c,l,f,h,v,p,g,y;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=(n=this).exportMeta,i=n.stylesheets,o=r.totalWidth,a=r.totalPages,s=r.paperWidth,u=r.paperHeight,c=r.contentHeight;case 1:if(!((l=r.currentPage)<a)){e.next=18;break}return n.trigger("exportStep",{text:n.L(zp.exportingPageText,{currentPage:l,totalPages:a}),progress:Math.round((l+1)/a*90)}),e.next=5,jp()(n.buildPage(t));case 5:return f=e.sent,h=f.html,v=f.header,p=f.footer,g=f.offset,y=[].concat(d()(i),["\n                <style>\n                    #".concat(t.client.id," {\n                        height: ").concat(r.exactGridHeight,"px !important;\n                        width: ").concat(o,"px !important;\n                    }\n                    \n                    .b-export-body .b-export-viewport {\n                        margin-left : ").concat(-s*r.horizontalPosition,"in;\n                        margin-top  : ").concat(r.currentPageTopMargin,"px;\n                    }\n                </style>\n            ")]),r.currentPageTopMargin-=c+g,e.next=14,jp()(n.stateNextPage(t));case 14:return e.next=16,{html:n.pageTpl({html:h,header:v,footer:p,styles:y,paperWidth:s,paperHeight:u})};case 16:e.next=1;break;case 18:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),zp._$name="MultiPageExporter";var Gp=function(e){fe()(s,e);var t,n,r,i,o,a=Wp(s);function s(){return v()(this,s),a.apply(this,arguments)}return g()(s,[{key:"stateNextPage",value:(o=Wr()(Vr.a.mark((function e(t){var n,r,i,o;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t.client,n=this.exportMeta,r=n.totalRows,i=n.processedRows,o=n.totalPages,++n.currentPage,++n.verticalPosition,n.currentPage===o&&i.size!==r&&(++n.totalPages,++n.verticalPages);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"estimateTotalPages",value:function(e){var t,n=this,r=n.exportMeta,i=e.client,o=e.headerTpl,a=e.footerTpl,s=e.alignRows,u=e.rowsRange,c=e.repeatHeader,l=r.pageWidth,f=r.pageHeight,d=r.totalWidth,h=n.getScaleValue(l,d),v=0-n.getVirtualScrollerHeight(i)+i.height-i.bodyHeight+i.scrollable.scrollHeight,p=f/h,g=i.store.count,y=0;if(o&&(p-=n.measureElement(o({totalWidth:d,totalPages:-1,currentPage:-1}))),a&&(p-=n.measureElement(a({totalWidth:d,totalPages:-1,currentPage:-1}))),c&&(p-=i.headerHeight,v-=i.headerHeight),u===wp.visible){var m=i.rowManager,k=m.firstVisibleRow,b=m.lastVisibleRow;y=k.top,g=n.getVisibleRowsCount(i),v=v-i.scrollable.scrollHeight+b.bottom-k.top}if(s&&!c&&u!==wp.visible){var w=i.rowManager.rowOffsetHeight,C=Math.floor((p-i.headerHeight)/w),S=Math.floor(p/w),D=g-C;t=1+Math.ceil(D/S)}else t=Math.ceil(v/p);Object.assign(r,{scale:h,contentHeight:p,totalRows:g,totalHeight:v,verticalPages:t,initialScroll:y,horizontalPages:1,totalPages:t})}},{key:"prepareComponent",value:(i=Wr()(Vr.a.mark((function e(t){var n,r,i,o,a,u,c,l,f;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,we()(pe()(s.prototype),"prepareComponent",this).call(this,t);case 2:r=(n=this).exportMeta,i=t.client,o=Cp[t.paperFormat],a=t.orientation===Sp.portrait,u=a?o.width:o.height,c=a?o.height:o.width,l=n.inchToPx(u),f=n.inchToPx(c),Object.assign(r,{paperWidth:u,paperHeight:c,pageWidth:l,pageHeight:f,horizontalPages:1,currentPage:0,verticalPosition:0,horizontalPosition:0,currentPageTopMargin:0,processedRows:new Set}),n.estimateTotalPages(t),n.adjustRowBuffer(i);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"restoreComponent",value:(r=Wr()(Vr.a.mark((function e(t){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,we()(pe()(s.prototype),"restoreComponent",this).call(this,t);case 2:this.restoreRowBuffer(t.client);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"buildPage",value:(n=Wr()(Vr.a.mark((function e(t){var n,r,i,o,a,s,u,c,l,f,d,h,v,p,g,y,m,k,b,w,C,S,D,R,x,E,T,M,A,P;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(r=(n=this).exportMeta,i=t.client,o=t.headerTpl,a=t.footerTpl,s=t.alignRows,u=t.repeatHeader,c=r.totalWidth,l=r.totalPages,f=r.currentPage,d=r.subGrids,h=r.currentPageTopMargin,v=r.verticalPosition,p=r.totalRows,g=r.contentHeight,y=u?0:i.headerHeight,m=i.rowManager,k=m.rows,Object.values(d).forEach((function(e){return e.rows=[]})),t.rowsRange===wp.all&&(r.totalHeight=i.height-i.bodyHeight+i.scrollable.scrollHeight-n.getVirtualScrollerHeight(i)),b=t.rowsRange===wp.visible?k.findIndex((function(e){return e.bottom>i.scrollable.y})):k.findIndex((function(e){return e.bottom+h+y>0})),D=b,R=0===v?0:k[b].top+h+y,o&&(C=n.prepareHTML(o({totalWidth:c,totalPages:l,currentPage:f}))),a&&(S=n.prepareHTML(a({totalWidth:c,totalPages:l,currentPage:f}))),w=g-R,0===v&&(w-=y),E=0;w>0;)T=k[b],s&&w<T.offsetHeight?(E=-w,w=0):(n.collectRow(T),(w-=T.offsetHeight)>0&&r.processedRows.add(T.dataIndex),x=T.dataIndex,(++b===k.length&&w>0||t.rowsRange===wp.visible&&b-D===p)&&(w=0));return(M=k[b-1])&&(r.exactGridHeight=M.bottom+i.footerContainer.offsetHeight+i.headerContainer.offsetHeight),e.next=15,n.onRowsCollected(k.slice(D,b),t);case 15:if(t.rowsRange!==wp.visible){e.next=19;break}r.scrollableTopMargin=i.scrollable.y,e.next=23;break;case 19:return A=m.on("offsetrows",(function(e){var t=e.offset;return E+=t})),e.next=22,n.scrollRowIntoView(i,x+1);case 22:A();case 23:return P=n.buildPageHtml(),e.abrupt("return",{html:P,header:C,footer:S,offset:E});case 25:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"onRowsCollected",value:(t=Wr()(Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})},{key:"collectRow",value:function(e){var t=this.exportMeta.subGrids;Object.entries(e.elements).forEach((function(e){var n=ye()(e,2),r=n[0],i=n[1];t[r].rows.push(i.outerHTML)}))}},{key:"buildPageHtml",value:function(){var e=this.exportMeta.subGrids,t=this.prepareExportElement();return Object.values(e).forEach((function(e){var n=e.placeHolder,r=e.rows,i=n.outerHTML;t=t.replace(i,r.join(""))})),t}}],[{key:"$name",get:function(){return"MultiPageVerticalExporter"}},{key:"type",get:function(){return"multipagevertical"}},{key:"title",get:function(){return this.L("L{multipagevertical}")}},{key:"exportingPageText",get:function(){return"L{exportingPage}"}}]),s}(Np);function Yp(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Gp.prototype.pagesExtractor=function(){var e=Bp()(Vr.a.mark((function e(t){var n,r,i,o,a,s,u,c,l,f,h,v,p,g,y,m,k,b,w;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=(n=this).exportMeta,i=n.stylesheets,o=r.totalWidth,a=r.paperWidth,s=r.paperHeight,u=r.contentHeight,c=r.scale,l=r.initialScroll,f=r.totalPages;case 2:if(!((h=r.currentPage)<f)){e.next=21;break}return n.trigger("exportStep",{text:n.L(Gp.exportingPageText,{currentPage:h,totalPages:f}),progress:Math.round((h+1)/f*90)}),e.next=6,jp()(n.buildPage(t));case 6:return v=e.sent,p=v.html,g=v.header,y=v.footer,m=v.offset,k=[].concat(d()(i),["\n                <style>\n                    #".concat(t.client.id," {\n                        width: ").concat(o,"px !important;\n                    }\n                    \n                    .b-export .b-export-content {\n                        transform: scale(").concat(c,");\n                        transform-origin: top left;\n                        height: auto;\n                    }\n                </style>\n            ")]),t.repeatHeader?(b=r.exactGridHeight?"".concat(r.exactGridHeight+r.currentPageTopMargin,"px"):"100%",k.push("\n                <style>\n                    #".concat(t.client.id," {\n                        height: ").concat(b," !important;\n                    }\n                    \n                    .b-export .b-export-content {\n                        height: ").concat(100/c,"%;\n                    }\n                    \n                    .b-export-body {\n                        height: 100%;\n                        display: flex;\n                    }\n                \n                    .b-export-viewport {\n                        height: 100%;\n                    }\n                    \n                    .b-grid-vertical-scroller {\n                        margin-top: ").concat(r.currentPageTopMargin-l,"px;\n                    }\n                </style>\n                "))):(w=r.exactGridHeight||u-r.currentPageTopMargin,k.push("\n                <style>\n                    #".concat(t.client.id," {\n                        height: ").concat(w,"px !important;\n                    }\n                    \n                    .b-export-body {\n                        overflow: hidden;\n                    }\n                    \n                    .b-export .b-export-content {\n                        height: ").concat(100/c,"%;\n                    }\n                    \n                    .b-export-body .b-export-viewport {\n                        margin-top: ").concat(r.currentPageTopMargin,"px;\n                    }\n                    \n                    .b-grid-vertical-scroller {\n                        margin-top: -").concat(l,"px;\n                    }\n                </style>\n                "))),r.currentPageTopMargin-=u+m,e.next=16,jp()(n.stateNextPage(t));case 16:return f=r.totalPages,e.next=19,{html:n.pageTpl({html:p,header:g,footer:y,styles:k,paperWidth:a,paperHeight:s})};case 19:e.next=2;break;case 21:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),Gp._$name="MultiPageVerticalExporter";var Up=function(e){fe()(i,e);var t,n,r=Yp(i);function i(){return v()(this,i),r.apply(this,arguments)}return g()(i,[{key:"prepareComponent",value:(n=Wr()(Vr.a.mark((function e(t){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,we()(pe()(i.prototype),"prepareComponent",this).call(this,t);case 2:Object.assign(this.exportMeta,{verticalPages:1,horizontalPages:1,totalPages:1,currentPage:0,verticalPosition:0,horizontalPosition:0});case 3:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"onRowsCollected",value:(t=Wr()(Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(){return t.apply(this,arguments)})},{key:"positionRows",value:function(e){var t=0;return e.map((function(e){var n=ye()(e,2),r=n[0],i=n[1],o=r.replace(/translate\(\d+px, \d+px\)/,"translate(0px, ".concat(t,"px)"));return t+=i,o}))}},{key:"collectRow",value:function(e){var t=this.exportMeta.subGrids;Object.entries(e.elements).forEach((function(n){var r=ye()(n,2),i=r[0],o=r[1];t[i].rows.push([o.outerHTML,e.offsetHeight])}))}},{key:"buildPageHtml",value:function(){var e=this,t=e.exportMeta.subGrids,n=e.prepareExportElement();return Object.values(t).forEach((function(t){var r=t.placeHolder,i=t.rows,o=r.outerHTML;n=n.replace(o,e.positionRows(i).join(""))})),n}}],[{key:"$name",get:function(){return"SinglePageExporter"}},{key:"type",get:function(){return"singlepage"}},{key:"title",get:function(){return this.localize("L{singlepage}")}},{key:"defaultConfig",get:function(){return{centerContentHorizontally:!1}}}]),i}(Np);function qp(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Up.prototype.pagesExtractor=function(){var e=Bp()(Vr.a.mark((function e(t){var n,r,i,o,a,s,u,c,l,f,d,h,v,p,g,y,m,k,b,w,C,S,D,R,x,E,T,M,A;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this,r=t.client,i=r.rowManager,o=r.store,a=n.stylesheets,s=t.orientation===Sp.portrait,u=Cp[t.paperFormat],c=s?u.width:u.height,l=s?u.height:u.width,f=t.rowsRange===wp.visible&&o.count?Math.min(o.count,i.visibleRowCount):o.count,d=n.exportMeta,h=d.totalHeight,v=d.totalWidth,p=0,g=-1,!(i.rows.length>0)){e.next=16;break}t.rowsRange===wp.visible&&(g=i.rows.find((function(e){return e.bottom>r.scrollable.y})).dataIndex-1);case 4:if(!(p<f)){e.next=16;break}return k=i.rows,b=k[k.length-1],w=p,k.forEach((function(e){e.dataIndex>g&&p<f&&(++p,h+=e.offsetHeight,n.collectRow(e))})),C=k.findIndex((function(e){return e.dataIndex===g+1})),S=C+(p-w),e.next=10,jp()(n.onRowsCollected(k.slice(C,S),t));case 10:if(!(p<f)){e.next=14;break}return g=b.dataIndex,e.next=14,jp()(n.scrollRowIntoView(r,g+1));case 14:e.next=4;break;case 16:return D=n.buildPageHtml(),h+=r.height-r.bodyHeight,R=h,t.headerTpl&&(y=n.prepareHTML(t.headerTpl({totalWidth:v})),x=n.measureElement(y),h+=x),t.footerTpl&&(m=n.prepareHTML(t.footerTpl({totalWidth:v})),E=n.measureElement(m),h+=E),T=Math.min(1,n.getScaleValue(n.inchToPx(c),v)),M=Math.min(1,n.getScaleValue(n.inchToPx(l),h)),A=Math.min(T,M),a.push("<style>\n                #".concat(r.id," {\n                    height: ").concat(R,"px !important;\n                    width: ").concat(v,"px !important;\n                }\n                \n                .b-export-content {\n                    ").concat(n.centerContentHorizontally?"left: 50%;":"","\n                    transform: scale(").concat(A,") ").concat(n.centerContentHorizontally?"translateX(-50%)":"",";\n                    transform-origin: top left;\n                    height: ").concat(1===A?"inherit":"auto !important",";\n                }\n            </style>")),j.a.isIE11&&a.push("<style>\n                .b-export-body {\n                   min-height: ".concat(R,"px !important;\n                }\n         </style>")),e.next=26,{html:n.pageTpl({html:D,header:y,footer:m,styles:a,paperWidth:c,paperHeight:l})};case 26:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),Up._$name="SinglePageExporter";var Kp=function(e){fe()(r,e);var t,n=qp(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"doDestroy",value:function(){this.exportDialog&&this.exportDialog.destroy(),we()(pe()(r.prototype),"doDestroy",this).call(this)}},{key:"getExporter",value:function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this,r=n.exportersMap,i=t,o=i.type;if(r.has(o))e=r.get(o);else{var a=this.exporters.find((function(e){return e.type===o}));if(!a)throw new Error("Exporter type ".concat(o," is not found. Make sure you've configured it"));delete(t=an.clone(t)).type,(e=new a(t)).relayAll(n),r.set(o,e)}return e}},{key:"buildRequest",value:function(e,t){return{html:JSON.stringify(e),fileFormat:t.fileFormat,format:t.paperFormat,orientation:t.orientation}}},{key:"buildExportConfig",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this,n=t.client,r=t.exportServer,i=t.clientURL,o=t.fileFormat,a=t.fileName,s=t.paperFormat,u=t.rowsRange,c=t.alignRows,l=t.repeatHeader,f=t.keepRegionSizes,d=t.orientation,h=t.exporters,v=t.translateURLsToAbsolute,p=t.keepPathName,g=t.headerTpl,y=t.footerTpl;e.columns||(e.columns=n.columns.visibleColumns.map((function(e){return e.id})));var m=an.assign({client:n,exportServer:r,clientURL:i,fileFormat:o,paperFormat:s,rowsRange:u,alignRows:c,repeatHeader:l,keepRegionSizes:f,orientation:d,translateURLsToAbsolute:v,keepPathName:p,headerTpl:g,footerTpl:y,exporterType:h[0].type,fileName:a||n.$$name},e);if("multipagevertical"!==m.exporterType&&(m.repeatHeader=!1),!("alignRows"in e)&&e.repeatHeader&&(m.alignRows=!0),!("keepRegionSizes"in e)&&!m.keepRegionSizes){var k=[],b={};n.eachSubGrid((function(e){return e.collapsed&&k.push(e.region)})),k.length&&(n.eachSubGrid((function(e){k.includes(e.region)||(b[e.region]=!0)})),m.keepRegionSizes=b)}return m}},{key:"export",value:(t=Wr()(Vr.a.mark((function e(){var t,n,r,i,o,a,s,u,c,l,f=arguments;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=f.length>0&&void 0!==f[0]?f[0]:{},r=(n=this).client,i=n.pagesPerRequest,(t=n.buildExportConfig(t)).exporterConfig=an.assign({type:t.exporterType,translateURLsToAbsolute:t.translateURLsToAbsolute,keepPathName:t.keepPathName},t.exporterConfig||{}),!1===r.trigger("beforeExport",t)){e.next=33;break}if(r.ignoreViewBox=!0,r.mask(n.exportMask),e.prev=7,a=n.getExporter(t.exporterConfig),0!==i){e.next=19;break}return e.next=12,a.export(t);case 12:return s=e.sent,n.trigger("exportStep",{progress:90,text:n.exportProgressMask}),e.next=16,Je.post(t.exportServer,{html:s,orientation:t.orientation,format:t.paperFormat,fileFormat:t.fileFormat,fileName:t.fileName,clientURL:t.clientURL},Object.assign({credentials:"omit",parseJson:!0},n.fetchOptions));case 16:u=e.sent,o={response:u},u.ok&&(c=u.parsedJson,n.openAfterExport&&(c.success?j.a.isIE11?window.open(c.url,"ExportedPanel"):((l=document.createElement("a")).download=t.fileName,l.href=c.url,n.openInNewTab&&(l.target="_blank"),document.body.appendChild(l),l.click(),document.body.removeChild(l)):lc.toast(c.msg)));case 19:e.next=25;break;case 21:throw e.prev=21,e.t0=e.catch(7),o=e.t0 instanceof Response?{response:e.t0}:{error:e.t0},e.t0;case 25:return e.prev=25,n.exportDialog&&n.exportDialog.close(),r.unmask(),r.ignoreViewBox=!1,n.trigger("export",o),o.error?lc.toast(n.L("L{Export failed}")):o.response.ok||lc.toast(n.L("L{Server error}")),r.trigger("export",o),e.finish(25);case 33:return e.abrupt("return",o);case 34:case"end":return e.stop()}}),e,this,[[7,21,25,33]])}))),function(){return t.apply(this,arguments)})},{key:"showExportDialog",value:function(){var e=this;return e.exportDialog||(e.exportDialog=new Fp(Object.assign({},e.defaultExportDialogConfig,{listeners:{export:e.onExportDialogExport,thisObj:e}}))),e.exportDialog.show()}},{key:"onExportDialogExport",value:function(e){var t=e.values,n=this;n.mask=new Ku({progress:0,maxProgress:100,text:n.exportMask,target:n.exportDialog.element});var r=n.on({export:function(){n.mask.close(),r()},exportstep:function(e){var t=e.progress,r=e.text;n.mask.progress=t,null!=r&&(n.mask.text=r)}});n.currentExportPromise=n.export(t),n.currentExportPromise.then((function(){return n.currentExportPromise=null}))}},{key:"currentExportPromise",get:function(){return this._currentExportPromise},set:function(e){this._currentExportPromise=e}},{key:"exportersMap",get:function(){return this._exportersMap||(this._exportersMap=new Map)}},{key:"defaultExportDialogConfig",get:function(){return an.copyProperties({},this,["client","exporters","exporterType","orientation","fileFormat","paperFormat","alignRows","rowsRange","repeatHeader"])}}],[{key:"$name",get:function(){return"PdfExport"}},{key:"defaultConfig",get:function(){return{exportServer:void 0,fileName:null,fileFormat:"pdf",clientURL:null,paperFormat:"A4",orientation:"portrait",rowsRange:"all",alignRows:!1,repeatHeader:!1,keepRegionSizes:null,pagesPerRequest:0,exporterConfig:null,exporterType:"singlepage",exporters:[Up,zp,Gp],translateURLsToAbsolute:!0,keepPathName:!0,openAfterExport:!0,openInNewTab:!1,headerTpl:null,footerTpl:null,fetchOptions:null,exportMask:"L{Generating pages}",exportProgressMask:"L{Waiting for response from server}",localizableProperties:["exportMask","exportProgressMask"]}}}]),r}(lt(qr));function Xp(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Kp._$name="PdfExport",fv.registerFeature(Kp,!1,"Grid");var Zp=function(e){fe()(n,e);var t=Xp(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"export",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this;return e=an.assign({},t.config,e),t.normalizeColumns(e),t.generateExportData(e)}},{key:"generateExportData",value:function(e){var t=this.generateColumns(e);return{rows:this.generateRows(e),columns:t}}},{key:"normalizeColumns",value:function(e){var t=this,n=e.columns||this.target.columns.visibleColumns.filter((function(e){return!1!==e.exportable}));e.columns=n.map((function(e){return"string"==typeof e?t.target.columns.find((function(t){return t.field===e}))||{field:e}:e}))}},{key:"generateColumns",value:function(e){var t=this;return e.columns.map((function(n){return t.processColumn(n,e)}))}},{key:"generateRows",value:function(e){var t=e.columns;if(!t.length)return[];var n=this;return n.target.store.map((function(r){return n.processRecord(r,t,e)})).filter((function(e){return e.length}))}},{key:"getColumnType",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.target.store,n=e.exportedType||"object";if(void 0===e.exportedType&&e.field){var r=t.modelClass.getFieldDefinition(e.field);r&&"auto"!==r.type&&(n=r.type)}return n}},{key:"processColumn",value:function(e,t){var n=this.target,r=t.defaultColumnWidth,i=e.field,o=e.text,a=e.width,s=e.minWidth;if(i in n.store.modelClass.fieldMap||(i=""),!o||!a){var u=n.columns.find((function(e){return e.field===i}));o||(o=u&&u.text||i),null==a&&(a=u&&u.width||r)}return a=Math.max(a||r,s||r),{field:i,value:o,width:a,type:this.getColumnType(e)}}},{key:"processRecord",value:function(e,t,n){var r,i=this.target,o=n.showGroupHeader,a=n.indent,s=n.indentationSymbol;return e?e.isSpecialRow?o&&e.meta.groupRowFor&&(r=t.map((function(t){return i.features.group.buildGroupHeader({cellElement:Cr.createElement(),grid:i,record:e,column:t})}))):r=t.map((function(t){var r=e[t.field],o=t.renderer||t.defaultRenderer;return!o||r&&t.isDateColumn&&n.exportDateAsInstance||(r=o.call(t,{value:r,record:e,column:t,grid:i,isExport:!0})),a&&t.tree&&(r="".concat(s.repeat(e.childLevel)).concat(r)),r})):r=t.map((function(){return""})),r}}],[{key:"defaultConfig",get:function(){return{target:null,defaultColumnWidth:100,exportDateAsInstance:!0,showGroupHeader:!0,columns:null,indent:!0,indentationSymbol:""}}}]),n}(ue);Zp._$name="TableExporter";var Jp=function(){function e(t){v()(this,e),this._value=t}return g()(e,[{key:"toString",value:function(){return Boolean(this.value)?"":""}},{key:"value",get:function(){return this._value}}]),e}();function Qp(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Jp._$name="BooleanUnicodeSymbol";var eg=function(e){fe()(n,e);var t=Qp(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"processValue",value:function(e){return null==e||Number.isNaN(e)||"function"==typeof e||"object"===l()(e)&&"[object Object]"===String(e)?"":e}},{key:"generateExportData",value:function(e){var t=this,n=t.exporter.export(e.exporterConfig),r=n.rows,i=n.columns;return{rows:r.map((function(n){return n.map((function(n,r){var o;return n instanceof Date?n=Zt.format(n,e.dateFormat):"boolean"==typeof n&&(n=new Jp(n)),t.convertEmptyValueToEmptyString&&(n=t.processValue(n)),{value:n,type:"number"===(null===(o=i[r])||void 0===o?void 0:o.type)?"number":"string"}}))})),columns:i.map((function(e){var t=e.field,n=e.value,r=e.width;e.type;return"string",{field:t,value:n,width:r,type:"string"}}))}}},{key:"export",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this;if(!t.zipcelx)throw new Error('ExcelExporter: "zipcelx" library is required');if(!t.disabled){(e=an.assign({},t.config,e)).filename||(e.filename=t.client.$$name);var n=e,r=n.filename,i=t.generateExportData(e),o=i.rows,a=i.columns;t.zipcelx({filename:r,sheet:{data:[a].concat(o),cols:a}})}}},{key:"construct",value:function(e,t){we()(pe()(n.prototype),"construct",this).call(this,e,t),this.zipcelx||"undefined"!=typeof zipcelx&&(this.zipcelx=zipcelx)}},{key:"exporter",get:function(){return this._exporter||(this._exporter=new this.exporterClass(Object.assign({target:this.client},this.exporterConfig)))}}],[{key:"$name",get:function(){return"ExcelExporter"}},{key:"defaultConfig",get:function(){return{filename:null,dateFormat:"YYYY-MM-DD",exporterClass:Zp,exporterConfig:null,zipcelx:null,convertEmptyValueToEmptyString:!0}}}]),n}(qr);function tg(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return ng(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ng(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function ng(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}eg._$name="ExcelExporter",fv.registerFeature(eg,!1,"Grid");var rg=function(){function e(){v()(this,e)}return g()(e,null,[{key:"convertFromObject",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};F.assignIf(t,{rootName:"root",elementName:"element",includeHeader:!0,rootElementForArray:!0});var n=t.rootName,r=t.elementName,i=t.includeHeader,o=t.rootElementForArray,a=t.xmlns;a=a?' xmlns="'.concat(a,'"'):"";var s=i?'<?xml version="1.0" encoding="UTF-8" standalone="yes"?>':"",u=function e(t){var n=[];for(var i in t){var a=t[i];if(Array.isArray(a)){o&&n.push("<".concat(i,">"));var s,u=tg(a);try{for(u.s();!(s=u.n()).done;){var c=s.value;r.length?n.push("<".concat(r,">")):n.push("<".concat(i,">")),n.push(e(c)),r.length?n.push("</".concat(r,">")):n.push("</".concat(i,">"))}}catch(e){u.e(e)}finally{u.f()}o&&n.push("</".concat(i,">"))}else F.isObject(a)?n.push("<".concat(i,">").concat(e(a),"</").concat(i,">")):null==a?n.push("<".concat(i,"/>")):n.push("<".concat(i,">").concat(E.encodeHtml(a),"</").concat(i,">"))}return n.join("")};return"".concat(s,"<").concat(n).concat(a,">").concat(u(e),"</").concat(n,">")}}]),e}();function ig(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function og(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ig(Object(n),!0).forEach((function(t){ke()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ig(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function ag(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}rg._$name="XMLHelper";var sg=Zt.clearTime(new Date(1900,5,15)),ug={minute:3,hour:5,day:7,week:9,month:11},cg={minute:1,hour:2,day:3,week:4,month:5},lg={finishnoearlierthan:6,finishnolaterthan:7,mustfinishon:3,muststarton:2,startnoearlierthan:4,startnolaterthan:5},fg={FixedDuration:1,FixedUnits:0,FixedEffort:2,Normal:0},dg={0:3,1:2,2:1,3:0},hg=function(e){fe()(n,e);var t=ag(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"generateExportData",value:function(){var e=this;return og(og({},e.getMsProjectConfig()),{},{Calendars:{Calendar:e.getCalendarsData()},Tasks:{Task:e.getTasksData()},Resources:{Resource:e.getResourcesData()},Assignments:{Assignment:e.getAssignmentsData()}})}},{key:"export",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this;if(!t.disabled){(e=an.assign({},t.config,e)).filename||(e.filename="".concat(t.client.$$name,".xml"));var n=t.generateExportData(e),r=t.convertToXml(n);j.a.download(e.filename,"data:text/xml;charset=utf-8,".concat(escape(r)))}}},{key:"convertToXml",value:function(e){return rg.convertFromObject(e,{rootName:"Project",elementName:"",xmlns:"http://schemas.microsoft.com/project",rootElementForArray:!1})}},{key:"getMsProjectConfig",value:function(){var e=this,t=e.dateFormat,n=e.client.project,r=e.filename||e.client.$$name;return{CalendarUID:e.getCalendarUID(n.effectiveCalendar),CreationDate:Zt.format(new Date,t),CurrentDate:Zt.format(new Date,t),DaysPerMonth:n.daysPerMonth,FinishDate:Zt.format(n.endDate,t),MinutesPerDay:60*n.hoursPerDay,MinutesPerWeek:n.daysPerWeek*n.hoursPerDay*60,Name:r,ScheduleFromStart:"Forward"===n.direction?1:0,StartDate:Zt.format(n.startDate,t),Title:r,WorkFormat:cg[n.effortUnit]}}},{key:"getCalendarsData",value:function(){var e=this,t=e.client,n=t.calendarManagerStore,r=t.project.calendar,i=n.allRecords||[];return n.getByInternalId(r.internalId)||i.push(r),i.map((function(t){return{BaseCalendarUID:e.getCalendarUID(t.parent),IsBaseCalendar:t.parentId?0:1,Name:"".concat(t.name||t.internalId," - imported"),UID:e.getCalendarUID(t),WeekDays:{WeekDay:e.formatWeekDays(t)}}}))}},{key:"formatWeekDays",value:function(e){for(var t,n=this.timeFormat,r=[],i={},o=sg,a=0;a<7;a++){var s=o.getDay();i[s]={DayType:s+1,DayWorking:0},t=Zt.clearTime(Zt.add(o,1,"day")),r.push({startDate:o,endDate:t}),o=t}var u=new e.constructor({intervals:r});return this.client.project.combineCalendars([e,u]).forEachAvailabilityInterval({startDate:sg,endDate:t},(function(t,r,o){var a=o.getCalendarsWorkStatus(),s=i[t.getDay()];a.get(e)&&(s.DayWorking=1,s.WorkingTimes=s.WorkingTimes||{WorkingTime:[]},s.WorkingTimes.WorkingTime.push({FromTime:Zt.format(t,n),ToTime:Zt.format(r,n)}))})),Object.values(i)}},{key:"getTasksData",value:function(){var e=this,t=e.dateFormat,n=e.client.project;return e.client.tasks.map((function(r){var i=r.wbsCode;return{CalendarUID:e.getCalendarUID(r.effectiveCalendar),ConstraintDate:Zt.format(r.constraintDate,t),ConstraintType:lg[r.constraintType],Deadline:Zt.format(r.deadlineDate,t),Duration:e.toTimeSpanValue(r.duration,r.durationUnit),DurationFormat:ug[r.durationUnit],EarlyFinish:Zt.format(r.earlyEnd,t),EarlyStart:Zt.format(r.earlyStart,t),EffortDriven:r.effortDriven?1:0,Estimated:0,Finish:Zt.format(r.endDate,t),LateFinish:Zt.format(r.lateEnd,t),LateStart:Zt.format(r.lateStart,t),Manual:r.manuallyScheduled?1:0,ManualDuration:e.toTimeSpanValue(r.duration,r.durationUnit),ManualFinish:Zt.format(r.endDate,t),ManualStart:Zt.format(r.startDate,t),Milestone:r.isMilestone?1:0,Name:r.name,Notes:r.note,ProjectExternallyEdited:0,OutlineLevel:i.split(".").length,OutlineNumber:i,PredecessorLink:r.predecessors.map((function(e){return{LagFormat:ug[e.lagUnit],LinkLag:10*n.convertDuration(e.lag,e.lagUnit,"minute"),PredecessorUID:e.fromEvent.id,Type:dg[e.type]}})),RemainingDuration:e.toTimeSpanValue(r.duration,r.durationUnit),Rollup:r.rollup?1:0,Start:Zt.format(r.startDate,t),Summary:r.isLeaf?0:1,TotalSlack:r.totalSlack,Type:r.isLeaf?fg[r.schedulingMode]:1,UID:r.id,WBS:i,Work:e.toTimeSpanValue(r.effort,r.effortUnit)}}))}},{key:"getCalendarUID",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;return e&&!e.isRoot?e.internalId:t}},{key:"getResourcesData",value:function(){var e=this;return this.client.resources.map((function(t){return{CalendarUID:2013===e.msProjectVersion?null:e.getCalendarUID(t.effectiveCalendar),Name:t.name,UID:t.id,Type:1}}))}},{key:"getAssignmentsData",value:function(){var e=this;return 2013===this.msProjectVersion?[]:this.client.assignments.map((function(t){var n=t.data,r=t.event;return{Finish:Zt.format(r.endDate,e.dateFormat),ResourceUID:n.resource,Start:Zt.format(r.startDate,e.dateFormat),TaskUID:n.event,UID:n.id,Units:n.units/100}}))}},{key:"toTimeSpanValue",value:function(e,t){var n=Zt.getDelta(Zt.as("ms",e,t),{abbrev:!0}),r=n.w,i=n.min,o=n.s,a=n.yr,s=n.mon,u=n.d,c=n.h;return c=c||0,a&&(c+=Zt.as("h",a,"y")),s&&(c+=Zt.as("h",s,"month")),r&&(c+=Zt.as("h",r,"w")),u&&(c+=Zt.as("h",u,"d")),"PT".concat(c,"H").concat(i||0,"M").concat(o||0,"S")}}],[{key:"$name",get:function(){return"MspExport"}},{key:"configurable",get:function(){return{filename:null,dateFormat:"YYYY-MM-DDTHH:mm:ss",timeFormat:"HH:mm:ss",msProjectVersion:2019}}}]),n}(qr);function vg(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}hg._$name="MspExport",fv.registerFeature(hg,!1,"Gantt");var pg=function(e){fe()(n,e);var t=vg(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"startMonitoring",value:function(e){var t=this,n=e instanceof HTMLElement?{element:e}:e,r=n.element,i=n.verticalElement||t.verticalElement||r;if(r&&(r.scrollWidth>r.offsetWidth||i.scrollHeight>i.offsetHeight)){if(t.monitoring.find((function(e){return e.element===r})))return;n.direction=n.direction||t.direction,Object.assign(n,{verticalElement:i,scrollManager:t,startScrollLeft:r.scrollLeft,startScrollTop:i.scrollTop,scrollLeft:r.scrollLeft,scrollTop:i.scrollTop,scrollRelativeLeft:0,scrollRelativeTop:0});var o=t.onMouseMove.bind(n);t.mouseMoveDetacher=nu.on({mousemove:o,touchmove:o,mouseleave:function(){return t.clearTimeout(t.scrollTimeout)},element:r}),n.scrollWidth=r.scrollWidth,t.monitoring.push(n)}}},{key:"stopMonitoring",value:function(e){var t=this,n=t.monitoring.find((function(t){return t.element===e}));n&&(t.stopScroll(n),t.mouseMoveDetacher&&t.mouseMoveDetacher(),t.monitoring.splice(t.monitoring.indexOf(n),1))}},{key:"startScroll",value:function(e){e.scrolling=!0,this.performScroll(e)}},{key:"stopScroll",value:function(e){e.scrolling=!1,e.scrollRequested&&(this.cancelAnimationFrame(e.frameId),e.scrollRequested=!1),this.clearTimeout(this.scrollTimeout),this.scrollTimeout=null}},{key:"performScroll",value:function(e){var t=this;if(e.scrolling&&!e.scrollRequested){var n=e.element,r=e.verticalElement;0!==e.scrollDeltaX&&(e.scrollLeft+=e.scrollDeltaX,e.scrollLeft=Math.max(Math.min(e.scrollLeft,e.scrollWidth-n.clientWidth),0),e.scrollRelativeLeft=e.scrollLeft-e.startScrollLeft,n.scrollLeft=e.scrollLeft),0!==e.scrollDeltaY&&(e.scrollTop+=e.scrollDeltaY,e.scrollTop=Math.max(Math.min(e.scrollTop,r.scrollHeight-r.clientHeight),0),e.scrollRelativeTop=e.scrollTop-e.startScrollTop,r.scrollTop=e.scrollTop),0===e.scrollRelativeLeft&&0===e.scrollRelativeTop||!e.callback||e.callback.call(e.thisObj||this,e),e.scrollRequested=!0,e.frameId=this.requestAnimationFrame((function(){e.scrollRequested=!1,t.performScroll(e)}))}}},{key:"onMouseMove",value:function(e){var t=this,n=t.scrollManager,r=t.element,i=t.verticalElement,o=r.getBoundingClientRect(),a=i.getBoundingClientRect(),s=n.zoneWidth,u=n.scrollSpeed;t.scrollDeltaX=0,"vertical"!==t.direction&&(e.clientX>o.right-s?t.scrollDeltaX=Math.round((s-(o.right-e.clientX))/u)+1:e.clientX<o.left+s&&(t.scrollDeltaX=-Math.round((s+(o.left-e.clientX))/u)-1)),t.scrollDeltaY=0,"horizontal"!==t.direction&&(e.clientY>a.bottom-s?t.scrollDeltaY=Math.round((s-(a.bottom-e.clientY))/u)+1:e.clientY<a.top+s&&(t.scrollDeltaY=-Math.round((s+(a.top-e.clientY))/u)-1)),0===t.scrollDeltaX&&0===t.scrollDeltaY?n.stopScroll(t):n.scrollTimeout||(n.scrollTimeout=n.setTimeout((function(){return n.startScroll(t)}),n.startScrollDelay))}}],[{key:"defaultConfig",get:function(){return{zoneWidth:50,scrollSpeed:5,verticalElement:null,direction:"both",monitoring:[],startScrollDelay:500,testConfig:{scrollSpeed:2,startScrollDelay:0}}}}]),n}(_a(ue));function gg(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}pg._$name="ScrollManager";var yg=function(e){fe()(n,e);var t=gg(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"fixCellWidths",value:function(){var e,t=this,n=!1;t.columns.traverse((function(r){var i=t.getBarCellElement(r.id),o=Cr.setLength(r.width),a=Cr.setLength(r.minWidth);if(i){if(e=j.a.isIE11?"calc(".concat(o," - ").concat(t.getLrPadding(i),"px)"):o,n=n||Boolean(r.flex),r.isParent&&null==r.width&&null==r.flex){var s=r.children.reduce((function(e,t){return e+(!t.hidden&&t.flex||0)}),0);i.style.flex=s>0?"".concat(s," 0 auto"):"",s>0&&r.traverse((function(e){return e.data.minWidth=null}))}else if(parseInt(r.minWidth)>=0&&(i.style.minWidth=a),i.style.flex=i.style.flexBasis=i.style.width="",r.flex)!isNaN(parseInt(r.flex))&&r.children?i.style.flex="".concat(r.flex," 0 auto"):i.style.flex=r.flex;else if(parseInt(r.width)>=0){var u=r.parent;!t.isHeader||u.isRoot||u.width?i.style.flexBasis=e:i.style.width=o}r.height>=0&&(i.style.height=Cr.setLength(r.height))}})),t.element.classList[n?"add":"remove"]("b-has-flex")}},{key:"getLrPadding",value:function(e){if(!this.cellLrPadding){var t=e.ownerDocument.defaultView.getComputedStyle(e);this.cellLrPadding=parseInt(t.getPropertyValue("padding-left"))+parseInt(t.getPropertyValue("padding-right"))+parseInt(t.getPropertyValue("border-left-width"))+parseInt(t.getPropertyValue("border-right-width"))}return this.cellLrPadding}},{key:"getBarCellElement",value:function(e){return this.element.querySelector('[data-column-id="'.concat(e,'"]'))}},{key:"columns",get:function(){return this._columns||this.subGrid.columns},set:function(e){this._columns=e}}],[{key:"$name",get:function(){return"Bar"}},{key:"type",get:function(){return"gridbar"}},{key:"defaultConfig",get:function(){return{htmlCls:"",scrollable:{}}}}]),n}(oc);function mg(){var e=El()(['\n                <div\n                    class="b-grid-footer '," ",'"\n                    data-column="','" data-column-id="','" data-all-index="','"\n                    >\n                    ',"\n                </div>"]);return mg=function(){return e},e}function kg(){var e=El()(['\n            <div class="b-grid-footer-scroller b-grid-footer-scroller-','">\n                <div data-reference="footersElement" class="b-grid-footers b-grid-footers-','" data-region="','"></div>\n            </div>\n        ']);return kg=function(){return e},e}function bg(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}yg.initClass(),yg._$name="Bar";var wg=function(e){fe()(n,e);var t=bg(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"startConfigure",value:function(e){e.scrollable.overflowX="hidden-scroll",we()(pe()(n.prototype),"startConfigure",this).call(this,e)}},{key:"refreshContent",value:function(){this.element.firstElementChild.innerHTML=this.contentTemplate(),this.fixFooterWidths()}},{key:"onPaint",value:function(e){e.firstPaint&&this.refreshContent()}},{key:"template",value:function(){var e=this.subGrid.region;return Iu.tpl(kg(),e,e,e)}},{key:"getFooter",value:function(e){return this.getBarCellElement(e)}},{key:"contentTemplate",value:function(){return this.columns.visibleColumns.map((function(e){return e.hidden?"":Iu.tpl(mg(),e.align?"b-grid-footer-align-".concat(e.align):"",e.cls||"",e.field||"",e.id,e.allIndex,e.footerText||"")})).join("")}},{key:"fixFooterWidths",value:function(){this.fixCellWidths()}},{key:"subGrid",get:function(){return this._subGrid},set:function(e){this._subGrid=this.owner=e}},{key:"overflowElement",get:function(){return this.footersElement}}],[{key:"$name",get:function(){return"Footer"}},{key:"type",get:function(){return"gridfooter"}}]),n}(yg);function Cg(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}wg.initClass(),wg._$name="Footer";var Sg=function(e){fe()(n,e);var t=Cg(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e){Object.assign(this,{_elements:{},_elementsArray:[],_cells:{},_allCells:[],_regions:[],lastHeight:0,lastTop:-1,_dataIndex:0,_top:0,_height:0,_id:null,forceInnerHTML:!1,isGroupFooter:!1},e),we()(pe()(n.prototype),"construct",this).call(this)}},{key:"doDestroy",value:function(){var e=this;e.rowManager.isDestroying||(e.removeElements(),e.rowManager.idMap[e.id]===e&&delete e.rowManager.idMap[e.id]),we()(pe()(n.prototype),"doDestroy",this).call(this)}},{key:"addElement",value:function(e,t){var n=this,r=t.firstElementChild;for(n._elements[e]=t,n._elementsArray.push(t),n._regions.push(e),qo.assign(t,{index:n.index}),n._cells[e]=[];r;)n._cells[e].push(r),n._allCells.push(r),qo.set(r,{column:r.dataset.column,columnId:r.dataset.columnId,rowElement:r.parentNode,row:n}),r=r.nextElementSibling;t.dataset.index=n.index}},{key:"getElement",value:function(e){return this._elements[e]}},{key:"eachElement",value:function(e){for(var t=0;t<this._elementsArray.length;t++)e(this._elementsArray[t],t)}},{key:"eachCell",value:function(e){this._allCells.forEach(e)}},{key:"getCells",value:function(e){return this._cells[e]}},{key:"getCell",value:function(e){return this._allCells.find((function(t){var n=qo.get(t);return n.columnId===e||n.column===e}))}},{key:"removeElements",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;t.rowManager.trigger("removeRow",{row:t}),e||t._elementsArray.forEach((function(e){return e.remove()})),t._elements={},t._cells={},t._elementsArray.length=t._regions.length=t._allCells.length=t.lastHeight=t.height=0,t.lastTop=-1}},{key:"updateElementsHeight",value:function(){var e=this;if(e.rowManager.storeKnownHeight(e.id,e.height),e.lastHeight!==e.height){for(var t=e._elementsArray,n=0;n<t.length;n++)t[n].style.height="".concat(e.offsetHeight,"px");e.lastHeight=e.height}}},{key:"addCls",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.eachElement((function(e){return Cr.addClasses(e,t)}))}},{key:"removeCls",value:function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];this.eachElement((function(e){return Cr.removeClasses(e,t)}))}},{key:"setTop",value:function(e,t){this._top!==e&&(this._top=e,this.translateElements(t))}},{key:"setBottom",value:function(e,t){this.setTop(e-this.offsetHeight,t)}},{key:"translateElements",value:function(e){var t=this,n=t.grid.positionMode;if(t.lastTop!==t.top){for(var r=t._elementsArray,i=0;i<r.length;i++){var o=r[i].style;"translate"===n?o.transform="translate(0,".concat(t.top,"px)"):"translate3d"===n?o.transform="translate3d(0,".concat(t.top,"px,0)"):"position"===n&&(o.top="".concat(t.top,"px"))}e||t.rowManager.trigger("translateRow",{row:t}),t.lastTop=t.top}}},{key:"offset",value:function(e){var t=this._top+e;return t<0&&(e-=t,t=0),this.setTop(t),e}},{key:"render",value:function(e,t){var n,r,i,o,a=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],s=arguments.length>3&&void 0!==arguments[3]&&arguments[3],u=this,c=u.cells,l=u.grid,f=u.rowManager,d=u.height,h=u._id,v=u._elementsArray,p=qo.get(v[0]),g=f._rowHeight,y=a&&l.transitionDuration?"".concat(u.cls," b-grid-row-updating"):u.cls,m=0;t||!1===t||(t=l.store.getById(p.id),e=l.store.indexOf(t));var k=t&&l.isSelected(t.id);for(f.trigger("beforeRenderRow",{row:u,record:t,recordIndex:e,oldId:h});m<v.length;m++)(r=v[m]).className=y,k&&r.classList.add("b-selected"),t.cls&&t.cls.split(" ").forEach((function(e){return r.classList.add(e)}));a&&l.transitionDuration&&u.setTimeout((function(){v.forEach((function(e){e.classList.remove("b-grid-row-updating")}))}),l.transitionDuration),u.id=t.id,u.dataIndex=e;var b=!l.fixedRowHeight&&l.getRowHeight(t)||g,w=null;for(m=0;m<c.length;m++)i=c[m],o=u.renderCell(i,t,m,a,b),f.fixedRowHeight||null!=o.height&&(w=Math.max(w,o.height));u.height=null!==(n=w)&&void 0!==n?n:b,u.updateElementsHeight(),a&&(d!==u.height&&f.translateFromRow(u,s),f.trigger("updateRow",{row:u,record:t,recordIndex:e,oldId:h}),f.trigger("renderDone")),f.trigger("renderRow",{row:u,record:t,recordIndex:e,oldId:h}),u.forceInnerHTML=!1}},{key:"renderCell",value:function(e,t,n){var r,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=arguments.length>4?arguments[4]:void 0,a=this,s=a.grid,u=qo.get(e),c=s.columns.getById(u.columnId),f=u.rowElement,d=qo.get(f),h=c.internalCellCls,v=c.cellCls,p=c.align,g=c.renderer,y=c.defaultRenderer,m=c.id,k={columnId:m,id:d.id},b=g||y;if(!t){if(null===d.id)return void(e.className="b-grid-cell");if(!(t=s.store.getById(d.id)))return}var w=c.getRawValue(t),C=!0,S=t.fieldMap[c.field],D={configuredHeight:o,height:null},R={cellElement:e,dataField:S,rowElement:f,value:w,record:t,column:c,size:D,grid:s,row:u.row,updatingSingleRow:i},x=(r={"b-grid-cell":1},ke()(r,h,h),ke()(r,v,t.isSpecialRow&&"b-check-cell"===c.internalCellCls?void 0:v),ke()(r,"b-cell-dirty",t.isFieldModified(c.field)),ke()(r,"b-grid-cell-align-".concat(p),p),ke()(r,"b-selected",s.isSelected(k)),ke()(r,"b-focused",s.isFocused(k)),r);Cr.syncClassList(e,x),b?void 0===(w=b.call(c,R))&&(C=!1):S&&(w=S.print(w)),s.processCellContent&&(C=s.processCellContent({cellContent:w,cellElement:e,record:t,cellElementData:u,rendererData:R}));var E=R.cellContent=null==w?"":String(w);if(C)if(a.forceInnerHTML&&(e.innerHTML="",e.lastDomConfig=null),c.htmlEncode&&!c.disableHtmlEncode)j.a.isLinux||e._hasHtml?(e.innerText=E,e._hasHtml=!1):Cr.setInnerText(e,E);else{var T="string"==typeof w,M="object"===l()(w);!c.autoSyncHtml||T&&!e.childElementCount?M?Gs.sync({targetElement:e,domConfig:{onlyChildren:!0,children:Array.isArray(w)?w:[w]}}):e._content!==E&&(e.innerHTML=e._content=E):T?Cr.sync(E,e.firstElementChild):Gs.sync({domConfig:w,targetElement:e})}return a.rowManager.trigger("renderCell",R),D}},{key:"index",get:function(){return this._index},set:function(e){this._index=e}},{key:"dataIndex",get:function(){return this._dataIndex},set:function(e){if(this._dataIndex!==e){var t=this._elementsArray;this._dataIndex=e;for(var n=0;n<t.length;n++)t[n].dataset.index=e}}},{key:"id",get:function(){return this._id},set:function(e){var t=this,n={id:e},r=t.rowManager.idMap,i=t._elementsArray,o=t._allCells;if(t._id!=e||r[e]!==t){r[t._id]===t&&delete r[t._id],r[e]=t,t._id=e;for(var a=0;a<i.length;a++)qo.assign(i[a],n);for(var s=0;s<o.length;s++)qo.assign(o[s],n);for(var u=0;u<i.length;u++)i[u].dataset.id=e}}},{key:"elements",get:function(){return this._elements}},{key:"cells",get:function(){return this._allCells}},{key:"height",get:function(){return this._height},set:function(e){this._height=e}},{key:"offsetHeight",get:function(){return this.height+this.grid._rowBorderHeight}},{key:"isFirst",get:function(){return 0===this.dataIndex}},{key:"top",get:function(){return this._top}},{key:"bottom",get:function(){return this._top+this._height+this.grid._rowBorderHeight}}],[{key:"defaultConfig",get:function(){return{cls:"b-grid-row"}}}]),n}(_a(ue));function Dg(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Rg(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Rg(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Rg(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function xg(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Sg._$name="Row";var Eg=function(e){fe()(n,e);var t=xg(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e){e.grid._rowManager=this,we()(pe()(n.prototype),"construct",this).call(this,e.grid,e)}},{key:"doDestroy",value:function(){this._rows.forEach((function(e){return e.destroy()})),we()(pe()(n.prototype),"doDestroy",this).call(this)}},{key:"initWithHeight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;return n.autoHeight&&(e=n.store.allCount*n.preciseRowOffsetHeight),n.viewHeight=e,n.calculateRowCount(t),e}},{key:"reinitialize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;t.calculateRowCount(!1,!0,!0),t.topIndex+t.rowCount-1>t.store.count&&(e=!0);var n=t.topRow&&!e?t.topRow.top:0;t.scrollTargetRecordId=null,e&&(t.topIndex=t.lastScrollTop=0);var r=t.topRow;r&&(r.dataIndex=t.topIndex,r.setTop(n,!0)),t.estimateTotalHeight(),t.renderFromRow(r)}},{key:"matchRowCount",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=t.rows,r=t.grid,i=n.length,o=i-t.rowCount;if(o)if(o<0){for(var a=[],s=i,u=i?n[i-1].dataIndex+1:0;s<t.rowCount;s++,u++)a.push(new Sg({rowManager:t,grid:r,index:s,dataIndex:u}));n.push.apply(n,a),t.trigger("addRows",{rows:a}),e||t.renderFromRow(n[Math.max(0,i-1)])}else{var c=n.splice(i-o,o);t.trigger("removeRows",{rows:c}),c.forEach((function(e){return e.destroy()}))}}},{key:"calculateRowCount",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.store,o=Math.ceil(r.viewHeight/r.minRowOffsetHeight),a=o+r.prependRowBuffer+r.appendRowBuffer;return!r.grid.columns.count||isNaN(o)?(r.rowCount=0,0):(a<r.rowCount&&!t||(r.visibleRowCount=o,r.rowCount=Math.min(i.count,a),e||(r.rows&&r.rowCount!==r.rows.length?r.matchRowCount(n):r.rowCount||r.trigger("changeTotalHeight",{totalHeight:r.totalHeight}),r.grid.toggleEmptyText())),r.rowCount)}},{key:"removeAllRows",value:function(){var e=this,t=e.topRow,n=t?e.refreshDetails={topRowIndex:t.dataIndex,topRowTop:t.top}:e.refreshDetails,r=e.rows.slice();return e.trigger("removeRows",{rows:r}),e.rows.forEach((function(e){return e.destroy()})),e.rows.length=0,e.idMap={},n}},{key:"setPosition",value:function(e){var t=this.topRow,n=e.topRowIndex,r=e.topRowTop;t.setTop(r),t.dataIndex=n}},{key:"getRow",value:function(e){return this.rowCount&&this.rows[e-this.topIndex]}},{key:"getRowById",value:function(e){return e&&e.isModel&&(e=e.id),this.idMap[e]}},{key:"getRowFromElement",value:function(e){return(e=e.closest(".b-grid-row"))&&this.getRow(e.dataset.index)}},{key:"getRowAt",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return t||(e-=En.from(this.grid.bodyContainer,null,!0).roundPx(1).top,e+=this.grid.scrollable.y),e=Cr.roundPx(e),this.rows.find((function(t){return e>=t.top&&e<t.bottom}))}},{key:"getRowFor",value:function(e){return e instanceof HTMLElement?this.getRowFromElement(e):this.getRowById(e)}},{key:"getNextRow",value:function(e){var t="number"==typeof e?e:e.index;return this.getRow((t+1)%this.rowCount)}},{key:"offsetRows",value:function(e){if(0!==e)for(var t=this.rows,n=t.length,r=0;r<n;r++)t[r].offset(e);this.trigger("offsetRows",{offset:e})}},{key:"storeKnownHeight",value:function(e,t){var n=this,r=n.heightMap;n.fixedRowHeight||(r.has(e)&&(n.totalKnownHeight-=r.get(e)),r.set(e,t),n.totalKnownHeight+=t,t<n.minRowHeight&&(n.minRowHeight=t),n.averageRowHeight=n.totalKnownHeight/r.size)}},{key:"getOffsetHeight",value:function(e){var t=this;return(t.heightMap.get(e.id)||t.grid.getRowHeight(e)||t.averageRowHeight||t.rowHeight)+t.grid._rowBorderHeight}},{key:"invalidateKnownHeight",value:function(e){var t=this;if(!t.fixedRowHeight){var n=t.heightMap;Array.isArray(e)||(e=[e]),e.forEach((function(e){e&&n.has(e.id)&&(t.totalKnownHeight-=n.get(e.id),n.delete(e.id))})),t.averageRowHeight=t.totalKnownHeight/n.size}}},{key:"clearKnownHeights",value:function(){this.heightMap.clear(),this.averageRowHeight=this.totalKnownHeight=0}},{key:"calculateTop",value:function(e){if(this.fixedRowHeight)return e*this.rowOffsetHeight;for(var t=this.store,n=0,r=0;r<e;r++){var i=t.getAt(r);n+=this.getOffsetHeight(i)}return Math.floor(n)}},{key:"getRecordCoords",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i="string"==typeof e||"number"==typeof e?e:e.id,o=r.getRowById(e),a=r.client._bodyRectangle;return t||(a=r.client._bodyRectangle=En.client(r.client.bodyContainer)),o?new En(a.x,t?Math.round(o.top):Math.round(o.top+a.y-r.client.scrollable.y),a.width,o.offsetHeight):r.getRecordCoordsByIndex(r.store.indexOf(i),t,n)}},{key:"getRecordCoordsByIndex",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.topRow,o=r.bottomRow,a=r.client._bodyRectangle,s=r.store.getAt(e),u=s.id,c=r.preciseRowOffsetHeight,l=i.dataIndex,f=o.dataIndex,d=e>f?{index:e-f-1,y:o.bottom,from:"bottomRow"}:e>l/2?{index:e-l,y:i.top,from:"topRow"}:{index:e,y:0,from:"top"},h=r.allHeightsKnown&&!n?r.calculateTop(e):Math.floor(d.y+d.index*c),v=new En(a.x,t?h:h+a.y-r.client.scrollable.y,a.width,Math.floor(r.heightMap.get(u)||c));return v.virtual=!0,v.block=v.bottom<a.y?"start":v.y>a.bottom?"end":"nearest",v}},{key:"forEach",value:function(e){this.rows.forEach(e)}},{key:Symbol.iterator,value:function(){return this.rows[Symbol.iterator]()}},{key:"refreshCell",value:function(e,t){var n=this.getRowFor(e);if(n){var r=n.getCell(t);if(r)return n.renderCell(r),!0}return!1}},{key:"returnToTop",value:function(){var e=this;e.topIndex=0,e.lastScrollTop=0,e.topRow&&(e.topRow.dataIndex=0,e.topRow.setTop(0,!0)),e.refresh(),e.grid.scrollable.y=0}},{key:"renderFromRecord",value:function(e){var t=this.getRowById(e.id);t&&this.renderFromRow(t)}},{key:"renderFromRow",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=this,n=t.rows,r=t.store,i=r.count;if(0!==t.calculateRowCount(!1,i<n.length,!0)){for(var o,a=e?n.indexOf(e):0,s=e?e.dataIndex:n[0].dataIndex,u=i-s-1,c=Math.min(n.length-1,a+u),l=n.length-c-1,f=a>0?n[a-1].bottom:n[a].top,d=a;d<=c;d++)(o=n[d]).dataIndex=s,o.setTop(f,!0),o.render(s,r.getAt(s++),!1),f+=o.offsetHeight;for(;l-- >0;)t.displayRecordAtTop();t.estimateTotalHeight(!0),t.trigger("renderDone")}}},{key:"renderRows",value:function(e){var t,n=!1;(e=Array.from(e)).sort((function(e,t){return e.dataIndex-t.dataIndex}));var r,i=Dg(e);try{for(i.s();!(r=i.n()).done;){var o=r.value;t=o.height,o.render(null,null,!1),n|=o.height!==t}}catch(e){i.e(e)}finally{i.f()}n&&this.translateFromRow(e[0]),this.trigger("renderDone")}},{key:"translateFromRow",value:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=this,o=e.bottom;for(n=e.dataIndex+1,t=i.getRow(n);t;t=i.getRow(++n))t.setTop(o),o+=t.offsetHeight;r||i.estimateTotalHeight(!0)}},{key:"refresh",value:function(){var e=this.topRow;e&&(this.idMap={},this.renderFromRow(e),this.trigger("refresh"))}},{key:"jumpToPosition",value:function(e,t){var n=this,r=n.store,i=n.heightMap,o=r.count;if(n.allHeightsKnown&&!n.fixedRowHeight){for(var a=e-n.prependBufferHeight,s=n.grid._rowBorderHeight,u=0,c=0;u<a;){var l=r.getAt(c);u+=i.get(l.id)+s,c++}var f=Math.max(Math.min(c,o-n.rowCount),0);n.lastScrollTop=e,n.topRow.dataIndex=n.topIndex=f,n.topRow.setTop(n.calculateTop(f),!1),n.refresh()}else{var d=n.preciseRowOffsetHeight,h=null==t?Math.floor(e/d)-n.prependRowBuffer:t-Math.floor(n.rowCount/2),v=Math.max(Math.min(h,o-n.rowCount),0),p=n.client.scrollable.y,g=Math.min(n.client._bodyRectangle.height+p+n.appendBufferHeight,n.totalHeight);if(n.lastScrollTop=e,n.topRow.dataIndex=n.topIndex=v,n.topRow.setTop(Math.floor(v*d),!1),n.refresh(),n.bottomRow.bottom<g)for(n.calculateRowCount(!1,!1,!1);n.bottomRow.bottom<g&&n._rows[n.prependRowBuffer].top<p&&n.bottomRow.dataIndex<o-1;)n.displayRecordAtBottom();n.estimateTotalHeight()}if(null!=t){var y=n.grid.scrollable,m=n.getRow(t),k=m&&En.from(m._elementsArray[0]).center.y,b=y.viewport.center.y;m&&(y.y=e=Math.floor(y.y+(k-b)))}return e}},{key:"warpIfNeeded",value:function(e){var t,n=this,r={newScrollTop:e,deltaTop:e-n.lastScrollTop};Math.abs(r.deltaTop)>n.rowCount*n.rowOffsetHeight*3&&(n.scrollTargetRecordId&&(t=n.store.indexOf(n.scrollTargetRecordId)),r.newScrollTop=n.jumpToPosition(e,t),r.deltaTop=0);return r}},{key:"updateRenderedRows",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.client._bodyRectangle;if(0===r.rowCount)return 0;var o=r.totalHeight;if(t||Math.abs(e-r.lastScrollTop)>=r.rowOffsetHeight||r.topRow.top>e||r.bottomRow.bottom<e+i.height){var a=r.warpIfNeeded(e);r.scrollTargetRecordId=null,r.lastScrollTop=a.newScrollTop,a.deltaTop>0?r.fillBelow(a.newScrollTop):a.deltaTop<0&&r.fillAbove(a.newScrollTop),r.fixedRowHeight||n||r.correctError(a,i,e),o=r.estimateTotalHeight()}return o}},{key:"correctError",value:function(e,t,n){var r=this,i=0;(r.allHeightsKnown||e.deltaTop<0&&n<2*t.height||e.deltaTop>0&&n>r.totalHeight-2*t.height-3)&&(i=r.topRow.top-r.calculateTop(r.topRow.dataIndex)),i&&(r.offsetRows(-i),r.grid.scrollable.y=r.lastScrollTop=r.grid.scrollable.y-i)}},{key:"fillAbove",value:function(e){for(var t=this,n=e-t.topRow.top-t.prependBufferHeight,r=0;r>n&&t.topIndex>0;)r-=t.displayRecordAtTop();t.trigger("renderDone")}},{key:"fillBelow",value:function(e){for(var t=this,n=e-t.topRow.top-t.prependBufferHeight,r=t.store.count,i=t.rowCount,o=0;o<n&&t.topIndex+i<r&&t.topRow.top+t.topRow.offsetHeight<e;)o+=t.displayRecordAtBottom();t.trigger("renderDone")}},{key:"estimateTotalHeight",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;if(!t.grid.renderingRows){var n,r=t.store.count,i=r-t.heightMap.size,o=t.bottomRow;if(t.fixedRowHeight)n=r*t.rowOffsetHeight;else{if(n=t.totalKnownHeight+t.heightMap.size*t.grid._rowBorderHeight+i*t.preciseRowOffsetHeight,o&&i){var a=o.bottom;(a>n||t.topIndex+t.rowCount>=r&&n>a)&&(n=a,o.dataIndex<r-1&&(n+=(r-1-o.dataIndex)*t.preciseRowOffsetHeight))}n=Math.floor(n)}return n!==t.totalHeight&&!1!==t.trigger("changeTotalHeight",{totalHeight:n,immediate:e})&&(t._totalHeight=n),n}}},{key:"displayRecordAtTop",value:function(){var e=this,t=e.topIndex-1,n=e.store.getAt(t),r=e.bottomRow,i=r.top;return e.trigger("beforeTranslateRow",{row:r,newRecord:n}),r._top=e.topRow.top-e.getOffsetHeight(n),r.estimatedTop=!e.fixedRowHeight,r.render(t,n,!1),r._top=i,r.setBottom(e.topRow.top),r.estimatedTop=!1,e.topIndex--,e._rows.unshift(e._rows.pop()),r.offsetHeight}},{key:"displayRecordAtBottom",value:function(){var e=this,t=e.topIndex+e.rowCount,n=e.store.getAt(t),r=e.topRow;return e.trigger("beforeTranslateRow",{row:r,newRecord:n}),r.dataIndex=t,r.setTop(e.bottomRow.bottom),r.render(t,n,!1),e.topIndex++,e._rows.push(e._rows.shift()),r.offsetHeight}},{key:"store",get:function(){return this.client.store}},{key:"rows",get:function(){return this._rows}},{key:"topRow",get:function(){return this.rows[0]}},{key:"bottomRow",get:function(){var e=Math.min(this.rowCount,this.store.count);return this.rows[e-1]}},{key:"firstVisibleRow",get:function(){var e=this;return this.rows.find((function(t){return t.bottom>e.grid.scrollable.y}))}},{key:"firstFullyVisibleRow",get:function(){var e=this;return this.rows.find((function(t){return t.top>=e.grid.scrollable.y}))}},{key:"lastVisibleRow",get:function(){var e=this.grid;return De.findLast(this.rows,(function(t){return t.top<e.scrollable.y+e.bodyHeight}))}},{key:"rowHeight",get:function(){return this._rowHeight},set:function(e){var t=this,n=t.grid,r=t.fixedRowHeight,i=t.rowHeight;if(an.assertNumber(e,"rowHeight"),e<10&&(e=10),t.trigger("beforeRowHeight",{height:e}),t.minRowHeight=t._rowHeight=e,t.prependBufferHeight=t.prependRowBuffer*t.rowOffsetHeight,t.appendBufferHeight=t.appendRowBuffer*t.rowOffsetHeight,r&&(t.averageRowHeight=e),t.rows.length){var o,a,s=n.scrollable.y,u=t.getRowAt(s,!0),c=u?u.top-s:0;r?(o=e,a=i):(a=o=t.averageRowHeight,t.clearKnownHeights(),o*=e/i),t.calculateRowCount(!1,!0,!0),t.topRow.setTop(t.topRow.dataIndex*(o+n._rowBorderHeight),!0),t.refresh(),s*(o/a)!==s&&n.scrollRowIntoView(u.id,{block:"start",edgeOffset:c})}t.trigger("rowHeight",{height:e})}},{key:"rowOffsetHeight",get:function(){return Math.floor(this.preciseRowOffsetHeight)}},{key:"preciseRowOffsetHeight",get:function(){return(this.averageRowHeight||this._rowHeight)+this.grid._rowBorderHeight}},{key:"minRowOffsetHeight",get:function(){return(this.minRowHeight||this._rowHeight)+this.grid._rowBorderHeight}},{key:"allHeightsKnown",get:function(){return this.fixedRowHeight||this.heightMap.size>=this.store.count}},{key:"totalHeight",get:function(){return this._totalHeight}},{key:"widgetClass",get:function(){}}],[{key:"pluginConfig",get:function(){return{chain:["getRowById","getRecordCoords","getRow","getRowFor","getRowFromElement","destroy"],assign:["rowHeight","topRow","bottomRow"]}}},{key:"defaultConfig",get:function(){return{prependRowBuffer:5,appendRowBuffer:5,rowHeight:null,fixedRowHeight:null,autoHeight:!1}}},{key:"properties",get:function(){return{idMap:{},topIndex:0,lastScrollTop:0,_rows:[],heightMap:new Map,totalKnownHeight:0,_totalHeight:0,averageRowHeight:0,scrollTargetRecordId:null,refreshDetails:{topRowIndex:0,topRowTop:0}}}}]),n}(qr);function Tg(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Mg(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Mg(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Mg(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ag(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Eg._$name="RowManager";var Pg={x:1},Ig=function(e){fe()(n,e);var t=Ag(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"addScroller",value:function(e){(this.xScrollers||(this.xScrollers=[])).push(e)}},{key:"addPartner",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Pg;if("string"==typeof t&&(t=ke()({},t,1)),t.x)for(var r=0;r<this.xScrollers.length;r++)this.xScrollers[r].addPartner(e.xScrollers[r],"x");t.y&&we()(pe()(n.prototype),"addPartner",this).call(this,e,"y")}},{key:"updateOverflowX",value:function(e){this.xScrollers&&this.xScrollers.forEach((function(t){return t.overflowX=e})),this.widget.virtualScrollers.classList[!1===e?"add":"remove"]("b-hide-display")}},{key:"scrollIntoView",value:function(e,t){if(1!==e.nodeType)return we()(pe()(n.prototype),"scrollIntoView",this).call(this,e,t);var r,i=Tg(this.xScrollers);try{for(i.s();!(r=i.n()).done;){var o=r.value;if(o.element.contains(e))return o.scrollIntoView(e,t)}}catch(e){i.e(e)}finally{i.f()}}},{key:"x",set:function(e){this.xScrollers&&(this.xScrollers[0].x=e)},get:function(){return this.xScrollers?this.xScrollers[0].x:0}}]),n}(Hu);function Og(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Fg(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Fg(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Fg(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Lg(){var e=El()(['\n                <div class="b-grid-header" data-column="','" data-column-id="','" ','>\n                    <div class="b-grid-header-text">\n                        <div class="b-grid-header-text-content"></div>\n                    </div>\n                    ','\n                    <div class="b-grid-header-resize-handle"></div>\n                </div>\n            ']);return Lg=function(){return e},e}function jg(){var e=El()(['\n            <div class="b-grid-header-scroller b-grid-header-scroller-','">\n                <div data-reference="headersElement" class="b-grid-headers b-grid-headers-','" data-region="','" data-max-depth="','" data-reference="headersElement"></div>\n            </div>\n        ']);return jg=function(){return e},e}function _g(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Ig._$name="GridScroller";var Bg=function(e){fe()(n,e);var t=_g(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"startConfigure",value:function(e){e.scrollable.overflowX="hidden-scroll",we()(pe()(n.prototype),"startConfigure",this).call(this,e)}},{key:"template",value:function(){var e=this.region;return Iu.tpl(jg(),e,e,e,this.maxDepth)}},{key:"contentTemplate",value:function(e){var t=this;return e.hidden?"":Iu.tpl(Lg(),e.field||"",e.id,e.isFocusable?'tabindex="0"':"",e.children?'\n                    <div class="b-grid-header-children">\n                            '.concat(e.children.map((function(e){return t.contentTemplate(e)})).join(""),"\n                    </div>\n                    "):"")}},{key:"calculateMinWidthForSafari",value:function(){var e=0;return this.columns.visibleColumns.forEach((function(t){e+=t.calculateMinWidth()})),e}},{key:"fixHeaderWidths",value:function(){this.fixCellWidths()}},{key:"refreshHeaders",value:function(){var e=this;e.columns.traverse((function(t){var n=e.getBarCellElement(t.id);if(n){var r,i=new An((r={"b-grid-header":1,"b-grid-header-parent":t.isParent},ke()(r,"b-level-".concat(t.childLevel),1),ke()(r,"b-depth-".concat(t.meta.depth),1),ke()(r,"b-grid-header-align-".concat(t.align),t.align),ke()(r,"b-grid-header-resizable",t.resizable&&t.isLeaf),ke()(r,t.cls,t.cls),ke()(r,"b-last-parent",t.isParent&&t.isLastInSubGrid),ke()(r,"b-last-leaf",t.isLeaf&&t.isLastInSubGrid),r)),o=t.text;n.className=i,t.headerRenderer&&(o=t.headerRenderer.call(t.thisObj||e,{column:t,headerElement:n})),t.icon&&(o='<i class="'.concat(t.icon,'"></i>')+(o||""));var a=n.querySelector(".b-grid-header-text-content");a&&(a.innerHTML=o||"")}})),e.fixHeaderWidths()}},{key:"initDepths",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.columns.topColumns,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this,r=0;t&&t.meta&&t.meta.depth++;var i,o=Og(e);try{for(o.s();!(i=o.n()).done;){var a=i.value;a.meta.depth=0,a.children&&(n.initDepths(a.children.filter(n.columns.chainedFilterFn),a),a.meta.depth&&t&&(t.meta.depth+=a.meta.depth)),a.meta.depth>r&&(r=a.meta.depth)}}catch(e){o.e(e)}finally{o.f()}return t||(n.maxDepth=r),r}},{key:"getHeader",value:function(e){return this.getBarCellElement(e)}},{key:"refreshContent",value:function(){var e=this;e.content=e.columns.topColumns.map((function(t){return e.contentTemplate(t)})).join(""),e.refreshHeaders()}},{key:"onPaint",value:function(e){e.firstPaint&&this.refreshContent()}},{key:"subGrid",get:function(){return this._subGrid},set:function(e){this._subGrid=e,this.id=e.id+"-header"}},{key:"region",get:function(){return this.subGrid&&this.subGrid.region}},{key:"overflowElement",get:function(){return this.headersElement}},{key:"columns",get:function(){var e=this,t=we()(pe()(n.prototype),"columns",this);return e.columnsDetacher||(e.columnsDetacher=t.on({change:function(){e.initDepths()},thisObj:e}),e.initDepths()),t},set:function(e){sc()(pe()(n.prototype),"columns",e,this,!0)}},{key:"contentElement",get:function(){return this.element.firstElementChild}}],[{key:"$name",get:function(){return"Header"}},{key:"type",get:function(){return"gridheader"}}]),n}(yg);function Hg(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Bg.initClass(),Bg._$name="Header";var $g={touchstart:"onElementTouchStart",touchmove:"onElementTouchMove",touchend:"onElementTouchEnd",mouseover:"onElementMouseOver",mouseout:"onElementMouseOut",mousedown:"onElementMouseDown",mousemove:"onElementMouseMove",mouseup:"onElementMouseUp",click:"onHandleElementClick",dblclick:"onElementDblClick",keydown:"onElementKeyDown",keyup:"onElementKeyUp",keypress:"onElementKeyPress",contextmenu:"onElementContextMenu"};function Ng(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var Vg={string:1,object:1,function:1};function zg(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var Wg=Object.freeze({doSelect:!0}),Gg=Object.freeze({x:!1,y:!1});function Yg(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}function Ug(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return qg(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return qg(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function qg(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Kg(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var Xg={string:1,number:1},Zg={dataset:1,batch:1};function Jg(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var Qg=function(e){return e.columns.suspendEvents()},ey=function(e){return e.columns.resumeEvents()},ty=function(e){e.columns.clearCaches(),e.columns.fillFromMaster()},ny=function(e,t){return e.stateSortIndex-t.stateSortIndex};function ry(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var iy=Promise.resolve(),oy={block:"nearest"},ay=function(e){fe()(n,e);var t=ry(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"scrollIntoView",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:oy,n=this,r=n.getDeltaTo(e,t),i=r.xDelta,o=r.yDelta,a=i||o?n.scrollBy(i,o,t):iy;return(t.highlight||t.focus)&&a.then((function(){t.highlight&&(e instanceof En?e.translate(-i,-o).highlight():Cr.highlight(e)),t.focus&&e.focus&&e.focus()})),a}},{key:"scrollBy",value:function(e,t,r){var i=t&&this.yScroller.scrollBy(0,t,r),o=e&&we()(pe()(n.prototype),"scrollBy",this).call(this,e,0,r);if(o&&o.cancel&&i&&i.cancel){var a=o.cancel,s=i.cancel;return o.cancel=i.cancel=function(){a(),s()},Promise.all([o,i])}return o||i||iy}},{key:"scrollTo",value:function(e,t,r){var i=null!=t&&this.yScroller.scrollTo(null,t,r),o=null!=e&&we()(pe()(n.prototype),"scrollTo",this).call(this,e,null,r);if(r&&r.animate||this.syncPartners(),o&&o.cancel&&i&&i.cancel){var a=o.cancel,s=i.cancel;return o.cancel=i.cancel=function(){a(),s()},Promise.all([o,i])}return o||i||iy}},{key:"viewport",get:function(){var e=En.from(this.element);return e.intersect(En.from(this.yScroller.element))||new En(e.x,e.y,e.width,0)}},{key:"y",set:function(e){this.yScroller&&(this.yScroller.y=e)},get:function(){return this.yScroller?this.yScroller.y:0}},{key:"maxY",get:function(){return this.yScroller?this.yScroller.maxY:0}},{key:"scrollHeight",get:function(){return this.yScroller?this.yScroller.scrollHeight:0}},{key:"clientHeight",get:function(){return this.yScroller?this.yScroller.clientHeight:0}}]),n}(Hu);function sy(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return uy(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return uy(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function uy(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function cy(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}ay._$name="SubGridScroller";var ly=function(e){fe()(i,e);var t,n,r=cy(i);function i(){return v()(this,i),r.apply(this,arguments)}return g()(i,[{key:"construct",value:function(e){we()(pe()(i.prototype),"construct",this).call(this,e),this.rowManager.on("addrows",this.onAddRow,this)}},{key:"doDestroy",value:function(){var e,t=this;t.header.destroy(),t.footer.destroy(),null===(e=t.fakeScroller)||void 0===e||e.destroy(),t.virtualScrollerElement.remove(),t.splitterElement.remove(),t.headerSplitter.remove(),t.scrollerSplitter.remove(),t.footerSplitter.remove(),we()(pe()(i.prototype),"doDestroy",this).call(this)}},{key:"changeHeader",value:function(){return new this.headerClass(this.barConfig)}},{key:"changeFooter",value:function(){return new this.footerClass(this.barConfig)}},{key:"toggleSplitterCls",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this,r=[n.splitterElement,n.headerSplitter,n.footerSplitter,n.scrollerSplitter];r.forEach((function(n){return null==n?void 0:n.classList[t?"add":"remove"](e)}))}},{key:"changeElement",value:function(e){var t,n=this.region;we()(pe()(i.prototype),"changeElement",this).call(this,{className:(t={"b-grid-subgrid":1},ke()(t,"b-grid-subgrid-".concat(n),1),ke()(t,"b-grid-horizontal-scroller",1),ke()(t,"b-grid-subgrid-collapsed",this.collapsed),t),dataset:{region:n}})}},{key:"changeVirtualScrollerElement",value:function(){var e=Cr.createElement({reference:"virtualScrollerElement",className:"b-virtual-scroller",dataset:{region:this.region},children:[{reference:"virtualScrollerWidth",className:"b-virtual-width"}]});return this.virtualScrollerWidth=e.virtualScrollerWidth,e.virtualScrollerElement}},{key:"changeSplitterElement",value:function(){var e=Cr.createElement({reference:"splitterElement",className:{"b-grid-splitter":1,"b-grid-splitter-collapsed":this.collapsed,"b-hide-display":1},dataset:{region:this.region},children:[{className:"b-grid-splitter-inner b-grid-splitter-main",children:[{className:"b-grid-splitter-buttons",reference:"splitterButtons",children:[{tag:"i",className:"b-icon b-icon-collapse-gridregion"},{tag:"i",className:"b-icon b-icon-expand-gridregion"}]}]}]});return this.splitterButtons=e.splitterButtons,e.splitterElement}},{key:"changeHeaderSplitter",value:function(){return Cr.createElement(this.splitterConfig)}},{key:"changeScrollerSplitter",value:function(){return Cr.createElement(this.splitterConfig)}},{key:"changeFooterSplitter",value:function(){return Cr.createElement(this.splitterConfig)}},{key:"hideSplitter",value:function(){this.splitterElement.classList.add("b-hide-display"),this.headerSplitter.classList.add("b-hide-display"),this.scrollerSplitter.classList.add("b-hide-display"),this.footerSplitter.classList.add("b-hide-display"),this.$showingSplitter=!1}},{key:"showSplitter",value:function(){this.splitterElement.classList.remove("b-hide-display"),this.headerSplitter.classList.remove("b-hide-display"),this.scrollerSplitter.classList.remove("b-hide-display"),this.footerSplitter.classList.remove("b-hide-display"),this.$showingSplitter=!0}},{key:"render",value:function(){for(var e,t=this,n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];(e=we()(pe()(i.prototype),"render",this)).call.apply(e,[this].concat(r)),t.grid&&(t.updateHasFlex(),t.element.parentNode.insertBefore(t.splitterElement,t.element.nextElementSibling),nu.on({element:t.grid.element,delegate:".b-grid-splitter[data-region=".concat(t.region,"]"),mouseover:"onSplitterMouseOver",mouseout:"onSplitterMouseOut",thisObj:t}),t._collapsed&&t.collapse())}},{key:"refreshHeader",value:function(){this.header.refreshContent()}},{key:"refreshFooter",value:function(){var e;null===(e=this.footer)||void 0===e||e.refreshContent()}},{key:"eachWidget",value:function(e){for(var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this,r=[n.header,n.footer],i=0;i<r.length;i++){var o=r[i];if(!1===e(o))return;t&&o.eachWidget&&o.eachWidget(e,t)}}},{key:"fixCellWidths",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;t||(t=this.columns.bottomColumns.filter((function(e){return!e.hidden})));for(var n=e.firstElementChild,r=0;n;){var i=t[r];i.minWidth&&(n.style.minWidth=Cr.setLength(i.minWidth)),i.flex?(n.style.flex=i.flex,n.style.width=""):i.width?(n.style.width=Cr.setLength(i.width),j.a.isIE11&&(n.style.flex="",n.style.minWidth=Cr.setLength(i.calcMinWidth))):n.style.flex=n.style.width=n.style.minWidth="",n=n.nextElementSibling,r++}}},{key:"fixWidths",value:function(){var e=this,t=e.element,n=e.header,r=e.footer;if(!e.collapsed){if(e.flex)n.flex=e.flex,r&&(r.flex=e.flex),t.style.flex=e.flex;else{if(e.hasCalculatedWidth&&!e.columns.some((function(e){return!e.hidden&&e.flex}))&&e.totalFixedWidth!==e.width)return e.width=e.totalFixedWidth,void(e.hasCalculatedWidth=!0);var i=e.width;if(!i){i=0;var o,a=sy(e.columns);try{for(a.s();!(o=a.n()).done;){var s=o.value;s.flex||s.hidden||(i+=s.width)}}catch(e){a.e(e)}finally{a.f()}}t.style.width="".concat(i,"px"),n.width=i,r&&(r.width=i)}e.syncScrollingPartners(!1)}}},{key:"fixRowWidthsInSafariEdge",value:function(){if(j.a.isSafari||j.a.isEdge){var e=this.region,t=this.header,n=t.calculateMinWidthForSafari();this.rowManager.forEach((function(t){var r=t.getElement(e);r&&(r.style.width="".concat(n,"px"))})),t.headersElement.style.width="".concat(n,"px")}}},{key:"onInternalResize",value:function(e,t,n,r,o){var a=this,s=a.grid;we()(pe()(i.prototype),"onInternalResize",this).call(this,e,t,n,r,o),s&&(a.syncSplitterButtonPosition(),t!==r&&(s.trigger("horizontalScroll",{subGrid:a,grid:s,scrollLeft:a.scrollable.x}),a.refreshFakeScroll(),a.fixRowWidthsInSafariEdge()),a.trigger("afterInternalResize",a))}},{key:"syncParallelSplitters",value:function(e){var t=this,n=t.grid;if(t.splitterElement&&t.$showingSplitter)t.toggleSplitterCls("b-grid-splitter-collapsed",e);else{var r=n.getSubGrid(n.getPreviousRegion(t.region));r&&r.splitterElement&&r.syncParallelSplitters(e)}}},{key:"onSplitterMouseOver",value:function(){var e=this.nextSibling;this.collapsed||e&&e.collapsed||this.toggleSplitterCls("b-hover"),this.startSplitterButtonSyncing()}},{key:"onSplitterMouseOut",value:function(){var e=this.nextSibling;this.toggleSplitterCls("b-hover",!1),this.collapsed||e&&e.collapsed||this.stopSplitterButtonSyncing()}},{key:"startSplitterButtonSyncing",value:function(){var e=this;e.splitterElement&&(e.syncSplitterButtonPosition(),e.splitterSyncScrollListener||(e.splitterSyncScrollListener=e.grid.scrollable.on({scroll:"syncSplitterButtonPosition",thisObj:e})))}},{key:"stopSplitterButtonSyncing",value:function(){this.splitterSyncScrollListener&&(this.splitterSyncScrollListener(),this.splitterSyncScrollListener=null)}},{key:"syncSplitterButtonPosition",value:function(){var e=this;e.splitterButtons.style.transform="translateY(".concat(e.grid.scrollable.y+e.grid.bodyHeight/2-(e.headerSplitter?e.grid.headerHeight:0),"px)")}},{key:"updateHasFlex",value:function(){var e=this.columns.visibleColumns.some((function(e){return e.flex}));Cr.toggleClasses(this.element,["b-has-flex"],e)}},{key:"refreshFakeScroll",value:function(){var e=this,t=e.element,n=e.virtualScrollerElement,r=e.virtualScrollerWidth,i=e.totalFixedWidth,o=e.store,a=e.header,s=e.footer,u=e.scrollable;u.scrollWidth=(null==o?void 0:o.count)?null:i,n.style.width=t.style.width,n.style.flex=t.style.flex,e.collapsed||(e.overflowingHorizontally?(r.style.width="".concat(u.scrollWidth,"px"),a.element.classList.add("b-overflowing"),s.element.classList.add("b-overflowing"),e.grid.virtualScrollers.classList.remove("b-hide-display")):(r.style.width=0,a.element.classList.remove("b-overflowing"),s.element.classList.remove("b-overflowing")))}},{key:"initScroll",value:function(){var e=this,t=e.scrollable,n=e.virtualScrollerElement;e.syncPartnersOnFrame=e.createOnFrame(e.syncScrollingPartners),j.a.isFirefox&&t.element.addEventListener("wheel",(function(e){e.deltaX&&(t.x+=e.deltaX,e.preventDefault())})),t.yScroller=e.grid.scrollable,t.yScroller.addScroller(t),e.fakeScroller=new Hu({element:n,overflowX:!0}),t.on({scroll:"onSubGridScroll",scrollend:"onSubGridScrollEnd",thisObj:e}),t.addPartner(e.fakeScroller,"x"),t.addPartner(e.header.scrollable,"x"),t.addPartner(e.footer.scrollable,"x")}},{key:"onSubGridScrollEnd",value:function(){this.forceScrollUpdate||this.syncScrollingPartners(),this.scrolling=!1}},{key:"onSubGridScroll",value:function(){this.forceScrollUpdate?(this.syncScrollingPartners(),this.forceScrollUpdate=!1):this.syncPartnersOnFrame()}},{key:"syncScrollingPartners",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this,n=t.grid;!t.scrolling&&e&&(t.scrolling=!0),n.trigger("horizontalScroll",{subGrid:t,grid:n,scrollLeft:t.scrollable.x})}},{key:"scrollColumnIntoView",value:function(e,t){var n=this,r=n.header.scrollable;if(e=e instanceof Dh?e:n.columns.get(e)||n.columns.getById(e)||n.columns.getAt(e)){var i=n.header.getHeader(e.id);if(i)return r.scrollIntoView(En.from(i,null,!0),t)}}},{key:"onAddRow",value:function(e){var t=e.rows,n=this,r=n.rowElementConfig,i=n.columns.bottomColumns.filter((function(e){return!e.hidden})),o=document.createDocumentFragment();t.forEach((function(e){var t=Cr.createElement(r);o.appendChild(t),e.addElement(n.region,t),n.fixCellWidths(t,i)})),n.fixRowWidthsInSafariEdge(),n.element.insertBefore(o,n.insertRowsBefore)}},{key:"clearRows",value:function(){this.emptyCache();var e=this.element.querySelectorAll(".b-grid-row"),t=document.createRange();e.length&&(t.setStartBefore(e[0]),t.setEndAfter(e[e.length-1]),t.deleteContents())}},{key:"addNewRowElement",value:function(){var e=Cr.append(this.element,this.rowElementConfig);return this.fixCellWidths(e),e}},{key:"toggleTransitionClasses",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=t.grid,r=n.getSubGrid(n.getNextRegion(t.region)),i=n.resolveSplitter(r);r.element.classList[e?"remove":"add"]("b-grid-subgrid-animate-collapse"),r.header.element.classList[e?"remove":"add"]("b-grid-subgrid-animate-collapse"),t.element.classList[e?"remove":"add"]("b-grid-subgrid-animate-collapse"),t.header.element.classList[e?"remove":"add"]("b-grid-subgrid-animate-collapse"),i.classList[e?"remove":"add"]("b-grid-splitter-animate")}},{key:"collapse",value:(n=Wr()(Vr.a.mark((function e(){var t,n,r,i,o;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(t=this).grid,r=n.getSubGrid(n.getNextRegion(t.region)),i=t.splitterElement?t:t.previousSibling,o=0,n.eachSubGrid((function(e){e!==t&&!e._collapsed&&++o})),0!==o){e.next=6;break}return e.next=6,r.expand();case 6:return e.abrupt("return",new Promise((function(e){if(!t._beforeCollapseState){t._beforeCollapseState={};var n=!1;t.width&&(n=!0,t.on({afterinternalresize:function(){e(t)},thisObj:t,once:!0})),t._beforeCollapseState.width=t.width,t._beforeCollapseState.elementWidth=t.element.style.width,""===r.element.style.flex&&(t._beforeCollapseState.nextRegionWidth=r.width,r.width+=t._beforeCollapseState.width),""!==t.element.style.flex&&(t._beforeCollapseState.flex=t.element.style.flex,t.header.element.style.flex=t.element.style.flex=""),t.element.classList.add("b-grid-subgrid-collapsed"),t.virtualScrollerElement.classList.add("b-collapsed"),t.header.element.classList.add("b-collapsed"),t.footer.element.classList.add("b-collapsed"),t.width="",t._collapsed=!0,n||e(!1)}})).then((function(e){t.isDestroyed||!1===e||(t.syncParallelSplitters(!0),t.grid.trigger("subGridCollapse",t),i.startSplitterButtonSyncing&&i.startSplitterButtonSyncing())})));case 7:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"expand",value:(t=Wr()(Vr.a.mark((function e(){var t,n,r,i;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(t=this).grid,r=n.getSubGrid(n.getNextRegion(t.region)),i=t.splitterElement?t:t.previousSibling,e.abrupt("return",new Promise((function(e){if(null!=t._beforeCollapseState){var n=!1;t.width!==t._beforeCollapseState.elementWidth&&(n=!0,t.on({afterinternalresize:function(){t.setTimeout((function(){return e(t)}),10)},thisObj:t,once:!0})),""===r.element.style.flex&&(r.width=t._beforeCollapseState.nextRegionWidth),t.element.classList.remove("b-grid-subgrid-collapsed"),t._collapsed=!1,t.virtualScrollerElement.classList.remove("b-collapsed"),t.header.element.classList.remove("b-collapsed"),t.footer.element.classList.remove("b-collapsed"),t._beforeCollapseState.flex?(t.width=t._beforeCollapseState.width,t.header.flex=t.flex=t._beforeCollapseState.flex,t.footer.flex=t._beforeCollapseState.flex,t._width=null):t.width=t._beforeCollapseState.elementWidth,t.element.classList.remove("b-grid-subgrid-collapsed"),t._collapsed=!1,n||e(!1),delete t._beforeCollapseState}})).then((function(e){!1!==e&&(i.stopSplitterButtonSyncing(),t.syncParallelSplitters(!1),t.grid.trigger("subGridExpand",t))})));case 2:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"barConfig",get:function(){var e=this.element.style,t=e.width,n=e.flex,r={subGrid:this,parent:this};return n?r.flex=n:t&&(r.width=t),r}},{key:"rowElementConfig",get:function(){return{className:"b-grid-row",children:this.columns.visibleColumns.map((function(e){return{className:"b-grid-cell",dataset:{column:e.field||"",columnId:e.id}}}))}}},{key:"splitterConfig",get:function(){return{className:this.splitterElement.className.trim(),children:[{className:"b-grid-splitter-inner"}],dataset:{region:this.region}}}},{key:"totalFixedWidth",get:function(){return this.columns.totalFixedWidth}},{key:"width",set:function(e){var t=this;t.hasCalculatedWidth=!1,sc()(pe()(i.prototype),"width",e,this,!0),t.header.width=e,t.footer.width=e,t.isPainted&&t.onElementResize()},get:function(){return we()(pe()(i.prototype),"width",this)}},{key:"flex",set:function(e){var t=this;t.hasCalculatedWidth=!1,t.header.flex=e,t.footer.flex=e,sc()(pe()(i.prototype),"flex",e,this,!0),t.isPainted&&t.onElementResize()},get:function(){return we()(pe()(i.prototype),"flex",this)}},{key:"viewRectangle",get:function(){return new En(this.scrollable.x,this.scrollable.y,this._width||0,this.rowManager.viewHeight)}},{key:"overflowingHorizontally",get:function(){var e=this.scrollable;return e.scrollWidth>e.clientWidth+(j.a.isEdge?1:0)}},{key:"scrolling",set:function(e){this._scrolling=e},get:function(){return this._scrolling}},{key:"rowElements",get:function(){return this.fromCache(".b-grid-row",!0)}},{key:"emptyText",get:function(){return this._emptyText},set:function(e){this._emptyText=e,this.element.dataset.emptyText=e}},{key:"collapsed",get:function(){return this._collapsed},set:function(e){this.isConfiguring?this._collapsed=e:e?this.collapse():this.expand()}}],[{key:"$name",get:function(){return"SubGrid"}},{key:"type",get:function(){return"subgrid"}},{key:"defaultConfig",get:function(){return{localizableProperties:["emptyText"],insertRowsBefore:null,appendTo:null,monitorResize:!0,headerClass:null,footerClass:null,collapsed:null,scrollable:{overflowX:!0},scrollerClass:ay,hasCalculatedWidth:null,sealedColumns:null,emptyText:null}}},{key:"configurable",get:function(){return{element:!0,header:!0,footer:!0,virtualScrollerElement:!0,splitterElement:!0,headerSplitter:!0,scrollerSplitter:!0,footerSplitter:!0}}}]),i}(oc);function fy(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return dy(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return dy(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function dy(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function hy(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}ly.initClass(),ly._$name="SubGrid";var vy=tt.mergeLocales(Nu,{ColumnPicker:{column:"Column",columnsMenu:"Columns",hideColumn:"Hide column",hideColumnShort:"Hide"},Filter:{applyFilter:"Apply filter",filter:"Filter",editFilter:"Edit filter",on:"On",before:"Before",after:"After",equals:"Equals",lessThan:"Less than",moreThan:"More than",removeFilter:"Remove filter"},FilterBar:{enableFilterBar:"Show filter bar",disableFilterBar:"Hide filter bar"},Group:{group:"Group",groupAscending:"Group ascending",groupDescending:"Group descending",groupAscendingShort:"Ascending",groupDescendingShort:"Descending",stopGrouping:"Stop grouping",stopGroupingShort:"Stop"},Search:{searchForValue:"Search for value"},Sort:{sort:"Sort",sortAscending:"Sort ascending",sortDescending:"Sort descending",multiSort:"Multi sort",removeSorter:"Remove sorter",addSortAscending:"Add ascending sorter",addSortDescending:"Add descending sorter",toggleSortAscending:"Change to ascending",toggleSortDescending:"Change to descending",sortAscendingShort:"Ascending",sortDescendingShort:"Descending",removeSorterShort:"Remove",addSortAscendingShort:"+ Ascending",addSortDescendingShort:"+ Descending"},GridBase:{loadFailedMessage:"Data loading failed!",syncFailedMessage:"Data synchronization failed!",unspecifiedFailure:"Unspecified failure",networkFailure:"Network error",parseFailure:"Failed to parse server response",loadMask:"Loading...",syncMask:"Saving changes, please wait...",noRows:"No records to display",moveColumnLeft:"Move to left section",moveColumnRight:"Move to right section",removeRow:"Delete record",removeRows:"Delete records",moveColumnTo:function(e){return"Move column to ".concat(e)}},CellMenu:{removeRow:"Delete record",removeRows:"Delete records"},PdfExport:{"Waiting for response from server":"Waiting for response from server...","Export failed":"Export failed","Server error":"Server error","Generating pages":"Generating pages..."},ExportDialog:{width:"40em",labelWidth:"12em",exportSettings:"Export settings",export:"Export",exporterType:"Control pagination",cancel:"Cancel",fileFormat:"File format",rows:"Rows",alignRows:"Align rows",columns:"Columns",paperFormat:"Paper format",orientation:"Orientation",repeatHeader:"Repeat header"},ExportRowsCombo:{all:"All rows",visible:"Visible rows"},ExportOrientationCombo:{portrait:"Portrait",landscape:"Landscape"},SinglePageExporter:{singlepage:"Single page"},MultiPageExporter:{multipage:"Multiple pages",exportingPage:function(e){var t=e.currentPage,n=e.totalPages;return"Exporting page ".concat(t,"/").concat(n)}},MultiPageVerticalExporter:{multipagevertical:"Multiple pages (vertical)",exportingPage:function(e){var t=e.currentPage,n=e.totalPages;return"Exporting page ".concat(t,"/").concat(n)}}}),py=vy;function gy(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return yy(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return yy(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function yy(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function my(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}rt.registerLocale("En",{desc:"English",locale:vy});var ky=new Promise((function(e){return e()})),by={block:"nearest",inline:"nearest"},wy={dataset:1,filter:1},Cy=function(e){fe()(n,e);var t=my(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"finishConfigure",value:function(e){var t=this;we()(pe()(n.prototype),"finishConfigure",this).call(this,e),t.scrollManager=new pg(an.assign({grid:t,verticalElement:t.scrollable.element},t.scrollManager)),rt.on({locale:"onBeforeLocaleChange",prio:1,thisObj:t}),rt.on({locale:"onLocaleChange",prio:-1,thisObj:t}),$r.on({theme:"onThemeChange",thisObj:t}),t.on({subGridExpand:"onSubGridExpand",prio:-1,thisObj:t}),t.bufferedFixElementHeights=t.buffer("fixElementHeights",350,t),t.setGridClassList(t.element.classList)}},{key:"updateEnableSticky",value:function(e){this.positionMode=e?"position":"translate",this.element.classList[e?"add":"remove"]("b-enable-sticky")}},{key:"onSubGridExpand",value:function(){this.renderContents()}},{key:"onBeforeLocaleChange",value:function(){this._suspendRenderContentsOnColumnsChanged=!0}},{key:"onLocaleChange",value:function(){this._suspendRenderContentsOnColumnsChanged=!1,this.isPainted&&this.renderContents()}},{key:"finalizeInit",value:function(){we()(pe()(n.prototype),"finalizeInit",this).call(this),this.store.isLoading&&this.onStoreBeforeRequest()}},{key:"doDestroy",value:function(){var e=this;e.detachListeners("GridBase:store");for(var t=0,r=Object.values(e.features);t<r.length;t++){var i=r[t];i.destroy&&i.destroy()}e.columns&&(e.columns=null),e.store&&(e.store=null),we()(pe()(n.prototype),"doDestroy",this).call(this)}},{key:"setGridClassList",value:function(e){var t=this;for(var n in e.add("b-grid-".concat(t.positionMode)),t.enableTextSelection||e.add("b-grid-notextselection"),t.autoHeight&&e.add("b-autoheight"),t.fillLastColumn&&e.add("b-fill-last-column"),t.showDirty&&e.add("b-show-dirty"),t.features){var r=t.features[n],i=void 0;(i=Object.prototype.hasOwnProperty.call(r.constructor,"featureClass")?r.constructor.featureClass:"b-".concat(r instanceof ue?r.$$name:r.constructor.name))&&e.add(i.toLowerCase())}}},{key:"updateHideFooters",value:function(e){var t;null===(t=this.footerContainer)||void 0===t||t.classList[e?"add":"remove"]("b-hidden")}},{key:"onColumnsChanged",value:function(e){var t=e.action,n=e.changes,r=e.record,i=this;if(i.isPainted){if("update"===t){if("width"in n||"minWidth"in n||"flex"in n){var o=r.region;return void i.columns.visibleColumns.forEach((function(e){e.region===o&&e.repaintOnResize&&i.refreshColumn(e)}))}if("hidden"in n){var a=i.getSubGridFromColumn(r.id);a.header.fixHeaderWidths(),a.footer.fixFooterWidths(),a.updateHasFlex()}}if("dataset"===t||"update"===t&&"region"in n){var s=i.columns.getDistinctValues("region"),u=De.delta(s,i.regions,!0),c=u.toRemove,l=u.toAdd;i.remove(c.map((function(e){return i.getSubGrid(e)}))),i.add(l.map((function(e){return i.createSubGrid(e)})))}i._suspendRenderContentsOnColumnsChanged||i.renderContents()}}},{key:"onColumnsResized",value:function(e){var t=e.changes,n=e.record,r=this,i=Cr.setLength(n.width),o=Cr.setLength(n.minWidth),a=r.getSubGridFromColumn(n.id);a.header.fixHeaderWidths(),a.footer.fixFooterWidths(),a.updateHasFlex(),r.cellEls&&n===r.lastColumnResized||(r.cellEls=Cr.children(r.element,'.b-grid-cell[data-column-id="'.concat(n.id,'"]')),r.lastColumnResized=n);var s,u=gy(r.cellEls);try{for(u.s();!(s=u.n()).done;){var c,l=s.value;if("width"in t&&(l.style.width=i,j.a.isIE11&&(l.style.flex="",l.style.minWidth=Cr.setLength(n.calcMinWidth))),"minWidth"in t&&(l.style.minWidth=o),"flex"in t)l.style.flex=null!==(c=n.flex)&&void 0!==c?c:null}}catch(e){u.e(e)}finally{u.f()}r.resizingColumns||r.afterColumnsResized()}},{key:"afterColumnsResized",value:function(){this.eachSubGrid((function(e){e.collapsed||(e.fixWidths(),e.fixRowWidthsInSafariEdge())})),this.lastColumnResized=this.cellEls=null,this.bufferedAfterColumnsResized()}},{key:"bufferedAfterColumnsResized",value:function(){this.refreshVirtualScrollbars(),this.eachSubGrid((function(e){e.collapsed||e.refreshFakeScroll()})),this.onHeightChange()}},{key:"processCellEditor",value:function(e){}},{key:"getRowHeight",value:function(e){return e.rowHeight}},{key:"bindStore",value:function(e){var t,n=this.asyncEventSuffix;e.on((t={name:"GridBase:store"},ke()(t,"refresh".concat(n),"onStoreDataChange"),ke()(t,"add".concat(n),"onStoreAdd"),ke()(t,"remove".concat(n),"onStoreRemove"),ke()(t,"move".concat(n),"onStoreMove"),ke()(t,"replace".concat(n),"onStoreReplace"),ke()(t,"removeAll".concat(n),"onStoreRemoveAll"),ke()(t,"idChange","onStoreRecordIdChange"),ke()(t,"update","onStoreUpdateRecord"),ke()(t,"beforeRequest","onStoreBeforeRequest"),ke()(t,"afterRequest","onStoreAfterRequest"),ke()(t,"clearChanges","onStoreDataChange"),ke()(t,"exception","onStoreException"),ke()(t,"commit","onStoreCommit"),t),this)}},{key:"unbindStore",value:function(e){this.detachListeners("GridBase:store"),this.destroyStore&&e.destroy()}},{key:"onStoreUpdateRecord",value:function(e){var t=e.source,n=e.record,r=e.changes,i=this;if(i.forceFullRefresh)i.rowManager.refresh(),i.forceFullRefresh=!1;else{var o;if(n.isFieldModified("id")&&(o=i.getRowFor(n.meta.modified.id)),!(o=o||i.getRowFor(n)))return;if(i.fullRowRefresh||n.isSpecialRow){var a=t.indexOf(n);-1!==a&&o.render(a,n)}else i.columns.visibleColumns.forEach((function(e){var t=e.field;if(!(e.constructor.simpleRenderer&&!Object.prototype.hasOwnProperty.call(e.data,"renderer"))||r[t]){var i=o.getCell(t);i&&o.renderCell(i,n)}}))}}},{key:"refreshFromRowOnStoreAdd",value:function(e,t){var n=this.rowManager;n.renderFromRow(e),n.trigger("changeTotalHeight",{totalHeight:n.totalHeight}),1===this.store.count&&this.callEachSubGrid("refreshFakeScroll")}},{key:"onMaskAutoClose",value:function(e){we()(pe()(n.prototype),"onMaskAutoClose",this).call(this,e),this.toggleEmptyText()}},{key:"onStoreAdd",value:function(e){var t=e.source,n=e.records,r=e.index,i=e.oldIndex,o=e.isChild,a=e.oldParent,s=e.isMove,u=e.isExpandAll;if(this.isPainted&&!u&&(!o||n[0].ancestorsExpanded(t))){this.rowManager.calculateRowCount(!1,!0,!0);var c=this,l=c.rowManager,f=l.topIndex,d=l.rows,h=l.rowCount,v=l.topIndex+l.rowCount-1,p=r,g=r+n.length-1,y=v>=t.count-n.length-1;if(a||i>-1||o&&s)l.refresh();else if(p>=f&&p<f+h)c.refreshFromRowOnStoreAdd.apply(c,[d[p-f]].concat(Array.prototype.slice.call(arguments)));else if(g>=f&&g<f+h)l.refresh();else{var m=l.totalHeight.totalHeight;y&&r>v&&l.fillBelow(c._scrollTop||0),m!==l.totalHeight&&l.trigger("changeTotalHeight",{totalHeight:l.totalHeight})}}}},{key:"onStoreException",value:function(e){var t,n=e.action,r=e.type,i=e.response,o=e.exceptionType,a=e.error,s=this;switch(r){case"server":t=i.message||s.L("L{unspecifiedFailure}");break;case"exception":t="network"===o?s.L("L{networkFailure}"):a&&a.message||s.L("L{parseFailure}")}if(s.masked){var u='<div class="b-grid-load-failure">\n                    <div class="b-grid-load-fail">'.concat(s.L("read"===n?"L{loadFailedMessage}":"L{syncFailedMessage}"),'</div>\n                    <div class="b-grid-load-fail">').concat(i&&i.url?i.url+" responded with":"",'</div>\n                    <div class="b-grid-load-fail">').concat(t,"</div>\n                </div>");an.assign(s.masked.errorDefaults,s.loadMaskError),s.masked.error=u}}},{key:"onStoreDataChange",value:function(e){var t=e.action,r=e.changes,i=e.source;if(!this.suspendRendering){we()(pe()(n.prototype),"onStoreDataChange",this)&&we()(pe()(n.prototype),"onStoreDataChange",this).apply(this,arguments);var o=this,a=i.isGrouped&&r&&i.groupers.some((function(e){return e.field in r}));"dataset"===t&&o.rowManager.clearKnownHeights(),o.isPainted&&!a&&o.renderRows(null,t in wy),o.toggleEmptyText()}}},{key:"onStoreRecordIdChange",value:function(){we()(pe()(n.prototype),"onStoreRecordIdChange",this)&&we()(pe()(n.prototype),"onStoreRecordIdChange",this).apply(this,arguments)}},{key:"onStoreBeforeRequest",value:function(){var e=this.loadMask;e&&(this.masked=Ku.mergeConfigs(this.loadMaskDefaults,e))}},{key:"onStoreAfterRequest",value:function(e){this.loadMask&&!e.exception&&(this.masked=null,this.toggleEmptyText())}},{key:"needsFullRefreshOnStoreRemove",value:function(){var e=this._features;return(null==e?void 0:e.group)&&!e.group.disabled||(null==e?void 0:e.groupSummary)&&!e.groupSummary.disabled}},{key:"onStoreRemove",value:function(e){var t=e.records,r=e.isCollapse,i=e.isChild,o=e.isMove,a=e.isCollapseAll;if(this.isPainted&&!o&&!a){we()(pe()(n.prototype),"onStoreRemove",this)&&we()(pe()(n.prototype),"onStoreRemove",this).apply(this,arguments);var s=Math.pow(2,53)-1,u=this,c=u.rowManager,l=t.reduce((function(e,t){var n=c.getRowById(t.id);return n&&(e.push(n),s=Math.min(s,c.rows.indexOf(n))),e}),[]);if(c.invalidateKnownHeight(t),u.animateRemovingRows&&l.length&&!r&&!i){var f=l[0];u.isAnimating=!0,nu.onTransitionEnd({element:f._elementsArray[0],property:"left",duration:u.transitionDuration,thisObj:u,handler:function(){u.isAnimating=!1,l.forEach((function(e){return!e.isDestroyed&&e.removeCls("b-removing")})),c.refresh(),u.trigger("rowRemove")}}),l.forEach((function(e){return e.addCls("b-removing")}))}else u.needsFullRefreshOnStoreRemove.apply(u,arguments)?c.refresh():(c.calculateRowCount(!1,!0,!0),c.rows[s]?c.renderFromRow(c.rows[s]):c.trigger("changeTotalHeight",{totalHeight:c.totalHeight}),u.trigger("rowRemove",{isCollapse:r}))}}},{key:"onStoreMove",value:function(e){var t=e.from,n=e.to,r=this.rowManager,i=r.topIndex,o=r.rowCount,a=[t,n].sort(),s=ye()(a,2),u=s[0],c=s[1];u>=i&&u<i+o?r.renderFromRow(r.rows[u-i]):c>=i&&c<i+o&&r.refresh()}},{key:"onStoreReplace",value:function(e){var t=this,n=e.records,r=e.all,i=this.rowManager;if(r)i.clearKnownHeights(),i.refresh();else{var o=n.reduce((function(e,n){var r=ye()(n,2)[1],i=t.getRowFor(r);return i&&e.push(i),e}),[]);i.invalidateKnownHeight(n),i.renderRows(o)}}},{key:"onStoreRemoveAll",value:function(){we()(pe()(n.prototype),"onStoreRemoveAll",this)&&we()(pe()(n.prototype),"onStoreRemoveAll",this).apply(this,arguments),this.isPainted&&(this.rowManager.clearKnownHeights(),this.renderRows(),this.toggleEmptyText())}},{key:"onStoreCommit",value:function(e){var t=this,n=e.changes;if(this.showDirty&&n.modified.length){var r=[];n.modified.forEach((function(e){var n=t.rowManager.getRowFor(e);n&&r.push(n)})),this.rowManager.renderRows(r)}}},{key:"populateHeaderMenu",value:function(e){var t=e.column,n=e.items,r=this,i=r.subGrids,o=r.regions,a=!0;Object.entries(i).forEach((function(e){var s=ye()(e,2),u=s[0],c=s[1];if(!c.sealedColumns&&t.draggable&&u!==t.region&&(!t.parent&&i[t.region].columns.count>1||t.parent&&t.parent.children.length>1)){var l=c.element.compareDocumentPosition(i[t.region].element)===document.DOCUMENT_POSITION_PRECEDING,f=o.length>2?r.L("L{moveColumnTo}",r.optionalL(u)):r.L(l?"L{moveColumnRight}":"L{moveColumnLeft}");n["".concat(u,"Region")]={targetSubGrid:u,text:f,icon:"b-fw-icon "+(l?"b-icon-column-move-right":"b-icon-column-move-left"),name:"moveColumn",cls:a?"b-separator":"",onItem:function(e){var n=e.item;t.traverse((function(e){return e.region=u})),r.columns.insert(r.columns.indexOf(i[n.targetSubGrid].columns.last)+1,t),r.scrollColumnIntoView(t)}},a=!1}}))}},{key:"populateCellMenu",value:function(e){var t,n=e.record,r=e.items,i=this;if((null===(t=i.features)||void 0===t?void 0:t.contextMenu)&&!i.features.contextMenu.disabled&&i.showRemoveRowInContextMenu&&!i.readOnly&&n&&!n.isSpecialRow){var o=i.selectedRecords.length>1;r.removeRow={text:o?"L{removeRows}":"L{removeRow}",localeClass:this,icon:"b-fw-icon b-icon-trash",name:o?"removeRows":"removeRow",onItem:function(){return i.store.remove(o?i.selectedRecords:n)}}}}},{key:"getColumnDragToolbarItems",value:function(e,t){return t}},{key:"normalizeCellContext",value:function(e){var t=this.columns,n=this.store;if(e instanceof n.modelClass)return{record:e,id:e.id,columnId:t.bottomColumns[0].id};if(!("columnId"in e)){if("field"in e){var r=t.get(e.field);e.columnId=r&&r.id}else if("column"in e){var i="number"==typeof e.column?t.bottomColumns[e.column]:e.column;e.columnId=i&&i.id}"columnId"in e||(e.columnId=t.bottomColumns[0].id)}if("id"in e){if(e.element&&!n.getById(e.id)){var o=this.getRecordFromElement(e.element);o&&(e.id=o.id)}}else{var a="row"in e?n.getAt(e.row):e.record;a&&(e.id=a.id)}return e}},{key:"getCell",value:function(e){var t,n=null;return"id"in(e=this.normalizeCellContext(e))&&(t=this.getRowById(e.id)),t&&"columnId"in e&&(n=t.getCell(e.columnId)),n}},{key:"getHeaderElement",value:function(e){return"string"!=typeof e&&(e=e.id),this.fromCache('.b-grid-header[data-column-id="'.concat(e,'"]'))}},{key:"getHeaderElementByField",value:function(e){var t=this.columns.get(e);return t?this.getHeaderElement(t):null}},{key:"getRecordFromElement",value:function(e){var t=e.closest(".b-grid-row");return t?this.store.getAt(t.dataset.index):null}},{key:"getColumnFromElement",value:function(e){var t=Cr.up(e,".b-grid-cell, .b-grid-header");if(!t)return null;if(t.matches(".b-grid-header"))return this.columns.getById(t.dataset.columnId);var n=qo.get(t);return this.columns.getById(n.columnId)}},{key:"fixSizes",value:function(){this.callEachSubGrid("fixWidths")}},{key:"onRowManagerChangeTotalHeight",value:function(e){var t=e.totalHeight,n=e.immediate;return this.refreshTotalHeight(t,n)}},{key:"refreshTotalHeight",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.rowManager.totalHeight,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;if(n.renderingRows||!n.isVisible)return!1;n.rowManager.bottomRow&&(e=Math.max(e,n.rowManager.bottomRow.bottom));var r=n.scrollable,i=Math.abs(n.virtualScrollHeight-e),o=n._bodyRectangle.height,a=e-o;if(i){var s=a-n._scrollTop<2*o||n._verticalScrollHeight&&n._verticalScrollHeight-o<n._scrollTop;r.scrollHeight=n.virtualScrollHeight=e,n.isPainted&&(n.scrolling&&!s||i<100)&&!t?n.bufferedFixElementHeights():(n.virtualScrollHeightDirty&&n.virtualScrollHeightDirty(),n.bufferedFixElementHeights.cancel(),n.fixElementHeights())}}},{key:"fixElementHeights",value:function(){var e=this,t=e.virtualScrollHeight,n="".concat(t,"px");e._verticalScrollHeight=t,e.verticalScroller.style.height=n,e.virtualScrollHeightDirty=!1,e.autoHeight&&(e.bodyContainer.style.height=n,e._bodyHeight=t,e._bodyRectangle=En.client(e.bodyContainer)),e.refreshVirtualScrollbars()}},{key:"enableScrollingCloseToEdges",value:function(e){"string"==typeof e&&(e=this.subGrids[e]),this.scrollManager.startMonitoring({element:e.element})}},{key:"disableScrollingCloseToEdges",value:function(e){"string"==typeof e&&(e=this.subGrids[e]),this.scrollManager.stopMonitoring(e.element)}},{key:"onRowManagerRequestScrollChange",value:function(e){var t=e.bottom;this.scrollable.y=t-this.bodyHeight}},{key:"initScroll",value:function(){var e=this;if(!e.scrollInitialized){var t,n=e.createOnFrame((function(){(t=e.scrollable.y)!==e._scrollTop&&(e._scrollTop=t,e.scrolling||(e.scrolling=!0,e.eachSubGrid((function(e){return e.suspendResizeMonitor=!0}))),e.rowManager.updateRenderedRows(t),e.trigger("scroll",{scrollTop:t}))}));e.scrollInitialized=!0,e.scrollable.on({scroll:n,scrollend:function(){e.scrolling=!1,e.eachSubGrid((function(e){return e.suspendResizeMonitor=!1}))}}),e.callEachSubGrid("initScroll")}}},{key:"scrollRowIntoView",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:by,n=this,r=t.block||"nearest",i=n.rowManager;if(e=n.store.getById(e)){if(-1===n.store.indexOf(e))return ky;var o=n.scrollable,a=n.getRecordCoords(e),s=En.from(o.element);if(a.virtual){var u=a.block;if(o.scrollIntoView(a,{block:"center"}),i.scrollTargetRecordId=e,i.updateRenderedRows(o.y,!0),a=n.getRecordCoords(e),i.lastScrollTop=o.y,a.virtual)return ky;var c="nearest"!==r?t:{block:u};if(t.animate){o.suspendEvents(),"end"===r||"nearest"===r&&"end"===u?o.y-=s.bottom-a.bottom:("start"===r||"nearest"===r&&"start"===u)&&(o.y+=a.y-s.y),i.updateRenderedRows(o.y,!1,!0),"end"===u?o.y-=i.appendRowBuffer*i.rowHeight-1:o.y+=i.prependRowBuffer*i.rowHeight-1;var l=o.scrollIntoView(n.getRecordCoords(e),Object.assign({},t,c));return l.then((function(){return o.resumeEvents()}))}return n.scrollRowIntoView(e,Object.assign({},t,c))}var f=t.column;if(f){if("string"==typeof f&&(f=n.columns.getById(f)||n.columns.get(f)),f){o=n.getSubGridFromColumn(f).scrollable;var d=En.from(i.getRowFor(e).getCell(f.id));a.x=d.x,a.width=d.width}}else t.x=!1;return o.scrollIntoView(a,t)}}},{key:"scrollColumnIntoView",value:function(e,t){return e=e instanceof Dh?e:this.columns.get(e)||this.columns.getById(e)||this.columns.getAt(e),this.getSubGridFromColumn(e).scrollColumnIntoView(e,t)}},{key:"scrollCellIntoView",value:function(e,t){return this.scrollRowIntoView(e.id,Object.assign({column:e.columnId},"boolean"==typeof t?{animate:t}:t))}},{key:"scrollToBottom",value:function(e){return this.scrollRowIntoView(this.store.last,e)}},{key:"scrollToTop",value:function(e){return this.scrollable.scrollBy(0,-this.scrollable.y,e)}},{key:"storeScroll",value:function(){var e=this.storedScrollState={scrollTop:this.scrollable.y,scrollLeft:{}};return this.eachSubGrid((function(t){e.scrollLeft[t.region]=t.scrollable.x})),e}},{key:"restoreScroll",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.storedScrollState,t=this;t.eachSubGrid((function(t){t.scrollable.x=e.scrollLeft[t.region]})),t.scrollable.y=e.scrollTop}},{key:"measureRowHeight",value:function(){var e,t=this,n=Cr.createElement({tag:"div",className:"b-grid "+((null===(e=t.features)||void 0===e?void 0:e.stripe)?"b-stripe":""),style:"position: absolute; visibility: hidden",html:'<div class="b-grid-subgrid"><div class="b-grid-row"></div></div>',parent:document.getElementById(t.appendTo)||document.body}),r=n.firstElementChild.firstElementChild,i=parseInt(Cr.getStyleValue(r,"height")),o=parseInt(Cr.getStyleValue(r,"border-top-width")),a=parseInt(Cr.getStyleValue(r,"border-bottom-width"));null!=t.rowHeight&&t.rowHeight!==t._rowHeightFromStyle||(t.rowHeight=!isNaN(i)&&i?i:t.defaultRowHeight,t._rowHeightFromStyle=t.rowHeight),t._rowBorderHeight=o+a,t._isRowMeasured=!0,n.remove()}},{key:"onThemeChange",value:function(e){var t=e.theme;this.measureRowHeight(),this.trigger("theme",{theme:t})}},{key:"refreshRows",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.element,n=this.rowManager;t.classList.add("b-notransition"),e?n.returnToTop():n.refresh(),t.classList.remove("b-notransition")}},{key:"refreshColumn",value:function(e){if(!e.hidden){var t=e.field;this.rowManager.forEach((function(e){var n=e.getCell(t);e.renderCell(n)}))}}},{key:"refreshVirtualScrollbars",value:function(){var e=this,t=e.headerContainer,n=e.footerContainer,r=e.virtualScrollers,i=e.hasVerticalOverflow?"add":"remove";Object.values(e.subGrids).some((function(e){return e.overflowingHorizontally}))?r.classList.remove("b-hide-display"):r.classList.add("b-hide-display"),Cr.scrollBarWidth&&(t.classList[i]("b-show-yscroll-padding"),n.classList[i]("b-show-yscroll-padding"),r.classList[i]("b-show-yscroll-padding")),e.onHeightChange()}},{key:"onContentChange",value:function(){var e=this,t=e.rowManager;e.isVisible?(t.estimateTotalHeight(),e.paintListener=null,e.refreshTotalHeight(e.contentHeight),e.callEachSubGrid("refreshFakeScroll"),e.onHeightChange()):e.paintListener||(e.paintListener=e.on({paint:"onContentChange",once:!0,thisObj:e}))}},{key:"onHeightChange",value:function(){var e=this;e._bodyRectangle=En.client(e.bodyContainer),e._bodyHeight=e.autoHeight?e.contentHeight:e.bodyContainer.offsetHeight}},{key:"renderHeader",value:function(e,t){}},{key:"renderFooter",value:function(e,t){}},{key:"suspendRefresh",value:function(){this.refreshSuspended++}},{key:"resumeRefresh",value:function(e){this.refreshSuspended&&!--this.refreshSuspended&&(e&&this.refreshRows(),this.trigger("resumeRefresh"))}},{key:"renderRows",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r=e&&n.storeScroll();n.refreshSuspended||(n.trigger("beforeRenderRows"),n.renderingRows=!0,n.element.classList.add("b-grid-refreshing"),t&&(n.scrollable.y=n._scrollTop=0),n.rowManager.reinitialize(t),n.trigger("renderRows"),n.renderingRows=!1,n.onContentChange(),e&&n.restoreScroll(r),n.element.classList.remove("b-grid-refreshing"))}},{key:"renderContents",value:function(){var e=this,t=e.element,n=e.headerContainer,r=e.footerContainer,i=e.rowManager;if(e.emptyCache(),e.isPainted){e._headerHeight=null,e.callEachSubGrid("refreshHeader",n),e.callEachSubGrid("refreshFooter",r),e.renderHeader(n,t),e.renderFooter(r,t),e.fixSizes();var o=i.removeAllRows();i.calculateRowCount(!1,!0,!0),i.rowCount&&(i.setPosition(o),e.renderRows())}}},{key:"onPaint",value:function(){var e=this,t=e.rowManager,n=e.store,r=e.element,i=e.headerContainer,o=e.bodyContainer,a=e.footerContainer,s=Cr.scrollBarPadElement;if(!e.isPainted){var u,c=0;e.columns.on({change:function(){return u=!0},single:!0}),e._bodyRectangle=En.client(e.bodyContainer);var l=e.bodyContainer.offsetHeight;e.updateResponsive(e.width,0),u&&(e.callEachSubGrid("refreshHeader",i),e.callEachSubGrid("refreshFooter",a)),e.renderHeader(i,r),e.renderFooter(a,r),Cr.append(i,s),Cr.append(a,s),Cr.append(e.virtualScrollers,s),e.autoHeight?(e._bodyHeight=t.initWithHeight(r.offsetHeight-i.offsetHeight-a.offsetHeight,!0),o.style.height=e.bodyHeight+"px"):(e._bodyHeight=l,t.initWithHeight(e._bodyHeight,!0)),e.eachSubGrid((function(e){e.header.maxDepth>c&&(c=e.header.maxDepth)})),i.dataset.maxDepth=c,e.fixSizes(),!n.count&&n.isLoading||e.renderRows(!1,!1),e.initScroll(),e.initInternalEvents()}}},{key:"render",value:function(){var e=this;e.requireSize=Boolean(e.owner),we()(pe()(n.prototype),"render",this).apply(this,arguments),e.autoHeight||!e.headerContainer.offsetHeight||e.bodyContainer.offsetHeight||console.warn("Grid element not sized correctly, please check your CSS styles and review how you size the widget")}},{key:"maskBody",value:function(e){var t=this;if(t.bodyContainer){t.unmaskBody();var n=(t.activeMask=Ku.mask(e,t.element)).maskElement;return n.style.marginTop="".concat(t.bodyContainer.offsetTop,"px"),n.style.height="".concat(t.virtualScrollers.offsetTop+t.virtualScrollers.offsetHeight-t.bodyContainer.offsetTop,"px"),t.activeMask}}},{key:"unmaskBody",value:function(){var e=this;e.loadmaskHideTimer&&e.clearTimeout(e.loadmaskHideTimer),e.loadmaskHideTimer=null,e.activeMask&&e.activeMask.destroy(),e.activeMask=null}},{key:"toggleEmptyText",value:function(){this.bodyContainer&&Cr.toggleClasses(this.bodyContainer,"b-grid-empty",!(this.rowManager.rowCount>0||this.store.isLoading||this.store.isCommitting))}},{key:"bodyConfig",get:function(){return{reference:"bodyElement",className:"b-grid-panel-body",children:[{tag:"header",reference:"headerContainer",className:{"b-grid-header-container":1,"b-hidden":this.hideHeaders}},{reference:"bodyContainer",className:"b-grid-body-container",tabIndex:-1,children:[{reference:"verticalScroller",className:"b-grid-vertical-scroller"}]},{reference:"virtualScrollers",className:"b-virtual-scrollers",style:j.a.isFirefox?{height:"".concat(Cr.scrollBarWidth,"px")}:void 0},{tag:"footer",reference:"footerContainer",className:{"b-grid-footer-container":1,"b-hidden":this.hideFooters}}]}}},{key:"contentElement",get:function(){return this.verticalScroller}},{key:"overflowElement",get:function(){return this.bodyContainer}},{key:"focusElement",get:function(){return this.bodyContainer}},{key:"columns",set:function(e){var t,n,r=this;r._columnStore?e?r._columnStore.data=e:r._columnStore.destroy():(e instanceof Th?(e.grid||(e.grid=r),r._columnStore=e):Array.isArray(e)?r._columnStore=new Th({grid:r,data:e}):e&&(r._columnStore=new Th(Object.assign({grid:r},e))),r._columnStore.on("change",r.onColumnsChanged,r),r._columnStore.on((t=r.onColumnsResized,n=r,{update:function(e){var r=e.store,i=e.record,o=e.changes,a=!0;return("width"in o||"minWidth"in o||"flex"in o)&&(a=t.call(n,{store:r,record:i,changes:o})),a}})),j.a.isTouchDevice&&(r.touch=!0,r._columnStore.forEach((function(e){var t=e.touchConfig;t&&e.applyState(t)}))))},get:function(){return this._columnStore}},{key:"rowManager",get:function(){var e=this;return e._isRowMeasured||e.measureRowHeight(),e._rowManager||(e._rowManager=new Eg({grid:e,rowHeight:e.rowHeight,rowScrollMode:e.rowScrollMode||"move",autoHeight:e.autoHeight,fixedRowHeight:e.fixedRowHeight,listeners:{changeTotalHeight:e.onRowManagerChangeTotalHeight,requestScrollChange:e.onRowManagerRequestScrollChange,thisObj:e}}))}},{key:"store",get:function(){return this._store},set:function(e){var t=this,n=t.rowManager,r=t.initialConfig.features,i=t._store;if(e!==i)if(i&&t.unbindStore(i),e){if("string"==typeof e&&(e=No.getStore(e)),e instanceof No);else{var o={};t.data&&(o.data=t.data),(null==r?void 0:r.tree)&&(o.tree=!0),e.modelClass||(o.modelClass=function(e){fe()(n,e);var t=my(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(iv)),e=new(e.readUrl?Uo:No)(Object.assign(o,e))}t._store=e,t.bindStore(e),t.isPainted&&!t.refreshSuspended&&n.reinitialize()}else t._store=null}},{key:"data",get:function(){return this._store?this._store.records:this._data},set:function(e){this._store?this._store.data=e:this._data=e}},{key:"emptyText",get:function(){return this._emptyText},set:function(e){this._emptyText=e,this.eachSubGrid((function(t){return t.emptyText=e}))}},{key:"bodyHeight",get:function(){return this._bodyHeight}},{key:"headerHeight",get:function(){var e=this;return e.isPainted&&!e._headerHeight&&(e._headerHeight=e.headerContainer.offsetHeight),e._headerHeight}},{key:"autoHeight",get:function(){return this._autoHeight},set:function(e){an.assertBoolean(e,"autoHeight"),this._autoHeight=e}},{key:"columnLines",get:function(){return this._columnLines},set:function(e){an.assertBoolean(e,"columnLines"),Cr.toggleClasses(this.element,"b-no-column-lines",!e),this._columnLines=e}},{key:"scrolling",set:function(e){this._scrolling=e},get:function(){return this._scrolling}},{key:"hasVerticalOverflow",get:function(){var e=this.scrollable;return j.a.isEdge||j.a.isIE11?Math.abs(e.scrollHeight-e.clientHeight)>1:e.scrollHeight>e.clientHeight}},{key:"contentHeight",get:function(){var e=this.rowManager;return Math.max(e.totalHeight,e.bottomRow?e.bottomRow.bottom:0)}},{key:"firstVisibleRow",get:function(){return this.rowManager.firstVisibleRow}},{key:"firstFullyVisibleRow",get:function(){return this.rowManager.firstFullyVisibleRow}}],[{key:"getLKey",value:function(){return"bf757ffb-df5b-11e9-9294-d094663d5c88"}},{key:"$name",get:function(){return"GridBase"}},{key:"type",get:function(){return"gridbase"}},{key:"delayable",get:function(){return{onGridScroll:{type:"raf"},bufferedAfterColumnsResized:250}}},{key:"configurable",get:function(){return{enableSticky:null,subGridConfigs:{normal:{flex:1}},hideFooters:!0}}},{key:"defaultConfig",get:function(){return{rowHeight:null,fixedRowHeight:null,defaultRowHeight:45,emptyText:"L{noRows}",fullRowRefresh:!0,hideHeaders:null,showRemoveRowInContextMenu:!0,autoHeight:null,store:{},data:null,columns:[],defaultRegion:"normal",destroyStore:null,enableTextSelection:null,loadMask:"L{loadMask}",loadMaskDefaults:{useTransition:!0,showDelay:1e3},loadMaskError:{icon:"b-icon b-icon-warning",autoClose:3e3,showDelay:0},maskDefaults:{cover:"body",target:"element"},syncMask:"L{syncMask}",columnLines:!0,fillLastColumn:!0,resizeToFitIncludesHeader:!0,animateRemovingRows:!j.a.isIE11,disableGridRowModelWarning:null,headerClass:Bg,footerClass:wg,testPerformance:!1,positionMode:"translate",rowScrollMode:"move",monitorResize:!0,features:!0,scrollable:{overflowY:!0},scrollerClass:Ig,scrollManager:null,showDirty:null,refreshSuspended:0,transitionDuration:500,contextMenuTriggerEvent:"contextmenu",localizableProperties:["emptyText","loadMask","syncMask"],asyncEventSuffix:""}}},{key:"properties",get:function(){return{_selectedRecords:[],_verticalScrollHeight:0,virtualScrollHeight:0,_scrollTop:null}}},{key:"deprecatedEvents",get:function(){return{cellContextMenuBeforeShow:{product:"Grid",invalidAsOfVersion:"5.0.0",message:"`cellContextMenuBeforeShow` event is deprecated, in favor of `cellMenuBeforeShow` event. Please see https://bryntum.com/docs/grid/#guides/upgrades/4.0.0.md for more information."},cellContextMenuShow:{product:"Grid",invalidAsOfVersion:"5.0.0",message:"`cellContextMenuShow` event is deprecated, in favor of `cellMenuShow` event. Please see https://bryntum.com/docs/grid/#guides/upgrades/4.0.0.md for more information."},headerContextMenuBeforeShow:{product:"Grid",invalidAsOfVersion:"5.0.0",message:"`headerContextMenuBeforeShow` event is deprecated, in favor of `headerMenuBeforeShow` event. Please see https://bryntum.com/docs/grid/#guides/upgrades/4.0.0.md for more information."},headerContextMenuShow:{product:"Grid",invalidAsOfVersion:"5.0.0",message:"`headerContextMenuShow` event is deprecated, in favor of `headerMenuShow` event. Please see https://bryntum.com/docs/grid/#guides/upgrades/4.0.0.md for more information."},contextMenuItem:{product:"Grid",invalidAsOfVersion:"5.0.0",message:"`contextMenuItem` event is deprecated, in favor of `cellMenuItem` and `headerMenuItem` events. Please see https://bryntum.com/docs/grid/#guides/upgrades/4.0.0.md for more information."},contextMenuToggleItem:{product:"Grid",invalidAsOfVersion:"5.0.0",message:"`contextMenuToggleItem` event is deprecated, in favor of `cellMenuToggleItem` and `headerMenuToggleItem` events. Please see https://bryntum.com/docs/grid/#guides/upgrades/4.0.0.md for more information."}}}}]),n}(Nl.mixin(Xr,Jr,(function(e){return function(e){fe()(n,e);var t=Hg(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"initInternalEvents",value:function(){for(var e=Object.keys($g),t=e.length,n={element:this.element,thisObj:this},r=0;r<t;r++)n[e[r]]="handleEvent";nu.on(n),nu.on({focus:"onGridElementFocus",element:this.focusElement,thisObj:this})}},{key:"getCellDataFromEvent",value:function(e){var t=Cr.up(e.target,".b-grid-cell");if(t){var n=qo.get(t),r=n.id,i=n.columnId,o=this.store.getById(r),a=this.columns.getById(i);return o?{cellElement:t,cellData:n,columnId:i,id:r,record:o,column:a,cellSelector:{id:r,columnId:i}}:null}}},{key:"getHeaderDataFromEvent",value:function(e){var t=Cr.up(e.target,".b-grid-header");if(t){var n=an.assign({},t.dataset),r=n.columnId,i=this.columns.getById(r);return i?{headerElement:t,headerData:n,columnId:r,column:i}:null}}},{key:"handleEvent",value:function(e){this.disabled||(this.event=e,$g[e.type]&&this[$g[e.type]](e))}},{key:"onElementTouchStart",value:function(e){var t=this,n=t.getCellDataFromEvent(e);Cr.isTouchEvent=!0,1===e.touches.length&&(t.longPressTimeout=t.setTimeout((function(){t.onElementLongPress(e),e.preventDefault(),t.longPressPerformed=!0}),t.longPressTime)),n&&!e.defaultPrevented&&t.onFocusGesture(n,e)}},{key:"onElementTouchMove",value:function(e){this.longPressTimeout&&(this.clearTimeout(this.longPressTimeout),this.longPressTimeout=null)}},{key:"onElementTouchEnd",value:function(e){var t=this;t.longPressPerformed&&(e.cancelable&&e.preventDefault(),t.longPressPerformed=!1),t.longPressTimeout&&(t.clearTimeout(t.longPressTimeout),t.longPressTimeout=null)}},{key:"onElementLongPress",value:function(e){}},{key:"triggerCellMouseEvent",value:function(e,t){var n=this.getCellDataFromEvent(t);if(n){var r=this.columns.getById(n.columnId);this.trigger("cell"+E.capitalize(e),{grid:this,record:n.record,column:r,cellSelector:n.cellSelector,cellElement:n.cellElement,target:t.target,event:t})}}},{key:"onElementMouseDown",value:function(e){var t=this.getCellDataFromEvent(e);this.skipFocusSelection=!0,this.triggerCellMouseEvent("mousedown",e),t&&!e.defaultPrevented&&this.onFocusGesture(t,e)}},{key:"onElementMouseMove",value:function(e){this.mouseMoveEvent=e}},{key:"onElementMouseUp",value:function(e){}},{key:"onHandleElementClick",value:function(e){!1!==this.trigger("beforeElementClick",{event:e})&&this.onElementClick(e)}},{key:"onElementClick",value:function(e){var t=this.getCellDataFromEvent(e);t&&(this.triggerCellMouseEvent("click",e),qo.get(t.cellElement).row.removeCls("b-hover"))}},{key:"onFocusGesture",value:function(e,t){e&&this.focusCell(e.cellSelector,{scroll:!1,doSelect:!0,event:t})}},{key:"onElementDblClick",value:function(e){var t=e.target;if(this.triggerCellMouseEvent("dblClick",e),t.classList.contains("b-grid-header-resize-handle")){var n=Cr.up(t,".b-grid-header");this.columns.getById(n.dataset.columnId).resizeToFitContent()}}},{key:"onElementMouseOver",value:function(e){if(!this.scrolling){var t=Cr.up(e.target,".b-grid-cell");if(t){var n=qo.get(t).row;!n||"number"==typeof e.buttons&&0!==e.buttons||(this.hoveredRow=n),this.triggerCellMouseEvent("mouseOver",e)}this.trigger("mouseOver",{event:e})}}},{key:"onElementMouseOut",value:function(e){(this.hoveredRow=null,this.scrolling)||(Cr.up(e.target,".b-grid-cell")&&this.triggerCellMouseEvent("mouseOut",e),this.trigger("mouseOut",{event:e}))}},{key:"onElementKeyDown",value:function(e){var t=this;if(!e.handled){var n=t.focusedCell;if(e.target.matches(".b-grid-header.b-depth-0"))t.handleHeaderKeyDown(e);else if(e.target===t.focusElement||j.a.isIE11&&e.currentTarget===t.focusElement){if(t.handleViewKeyDown(e),n){var r,i=n.element,o=t.columns.getById(i.dataset.columnId);null===(r=o.onCellKeyDown)||void 0===r||r.call(o,{event:e,cellElement:i})}}else if("Escape"===e.key&&t.isActionableLocation){var a=an.clone(n);a.element=null,t.focusCell(a),Cr.focusWithoutScrolling(t.element)}}}},{key:"handleViewKeyDown",value:function(e){switch(e.key){case"ArrowLeft":return e.preventDefault(),this.navigateLeft(e);case"ArrowRight":return e.preventDefault(),this.navigateRight(e);case"ArrowUp":return e.preventDefault(),this.navigateUp(e);case"ArrowDown":return e.preventDefault(),this.navigateDown(e)}}},{key:"handleHeaderKeyDown",value:function(e){var t=this,n=t.columns.getById(e.target.dataset.columnId);switch(n.onKeyDown&&n.onKeyDown(e),e.key){case"ArrowLeft":t.onHeaderLeftKey(n);break;case"ArrowRight":t.onHeaderRightKey(n);break;case"ArrowDown":e.preventDefault(),t.onHeaderDownKey(n);break;case"Enter":t.onHeaderEnterKey(n)}}},{key:"onHeaderLeftKey",value:function(e){var t=this.columns.getAdjacentVisibleLeafColumn(e,!1);t&&this.getHeaderElement(t.id).focus()}},{key:"onHeaderRightKey",value:function(e){var t=this.columns.getAdjacentVisibleLeafColumn(e,!0);t&&this.getHeaderElement(t.id).focus()}},{key:"onHeaderDownKey",value:function(e){var t=this.firstFullyVisibleRow;t&&this.focusCell({columnId:e.id,id:t.id})}},{key:"onHeaderEnterKey",value:function(e){this.getHeaderElement(e.id).click()}},{key:"onElementKeyPress",value:function(e){}},{key:"onElementKeyUp",value:function(e){}},{key:"onElementContextMenu",value:function(e){var t=this.getCellDataFromEvent(e);t&&(this.triggerCellMouseEvent("contextMenu",e),Cr.isTouchEvent&&this.onFocusGesture(t,e))}},{key:"onInternalResize",value:function(e,t,r,i,o){var a=this;a._devicePixelRatio&&a._devicePixelRatio!==window.devicePixelRatio&&Cr.resetScrollBarWidth(),a._devicePixelRatio=window.devicePixelRatio,a._bodyRectangle=En.client(a.bodyContainer),we()(pe()(n.prototype),"onInternalResize",this).apply(this,arguments),r!==o&&(a._bodyHeight=a.bodyContainer.offsetHeight,a.isPainted&&a.rowManager.initWithHeight(a._bodyHeight)),a.refreshVirtualScrollbars(),t!==i&&a.setTimeout((function(){a.isDestroyed||a.updateResponsive(t,i)}),0)}},{key:"hoveredRow",set:function(e){var t=this;t._hoveredRow&&!t._hoveredRow.isDestroyed&&(t._hoveredRow.removeCls("b-hover"),t._hoveredRow=null),e&&!t.scrolling&&(t._hoveredRow=e,e.addCls("b-hover"))}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"GridElementEvents"}},{key:"defaultConfig",get:function(){return{longPressTime:400}}}]),n}(e||ue)}),(function(e){return function(e){fe()(n,e);var t=Ng(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"createFeatureInitializer",value:function(e,t,n,r){var i=[this],o=n.prototype.construct;return Vg[l()(r)]&&(i[1]=r),{configurable:!0,get:function(){return delete e[t],n.prototype.construct=function(){e[t]=this;for(var r=arguments.length,i=new Array(r),a=0;a<r;a++)i[a]=arguments[a];o.apply(this,i),n.prototype.construct=o},Ue()(n,i)}}}},{key:"hasFeature",value:function(e){return!(!this.features||!this.features[e])}},{key:"features",set:function(e){var t=fv.getInstanceDefaultFeatures(this);e=this._features=an.assign({},e),t&&Object.keys(t).forEach((function(t){t in e||(e[t]=!0)}));for(var n=fv.getInstanceFeatures(this),r=0,i=Object.keys(e);r<i.length;r++){var o=i[r],a=e[o];if(a){if(E.uncapitalize(o)!==o)throw new Error("Invalid feature name '".concat(o,"', must start with a lowercase letter"));var s=n[o];if(!s)throw new Error("Feature '".concat(o,"' not available, make sure you have imported it"));Reflect.defineProperty(e,o,this.createFeatureInitializer(e,o,s,a))}}},get:function(){return this._features}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"GridFeatures"}}]),n}(e||ue)}),(function(e){return function(e){fe()(n,e);var t=zg(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"onGridElementFocus",value:function(e){var t=this,n={doSelect:!1,event:e};if(t._initialFocusedCellContext){var r=t._initialFocusedCellContext,i=r.cellSelector,o=r.options;t._focusedCell=null,t.focusCell(i,o),t._initialFocusedCellContext=null}else if(t._focusedCell)t.focusCell(t._focusedCell,n);else{var a=t.element.contains(e.relatedTarget)?null:t.lastFocusedCell;if(a){var s=t.getCell(a);if(!s||!Cr.isVisible(s)||!t.store.getById(a.id))return void t.revertFocus();t.returningFocus=!0,t.focusCell(a,n),t.returningFocus=!1}else if(!t.scrolling&&!t.skipFocusSelection&&t.store.first){var u=t.mouseMoveEvent,c=t.rowManager,l=t._bodyRectangle,f=u&&c.getRowAt(Math.min(Math.max(u.clientY,l.y),l.bottom))||t.firstFullyVisibleRow,d=u&&t.getCellDataFromEvent(u)||{id:f.id,columnId:t.columns.visibleColumns[0].id};t.getCell(d)&&t.focusCell(d,n)}}t.skipFocusSelection=!1}},{key:"onFocusOut",value:function(e){we()(pe()(n.prototype),"onFocusOut",this).call(this,e),this.clearFocus()}},{key:"afterHide",value:function(){we()(pe()(n.prototype),"afterHide",this).apply(this,arguments),this.lastFocusedCell=this.mouseMoveEvent=null}},{key:"isFocused",value:function(e){return Boolean(this._focusedCell)&&this.isLocationEqual(e,this._focusedCell)}},{key:"focusCell",value:function(e){var t,n,r,i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Wg;if(document.hasFocus()||!j.a.isMac||2!==(null===(t=i)||void 0===t||null===(n=t.event)||void 0===n?void 0:n.button)){var o=this,a=Cr.activeElement;e=o.normalizeCellContext(e===Object?Object.assign({},e):e);var s=!1!==i.doSelect,u=i,c=u.event,l=u.scroll,f=o.lastFocusedCell=o._focusedCell,d=o.isLocationEqual(e,f),h=f&&o.getCell(f),v=o.getSubGridFromColumn(e.columnId),p=o.getCell(e);if(c&&"mousedown"===c.type)for(var g=c.target;g!==p;g=g.parentElement)if(Cr.isFocusable(g))return void(e.element=g);if(d)return c&&o.onCellNavigate&&o.onCellNavigate(o,null,o._focusedCell,c,s),e;h&&h.classList.remove("b-focused");var y=p||o.getCell({row:o.rowManager.topIndex,columnId:e.columnId}),m=En.from(v.element),k=En.from(o.bodyContainer),b=En.from(y).moveTo(null,m.y);return!1===l?i=Object.assign({},i,Gg):(i=Object.assign({},i,l),b.width>m.width||b.height>k.height?i.x=i.y=!1:i.column=e.columnId,o.scrollRowIntoView(e.id,i)),a===o.focusElement||o.focusElement.contains(a)||(null===(r=oc.fromElement(a))||void 0===r?void 0:r.owner)===o?((p=o.getCell(e))&&(e.element=p,p.classList.add("b-focused")),o._focusedCell=e,o.onCellNavigate&&o.onCellNavigate(o,f,o._focusedCell,c,s),o.trigger("navigate",{lastFocusedCell:f,focusedCell:o._focusedCell,event:c}),e):(o._initialFocusedCellContext={cellSelector:e,options:i},Cr.focusWithoutScrolling(o.focusElement),void(o.isLocationEqual(e,o._focusedCell)||j.a.isIE11||(o._initialFocusedCellContext=null)))}}},{key:"isLocationEqual",value:function(e,t){return e&&t&&e.id===t.id&&e.columnId===t.columnId&&(!e.element||!t.element||e.element===t.element)}},{key:"blurCell",value:function(e){var t=this.getCell(e);t&&t.classList.remove("b-focused")}},{key:"clearFocus",value:function(){var e=this;e._focusedCell&&(e.lastFocusedCell=e._focusedCell,e.blurCell(e._focusedCell),e._focusedCell=null)}},{key:"internalNextPrevCell",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0,n=this,r=n._focusedCell;return r?n.focusCell({id:r.id,columnId:n.columns.getAdjacentVisibleLeafColumn(r.columnId,e,!0).id},{doSelect:!0,event:t}):null}},{key:"navigateRight",value:function(e){return this.internalNextPrevCell(!0,e)}},{key:"navigateLeft",value:function(e){return this.internalNextPrevCell(!1,e)}},{key:"internalNextPrevRow",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=arguments.length>2?arguments[2]:void 0,r=this,i=r._focusedCell;if(!i)return!1;var o=r.store["get".concat(e?"Next":"Prev")](i.id,!1,t);return o?r.focusCell({id:o.id,columnId:i.columnId,scroll:{x:!1}},{doSelect:!0,event:n}):e?void 0:(this.clearFocus(),this.getHeaderElement(i.columnId).focus())}},{key:"navigateDown",value:function(e){return this.internalNextPrevRow(!0,!1,e)}},{key:"navigateUp",value:function(e){return this.internalNextPrevRow(!1,!1,e)}},{key:"focusedCell",get:function(){var e=this._focusedCell;if(e&&this.getCell(e))return e;this.clearFocus()},set:function(e){this.focusCell(e,{doSelect:!1})}},{key:"isActionableLocation",get:function(){var e=this._focusedCell;return Boolean(e&&e.element&&this.getCell(e).contains(e.element))}},{key:"focusedRecord",get:function(){if(this._focusedCell)return this.store.getById(this._focusedCell.id)}},{key:"cellCSSSelector",get:function(){var e=this._focusedCell,t=e&&this.getRowById(e.id);return e&&t?"[data-index=".concat(t.index,"] [data-column-id=").concat(e.columnId,"]"):""}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"GridNavigation"}}]),n}(e||ue)}),(function(e){return function(e){fe()(n,e);var t=Yg(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"getClosestBiggerLevel",value:function(e){var t=this,n=Object.keys(t.responsiveLevels),r=null,i=99995,o=null;return n.forEach((function(n){var a=t.responsiveLevels[n];if(["number","string"].includes(l()(a))||(a=a.levelWidth),"*"===a)o=n;else if(e<a){var s=a-e;s<i&&(i=s,r=n)}})),r||o}},{key:"updateResponsive",value:function(e,t){var n=this,r=n.getClosestBiggerLevel(t),i=n.getClosestBiggerLevel(e);if(r!==i){var o=n.responsiveLevels[i];["number","string"].includes(l()(o))||n.applyState(o),n.columns.forEach((function(e){var t=e.responsiveLevels;t&&(t[i]?e.applyState(t[i]):t["*"]&&e.applyState(t["*"]))})),n.element.classList.remove("b-responsive-"+r),n.element.classList.add("b-responsive-"+i),n.trigger("responsive",{level:i,width:e,oldLevel:r,oldWidth:t})}}},{key:"responsiveLevel",get:function(){return this.getClosestBiggerLevel(this.width)}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"GridResponsive"}},{key:"defaultConfig",get:function(){return{responsiveLevels:Object.freeze({small:400,medium:600,large:"*"})}}}]),n}(e||ue)}),(function(e){return function(e){fe()(n,e);var t=Kg(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"afterConfigure",value:function(){var e=this;if(e.selectionMode.checkbox){var t=Th.getColumnClass("check");if(!t)throw new Error("CheckColumn must be imported for checkbox selection mode to work");var r=e.checkboxColumn=new t({id:"".concat(e.id,"-selection-column"),width:"4em",minWidth:"4em",field:null,cellCls:"b-checkbox-selection",region:e.items[0].region,showCheckAll:e.selectionMode.showCheckAll},e.columns);r.meta.depth=0,r._grid=e;var i=r.renderer;r.renderer=function(t){t.value=e.isSelected(t.record),i.call(r,t)},r.on({toggle:"onCheckChange",toggleAll:"onCheckAllChange",thisObj:e});var o=e.columns.indexOf(e.columns.findRecord("type","rownumber"))+1;e.columns.insert(o,r)}we()(pe()(n.prototype),"afterConfigure",this).call(this)}},{key:"onStoreRecordIdChange",value:function(e){var t=e.record,r=e.oldValue;we()(pe()(n.prototype),"onStoreRecordIdChange",this)&&we()(pe()(n.prototype),"onStoreRecordIdChange",this).apply(this,arguments);var i=this.selectedRecordCollection.get(r);i===t&&this.selectedRecordCollection.rebuildIndices()}},{key:"onSelectedRecordCollectionChange",value:function(e){e.source,e.action;var t=e.added,n=void 0===t?[]:t,r=e.removed,i=this;i._selectedCell&&!i.isSelectable(i._selectedCell)&&i.deselectCell(i._selectedCell),n=n.filter((function(e){return i.isSelectable(e)})),i.triggerChangeEvent({mode:"row",action:n.length?"select":"deselect",selection:i.selectedRecords,selected:n,deselected:r},i.silent)}},{key:"onCheckChange",value:function(e){var t=e.source,n=e.checked,r=e.record;n?(this.selectRow({record:r,column:t,addToSelection:!1!==this.selectionMode.multiSelect,scrollIntoView:!1}),t.headerCheckbox&&this.selectedRecords.length===this.store.count-(this.store.groupRecords?this.store.groupRecords.length:0)&&(t.suspendEvents(),t.headerCheckbox.checked=!0,t.resumeEvents())):(this.deselectRow(r),t.headerCheckbox&&(t.suspendEvents(),t.headerCheckbox.checked=!1,t.resumeEvents()))}},{key:"onCheckAllChange",value:function(e){this[e.checked?"selectAll":"deselectAll"]()}},{key:"spliceSelectedRecords",value:function(e,t,n){this._selectedRecordCollection.splice(e,t,n)}},{key:"isSelected",value:function(e){var t;return(null===(t=e)||void 0===t?void 0:t.isModel)&&(e=e.id),Xg[l()(e)]?this.selectedRecordCollection.includes(e):this._selectedCell&&this._selectedCell.id==e.id&&this._selectedCell.columnId===e.columnId}},{key:"isSelectable",value:function(e){if(!e)return!1;var t=this.store.getById(e.id||e);return t&&!(t.meta&&t.isSpecialRow)}},{key:"selectRow",value:function(e){var t=e.record,n=e.column,r=void 0===n?this.columns.bottomColumns[0]:n,i=e.scrollIntoView,o=void 0===i||i,a=e.addToSelection,s=void 0!==a&&a;if("object"!==l()(arguments[0])){var u=arguments;t=u[0],o=!(u.length>1)||u[1],s=u[2]||!1}var c=this,f=c.store.getById(t);t?c.selectCell({id:f.id,column:r},o,s):c.deselectAll()}},{key:"selectCell",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this,o=i.selectedRecordCollection,a=i.selectionMode,s=i.normalizeCellContext(e),u=s.record||i.store.getById(s.id);if(i.isSelectable(u)){if(t&&i.scrollRowIntoView(s.id,{column:s.columnId}),a.row&&(r&&(i.silent=(i.silent||0)+1),n?o.add(u):o.splice(0,o.count,u),r&&i.silent--,1===i.selectedRecordCollection.count&&(i.startCell=s,i.lastRange=null)),a.cell&&(s.columnId||s.column)&&!i.isSelected(s)){var c=i._selectedCell?[i._selectedCell]:[];i._selectedCell=s,i.triggerChangeEvent({mode:"cell",action:"select",selected:[s],deselected:c,selection:[s]},r)}return s}this.deselectAll()}},{key:"selectAll",value:function(){var e,t=this;t.store.isFiltered?(e=t.selectedRecordCollection).add.apply(e,d()(t.store.records.filter((function(e){return!e.isSpecialRow})))):t.selectedRecords=t.store.records.filter((function(e){return!e.isSpecialRow}))}},{key:"deselectAll",value:function(){var e,t=this;t.store.isFiltered?(e=t.selectedRecordCollection).remove.apply(e,d()(t.store.records.filter((function(e){return!e.isSpecialRow})))):t.selectedRecordCollection.clear();t._selectedCell&&t.deselectCell(t._selectedCell)}},{key:"deselectRow",value:function(e){this.deselectRows(e)}},{key:"deselectRows",value:function(e){var t=this,n=(e=Array.isArray(e)?e:[e]).map((function(e){return t.store.getById(e)}));this.selectedRecordCollection.remove(n)}},{key:"deselectCell",value:function(e){var t=this,n=t.normalizeCellContext(e),r=t.selectionMode,i=n.record||t.store.getById(n.id),o=t._selectedCell;return r.row&&t.selectedRecordCollection.remove(i),r.cell&&n.columnId&&o&&o.id===n.id&&o.columnId===n.columnId&&(t._selectedCell=null,t.triggerChangeEvent({mode:"cell",action:"deselect",selected:[],deselected:[n],selection:[]})),n}},{key:"selectRange",value:function(e,t){var n=this.store,r=this.selectedRecordCollection,i=n.indexOf(e),o=n.indexOf(t),a=Math.min(i,o),s=Math.max(i,o);if(-1===a||-1===s)throw new Error("Record not found in selectRange");r.splice(0,r.count,n.getRange(a,s+1,!1))}},{key:"onStoreRemove",value:function(e){we()(pe()(n.prototype),"onStoreRemove",this)&&we()(pe()(n.prototype),"onStoreRemove",this).call(this,e),this.selectedRecordCollection.remove(e.records)}},{key:"onStoreDataChange",value:function(e){var t=e.action,r=e.source;if(we()(pe()(n.prototype),"onStoreDataChange",this)&&we()(pe()(n.prototype),"onStoreDataChange",this).apply(this,arguments),Zg[t]){var i=this.selectedRecordCollection,o=[];i.forEach((function(e){if(r.includes(e)){var t=i.indexOf(e);i.splice(t,1,r.getById(e.id))}else o.push(e)})),i.remove(o)}}},{key:"onStoreRemoveAll",value:function(){we()(pe()(n.prototype),"onStoreRemoveAll",this)&&we()(pe()(n.prototype),"onStoreRemoveAll",this).call(this),this.deselectAll()}},{key:"handleMouseMultiSelect",value:function(e,t){var n=this,r=e.id;(t.metaKey||t.ctrlKey)&&n.isSelected(r)?n.deselectRow(r):n.selectionMode.multiSelect&&(t.shiftKey&&n.startCell?function(e,t){var r=n.store,i=n.selectedRecordCollection,o=r.indexOf(e),a=r.indexOf(t),s=Math.min(o,a),u=Math.max(o,a);if(-1===s||-1===u)throw new Error("Record not found in selectRange");var c=r.getRange(s,u+1,!1).filter((function(e){return n.isSelectable(e)}));i.splice(0,n.lastRange||0,c),n.lastRange=c}(n.startCell.id,r):(t.ctrlKey||t.metaKey)&&n.selectRow({record:r,scrollIntoView:!1,addToSelection:!0}))}},{key:"onCellNavigate",value:function(e,t,n,r){var i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(e.columns.getById(n.columnId)!==e.checkboxColumn&&!e.selectionMode.rowCheckboxSelection&&!(!i||e.returningFocus||r&&r.target.closest(".b-tree-expander"))){var o=t&&n.id===t.id,a=r&&"mousedown"===r.type,s=a&&r.ctrlKey;if(!r||r.button&&2!==r.button||!r.shiftKey&&!s){var u=o&&(!r||r.shiftKey||r.ctrlKey),c=r&&e.isSelected(n.id),l=s;e.selectCell(n,!1,u||l||c)}else e.handleMouseMultiSelect(n,r);e.startCell&&!s||(e.startCell=n,e.lastRange=null)}}},{key:"triggerChangeEvent",value:function(e,t){var n,r,i,o,a=this,s=e.mode,u=e.selected,c=e.deselected;if("row"===s){for(n=0,r=u.length;n<r;n++)(i=a.getRowFor(u[n]))&&(i.addCls("b-selected"),!a.checkboxColumn||a.checkboxColumn.hidden||u[n].isSpecialRow||(i.getCell(a.checkboxColumn.id).widget.checked=!0));for(n=0,r=c.length;n<r;n++)(i=a.getRowFor(c[n]))&&(i.removeCls("b-selected"),!a.checkboxColumn||a.checkboxColumn.hidden||c[n].isSpecialRow||(i.getCell(a.checkboxColumn.id).widget.checked=!1))}else if("cell"===s){for(n=0,r=u.length;n<r;n++)(o=a.getCell(u[n]))&&o.classList.add("b-selected");for(n=0,r=c.length;n<r;n++)(o=a.getCell(c[n]))&&o.classList.remove("b-selected")}t||a.trigger("selectionChange",e)}},{key:"onCellClick",value:function(e){var t=e.event,n=e.record;this.selectionMode.checkbox||!this.selectionMode.multiSelect||t.shiftKey||t.metaKey||t.ctrlKey||this.deselectRows(this.selectedRecords.filter((function(e){return e!==n})))}},{key:"selectedRecordCollection",set:function(e){e instanceof no||(e=new no(e)),this._selectedRecordCollection=e,e.on({change:"onSelectedRecordCollectionChange",thisObj:this})},get:function(){return this._selectedRecordCollection}},{key:"selectedCell",get:function(){return this._selectedCell},set:function(e){this.selectCell(e)}},{key:"selectionMode",set:function(e){e&&e.rowCheckboxSelection&&(e.row=e.checkbox=!0,e.cell=!1),this._selectionMode=e},get:function(){return this._selectionMode}},{key:"selectedRecord",get:function(){return this.selectedRecordCollection.last||null},set:function(e){this.selectRow({record:e})}},{key:"selectedRecords",get:function(){return this.selectedRecordCollection.values},set:function(e){var t=this.selectedRecordCollection,n=this.store,r=[];if(e){var i,o=Ug(e);try{for(o.s();!(i=o.n()).done;){var a=i.value;(a=n.getById(a))&&r.push(a)}}catch(e){o.e(e)}finally{o.f()}}t.splice(0,t.count,r)}},{key:"selectedCellCSSSelector",get:function(){var e=this._selectedCell,t=e&&this.getRowById(e.id);return e&&t?"[data-index=".concat(t.dataIndex,"] [data-column-id=").concat(e.columnId,"]"):""}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"GridSelection"}},{key:"defaultConfig",get:function(){return{selectionMode:{row:!0,cell:!0,rowCheckboxSelection:!1,multiSelect:!0,checkbox:!1,showCheckAll:!1},selectedRecordCollection:{}}}}]),n}(e||ue)}),(function(e){return function(e){fe()(n,e);var t=Jg(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"getState",value:function(){var e=this,t=e.element.style.cssText,n={rowHeight:e.rowHeight,readOnly:e.readOnly};if(t&&(n.style=t),e.selectedCell){var r=e.selectedCell,i=r.id,o=r.columnId;n.selectedCell={id:i,columnId:o}}return n.selectedRecords=e.selectedRecords.map((function(e){return e.id})),n.columns=e.columns.map((function(e){return e.getState()})),n.store=e.store.state,n.scroll=e.storeScroll(),n.subGrids={},e.eachSubGrid((function(e){var t=n.subGrids[e.region]=n.subGrids[e.region]||{};null==e.flex&&(t.width=e.width),t.collapsed=e.collapsed})),n}},{key:"applyState",value:function(e){var t=this;if("readOnly"in e&&(t.readOnly=e.readOnly),"rowHeight"in e&&(t.rowHeight=e.rowHeight),"style"in e&&(t.style=e.style),"selectedCell"in e&&(t.selectedCell=e.selectedCell),"store"in e&&(t.store.state=e.store),"selectedRecords"in e&&(t.selectedRecords=e.selectedRecords),"columns"in e){var n=!1,r=!1;t.columns.suspendEvents(),t.eachSubGrid(Qg),e.columns.forEach((function(e,i){var o=t.columns.getById(e.id);if(o){var a=o.generation;o.applyState(e),n=n||o.generation!==a,o.stateSortIndex=i,o.allIndex!==i&&(r=n=!0)}})),n&&t.eachSubGrid(ty),r&&(t.eachSubGrid((function(e){e.columns.records.sort(ny),e.columns.allRecords.sort(ny)})),t.columns.sort({fn:ny,ascending:!0})),t.isPainted&&n&&t.renderContents(),t.columns.resumeEvents(),t.eachSubGrid(ey)}"subGrids"in e&&t.eachSubGrid((function(t){if(t.region in e.subGrids){var n=e.subGrids[t.region];"width"in n&&(t.width=n.width),"collapsed"in n&&(t.collapsed=n.collapsed)}})),"scroll"in e&&t.restoreScroll(e.scroll)}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"GridState"}}]),n}(e||ue)}),(function(e){return function(e){fe()(n,e);var t=hy(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"changeSubGridConfigs",value:function(e){var t,n=new Set,r=fy(this.columns);try{for(r.s();!(t=r.n()).done;){var i=t.value;i.region&&!e[i.region]&&(e[i.region]={}),n.add(i.region)}}catch(e){r.e(e)}finally{r.f()}e.normal&&an.isEmpty(e.normal)&&(e.normal=Cy.defaultConfig.subGridConfigs.normal);var o,a=fy(n);try{for(a.s();!(o=a.n()).done;){var s=o.value;this.createSubGrid(s,e[s])}}catch(e){a.e(e)}finally{a.f()}return this.items=Object.values(this.subGrids),e}},{key:"createSubGrid",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this,r=n.columns.makeChained((function(t){return t.region===e}),["region"]),i=an.assign({grid:n,store:n.store,rowManager:n.rowManager,region:e,headerClass:n.headerClass,footerClass:n.footerClass,columns:r,weight:e},t||n.subGridConfigs[e]);n.regions.push(e);var o=!1;i.flex||i.width||(i.width=r.totalFixedWidth,o=!0);var a=n.subGrids[e]=new ly(i);return a.hasCalculatedWidth=o,e===n.regions[0]&&(a.isFirstRegion=!0),a}},{key:"onChildAdd",value:function(e){if(e.isSubGrid){var t=this,r=t.items,i=t.headerContainer,o=t.virtualScrollers,a=t.footerContainer,s=2*r.indexOf(e);t.hideHeaders||(Cr.insertAt(i,e.headerSplitter,s),Cr.insertAt(i,e.header.element,s)),Cr.insertAt(o,e.scrollerSplitter,s),Cr.insertAt(o,e.virtualScrollerElement,s),Cr.insertAt(a,e.footerSplitter,s),Cr.insertAt(a,e.footer.element,s),r.forEach((function(e,t){t<r.length-1&&e.showSplitter()}))}return we()(pe()(n.prototype),"onChildAdd",this).call(this,e)}},{key:"onChildRemove",value:function(e){we()(pe()(n.prototype),"onChildRemove",this).call(this,e);var t=this.items;delete this.subGrids[e.region],De.remove(this.regions,e.region),e.destroy(),t.length&&t[t.length-1].hideSplitter()}},{key:"doDestroy",value:function(){this.eachSubGrid((function(e){return e.destroy()})),we()(pe()(n.prototype),"doDestroy",this).call(this)}},{key:"eachSubGrid",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;this.items.forEach((function(n,r){e.call(t||n,n,r++)}))}},{key:"eachWidget",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.items.forEach((function(n){!1!==e(n)&&t&&n.eachWidget&&n.eachWidget(e,t)}))}},{key:"callEachSubGrid",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];var i=null;return this.items.forEach((function(t,r){if(t[e]){var o=t[e].apply(t,n);0===r&&(i=o)}})),i}},{key:"getLastRegions",value:function(){var e=this.regions.slice(-2);return 2===e.length?e:[e[0],e[0]]}},{key:"getNextRegion",value:function(e){var t=this.regions;return t[t.indexOf(e)+1]||t[t.length-2]}},{key:"getPreviousRegion",value:function(e){return this.regions[this.regions.indexOf(e)-1]}},{key:"getSubGrid",value:function(e){return this.subGrids[e]}},{key:"getSubGridFromColumn",value:function(e){return e=e instanceof Dh?e:this.columns.get(e)||this.columns.getById(e),this.getSubGrid(e.region)}},{key:"resolveSplitter",value:function(e){var t=this.getLastRegions(),n=e instanceof ly?e.region:e;return t[1]===n&&(n=t[0]),this.subGrids[n].splitterElement}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"GridSubGrids"}},{key:"properties",get:function(){return{subGrids:{},regions:[]}}}]),n}(e||ue)})));function Sy(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Cy.initClass(),y.a.setVersion("grid","4.0.2"),Cy._$name="GridBase";var Dy={Enter:1,F2:1},Ry={ArrowUp:1,ArrowDown:1,ArrowLeft:1,ArrowRight:1},xy=function(e){fe()(f,e);var t,n,r,i,o,a,s,u,c=Sy(f);function f(){return v()(this,f),c.apply(this,arguments)}return g()(f,[{key:"construct",value:function(e,t){we()(pe()(f.prototype),"construct",this).call(this,e,t);var n=this,r={beforeRenderRows:"onGridBeforeRenderRows",cellClick:"onCellClick",thisObj:n};n.grid=e,"cellclick"!==n.triggerEvent&&(r[n.triggerEvent]="onTriggerEditEvent"),e.on(r),n.bindStore(e.store)}},{key:"bindStore",value:function(e){this.detachListeners("store"),e.on({name:"store",update:"onStoreUpdate",thisObj:this})}},{key:"confirm",value:(u=Wr()(Vr.a.mark((function e(t){var n;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=!0,!this.editorContext){e.next=7;break}return zd.owner=this.editorContext.editor.inputField,e.next=5,zd.confirm(t);case 5:n=e.sent,zd.owner=null;case 7:return e.abrupt("return",n===zd.yesButton);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"doDestroy",value:function(){this.cancelEditing(!0),this.grid.columns.allRecords.forEach((function(e){e._cellEditor&&e._cellEditor.destroy()})),we()(pe()(f.prototype),"doDestroy",this).call(this)}},{key:"doDisable",value:function(e){e&&this.cancelEditing(!0),we()(pe()(f.prototype),"doDisable",this).call(this,e)}},{key:"getEditorForCell",value:function(e){var t=e.cell,n=e.column,r=e.selector,i=e.editor,o=this,a=o.grid,s=n._cellEditor,u=0;n.editTargetSelector&&(u=t.querySelector(n.editTargetSelector).offsetLeft);return i.autoSelect=o.autoSelect,s?(s.inputField!==i&&(s.remove(s.items[0]),s.add(i)),s.align.offset[0]=u):s=n._cellEditor=new o.editorClass({constrainTo:null,cls:"b-cell-editor",inputField:i,blurAction:"none",invalidAction:n.invalidAction,completeKey:!1,cancelKey:!1,owner:a,align:{align:"t0-t0",offset:[u,0]},listeners:o.getEditorListeners()}),n.instantUpdate&&!i.cellEditValueSetter&&(an.wrapProperty(i,"value",null,(function(e){var t=o.editorContext;(null==t?void 0:t.editor.isValid)&&!an.isEqual(t.record[t.column.field],e)&&(t.record[t.column.field]=e)})),i.cellEditValueSetter=!0),Object.assign(s.element.dataset,{rowId:r.id,columnId:r.columnId,field:n.field}),s.inputField.revertOnEscape=n.revertOnEscape,o.editor=s}},{key:"getEditorListeners",value:function(){return{focusout:"onEditorFocusOut",focusin:"onEditorFocusIn",start:"onEditorStart",beforecomplete:"onEditorBeforeComplete",complete:"onEditorComplete",cancel:"onEditorCancel",thisObj:this}}},{key:"onEditorStart",value:function(e){var t=e.source,n=this,r=n.editorContext=t.cellEditorContext;if(r){var i=n.grid;r.cell.classList.add("b-editing"),"cellclick"!==n.triggerEvent&&i.on({cellclick:"onCellClickWhileEditing"},n),n.removeEditingListeners=$r.addListener({globaltap:"onTapOut",thisObj:n}),i.trigger("startCellEdit",{grid:i,editorContext:r})}}},{key:"onEditorBeforeComplete",value:function(e){var t=this.grid,n=e.source.cellEditorContext;return e.grid=t,e.editorContext=n,t.trigger("beforeFinishCellEdit",e)}},{key:"onEditorComplete",value:function(e){var t=e.source,n=this.grid,r=t.cellEditorContext;r.value=t.inputField.value,n.trigger("finishCellEdit",{grid:n,editorContext:r}),this.cleanupAfterEdit(r)}},{key:"onEditorCancel",value:function(){var e=this.editorContext,t=this.muteEvents,n=this.grid;e&&this.cleanupAfterEdit(e),t||n.trigger("cancelCellEdit",{grid:n})}},{key:"cleanupAfterEdit",value:function(e){var t=e.editor;e.cell.classList.remove("b-editing"),t.cellEditorContext=this.editorContext=null,this.grid.un({cellclick:"onCellClickWhileEditing",viewportResize:"onViewportResizeWhileEditing"},this),this.removeEditingListeners(),$r.suspendFocusEvents(),t.element.remove(),$r.resumeFocusEvents()}},{key:"getAdjacentEditableCell",value:(s=Wr()(Vr.a.mark((function e(t,n){var r,i,o,a,s,u,c,l;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=this.grid,i=r.store,o=r.columns,a=t.id,s=t.columnId,u=o.getAdjacentLeaf(s,n);case 2:if(!a){e.next=16;break}if(c=i.getById(a),!u){e.next=11;break}if(s=u.id,u.hidden||!u.editor||!u.canEdit(c)){e.next=8;break}return e.abrupt("return",{id:a,columnId:u.id});case 8:u=o.getAdjacentLeaf(s,n),e.next=14;break;case 11:l=i.getAdjacent(t.id,n,!1,!0),a=null==l?void 0:l.id,l&&(u=n?o.first:o.leaves[o.leaves.length-1]);case 14:e.next=2;break;case 16:return e.abrupt("return",null);case 17:case"end":return e.stop()}}),e,this)}))),function(e,t){return s.apply(this,arguments)})},{key:"doAddNewAtEnd",value:(a=Wr()(Vr.a.mark((function e(t){var n,r;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.grid,r=n.store.add(t)[0],n.rowManager.getRowFor(r)||n.rowManager.displayRecordAtBottom(),e.abrupt("return",r);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"getEditingContext",value:function(e){e=this.grid.normalizeCellContext(e);var t=this.grid,n=t.columns.getById(e.columnId),r=t.store.getById(e.id);if(n&&!n.hidden&&n.editor&&r&&!r.isSpecialRow&&n.canEdit(r)){var i=null==r?void 0:r[n.field];return{column:n,record:r,value:void 0===i?null:i,selector:e,editor:n.editor}}return!1}},{key:"startEditing",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this;if(!t.editorContext&&!t.disabled){var n=t.grid,r=n.normalizeCellContext(e),i=t.getEditingContext(r);if(!i)return!1;if(n.focusCell(e),i.cell=n.getCell(e),!1===n.trigger("beforeCellEditStart",{grid:n,editorContext:i}))return!1;Cr.focusWithoutScrolling(n.focusElement);var o=i.editor=t.getEditorForCell(i),a=i.cell,s=i.record,u=i.column;return o.inputField.highlightExternalChange=!1,o.cellEditorContext=i,o.render(t.grid.getSubGridFromColumn(u).element),o.startEdit({target:a,record:s,field:o.inputField.name||i.column.field}),!0}return!1}},{key:"cancelEditing",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=t.editorContext,r=t.editor,i=t.grid;n&&(r.containsFocus&&(t.editorContext=null,r.inputField.owns(Cr.activeElement)&&Cr.focusWithoutScrolling(i.focusElement),t.editorContext=n),t.muteEvents=e,r.cancelEdit(),t.muteEvents=!1)}},{key:"finishEditing",value:(o=Wr()(Vr.a.mark((function e(){var t,n,r;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.editorContext,n=!1,!t){e.next=9;break}return r=t.column,this.finishEditingPromise=t.editor.completeEdit(r.bindCallback(r.finalizeCellEdit)),e.next=7,this.finishEditingPromise;case 7:n=e.sent,this.finishEditingPromise=null;case 9:return e.abrupt("return",n);case 10:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"onCellClickWhileEditing",value:(i=Wr()(Vr.a.mark((function e(t){var n,r,i;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.event,r=t.cellSelector,!(i=this).finishEditingPromise){e.next=4;break}return e.abrupt("return");case 4:if(!i.editorContext||i.editorContext.editor.owns(n.target)){e.next=17;break}if(!i.getEditingContext(r)){e.next=16;break}return e.next=8,i.finishEditing();case 8:if(!e.sent){e.next=12;break}i.startEditing(r),e.next=14;break;case 12:i.grid.focusCell(i.editorContext.selector),i.editor.inputField.focus();case 14:e.next=17;break;case 16:i.finishEditing();case 17:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"onCellClick",value:function(e){var t=e.source,n=e.record,r=e.cellSelector,i=e.cellElement,o=e.target,a=e.event,s=t.focusedCell||{},u=t.columns.getById(r.columnId);if(u.onCellClick)u.onCellClick({grid:t,column:u,record:n,cellSelector:r,cellElement:i,target:o,event:a});else{if(o.closest(".b-tree-expander"))return this.cancelEditing(),!1;Cr.isTouchEvent&&r.id==s.id&&r.columnId==s.columnId?this.startEditing(r):"cellclick"===this.triggerEvent&&this.onTriggerEditEvent({cellSelector:r})}}},{key:"onTriggerEditEvent",value:function(e){var t=e.cellSelector;this.editorContext&&!this.finishEditing()||this.startEditing(t)}},{key:"onStoreUpdate",value:function(e){var t=e.changes,n=e.record,r=this.editorContext;(null==r?void 0:r.editor.isVisible)&&n===r.record&&r.editor.dataField in t&&r.editor.refreshEdit()}},{key:"onGridBeforeRenderRows",value:function(){var e;(null===(e=this.editorContext)||void 0===e?void 0:e.editor.isVisible)&&this.cancelEditing()}},{key:"onElementKeyDown",value:(r=Wr()(Vr.a.mark((function e(t){var n,r,i,o,a,s;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this,!t.handled&&n.grid.focusElement.contains(t.target)){e.next=3;break}return e.abrupt("return");case 3:if(n.editorContext){e.next=8;break}r=t.key,i="Backspace"===r,((o=n.autoEdit&&(1===r.length||i))||Dy[r])&&n.grid.focusedCell&&(n.startEditing(n.grid.focusedCell)&&(a=n.editor.inputField,s=a.input,o&&s&&(a.internalOnKeyEvent(t),t.defaultPrevented||(s.value=i?"":r,a.internalOnInput(t),a.moveCaretToEnd()))),t.preventDefault()),e.next=23;break;case 8:e.t0=t.key,e.next="Enter"===e.t0?11:"F2"===e.t0?13:"Escape"===e.t0?16:"Tab"===e.t0?20:22;break;case 11:return n.onEnterKeyPress(t),e.abrupt("break",22);case 13:return t.preventDefault(),n.finishEditing(),e.abrupt("break",22);case 16:return t.stopPropagation(),t.preventDefault(),n.cancelEditing(),e.abrupt("break",22);case 20:return n.onTabKeyPress(t),e.abrupt("break",22);case 22:Ry[t.key]&&(t.handled=!0);case 23:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"onEnterKeyPress",value:(n=Wr()(Vr.a.mark((function e(t){var n,r;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(n=this).grid,t.preventDefault(),t.stopPropagation(),e.next=5,n.finishEditing();case 5:if(!e.sent){e.next=10;break}if(n.isEditing){e.next=10;break}if(!(t.ctrlKey||t.metaKey||t.altKey||n.grid.touch)){e.next=9;break}return e.abrupt("return");case 9:t.shiftKey?r.navigateUp()&&n.startEditing(r.focusedCell):r.navigateDown()&&n.startEditing(r.focusedCell);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"onTabKeyPress",value:(t=Wr()(Vr.a.mark((function e(t){var n,r,i,o,a;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t.preventDefault(),!(r=(n=this).grid.focusedCell)){e.next=24;break}return i=!t.shiftKey,e.next=6,n.getAdjacentEditableCell(r,i);case 6:if((o=e.sent)||!i||!n.addNewAtEnd){e.next=17;break}return e.next=10,n.finishEditing();case 10:if(!0!==e.sent){e.next=17;break}return e.next=14,this.doAddNewAtEnd("object"===l()(n.addNewAtEnd)?an.clone(n.addNewAtEnd):{});case 14:return e.next=16,n.getAdjacentEditableCell(r,i);case 16:o=e.sent;case 17:if(!o){e.next=24;break}if(a=!0,!n.isEditing){e.next=23;break}return e.next=22,n.finishEditing();case 22:a=e.sent;case 23:a&&(n.grid.focusCell(o,{animate:n.focusCellAnimationDuration}),n.startEditing(o));case 24:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"onElementMouseDown",value:function(e){2===e.button&&this.editorContext&&e.preventDefault()}},{key:"onEditorFocusOut",value:function(e){var t=this,n=t.grid;t.editorContext&&!t.editor.isFinishing&&t.editor.inputField.owns(e._target)&&(e.toWidget!==n||n.isLocationEqual(t.grid.focusedCell,t.editorContext.selector))&&("cancel"===t.blurAction?t.cancelEditing():t.finishEditingPromise||t.finishEditing())}},{key:"onEditorFocusIn",value:function(e){var t=e.toWidget;t===this.editor.inputField&&this.autoSelect&&t.selectAll&&!t.readOnly&&!t.disabled&&t.selectAll()}},{key:"onTapOut",value:function(e){var t=e.event,n=this;n.grid.bodyContainer.contains(t.target)||n.editor.owns(t.target)||("cancel"===n.blurAction?n.cancelEditing():n.finishEditing())}},{key:"onElementClick",value:function(e){e.target.classList.contains("b-grid-body-container")&&this.editorContext&&this.finishEditing()}},{key:"disabled",set:function(e){sc()(pe()(f.prototype),"disabled",e,this,!0)},get:function(){var e=this.grid;return Boolean(we()(pe()(f.prototype),"disabled",this)||e.disabled||e.readOnly)}},{key:"isEditing",get:function(){return Boolean(this.editorContext)}},{key:"activeRecord",get:function(){var e;return(null===(e=this.editorContext)||void 0===e?void 0:e.record)||null}}],[{key:"$name",get:function(){return"CellEdit"}},{key:"defaultConfig",get:function(){return{autoSelect:!0,blurAction:"complete",addNewAtEnd:null,autoEdit:!1,editorClass:fd,triggerEvent:"celldblclick",focusCellAnimationDuration:100}}},{key:"pluginConfig",get:function(){return{assign:["startEditing"],before:["onElementKeyDown","onElementMouseDown"],chain:["onElementClick","bindStore"]}}}]),f}(_a(qr));function Ey(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}xy._$name="CellEdit",fv.registerFeature(xy,!0);var Ty=function(e){fe()(n,e);var t=Ey(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"$name",get:function(){return"Grid"}},{key:"type",get:function(){return"grid"}}]),n}(Cy);function My(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Ty.initClass(),Ty._$name="Grid";var Ay=function(e){fe()(n,e);var t=My(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"store",set:function(e){if(e&&!e.tree){if(e instanceof No)throw new Error("TreeGrid requires a Store configured with tree : true");e.tree=!0}sc()(pe()(n.prototype),"store",e,this,!0)},get:function(){return we()(pe()(n.prototype),"store",this)}}],[{key:"$name",get:function(){return"TreeGrid"}},{key:"type",get:function(){return"treegrid"}}]),n}(Ty);function Py(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Iy(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Iy(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Iy(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Oy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Fy(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Ay.initClass(),Ay._$name="TreeGrid";var Ly=function(e,t,n){return e.store&&(e=e.store),t.store&&(t=t.store),(e=e[n]||0)<(t=t[n]||0)?-1:e>t?1:0},jy=function(e,t){return Ly(e,t,"loadPriority")},_y=function(e,t){return Ly(e,t,"syncPriority")},By=function(){},Hy=function(e){var t;e.$meta;var n=[];return e.isEvents||n.push(Ge),e.isDelayable||n.push(_a),function(e){fe()(f,e);var t,n,r,i,o,a,s,u,c=Fy(f);function f(){return v()(this,f),c.apply(this,arguments)}return g()(f,[{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._requestId=0,this.activeRequests={},this.crudStoresIndex={},we()(pe()(f.prototype),"construct",this).call(this,e)}},{key:"afterConstruct",value:function(){we()(pe()(f.prototype),"afterConstruct",this).call(this),this.autoLoad&&this.doAutoLoad()}},{key:"doAutoLoad",value:function(){var e=this;return this.load().catch((function(t){if(!t||!e.isValidResponse(t.rawResponse,t.response))throw t}))}},{key:"getStoreDescriptor",value:function(e){return e?e instanceof No?this.crudStores.find((function(t){return t.store===e})):"object"===l()(e)?this.crudStoresIndex[e.storeId]:this.crudStoresIndex[e]||this.getStoreDescriptor(No.getStore(e)):null}},{key:"fillStoreDescriptor",value:function(e){var t=e.store,n=t.storeIdProperty,r=void 0===n?this.storeIdProperty:n,i=t.modelClass;return e.storeId||(e.storeId=t[r]),e.idField||(e.idField=i.idField),e.phantomIdField||(e.phantomIdField=i.phantomIdField),e.phantomParentIdField||(e.phantomParentIdField=i.phantomParentIdField),"writeAllFields"in e||(e.writeAllFields=t.writeAllFields),e}},{key:"updateCrudStoreIndex",value:function(){var e=this.crudStoresIndex={};this.crudStores.forEach((function(t){return t.storeId&&(e[t.storeId]=t)}))}},{key:"getCrudStore",value:function(e){var t=this.getStoreDescriptor(e);return null==t?void 0:t.store}},{key:"forEachCrudStore",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;e&&this.crudStores.every((function(n){return!1!==e.call(t,n.store,n.storeId,n)}))}},{key:"internalAddCrudStore",value:function(e){var t,n=this;return e instanceof No?t={store:e}:"object"===l()(e)?(e.stores?(Array.isArray(e.stores)||(e.stores=[e.stores]),e.stores.forEach((function(t,n){var r=t;"string"==typeof t&&(r={storeId:t}),r.masterStoreInfo=e,e.stores[n]=r}))):e.store||(e={storeId:e.id,store:new No(e)}),t=e):t={store:No.getStore(e)},n.fillStoreDescriptor(t),(e=t.store).setCrudManager?e.setCrudManager(n):e.crudManager=n,e.pageSize=null,n.overrideCrudStoreLoad&&e.load&&(e.load=e.commit=function(){}),n.bindCrudStoreListeners(e),t}},{key:"addCrudStore",value:function(e,t,n){var r;if(e&&(Array.isArray(e)||(e=[e]),e.length)){var i=this,o=e.map(i.internalAddCrudStore,i);if(void 0===t){var a;(a=i.crudStores).push.apply(a,d()(o))}else{var s,u=t;n&&((n instanceof No||"object"!==l()(n))&&(n=i.getStoreDescriptor(n)),u+=i.crudStores.indexOf(n)),(s=i.crudStores).splice.apply(s,[u,0].concat(d()(o)))}(r=i.orderedCrudStores).push.apply(r,d()(o)),i.updateCrudStoreIndex()}}},{key:"addPrioritizedStore",value:function(e){this.hasCrudStore(e)||this.addCrudStore(e,De.findInsertionIndex(e,this.crudStores,jy)),this.hasApplySequenceStore(e)||this.addStoreToApplySequence(e,De.findInsertionIndex(e,this.syncApplySequence,_y))}},{key:"hasCrudStore",value:function(e){var t;return null===(t=this.crudStores)||void 0===t?void 0:t.some((function(t){return t===e||t.store===e||t.storeId===e}))}},{key:"removeCrudStore",value:function(e){for(var t=this,n=t.crudStores,r=0,i=n.length;r<i;r++){var o=n[r];if(o===e||o.store===e||o.storeId===e){t.unbindCrudStoreListeners(o.store),delete t.crudStoresIndex[o.storeId],n.splice(r,1),t.syncApplySequence&&t.removeStoreFromApplySequence(e);break}}}},{key:"bindCrudStoreListeners",value:function(e){e.on({name:e.id,change:"onCrudStoreChange",thisObj:this})}},{key:"unbindCrudStoreListeners",value:function(e){this.detachListeners(e.id)}},{key:"addStoreToApplySequence",value:function(e,t,n){if(e){Array.isArray(e)||(e=[e]);var r=this,i=e.reduce((function(e,t){var n=r.getStoreDescriptor(t);return n&&e.push(n),e}),[]);if(void 0===t){var o;(o=r.syncApplySequence).push.apply(o,d()(i))}else{var a,s=t;n&&((n instanceof No||"object"!==l()(n))&&(n=r.getStoreDescriptor(n)),s+=r.syncApplySequence.indexOf(n)),(a=r.syncApplySequence).splice.apply(a,[s,0].concat(d()(i)))}var u=r.syncApplySequence.map((function(e){return e.storeId}));r.orderedCrudStores=d()(r.syncApplySequence),r.crudStores.forEach((function(e){u.includes(e.storeId)||r.orderedCrudStores.push(e)}))}}},{key:"removeStoreFromApplySequence",value:function(e){var t=this.syncApplySequence.findIndex((function(t){return t===e||t.store===e||t.storeId===e}));t>-1&&(this.syncApplySequence.splice(t,1),this.orderedCrudStores.splice(t,1))}},{key:"hasApplySequenceStore",value:function(e){return this.syncApplySequence.some((function(t){return t===e||t.store===e||t.storeId===e}))}},{key:"onCrudStoreChange",value:function(){var e=this;e.crudIgnoreUpdates||(e.crudStoreHasChanges()?(e.trigger("hasChanges"),e.autoSync&&e.scheduleAutoSync()):e.trigger("noChanges"))}},{key:"suspendAutoSync",value:function(){this.autoSyncSuspendCounter++,this.forEachCrudStore((function(e){return e.suspendAutoCommit()}))}},{key:"resumeAutoSync",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this;t.autoSyncSuspendCounter--,t.autoSyncSuspendCounter<=0&&(t.autoSyncSuspendCounter=0,t.autoSync&&e&&(t.forEachCrudStore((function(t){return t.resumeAutoCommit(e)})),t.sync()))}},{key:"scheduleAutoSync",value:function(){var e=this;e.autoSyncTimerId||e.autoSyncSuspendCounter||(e.autoSyncTimerId=e.setTimeout((function(){e.autoSyncTimerId=null,e.sync().catch((function(t){if(!t||!e.isValidResponse(t.rawResponse,t.response))throw t}))}),e.autoSyncTimeout))}},{key:"internalOnResponse",value:(u=Wr()(Vr.a.mark((function e(t,n,r,i){var o,a;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((o=this).activeRequests[t]=null,(a=n?o.decode(n):null)&&a.success){e.next=7;break}return o.trigger("requestFail",{requestType:t,response:a,responseText:n,responseOptions:r}),o.trigger(t+"Fail",{response:a,responseOptions:r,responseText:n,options:i}),e.abrupt("return",a);case 7:if(!1===o.trigger("beforeResponseApply",{requestType:t,response:a})||!1===o.trigger("before"+E.capitalize(t)+"Apply",{response:a,options:i})){e.next=14;break}return o.crudRevision=a.revision,e.next=11,o.applyResponse(t,a,i);case 11:o.trigger("requestDone",{requestType:t,response:a,responseOptions:r}),o.trigger(t,{response:a,responseOptions:r,options:i}),"load"!==t&&o.crudStoreHasChanges()||o.trigger("noChanges");case 14:return e.abrupt("return",a);case 15:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r){return u.apply(this,arguments)})},{key:"internalOnLoad",value:(s=Wr()(Vr.a.mark((function e(t,n,r){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.crudLoaded=!0,e.abrupt("return",this.internalOnResponse("load",t,n,r));case 2:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return s.apply(this,arguments)})},{key:"internalOnSync",value:(a=Wr()(Vr.a.mark((function e(t,n,r){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.internalOnResponse("sync",t,n,r));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return a.apply(this,arguments)})},{key:"suspendChangesTracking",value:function(){this.crudIgnoreUpdates++}},{key:"resumeChangesTracking",value:function(e){!this.crudIgnoreUpdates||--this.crudIgnoreUpdates||e||this.onCrudStoreChange()}},{key:"crudStoreHasChanges",value:function(e){return e?this.isCrudStoreDirty(this.getCrudStore(e)):this.crudStores.some(this.isCrudStoreDirty)}},{key:"isCrudStoreDirty",value:function(e){return Boolean(null==e?void 0:e.store.changes)}},{key:"emitCrudStoreEvents",value:function(e,t,n){var r,i=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Oy(Object(n),!0).forEach((function(t){ke()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Oy(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({action:"read"+t},n),o=Py(this.crudStores);try{for(o.s();!(r=o.n()).done;){var a=r.value;e.includes(a.storeId)&&a.store.trigger(t,i)}}catch(e){o.e(e)}finally{o.f()}}},{key:"getLoadPackage",value:function(e){var t={type:"load",requestId:this.requestId},n=this.crudStores,r=Object.assign({},e);return delete r.request,t.stores=n.map((function(e){var t,n=null==r?void 0:r[e.storeId],i=e.pageSize||(null===(t=e.store)||void 0===t?void 0:t.pageSize);if(n||i){var o=Object.assign({storeId:e.storeId,page:1},n);return i&&(o.pageSize=i),e.currentPage=o.page,n&&delete r[e.storeId],o}return e.storeId})),Object.assign(t,r),t}},{key:"loadCrudStore",value:function(e,t,n){var r=null==t?void 0:t.rows;(null==n?void 0:n.append)||(null==t?void 0:t.append)?e.add(r):e.data=r,e.trigger("load",{data:r})}},{key:"loadDataToCrudStore",value:function(e,t,n){var r,i=this,o=e.store,a=e.stores,s=e.idField||"id",u=o.tree,c=null==t?void 0:t.rows;(o.__loading=!0,c)&&(a&&(r=i.getSubStoresData(c,a,s,u)),i.loadCrudStore(o,t,n,e),r&&r.forEach((function(e){i.loadDataToCrudStore(Object.assign({store:o.getById(e.id).get(e.storeDesc.storeId)},e.storeDesc),e.data)})));o.__loading=!1}},{key:"loadCrudManagerData",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.suspendChangesTracking(),this.crudStores.forEach((function(r){var i=r.storeId,o=e[i];o&&t.loadDataToCrudStore(r,o,n[i])})),this.resumeChangesTracking(!0)}},{key:"load",value:function(e){var t=this,n=t.getLoadPackage(e);return new Promise((function(r,i){if(!1!==t.trigger("beforeLoad",{pack:n})){var o=t.activeRequests.load;o&&(t.cancelRequest(o.desc,o.reject),t.trigger("loadCanceled",{pack:n}));var a=F.assign({data:t.encode(n),type:"load",success:t.onLoadSuccess,failure:t.onLoadFailure,thisObj:t},null==e?void 0:e.request);t.activeRequests.load={options:e,pack:n,resolve:r,reject:function(){a.success=a.failure=null,i.apply(void 0,arguments)},id:n.requestId,desc:t.sendRequest(a)},t.emitCrudStoreEvents(n.stores,"loadStart"),t.trigger("loadStart",{pack:n})}else t.trigger("loadCanceled",{pack:n}),t.processPromise(i,null,{action:"load",cancelled:!0})}))}},{key:"onLoadSuccess",value:(o=Wr()(Vr.a.mark((function e(t,n){var r,i,o,a;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isDestroyed){e.next=2;break}return e.abrupt("return");case 2:return r="",i=this.activeRequests.load,o=i.options,e.next=6,t.text().then((function(e){return r=e})).catch(By);case 6:if(!this.isDestroyed){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,this.internalOnLoad(r,n,o);case 10:if(a=e.sent,!this.isDestroyed){e.next=13;break}return e.abrupt("return");case 13:this.emitCrudStoreEvents(i.pack.stores,"afterRequest"),(null==a?void 0:a.success)?i.resolve({response:a,rawResponse:t,responseText:r,options:o}):this.processPromise(i.reject,i.resolve,{action:"load",cancelled:!1,response:a,rawResponse:t,responseText:r,options:o});case 15:case"end":return e.stop()}}),e,this)}))),function(e,t){return o.apply(this,arguments)})},{key:"onLoadFailure",value:(i=Wr()(Vr.a.mark((function e(t){var n,r,i,o,a,s,u,c,l=arguments;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=l.length>1&&void 0!==l[1]?l[1]:{},!this.isDestroyed){e.next=3;break}return e.abrupt("return");case 3:if(i=this.activeRequests.load,o=i.options,a=null===(n=r.abortController)||void 0===n?void 0:n.signal,s=Boolean(null==a?void 0:a.aborted)){e.next=18;break}if(u="",!t){e.next=9;break}return e.next=9,t.text().then((function(e){return u=e})).catch(By);case 9:if(!this.isDestroyed){e.next=11;break}return e.abrupt("return");case 11:return e.next=13,this.internalOnLoad(u,r,o);case 13:if(c=e.sent,!this.isDestroyed){e.next=16;break}return e.abrupt("return");case 16:this.emitCrudStoreEvents(i.pack.stores,"afterRequest",{exception:!0}),this.processPromise(i.reject,null,{action:"load",cancelled:s,response:c,rawResponse:t,responseText:u,options:o,request:i});case 18:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"getSubStoresData",value:function(e,t,n,r){var i=this;if(e){var o=[];return r?e.forEach((function(e){a(e,t);var r=i.getSubStoresData(e.children,t,n,!0);r&&o.push.apply(o,d()(r))})):e.forEach((function(e){return a(e,t)})),o}function a(e,t){t.forEach((function(t){var r=t.storeId;e[r]&&(o.push({id:e[n],storeDesc:t,data:e[r]}),delete e[r])}))}}},{key:"prepareAdded",value:function(e,t){var n=this,r=t.store,i=t.stores,o=r.isTree,a=t.phantomIdField||this.phantomIdField,s=t.phantomParentIdField||this.phantomParentIdField;return e.filter((function(e){return e.isValid})).map((function(e){var t=e.constructor,r=Object.assign(e.persistableData,ke()({},a,e.id));if(o){var u=e.parent;u&&!u.isRoot&&u.isPhantom&&(r[s]=u.id)}return n.resetIdsBeforeSync&&an.deletePath(r,t.getFieldDataSource(t.idField)),i&&n.processSubStores(e,r,i),r}))}},{key:"prepareUpdated",value:function(e,t){var n=this,r=t.store,i=t.stores,o=r.isTree,a=t.writeAllFields||!1!==t.writeAllFields&&this.writeAllFields,s=t.phantomParentIdField||this.phantomParentIdField;if(t.store.tree){var u=t.store.rootNode;e=e.filter((function(e){return e!==u}))}return e.filter((function(e){return e.isValid})).reduce((function(e,t){var r;if(r=a?t.persistableData:t.modificationData,o){var u=t.parent;u&&!u.isRoot&&u.isPhantom&&(r[s]=u.id)}return i&&n.processSubStores(t,r,i),an.isEmpty(r)||e.push(r),e}),[])}},{key:"prepareRemoved",value:function(e){return e.map((function(e){var t=e.constructor;return an.setPath({},t.getFieldDataSource(t.idField),e.id)}))}},{key:"processSubStores",value:function(e,t,n){var r=this;n.forEach((function(n){var i=n.storeId,o=e.get(i);if(o){var a=r.getCrudStoreChanges(Object.assign({store:o},n));a?t[i]=Object.assign(a,{$store:!0}):delete t[i]}else delete t[i]}))}},{key:"getCrudStoreChanges",value:function(e){var t,n=e.store,r=n.added.values,i=n.modified.values,o=n.removed.values;return r.length&&(r=this.prepareAdded(r,e)),i.length&&(i=this.prepareUpdated(i,e)),o.length&&(o=this.prepareRemoved(o)),(r.length||i.length||o.length)&&(t={},r.length&&(t.added=r),i.length&&(t.updated=i),o.length&&(t.removed=o)),t}},{key:"getChangeSetPackage",value:function(){var e=this,t={type:"sync",requestId:this.requestId,revision:this.crudRevision},n=0;return this.crudStores.forEach((function(r){var i=e.getCrudStoreChanges(r);i&&(n++,t[r.storeId]=i)})),n?t:null}},{key:"applyChangesToRecord",value:function(e,t,n){var r,i=this,o=e.constructor,a=o.fieldDataSourceMap,s=o.prototype,u={},c=e.data,l=ke()({},i.phantomIdField,!0);n&&n.forEach((function(n){var r=n.storeId;if(Object.prototype.hasOwnProperty.call(t,r)){l[r]=!0;var o=e.get(r);o?i.applyChangesToStore(Object.assign({store:o},n),t[r]):console.log("Can't find store for the response sub-package")}}));var f={};for(var d in t)Object.prototype.hasOwnProperty.call(t,d)&&!l[d]&&(f[d]=t[d]);var h=an.pathifyKeys(f);for(var v in h){var p=a[v],g=p?p.name:v,y=o.processField(g,h[v]),m=v in s?e[g]:an.getPath(c,v);((null==p?void 0:p.isEqual)?p.isEqual(m,y):an.isEqual(m,y))||(r=!0,u[g]=y)}if(r){for(var k in i.suspendChangesTracking(),u)e[k]=u[k];i.resumeChangesTracking(!0)}e.clearChanges(!0,!1)}},{key:"applyRemovals",value:function(e,t,n){var r=this,i=e.removed,o=e.modelClass,a=n.findByIdFn,s=n.removeRecordFn,u=o.getFieldDataSource(o.idField),c=0;return t.forEach((function(e){var t=e[u],n=!1;if(i.includes(t)&&(i.remove(t),n=!0,c++),!n){var o=a(t);o?(r.suspendChangesTracking(),s(o),i.remove(o),c++,r.resumeChangesTracking(!0)):console.log("Can't find record to remove from the response package")}})),c}},{key:"getApplyChangesToStoreHelpers",value:function(e){return e.tree?{findByPhantomFn:function(t){return e.getById(t)},findByIdFn:function(t){return e.getById(t)},addRecordFn:function(t){return(t.parentId&&e.getById(t.parentId)||e.rootNode).appendChild(t)},removeRecordFn:function(e){return e.remove()}}:{findByPhantomFn:function(t){return e.getById(t)},findByIdFn:function(t){return e.getById(t)},addRecordFn:function(t){return e.add(t)[0]},removeRecordFn:function(t){return e.remove(t)}}}},{key:"applyChangesToStore",value:function(e,t){var n=this,r=e.phantomIdField||n.phantomIdField,i=e.store,o=i.modelClass,a=o.getFieldDataSource(o.idField),s=n.getApplyChangesToStoreHelpers(i),u=s.findByPhantomFn,c=s.findByIdFn,l=s.addRecordFn,f=s.removeRecordFn,d=t.rows,h=t.removed;if(d){var v=e.stores;d.forEach((function(e){var t=e[r],o=an.getPath(e,a),s=null;null!=t?s=u(t):null!=o&&(s=c(o)),s?n.applyChangesToRecord(s,e,v,i):(n.suspendChangesTracking(),s=l(e),n.resumeChangesTracking(!0),s.clearChanges())}))}h&&n.applyRemovals(i,h,{findByIdFn:c,removeRecordFn:f})&&i.trigger("dataChanged",{source:i})}},{key:"applySyncResponse",value:function(e){var t=this.orderedCrudStores;this.applyingSyncResponse=!0;var n,r=Py(t);try{for(r.s();!(n=r.n()).done;){var i=n.value,o=e[i.storeId];o&&this.applyChangesToStore(i,o)}}catch(e){r.e(e)}finally{r.f()}this.applyingSyncResponse=!1}},{key:"applyLoadResponse",value:function(e,t){this.applyingLoadResponse=!0,this.loadCrudManagerData(e,t),this.applyingLoadResponse=!1}},{key:"applyResponse",value:(r=Wr()(Vr.a.mark((function e(t,n,r){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.trackResponseType&&(t=n.type||t),e.t0=t,e.next="load"===e.t0?4:"sync"===e.t0?6:8;break;case 4:return this.applyLoadResponse(n,r),e.abrupt("break",8);case 6:return this.applySyncResponse(n),e.abrupt("break",8);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return r.apply(this,arguments)})},{key:"sync",value:function(){var e=this,t=this;return t.activeRequests.sync?(t.trigger("syncDelayed"),t.activeSyncPromise=t.activeSyncPromise.finally((function(){return t.sync()}))):t.activeSyncPromise=new Promise((function(n,r){var i=t.getChangeSetPackage();i?!1!==t.trigger("beforeSync",{pack:i})?(t.trigger("syncStart",{pack:i}),t.activeRequests.sync={pack:i,resolve:n,reject:r,id:i.requestId,desc:t.sendRequest({data:t.encode(i),type:"sync",success:t.onSyncSuccess,failure:t.onSyncFailure,thisObj:t})}):(t.trigger("syncCanceled",{pack:i}),e.processPromise(r,null,{action:"sync",cancelled:!0})):n(null)})).catch((function(e){if(e&&!e.cancelled)throw e;return e}))}},{key:"onSyncSuccess",value:(n=Wr()(Vr.a.mark((function e(t,n){var r,i,o;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isDestroyed){e.next=2;break}return e.abrupt("return");case 2:return r="",e.next=5,t.text().then((function(e){return r=e})).catch(By);case 5:if(!this.isDestroyed){e.next=7;break}return e.abrupt("return");case 7:return i=this.activeRequests.sync,e.next=10,this.internalOnSync(r,n);case 10:if(o=e.sent,!this.isDestroyed){e.next=13;break}return e.abrupt("return");case 13:(null==o?void 0:o.success)?i.resolve({response:o,rawResponse:t,responseText:r,request:i}):this.processPromise(i.reject,i.resolve,{action:"sync",cancelled:!1,response:o,rawResponse:t,responseText:r,request:i});case 14:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"onSyncFailure",value:(t=Wr()(Vr.a.mark((function e(t){var n,r,i,o,a,s,u,c,l=arguments;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=l.length>1&&void 0!==l[1]?l[1]:{},!this.isDestroyed){e.next=3;break}return e.abrupt("return");case 3:if(i=this.activeRequests.sync,o=i.options,a=null===(n=r.abortController)||void 0===n?void 0:n.signal,s=Boolean(null==a?void 0:a.aborted)){e.next=17;break}if(u="",!t){e.next=9;break}return e.next=9,t.text().then((function(e){return u=e})).catch(By);case 9:if(!this.isDestroyed){e.next=11;break}return e.abrupt("return");case 11:return e.next=13,this.internalOnSync(u,r,o);case 13:if(c=e.sent,!this.isDestroyed){e.next=16;break}return e.abrupt("return");case 16:this.processPromise(i.reject,null,{action:"sync",cancelled:s,response:c,rawResponse:t,responseText:u,options:o,request:i});case 17:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"commitCrudStores",value:function(){this.crudStores.forEach((function(e){return e.store.commit()}))}},{key:"rejectCrudStores",value:function(){this.orderedCrudStores.forEach((function(e){return e.store.clearChanges()}))}},{key:"doDestroy",value:function(){var e=this,t=e.activeRequests,n=t.load,r=t.sync;for(n&&e.cancelRequest(n.desc,n.reject),r&&e.cancelRequest(r.desc,r.reject);e.crudStores.length>0;)e.removeCrudStore(e.crudStores[0]);we()(pe()(f.prototype),"doDestroy",this)&&we()(pe()(f.prototype),"doDestroy",this).call(this)}},{key:"isValidResponse",value:function(e,t){return e&&(e.ok&&t||[500,404].includes(e.status))}},{key:"processPromise",value:function(e,t,n){var r=n.cancelled,i=n.action,o=n.rawResponse,a=n.response;if(t&&this.isValidResponse(o,a))t(n);else{var s="".concat(E.capitalize(i)," ").concat(r?"canceled":"failed"),u=new Error(s);Object.assign(u,n),e(u)}}},{key:"isCrudManager",get:function(){return!0}},{key:"crudStores",set:function(e){this._crudStores=[],this.addCrudStore(e);var t,n=Py(this._crudStores);try{for(n.s();!(t=n.n()).done;){var r=t.value;r.loadPriority=r.syncPriority=0}}catch(e){n.e(e)}finally{n.f()}},get:function(){return this._crudStores}},{key:"orderedCrudStores",get:function(){return this._orderedCrudStores},set:function(e){return this._orderedCrudStores=e}},{key:"syncApplySequence",set:function(e){this._syncApplySequence=[],this.addStoreToApplySequence(e)},get:function(){return this._syncApplySequence}},{key:"isBatchingChanges",get:function(){return this.crudIgnoreUpdates>0}},{key:"isCrudManagerLoading",get:function(){return Boolean(this.activeRequests.load||this.applyingLoadResponse)}},{key:"isCrudManagerSyncing",get:function(){return Boolean(this.activeRequests.sync||this.applyingSyncResponse)}},{key:"isLoadingOrSyncing",get:function(){return Boolean(this.activeRequests.load||this.activeRequests.sync)}},{key:"requestId",get:function(){return Number.parseInt("".concat(Date.now()).concat(this._requestId++))}}],[{key:"$name",get:function(){return"AbstractCrudManagerMixin"}},{key:"defaultConfig",get:function(){return{crudRevision:null,crudStores:[],storeIdProperty:"storeId",crudFilterParam:"filter",transport:{},trackResponseType:!1,phantomIdField:"$PhantomId",phantomParentIdField:"$PhantomParentId",autoLoad:!1,autoSyncTimeout:100,autoSync:!1,resetIdsBeforeSync:!0,syncApplySequence:[],orderedCrudStores:[],writeAllFields:!1,crudIgnoreUpdates:0,autoSyncSuspendCounter:0,crudLoaded:!1,createMissingRecords:!1,autoSyncTimerId:null,applyingLoadResponse:!1,applyingSyncResponse:!1,callOnFunctions:!0}}}]),f}((t=e||ue).mixin.apply(t,n))};function $y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var Ny=function(e){fe()(n,e);var t=$y(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.stores&&(e.crudStores=e.stores,delete e.stores),we()(pe()(n.prototype),"construct",this).call(this,e)}},{key:"commit",value:function(){this.commitCrudStores()}},{key:"reject",value:function(){this.rejectCrudStores()}},{key:"addStore",value:function(){return this.addCrudStore.apply(this,arguments)}},{key:"removeStore",value:function(){return this.removeCrudStore.apply(this,arguments)}},{key:"getStore",value:function(){return this.getCrudStore.apply(this,arguments)}},{key:"hasChanges",value:function(){return this.crudStoreHasChanges.apply(this,arguments)}},{key:"loadData",value:function(){return this.loadCrudManagerData.apply(this,arguments)}},{key:"revision",get:function(){return this.crudRevision},set:function(e){this.crudRevision=e}},{key:"stores",set:function(e){e!==this.crudStores&&(this.crudStores=e)},get:function(){return this.crudStores}},{key:"isLoading",get:function(){return this.isCrudManagerLoading}}],[{key:"defaultConfig",get:function(){return{overrideCrudStoreLoad:!0,stores:null}}}]),n}(ue.mixin(Hy));function Vy(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Ny._$name="AbstractCrudManager";var zy=function(e){return function(e){fe()(n,e);var t=Vy(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"cancelRequest",value:function(e,t){t()}},{key:"shouldUseBodyForRequestData",value:function(e,t,n){return!("HEAD"===t||"GET"===t||n)}},{key:"sendRequest",value:function(e){var t=this,r=e.data,i=t.transport[e.type]||{},o=F.assign({},i,i.requestConfig);o.method=o.method||n.defaultMethod[e.type],o.params=F.assign(o.params||{},e.params);var a,s=o.paramName;if(t.shouldUseBodyForRequestData(i,o.method,s)?(o.body=r,o.headers=o.headers||{},o.headers["Content-Type"]=o.headers["Content-Type"]||"application/json"):(s=s||"data",o.params[s]=r),!o.url)throw new Error("Trying to request without URL specified");delete o.requestConfig,delete o.paramName,t.trigger("beforeSend",{params:o.params,type:e.type,requestConfig:o,config:e}),o.queryParams=o.params,delete o.params;var u=F.assign({},o,o.fetchOptions),c=Je.fetch(o.url,u);return c.catch((function(e){var t=u.abortController&&u.abortController.signal;t&&!t.aborted&&console.warn(e)})).then((function(n){var r,i;n&&n.ok?a=null===(r=e.success)||void 0===r?void 0:r.call(e.thisObj||t,n,u):a=null===(i=e.failure)||void 0===i?void 0:i.call(e.thisObj||t,n,u)})),Promise.all([c,a])}}],[{key:"$name",get:function(){return"AjaxTransport"}},{key:"defaultMethod",get:function(){return{load:"GET",sync:"POST"}}}]),n}(e||ue)};function Wy(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var Gy=function(e){return function(e){fe()(n,e);var t=Wy(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"afterConstruct",value:function(){var e=this.crudManager;we()(pe()(n.prototype),"afterConstruct",this).call(this),e&&this.loadMask&&e.isCrudManagerLoading&&this.onCrudManagerLoadStart()}},{key:"bindCrudManager",value:function(e){this.detachListeners("crudManager"),null==e||e.on({name:"crudManager",loadStart:"onCrudManagerLoadStart",load:"onCrudManagerLoad",loadCanceled:"onCrudManagerLoadCanceled",syncStart:"onCrudManagerSyncStart",sync:"onCrudManagerSync",syncCanceled:"onCrudManagerSyncCanceled",requestFail:"onCrudManagerRequestFail",thisObj:this})}},{key:"onCrudManagerLoadStart",value:function(){var e=this.loadMask;e&&(this.masked=Ku.mergeConfigs(this.loadMaskDefaults,e)),this.toggleEmptyText()}},{key:"onCrudManagerSyncStart",value:function(){var e=this.syncMask;e&&(this.masked=Ku.mergeConfigs(this.loadMaskDefaults,e))}},{key:"onCrudManagerRequestFinalize",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0,r=this;if(e)r.masked=null,r.toggleEmptyText();else{var i='<div class="b-grid-load-failure">\n                <div class="b-grid-load-fail">'.concat(r.L("L{GridBase.".concat(t,"FailedMessage}")),"</div>\n                ").concat(n&&n.message?'<div class="b-grid-load-fail">'.concat(r.L("L{CrudManagerView.serverResponseLabel}")," ").concat(n.message,"</div>"):"","\n            </div>");r.masked=Ku.mergeConfigs(r.loadMaskDefaults,r.loadMaskError,i)}}},{key:"onCrudManagerLoadCanceled",value:function(){this.onCrudManagerRequestFinalize()}},{key:"onCrudManagerSyncCanceled",value:function(){this.onCrudManagerRequestFinalize()}},{key:"onCrudManagerLoad",value:function(){this.onCrudManagerRequestFinalize()}},{key:"onCrudManagerSync",value:function(){this.onCrudManagerRequestFinalize()}},{key:"onCrudManagerRequestFail",value:function(e){var t=e.requestType,n=e.response;this.onCrudManagerRequestFinalize(!1,t,n)}},{key:"changeCrudManager",value:function(e){e&&!e.isCrudManager&&(e=new this.crudManagerClass(Object.assign({scheduler:this},e))),this._crudManager=e,this.bindCrudManager(e)}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"CrudManagerView"}},{key:"configurable",get:function(){return{crudManagerClass:null,crudManager:null}}}]),n}(e)};function Yy(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var Uy=function(e){return function(e){fe()(n,e);var t=Yy(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"encode",value:function(e){return E.safeJsonStringify(e)}},{key:"decode",value:function(e){return E.safeJsonParse(e)}}],[{key:"$name",get:function(){return"JsonEncoder"}}]),n}(e||ue)};function qy(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var Ky=function(e){return function(e){fe()(o,e);var t,n,r,i=qy(o);function o(){return v()(this,o),i.apply(this,arguments)}return g()(o,[{key:"startConfigure",value:function(e){this.getConfig("project"),we()(pe()(o.prototype),"startConfigure",this).call(this,e)}},{key:"doAutoLoad",value:(r=Wr()(Vr.a.mark((function e(){var t;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this.project)){e.next=4;break}return e.next=4,t.commitAsync();case 4:return e.abrupt("return",we()(pe()(o.prototype),"doAutoLoad",this).call(this));case 5:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"loadCrudManagerData",value:function(e){var t=this,n=t.project;t.suspendChangesTracking(),we()(pe()(o.prototype),"loadCrudManagerData",this).apply(this,arguments),(null==e?void 0:e.project)&&(t.applyingProjectResponse=!0,Object.assign(n,e.project),t.applyingProjectResponse=!1),t.resumeChangesTracking()}},{key:"sync",value:(n=Wr()(Vr.a.mark((function e(){var t;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.project,this.suspendAutoSync(),!t){e.next=5;break}return e.next=5,t.commitAsync();case 5:return this.resumeAutoSync(!1),e.abrupt("return",we()(pe()(o.prototype),"sync",this).call(this));case 7:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"applyResponse",value:(t=Wr()(Vr.a.mark((function e(t,n,r){var i,a;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i=this).isDestroyed){e.next=3;break}return e.abrupt("return");case 3:return i.trigger("startApplyResponse"),i.clearCrudStoresChanges({clearRemovedCollection:!1}),e.next=7,we()(pe()(o.prototype),"applyResponse",this).call(this,t,n,r);case 7:if(i.clearCrudStoresChanges({removeAddedRecords:!1,clearAddedCollection:!1,clearModifiedCollection:!1,clearRemovedCollection:!0}),i.applyingProjectResponse=!0,n&&n.project&&Object.assign(i,n.project),i.applyingProjectResponse=!1,!i.project){e.next=18;break}return i.trackResponseType&&(t=n.type||t),a="propagating".concat(E.capitalize(t),"Changes"),i[a]=!0,e.next=17,i.project.commitAsync();case 17:i[a]=!1;case 18:case"end":return e.stop()}}),e,this)}))),function(e,n,r){return t.apply(this,arguments)})},{key:"clearCrudStoresChanges",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{removeAddedRecords:!0,clearAddedCollection:!0,clearModifiedCollection:!0,clearRemovedCollection:!0},n=t.removeAddedRecords,r=t.clearAddedCollection,i=t.clearModifiedCollection,o=t.clearRemovedCollection;this.forEachCrudStore((function(t){n&&t.remove(e.added,!0),i&&(t.modified.forEach((function(e){return e.clearChanges(!1)})),t.modified.clear()),r&&t.added.clear(),o&&t.removed.clear()}))}}],[{key:"defaultConfig",get:function(){return{project:null}}}]),o}((e||ue).mixin(Hy,zy,Uy))};function Xy(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Zy(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Xy(Object(n),!0).forEach((function(t){ke()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Xy(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Jy(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var Qy=function(e){fe()(n,e);var t=Jy(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"afterConstruct",value:function(){we()(pe()(n.prototype),"afterConstruct",this).call(this),this.normalize()}},{key:"normalize",value:function(){var e=this,t=e.startDate,n=e.endDate,r=e.duration,i=e.durationUnit,o=null!=r;t&&n&&!o?e.setData("duration",Zt.diff(t,n,i,!0)):t&&!n&&o?e.setData("endDate",Zt.add(t,r,i)):!t&&n&&o&&e.setData("startDate",Zt.add(n,-r,i))}},{key:"setDuration",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.durationUnit,n={duration:e=parseFloat(e),durationUnit:t};this.startDate?n.endDate=Zt.add(this.startDate,e,t):this.endDate&&(n.startDate=Zt.add(this.endDate,-e,t)),this.set(n)}},{key:"setStartDate",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this,r={startDate:e};if(e){var i;if(t)i=null!=n.duration;else if(n.endDate){if(r.duration=Zt.diff(e,n.endDate,n.durationUnit,!0),r.duration<0)throw new Error("Negative duration")}else i=null!=this.duration;i&&(r.endDate=Zt.add(e,n.duration,n.durationUnit))}else r.duration=null;n.set(r)}},{key:"setEndDate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r={endDate:e};if(e){var i;if(!0===t)i=null!=n.duration;else if(n.startDate){if(r.duration=Zt.diff(n.startDate,e,n.durationUnit,!0),r.duration<0)throw new Error("Negative duration")}else i=null!=this.duration;i&&(r.startDate=Zt.add(e,-n.duration,n.durationUnit))}n.set(r)}},{key:"setStartEndDate",value:function(e,t,n){this.set({startDate:e,endDate:t},null,n)}},{key:"inSetNormalize",value:function(e){if("string"!=typeof e){var t=e.startDate,n=e.endDate,r=e.duration,i=e.durationUnit;return"string"==typeof t&&(t=this.getFieldDefinition("startDate").convert(t)),"string"==typeof n&&(n=this.getFieldDefinition("endDate").convert(n)),"duration"in e?(t&&!n&&(n=Zt.add(t,r,i||this.durationUnit,!0,!0)),!t&&n&&(t=Zt.add(n,-r,i||this.durationUnit,!0,!0))):t&&n&&(r=Zt.diff(t,n,i||this.durationUnit,!0)),t&&(e.startDate=t),n&&(e.endDate=n),null!=r&&(e.duration=r),e}}},{key:"inSet",value:function(e,t,r,i,o){return o||(e=this.inSetNormalize(e)||e),we()(pe()(n.prototype),"inSet",this).call(this,e,t,r,i,o)}},{key:"forEachDate",value:function(e,t){return this.dates.forEach(e.bind(t))}},{key:"shift",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.durationUnit;if("string"==typeof e){var n=e;e=t,t=n}return this.setStartDate(Zt.add(this.startDate,e,t,!0),!0)}},{key:"fullCopy",value:function(){return this.copy.apply(this,arguments)}},{key:"intersects",value:function(e){return this.intersectsRange(e.startDate,e.endDate)}},{key:"intersectsRange",value:function(e,t){var n=this.startDate,r=this.endDate;return n&&r&&Zt.intersectSpans(n,r,e,t)}},{key:"split",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:.5,t=this,n=t.copy(),r=t.eventStore,i=t.assignmentStore,o=t.duration*e,a=t.duration-o;if(e<=0||e>=1)throw new Error("Split point must be > 0 and < 1");return n.startDate=Zt.add(t.startDate,o,t.durationUnit),n.duration=a,t.duration=o,r&&(r.add(n),i&&!r.usesSingleAssignment&&i.add(t.assignments.map((function(e){var t=Object.assign({},e.data,{eventId:n.id,event:null,resource:null});return delete t.id,t})))),n}},{key:"toICSString",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!this.isScheduled)return"";var t=Zt.toUTC(new Date),n=Zt.toUTC(this.startDate),r=Zt.toUTC(this.endDate),i="YYYYMMDDTHHmmss",o=e.DTSTAMP||Zt.format(t,i)+"Z";delete e.DTSTAMP;var a={};if(this.allDay){var s="YYYYMMDD";a={"DTSTART;VALUE=DATE":Zt.format(n,s),"DTEND;VALUE=DATE":Zt.format(r,s)}}else a={DTSTART:Zt.format(n,i)+"Z",DTEND:Zt.format(r,i)+"Z"};var u=y.a.scheduler&&y.a.getVersion("scheduler")||y.a.calendar&&y.a.getVersion("calendar")||"",c={BEGIN:"VCALENDAR",VERSION:"2.0",CALSCALE:"GREGORIAN",PRODID:"-//Bryntum AB//Bryntum Scheduler ".concat(u," //EN"),END:"VCALENDAR"},l=Zy(Zy(Zy(Zy({BEGIN:"VEVENT",UID:this.id+"@bryntum.com",CLASS:"PUBLIC",SUMMARY:this.name,DTSTAMP:o},a),this.recurrenceRule?{RRULE:this.recurrenceRule}:{}),e),{},{END:"VEVENT"}),f=Object.keys(c).map((function(e){return"".concat(e,":").concat(c[e])})),h=Object.keys(l).map((function(e){return"".concat(e,":").concat(l[e])}));return f.splice.apply(f,[f.length-1,0].concat(d()(h))),f.join("\n")}},{key:"exportToICS",value:function(e){if(this.isScheduled){var t=new Blob([this.toICSString(e)],{type:"text/calendar"});j.a.downloadBlob(t,(this.name||"Event")+".ics")}}},{key:"eventStore",get:function(){var e,t=this;if(t.isOccurrence)return t.recurringTimeSpan.eventStore;t._eventStore||(t._eventStore=null===(e=t.stores)||void 0===e?void 0:e.find((function(e){return e.isEventStore})));return t._eventStore}},{key:"cls",get:function(){return this._cls||(this._cls=new An(we()(pe()(n.prototype),"get",this).call(this,"cls"))),this._cls},set:function(e){var t=this;t._cls?t._cls.value=e:t._cls=new An(e),t.set("cls",t._cls.value)}},{key:"startDate",get:function(){return this.get("startDate")},set:function(e){this.setStartDate(e)}},{key:"endDate",get:function(){return this.get("endDate")},set:function(e){this.setEndDate(e)}},{key:"duration",get:function(){return this.get("duration")},set:function(e){this.setDuration(e,this.durationUnit)}},{key:"durationUnit",get:function(){return this.get("durationUnit")}},{key:"fullDuration",get:function(){return new Ko({unit:this.durationUnit,magnitude:this.duration})},set:function(e){"string"==typeof e&&(e=Zt.parseDuration(e,!0,this.durationUnit)),this.setDuration(e.magnitude,e.unit)}},{key:"dates",get:function(){for(var e=[],t=Zt.startOf(this.startDate,"day"),n=this.endDate,r=t;r<n;r=Zt.add(r,1,"day"))e.push(r);return e}},{key:"startDateMS",get:function(){var e;return null===(e=this.startDate)||void 0===e?void 0:e.getTime()}},{key:"endDateMS",get:function(){var e;return null===(e=this.endDate)||void 0===e?void 0:e.getTime()}},{key:"durationMS",get:function(){var e=this;return e.endDate&&e.startDate?e.endDateMS-e.startDateMS:Zt.asMilliseconds(e.duration||0,e.durationUnit)}},{key:"isMilestone",get:function(){return 0===this.durationMS}},{key:"isScheduled",get:function(){return Boolean(this.startDate&&this.endDate&&this.hasValidDates)}},{key:"isValid",get:function(){var e=!0;if(e){var t=this.startDate,n=this.endDate;e=!t||!n||n-t>=0}return e}},{key:"hasValidDates",get:function(){var e=this.startDateMS,t=this.endDateMS;return!e||!t||t-e>=0}},{key:"wbsCode",get:function(){return this._wbsCode||this.indexPath.join(".")},set:function(e){this._wbsCode=e}}],[{key:"fields",get:function(){return[{name:"startDate",type:"date"},{name:"endDate",type:"date"},{name:"duration",type:"number",allowNull:!0},{name:"durationUnit",type:"string",defaultValue:"d"},{name:"fullDuration",persist:!1},{name:"cls",defaultValue:""},"iconCls",{name:"style",type:"object"},{name:"name",type:"string",defaultValue:""}]}}]),n}(Bi);function em(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Qy._$name="TimeSpan";var tm=function(e){fe()(n,e);var t=em(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"isResourceTimeRange",get:function(){return!0}},{key:"resources",get:function(){return this.resource?[this.resource]:[]}}],[{key:"fields",get:function(){return["resourceId","timeRangeColor"]}},{key:"relationConfig",get:function(){return[{relationName:"resource",fieldName:"resourceId",store:"resourceStore",collectionName:"timeRanges",nullFieldOnRemove:!0}]}}]),n}(Qy);function nm(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}tm._$name="ResourceTimeRangeModel";var rm=function(e){fe()(n,e);var t=nm(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"getResourcesForEvent",value:function(e){return[e.resource]}},{key:"resourceStore",set:function(e){this._resourceStore=e,this.isConfiguring||this.initRelations(!0)},get:function(){return this._resourceStore}}],[{key:"defaultConfig",get:function(){return{loadPriority:500,syncPriority:500,resourceStore:null,modelClass:tm,storeId:"resourceTimeRanges"}}}]),n}(Uo);function im(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}rm._$name="ResourceTimeRangeStore";var om=function(e){return function(e){fe()(n,e);var t=im(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"$name",get:function(){return"PartOfProject"}}]),n}(e||ue)};function am(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var sm=function(e){return function(e){fe()(n,e);var t=am(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e){var t;null!=(e=e||{}).eventId&&(e.event=e.eventId),null!=e.resourceId&&(e.resource=e.resourceId);for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];(t=we()(pe()(n.prototype),"construct",this)).call.apply(t,[this,e].concat(i))}},{key:"set",value:function(e,t){var r,i,o,a=this.fieldToKeys(e,t);"resource"in a&&(a.resourceId=null===(i=a.resource)||void 0===i?void 0:i.id);"event"in a&&(a.eventId=null===(o=a.event)||void 0===o?void 0:o.id);for(var s=arguments.length,u=new Array(s>2?s-2:0),c=2;c<s;c++)u[c-2]=arguments[c];(r=we()(pe()(n.prototype),"set",this)).call.apply(r,[this,a,null].concat(u))}},{key:"getResource",value:function(){return this.resource}},{key:"toString",value:function(){return this.resourceName?"".concat(this.resourceName," ").concat(this.units,"%"):""}},{key:"eventResourceKey",get:function(){var e=this;return"".concat(e.event?e.eventId:e.getData("eventId")||e.internalId,"-").concat(e.resource?e.resourceId:e.getData("resourceId")||e.internalId)}},{key:"resourceId",set:function(e){var t=this.resource;(null==t?void 0:t.isModel)&&t.id===e?this.set("resourceId",e):this.resource=e},get:function(){var e;return this.get("resourceId")||(null===(e=this.resource)||void 0===e?void 0:e.id)}},{key:"eventId",set:function(e){var t=this.event;(null==t?void 0:t.isModel)&&t.id===e?this.set("eventId",e):this.event=e},get:function(){var e;return this.get("eventId")||(null===(e=this.event)||void 0===e?void 0:e.id)}},{key:"eventName",get:function(){var e;return null===(e=this.event)||void 0===e?void 0:e.name}},{key:"resourceName",get:function(){var e;return null===(e=this.resource)||void 0===e?void 0:e.name}},{key:"isAssignment",get:function(){return!0}},{key:"isPersistable",get:function(){var e=this.event,t=this.resource,n=this.unjoinedStores,r=this.assignmentStore,i=null==r?void 0:r.crudManager;return r?this.isValid&&(i||!e.hasGeneratedId&&!t.hasGeneratedId):Boolean(n[0])}},{key:"isValid",get:function(){return null!=this.resource&&null!=this.event}}],[{key:"$name",get:function(){return"AssignmentModelMixin"}},{key:"fields",get:function(){return["resourceId","eventId",{name:"drawDependencies",type:"boolean"},"event","resource"]}}]),n}(e)};function um(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var cm=Vr.a.mark(wm),lm=Vr.a.mark(Cm),fm=Vr.a.mark(Sm),dm=Vr.a.mark(Dm),hm=Vr.a.mark(Rm),vm=Vr.a.mark(xm),pm=Vr.a.mark(Em),gm=Vr.a.mark(Tm),ym=Vr.a.mark(Mm);function mm(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return km(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return km(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function km(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function bm(e){var t,n=[],r=[],i=Vr.a.mark((function i(){var o,a;return Vr.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:t||(t=e[Symbol.iterator]());case 1:if(!n.length){i.next=5;break}return i.delegateYield(n,"t0",4);case 4:n.length=0;case 5:if(t){i.next=7;break}return i.abrupt("break",17);case 7:if(o=t.next(),a=o.value,!o.done){i.next=12;break}return t=null,e=null,i.abrupt("break",17);case 12:return r.push(a),i.next=15,a;case 15:i.next=1;break;case 17:case"end":return i.stop()}}),i)})),o=Vr.a.mark((function i(){var o,a;return Vr.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:t||(t=e[Symbol.iterator]());case 1:if(!r.length){i.next=5;break}return i.delegateYield(r,"t0",4);case 4:r.length=0;case 5:if(t){i.next=7;break}return i.abrupt("break",17);case 7:if(o=t.next(),a=o.value,!o.done){i.next=12;break}return t=null,e=null,i.abrupt("break",17);case 12:return n.push(a),i.next=15,a;case 15:i.next=1;break;case 17:case"end":return i.stop()}}),i)}));return[i(),o()]}function wm(e,t){var n,r,i,o;return Vr.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(!(t<0)){a.next=2;break}throw new Error("Batch size needs to a natural number");case 2:t|=0,n=[],r=mm(e),a.prev=5,r.s();case 7:if((i=r.n()).done){a.next=16;break}if(o=i.value,n.length!==t){a.next=13;break}return a.next=12,n;case 12:n.length=0;case 13:n.push(o);case 14:a.next=7;break;case 16:a.next=21;break;case 18:a.prev=18,a.t0=a.catch(5),r.e(a.t0);case 21:return a.prev=21,r.f(),a.finish(21);case 24:if(!(n.length>0)){a.next=27;break}return a.next=27,n;case 27:case"end":return a.stop()}}),cm,null,[[5,18,21,24]])}function Cm(e,t){var n,r,i,o;return Vr.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:n=0,r=mm(e),a.prev=2,r.s();case 4:if((i=r.n()).done){a.next=11;break}if(o=i.value,!t(o,n++)){a.next=9;break}return a.next=9,o;case 9:a.next=4;break;case 11:a.next=16;break;case 13:a.prev=13,a.t0=a.catch(2),r.e(a.t0);case 16:return a.prev=16,r.f(),a.finish(16);case 19:case"end":return a.stop()}}),lm,null,[[2,13,16,19]])}function Sm(e,t){var n,r,i,o;return Vr.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:n=0,r=mm(e),a.prev=2,r.s();case 4:if((i=r.n()).done){a.next=11;break}if(o=i.value,!(++n>t)){a.next=9;break}return a.next=9,o;case 9:a.next=4;break;case 11:a.next=16;break;case 13:a.prev=13,a.t0=a.catch(2),r.e(a.t0);case 16:return a.prev=16,r.f(),a.finish(16);case 19:case"end":return a.stop()}}),fm,null,[[2,13,16,19]])}function Dm(e,t){var n,r,i,o;return Vr.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:n=0,r=mm(e),a.prev=2,r.s();case 4:if((i=r.n()).done){a.next=10;break}return o=i.value,a.next=8,t(o,n++);case 8:a.next=4;break;case 10:a.next=15;break;case 12:a.prev=12,a.t0=a.catch(2),r.e(a.t0);case 15:return a.prev=15,r.f(),a.finish(15);case 18:case"end":return a.stop()}}),dm,null,[[2,12,15,18]])}function Rm(e){var t,n,r,i;return Vr.a.wrap((function(o){for(;;)switch(o.prev=o.next){case 0:t=new Set,n=mm(e),o.prev=2,n.s();case 4:if((r=n.n()).done){o.next=12;break}if(i=r.value,t.has(i)){o.next=10;break}return t.add(i),o.next=10,i;case 10:o.next=4;break;case 12:o.next=17;break;case 14:o.prev=14,o.t0=o.catch(2),n.e(o.t0);case 17:return o.prev=17,n.f(),o.finish(17);case 20:case"end":return o.stop()}}),hm,null,[[2,14,17,20]])}function xm(e,t){var n,r,i,o,a;return Vr.a.wrap((function(s){for(;;)switch(s.prev=s.next){case 0:n=new Set,r=mm(e),s.prev=2,r.s();case 4:if((i=r.n()).done){s.next=13;break}if(o=i.value,a=t(o),n.has(a)){s.next=11;break}return n.add(a),s.next=11,o;case 11:s.next=4;break;case 13:s.next=18;break;case 15:s.prev=15,s.t0=s.catch(2),r.e(s.t0);case 18:return s.prev=18,r.f(),s.finish(18);case 21:case"end":return s.stop()}}),vm,null,[[2,15,18,21]])}function Em(e,t){var n,r,i,o;return Vr.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:n=0,r=mm(e),a.prev=2,r.s();case 4:if((i=r.n()).done){a.next=14;break}if(o=i.value,!t(o,n++)){a.next=11;break}return a.next=9,o;case 9:a.next=12;break;case 11:return a.abrupt("return");case 12:a.next=4;break;case 14:a.next=19;break;case 16:a.prev=16,a.t0=a.catch(2),r.e(a.t0);case 19:return a.prev=19,r.f(),a.finish(19);case 22:case"end":return a.stop()}}),pm,null,[[2,16,19,22]])}function Tm(){var e,t=arguments;return Vr.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:e=0;case 1:if(!(e<t.length)){n.next=6;break}return n.delegateYield(e<0||t.length<=e?void 0:t[e],"t0",3);case 3:e++,n.next=1;break;case 6:case"end":return n.stop()}}),gm)}function Mm(e){var t,n,r;return Vr.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:t=mm(e),i.prev=1,t.s();case 3:if((n=t.n()).done){i.next=8;break}return r=n.value,i.delegateYield(r,"t0",6);case 6:i.next=3;break;case 8:i.next=13;break;case 10:i.prev=10,i.t1=i.catch(1),t.e(i.t1);case 13:return i.prev=13,t.f(),i.finish(13);case 16:case"end":return i.stop()}}),ym,null,[[1,10,13,16]])}var Am=function(){function e(t){if(v()(this,e),this.iterable=void 0,!t)throw new Error("Require an iterable instance for chaining");this.iterable=t}return g()(e,[{key:"derive",value:function(t){return this.iterable=void 0,new e(t)}},{key:"copy",value:function(){var t=bm(this.iterable),n=ye()(t,2),r=n[0],i=n[1];return this.iterable=i,new e(r)}},{key:"split",value:function(){var t=bm(this.iterable),n=ye()(t,2),r=n[0],i=n[1];return[new e(r),this.derive(i)]}},{key:"inBatchesBySize",value:function(e){return this.derive(wm(this.iterable,e))}},{key:"filter",value:function(e){return this.derive(Cm(this.iterable,e))}},{key:"drop",value:function(e){return this.derive(Sm(this.iterable,e))}},{key:"map",value:function(e){return this.derive(Dm(this.iterable,e))}},{key:"reduce",value:function(e,t){return function(e,t,n){var r,i=0,o=n,a=mm(e);try{for(a.s();!(r=a.n()).done;){o=t(o,r.value,i++)}}catch(e){a.e(e)}finally{a.f()}return o}(this,e,t)}},{key:"concat",value:function(){return this.derive(Mm(this.iterable))}},{key:"uniqueOnly",value:function(){return this.derive(Rm(this.iterable))}},{key:"uniqueOnlyBy",value:function(e){return this.derive(xm(this.iterable,e))}},{key:"every",value:function(e){return function(e,t){var n,r=0,i=mm(e);try{for(i.s();!(n=i.n()).done;){if(!t(n.value,r++))return!1}}catch(e){i.e(e)}finally{i.f()}return!0}(this,e)}},{key:"some",value:function(e){return function(e,t){var n,r=0,i=mm(e);try{for(i.s();!(n=i.n()).done;){if(t(n.value,r++))return!0}}catch(e){i.e(e)}finally{i.f()}return!1}(this,e)}},{key:"takeWhile",value:function(e){return this.derive(Em(this.iterable,e))}},{key:Symbol.iterator,value:Vr.a.mark((function e(){var t;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.iterable){e.next=3;break}throw new Error("Chained iterator already exhausted or used to derive the new one");case 3:return this.iterable=void 0,e.delegateYield(t,"t0",5);case 5:t=void 0;case 6:case"end":return e.stop()}}),e,this)}))},{key:"toArray",value:function(){return Array.from(this)}},{key:"sort",value:function(e){return Array.from(this).sort(e)}},{key:"toSet",value:function(){return new Set(this)}},{key:"toMap",value:function(){return new Map(this)}},{key:"flush",value:function(){var e,t=mm(this);try{for(t.s();!(e=t.n()).done;)e.value}catch(e){t.e(e)}finally{t.f()}}},{key:"memoize",value:function(){return new Im(this)}}]),e}(),Pm=function(e){return new Am(e)},Im=function(e){fe()(n,e);var t=um(n);function n(){var e;return v()(this,n),(e=t.apply(this,arguments)).elements=[],e.$iterator=void 0,e}return g()(n,[{key:"derive",value:function(e){return new Am(e)}},{key:Symbol.iterator,value:Vr.a.mark((function e(){var t,n,r,i,o,a;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.elements,!this.$iterable){e.next=33;break}if(this.$iterator||(this.$iterator=this.$iterable[Symbol.iterator]()),n=this.$iterator,!((r=t.length)>0)){e.next=7;break}return e.delegateYield(t,"t0",7);case 7:if(!(t.length>r)){e.next=17;break}i=r;case 10:if(!(i<t.length)){e.next=16;break}return e.next=13,t[i];case 13:i++,e.next=10;break;case 16:r=t.length;case 17:if(n){e.next=19;break}return e.abrupt("break",31);case 19:if(o=n.next(),a=o.value,!o.done){e.next=25;break}n=this.$iterator=null,this.$iterable=null,e.next=29;break;case 25:return t.push(a),r++,e.next=29,a;case 29:e.next=7;break;case 31:e.next=34;break;case 33:return e.delegateYield(t,"t1",34);case 34:case"end":return e.stop()}}),e,this)}))},{key:"iterable",set:function(e){this.$iterable=e},get:function(){return this}}]),n}(Am),Om=function(e){return new Im(e)};function Fm(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var Lm=Symbol("MixinIdentity"),jm=Symbol("MixinStateProperty"),_m=function(){function e(){v()(this,e),this.baseEl=void 0,this.sourceEl=void 0,this.$elementsByTopoLevel=void 0,this.$topoLevels=void 0,this.linearizedByTopoLevelsSource=Om(this.linearizedByTopoLevels())}return g()(e,[{key:"buildTopoLevels",value:function(){return Array.from(this.elementsByTopoLevel.keys()).sort((function(e,t){return e-t}))}},{key:"getOrCreateLevel",value:function(e,t){var n=e.get(t);return n||(n=[],e.set(t,n)),n}},{key:"buildElementsByTopoLevel",value:function(){var e=this,t=0,n=this.baseEl?Pm(this.baseEl.walkDepthState.elementsByTopoLevel.values()).concat().toSet():new Set,r=Pm(this.sourceEl.requirements).map((function(e){return e.walkDepthState.elementsByTopoLevel})).concat().reduce((function(n,r){var i=ye()(r,2),o=i[0],a=i[1];return o>t&&(t=o),e.getOrCreateLevel(n,o).push(a),n}),new Map);return this.getOrCreateLevel(r,t+1).push([this.sourceEl]),Pm(r).map((function(e){var t=ye()(e,2),r=t[0],i=t[1];return[r,Pm(i).concat().uniqueOnly().filter((function(e){return!n.has(e)})).sort((function(e,t){return e.id-t.id}))]})).toMap()}},{key:"linearizedByTopoLevels",value:Vr.a.mark((function e(){var t=this;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(Pm(this.topoLevels).map((function(e){return t.elementsByTopoLevel.get(e)})).concat(),"t0",1);case 1:case"end":return e.stop()}}),e,this)}))},{key:"topoLevels",get:function(){return void 0!==this.$topoLevels?this.$topoLevels:this.$topoLevels=this.buildTopoLevels()}},{key:"elementsByTopoLevel",get:function(){return void 0!==this.$elementsByTopoLevel?this.$elementsByTopoLevel:this.$elementsByTopoLevel=this.buildElementsByTopoLevel()}}],[{key:"new",value:function(e){var t=new this;return e&&Object.assign(t,e),t}}]),e}(),Bm=1,Hm=function(e){return function(e){fe()(n,e);var t=Fm(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(e)},$m=function e(){v()(this,e)},Nm=function(){function e(){v()(this,e),this.id=Bm++,this.requirements=[],this.baseClass=$m,this.identitySymbol=void 0,this.mixinLambda=Hm,this.walkDepthState=void 0,this.$minimalClass=void 0,this.name=""}return g()(e,[{key:"getBaseClassMixinId",value:function(e){var t=this.constructor,n=t.baseClassesIds.get(e);if(void 0!==n)return n;var r=Bm++;return t.baseClassesIds.set(e,r),r}},{key:"buildMinimalClass",value:function(){var e,t=this.constructor,n=this.baseClass,r=this.walkDepthState.linearizedByTopoLevelsSource.reduce((function(e,n){var r=e.cls,i=e.hash+String.fromCharCode(n.id),o=t.minimalClassesByLinearHash.get(i);return o||(o=n.mixinLambda(r),n.name=o.name,t.minimalClassesByLinearHash.set(i,o)),e.cls=o,e.hash=i,e}),{cls:n,hash:String.fromCharCode(this.getBaseClassMixinId(n))}).cls,i=Object.assign(r,(e={},ke()(e,Lm,this.identitySymbol),ke()(e,jm,this),ke()(e,"mix",this.mixinLambda),ke()(e,"derive",(function(e){return Ym([i,e],(function(e){return function(e){fe()(n,e);var t=Fm(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(e)}))})),ke()(e,"$",this),ke()(e,"toString",this.toString.bind(this)),e));return Object.defineProperty(i,Symbol.hasInstance,{value:Wm}),i}},{key:"toString",value:function(){return this.walkDepthState.linearizedByTopoLevelsSource.reduce((function(e,t){return"".concat(t.name,"(").concat(e,")")}),this.baseClass.name)}},{key:"minimalClass",get:function(){return void 0!==this.$minimalClass?this.$minimalClass:this.$minimalClass=this.buildMinimalClass()}}],[{key:"new",value:function(e){var t,n=new this;e&&Object.assign(n,e),n.walkDepthState=_m.new({sourceEl:n,baseEl:Vm(n.baseClass)});var r=n.mixinLambda,i=n.identitySymbol=Symbol(r.name),o=Object.assign((function(e){var t=r(e);return t.prototype[i]=!0,t}),(t={},ke()(t,Lm,i),ke()(t,jm,n),t));return Object.defineProperty(o,Symbol.hasInstance,{value:Wm}),n.mixinLambda=o,n}}]),e}();Nm.minimalClassesByLinearHash=new Map,Nm.baseClassesIds=new Map;var Vm=function(e){return Object.getPrototypeOf(e.prototype).constructor[jm]},zm=function(e,t){var n,r;if(e.length>0){var i=e[e.length-1];r=i,Object.getPrototypeOf(r.prototype).constructor.hasOwnProperty(jm)||i===$m||(n=i)}var o=[];return e.forEach((function(t,r){var i=t[jm];if(void 0!==i){var a=i.baseClass;if(a!==$m)if(n){if(n!==a){var s=a.prototype.isPrototypeOf(n.prototype),u=n.prototype.isPrototypeOf(a.prototype);if(!s&&!u)throw new Error("Base class mismatch");n=u?a:n}}else n=a;o.push(i)}else if(r!==e.length-1)throw new Error("Base class should be provided as the last element of the requirements array")})),Nm.new({requirements:o,mixinLambda:t,baseClass:n||$m}).minimalClass},Wm=function(e){return Boolean(e&&e[this[Lm]])},Gm=function(e,t){return Boolean(e&&e[t[Lm]])},Ym=zm,Um=zm,qm=function(){function e(){v()(this,e)}return g()(e,[{key:"initialize",value:function(e){e&&Object.assign(this,e)}}],[{key:"new",value:function(e){var t=new this;return t.initialize(e),t}}]),e}();function Km(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Xm(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Xm(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Xm(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var Zm=-Math.pow(2,30),Jm=Math.pow(2,30)-1,Qm=function(e){return e.slice(0,1).toUpperCase()+e.slice(1)},ek=function(e){return Object(e)!==e},tk=function(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0}),n},nk=function(e){return function(t,n){t[n]=e}},rk=function(e){return new Promise((function(t){return setTimeout(t,e)}))},ik=null,ok=function(e){return null===ik&&(ik=void 0!==Vr.a),!0===ik?Vr.a.isGeneratorFunction(e):"GeneratorFunction"===e.constructor.name};var ak=function(){},sk=function(e){return ak},uk=(sk(),sk());function ck(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var lk=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":l()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},fk=Symbol("BreakCurrentStackExecution"),dk=function(e){fe()(n,e);var t=ck(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(qm);lk([nk(!0)],dk.prototype,"sync",void 0),lk([nk(!0)],dk.prototype,"pure",void 0);var hk=Symbol("ProposedOrPreviousSymbol"),vk=dk.new({handler:hk}),pk=Symbol("RejectSymbol"),gk=function(e){fe()(n,e);var t=ck(n);function n(){var e;return v()(this,n),(e=t.apply(this,arguments)).handler=pk,e}return n}(dk);lk([nk(!1)],gk.prototype,"pure",void 0);var yk=function(e){return gk.new({reason:e})},mk=Symbol("TransactionSymbol"),kk=(dk.new({handler:mk}),Symbol("OwnQuarkSymbol")),bk=(dk.new({handler:kk}),Symbol("OwnIdentifierSymbol")),wk=(dk.new({handler:bk}),Symbol("WriteSymbol")),Ck=function(e){fe()(n,e);var t=ck(n);function n(){var e;return v()(this,n),(e=t.apply(this,arguments)).handler=wk,e}return n}(dk);lk([nk(!1)],Ck.prototype,"pure",void 0);var Sk=function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];return Ck.new({identifier:e,proposedArgs:[t].concat(r)})},Dk=Symbol("WriteSeveralSymbol"),Rk=function(e){fe()(n,e);var t=ck(n);function n(){var e;return v()(this,n),(e=t.apply(this,arguments)).handler=Dk,e}return n}(dk);lk([nk(!1)],Rk.prototype,"pure",void 0);var xk=Symbol("PreviousValueOfSymbol"),Ek=function(e){fe()(n,e);var t=ck(n);function n(){var e;return v()(this,n),(e=t.apply(this,arguments)).handler=xk,e}return n}(dk),Tk=Symbol("ProposedValueOfSymbol"),Mk=Symbol("HasProposedValueSymbol"),Ak=function(e){fe()(n,e);var t=ck(n);function n(){var e;return v()(this,n),(e=t.apply(this,arguments)).handler=Mk,e}return n}(dk),Pk=function(e){return Ak.new({identifier:e})},Ik=Symbol("ProposedOrPreviousValueOfSymbol"),Ok=function(e){fe()(n,e);var t=ck(n);function n(){var e;return v()(this,n),(e=t.apply(this,arguments)).handler=Ik,e}return n}(dk),Fk=function(e){return Ok.new({identifier:e})},Lk=Symbol("ProposedArgumentsOfSymbol"),jk=function(e){fe()(n,e);var t=ck(n);function n(){var e;return v()(this,n),(e=t.apply(this,arguments)).handler=Lk,e}return n}(dk),_k=function(e){return jk.new({identifier:e})},Bk=Symbol("UnsafeProposedOrPreviousValueOfSymbol"),Hk=function(e){fe()(n,e);var t=ck(n);function n(){var e;return v()(this,n),(e=t.apply(this,arguments)).handler=Bk,e}return n}(dk),$k=function(e){return Hk.new({identifier:e})},Nk=Symbol("UnsafePreviousValueOfSymbol");function Vk(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Symbol("ContextSync"),Symbol("ContextGen");var zk=function(e){fe()(n,e);var t=Vk(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([],(function(e){return function(e){fe()(r,e);var t,n=Vk(r);function r(){var e;return v()(this,r),(e=n.apply(this,arguments)).iterator=void 0,e.iterationResult=void 0,e}return g()(r,[{key:"isCalculationStarted",value:function(){return Boolean(this.iterator||this.iterationResult)}},{key:"isCalculationCompleted",value:function(){return Boolean(this.iterationResult&&this.iterationResult.done)}},{key:"startCalculation",value:function(e){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];var o=this.iterator=(t=this.calculation).call.apply(t,[this.context||this,e].concat(r));return this.iterationResult=o.next()}},{key:"continueCalculation",value:function(e){return this.iterationResult=this.iterator.next(e)}},{key:"cleanupCalculation",value:function(){this.iterationResult=void 0,this.iterator=void 0}},{key:"calculation",value:Vr.a.mark((function e(t){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Abstract method `calculation` called");case 1:case"end":return e.stop()}}),e)}))},{key:"runSyncWithEffect",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];for(this.startCalculation.apply(this,[e].concat(n));!this.isCalculationCompleted();)this.continueCalculation(e(this.iterationResult.value));return this.iterator=void 0,this.result}},{key:"runAsyncWithEffect",value:(t=Wr()(Vr.a.mark((function e(t){var n,r,i,o=arguments;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(n=o.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=o[i];this.startCalculation.apply(this,[t].concat(r));case 2:if(this.isCalculationCompleted()){e.next=10;break}return e.t0=this,e.next=6,t(this.iterationResult.value);case 6:e.t1=e.sent,e.t0.continueCalculation.call(e.t0,e.t1),e.next=2;break;case 10:return this.iterator=void 0,e.abrupt("return",this.result);case 12:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"result",get:function(){return this.iterationResult&&this.iterationResult.done?this.iterationResult.value:void 0}}]),r}(e)}))),Wk=Symbol("SynchronousCalculationStarted"),Gk={value:Wk},Yk=function(e){fe()(n,e);var t=Vk(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([],(function(e){return function(e){fe()(r,e);var t,n=Vk(r);function r(){var e;return v()(this,r),(e=n.apply(this,arguments)).iterationResult=void 0,e}return g()(r,[{key:"isCalculationStarted",value:function(){return Boolean(this.iterationResult)}},{key:"isCalculationCompleted",value:function(){return Boolean(this.iterationResult&&this.iterationResult.done)}},{key:"startCalculation",value:function(e){var t;this.iterationResult=Gk;for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return this.iterationResult={done:!0,value:(t=this.calculation).call.apply(t,[this.context||this,e].concat(r))}}},{key:"continueCalculation",value:function(e){throw new Error("Can not continue synchronous calculation")}},{key:"cleanupCalculation",value:function(){this.iterationResult=void 0}},{key:"calculation",value:function(e){throw new Error("Abstract method `calculation` called")}},{key:"runSyncWithEffect",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return this.startCalculation.apply(this,[e].concat(n)),this.result}},{key:"runAsyncWithEffect",value:(t=Wr()(Vr.a.mark((function e(t){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Can not run synchronous calculation asynchronously");case 1:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"result",get:function(){return this.iterationResult&&this.iterationResult.done?this.iterationResult.value:void 0}}]),r}(e)})));function Uk(e,t,n,r){for(var i=t.apply(r||null,n),o=i.next();!o.done;)o=i.next(e(o.value));return o.value}function qk(e,t,n,r){return Kk.apply(this,arguments)}function Kk(){return(Kk=Wr()(Vr.a.mark((function e(t,n,r,i){var o,a,s;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:o=n.apply(i||null,r),a=o.next();case 2:if(a.done){e.next=15;break}if(!((s=t(a.value))instanceof Promise)){e.next=12;break}return e.t0=o,e.next=8,s;case 8:e.t1=e.sent,a=e.t0.next.call(e.t0,e.t1),e.next=13;break;case 12:a=o.next(s);case 13:e.next=2;break;case 15:return e.abrupt("return",a.value);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Xk(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var Zk;!function(e){e.Cancel="Cancel",e.Resume="Resume"}(Zk||(Zk={}));var Jk=Symbol("WalkSource"),Qk=function(e){fe()(n,e);var t=Xk(n);function n(){var e;return v()(this,n),(e=t.apply(this,arguments)).visited=new Map,e.toVisit=[],e.currentEpoch=0,e}return g()(n,[{key:"startFrom",value:function(e){this.continueFrom(e)}},{key:"continueFrom",value:function(e){this.toVisit.push.apply(this.toVisit,e.map((function(e){return{node:e,from:Jk,label:void 0}}))),this.walkDepth()}},{key:"onNode",value:function(e,t){}},{key:"onTopologicalNode",value:function(e){}},{key:"onCycle",value:function(e,t){return Zk.Cancel}},{key:"forEachNext",value:function(e,t){throw new Error("Abstract method called")}},{key:"collectNext",value:function(e,t,n){throw new Error("Abstract method called")}},{key:"getVisitedInfo",value:function(e){return this.visited.get(e)}},{key:"setVisitedInfo",value:function(e,t,n){return n?(n.visitedAt=t,n.visitEpoch=this.currentEpoch):(n={visitedAt:t,visitEpoch:this.currentEpoch},this.visited.set(e,n)),n}},{key:"walkDepth",value:function(){this.visited;for(var e,t=this.toVisit;e=t.length;){var n=t[e-1].node,r=this.getVisitedInfo(n);if(r&&-2===r.visitedAt&&r.visitEpoch===this.currentEpoch)t.pop();else if(r&&r.visitEpoch===this.currentEpoch&&-1!==r.visitedAt){if(r.visitedAt<e){if(this.onCycle(n,t)!==Zk.Resume)break}else r.visitedAt=-2,this.onTopologicalNode(n);t.pop()}else{if(!1===this.onNode(n,t[e-1]))break;var i=this.setVisitedInfo(n,e,r),o=t.length;this.collectNext(n,t,i),t.length===o&&(i.visitedAt=-2,this.onTopologicalNode(n),t.pop())}}}}]),n}(qm);function eb(e){var t=e.length;if(0===t)return[];for(var n=e[t-1].node,r=[n],i=t-1,o=i;i>=0&&e[i].from!==n;){for(;i>=0&&e[i].from===e[o].from;)i--;i>=0&&(r.push(e[i].node),o=i)}return i<0?[]:(r.push(n),r.reverse())}function tb(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return nb(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return nb(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function nb(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function rb(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var ib;!function(e){e[e.Normal=1]="Normal",e[e.Past=2]="Past"}(ib||(ib={}));var ob=0,ab=function(e){fe()(n,e);var t=rb(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Um([Map],(function(e){return function(e){fe()(n,e);var t=rb(n);function n(){var e;return v()(this,n),(e=t.apply(this,arguments)).createdAt=void 0,e.identifier=void 0,e.value=void 0,e.proposedValue=void 0,e.proposedArguments=void 0,e.usedProposedOrPrevious=!1,e.previous=void 0,e.origin=void 0,e.originId=Zm,e.needToBuildProposedValue=!1,e.edgesFlow=0,e.visitedAt=-1,e.visitEpoch=0,e.promise=void 0,e.$outgoingPast=void 0,e}return g()(n,[{key:"forceCalculation",value:function(){this.edgesFlow=Jm}},{key:"cleanup",value:function(){this.cleanupCalculation()}},{key:"isShadow",value:function(){return Boolean(this.origin&&this.origin!==this)}},{key:"resetToEpoch",value:function(e){this.visitEpoch=e,this.visitedAt=-1,this.edgesFlow<0&&(this.edgesFlow=0),this.usedProposedOrPrevious=!1,this.cleanupCalculation(),void 0!==this.value&&this.clearOutgoing(),this.promise=void 0,this.origin&&this.origin===this?(this.proposedArguments=void 0,void 0!==this.value&&(this.proposedValue=this.value),this.value=void 0):(this.origin=void 0,this.value=void 0),this.identifier.proposedValueIsBuilt&&this.proposedValue!==sb&&(this.needToBuildProposedValue=!0,this.proposedValue=void 0)}},{key:"copyFrom",value:function(e){this.value=e.value,this.proposedValue=e.proposedValue,this.proposedArguments=e.proposedArguments,this.usedProposedOrPrevious=e.usedProposedOrPrevious}},{key:"clearProperties",value:function(){this.value=void 0,this.proposedValue=void 0,this.proposedArguments=void 0}},{key:"mergePreviousOrigin",value:function(e){var t=this.origin;if(t!==this.previous)throw new Error("Invalid state");this.copyFrom(t);var n,r=this.getOutgoing(),i=tb(t.getOutgoing());try{for(i.s();!(n=i.n()).done;){var o=ye()(n.value,2),a=o[0],s=o[1];if(!r.get(a)){var u=e.get(a);u&&u.originId!==s.originId||r.set(a,u||s)}}}catch(e){i.e(e)}finally{i.f()}if(void 0!==t.$outgoingPast){var c,l=this.getOutgoingPast(),f=tb(t.getOutgoingPast());try{for(f.s();!(c=f.n()).done;){var d=ye()(c.value,2),h=d[0],v=d[1];if(!l.get(h)){var p=e.get(h);p&&p.originId!==v.originId||l.set(h,p||v)}}}catch(e){f.e(e)}finally{f.f()}}this.origin=this,t.clearProperties(),t.clear()}},{key:"setOrigin",value:function(e){this.origin=e,this.originId=e.originId}},{key:"getOrigin",value:function(){return this.origin?this.origin:this.startOrigin()}},{key:"startOrigin",value:function(){return this.originId=ob++,this.origin=this}},{key:"getOutgoing",value:function(){return this}},{key:"getOutgoingPast",value:function(){return void 0!==this.$outgoingPast?this.$outgoingPast:this.$outgoingPast=new Map}},{key:"addOutgoingTo",value:function(e,t){(t===ib.Normal?this:this.getOutgoingPast()).set(e.identifier,e)}},{key:"clearOutgoing",value:function(){this.clear(),void 0!==this.$outgoingPast&&this.$outgoingPast.clear()}},{key:"getValue",value:function(){return this.origin?this.origin.value:void 0}},{key:"setValue",value:function(e){if(this.origin&&this.origin!==this)throw new Error("Can not set value to the shadow entry");this.getOrigin().value=e}},{key:"hasValue",value:function(){return void 0!==this.getValue()}},{key:"hasProposedValue",value:function(){return!this.isShadow()&&this.hasProposedValueInner()}},{key:"hasProposedValueInner",value:function(){return void 0!==this.proposedValue}},{key:"getProposedValue",value:function(e){return this.needToBuildProposedValue&&(this.needToBuildProposedValue=!1,this.proposedValue=this.identifier.buildProposedValue.call(this.identifier.context||this.identifier,this.identifier,this,e)),this.proposedValue}},{key:"outgoingInTheFutureCb",value:function(e,t){for(var n=this;n;){var r,i=tb(n.getOutgoing().values());try{for(i.s();!(r=i.n()).done;){var o=r.value;o.originId===e.getLatestEntryFor(o.identifier).originId&&t(o)}}catch(e){i.e(e)}finally{i.f()}n=n.isShadow()?n.previous:null}}},{key:"outgoingInTheFutureAndPastCb",value:function(e,t){for(var n=this;n;){var r,i=tb(n.getOutgoing().values());try{for(i.s();!(r=i.n()).done;){var o=r.value,a=e.getLatestEntryFor(o.identifier);a&&o.originId===a.originId&&t(o)}}catch(e){i.e(e)}finally{i.f()}if(void 0!==n.$outgoingPast){var s,u=tb(n.$outgoingPast.values());try{for(u.s();!(s=u.n()).done;){var c=s.value,l=e.getLatestEntryFor(c.identifier);l&&c.originId===l.originId&&t(c)}}catch(e){u.e(e)}finally{u.f()}}n=n.isShadow()?n.previous:null}}},{key:"outgoingInTheFutureAndPastTransactionCb",value:function(e,t){for(var n=this;n;){var r,i=tb(n.getOutgoing().values());try{for(i.s();!(r=i.n()).done;){var o=r.value,a=e.getLatestStableEntryFor(o.identifier);a&&o.originId===a.originId&&t(o)}}catch(e){i.e(e)}finally{i.f()}if(void 0!==n.$outgoingPast){var s,u=tb(n.$outgoingPast.values());try{for(u.s();!(s=u.n()).done;){var c=s.value,l=e.getLatestStableEntryFor(c.identifier);l&&c.originId===l.originId&&t(c)}}catch(e){u.e(e)}finally{u.f()}}n=n.isShadow()?n.previous:null}}},{key:"outgoingInTheFutureTransactionCb",value:function(e,t){for(var n=this;n;){var r,i=tb(n.getOutgoing().values());try{for(i.s();!(r=i.n()).done;){var o=r.value,a=e.getLatestEntryFor(o.identifier);a&&o.originId===a.originId&&t(o)}}catch(e){i.e(e)}finally{i.f()}n=n.isShadow()?n.previous:null}}},{key:"level",get:function(){return this.identifier.level}},{key:"calculation",get:function(){return this.identifier.calculation}},{key:"context",get:function(){return this.identifier.context||this.identifier}}],[{key:"new",value:function(e){var t=new this;return e&&Object.assign(t,e),t}}]),n}(e)}))),sb=Symbol("Tombstone");function ub(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var cb,lb=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":l()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a};!function(e){e[e.UserInput=0]="UserInput",e[e.DependsOnlyOnUserInput=1]="DependsOnlyOnUserInput",e[e.DependsOnlyOnDependsOnlyOnUserInput=2]="DependsOnlyOnDependsOnlyOnUserInput",e[e.DependsOnSelfKind=3]="DependsOnSelfKind"}(cb||(cb={}));var fb=function(e){fe()(n,e);var t=ub(n);function n(){var e;return v()(this,n),(e=t.apply(this,arguments)).name=void 0,e.lazy=!1,e.total=!0,e.pure=!0,e.proposedValueIsBuilt=!1,e}return g()(n,[{key:"calculation",value:function(e){throw new Error("Abstract method `calculation` called")}},{key:"equality",value:function(e,t){return e===t}}]),n}(qm);lb([nk(cb.DependsOnSelfKind)],fb.prototype,"level",void 0),lb([nk(!0)],fb.prototype,"sync",void 0);var db=function(e){fe()(n,e);var t=ub(n);function n(){var e;return v()(this,n),(e=t.apply(this,arguments)).context=void 0,e}return g()(n,[{key:"newQuark",value:function(e){var t=this.quarkClass.new();return t.createdAt=e,t.identifier=this,t.needToBuildProposedValue=this.proposedValueIsBuilt,t}},{key:"write",value:function(e,t,n,r){(n=n||t.getWriteTarget(e)).proposedValue=r;for(var i=arguments.length,o=new Array(i>4?i-4:0),a=4;a<i;a++)o[a-4]=arguments[a];n.proposedArguments=o.length>0?o:void 0}},{key:"writeToTransaction",value:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];e.write.apply(e,[this,t].concat(r))}},{key:"writeToGraph",value:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];e.write.apply(e,[this,t].concat(r))}},{key:"readFromGraphAsync",value:function(e){return e.readAsync(this)}},{key:"readFromGraph",value:function(e){return e.read(this)}},{key:"readFromTransaction",value:function(e){return e.read(this)}},{key:"readFromTransactionAsync",value:function(e){return e.readAsync(this)}},{key:"buildProposedValue",value:function(e,t,n){}},{key:"enterGraph",value:function(e){}},{key:"leaveGraph",value:function(e){}}]),n}(fb),hb=ab.mix(Yk.mix(Map)),vb=ab.mix(zk.mix(Map)),pb=function(e){fe()(n,e);var t=ub(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"calculation",value:function(e){throw new Error("The 'calculation' method of the variables will never be called. Instead the value will be set directly to quark")}},{key:"write",value:function(e,t,n,r){(n=n||t.getWriteTarget(e)).value=r;for(var i=arguments.length,o=new Array(i>4?i-4:0),a=4;a<i;a++)o[a-4]=arguments[a];n.proposedArguments=o.length>0?o:void 0}}]),n}(db);function gb(){return pb.new.apply(pb,arguments)}lb([nk(cb.UserInput)],pb.prototype,"level",void 0),lb([nk(hb)],pb.prototype,"quarkClass",void 0);var yb=function(e){fe()(n,e);var t=ub(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"calculation",value:function(e){return e(vk)}}]),n}(db);function mb(){return yb.new.apply(yb,arguments)}lb([nk(hb)],yb.prototype,"quarkClass",void 0);var kb=function(e){fe()(n,e);var t=ub(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"calculation",value:Vr.a.mark((function e(t){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,vk;case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))}]),n}(db);function bb(){return kb.new.apply(kb,arguments)}lb([nk(vb)],kb.prototype,"quarkClass",void 0);var wb=function(e){throw new Error("Unknown identifier ".concat(e))};function Cb(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var Sb=0,Db=function(e){fe()(n,e);var t=Cb(n);function n(){var e;return v()(this,n),(e=t.apply(this,arguments)).createdAt=Sb++,e.name="revision-"+e.createdAt,e.previous=void 0,e.scope=new Map,e.reachableCount=0,e.referenceCount=0,e.selfDependent=new Set,e}return g()(n,[{key:"getLatestEntryFor",value:function(e){for(var t=this;t;){var n=t.scope.get(e);if(n)return n;t=t.previous}return null}},{key:"hasIdentifier",value:function(e){var t=this.getLatestEntryFor(e);return Boolean(t&&t.getValue()!==sb)}},{key:"previousAxis",value:Vr.a.mark((function e(){var t;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this;case 1:if(!t){e.next=7;break}return e.next=4,t;case 4:t=t.previous,e.next=1;break;case 7:case"end":return e.stop()}}),e,this)}))}]),n}(qm),Rb=function(){function e(){v()(this,e),this.length=0,this.levels=[],this.lowestLevel=Jm}return g()(e,[{key:"getLowestLevel",value:function(){for(var e=this.lowestLevel!==Jm?this.lowestLevel:0;e<this.levels.length;e++)if(this.levels[e])return this.lowestLevel=e;return this.lowestLevel=Jm}},{key:"takeLowestLevel",value:function(){for(var e=this.lowestLevel!==Jm?this.lowestLevel:0;e<this.levels.length;e++){var t=this.levels[e];if(t)return this.length-=t.length,this.levels[e]=null,this.lowestLevel=e+1,t}}},{key:"pop",value:function(){for(var e=this.lowestLevel!==Jm?this.lowestLevel:0;e<this.levels.length;e++){var t=this.levels[e];if(this.lowestLevel=e,t&&t.length>0)return this.length--,t.pop()}this.lowestLevel=Jm}},{key:"push",value:function(e){var t=e.level,n=this.levels[t];if(!n){for(var r=this.levels.length;r<t;r++)this.levels[r]=null;n=this.levels[t]=[]}n.push(e),this.length++,t<this.lowestLevel&&(this.lowestLevel=t)}},{key:Symbol.iterator,value:Vr.a.mark((function e(){var t,n;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=0;case 1:if(!(t<this.levels.length)){e.next=8;break}if(!(n=this.levels[t])){e.next=5;break}return e.delegateYield(n,"t0",5);case 5:t++,e.next=1;break;case 8:case"end":return e.stop()}}),e,this)}))}]),e}();function xb(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var Eb=function(e){fe()(n,e);var t=xb(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"toString",value:function(){var e=[],t=[];return this.cycle.forEach((function(n){var r=n.name,i=n.context;e.push(r),t[t.length-1]!==i&&t.push(i)})),"events: \n"+t.map((function(e){return"#"+e.id})).join(" => ")+"\n\nidentifiers: \n"+e.join("\n")}}]),n}(qm),Tb=function(e){fe()(n,e);var t=xb(n);function n(){var e;return v()(this,n),(e=t.apply(this,arguments)).transaction=void 0,e}return g()(n,[{key:"onCycle",value:function(e,t){return Zk.Cancel}},{key:"doCollectNext",value:function(e,t,n){var r=this.visited.get(t);r||(r={visitedAt:-1,visitEpoch:this.currentEpoch},this.visited.set(t,r)),n.push({node:t,from:e,label:void 0})}},{key:"collectNext",value:function(e,t){var n=this,r=this.transaction.getLatestEntryFor(e);r&&r.outgoingInTheFutureTransactionCb(this.transaction,(function(r){n.doCollectNext(e,r.identifier,t)}))}}]),n}(Qk);function Mb(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Ab(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ab(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Ab(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Pb(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var Ib=function(e){fe()(n,e);var t=Pb(n);function n(){var e;return v()(this,n),(e=t.apply(this,arguments)).visited=new Map,e.transaction=void 0,e.baseRevision=void 0,e.pushTo=void 0,e.toVisit=[],e.currentEpoch=0,e}return g()(n,[{key:"startFrom",value:function(e){this.continueFrom(e)}},{key:"continueFrom",value:function(e){this.toVisit.push.apply(this.toVisit,e),this.walkDepth()}},{key:"startNewEpoch",value:function(){if(this.toVisit.length)throw new Error("Can not start new walk epoch in the middle of the walk");this.currentEpoch++}},{key:"onTopologicalNode",value:function(e,t){e.lazy||e.level===cb.UserInput||this.pushTo.push(t)}},{key:"onCycle",value:function(e,t){return Zk.Resume}},{key:"doCollectNext",value:function(e,t,n){var r=this.visited.get(t);r||((r=t.newQuark(this.baseRevision)).visitEpoch=this.currentEpoch,this.visited.set(t,r)),n.push(t)}},{key:"collectNext",value:function(e,t,n){var r=this,i=this.baseRevision.getLatestEntryFor(e);i&&(n.previous=i,i.outgoingInTheFutureAndPastTransactionCb(this.transaction,(function(n){r.doCollectNext(e,n.identifier,t)})));var o,a=Mb(n.getOutgoing().keys());try{for(a.s();!(o=a.n()).done;){var s=o.value;this.doCollectNext(e,s,t)}}catch(e){a.e(e)}finally{a.f()}if(void 0!==n.$outgoingPast){var u,c=Mb(n.getOutgoingPast().keys());try{for(c.s();!(u=c.n()).done;){var l=u.value;this.doCollectNext(e,l,t)}}catch(e){c.e(e)}finally{c.f()}}}},{key:"walkDepth",value:function(){for(var e,t=this.visited,n=this.toVisit;e=n.length;){var r=n[e-1],i=t.get(r);if(i&&-2===i.visitedAt&&i.visitEpoch===this.currentEpoch)i.edgesFlow++,n.pop();else if(i&&i.visitEpoch===this.currentEpoch&&-1!==i.visitedAt){if(i.visitedAt<e){if(this.onCycle(r,n)!==Zk.Resume)break;i.edgesFlow++}else i.visitedAt=-2,this.onTopologicalNode(r,i);n.pop()}else{var o=n.length;i||((i=r.newQuark(this.baseRevision)).visitEpoch=this.currentEpoch,t.set(r,i)),this.collectNext(r,n,i),i.visitEpoch<this.currentEpoch&&i.resetToEpoch(this.currentEpoch),i.visitedAt=e,i.edgesFlow++,n.length===o&&(i.visitedAt=-2,this.onTopologicalNode(r,i),n.pop())}}}}]),n}(qm);function Ob(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Fb(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Fb(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Fb(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Lb(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var jb=ib.Normal,_b=ib.Past,Bb=function(e){fe()(i,e);var t,n,r=Lb(i);function i(){var e;return v()(this,i),(e=r.apply(this,arguments)).baseRevision=void 0,e.candidateClass=Db,e.candidate=void 0,e.graph=void 0,e.isClosed=!1,e.walkContext=void 0,e.entries=new Map,e.stackGen=new Rb,e.activeStack=[],e.onEffectSync=void 0,e.onEffectAsync=void 0,e.propagationStartDate=0,e.lastProgressNotificationDate=0,e.startProgressNotificationsAfterMs=500,e.emitProgressNotificationsEveryMs=200,e.emitProgressNotificationsEveryCalculations=100,e.plannedTotalIdentifiersToCalculate=0,e.ongoing=Promise.resolve(),e.selfDependedMarked=!1,e.rejectedWith=void 0,e}return g()(i,[{key:"initialize",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];(e=we()(pe()(i.prototype),"initialize",this)).call.apply(e,[this].concat(n)),this.walkContext=Ib.new({visited:this.entries,transaction:this,baseRevision:this.baseRevision,pushTo:this.stackGen}),this.candidate||(this.candidate=this.candidateClass.new({previous:this.baseRevision})),this.onEffectSync=this.read.bind(this),this.onEffectAsync=this.readAsync.bind(this)}},{key:"markSelfDependent",value:function(){if(!this.selfDependedMarked){this.selfDependedMarked=!0;var e,t=Ob(this.baseRevision.selfDependent);try{for(t.s();!(e=t.n()).done;){var n=e.value,r=this.entries.get(n);r&&r.getValue()===sb||this.touch(n)}}catch(e){t.e(e)}finally{t.f()}}}},{key:"getActiveEntry",value:function(){return this.activeStack[this.activeStack.length-1]}},{key:"yieldAsync",value:function(e){return e instanceof Promise?e:this.graph[e.handler](e,this)}},{key:"yieldSync",value:function(e){if(e instanceof Promise)throw new Error("Can not yield a promise in the synchronous context");return this.graph[e.handler](e,this)}},{key:"readAsync",value:(n=Wr()(Vr.a.mark((function e(t){var n,r,i,o=this;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t instanceof db){e.next=2;break}return e.abrupt("return",this.yieldAsync(t));case 2:if((r=this.getActiveEntry())?n=this.addEdge(t,r,jb):(n=this.entries.get(t))||((i=this.baseRevision.getLatestEntryFor(t))||wb(t),n=i.hasValue()?i:this.touch(t)),!n.hasValue()){e.next=6;break}return e.abrupt("return",n.getValue());case 6:if(!n.promise){e.next=8;break}return e.abrupt("return",n.promise);case 8:n.previous&&n.previous.hasValue()||n.forceCalculation();case 9:if(!(this.stackGen.lowestLevel<t.level)){e.next=14;break}return e.next=12,qk(this.onEffectAsync,this.calculateTransitionsStackGen,[this.onEffectAsync,this.stackGen.takeLowestLevel()],this);case 12:e.next=9;break;case 14:return this.markSelfDependent(),e.abrupt("return",this.ongoing=n.promise=this.ongoing.then((function(){if(void 0===n.getValue())return qk(o.onEffectAsync,o.calculateTransitionsStackGen,[o.onEffectAsync,[n]],o)})).then((function(){if(o.rejectedWith)throw new Error("Transaction rejected: ".concat(String(o.rejectedWith.reason)));if(!n.hasValue())throw new Error("Computation cycle. Sync");return n.getValue()})));case 16:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"get",value:function(e){var t,n=this;if(!(e instanceof db))return this.yieldSync(e);var r=this.getActiveEntry();if(r)t=this.addEdge(e,r,jb);else if(!(t=this.entries.get(e))){var i=this.baseRevision.getLatestEntryFor(e);i||wb(e),t=i.hasValue()?i:this.touch(e)}var o=t.getValue();if(o===sb&&wb(e),void 0!==o&&t.hasValue())return o;if(t.promise)return t.promise;for(t.previous&&t.previous.hasValue()||t.forceCalculation();this.stackGen.getLowestLevel()<e.level;)this.calculateTransitionsStackSync(this.onEffectSync,this.stackGen.takeLowestLevel());if(this.markSelfDependent(),e.sync){this.calculateTransitionsStackSync(this.onEffectSync,[t]);var a=t.getValue();if(void 0===a)throw new Error("Cycle during synchronous computation");return a===sb&&wb(e),a}var s=this.ongoing=t.promise=this.ongoing.then((function(){if(void 0===t.getValue())return qk(n.onEffectAsync,n.calculateTransitionsStackGen,[n.onEffectAsync,[t]],n)})).then((function(){if(n.rejectedWith)throw new Error("Transaction rejected: ".concat(String(n.rejectedWith.reason)));var r=t.getValue();if(void 0===r)throw new Error("Computation cycle. Async get");return r===sb&&wb(e),r}));return s}},{key:"read",value:function(e){if(!(e instanceof db))return this.yieldSync(e);var t,n=this.getActiveEntry();if(n)t=this.addEdge(e,n,jb);else if(!(t=this.entries.get(e))){var r=this.baseRevision.getLatestEntryFor(e);r||wb(e),t=r.hasValue()?r:this.touch(e)}var i=t.getValue();if(i===sb&&wb(e),void 0!==i)return i;for(t.previous&&t.previous.hasValue()||t.forceCalculation();this.stackGen.getLowestLevel()<e.level;)this.calculateTransitionsStackSync(this.onEffectSync,this.stackGen.takeLowestLevel());this.markSelfDependent(),this.calculateTransitionsStackSync(this.onEffectSync,[t]);var o=t.getValue();if(void 0===o)throw new Error("Cycle during synchronous computation");return o===sb&&wb(e),o}},{key:"readCurrentOrProposedOrPrevious",value:function(e){var t=this.entries.get(e);if(t){var n=t.getValue();if(void 0!==n)return n;if(void 0!==t.proposedValue)return t.proposedValue}return this.readPrevious(e)}},{key:"readCurrentOrProposedOrPreviousAsync",value:function(e){var t=this.entries.get(e);if(t){var n=t.getValue();if(void 0!==n)return n;if(void 0!==t.proposedValue)return t.proposedValue}return this.readPreviousAsync(e)}},{key:"readPrevious",value:function(e){var t=this.baseRevision.getLatestEntryFor(e);if(t){var n=t.getValue();return n!==sb?void 0!==n?n:this.read(e):void 0}}},{key:"readPreviousAsync",value:function(e){var t=this.baseRevision.getLatestEntryFor(e);if(t){var n=t.getValue();return n!==sb?void 0!==n?n:this.readAsync(e):void 0}}},{key:"readProposedOrPrevious",value:function(e){var t=this.entries.get(e);return t&&void 0!==t.proposedValue?t.proposedValue:this.readPrevious(e)}},{key:"readProposedOrPreviousAsync",value:function(e){var t=this.entries.get(e);return t&&void 0!==t.proposedValue?t.proposedValue:this.readPreviousAsync(e)}},{key:"write",value:function(e,t){var n;void 0===t&&(t=null);for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];(n=e.write).call.apply(n,[e.context||e,e,this,null,t].concat(i))}},{key:"getWriteTarget",value:function(e){return this.touch(e).startOrigin()}},{key:"acquireQuarkIfExists",value:function(e){var t=this.entries.get(e);return t&&t.origin===t?t.origin:void 0}},{key:"touch",value:function(e){var t=this.entries.get(e);(!t||t.visitEpoch<this.walkContext.currentEpoch)&&this.walkContext.continueFrom([e]);var n=t||this.entries.get(e);return n.forceCalculation(),n}},{key:"hasIdentifier",value:function(e){var t=this.entries.get(e);return(!t||t.getValue()!==sb)&&Boolean(t||this.baseRevision.getLatestEntryFor(e))}},{key:"addIdentifier",value:function(e,t){var n=this.entries.get(e),r=e.level===cb.UserInput;if(n||((n=e.newQuark(this.baseRevision)).previous=this.baseRevision.getLatestEntryFor(e),n.forceCalculation(),this.entries.set(e,n),e.lazy||r||this.stackGen.push(n)),void 0!==t||r){var i;n.startOrigin();for(var o=arguments.length,a=new Array(o>2?o-2:0),s=2;s<o;s++)a[s-2]=arguments[s];(i=e.write).call.apply(i,[e.context||e,e,this,n,void 0===t&&r?null:t].concat(a))}return n.getValue()===sb&&(n.value=void 0),e.enterGraph(this.graph),n}},{key:"removeIdentifier",value:function(e){e.leaveGraph(this.graph),this.touch(e).startOrigin().setValue(sb)}},{key:"populateCandidateScopeFromTransitions",value:function(e,t){if(0===e.scope.size)e.scope=t;else{var n,r=Ob(t);try{for(r.s();!(n=r.n()).done;){var i=ye()(n.value,2),o=i[0],a=i[1];a.isShadow()?function(){var t=e.getLatestEntryFor(o);a.getOutgoing().forEach((function(e,n){return t.getOutgoing().set(n,e)}))}():e.scope.set(o,a)}}catch(e){r.e(e)}finally{r.f()}}}},{key:"preCommit",value:function(e){if(this.isClosed)throw new Error("Can not propagate closed revision");this.markSelfDependent(),this.isClosed=!0,this.propagationStartDate=Date.now(),this.plannedTotalIdentifiersToCalculate=this.stackGen.length}},{key:"postCommit",value:function(){this.populateCandidateScopeFromTransitions(this.candidate,this.entries);var e=this.entries;return this.walkContext=void 0,{revision:this.candidate,entries:e,transaction:this}}},{key:"commit",value:function(e){return this.preCommit(e),this.calculateTransitionsSync(this.onEffectSync),this.postCommit()}},{key:"reject",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:gk.new();this.rejectedWith=e;var t,n=Ob(this.entries.values());try{for(n.s();!(t=n.n()).done;){var r=t.value;r.cleanup()}}catch(e){n.e(e)}finally{n.f()}this.entries.clear(),this.walkContext=void 0}},{key:"commitAsync",value:(t=Wr()(Vr.a.mark((function e(t){var n=this;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.preCommit(t),e.abrupt("return",this.ongoing=this.ongoing.then((function(){return qk(n.onEffectAsync,n.calculateTransitions,[n.onEffectAsync],n)})).then((function(){return n.postCommit()})));case 2:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"getLatestEntryFor",value:function(e){var t=this.entries.get(e)||this.baseRevision.getLatestEntryFor(e);if(t.getValue()!==sb)return t}},{key:"getLatestStableEntryFor",value:function(e){var t=this.entries.get(e);if(t){var n=t.getValue();if(n===sb)return;return void 0===n?this.baseRevision.getLatestEntryFor(e):t}return this.baseRevision.getLatestEntryFor(e)}},{key:"addEdge",value:function(e,t,n){if(t.identifier.level<e.level)throw new Error("Identifier can not read from higher level identifier");var r=this.entries.get(e);if(!r){var i=this.baseRevision.getLatestEntryFor(e);i||wb(e),r=e.newQuark(this.baseRevision),i.origin&&r.setOrigin(i.origin),r.previous=i,this.entries.set(e,r)}return r.addOutgoingTo(t,n),r}},{key:"onQuarkCalculationCompleted",value:function(e,t){var n=this;e.cleanup();var r=e.identifier,i=e.previous,o=Boolean(i&&i.hasValue()&&r.equality(t,i.getValue()));o?(i.outgoingInTheFutureAndPastTransactionCb(this,(function(e){var t=n.entries.get(e.identifier);t&&t.edgesFlow--})),e.edgesFlow=Jm,e.setOrigin(i.origin),e.value=t):(e.startOrigin(),e.setValue(t));var a=!1;e.usedProposedOrPrevious&&(void 0!==e.proposedValue?r.equality(t,e.proposedValue)&&(a=!0):(o||!i&&null===t)&&(a=!0),a||this.candidate.selfDependent.add(r))}},{key:"onReadIdentifier",value:function(e,t,n){var r,i=this.addEdge(e,t,jb);if(i.hasValue()||void 0!==i.value){var o=i.getValue();return o===sb&&wb(e),t.continueCalculation(o)}return i.isShadow()?(i.startOrigin(),i.forceCalculation(),void n.push(i)):i.isCalculationStarted()?(Tb.new({transaction:this,onCycle:function(e,t){return r=Eb.new({cycle:eb(t)}),Zk.Cancel}}).startFrom([i.identifier]),void this.graph.onComputationCycleHandler(t,i,r)):(n.push(i),void(i.previous&&i.previous.hasValue()||i.forceCalculation()))}},{key:"calculateTransitions",value:Vr.a.mark((function e(t){var n;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this.stackGen;case 1:if(!n.length){e.next=5;break}return e.delegateYield(this.calculateTransitionsStackGen(t,n.takeLowestLevel()),"t0",3);case 3:e.next=1;break;case 5:case"end":return e.stop()}}),e,this)}))},{key:"calculateTransitionsSync",value:function(e){for(var t=this.stackGen;t.length;)this.calculateTransitionsStackSync(e,t.takeLowestLevel())}},{key:"calculateTransitionsStackGen",value:Vr.a.mark((function e(t,n){var r,i,o,a,s,u,c,l,f,d,h,v,p,g;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.rejectedWith){e.next=2;break}return e.abrupt("return");case 2:this.walkContext.startNewEpoch(),r=this.entries,i=this.propagationStartDate,o=!!this.graph&&this.graph.enableProgressNotifications,a=0,s=this.activeStack,this.activeStack=n;case 9:if(!n.length||this.rejectedWith){e.next=72;break}if(!o||a++%this.emitProgressNotificationsEveryCalculations){e.next=20;break}if(u=Date.now(),!(u-i>this.startProgressNotificationsAfterMs)){e.next=20;break}if((c=this.lastProgressNotificationDate)&&!(u-c>this.emitProgressNotificationsEveryMs)){e.next=20;break}return this.lastProgressNotificationDate=u,this.graph.onPropagationProgressNotification({total:this.plannedTotalIdentifiersToCalculate,remaining:n.length,phase:"propagating"}),e.next=20,rk(0);case 20:if(l=n[n.length-1],f=l.identifier,r.get(f)===l){e.next=27;break}return l.cleanup(),n.pop(),e.abrupt("continue",9);case 27:if(0==l.edgesFlow&&(l.edgesFlow--,(d=l.previous)&&d.outgoingInTheFutureAndPastTransactionCb(this,(function(e){var t=r.get(e.identifier);t&&t.edgesFlow--}))),!(l.edgesFlow<0&&l.previous&&l.previous.origin)){e.next=34;break}return l.setOrigin(l.previous.origin),0===l.size&&r.delete(f),l.cleanup(),n.pop(),e.abrupt("continue",9);case 34:if(!l.hasValue()&&l.proposedValue!==sb){e.next=38;break}return l.cleanup(),n.pop(),e.abrupt("continue",9);case 38:h=l.visitEpoch,v=l.isCalculationStarted()?l.iterationResult:l.startCalculation(this.onEffectSync);case 40:if(!v){e.next=70;break}if(p=void 0===v.value?null:v.value,!l.isCalculationCompleted()){e.next=48;break}return l.visitEpoch==h&&this.onQuarkCalculationCompleted(l,p),n.pop(),e.abrupt("break",70);case 48:if(!(p instanceof db)){e.next=52;break}v=this.onReadIdentifier(p,l,n),e.next=68;break;case 52:if(p!==Wk){e.next=57;break}return n.pop(),e.abrupt("break",70);case 57:return e.next=59,p;case 59:if((g=e.sent)!==fk){e.next=62;break}return e.abrupt("break",70);case 62:if(l.visitEpoch!==h){e.next=66;break}v=l.continueCalculation(g),e.next=68;break;case 66:return n.pop(),e.abrupt("break",70);case 68:e.next=40;break;case 70:e.next=9;break;case 72:this.activeStack=s;case 73:case"end":return e.stop()}}),e,this)}))},{key:"calculateTransitionsStackSync",value:function(e,t){if(!this.rejectedWith){this.walkContext.startNewEpoch();var n=this.entries,r=this.activeStack;for(this.activeStack=t;t.length&&!this.rejectedWith;){var i=t[t.length-1],o=i.identifier;if(n.get(o)===i){if(0==i.edgesFlow){i.edgesFlow--;var a=i.previous;a&&a.outgoingInTheFutureAndPastTransactionCb(this,(function(e){var t=n.get(e.identifier);t&&t.edgesFlow--}))}if(i.edgesFlow<0&&i.previous&&i.previous.origin)i.setOrigin(i.previous.origin),0===i.size&&n.delete(o),i.cleanup(),t.pop();else if(i.hasValue()||i.proposedValue===sb)i.cleanup(),t.pop();else for(var s=i.visitEpoch,u=i.isCalculationStarted()?i.iterationResult:i.startCalculation(this.onEffectSync);u;){var c=void 0===u.value?null:u.value;if(i.isCalculationCompleted()){i.visitEpoch==s&&this.onQuarkCalculationCompleted(i,c),t.pop();break}if(c instanceof db)u=this.onReadIdentifier(c,i,t);else{if(c===Wk){t.pop();break}var l=e(c);if(l instanceof Promise)throw new Error("Effect resolved to promise in the synchronous context, check that you marked the asynchronous calculations accordingly");if(l===fk)break;if(i.visitEpoch!==s){t.pop();break}u=i.continueCalculation(l)}}}else i.cleanup(),t.pop()}this.activeStack=r}}},{key:"dirty",get:function(){return this.entries.size>0}}]),i}(qm);function Hb(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return $b(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return $b(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function $b(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Nb(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var Vb={rejectedWith:null},zb=function(e){fe()(n,e);var t=Nb(n);function n(){var e;return v()(this,n),(e=t.apply(this,arguments)).handlers=[],e}return g()(n,[{key:"trigger",value:function(e){for(var t=0;t<this.handlers.length;t++)this.handlers[t](e)}}]),n}(qm),Wb=function(e){fe()(a,e);var t,n,r,i,o=Nb(a);function a(){var e;return v()(this,a),(e=o.apply(this,arguments)).baseRevisionStable=void 0,e.baseRevisionTentative=void 0,e.baseRevision=Db.new(),e.topRevision=void 0,e.historyLimit=0,e.listeners=new Map,e.$activeTransaction=void 0,e.isCommitting=!1,e.enableProgressNotifications=!1,e.ongoing=Promise.resolve(),e._isInitialCommit=!0,e.autoCommitTimeoutId=null,e.autoCommit=!1,e.autoCommitMode="sync",e.autoCommitHandler=null,e.onWriteDuringCommit="throw",e.onComputationCycle="throw",e.transactionClass=Bb,e.$followingRevision=void 0,e}return g()(a,[{key:"initialize",value:function(){for(var e,t=this,n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];(e=we()(pe()(a.prototype),"initialize",this)).call.apply(e,[this].concat(r)),this.topRevision||(this.topRevision=this.baseRevision),this.autoCommit&&(this.autoCommitHandler="sync"===this.autoCommitMode?function(e){return t.commit(e)}:function(){var e=Wr()(Vr.a.mark((function e(n){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t.commitAsync(n));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()),this.markAndSweep()}},{key:"hasPendingAutoCommit",value:function(){return null!==this.autoCommitTimeoutId}},{key:"clear",value:function(){this.reject(),this.unScheduleAutoCommit(),this.baseRevision.scope&&this.baseRevision.scope.clear(),this.baseRevision.previous=null,this.listeners.clear(),this.topRevision=this.baseRevision,this.$followingRevision=void 0,this.$activeTransaction=void 0,this.markAndSweep()}},{key:"eachReachableRevision",value:Vr.a.mark((function e(){var t,n,r,i,o;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=!0,n=0,r=Hb(this.topRevision.previousAxis()),e.prev=3,r.s();case 5:if((i=r.n()).done){e.next=12;break}return o=i.value,e.next=9,[o,t||n<this.historyLimit];case 9:o===this.baseRevision?t=!1:t||n++;case 10:e.next=5;break;case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(3),r.e(e.t0);case 17:return e.prev=17,r.f(),e.finish(17);case 20:case"end":return e.stop()}}),e,this,[[3,14,17,20]])}))},{key:"markAndSweep",value:function(){var e,t,n=[],r=Hb(this.eachReachableRevision());try{for(r.s();!(t=r.n()).done;){var i=ye()(t.value,2),o=i[0];i[1]?(o.reachableCount++,e=o):n.push(o),o.referenceCount++}}catch(e){r.e(e)}finally{r.f()}n.unshift(e);for(var a=n.length-1;a>=1&&0===n[a].reachableCount;a--)this.compactRevisions(n[a-1],n[a])}},{key:"compactRevisions",value:function(e,t){if(t.reachableCount>0||e.previous!==t)throw new Error("Invalid compact operation");if(t.referenceCount<=1){var n,r=Hb(e.scope);try{for(r.s();!(n=r.n()).done;){var i=ye()(n.value,2),o=i[0],a=i[1];if(a.getValue()===sb)t.scope.delete(o);else{var s=t.scope.get(o);a.origin===a?s&&(s.clear(),s.clearProperties()):s&&a.origin===s?a.mergePreviousOrigin(e.scope):o.lazy&&!a.origin&&s&&s.origin&&(a.startOrigin().proposedValue=void 0!==s.origin.value?s.origin.value:s.origin.proposedValue),a.previous=void 0,t.scope.set(o,a)}}}catch(e){r.e(e)}finally{r.f()}!function(e,t){var n,r=Km(e);try{for(r.s();!(n=r.n()).done;){var i=n.value;t.add(i)}}catch(e){r.e(e)}finally{r.f()}}(e.selfDependent,t.selfDependent),e.scope=t.scope,t.scope=null}else e.scope=new Map(Tm(t.scope,e.scope)),e.selfDependent=new Set(Tm(t.selfDependent,e.selfDependent)),t.referenceCount--;e.previous=null}},{key:"branch",value:function(e){return this.constructor.new(Object.assign({},e,{baseRevision:this.baseRevision}))}},{key:"propagate",value:function(e){return this.commit(e)}},{key:"reject",value:function(e){this.activeTransaction.reject(gk.new({reason:e})),this.ongoing=Promise.resolve(),this.$activeTransaction=void 0,this.baseRevisionTentative=void 0,this.baseRevisionStable&&(this.baseRevision=this.baseRevisionStable,this.baseRevisionStable=void 0)}},{key:"commit",value:function(e){this.unScheduleAutoCommit(),this.baseRevisionStable=this.baseRevision;var t=this.activeTransaction.commit(e);this.$activeTransaction=void 0;var n=this.finalizeCommit(t);return this.baseRevisionStable=void 0,this.isInitialCommit=!1,n}},{key:"propagateAsync",value:(i=Wr()(Vr.a.mark((function e(t){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.commitAsync(t));case 1:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"commitAsync",value:(r=Wr()(Vr.a.mark((function e(t){var n=this;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isCommitting){e.next=2;break}return e.abrupt("return",this.ongoing);case 2:return this.isCommitting=!0,this.baseRevisionStable=this.baseRevision,e.abrupt("return",this.ongoing=this.ongoing.then((function(){return n.doCommitAsync(t)})).then((function(e){return e})).finally((function(){n.baseRevisionStable=void 0,n.baseRevisionTentative=void 0,n.isInitialCommit=!1,n.isCommitting=!1})));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"doCommitAsync",value:(n=Wr()(Vr.a.mark((function e(t){var n,r,i;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.unScheduleAutoCommit(),n=this.activeTransaction,e.next=4,n.commitAsync(t);case 4:return r=e.sent,this.baseRevisionTentative=n.candidate,this.$activeTransaction=void 0,i=this.finalizeCommit(r),e.next=10,this.finalizeCommitAsync(r);case 10:if(!this.activeTransaction.dirty){e.next=16;break}return e.next=13,this.doCommitAsync(t);case 13:return e.abrupt("return",e.sent);case 16:return e.abrupt("return",i);case 17:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"finalizeCommit",value:function(e){var t=e.revision,n=e.entries,r=e.transaction;if(r.rejectedWith)this.baseRevisionStable&&(this.baseRevision=this.baseRevisionStable),this.baseRevisionStable=void 0,this.baseRevisionTentative=void 0;else{if(t.previous!==this.baseRevision)throw new Error("Invalid revisions chain");var i,o=Hb(this.eachReachableRevision());try{for(o.s();!(i=o.n()).done;){var a=ye()(i.value,2),s=a[0];a[1]&&s.reachableCount--,s.referenceCount--}}catch(e){o.e(e)}finally{o.f()}this.baseRevision=this.topRevision=t;var u,c=Hb(n);try{for(c.s();!(u=c.n()).done;){var l=ye()(u.value,2),f=l[0],d=l[1];if(d.cleanup(),!d.isShadow()&&d.hasValue()){var h=this.listeners.get(f);h&&h.trigger(d.getValue())}}}catch(e){c.e(e)}finally{c.f()}this.$followingRevision=void 0,this.markAndSweep()}return{rejectedWith:r.rejectedWith}}},{key:"finalizeCommitAsync",value:(t=Wr()(Vr.a.mark((function e(t){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"onComputationCycleHandler",value:function(e,t,n){var r=new Error("Computation cycle:\n"+n);switch(r.cycle=n,this.onComputationCycle){case"ignore":return console.log(r.message),e.continueCalculation(void 0!==t.proposedValue?t.proposedValue:t.value);case"throw":throw r;case"reject":this.reject(r);break;case"warn":uk(r)}}},{key:"scheduleAutoCommit",value:function(){null===this.autoCommitTimeoutId&&(this.autoCommitTimeoutId=setTimeout(this.autoCommitHandler,10))}},{key:"unScheduleAutoCommit",value:function(){null!==this.autoCommitTimeoutId&&(clearTimeout(this.autoCommitTimeoutId),this.autoCommitTimeoutId=null)}},{key:"variable",value:function(e){var t=gb();return this.addIdentifier(t,void 0===e?null:e)}},{key:"variableNamed",value:function(e,t){var n=gb({name:e});return this.addIdentifier(n,void 0===t?null:t)}},{key:"identifier",value:function(e,t){var n=ok(e)?bb({calculation:e,context:t}):mb({calculation:e,context:t});return this.addIdentifier(n)}},{key:"identifierNamed",value:function(e,t,n){var r="GeneratorFunction"===t.constructor.name?bb({name:e,calculation:t,context:n}):mb({name:e,calculation:t,context:n});return this.addIdentifier(r)}},{key:"addIdentifier",value:function(e,t){var n;if(this.isCommitting){if("throw"===this.onWriteDuringCommit)throw new Error("Adding identifier during commit");"warn"===this.onWriteDuringCommit&&uk(new Error("Adding identifier during commit"))}for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];return(n=this.activeTransaction).addIdentifier.apply(n,[e,t].concat(i)),this.autoCommit&&this.scheduleAutoCommit(),e}},{key:"removeIdentifier",value:function(e){if(this.isCommitting){if("throw"===this.onWriteDuringCommit)throw new Error("Removing identifier during commit");"warn"===this.onWriteDuringCommit&&uk(new Error("Removinfg identifier during commit"))}this.activeTransaction.removeIdentifier(e),this.listeners.delete(e),this.autoCommit&&this.scheduleAutoCommit()}},{key:"hasIdentifier",value:function(e){return this.activeTransaction.hasIdentifier(e)}},{key:"write",value:function(e,t){var n;if(this.isCommitting){if("throw"===this.onWriteDuringCommit)throw new Error("Write during commit");"warn"===this.onWriteDuringCommit&&uk(new Error("Write during commit"))}for(var r=arguments.length,i=new Array(r>2?r-2:0),o=2;o<r;o++)i[o-2]=arguments[o];(n=this.activeTransaction).write.apply(n,[e,t].concat(i)),this.autoCommit&&this.scheduleAutoCommit()}},{key:"readPrevious",value:function(e){return this.activeTransaction.readPrevious(e)}},{key:"readPreviousAsync",value:function(e){return this.activeTransaction.readPreviousAsync(e)}},{key:"read",value:function(e){return this.activeTransaction.read(e)}},{key:"readAsync",value:function(e){return this.activeTransaction.readAsync(e)}},{key:"get",value:function(e){return this.activeTransaction.get(e)}},{key:"observe",value:function(e,t){var n=this.addIdentifier(kb.new({lazy:!1,calculation:e}));return this.addListener(n,t),n}},{key:"observeContext",value:function(e,t,n){var r=this.addIdentifier(kb.new({lazy:!1,calculation:e,context:t}));return this.addListener(r,n),r}},{key:"addListener",value:function(e,t){var n=this.listeners.get(e);n||(n=zb.new(),this.listeners.set(e,n)),n.handlers.push(t)}},{key:"undo",value:function(){var e=this.baseRevision.previous;return!!e&&(this.baseRevision=e,this.$activeTransaction=void 0,!0)}},{key:"redo",value:function(){var e=this.baseRevision;if(e===this.topRevision)return!1;var t=this.followingRevision.get(e);return this.baseRevision=t,this.$activeTransaction=void 0,!0}},{key:"onPropagationProgressNotification",value:function(e){}},{key:hk,value:function(e,t){var n=t.getActiveEntry();n.usedProposedOrPrevious=!0;var r=n.getProposedValue(t);return void 0!==r?r:n.previous?n.identifier.lazy?n.previous.hasValue()?n.previous.getValue():n.previous.hasProposedValue()?n.previous.getProposedValue(t):null:t.readPrevious(n.identifier):void 0}},{key:pk,value:function(e,t){return this.reject(e.reason),fk}},{key:mk,value:function(e,t){return t}},{key:kk,value:function(e,t){return t.getActiveEntry()}},{key:bk,value:function(e,t){return t.getActiveEntry().identifier}},{key:wk,value:function(e,t){var n=t.getActiveEntry();if(n.identifier.lazy)throw new Error("Lazy identifiers can not use `Write` effect");var r=e.identifier.level>n.identifier.level;return r||t.walkContext.startNewEpoch(),t.write.apply(t,[e.identifier].concat(d()(e.proposedArgs))),r?void 0:fk}},{key:Dk,value:function(e,t){var n=t.getActiveEntry();if(n.identifier.lazy)throw new Error("Lazy identifiers can not use `Write` effect");var r=!0;return e.writes.forEach((function(e){e.identifier.level<=n.identifier.level&&r&&(t.walkContext.startNewEpoch(),r=!1),t.write.apply(t,[e.identifier].concat(d()(e.proposedArgs)))})),r?void 0:fk}},{key:xk,value:function(e,t){var n=t.getActiveEntry(),r=e.identifier;return t.addEdge(r,n,_b),t.readPrevious(r)}},{key:Tk,value:function(e,t){var n=t.getActiveEntry(),r=e.identifier;t.addEdge(r,n,_b);var i=t.entries.get(r);return i&&!i.isShadow()?i.getProposedValue(t):void 0}},{key:Mk,value:function(e,t){var n=t.getActiveEntry(),r=e.identifier;t.addEdge(r,n,_b);var i=t.entries.get(r);return!!i&&i.hasProposedValue()}},{key:Ik,value:function(e,t){var n=t.getActiveEntry(),r=e.identifier;return t.addEdge(r,n,_b),t.readProposedOrPrevious(r)}},{key:Bk,value:function(e,t){return t.readProposedOrPrevious(e.identifier)}},{key:Nk,value:function(e,t){return t.readPrevious(e.identifier)}},{key:Lk,value:function(e,t){var n=t.getActiveEntry(),r=e.identifier;t.addEdge(r,n,_b);var i=t.entries.get(r);return i&&!i.isShadow()?i.proposedArguments:void 0}},{key:"dirty",get:function(){return this.activeTransaction.dirty}},{key:"isInitialCommit",get:function(){return this._isInitialCommit},set:function(e){this._isInitialCommit=e}},{key:"followingRevision",get:function(){if(void 0!==this.$followingRevision)return this.$followingRevision;for(var e=Array.from(this.topRevision.previousAxis()),t=[],n=e.length-1;n>0;n--)t.push([e[n],e[n-1]]);return this.$followingRevision=new Map(t)}},{key:"activeTransaction",get:function(){return this.$activeTransaction?this.$activeTransaction:this.$activeTransaction=this.transactionClass.new({baseRevision:this.baseRevisionTentative||this.baseRevision,graph:this})}}]),a}(qm);function Gb(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var Yb=function(e){fe()(n,e);var t=Gb(n);function n(){var e;return v()(this,n),(e=t.apply(this,arguments)).name=void 0,e.ownFields=new Map,e.schema=void 0,e.$skeleton={},e.$allFields=void 0,e}return g()(n,[{key:"hasField",value:function(e){return void 0!==this.getField(e)}},{key:"getField",value:function(e){return this.allFields.get(e)}},{key:"addField",value:function(e){var t=e.name;if(!t)throw new Error("Field must have a name");if(this.ownFields.has(t))throw new Error("Field with name [".concat(t,"] already exists"));return e.entity=this,this.ownFields.set(t,e),e}},{key:"forEachParent",value:function(e){for(var t=this;t;)e(t),t=t.parentEntity}},{key:"forEachField",value:function(e){this.allFields.forEach(e)}},{key:"allFields",get:function(){if(void 0!==this.$allFields)return this.$allFields;var e=new Map,t=new Set;return this.forEachParent((function(n){n.ownFields.forEach((function(n,r){t.has(r)||(t.add(r),e.set(r,n))}))})),this.$allFields=e}}]),n}(qm);function Ub(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var qb;!function(e){e[e.Current=0]="Current",e[e.Previous=1]="Previous",e[e.ProposedOrPrevious=2]="ProposedOrPrevious",e[e.CurrentOrProposedOrPrevious=3]="CurrentOrProposedOrPrevious"}(qb||(qb={}));var Kb=function(e){fe()(n,e);var t=Ub(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([Wb],(function(e){return function(e){fe()(n,e);var t=Ub(n);function n(){var e;return v()(this,n),(e=t.apply(this,arguments)).autoCommit=!0,e.readMode=qb.Current,e}return g()(n,[{key:"addEntity",value:function(e){e.enterGraph(this)}},{key:"addEntities",value:function(e){var t=this;e.forEach((function(e){return t.addEntity(e)}))}},{key:"removeEntity",value:function(e){e.leaveGraph(this)}},{key:"removeEntities",value:function(e){var t=this;e.forEach((function(e){return t.removeEntity(e)}))}}]),n}(e)})));function Xb(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var Zb=function(e){fe()(n,e);var t=Xb(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([db],(function(e){return function(e){fe()(n,e);var t=Xb(n);function n(){var e;return v()(this,n),(e=t.apply(this,arguments)).field=void 0,e.self=void 0,e.DATA=void 0,e}return g()(n,[{key:"getFromGraph",value:function(e){return e?e.readMode===qb.Current?e.get(this):e.readMode===qb.Previous?e.activeTransaction.readPrevious(this):(e.readMode===qb.ProposedOrPrevious&&e.activeTransaction.readProposedOrPrevious(this),e.activeTransaction.readCurrentOrProposedOrPrevious(this)):this.DATA}},{key:"readFromGraph",value:function(e){return e?e.read(this):this.DATA}},{key:"writeToGraph",value:function(e,t){for(var n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];e?e.write.apply(e,[this,t].concat(r)):this.DATA=t}},{key:"leaveGraph",value:function(e){var t=e.activeTransaction.getLatestStableEntryFor(this);t&&(this.DATA=t.getValue()),we()(pe()(n.prototype),"leaveGraph",this).call(this,e)}},{key:"toString",value:function(){return this.name}}]),n}(e)}))),Jb=function(e){fe()(n,e);var t=Xb(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Zb.mix(yb)),Qb=function(e){fe()(n,e);var t=Xb(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Zb.mix(kb)),ew=function(e){fe()(n,e);var t=Xb(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Zb.mix(pb)),tw=function(e){fe()(n,e);var t=Xb(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(function(e){fe()(n,e);var t=Xb(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([db],(function(e){return function(e){fe()(n,e);var t=Xb(n);function n(){var e;return v()(this,n),(e=t.apply(this,arguments)).entity=void 0,e.self=void 0,e}return g()(n,[{key:"equality",value:function(){return!1}},{key:"toString",value:function(){return"Entity identifier [".concat(this.self,"]")}}]),n}(e)}))).mix(kb));function nw(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var rw=function(e){fe()(n,e);var t=nw(n);function n(){var e;return v()(this,n),(e=t.apply(this,arguments)).persistent=!0,e}return g()(n,[{key:"getIdentifierClass",value:function(e){return this.identifierCls?this.identifierCls:e?ok(e)?Qb:Jb:ew}}]),n}(fb);function iw(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var ow=Symbol("isEntity"),aw=function(e){fe()(n,e);var t=iw(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([],(function(e){return function(e){fe()(i,e);var t,n,r=iw(i);function i(){return v()(this,i),r.apply(this,arguments)}return g()(i,[{key:ow,value:function(){}},{key:"calculateSelf",value:Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this);case 1:case"end":return e.stop()}}),e,this)}))},{key:"createFieldIdentifier",value:function(e){var t=e.name,n=this.$entity,r=this.constructor,i=n.$skeleton;i[t]||(i[t]=r.getIdentifierTemplateClass(this,e));var o=new i[t];return o.context=this,o.self=this,o.name="".concat(this.$$.name,".$.").concat(e.name),o}},{key:"forEachFieldIdentifier",value:function(e){var t=this;this.$entity.forEachField((function(n,r){return e(t.$[r],r)}))}},{key:"enterGraph",value:function(e){var t=this;if(this.graph)throw new Error("Already entered replica");this.graph=e,e.addIdentifier(this.$$),this.$entity.forEachField((function(n,r){var i=t.$[r];e.addIdentifier(i,i.DATA),i.DATA=void 0}))}},{key:"leaveGraph",value:function(e){var t=this,n=this.graph,r=e||n;r&&(this.$entity.forEachField((function(e,n){return r.removeIdentifier(t.$[n])})),r.removeIdentifier(this.$$),r===n&&(this.graph=void 0))}},{key:"propagate",value:function(e){return this.commit(e)}},{key:"commit",value:function(e){var t=this.graph;return t?t.commit(e):Vb}},{key:"propagateAsync",value:(n=Wr()(Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.commitAsync());case 1:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"commitAsync",value:(t=Wr()(Vr.a.mark((function e(t){var n;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.graph){e.next=3;break}return e.abrupt("return",Promise.resolve(Vb));case 3:return e.abrupt("return",n.commitAsync(t));case 4:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"run",value:function(e){for(var t=this,n=function(e){if(e instanceof db)return t.graph.read(e);throw new Error("Helper methods can not yield effects during computation")},r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];return Uk(n,this[e],i,this)}},{key:"$entity",get:function(){return sw(this.constructor.prototype)}},{key:"$",get:function(){var e=this,t={};return this.$entity.forEachField((function(n,r){t[r]=e.createFieldIdentifier(n)})),tk(this,"$",t)}},{key:"$$",get:function(){return tk(this,"$$",tw.new({name:this.$entityName,entity:this.$entity,calculation:this.calculateSelf,context:this,self:this}))}},{key:"$entityName",get:function(){return this.constructor.name||this.$entity.name}}],[{key:"getIdentifierTemplateClass",value:function(e,t){var n=t.name,r={name:"".concat(e.$$.name,".$.").concat(n),field:t};t.hasOwnProperty("sync")&&(r.sync=t.sync),t.hasOwnProperty("lazy")&&(r.lazy=t.lazy),t.hasOwnProperty("equality")&&(r.equality=t.equality);var i=e.$calculations&&e[e.$calculations[n]];i&&(r.calculation=i);var o=e.$writes&&e[e.$writes[n]];o&&(r.write=o);var a=e.$buildProposed&&e[e.$buildProposed[n]];a&&(r.buildProposedValue=a,r.proposedValueIsBuilt=!0);var s=t.getIdentifierClass(i).new(r),u=function(){};return u.prototype=s,u}},{key:"createPropertyAccessorsFor",value:function(e){var t=e,n=this.prototype;Object.defineProperty(n,t,{get:function(){return this.$[t].getFromGraph(this.graph)},set:function(e){this.$[t].writeToGraph(this.graph,e)}})}},{key:"createMethodAccessorsFor",value:function(e){var t=e,n=this.prototype,r="get".concat(Qm(t)),i="set".concat(Qm(t)),o="put".concat(Qm(t));r in n||(n[r]=function(){return this.$[t].getFromGraph(this.graph)}),i in n||(n[i]=function(e){for(var n,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];return(n=this.$[t]).writeToGraph.apply(n,[this.graph,e].concat(i)),this.graph?"sync"===this.graph.autoCommitMode?this.graph.commit():this.graph.commitAsync():Promise.resolve(Vb)}),o in n||(n[o]=function(e){for(var n,r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];(n=this.$[t]).writeToGraph.apply(n,[this.graph,e].concat(i))})}},{key:"$entity",get:function(){return uw(this.prototype)}}]),i}(e)}))),sw=function(e){var t=Object.getPrototypeOf(e);return tk(e,"$entity",Yb.new({parentEntity:t.hasOwnProperty(ow)?null:t.$entity,name:e.constructor.name}))},uw=function(e){return e.hasOwnProperty("$entity")||sw(e),e.$entity},cw=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:rw;return function(n,r){uw(n).addField(t.new(Object.assign(e||{},{name:r})));var i=n.constructor;i.createPropertyAccessorsFor(r),i.createMethodAccessorsFor(r)}},lw=cw,fw=function(e){return function(t,n,r){uw(t),(t.$calculations?t.hasOwnProperty("$calculations")?t.$calculations:t.$calculations=Object.create(t.$calculations):t.$calculations={})[e]=n}},dw=function(e){return function(t,n,r){uw(t),(t.$writes?t.hasOwnProperty("$writes")?t.$writes:t.$writes=Object.create(t.$writes):t.$writes={})[e]=n}};function hw(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var vw=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":l()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},pw=function(e){fe()(n,e);var t=hw(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([rw],(function(e){return function(e){fe()(n,e);var t=hw(n);function n(){var e;return v()(this,n),(e=t.apply(this,arguments)).identifierCls=mw,e}return n}(e)}))),gw=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:pw;return cw(e,t)},yw=function(e){fe()(n,e);var t=hw(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([Zb],(function(e){var t=function(e){fe()(n,e);var t=hw(n);function n(){var e;return v()(this,n),(e=t.apply(this,arguments)).field=void 0,e.proposedValueIsBuilt=!0,e}return g()(n,[{key:"hasBucket",value:function(){return Boolean(this.field.bucket)}},{key:"getBucket",value:function(e){return e.$[this.field.bucket]}},{key:"buildProposedValue",value:function(e,t,n){var r=t.proposedValue;if(null===r)return null;var i=Gm(r,aw)?r:e.resolve(r);return i&&e.hasBucket()&&e.getBucket(i).addToBucket(n,e.self),i}},{key:"resolve",value:function(e){var t=this.field.resolver;return t?t.call(this.self,e):null}},{key:"enterGraph",value:function(e){if(this.hasBucket()){var t=e.activeTransaction.readProposedOrPrevious(this);t instanceof aw&&this.getBucket(t).addToBucket(e.activeTransaction,this.self)}we()(pe()(n.prototype),"enterGraph",this).call(this,e)}},{key:"leaveGraph",value:function(e){if(this.hasBucket()){var t=e.activeTransaction.readProposedOrPrevious(this);t instanceof aw&&this.getBucket(t).removeFromBucket(e.activeTransaction,this.self)}we()(pe()(n.prototype),"leaveGraph",this).call(this,e)}},{key:"write",value:function(e,t,r,i){var o=r||t.acquireQuarkIfExists(e);if(e.hasBucket())if(o){var a=o.getValue();a instanceof aw&&e.getBucket(a).removeFromBucket(t,e.self)}else if(t.baseRevision.hasIdentifier(e)){var s=t.readPrevious(e);s instanceof aw&&e.getBucket(s).removeFromBucket(t,e.self)}we()(pe()(n.prototype),"write",this).call(this,e,t,r,i)}}]),n}(e);return vw([nk(cb.DependsOnlyOnUserInput)],t.prototype,"level",void 0),vw([nk(hb)],t.prototype,"quarkClass",void 0),t}))),mw=function(e){fe()(n,e);var t=hw(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(yw.mix(Zb.mix(yb)));function kw(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var bw,ww=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":l()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Cw=function(e){fe()(n,e);var t=kw(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([rw],(function(e){return function(e){fe()(n,e);var t=kw(n);function n(){var e;return v()(this,n),(e=t.apply(this,arguments)).persistent=!1,e.identifierCls=Ew,e}return n}(e)}))),Sw=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Cw;return cw(e,t)};!function(e){e.Add="Add",e.Remove="Remove"}(bw||(bw={}));var Dw=function(e){fe()(n,e);var t=kw(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([ab],(function(e){return function(e){fe()(n,e);var t=kw(n);function n(){var e;return v()(this,n),(e=t.apply(this,arguments)).mutations=[],e.previousValue=void 0,e}return g()(n,[{key:"hasProposedValueInner",value:function(){return this.mutations.length>0}}]),n}(e)}))),Rw=Dw.mix(hb),xw=function(e){fe()(n,e);var t=kw(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([Zb],(function(e){var t=function(e){fe()(n,e);var t=kw(n);function n(){var e;return v()(this,n),(e=t.apply(this,arguments)).proposedValueIsBuilt=!0,e}return g()(n,[{key:"addToBucket",value:function(e,t){var n=e.getWriteTarget(this);n.mutations.push({type:bw.Add,entity:t});var r=e.baseRevision;!n.previousValue&&r.hasIdentifier(this)&&(n.previousValue=e.readPrevious(this))}},{key:"removeFromBucket",value:function(e,t){var n=e.entries.get(this);if(!n||n.getValue()!==sb){var r=e.getWriteTarget(this);r.mutations.push({type:bw.Remove,entity:t});var i=e.baseRevision;!r.previousValue&&i.hasIdentifier(this)&&(r.previousValue=e.readPrevious(this))}}},{key:"buildProposedValue",value:function(e,t,n){for(var r=t,i=new Set(r.previousValue),o=0;o<r.mutations.length;o++){var a=r.mutations[o],s=a.type,u=a.entity;s===bw.Remove?i.delete(u):s===bw.Add&&i.add(u)}return i}},{key:"leaveGraph",value:function(e){we()(pe()(n.prototype),"leaveGraph",this).call(this,e),this.DATA=void 0}}]),n}(e);return ww([nk(cb.DependsOnlyOnDependsOnlyOnUserInput)],t.prototype,"level",void 0),ww([nk(Rw)],t.prototype,"quarkClass",void 0),t}))),Ew=function(e){fe()(n,e);var t=kw(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(xw.mix(Zb.mix(yb)));function Tw(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var Mw=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":l()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Aw=(Symbol("KEEP_TRYING_TO_RESOLVE"),function(e,t){return e===t||((null==t?void 0:t.isBase)?this.serialize(t):t)==((null==e?void 0:e.isBase)?this.serialize(e):e)}),Pw=function(e){fe()(n,e);var t=Tw(n);function n(){var e;return v()(this,n),(e=t.apply(this,arguments)).modelFieldConfig={},e}return g()(n,[{key:"getIdentifierClass",value:function(e){return this.identifierCls?this.identifierCls:e?ok(e)?$w:Hw:Nw}}]),n}(rw),Iw=function(e){fe()(n,e);var t=Tw(n);function n(){var e;return v()(this,n),(e=t.apply(this,arguments)).identifierCls=_w,e}return n}(pw.mix(Pw)),Ow=function(e){fe()(n,e);var t=Tw(n);function n(){var e;return v()(this,n),(e=t.apply(this,arguments)).identifierCls=Bw,e}return n}(Cw.mix(rw)),Fw=Symbol("IsChronoModelSymbol"),Lw=function(e){fe()(n,e);var t=Tw(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([Zb],(function(e){var t=e.prototype,n=function(e){fe()(r,e);var n=Tw(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:Fw,value:function(){}},{key:"getFromGraph",value:function(e){return e?e.readMode===qb.CurrentOrProposedOrPrevious?this.sync?e.get(this):e.activeTransaction.readCurrentOrProposedOrPrevious(this):t.getFromGraph.call(this,e):this.DATA}},{key:"write",value:function(e,n,r,i){var o;i=e.convert(i);for(var a=arguments.length,s=new Array(a>4?a-4:0),u=4;u<a;u++)s[u-4]=arguments[u];(o=t.write).call.apply(o,[this,e,n,r,i].concat(s))}},{key:"convert",value:function(e){var t=this.field,n=this.self.getFieldDefinition(t.name);return(null==n?void 0:n.convert)?e=n.convert(e):t.converter&&(e=t.converter(e,t)),e}},{key:"equality",value:function(e,t){return e instanceof Date&&t instanceof Date?e.getTime()===t.getTime():e===t}}]),r}(e);return Mw([nk(!1)],n.prototype,"sync",void 0),n}))),jw=function(e){fe()(n,e);var t=Tw(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([Dw],(function(e){var t=e.prototype;return function(e){fe()(r,e);var n=Tw(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"setValue",value:function(e){t.setValue.call(this,e),e!==sb&&(this.identifier.DATA=e)}}]),r}(e)}))).mix(Rw),_w=function(e){fe()(n,e);var t=Tw(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"buildProposedValue",value:function(e,t,n){var r=t,i=r.proposedValue;if(null===i)return n.candidate.failedResolutionReferences.delete(r.identifier),null;if(Gm(i,aw))return e.hasBucket()&&e.getBucket(i).addToBucket(n,e.self),n.candidate.failedResolutionReferences.delete(r.identifier),i;var o=e.resolve(i);return Gm(o,aw)?(e.hasBucket()&&e.getBucket(o).addToBucket(n,e.self),n.candidate.failedResolutionReferences.delete(r.identifier),o):(n.candidate.failedResolutionReferences.set(r.identifier,i),null)}}]),n}(yw.mix(Lw.mix(Jb)));Mw([nk(!0)],_w.prototype,"sync",void 0),Mw([nk(jw)],_w.prototype,"quarkClass",void 0);var Bw=function(e){fe()(n,e);var t=Tw(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(xw.mix(Lw.mix(Jb)));Mw([nk(!0)],Bw.prototype,"sync",void 0);var Hw=function(e){fe()(n,e);var t=Tw(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Lw.mix(Jb)),$w=function(e){fe()(n,e);var t=Tw(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Lw.mix(Qb)),Nw=function(e){fe()(n,e);var t=Tw(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Lw.mix(ew)),Vw=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:Pw;return function(r,i){cw(Object.assign({modelFieldConfig:e},t),n)(r,i),zw(r.constructor)}},zw=function(e){e.hasOwnProperty("fields")||Object.defineProperty(e,"fields",{get:function(){return Ww(this)}})},Ww=function(e){var t=e.prototype,n=[];return t.hasOwnProperty("$entity")&&t.$entity.ownFields.forEach((function(e){if(e instanceof Pw){var t=e.modelFieldConfig||{};!t.convert&&e.converter&&e.converter!==Gw&&(t.convert=e.converter),n.push(Object.assign(t,{$chrono:e,name:e.name}))}})),n},Gw=function(e,t){var n,r;return null===e?null:(e instanceof Date||(e=Zt.parse(e,(null===(n=t.modelFieldConfig)||void 0===n?void 0:n.format)||(null===(r=t.modelFieldConfig)||void 0===r?void 0:r.dateFormat)||Zt.defaultParseFormat)),e||void 0)};function Yw(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var Uw=function(e){fe()(n,e);var t=Yw(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([aw,Bi],(function(e){var t=e.prototype;return function(e){fe()(r,e);var n=Yw(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"construct",value:function(e){var n;this.constructor.exposeProperties(),this.originalData=e=e||{};for(var r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];(n=t.construct).call.apply(n,[this,e].concat(i))}},{key:"copy",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=t.copy.call(this,n,r);return(an.isObject(r)&&!r.skipFieldIdentifiers||!an.isObject(r))&&this.forEachFieldIdentifier((function(t,n){i[n]=e[n]})),i}},{key:"applyValue",value:function(e,n,r,i,o){this.$entity.getField(n)&&(e=!0),i&&(e=!1),t.applyValue.call(this,e,n,r,i,o)}},{key:"afterChange",value:function(e,n,r,i,o){var a=this;!o&&Object.keys(n).some((function(e){return a.$entity.getField(e)}))?t.afterChange.call(this,e,n,!0,i,o):t.afterChange.apply(this,arguments)}},{key:"data",get:function(){return this._data},set:function(e){this._data=e;for(var t=this.fields,n=0;n<t.length;n++){var r=t[n];if(this.$entity.getField(r.name)){var i=r.complexMapping?an.getPath(e,r.dataSource):e[r.dataSource];this[r.name]=i}}}},{key:"$entityName",get:function(){var e=this.constructor.name||this.$entity.name,t=this.id;return"".concat(e).concat(null!=t?"-"+String(t):"")}}]),r}(e)})));function qw(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var Kw=function(e){fe()(n,e);var t=qw(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([],(function(e){e.prototype;return function(e){fe()(r,e);var t,n=qw(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"commitAsync",value:(t=Wr()(Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.project.commitAsync());case 1:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"calculateProject",value:function(){throw new Error("Implement me")}},{key:"setProject",value:function(e){return this.project=e}},{key:"getProject",value:function(){return this.project?this.project:this.setProject(this.calculateProject())}},{key:"getAssignmentStore",value:function(){var e=this.getProject();return null==e?void 0:e.assignmentStore}},{key:"getDependencyStore",value:function(){var e=this.getProject();return null==e?void 0:e.dependencyStore}},{key:"getEventStore",value:function(){var e=this.getProject();return null==e?void 0:e.eventStore}},{key:"getResourceStore",value:function(){var e=this.getProject();return null==e?void 0:e.resourceStore}},{key:"getCalendarManagerStore",value:function(){var e=this.getProject();return null==e?void 0:e.calendarManagerStore}},{key:"project",set:function(e){this.$project=e},get:function(){return this.$project}}]),r}(e)})));function Xw(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var Zw=function(e){fe()(n,e);var t=Xw(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([Kw],(function(e){e.prototype;return function(e){fe()(n,e);var t=Xw(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"getGraph",value:function(){var e=this.getProject();return null==e?void 0:e.getGraph()}},{key:"getEventById",value:function(e){var t;return null===(t=this.getEventStore())||void 0===t?void 0:t.getById(e)}},{key:"getDependencyById",value:function(e){var t;return null===(t=this.getDependencyStore())||void 0===t?void 0:t.getById(e)}},{key:"getResourceById",value:function(e){var t;return null===(t=this.getResourceStore())||void 0===t?void 0:t.getById(e)}},{key:"getAssignmentById",value:function(e){var t;return null===(t=this.getAssignmentStore())||void 0===t?void 0:t.getById(e)}},{key:"getCalendarById",value:function(e){var t;return null===(t=this.getCalendarManagerStore())||void 0===t?void 0:t.getById(e)}}]),n}(e)})));function Jw(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var Qw=function(e){fe()(n,e);var t=Jw(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([No],(function(e){return function(e){fe()(n,e);var t=Jw(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(e)})));function eC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var tC=function(e){fe()(n,e);var t=eC(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([Kw,No],(function(e){var t=e.prototype;return function(e){fe()(s,e);var n,r,i,o,a=eC(s);function s(){var e;return v()(this,s),(e=a.apply(this,arguments)).isLoadingData=!1,e}return g()(s,[{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return e.asyncEvents={add:!0,remove:!0,removeAll:!0,change:!0,refresh:!0,replace:!0,move:!0,update:!0},t.construct.call(this,e)}},{key:"trigger",value:function(e,n){var r=this,i=r.asyncEvents,o=r.project,a=null==i?void 0:i[e];return a&&(!0===a||a[n.action])?(t.trigger.call(r,"".concat(e,"PreCommit"),Object.assign({},n)),!o||o.isEngineReady()&&!o.isWritingData?t.trigger.call(r,e,n):null==o||o.on({dataReady:function(){t.trigger.call(r,e,n)},once:!0,thisObj:this}),!0):t.trigger.call(r,e,n)}},{key:"calculateProject",value:function(){return this.project}},{key:"setStoreData",value:function(e){var n;this.project&&(this.project.hasLoadedDataToCommit=!0),this.isLoadingData=!0,t.setStoreData.call(this,e),this.isLoadingData=!1,null===(n=this.project)||void 0===n||n.trigger("storeRefresh",{store:this})}},{key:"doAutoCommit",value:(o=Wr()(Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(this.suspendCount<=0)||this.project.isEngineReady()){e.next=3;break}return e.next=3,this.project.commitAsync();case 3:t.doAutoCommit.call(this);case 4:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"addAsync",value:(i=Wr()(Vr.a.mark((function e(t,n){var r;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this.add(t,n),e.next=3,this.project.commitAsync();case 3:return e.abrupt("return",r);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t){return i.apply(this,arguments)})},{key:"insertAsync",value:(r=Wr()(Vr.a.mark((function e(t,n,r){var i;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i=this.insert(t,n,r),e.next=3,this.project.commitAsync();case 3:return e.abrupt("return",i);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return r.apply(this,arguments)})},{key:"loadDataAsync",value:(n=Wr()(Vr.a.mark((function e(t){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.data=t,e.next=3,this.project.commitAsync();case 3:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})}]),s}(e)})));function nC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var rC=function(e){fe()(n,e);var t=nC(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([tC,Zw,Qw],(function(e){var t=e.prototype;return function(e){fe()(r,e);var n=nC(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"setStoreData",value:function(e){var n;null===(n=this.project)||void 0===n||n.repopulateStore(this),t.setStoreData.call(this,e)}}]),r}(e)})));function iC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var oC=function(e){fe()(n,e);var t=iC(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([Kw,Bi],(function(e){var t=e.prototype;return function(e){fe()(o,e);var n,r,i=iC(o);function o(){return v()(this,o),i.apply(this,arguments)}return g()(o,[{key:"joinStore",value:function(e){var n=!1;if(Gm(e,tC)){var r=e.getProject();!r||r.isRepopulatingStores||this.getProject()||(this.setProject(r),n=!0)}t.joinStore.call(this,e),n&&this.joinProject()}},{key:"unJoinStore",value:function(e){var n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];t.unJoinStore.call(this,e,n);var r=this.getProject();r&&!r.isDestroying&&!r.isRepopulatingStores&&Gm(e,tC)&&r===e.getProject()&&(this.leaveProject(n),this.setProject(null))}},{key:"joinProject",value:function(){}},{key:"leaveProject",value:function(){}},{key:"calculateProject",value:function(){var e=this.stores.find((function(e){return Gm(e,tC)&&!!e.getProject()}));return null==e?void 0:e.getProject()}},{key:"setAsync",value:(r=Wr()(Vr.a.mark((function e(t,n,r){var i,o;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=this.set(t,n,r),e.next=3,null===(i=this.project)||void 0===i?void 0:i.commitAsync();case 3:return e.abrupt("return",o);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return r.apply(this,arguments)})},{key:"getAsync",value:(n=Wr()(Vr.a.mark((function e(t){var n;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,null===(n=this.project)||void 0===n?void 0:n.commitAsync();case 2:return e.abrupt("return",this.get(t));case 3:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})}]),o}(e)})));function aC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var sC=function(e){fe()(n,e);var t=aC(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([oC,Zw,Uw],(function(e){var t=e.prototype;return function(e){fe()(r,e);var n=aC(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"joinProject",value:function(){this.getGraph().addEntity(this)}},{key:"leaveProject",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t.leaveProject.call(this,e);var n=this.getGraph();n.removeEntity(this)}},{key:"getProject",value:function(){return t.getProject.call(this)}},{key:"calculateProject",value:function(){var e=this.stores.find((function(e){return Gm(e,rC)&&!!e.getProject()}));return null==e?void 0:e.getProject()}}]),r}(e)})));function uC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var cC=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":l()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},lC=function(e){fe()(n,e);var t=uC(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([sC],(function(e){e.prototype;var t=function(e){fe()(n,e);var t=uC(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(e);return cC([cw({bucket:"assigned",resolver:function(e){return this.getEventById(e)},modelFieldConfig:{serialize:function(e){return null==e?void 0:e.id},isEqual:Aw,persist:!1}},Iw)],t.prototype,"event",void 0),cC([cw({bucket:"assigned",resolver:function(e){return this.getResourceById(e)},modelFieldConfig:{serialize:function(e){return null==e?void 0:e.id},isEqual:Aw,persist:!1}},Iw)],t.prototype,"resource",void 0),zw(t),t})));function fC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var dC=function(e){fe()(n,e);var t=fC(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([Kw],(function(e){e.prototype;return function(e){fe()(n,e);var t=fC(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"getEventById",value:function(e){var t;return null===(t=this.eventStore)||void 0===t?void 0:t.getById(e)}},{key:"getDependencyById",value:function(e){var t;return null===(t=this.dependencyStore)||void 0===t?void 0:t.getById(e)}},{key:"getResourceById",value:function(e){var t;return null===(t=this.resourceStore)||void 0===t?void 0:t.getById(e)}},{key:"getAssignmentById",value:function(e){var t;return null===(t=this.assignmentStore)||void 0===t?void 0:t.getById(e)}},{key:"getCalendarById",value:function(e){var t;return null===(t=this.calendarManagerStore)||void 0===t?void 0:t.getById(e)}},{key:"eventStore",get:function(){var e;return null===(e=this.project)||void 0===e?void 0:e.eventStore}},{key:"resourceStore",get:function(){var e;return null===(e=this.project)||void 0===e?void 0:e.resourceStore}},{key:"assignmentStore",get:function(){var e;return null===(e=this.project)||void 0===e?void 0:e.assignmentStore}},{key:"dependencyStore",get:function(){var e;return null===(e=this.project)||void 0===e?void 0:e.dependencyStore}},{key:"calendarManagerStore",get:function(){var e;return null===(e=this.project)||void 0===e?void 0:e.calendarManagerStore}}]),n}(e)})));function hC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var vC=function(e){fe()(n,e);var t=hC(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([oC,dC,Bi],(function(e){var t=e.prototype;return function(e){fe()(r,e);var n=hC(r);function r(){var e;return v()(this,r),(e=n.apply(this,arguments)).$isCalculating=!1,e.$changed={},e.$beforeChange={},e}return g()(r,[{key:"joinProject",value:function(){this.invalidate()}},{key:"leaveProject",value:function(){var e,n=arguments.length>0&&void 0!==arguments[0]&&arguments[0];t.leaveProject.call(this,n),null===(e=this.project)||void 0===e||e.bufferedCommitAsync()}},{key:"invalidate",value:function(){var e;null===(e=this.project)||void 0===e||e.invalidate(this)}},{key:"getCurrentOrProposed",value:function(e){var t;return e in this.$changed?this.$changed[e]:null!==(t=this.get(e))&&void 0!==t?t:null}},{key:"hasCurrentOrProposed",value:function(e){return null!=this.$changed[e]||null!=this.get(e)}},{key:"propose",value:function(e){var t=this;Object.keys(e).forEach((function(n){t.$changed[n]=e[n]})),this.invalidate()}},{key:"setChanged",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this;i.$changed[e]=t,r&&(e in i.$beforeChange||(i.$beforeChange[e]=i.get(e)),i.setData(e,t)),n&&i.invalidate()}},{key:"calculateInvalidated",value:function(){}},{key:"finalizeInvalidated",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;t.$isCalculating=!0,t.$changed.__REFADR__&&(t.$changed=Object.assign({},t.$changed)),Object.keys(t.$beforeChange).forEach((function(e){t.setData(e,t.$beforeChange[e])})),t.set(t.$changed,null,e),t.$changed={},t.$beforeChange={},t.$isCalculating=!1}}]),r}(e)})));function pC(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return gC(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return gC(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function gC(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function yC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var mC=function(e){fe()(n,e);var t=yC(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([vC],(function(e){var t=e.prototype;return function(e){fe()(a,e);var n,r,i,o=yC(a);function a(){return v()(this,a),o.apply(this,arguments)}return g()(a,[{key:"getStartDate",value:function(){return this.startDate}},{key:"proposeStartDate",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.propose({startDate:e,keepDuration:t})}},{key:"setStartDate",value:(i=Wr()(Vr.a.mark((function e(t){var n,r,i=arguments;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(i.length>1&&void 0!==i[1])||i[1],this.proposeStartDate(t,n),e.abrupt("return",null===(r=this.project)||void 0===r?void 0:r.commitAsync());case 3:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"getEndDate",value:function(){return this.endDate}},{key:"proposeEndDate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.propose({endDate:e,keepDuration:t})}},{key:"setEndDate",value:(r=Wr()(Vr.a.mark((function e(t){var n,r,i=arguments;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=i.length>1&&void 0!==i[1]&&i[1],this.proposeEndDate(t,n),e.abrupt("return",null===(r=this.project)||void 0===r?void 0:r.commitAsync());case 3:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"getDuration",value:function(){return this.duration}},{key:"proposeDuration",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];this.propose({duration:e,keepStart:n}),t&&this.propose({durationUnit:t})}},{key:"setDuration",value:(n=Wr()(Vr.a.mark((function e(t,n){var r,i,o=arguments;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=!(o.length>2&&void 0!==o[2])||o[2],this.proposeDuration(t,n,r),e.abrupt("return",null===(i=this.project)||void 0===i?void 0:i.commitAsync());case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"getDurationUnit",value:function(){return this.durationUnit}},{key:"joinProject",value:function(){var e,n=this.$changed;if(this.hasCurrentOrProposed("startDate")&&(n.startDate=this.getCurrentOrProposed("startDate")),this.hasCurrentOrProposed("endDate")&&(n.endDate=this.getCurrentOrProposed("endDate")),this.hasCurrentOrProposed("duration")&&(n.duration=this.getCurrentOrProposed("duration")),this.eventStore&&!this.eventStore.isLoadingData){var r=null===(e=this.assignmentStore)||void 0===e?void 0:e.storage.findItem("event",null);if(r){var i,o=pC(r);try{for(o.s();!(i=o.n()).done;){var a=i.value;a.getCurrentOrProposed("event")===this.id&&a.setChanged("event",this)}}catch(e){o.e(e)}finally{o.f()}}}t.joinProject.call(this)}},{key:"applyValue",value:function(e,n,r,i,o){"startDate"!==n&&"duration"!=n&&"endDate"!==n||(e=!0),i&&(e=!1),t.applyValue.call(this,e,n,r,i,o)}},{key:"afterChange",value:function(e,n,r,i,o){this.$isCalculating||o||this.setData(this.$changed),t.afterChange.call(this,e,n,r,i,o)}},{key:"calculateInvalidated",value:function(){var e=this.$changed,t="startDate"in e,n="endDate"in e,r="duration"in e,i=e.startDate,o=e.endDate,a=e.duration,s=e.keepDuration,u=e.keepStart,c=null;switch(!t||n||r?t||!n||r?t||n||!r?t&&n&&!r?null===i&&null===o?e.duration=null:c="duration":t&&!n&&r?c="endDate":!t&&n&&r?c="startDate":t&&n&&r&&(c=null==a?"duration":null==i?"startDate":"endDate"):null===a?e.endDate=null:!this.hasCurrentOrProposed("startDate")||!u&&this.hasCurrentOrProposed("endDate")?this.hasCurrentOrProposed("endDate")&&(c="startDate"):(u&&e.duration<0&&(e.duration=0),c="endDate"):null===o?e.startDate=null:this.hasCurrentOrProposed("startDate")&&o<this.getCurrentOrProposed("startDate")&&!s?(e.startDate=o,e.duration=0):!this.hasCurrentOrProposed("duration")||!s&&this.hasCurrentOrProposed("startDate")?this.hasCurrentOrProposed("startDate")&&(c="duration"):c="startDate":null===i?e.endDate=null:this.hasCurrentOrProposed("endDate")&&i>this.getCurrentOrProposed("endDate")&&!s?(e.endDate=i,e.duration=0):!this.hasCurrentOrProposed("duration")||!s&&this.hasCurrentOrProposed("endDate")?this.hasCurrentOrProposed("endDate")&&(c="duration"):c="endDate",c){case"startDate":e.startDate=Zt.add(this.getCurrentOrProposed("endDate"),-this.getCurrentOrProposed("duration"),this.getCurrentOrProposed("durationUnit"));break;case"endDate":e.endDate=Zt.add(this.getCurrentOrProposed("startDate"),this.getCurrentOrProposed("duration"),this.getCurrentOrProposed("durationUnit"));break;case"duration":e.duration=Zt.diff(this.getCurrentOrProposed("startDate"),this.getCurrentOrProposed("endDate"),this.getCurrentOrProposed("durationUnit"))}delete e.keepDuration,delete e.keepStart}},{key:"startDate",get:function(){return this.getCurrentOrProposed("startDate")},set:function(e){this.proposeStartDate(e)}},{key:"endDate",get:function(){return this.getCurrentOrProposed("endDate")},set:function(e){this.proposeEndDate(e)}},{key:"duration",get:function(){return this.getCurrentOrProposed("duration")},set:function(e){this.proposeDuration(e)}}],[{key:"fields",get:function(){return[{name:"startDate",type:"date"},{name:"endDate",type:"date"},{name:"duration",type:"number"},{name:"durationUnit",type:"string",defaultValue:"day"}]}}]),a}(e)})));function kC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var bC=function(e){fe()(n,e);var t=kC(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([vC],(function(e){var t=e.prototype;return function(e){fe()(r,e);var n=kC(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"joinProject",value:function(){var e,n=this;this.resourceStore&&!this.resourceStore.isLoadingData&&(null===(e=this.assignmentStore)||void 0===e||e.query((function(e){return e.get("resource")===n.id})).forEach((function(e){return e.setChanged("resource",n)}))),t.joinProject.call(this)}},{key:"leaveProject",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.assigned&&!e){var n=this.resourceStore;this.assigned.forEach((function(e){return n.assignmentsForRemoval.add(e)}))}t.leaveProject.call(this)}},{key:"applyValue",value:function(e,n,r,i,o){"id"===o.name&&this.assigned.forEach((function(e){e.set("resourceId",r)})),t.applyValue.call(this,e,n,r,i,o)}},{key:"assigned",get:function(){var e;return null===(e=this.project)||void 0===e?void 0:e.assignmentStore.getResourcesAssignments(this)}}]),r}(e)})));function wC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var CC,SC=function(e){fe()(n,e);var t=wC(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([vC],(function(e){var t=e.prototype;return function(e){fe()(r,e);var n=wC(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"setChanged",value:function(e,n,r){var i=this.assignmentStore,o=this.eventStore,a=this.resourceStore,s=this.project,u=!1;if("event"===e){var c=Gm(n,mC)?n:null==o?void 0:o.getById(n);c&&(u=!0),n=c||n}if("resource"===e){var l=Gm(n,bC)?n:null==a?void 0:a.getById(n);l&&(u=!0),n=l||n}t.setChanged.call(this,e,n,r,!0),!i||!u||s.isPerformingCommit||i.isLoadingData||i.isBatchAssigning||i.updateIndices()}},{key:"joinProject",value:function(){t.joinProject.call(this),this.setChanged("event",this.get("event")),this.setChanged("resource",this.get("resource"))}},{key:"calculateInvalidated",value:function(){var e,t,n=this.$changed,r=n.event,i=void 0===r?this.event:r,o=n.resource,a=void 0===o?this.resource:o;if(null!==i&&!Gm(i,mC)){var s=null===(e=this.eventStore)||void 0===e?void 0:e.getById(i);s&&this.setChanged("event",s,!1)}if(null!==a&&!Gm(a,bC)){var u=null===(t=this.resourceStore)||void 0===t?void 0:t.getById(a);u&&this.setChanged("resource",u,!1)}}},{key:"event",set:function(e){this.setChanged("event",e)},get:function(){var e=this.get("event");return Gm(e,mC)?e:null}},{key:"resource",set:function(e){this.setChanged("resource",e)},get:function(){var e=this.get("resource");return Gm(e,bC)?e:null}}],[{key:"fields",get:function(){return[{name:"resource",isEqual:function(e,t){return e===t},persist:!1},{name:"event",isEqual:function(e,t){return e===t},persist:!1}]}}]),r}(e)})));function DC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var RC=function(e){fe()(n,e);var t=DC(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(sm(om(((null===(CC=window.bryntum)||void 0===CC?void 0:CC.useBasicEngine)?lC:SC).derive(Bi))));function xC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}RC.exposeProperties(),RC._$name="AssignmentModel";var EC=function(e){return function(e){fe()(n,e);var t=xC(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"assignmentStore",get:function(){return this.project.assignmentStore}},{key:"calendarManagerStore",get:function(){return this.project.calendarManagerStore}},{key:"dependencyStore",get:function(){return this.project.dependencyStore}},{key:"eventStore",get:function(){return this.project.eventStore}},{key:"resourceStore",get:function(){return this.project.resourceStore}}],[{key:"$name",get:function(){return"PartOfBaseProject"}}]),n}(e)};function TC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var MC=function(e){return function(e){fe()(n,e);var t=TC(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"add",value:function(e){Array.isArray(e)||(e=[e]);for(var t=0;t<e.length;t++){var r=e[t];if(r instanceof Bi||(e[t]=r=this.createRecord(r)),-1!==this.storage.findIndex("eventResourceKey",r.eventResourceKey,!0))throw new Error("Duplicate assignment Event: ".concat(r.eventId," to resource: ").concat(r.resourceId))}return we()(pe()(n.prototype),"add",this).call(this,e)}},{key:"setStoreData",value:function(e){we()(pe()(n.prototype),"setStoreData",this).call(this,e)}},{key:"getOccurrence",value:function(e,t){if(!e||!(null==t?void 0:t.isOccurrence))return e;var n=this;return{id:"".concat(t.id,":a").concat(e.id),event:t,resource:e.resource,eventId:t.id,resourceId:e.resource.id,isAssignment:!0,isOccurrenceAssignment:!0,instanceMeta:function(e){return n.occurrenceInstanceMeta(this,e)}}}},{key:"occurrenceInstanceMeta",value:function(e,t){var n=t.id||t,r=e.id,i=this.occurrenceMeta;return i||(i=this.occurrenceMeta={}),i[r]||(i[r]={}),i[r][n]||(i[r][n]={})}},{key:"mapAssignmentsForEvent",value:function(e,t,n){e=this.eventStore.getById(e);var r=Boolean(t),i=Boolean(n);return r||i?e.assignments.reduce((function(e,o){var a=r?t(o):o;return i&&!n(a)||e.push(a),e}),[]):e.assignments}},{key:"mapAssignmentsForResource",value:function(e,t,n){e=this.resourceStore.getById(e);var r=Boolean(t),i=Boolean(n);return r||i?e.assignments.reduce((function(e,o){var a=r?t(o):o;return i&&!n(a)||e.push(a),e}),[]):e.assignments}},{key:"getAssignmentsForEvent",value:function(e){return e.assignments}},{key:"removeAssignmentsForEvent",value:function(e){return this.remove(e.assignments)}},{key:"getAssignmentsForResource",value:function(e){return(e=this.resourceStore.getById(e)).assignments}},{key:"removeAssignmentsForResource",value:function(e){this.remove(this.getAssignmentsForResource(e))}},{key:"getResourcesForEvent",value:function(e){return e.resources}},{key:"getEventsForResource",value:function(e){return(e=this.resourceStore.getById(e))&&e.events}},{key:"assignEventToResource",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return e},r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this,o=r?new Set(e.assignments):null;if(t=Array.isArray(t)?t:[t],i.eventStore&&i.eventStore.usesSingleAssignment&&e.assignments.length)return i.isEventAssignedToResource(e,t[0])||(e.resource=t[0]),[];var a=[];return i.suspendAutoCommit(),t.forEach((function(t){var s=i.getAssignmentForEventAndResource(e,t);if(s)r&&o.delete(s);else{var u={eventId:Bi.asId(e),resourceId:Bi.asId(t)};u=n(u),a.push(u)}})),a=i.add(a),r&&i.remove(Array.from(o)),i.resumeAutoCommit(),a}},{key:"unassignEventFromResource",value:function(e,t){var n=[];if(!t)return this.removeAssignmentsForEvent(e);Array.isArray(t)||(t=[t]);for(var r=0;r<t.length;r++)this.isEventAssignedToResource(e,t[r])&&n.push(this.getAssignmentForEventAndResource(e,t[r]));return this.remove(n)}},{key:"isEventAssignedToResource",value:function(e,t){return Boolean(this.getAssignmentForEventAndResource(e,t))}},{key:"getAssignmentForEventAndResource",value:function(e,t){return e=this.eventStore.getById(e),t=this.resourceStore.getById(t),e&&t?this.getOccurrence(e.assignments.find((function(e){return e.resource===t})),e):null}},{key:"storage",set:function(e){sc()(pe()(n.prototype),"storage",e,this,!0),this.storage.addIndex("eventResourceKey")},get:function(){return we()(pe()(n.prototype),"storage",this)}},{key:"isAssignmentStore",get:function(){return!0}}],[{key:"$name",get:function(){return"AssignmentStoreMixin"}},{key:"defaultConfig",get:function(){return{loadPriority:300,syncPriority:300,storeId:"assignments"}}}]),n}(e)},AC=function(e){return e instanceof Set||e instanceof Array?Pm(e):Pm([e])},PC=function(e){return new Promise((function(t){return setTimeout(t,e)}))};function IC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var OC=function(e){fe()(n,e);var t=IC(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([tC],(function(e){var t=e.prototype;return function(e){fe()(r,e);var n=IC(r);function r(){var e;return v()(this,r),(e=n.apply(this,arguments)).assignmentsForRemoval=new Set,e.allAssignmentsForRemoval=!1,e}return g()(r,[{key:"remove",value:function(e,n){this.assignmentsForRemoval=AC(e).toSet();var r=t.remove.call(this,e);return this.assignmentsForRemoval.clear(),r}},{key:"removeAll",value:function(e){this.allAssignmentsForRemoval=!0;var n=t.removeAll.call(this,e);return this.allAssignmentsForRemoval=!1,n}}]),r}(e)})));function FC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var LC=function(e){fe()(n,e);var t=FC(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([OC,rC],(function(e){e.prototype;return function(e){fe()(n,e);var t=FC(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"data",set:function(e){this.allAssignmentsForRemoval=!0,sc()(pe()(n.prototype),"data",e,this,!0),this.allAssignmentsForRemoval=!1}}],[{key:"defaultConfig",get:function(){return{modelClass:lC}}}]),n}(e)})));function jC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var _C=function(e){fe()(n,e);var t=jC(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([tC,dC,No],(function(e){var t=e.prototype;return function(e){fe()(r,e);var n=jC(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"setProject",value:function(e){var n=t.setProject.call(this,e);return e&&this.joinProject(e),n}},{key:"joinProject",value:function(e){}},{key:"onCommitAsync",value:function(){}}]),r}(e)})));function BC(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return HC(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return HC(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function HC(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function $C(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var NC,VC=new Set,zC=function(e){fe()(n,e);var t=$C(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([OC,_C],(function(e){e.prototype;return function(e){fe()(n,e);var t=$C(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"getEventsAssignments",value:function(e){return this.storage.findItem("event",e)||VC}},{key:"getResourcesAssignments",value:function(e){return this.storage.findItem("resource",e)||VC}},{key:"updateIndices",value:function(){this.storage.rebuildIndices()}},{key:"linkAssignments",value:function(e,t){var n=this.storage.findItem(t,null);if(n){this.isBatchAssigning=!0;var r,i=BC(n);try{for(i.s();!(r=i.n()).done;){var o=r.value,a=e.getById(o.getCurrentOrProposed(t));a&&o.setChanged(t,a)}}catch(e){i.e(e)}finally{i.f()}this.isBatchAssigning=!1,this.updateIndices()}}},{key:"onCommitAsync",value:function(){this.updateIndices()}},{key:"data",set:function(e){this.allAssignmentsForRemoval=!0,sc()(pe()(n.prototype),"data",e,this,!0),this.allAssignmentsForRemoval=!1}}],[{key:"defaultConfig",get:function(){return{modelClass:SC,storage:{extraKeys:[{property:"event",unique:!1},{property:"resource",unique:!1}]}}}}]),n}(e)})));function WC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var GC=function(e){fe()(n,e);var t=WC(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"defaultConfig",get:function(){return{modelClass:RC}}}]),n}(MC((null===(NC=window.bryntum)||void 0===NC?void 0:NC.useBasicEngine)?EC(LC.derive(Uo)):om(zC.derive(Uo))));function YC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}GC._$name="AssignmentStore";var UC=function(e){return function(e){fe()(n,e);var t=YC(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e){if(we()(pe()(n.prototype),"construct",this).call(this,e),!this.modelClass.isResourceModel)throw new Error("Model for ResourceStore must subclass ResourceModel")}},{key:"removeAll",value:function(){var e=we()(pe()(n.prototype),"removeAll",this).apply(this,arguments);return e&&this.assignmentStore.removeAll(),e}},{key:"onRecordIdChange",value:function(e){var t=e.record,r=e.oldValue,i=e.value;we()(pe()(n.prototype),"onRecordIdChange",this).call(this,{record:t,oldValue:r,value:i}),t.isFieldModified("id")&&(this.isChangingId=!0,t.updateAssignmentResourceIds(),this.isChangingId=!1)}},{key:"isResourceStore",get:function(){return!0}}],[{key:"$name",get:function(){return"ResourceStoreMixin"}},{key:"defaultConfig",get:function(){return{loadPriority:200,syncPriority:100,storeId:"resources",autoTree:!0}}}]),n}(e||ue)};function qC(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var KC,XC,ZC,JC,QC,eS,tS,nS,rS=function(e){return function(e){fe()(n,e);var t=qC(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"updateAssignmentResourceIds",value:function(){var e=this;this.assigned.forEach((function(t){t.resourceId=e.id}))}},{key:"syncId",value:function(e){we()(pe()(n.prototype),"syncId",this).call(this,e),this.updateAssignmentResourceIds()}},{key:"getEvents",value:function(){return this.events}},{key:"unassignAll",value:function(){this.assignments&&this.assignmentStore.remove(this.assignments)}},{key:"events",get:function(){return this.assignments.reduce((function(e,t){return t.event&&e.push(t.event),e}),[])}},{key:"assignments",get:function(){return this.assigned?d()(this.assigned):[]},set:function(e){var t=this;e.forEach((function(e){e.resource=t}))}},{key:"isPersistable",get:function(){return!this.parent||this.parent.isPersistable}}],[{key:"$name",get:function(){return"ResourceModelMixin"}},{key:"isResourceModel",get:function(){return!0}},{key:"fields",get:function(){return[{name:"name",type:"string",persist:!0},"eventColor","eventStyle","imageUrl","image"]}}]),n}(e)},iS=function(e){return Array.from(new Set(e))};!function(e){e.Millisecond="millisecond",e.Second="second",e.Minute="minute",e.Hour="hour",e.Day="day",e.Week="week",e.Month="month",e.Quarter="quarter",e.Year="year"}(KC||(KC={})),function(e){e.MustStartOn="muststarton",e.MustFinishOn="mustfinishon",e.StartNoEarlierThan="startnoearlierthan",e.StartNoLaterThan="startnolaterthan",e.FinishNoEarlierThan="finishnoearlierthan",e.FinishNoLaterThan="finishnolaterthan"}(XC||(XC={})),function(e){e.Normal="Normal",e.FixedDuration="FixedDuration",e.FixedEffort="FixedEffort",e.FixedUnits="FixedUnits"}(ZC||(ZC={})),function(e){e[e.NoError=0]="NoError",e[e.CyclicDependency=1]="CyclicDependency",e[e.DuplicatingDependency=2]="DuplicatingDependency"}(JC||(JC={})),function(e){e[e.StartToStart=0]="StartToStart",e[e.StartToEnd=1]="StartToEnd",e[e.EndToStart=2]="EndToStart",e[e.EndToEnd=3]="EndToEnd"}(QC||(QC={})),function(e){e.Project="Project",e.FromEvent="FromEvent",e.ToEvent="ToEvent"}(eS||(eS={})),function(e){e[e.SchedulerBasic=1]="SchedulerBasic",e[e.SchedulerPro=2]="SchedulerPro",e[e.Gantt=3]="Gantt"}(tS||(tS={})),function(e){e.Forward="Forward",e.Backward="Backward",e.None="None"}(nS||(nS={}));var oS,aS=new Date(-864e13),sS=new Date(864e13),uS=function(e){if(!e)return!1;var t=e.getTime();return t!==aS.getTime()&&t!==sS.getTime()};!function(e){e[e.Left=0]="Left",e[e.Right=1]="Right"}(oS||(oS={}));var cS;!function(e){e[e.FullRangeIterated=0]="FullRangeIterated",e[e.StoppedByIterator=1]="StoppedByIterator",e[e.MaxCacheExtendCyclesReached=2]="MaxCacheExtendCyclesReached",e[e.MaxRangeReached=3]="MaxRangeReached"}(cS||(cS={}));var lS=function(){function e(t){v()(this,e),this.cacheFilledStartDate=sS,this.cacheFilledEndDate=aS,this.intervalsCachingChunkDuration=30,this.intervalsCachingChunkUnit=KC.Day,this.maxCacheExtendCycles=100,this.maxRange=15552e7,t&&Object.assign(this,t)}return g()(e,[{key:"includeWrappingRangeFrom",value:function(e,t,n){e.ensureCacheFilledForInterval(t,n),this.intervalCache.includeWrappingRange(e.intervalCache,t,n)}},{key:"ensureCacheFilledForInterval",value:function(e,t){var n=this.cacheFilledStartDate.getTime(),r=this.cacheFilledEndDate.getTime();if(n!==sS.getTime()){var i=e.getTime(),o=t.getTime();if(n<=i&&o<=r)return;if(o<=n)t=new Date(n-1);else if(i>=r)e=new Date(r+1);else if(n<=i&&i<=r)e=new Date(r+1);else{if(!(n<=o&&o<=r))return this.ensureCacheFilledForInterval(e,new Date(n-1)),void this.ensureCacheFilledForInterval(new Date(r+1),t);t=new Date(n-1)}}(n===sS.getTime()||e.getTime()<r)&&(this.cacheFilledStartDate=e),(r===aS.getTime()||r<t.getTime())&&(this.cacheFilledEndDate=t),this.fillCache(e,t)}},{key:"fillCache",value:function(e,t){throw new Error("Abstract method")}},{key:"clear",value:function(){this.cacheFilledStartDate=sS,this.cacheFilledEndDate=aS,this.intervalCache.clear()}},{key:"forEachAvailabilityInterval",value:function(e,t,n){var r;n=n||this;var i=e.startDate,o=e.endDate,a=i&&i.getTime(),s=o&&o.getTime(),u=null!==(r=e.maxRange)&&void 0!==r?r:this.maxRange,c=!1!==e.isForward;if(c?!i:!o)throw new Error("At least `startDate` or `endDate` is required, depending from the `isForward` option");for(var l=this.intervalCache,f=c?i:o,d=c?i:o,h=d.getTime(),v=1;v<this.maxCacheExtendCycles;v++){c?this.ensureCacheFilledForInterval(f,o||Zt.add(f,this.intervalsCachingChunkDuration,this.intervalsCachingChunkUnit)):this.ensureCacheFilledForInterval(i||Zt.add(f,-this.intervalsCachingChunkDuration,this.intervalsCachingChunkUnit),f);for(var p=l.getIntervalOf(d,c?oS.Left:oS.Right);p;){var g=p.startDate,y=p.endDate;if(c&&s&&g.getTime()>=s||!c&&a&&y.getTime()<=a)return cS.FullRangeIterated;if(c&&g.getTime()-h>=u||!c&&h-y.getTime()>=u)return cS.MaxRangeReached;if(c&&g.getTime()>this.cacheFilledEndDate.getTime()||!c&&y.getTime()<this.cacheFilledStartDate.getTime())break;d=c?y:g;var m=a&&g.getTime()<a?i:g,k=s&&y.getTime()>s?o:y;if(!1===t.call(n,m,k,p.cacheInterval))return cS.StoppedByIterator;p=c?l.getNextInterval(p):l.getPrevInterval(p)}if(c&&d.getTime()===sS.getTime()||!c&&d.getTime()===aS.getTime())return cS.FullRangeIterated;f=c?this.cacheFilledEndDate:this.cacheFilledStartDate}return cS.MaxCacheExtendCyclesReached}}]),e}();function fS(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return dS(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return dS(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function dS(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}var hS,vS=function(){function e(t){v()(this,e),this.intervalGroups=[],t&&Object.assign(this,t)}return g()(e,[{key:"combineWith",value:function(t){var n=this.intervalGroups.slice();return n.push([t.calendar,t]),new e({intervalGroups:n})}},{key:"getIsWorkingForEvery",value:function(){if(null!=this.isWorkingForEvery)return this.isWorkingForEvery;var e,t=fS(this.getGroups());try{for(t.s();!(e=t.n()).done;){var n=ye()(e.value,2);n[0];if(!n[1][0].isWorking)return this.isWorkingForEvery=!1}}catch(e){t.e(e)}finally{t.f()}return this.isWorkingForEvery=!0}},{key:"getIsWorkingForSome",value:function(){if(null!=this.isWorkingForSome)return this.isWorkingForSome;var e,t=fS(this.getGroups());try{for(t.s();!(e=t.n()).done;){var n=ye()(e.value,2);n[0];if(n[1][0].isWorking)return this.isWorkingForSome=!0}}catch(e){t.e(e)}finally{t.f()}return this.isWorkingForSome=!1}},{key:"getCalendars",value:function(){return this.getGroups(),this.calendars}},{key:"isCalendarWorking",value:function(e){return this.getCalendarsWorkStatus().get(e)}},{key:"getCalendarsWorkStatus",value:function(){if(this.calendarsWorkStatus)return this.calendarsWorkStatus;var e,t=new Map,n=fS(this.getGroups());try{for(n.s();!(e=n.n()).done;){var r=ye()(e.value,2),i=r[0],o=r[1];t.set(i,o[0].isWorking)}}catch(e){n.e(e)}finally{n.f()}return this.calendarsWorkStatus=t}},{key:"getCalendarsWorking",value:function(){if(this.calendarsWorking)return this.calendarsWorking;var e,t=[],n=fS(this.getGroups());try{for(n.s();!(e=n.n()).done;){var r=ye()(e.value,2),i=r[0];r[1][0].isWorking&&t.push(i)}}catch(e){n.e(e)}finally{n.f()}return this.calendarsWorking=t}},{key:"getCalendarsNonWorking",value:function(){if(this.calendarsNonWorking)return this.calendarsNonWorking;var e,t=[],n=fS(this.getGroups());try{for(n.s();!(e=n.n()).done;){var r=ye()(e.value,2),i=r[0];r[1][0].isWorking||t.push(i)}}catch(e){n.e(e)}finally{n.f()}return this.calendarsNonWorking=t}},{key:"getGroups",value:function(){if(this.intervalsByCalendar)return this.intervalsByCalendar;var e=this.calendars=[],t=new Map;return this.intervalGroups.forEach((function(n){var r=ye()(n,2),i=r[0],o=r[1],a=t.get(i);a||(e.push(i),a=[],t.set(i,a)),a.push.apply(a,o.intervals)})),t.forEach((function(e,n){var r=iS(e);r.sort((function(e,t){return t.getPriorityField()-e.getPriorityField()})),t.set(n,r)})),this.intervalsByCalendar=t}}]),e}(),pS=function(e,t){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e,t){return e-t},r=0,i=t.length;r<i;){var o=(r+i)/2|0,a=n(e,t[o]);if(0===a)return{found:!0,index:o};a<0?i=o:r=o+1}return{found:!1,index:i}};!function(e){e[e.Exact=0]="Exact",e[e.Next=1]="Next"}(hS||(hS={}));var gS=function(){function e(t){v()(this,e),this.keys=[],this.values=[],this.comparator=t||function(e,t){return e-t}}return g()(e,[{key:"set",value:function(e,t){var n=pS(e,this.keys,this.comparator);return n.found?this.values[n.index]=t:(this.keys.splice(n.index,0,e),this.values.splice(n.index,0,t)),n.index}},{key:"insertAt",value:function(e,t,n){this.keys.splice(e,0,t),this.values.splice(e,0,n)}},{key:"setValueAt",value:function(e,t){this.values[e]=t}},{key:"get",value:function(e){var t=pS(e,this.keys,this.comparator);return t.found?this.values[t.index]:void 0}},{key:"getEntryAt",value:function(e){return e<this.keys.length?{key:this.keys[e],value:this.values[e]}:void 0}},{key:"getKeyAt",value:function(e){return this.keys[e]}},{key:"getValueAt",value:function(e){return this.values[e]}},{key:"delete",value:function(e){var t=pS(e,this.keys,this.comparator);t.found&&this.deleteAt(t.index)}},{key:"size",value:function(){return this.keys.length}},{key:"deleteAt",value:function(e){this.keys.splice(e,1),this.values.splice(e,1)}},{key:"indexOfKey",value:function(e){var t=pS(e,this.keys,this.comparator);return{found:t.found?hS.Exact:hS.Next,index:t.index}}},{key:"map",value:function(e){for(var t=this.keys,n=this.values,r=[],i=0;i<t.length;i++)r.push(e(n[i],t[i],i));return r}},{key:"getAllEntries",value:function(){return this.map((function(e,t){return{value:e,key:t}}))}},{key:"clear",value:function(){this.keys.length=0,this.values.length=0}}]),e}(),yS=function(){function e(t){if(v()(this,e),this.points=new gS((function(e,t){return e.getTime()-t.getTime()})),this.leftInfinityKey=aS,this.rightInfinityKey=sS,Object.assign(this,t),void 0===this.emptyInterval||!this.combineIntervalsFn)throw new Error("All of `emptyPoint`, `combineIntervalsFn` are required");this.points.set(this.leftInfinityKey,this.emptyInterval)}return g()(e,[{key:"size",value:function(){return this.points.size()}},{key:"indexOf",value:function(e){return this.points.indexOfKey(e)}},{key:"getDateAt",value:function(e){return this.points.getKeyAt(e)}},{key:"getPointAt",value:function(e){return this.points.getValueAt(e)}},{key:"getIntervalOf",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:oS.Left,r=this.indexOf(e),i=r.found,o=r.index;return t=n===oS.Left&&i===hS.Exact?o:o-1,this.getIntervalWithStartDateIndex(t)}},{key:"getPrevInterval",value:function(e){return 0===e.startDateIndex?null:this.getIntervalWithStartDateIndex(e.startDateIndex-1)}},{key:"getNextInterval",value:function(e){return e.startDateIndex>=this.size()-1?null:this.getIntervalWithStartDateIndex(e.startDateIndex+1)}},{key:"getIntervalWithStartDateIndex",value:function(e){return{startDateIndex:e,startDate:this.getDateAt(e),endDate:e+1<this.size()?this.getDateAt(e+1):this.rightInfinityKey,cacheInterval:this.getPointAt(e)}}},{key:"addInterval",value:function(e,t,n){var r,i,o=this.points,a=o.indexOfKey(e),s=a.found,u=a.index;if(s==hS.Exact){var c=n(i=o.getValueAt(u));o.setValueAt(u,c),r=u+1}else{var l=n(i=o.getValueAt(u-1));o.insertAt(u,e,l),r=u+1}for(;r<o.size();){if(o.getKeyAt(r).getTime()>=t.getTime())break;var f=n(i=o.getValueAt(r));o.setValueAt(r,f),r++}r===o.size()?o.insertAt(o.size(),t,this.emptyInterval):o.getKeyAt(r).getTime()===t.getTime()||o.insertAt(r,t,i)}},{key:"includeWrappingRange",value:function(e,t,n){for(var r=this,i=e.getIntervalOf(t);i&&(this.addInterval(i.startDate,i.endDate,(function(e){return r.combineIntervalsFn(e,i.cacheInterval)})),!(i.endDate.getTime()>n.getTime()));)i=e.getNextInterval(i)}},{key:"getSummary",value:function(){return this.points.map((function(e,t){return{label:e,date:t}}))}},{key:"clear",value:function(){this.points.clear(),this.points.set(this.leftInfinityKey,this.emptyInterval)}}]),e}();function mS(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var kS=function(e){fe()(n,e);var t=mS(n);function n(e){var r;return v()(this,n),(r=t.call(this,e)).calendarCaches=iS(r.calendarCaches),r.intervalCache=new yS({emptyInterval:new vS,combineIntervalsFn:function(e,t){return e.combineWith(t)}}),r}return g()(n,[{key:"fillCache",value:function(e,t){var n=this;this.calendarCaches.forEach((function(r){r.fillCache(e,t),n.includeWrappingRangeFrom(r,e,t)}))}}]),n}(lS);new Map;function bS(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var wS=function(e){fe()(n,e);var t=bS(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([oC],(function(e){e.prototype;return function(e){fe()(n,e);var t=bS(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"getCalendar",value:function(){return this.stores[0].calendar}},{key:"resetPriority",value:function(){this.priorityField=null,this.getCalendar().getDepth()}},{key:"getPriorityField",value:function(){if(null!=this.priorityField)return this.priorityField;var e=1e4+100*this.getCalendar().getDepth(),t=this.priority;return null==t&&(t=this.isRecurrent()?20:30),this.priorityField=e+t}},{key:"isRecurrent",value:function(){return Boolean(this.recurrentStartDate&&this.recurrentEndDate&&this.getStartDateSchedule()&&this.getEndDateSchedule())}},{key:"isStatic",value:function(){return Boolean(this.startDate&&this.endDate)}},{key:"parseDateSchedule",value:function(e){if(e&&e!==Object(e)&&((e=u.parse.text(e))!==Object(e)||e.error>0))try{e=JSON.parse(e)}catch(e){return null}return e}},{key:"getStartDateSchedule",value:function(){if(this.startDateSchedule)return this.startDateSchedule;var e=this.parseDateSchedule(this.recurrentStartDate);return this.startDateSchedule=u.schedule(e)}},{key:"getEndDateSchedule",value:function(){if(this.endDateSchedule)return this.endDateSchedule;var e=this.parseDateSchedule(this.recurrentEndDate);return this.endDateSchedule=u.schedule(e)}}],[{key:"fields",get:function(){return["name",{name:"startDate",type:"date",format:"YYYY-MM-DDTHH:mm:ssZ"},{name:"endDate",type:"date",format:"YYYY-MM-DDTHH:mm:ssZ"},"recurrentStartDate","recurrentEndDate",{name:"isWorking",type:"boolean",defaultValue:!1},{name:"priority",type:"number"}]}}]),n}(e)})));function CS(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var SS=function(e){fe()(n,e);var t=CS(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([tC],(function(e){e.prototype;return function(e){fe()(n,e);var t=CS(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"defaultConfig",get:function(){return{modelClass:wS}}}]),n}(e)}))),DS=function(){function e(t){if(v()(this,e),this.intervals=[],t&&Object.assign(this,t),!this.calendar)throw new Error("Required attribute `calendar` is missing")}return g()(e,[{key:"includeInterval",value:function(t){if(-1==this.intervals.indexOf(t)){var n=this.intervals.slice();return n.push(t),new e({intervals:n,calendar:this.calendar})}return this}},{key:"combineWith",value:function(t){return new e({intervals:this.intervals.concat(t.intervals),calendar:this.calendar})}},{key:"getIsWorking",value:function(){if(null!=this.isWorking)return this.isWorking;var e=this.intervals=this.normalizeIntervals(this.intervals);return this.isWorking=e[0].isWorking}},{key:"normalizeIntervals",value:function(e){var t=iS(e);return t.sort((function(e,t){return t.getPriorityField()-e.getPriorityField()})),t}}]),e}();function RS(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var xS=function(e){fe()(n,e);var t=RS(n);function n(e){var r;if(v()(this,n),(r=t.call(this,e)).staticIntervalsCached=!1,!r.unspecifiedTimeInterval)throw new Error("Required attribute `unspecifiedTimeInterval` is missing");return r.intervalCache=new yS({emptyInterval:new DS({intervals:[r.unspecifiedTimeInterval],calendar:r.calendar}),combineIntervalsFn:function(e,t){return e.combineWith(t)}}),r}return g()(n,[{key:"fillCache",value:function(e,t){var n=this;this.staticIntervalsCached||(this.cacheStaticIntervals(),this.staticIntervalsCached=!0),this.parentCache&&this.includeWrappingRangeFrom(this.parentCache,e,t);var r=e.getTime(),i=t.getTime();if(r>i)throw new Error("Invalid cache fill interval");this.forEachRecurrentInterval((function(o){var a=o.getStartDateSchedule(),s=o.getEndDateSchedule(),c=a.prev(1,e),l=s.next(1,t);if(c!==u.NEVER&&c.getTime()===r){var f=a.prev(2,e);f!==u.NEVER&&2===f.length&&(c=f[1])}if(l!==u.NEVER&&l.getTime()===i){var d=s.next(2,t);d!==u.NEVER&&2===d.length&&(l=d[1])}var h=a.next(1/0,c!==u.NEVER?c:e,l!==u.NEVER?new Date(l.getTime()-1):t);if(h!==u.NEVER){var v=s.next(1/0,new Date(h[0].getTime()+1),l!==u.NEVER?l:t);v.length>h.length?v.length=h.length:v.length<h.length&&(h.length=v.length),h.forEach((function(e,t){var r=e,i=v[t];n.intervalCache.addInterval(r,i,(function(e){return e.includeInterval(o)}))}))}}))}},{key:"clear",value:function(){this.staticIntervalsCached=!1,we()(pe()(n.prototype),"clear",this).call(this)}},{key:"cacheStaticIntervals",value:function(){var e=this;this.forEachStaticInterval((function(t){e.intervalCache.addInterval(t.startDate,t.endDate,(function(e){return e.includeInterval(t)}))}))}},{key:"forEachStaticInterval",value:function(e){this.intervalStore.forEach((function(t){t.isStatic()&&e(t)}))}},{key:"forEachRecurrentInterval",value:function(e){this.intervalStore.forEach((function(t){t.isRecurrent()&&e(t)}))}}]),n}(lS);function ES(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var TS=function(e){fe()(n,e);var t=ES(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([wS],(function(e){e.prototype;return function(e){fe()(n,e);var t=ES(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"getCalendar",value:function(){return this.calendar}},{key:"getPriorityField",value:function(){return null!=this.priorityField?this.priorityField:this.priorityField=this.getCalendar().getDepth()}}]),n}(e)})));function MS(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var AS=function(e){fe()(n,e);var t=MS(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([oC],(function(e){var t=e.prototype;return function(e){fe()(r,e);var n=MS(r);function r(){var e;return v()(this,r),(e=n.apply(this,arguments)).version=1,e}return g()(r,[{key:"afterConstruct",value:function(){t.afterConstruct.call(this);var e=this.getDefaultConfiguration().calendarIntervalModelClass||this.intervalStoreClass.defaultConfig.modelClass;this.intervalStore=new this.intervalStoreClass({calendar:this,modelClass:e}),this.intervals&&this.intervals.length&&this.addIntervals(this.intervals)}},{key:"isDefault",value:function(){var e=this.getProject();return!!e&&this===e.defaultCalendar}},{key:"getDepth",value:function(){return this.childLevel+1}},{key:"forEachAvailabilityInterval",value:function(e,t,n){return this.calendarCache.forEachAvailabilityInterval(e,t,n)}},{key:"accumulateWorkingTime",value:function(e,t,n){if(0===t)return{finalDate:new Date(e),remainingDurationInMs:0};if(isNaN(t))throw new Error("Invalid duration");var r=e;return this.forEachAvailabilityInterval(n?{startDate:e,isForward:!0}:{endDate:e,isForward:!1},(function(e,i,o){var a=!0;if(o.getIsWorking()){var s=e.getTimezoneOffset()-i.getTimezoneOffset(),u=i.getTime()-e.getTime()+60*s*1e3;t<=u?(r=n?new Date(e.getTime()+t):new Date(i.getTime()-t),t=0,a=!1):(r=n?i:e,t-=u)}return a})),{finalDate:new Date(r),remainingDurationInMs:t}}},{key:"calculateDurationMs",value:function(e,t){var n=0;return this.forEachAvailabilityInterval({startDate:e,endDate:t},(function(e,t,r){if(r.getIsWorking()){var i=e.getTimezoneOffset()-t.getTimezoneOffset();n+=t.getTime()-e.getTime()+60*i*1e3}})),n}},{key:"calculateEndDate",value:function(e,t){var n=t>=0,r=this.accumulateWorkingTime(e,Math.abs(t),n);return 0===r.remainingDurationInMs?r.finalDate:null}},{key:"calculateStartDate",value:function(e,t){var n=t<=0,r=this.accumulateWorkingTime(e,Math.abs(t),n);return 0===r.remainingDurationInMs?r.finalDate:null}},{key:"skipNonWorkingTime",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this.forEachAvailabilityInterval(n?{startDate:e,isForward:!0}:{endDate:e,isForward:!1},(function(e,r,i){if(i.getIsWorking())return t=n?e:r,!1}));return r===cS.MaxRangeReached||r===cS.FullRangeIterated?"empty_calendar":t?new Date(t):new Date(e)}},{key:"addInterval",value:function(e){return this.addIntervals([e])}},{key:"addIntervals",value:function(e){return this.bumpVersion(),this.intervalStore.add(e)}},{key:"bumpVersion",value:function(){this.clearCache(),this.version++}},{key:"clearCache",value:function(){this.$calendarCache&&this.$calendarCache.clear(),this.$calendarCache=void 0}},{key:"resetPriorityOfAllIntervals",value:function(){this.traverse((function(e){e.intervalStore.forEach((function(e){return e.resetPriority()}))}))}},{key:"insertChild",value:function(e,n){var r=t.insertChild.call(this,e,n);return Array.isArray(r)||(r=[r]),r.forEach((function(e){e.bumpVersion(),e.resetPriorityOfAllIntervals()})),r}},{key:"joinProject",value:function(){t.joinProject.call(this),this.intervalStore.setProject(this.getProject())}},{key:"leaveProject",value:function(){t.leaveProject.call(this),this.intervalStore.setProject(null),this.intervalStore.destroy(),this.clearCache()}},{key:"isDayHoliday",value:function(e){var t=Zt.clearTime(e),n=Zt.getNext(e,KC.Day),r=!1;return this.forEachAvailabilityInterval({startDate:t,endDate:n,isForward:!0},(function(e,t,n){return!(r=n.getIsWorking())})),!r}},{key:"getDailyHolidaysRanges",value:function(e,t){var n=[];for(e=Zt.clearTime(e);e<t;)this.isDayHoliday(e)&&n.push({startDate:e,endDate:Zt.getStartOfNextDay(e,!0,!0)}),e=Zt.getNext(e,KC.Day);return n}},{key:"getNonWorkingTimeRanges",value:function(e,t){var n=[];return this.forEachAvailabilityInterval({startDate:e,endDate:t,isForward:!0},(function(e,t,r){if(!r.getIsWorking()){var i=r.intervals[0];n.push({name:i.name,startDate:e,endDate:t})}})),n}},{key:"isWorkingTime",value:function(e,t){var n=this.skipNonWorkingTime(e);return!(!n||"empty_calendar"===n)&&n<t}},{key:"intervalStoreClass",get:function(){return SS}},{key:"calendarCache",get:function(){if(void 0!==this.$calendarCache)return this.$calendarCache;var e=new TS({isWorking:this.unspecifiedTimeIsWorking});return e.calendar=this,this.$calendarCache=new xS({calendar:this,unspecifiedTimeInterval:e,intervalStore:this.intervalStore,parentCache:this.parent&&!this.parent.isRoot?this.parent.calendarCache:null})}}],[{key:"fields",get:function(){return[{name:"version",type:"number"},"name",{name:"unspecifiedTimeIsWorking",type:"boolean",defaultValue:!0},"intervals"]}}]),r}(e)})));function PS(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var IS=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":l()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},OS=Symbol("CalendarMixin"),FS=function(e){fe()(n,e);var t=PS(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([AS,sC],(function(e){e.prototype;var t=function(e){fe()(n,e);var t=PS(n);function n(){var e;return v()(this,n),(e=t.apply(this,arguments)).version=1,e}return g()(n,[{key:OS,value:function(){}}]),n}(e);return IS([lw({persistent:!1})],t.prototype,"version",void 0),IS([Vw({type:"string"})],t.prototype,"name",void 0),IS([Vw({type:"boolean",defaultValue:!0})],t.prototype,"unspecifiedTimeIsWorking",void 0),IS([Vw()],t.prototype,"intervals",void 0),t})));function LS(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var jS=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":l()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},_S=function(e){fe()(n,e);var t=LS(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([sC],(function(e){e.prototype;var t=function(e){fe()(n,e);var t=LS(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"writeCalendar",value:function(e,t,n,r){var i=this.getCalendarManagerStore(),o=r;r&&i&&r instanceof FS&&!i.includes(o)&&i.add(r),e.constructor.prototype.write.call(this,e,t,n,r)}},{key:"resolveCalendar",value:function(e){var t;return null===(t=this.getCalendarManagerStore())||void 0===t?void 0:t.getById(e)}},{key:"calculateEffectiveCalendar",value:Vr.a.mark((function e(){var t,n;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.calendar;case 2:if(t=e.sent){e.next=8;break}return n=this.getProject(),e.next=7,n.$.effectiveCalendar;case 7:t=e.sent;case 8:return e.next=10,t.$.version;case 10:return e.abrupt("return",t);case 11:case"end":return e.stop()}}),e,this)}))}]),n}(e);return jS([lw()],t.prototype,"effectiveCalendar",void 0),jS([cw({modelFieldConfig:{persist:!0,serialize:function(e){return null==e?void 0:e.id},isEqual:Aw},resolver:function(e){return this.resolveCalendar(e)},sync:!0},Iw)],t.prototype,"calendar",void 0),jS([dw("calendar")],t.prototype,"writeCalendar",null),jS([fw("effectiveCalendar")],t.prototype,"calculateEffectiveCalendar",null),zw(t),t}))),BS=function(e){fe()(n,e);var t=LS(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([],(function(e){e.prototype;return function(e){fe()(n,e);var t=LS(n);function n(){var e;return v()(this,n),(e=t.apply(this,arguments)).combinedcalendarscache=new Map,e}return g()(n,[{key:"combineCalendars",value:function(e){var t=iS(e);if(0===t.length)throw new Error("No calendars to combine");t.sort((function(e,t){return e.internalId<t.internalId?-1:1}));var n,r=t.map((function(e){return e.internalId+"/"})).join(""),i=t.map((function(e){return e.version+"/"})).join(""),o=this.combinedcalendarscache.get(r);return o&&o.versionsHash===i?n=o.cache:(n=new kS({calendarCaches:t.map((function(e){return e.calendarCache}))}),this.combinedcalendarscache.set(r,{versionsHash:i,cache:n})),n}}]),n}(e)})));function HS(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var $S,NS=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":l()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},VS=function(e){fe()(n,e);var t=HS(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([_S,sC],(function(e){var t=e.prototype,n=function(e){fe()(r,e);var n=HS(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"leaveProject",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(this.assigned&&!e){var n=this.getResourceStore();this.assigned.forEach((function(e){return n.assignmentsForRemoval.add(e)}))}t.leaveProject.call(this)}},{key:"assignments",get:function(){return d()(this.assigned)}}]),r}(e);return NS([cw({},Ow)],n.prototype,"assigned",void 0),n})));function zS(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var WS=function(e){fe()(n,e);var t=zS(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(rS(om(((null===($S=window.bryntum)||void 0===$S?void 0:$S.useBasicEngine)?VS:bC).derive(iv))));function GS(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return YS(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return YS(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function YS(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function US(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}WS.exposeProperties(),WS._$name="ResourceModel";var qS=function(e){fe()(n,e);var t=US(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([tC],(function(e){var t=e.prototype;return function(e){fe()(r,e);var n=US(r);function r(){var e;return v()(this,r),(e=n.apply(this,arguments)).assignmentsForRemoval=new Set,e}return g()(r,[{key:"remove",value:function(e,n){var r=t.remove.call(this,e);return this.afterResourceRemoval(),r}},{key:"afterResourceRemoval",value:function(){var e=this.getAssignmentStore();if(e&&!e.allAssignmentsForRemoval){var t=d()(this.assignmentsForRemoval).filter((function(t){return!e.assignmentsForRemoval.has(t)}));t.length>0&&e.remove(t)}this.assignmentsForRemoval.clear()}},{key:"removeAll",value:function(e){var n=t.removeAll.call(this,e);return this.afterResourceRemoval(),n}},{key:"processRecord",value:function(e){var t=this.getById(e.id),n=t&&t!==e;if(n){var r,i=GS(t.assigned);try{for(i.s();!(r=i.n()).done;){var o=r.value;o.resource=e}}catch(e){i.e(e)}finally{i.f()}}return e}}]),r}(e)})));function KS(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var XS=function(e){fe()(n,e);var t=KS(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([qS,rC],(function(e){e.prototype;return function(e){fe()(n,e);var t=KS(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"defaultConfig",get:function(){return{modelClass:VS}}}]),n}(e)})));function ZS(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var JS,QS=function(e){fe()(n,e);var t=ZS(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([qS,_C],(function(e){e.prototype;return function(e){fe()(n,e);var t=ZS(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"joinProject",value:function(){var e;null===(e=this.assignmentStore)||void 0===e||e.linkAssignments(this,"resource")}},{key:"afterLoadData",value:function(){var e;null===(e=this.assignmentStore)||void 0===e||e.linkAssignments(this,"resource")}}],[{key:"defaultConfig",get:function(){return{modelClass:bC}}}]),n}(e)})));function eD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var tD=function(e){fe()(n,e);var t=eD(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"defaultConfig",get:function(){return{modelClass:WS}}}]),n}(UC((null===(JS=window.bryntum)||void 0===JS?void 0:JS.useBasicEngine)?EC(XS.derive(Uo)):om(QS.derive(Uo))));function nD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}tD._$name="ResourceStore";var rD=function(){return!0},iD=Object.freeze([]),oD=Object.freeze({}),aD=function(e){return!e.isRecurring},sD=function(e){return function(e){fe()(n,e);var t=nD(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e){we()(pe()(n.prototype),"construct",this).call(this,e),Object.assign(this,{autoTree:!0})}},{key:"afterLoadData",value:function(){this.syncIndices("splice",this.storage.allValues),we()(pe()(n.prototype),"afterLoadData",this)&&we()(pe()(n.prototype),"afterLoadData",this).call(this)}},{key:"onDataChange",value:function(e){var t=e.action,r=e.added,i=e.removed,o=e.replaced;this.syncIndices(t,r,i,o),we()(pe()(n.prototype),"onDataChange",this).apply(this,arguments)}},{key:"onDataReplaced",value:function(e,t){this.syncIndices("clear"),this.syncIndices("splice",this.storage.values),we()(pe()(n.prototype),"onDataReplaced",this).call(this,e,t)}},{key:"syncIndices",value:function(e){var t,n,r,i,o,a,s,u,c,l,f,d,h=arguments.length>1&&void 0!==arguments[1]?arguments[1]:iD,v=arguments.length>2&&void 0!==arguments[2]?arguments[2]:iD,p=arguments.length>3?arguments[3]:void 0,g=arguments.length>4?arguments[4]:void 0,y=this,m=null===(t=h)||void 0===t?void 0:t.length,k=null===(n=v)||void 0===n?void 0:n.length,b=null==p?void 0:p.length;if(y.dateIndicesRequested)switch(e){case"clear":y._startDateIndex={},y._dateIndex={};break;case"splice":if(b)for(h=h.slice(),v=v.slice(),l=0;l<b;l++)v.push(p[l][0]),h.push(p[l][1]);if(k)for(l=0;l<k;l++){var w,C,S;if(d=v[l],u=null===(w=Zt.clearTime(d.startDate))||void 0===w?void 0:w.getTime(),c=null!==(C=null===(S=d.endDate)||void 0===S?void 0:S.getTime())&&void 0!==C?C:u,u){y.removeIndexEntry("startDate",d,Zt.makeKey(u));do{y.removeIndexEntry("date",d,Zt.makeKey(u)),u+=864e5}while(u<c)}}if(m)for(l=0;l<m;l++){var D,R,x;if((f=h[l]).isScheduled)if(u=null===(D=Zt.clearTime(f.startDate))||void 0===D?void 0:D.getTime(),c=null!==(R=null===(x=f.endDate)||void 0===x?void 0:x.getTime())&&void 0!==R?R:u,u){y.addIndexEntry("startDate",f,Zt.makeKey(u));do{y.addIndexEntry("date",f,Zt.makeKey(u)),u+=864e5}while(u<c)}}break;case"reschedule":if(d=h[0],u=null===(r=Zt.clearTime((null===(i=g.startDate)||void 0===i?void 0:i.oldValue)||d.startDate))||void 0===r?void 0:r.getTime(),c=null!==(o=null===(a=(null===(s=g.endDate)||void 0===s?void 0:s.oldValue)||d.endDate)||void 0===a?void 0:a.getTime())&&void 0!==o?o:u,u){y.removeIndexEntry("startDate",d,Zt.makeKey(u));do{y.removeIndexEntry("date",d,Zt.makeKey(u)),u+=864e5}while(u<c)}y.syncIndices("splice",h)}}},{key:"onModelChange",value:function(e,t,r,i,o){("startDate"in r||"endDate"in r)&&this.syncIndices("reschedule",[e],null,null,r),we()(pe()(n.prototype),"onModelChange",this).apply(this,arguments)}},{key:"addIndexEntry",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t[e],r="_".concat(e,"Index"),i=this[r]||(this[r]={}),o=i[n]||(i[n]=new Set);o.add(t)}},{key:"removeIndexEntry",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:t[e],r="_".concat(e,"Index"),i=this[r]||(this[r]={}),o=i[n];o&&o.delete(t)}},{key:"getDateIndex",value:function(e){var t=this;return t.dateIndicesRequested||(t.dateIndicesRequested=!0,t.syncIndices("splice",t.storage.allValues)),t["_".concat(e,"Index")]||oD}},{key:"getEventsInTimeSpan",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return y.a.deprecate("Scheduler","5.0.0","`getEventsInTimeSpan` method deprecated, in favor of `getEvents`"),this.getEvents({startDate:e,endDate:t,allowPartial:n,onlyAssigned:r})}},{key:"getEventsByStartDate",value:function(e){return y.a.deprecate("Scheduler","5.0.0","`getEventsByStartDate` method deprecated, in favor of `getEvents`"),this.getEvents({startDate:e,startOnly:!0})}},{key:"getEvents",value:function(e){var t=e.filter,n=e.date,r=e.startDate,i=e.endDate,o=e.startOnly,a=e.includeOccurrences,s=e.allowPartial,u=e.onlyAssigned,c=void 0!==u&&u,l=e.dateMap,f=void 0!==l&&l,d=(e.getDateIndex,this),h=arguments[0],v=d.lastDateRange,p=d.added,g=d.filtersFunction,y=t;if(c&&(h.filter=y?function(e){return y(e)&&e.resources.length}:function(e){return e.resources.length}),"startDate"in h||(r=h.startDate=n),"includeOccurrences"in h||(a=h.includeOccurrences=!0),"allowPartial"in h||(s=h.allowPartial=!o),h.storeFilterFn=d.isFiltered?d.reapplyFilterOnAdd?g:function(e){return p.includes(e)?d.indexOf(e)>-1:g(e)}:null,!i)if(r)(i=h.endDate=Zt.clearTime(r)).setDate(i.getDate()+1);else{if(a)throw new Error("getEvents MUST be passed startDate and endDate if recurring occurrences are requested");h.dateFilter=rD}h.dateFilter||(h.dateFilter=o?function(e){return e.startDate&&!(Zt.clearTime(e.startDate)-r)}:s?function(e){return e.startDate&&Zt.intersectSpans(e.startDate,e.endDate||e.startDate,r,i)}:function(e){return e.startDate&&e.startDate>=r&&(e.endDate||e.startDate)<=i});var m={startDate:r,endDate:i},k=!v||v.startDate-m.startDate||v.endDate-m.endDate;return k&&(d.processConfiguredListeners(),d.trigger("loadDateRange",{old:v||{},new:Object.assign({},m)}),d.lastDateRange=m),f?d.getEventsAsMap(h):d.getEventsAsArray(h)}},{key:"getEventsAsArray",value:function(e){var t=e.filter,n=e.date,r=e.resourceRecord,i=e.startDate,o=void 0===i?n:i,a=e.endDate,s=e.startOnly,u=e.includeOccurrences,c=void 0===u||u,l=e.dateFilter,f=e.storeFilterFn,h=e.getDateIndex,v=this,p=[];if(v.count){var g=r?v.getEventsForResource(r):new Set;r||function(){var e=new Set,t=v.getDateIndex(s?"startDate":"date");v.recurringEvents.forEach((function(t){Zt.clearTime(t.startDate)<=o&&e.add(t)}));for(var n=new Date(o);n<a;n.setDate(n.getDate()+1)){var r=(h?v.getDateIndex(h(n)):t)[Zt.makeKey(n)];r&&r.forEach((function(t){return e.add(t)}))}g=d()(e)}(),f&&(g=g.filter(f));for(var y=0,m=g.length;y<m;y++){var k=g[y];k.isRecurring&&c?p.push.apply(p,k.getOccurrencesForDateRange(o,a).filter(l)):l(k)&&p.push(k)}}return t?p.filter(t):p}},{key:"getEventsAsMap",value:function(e){var t=e.filter,n=e.date,r=e.resourceRecord,i=e.startDate,o=void 0===i?n:i,a=e.endDate,s=e.startOnly,u=e.includeOccurrences,c=void 0===u||u,l=e.dateMap,f=e.storeFilterFn,h=e.getDateIndex;if(l.clear?l.clear():l=new Map,this.count){var v=this.getDateIndex(s?"startDate":"date"),p=[],g=function(e){return(!t||t(e))&&(!f||f(e))};if(r)throw new Error("Querying for events for a resource and returning a date-keyed Map is not supported");this.recurringEvents.forEach((function(e){Zt.clearTime(e.startDate)<a&&p.push(e)}));for(var y=new Date(o);y<a;y.setDate(y.getDate()+1)){var m,k=Zt.makeKey(y),b=(h?this.getDateIndex(h(y)):v)[Zt.makeKey(y)];if(b)b=d()(b).filter(aD).filter(g),(m=l.get(k)||l.set(k,[]).get(k)).push.apply(m,d()(b))}for(var w=0,C=p.length;w<C;w++)for(var S=p[w],D=(c?S.getOccurrencesForDateRange(o,a):[S]).filter(g),R=0,x=D.length;R<x;R++)for(var E=D[R],T=Zt.clearTime(E.startDate),M="startDate"===(h?h(T):s?"startDate":"date")?Zt.endOf(T):E.endDate||Zt.add(E.startDate,E.duration,E.durationUnit);T<M;T.setDate(T.getDate()+1)){var A=Zt.makeKey(T);(l.get(A)||l.set(A,[]).get(A)).push(E)}}return l}},{key:"forEachScheduledEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this;this.forEach((function(n){var r=n.startDate,i=n.endDate;if(r&&i)return e.call(t,n,r,i)}))}},{key:"getTotalTimeSpan",value:function(){var e=new Date(9999,0,1),t=new Date(0);return this.forEach((function(n){n.startDate&&(e=Zt.min(n.startDate,e)),n.endDate&&(t=Zt.max(n.endDate,t))})),e=e<new Date(9999,0,1)?e:null,t=t>new Date(0)?t:null,this.lastTotalTimeSpan={startDate:e||null,endDate:t||e||null}}},{key:"isEventPersistable",value:function(e){return e.isPersistable}},{key:"isDateRangeAvailable",value:function(e,t,n,r){var i=this,o=new Set(this.getEventsForResource(r));n instanceof RC&&n.event.resources.forEach((function(e){e.id!==n.resourceId&&i.getEventsForResource(e).forEach((function(e){return o.add(e)}))}));if(n){var a=n instanceof RC?n.event:n;o.delete(a)}return!Array.from(o).some((function(n){return n.isScheduled&&Zt.intersectSpans(e,t,n.startDate,n.endDate)}))}},{key:"filterEventsForResource",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this;return e.getEvents(this).filter(t.bind(n))}},{key:"getResourcesForEvent",value:function(e){return e.isOccurrence&&(e=e.recurringTimeSpan),this.assignmentStore.getResourcesForEvent(e)}},{key:"getEventsForResource",value:function(e){return this.assignmentStore.getEventsForResource(e)}},{key:"getAssignmentsForEvent",value:function(e){return this.assignmentStore.getAssignmentsForEvent(e)||[]}},{key:"getAssignmentsForResource",value:function(e){return this.assignmentStore.getAssignmentsForResource(e)||[]}},{key:"assignEventToResource",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.assignmentStore.assignEventToResource(e,t,void 0,n)}},{key:"unassignEventFromResource",value:function(e,t){this.assignmentStore.unassignEventFromResource(e,t)}},{key:"reassignEventFromResourceToResource",value:function(e,t,n){var r=Bi.asId(n),i=this.assignmentStore.getAssignmentForEventAndResource(e,t);i?i.resourceId=r:this.assignmentStore.assignEventToResource(e,n)}},{key:"isEventAssignedToResource",value:function(e,t){return this.assignmentStore.isEventAssignedToResource(e,t)}},{key:"removeAssignmentsForEvent",value:function(e){this.assignmentStore.removeAssignmentsForEvent(e)}},{key:"removeAssignmentsForResource",value:function(e){this.assignmentStore.removeAssignmentsForResource(e)}}],[{key:"$name",get:function(){return"EventStoreMixin"}}]),n}(e||ue)};function uD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var cD=function(e){return function(e){fe()(n,e);var t=uD(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e){if(we()(pe()(n.prototype),"construct",this).call(this,e,!0),!this.modelClass.isEventModel)throw new Error("The model for the EventStore must subclass EventModel")}},{key:"suspendAssignmentsAutoAdd",value:function(){this.assignmentsAutoAddSuspended++}},{key:"resumeAssignmentsAutoAdd",value:function(){this.assignmentsAutoAddSuspended>0&&this.assignmentsAutoAddSuspended--}},{key:"append",value:function(e){return this.add(e)}},{key:"processRecord",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];we()(pe()(n.prototype),"processRecord",this).call(this,e,t);var r=e.get("resourceId");if(null!=r){var i=this,o=i.assignmentStore,a=i.getById(e.id),s=a&&a!==e&&!t;if(s){var u=o.find((function(t){return t.eventId===e.id}));u&&(u.resource=r,i.reassignedFromReplace=!0)}else if(!o||t||i.assignmentsAutoAddSuspended)i.$processResourceIds=!0;else{var c=o.find((function(t){return t.resourceId===r&&t.eventId===e.id}));c||o.add({id:o.modelClass.generateId(""),resourceId:r,eventId:e.id})}i.usesSingleAssignment=!0}return e}},{key:"processResourceIds",value:function(){var e=this.assignmentStore;if(this.$processResourceIds&&(null==e?void 0:e.isAssignmentStore)){var t=[];this.forEach((function(n){var r=n.resourceId,i=n.id;null!=r&&t.push({id:e.modelClass.generateId(""),resourceId:r,eventId:i})})),e.useRawData={disableDefaultValue:!0,disableDuplicateIdCheck:!0,disableTypeConversion:!0},e.usesSingleAssignment=!1,e.data=t,e.usesSingleAssignment=!0,this.$processResourceIds=!1}}},{key:"loadData",value:function(){we()(pe()(n.prototype),"loadData",this).apply(this,arguments),this.processResourceIds()}},{key:"onBeforeRemoveAssignment",value:function(e){var t,n=e.records,r=this;if(r.removeUnassignedEvent&&!r.isRemoving&&!r.isSettingData&&!(null===(t=r.stm)||void 0===t?void 0:t.isRestoring)&&!r.usesSingleAssignment){var i=new Set;n.forEach((function(e){var t=e.event;t&&!t.isRemoved&&t.assignments.every((function(e){return n.includes(e)}))&&i.add(t)})),i.size&&r.remove(d()(i))}}},{key:"onProjectAssignmentStoreChange",value:function(e){var t=e.store;this.attachToAssignmentStore(t)}},{key:"attachToAssignmentStore",value:function(e){var t=this;t.detachListeners("assignmentStore"),e&&(t.processResourceIds(),e.on({name:"assignmentStore",addPreCommit:function(e){var n=e.records;!t.usesSingleAssignment||t.isSettingData||t.isAssigning||n.forEach((function(e){var t=e.event;(null==t?void 0:t.isEvent)&&t.resourceId!==e.resourceId&&(t.meta.isAssigning=!0,t.set("resourceId",e.resourceId),t.meta.isAssigning=!1)}))},beforeRemove:"onBeforeRemoveAssignment",removePreCommit:function(e){var n=e.records;t.usesSingleAssignment&&n.forEach((function(e){var n;null===(n=t.getById(e.eventId))||void 0===n||n.set("resourceId",null)}))},removeAllPreCommit:function(){t.usesSingleAssignment&&!t.isSettingData&&t.allRecords.forEach((function(e){return e.set("resourceId",null)}))},update:function(e){var n=e.record,r=e.changes;if(t.usesSingleAssignment&&"resourceId"in r){var i=n.event;i.meta.isAssigning=!0,i.set("resourceId",r.resourceId.value),i.meta.isAssigning=!1}},thisObj:t}))}},{key:"trigger",value:function(e,t){var r=t||{},i=r.changes;i&&"resourceId"in i&&1===Object.keys(i).length&&(t.isAssign=!0),we()(pe()(n.prototype),"trigger",this).apply(this,arguments)}},{key:"project",get:function(){return we()(pe()(n.prototype),"project",this)},set:function(e){sc()(pe()(n.prototype),"project",e,this,!0),this.detachListeners("project"),e&&(e.on({name:"project",assignmentStoreChange:"onProjectAssignmentStoreChange",thisObj:this,prio:200}),e.assignmentStore&&e.assignmentStore.isAssignmentStore&&this.attachToAssignmentStore(e.assignmentStore))}},{key:"data",set:function(e){this.isSettingData=!0,this.usesSingleAssignment&&this.assignmentStore.removeAll(!0),sc()(pe()(n.prototype),"data",e,this,!0),this.isSettingData=!1}}],[{key:"$name",get:function(){return"SharedEventStoreMixin"}},{key:"defaultConfig",get:function(){return{loadPriority:100,syncPriority:200,storeId:"events",removeUnassignedEvent:!0}}},{key:"properties",get:function(){return{assignmentsAutoAddSuspended:0}}}]),n}(e)};function lD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var fD=Object.freeze([]);function dD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var hD=function(e){return function(e){fe()(n,e);var t=dD(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"getRecurringEvents",value:function(){return this.getRecurringTimeSpans()}},{key:"isEventPersistable",value:function(e){return we()(pe()(n.prototype),"isEventPersistable",this).call(this,e)&&(!e.supportsRecurring||!e.isOccurrence)}}],[{key:"$name",get:function(){return"RecurringEventsMixin"}}]),n}(function(e){return function(e){fe()(n,e);var t=lD(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(){var e,t=this;t.globalOccurrences=new Map,t.recurringEvents=new Set;for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];(e=we()(pe()(n.prototype),"construct",this)).call.apply(e,[this].concat(i))}},{key:"afterLoadData",value:function(){this.globalOccurrences.clear(),this.refreshRecurringEventsCache("clear"),this.refreshRecurringEventsCache("splice",this.storage.allValues),we()(pe()(n.prototype),"afterLoadData",this)&&we()(pe()(n.prototype),"afterLoadData",this).call(this)}},{key:"onDataChange",value:function(e){var t=e.action,r=e.added,i=e.removed,o=e.replaced;this.refreshRecurringEventsCache(t,r,i,o),we()(pe()(n.prototype),"onDataChange",this).apply(this,arguments)}},{key:"refreshRecurringEventsCache",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:fD,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:fD,r=arguments.length>3?arguments[3]:void 0,i=this,o=i.recurringEvents,a=null==r?void 0:r.length;switch(e){case"clear":o.clear();break;case"splice":if(a){t=t.slice(),n=n.slice();for(var s=0;s<a;s++)n.push(r[s][0]),t.push(r[s][1])}var u=t.length,c=n.length;if(c)for(var l=0;l<c;l++){var f=n[l];f.isRecurring&&o.delete(f)}if(u)for(var d=0;d<u;d++){var h=t[d];h.isRecurring&&o.add(h)}}}},{key:"add",value:function(e){var t=Array.isArray(e)?e:[e];if(t.some((function(e){return e.isOccurrence})))throw new Error("Occurrences must not be added to the event store");return we()(pe()(n.prototype),"add",this).call(this,t)}},{key:"getById",value:function(e){var t=we()(pe()(n.prototype),"getById",this).call(this,e);return t||(t=this.globalOccurrences.get(this.modelClass.asId(e))),t}},{key:"onModelChange",value:function(e,t,r,i,o){var a=this.isRecurrenceRelatedFieldChange(e,r);if(a&&!i&&e.removeOccurrences(),we()(pe()(n.prototype),"onModelChange",this).apply(this,arguments),a&&!i){var s={action:"batch",records:this.storage.values};this.trigger("refresh",s),this.trigger("change",s)}}},{key:"isRecurrenceRelatedFieldChange",value:function(e,t){return e.isRecurring||"recurrenceRule"in t}},{key:"getOccurrencesForTimeSpan",value:function(e,t,n){var r=[];return e.isRecurring&&e.recurrence.forEachOccurrence(t,n,(function(e){return r.push(e)})),r}},{key:"getRecurringTimeSpans",value:function(){return d()(this.recurringEvents)}},{key:"data",set:function(e){this.globalOccurrences.clear(),sc()(pe()(n.prototype),"data",e,this,!0)}}],[{key:"$name",get:function(){return"RecurringTimeSpansMixin"}}]),n}(e||ue)}(e||ue))};function vD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var pD=/^([+-]?[0-9])?(SU|MO|TU|WE|TH|FR|SA)$/,gD=["SU","MO","TU","WE","TH","FR","SA"],yD=function(e){fe()(n,e);var t=vD(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"decodeDay",value:function(e){var t,n;return(t=pD.exec(e))&&(n=[gD.indexOf(t[2])],t[1]&&(t[1]=parseInt(t[1],10),n.push(t[1]))),n}},{key:"encodeDay",value:function(e){var t;if(Array.isArray(e)){var n=e,r=ye()(n,2);e=r[0],t=r[1]}return(t?t.toString():"")+gD[e]}},{key:"decode",value:function(e){var t,n=[];if(e)for(var r=0;r<e.length;r++)(t=this.decodeDay(e[r]))&&n.push(t);return n}},{key:"encode",value:function(e){var t,n=[];if(e)for(var r=0;r<e.length;r++)(t=this.encodeDay(e[r]))&&n.push(t);return n}}]),n}(ue);function mD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}yD._$name="RecurrenceDayRuleEncoder";var kD,bD=/ly$/i,wD=function(e){var t=e.replace(bD,"");return"DAI"===t?"DAY":t},CD=function(e,t,n,r){return r.buildOccurrence(e,n)},SD=function(e){return kD=e},DD=function(e){fe()(n,e);var t=mD(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"processIterationConfig",value:function(e){var t=e.recurrence,n=t.frequency,r=t.interval,i=t.timeSpan,o=t.endDate,a=t.count;if(!e.syncingStartDate&&!i.meta.isSyncedWithRule){var s=Zt.add(i.startDate,r,wD(n)),u=Zt.min(s,e.endDate||s);this.forEachDate({syncingStartDate:!0,startDate:i.startDate,endDate:u,recurrence:t,fn:CD})}var c=i.startDate,l=e.startDate,f=void 0===l?c:l,d=e.endDate,h=void 0===d?o:d;f<c&&(f=c),o?(!h||h>o)&&(h=o):a&&f>c&&(this.forEachDate({recurrence:t,fn:SD}),(!h||h>kD)&&(h=kD));var v=f;return e.startOnly||(f=new Date(Zt.max(Zt.add(f,-r,wD(n)),c))),Object.assign({extraArgs:[],startOnly:!Boolean(i.durationMS)},e,{startDate:f,endDate:h,timeSpan:i,timeSpanStart:c,earliestVisibleDate:v,durationMS:i.durationMS,spansStart:f<=c&&h>c})}},{key:"getNthDayInPeriod",value:function(e,t,n,r){var i,o,a;if(r){r>0?(o=1,a=e):(o=-1,a=t);var s=n-a.getDay();o*s<0&&(r+=o),((i=new Date(a.getTime()+6048e5*(r-o)+864e5*s))<e||i>t)&&(i=null)}return i}},{key:"buildDate",value:function(e,t,n){var r=new Date(e,t,n);if(r.getFullYear()===e&&r.getMonth()===t&&r.getDate()===n)return r}},{key:"isValidPosition",value:function(e){return Boolean(e)}},{key:"forEachDateAtPositions",value:function(e,t,n,r){for(var i=e.length,o={},a=0;a<t.length;a++){var s=t[a];if(this.isValidPosition(s)){var u=s>0?e[s-1]:e[i+s];if(u&&!o[u.getTime()]&&(o[u.getTime()]=!0,!1===n.call(r,u)))return!1}}}},{key:"isInView",value:function(e,t,n,r,i){return(e?t>=n:t.valueOf()+r>n)&&!i.hasException(t)}},{key:"frequency",get:function(){return"NONE"}},{key:"MAX_OCCURRENCES_COUNT",get:function(){return 1e6}}]),n}(ue);function RD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}DD._$name="AbstractRecurrenceIterator";var xD=function(e){fe()(n,e);var t=RD(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"forEachDate",value:function(e){var t=this.processIterationConfig(e),n=t.startOnly,r=t.startDate,i=t.endDate,o=t.timeSpan,a=t.timeSpanStart,s=t.earliestVisibleDate,u=t.durationMS,c=t.spansStart,l=t.recurrence,f=t.fn,h=t.extraArgs,v=t.scope,p=void 0===v?this:v,g=l.interval,y=r-a,m=864e5*g,k=Math.floor(y/m),b=l.count,w=0,C=Zt.add(a,k*g,"day");for(i||b||(b=this.MAX_OCCURRENCES_COUNT);!i||C<=i;){if(w++,this.isInView(n,C,s,u,o)&&(i&&C>i||!1===f.apply(p,[C,w,1===w&&c,o].concat(d()(h)))||b&&w>=b))break;C=Zt.add(C,g,"day")}}},{key:"frequency",get:function(){return"DAILY"}}]),n}(DD);function ED(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}xD._$name="DailyRecurrenceIterator";var TD=function(e){fe()(n,e);var t=ED(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"forEachDate",value:function(e){var t,n,r=this.processIterationConfig(e),i=r.startOnly,o=r.startDate,a=r.endDate,s=r.timeSpan,u=r.timeSpanStart,c=r.earliestVisibleDate,l=r.durationMS,f=r.spansStart,h=r.recurrence,v=r.fn,p=r.extraArgs,g=r.scope,y=void 0===g?this:g,m=h.interval,k=h.days,b=0,w=h.count,C=yD.decode(k);for(C&&C.length?C.sort((function(e,t){return e[0]-t[0]})):C=[[u.getDay()]],t=Zt.getNext(w?u:o,"week",0,0),a||w||(w=this.MAX_OCCURRENCES_COUNT);!a||t<=a;){for(var S=0;S<C.length;S++){if((n=Zt.copyTimeValues(Zt.add(t,C[S][0],"day"),u))>=u)if(b++,this.isInView(i,n,c,l,s)&&(a&&n>a||!1===v.apply(y,[n,b,1===b&&f,s].concat(d()(p)))||w&&b>=w))return}t=Zt.getNext(t,"week",m,0)}}},{key:"frequency",get:function(){return"WEEKLY"}}]),n}(DD);function MD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}TD._$name="WeeklyRecurrenceIterator";var AD=function(e){fe()(n,e);var t=MD(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"getNthDayOfMonth",value:function(e,t){var n=Zt.daysInMonth(e),r=null;return t&&Math.abs(t)<=n&&(r=new Date(e.getFullYear(),e.getMonth(),t<0?n+t+1:t)),r}},{key:"isValidPosition",value:function(e){return e&&Math.abs(e)>0&&Math.abs(e)<=31}},{key:"forEachDate",value:function(e){var t,n,r,i,o,a,s=this,u=this.processIterationConfig(e),c=u.startOnly,l=u.startDate,f=u.endDate,h=u.timeSpan,v=u.timeSpanStart,p=u.earliestVisibleDate,g=u.durationMS,y=u.spansStart,m=u.recurrence,k=u.fn,b=u.extraArgs,w=u.scope,C=void 0===w?this:w,S=m.interval,D=m.days,R=m.count,x=m.positions,E=yD.decode(D),T=x&&x.length,M={},A=m.monthDays,P=0;for(n=Zt.startOf(R?v:l,"month"),r=new Date(Zt.getNext(n,"month",1)-1),A&&A.length||E&&E.length||(A=[v.getDate()]),E&&E.length&&E.forEach((function(e){e[1]&&((t=t||{})[e[0]]=e[1])}));(!f||f>=n)&&(!R||P<R);){if(i=[],E&&E.length){if(E.forEach((function(e){var t=e[0],u=1,c=53;for(e[1]&&(u=c=e[1]),a=u;a<=c;a++)(o=s.getNthDayInPeriod(n,r,t,a))&&(o=Zt.copyTimeValues(o,v),M[o.getTime()]||(M[o.getTime()]=!0,i.push(o)))})),i.sort((function(e,t){return e-t})),!T)for(a=0;a<i.length;a++)if((o=i[a])>=v){var I=this.isInView(c,o,p,g,h);if(P++,I&&(f&&o>f||!1===k.apply(C,[o,P,1===P&&y,h].concat(d()(b)))||R&&P>=R))return!1}}else{var O=[];for(a=0;a<A.length;a++)(o=this.getNthDayOfMonth(n,A[a]))&&!M[o.getTime()]&&(M[o.getTime()]=!0,O.push(o));for(O.sort((function(e,t){return e-t})),a=0;a<O.length;a++)if(o=Zt.copyTimeValues(O[a],v),T)i.push(o);else if(o>=v){var F=this.isInView(c,o,p,g,h);if(P++,F&&(f&&o>f||!1===k.apply(C,[o,P,1===P&&y,h].concat(d()(b)))||R&&P>=R))return}}T&&i.length&&this.forEachDateAtPositions(i,x,(function(e){if(e>=v){var t=c?e>=p:e.valueOf()+g>p&&!h.hasException(e);if(P++,t&&(!f||e<=f)&&(!1===k.apply(C,[e,P,1===P&&y,h].concat(d()(b)))||R&&P>=R))return!1}})),n=Zt.getNext(n,"month",S),r=new Date(Zt.getNext(n,"month",1)-1)}}},{key:"frequency",get:function(){return"MONTHLY"}}]),n}(DD);function PD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}AD._$name="MonthlyRecurrenceIterator";var ID=function(e){fe()(n,e);var t=PD(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"forEachDate",value:function(e){var t,n,r,i,o,a,s=this,u=this.processIterationConfig(e),c=u.startOnly,l=u.startDate,f=u.endDate,h=u.timeSpan,v=u.timeSpanStart,p=u.earliestVisibleDate,g=u.durationMS,y=u.spansStart,m=u.recurrence,k=u.fn,b=u.extraArgs,w=u.scope,C=void 0===w?this:w,S=m.interval,D=m.days,R=m.count,x=m.positions,E=yD.decode(D),T=x&&x.length,M={},A=m.months,P=0;for(i=Zt.startOf(R?v:l,"year"),o=new Date(Zt.getNext(i,"year",1)-1),A&&A.sort((function(e,t){return e-t})),A&&A.length||E&&E.length||(A=[v.getMonth()+1]),E&&E.length&&E.forEach((function(e){e[1]&&((a=a||{})[e[0]]=e[1])}));(!f||f>=i)&&(!R||P<R);){if(r=[],E&&E.length){if(E.forEach((function(e){var a=e[0],u=1,c=53;for(e[1]&&(u=c=e[1]),t=u;t<=c;t++)(n=s.getNthDayInPeriod(i,o,a,t))&&(n=Zt.copyTimeValues(n,v),M[n.getTime()]||(M[n.getTime()]=!0,r.push(n)))})),r.sort((function(e,t){return e-t})),!T)for(t=0;t<r.length;t++)if((n=r[t])>=v){var I=this.isInView(c,n,p,g,h);if(P++,I&&(f&&n>f||!1===k.apply(C,[n,P,1===P&&y,h].concat(d()(b)))||R&&P>=R))return}}else for(t=0;t<A.length;t++)if((n=this.buildDate(i.getFullYear(),A[t]-1,v.getDate()))&&(n=Zt.copyTimeValues(n,v),!M[n.getTime()]))if(M[n.getTime()]=!0,T)r.push(n);else if(n>=v){var O=c?n>=p:n.valueOf()+g>p&&!h.hasException(n);if(P++,O&&(f&&n>f||!1===k.apply(C,[n,P,1===P&&y,h].concat(d()(b)))||R&&P>=R))return}T&&r.length&&this.forEachDateAtPositions(r,x,(function(e){if(e>=v){var t=c?e>=p:e.valueOf()+g>p&&!h.hasException(e);if(P++,t&&(!f||e<=f)&&(!1===k.apply(C,[e,P,1===P&&y,h].concat(d()(b)))||R&&P>=R))return!1}})),i=Zt.getNext(i,"year",S),o=new Date(Zt.getNext(i,"year",1)-1)}}},{key:"frequency",get:function(){return"YEARLY"}}]),n}(DD);function OD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}ID._$name="YearlyRecurrenceIterator";var FD={};function LD(e){return e?"string"==typeof e&&(e=e.split(",").map((function(e){return parseInt(e,10)}))):e=null,e}function jD(e){return e?"string"==typeof e&&(e=e.split(",")):e=null,e}function _D(e,t){return String(e)===String(t)}function BD(e){return this.defaultValue&&void 0===e?this.defaultValue:this.allowNull&&null==e?null:(e=parseInt(e),isNaN(e)?void 0:e)}[xD,TD,AD,ID].forEach((function(e){FD[e.frequency]=e}));var HD=function(e){fe()(n,e);var t=OD(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this,r=e.rule,i=e.timeSpan;t._suspendedTimeSpanNotifying=0,delete e.timeSpan,delete e.rule,we()(pe()(n.prototype),"construct",this).apply(this,arguments),r&&(t.suspendTimeSpanNotifying(),t.rule=r,t.resumeTimeSpanNotifying()),t.timeSpan=i}},{key:"forEachOccurrence",value:function(e,t,n){this.timeSpan.startDate&&this.recurrenceIterator.forEachDate({recurrence:this,startDate:e,endDate:t,fn:function(e,t,r,i){n(i.buildOccurrence(e,r),r,t,e)}})}},{key:"sanitize",value:function(){var e=this,t=e.timeSpan,n=t&&t.startDate;switch(e.beginBatch(),e.isSanitizing=!0,e.frequency){case"DAILY":e.positions=null,e.days=null,e.monthDays=null,e.months=null;break;case"WEEKLY":e.positions=null,e.monthDays=null,e.months=null;var r=e.days;n&&r&&1==r.length&&r[0]==yD.encodeDay(n.getDay())&&(e.days=null);break;case"MONTHLY":e.monthDays&&e.monthDays.length&&(e.positions=null,e.days=null),e.months=null;var i=e.monthDays;n&&i&&1==i.length&&i[0]==n.getDate()&&(e.monthDays=null);break;case"YEARLY":e.monthDays=null;var o=e.months;n&&o&&1==o.length&&o[0]==n.getMonth()+1&&(e.months=null)}e.isSanitizing=!1,e.endBatch()}},{key:"copy",value:function(){for(var e,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];var o=(e=we()(pe()(n.prototype),"copy",this)).call.apply(e,[this].concat(r));return o.dateFormat=this.dateFormat,o.timeSpan=this.timeSpan,o}},{key:"afterChange",value:function(e,t,r){var i=we()(pe()(n.prototype),"afterChange",this).call(this,e,t,r),o=this.timeSpan;if(this.isSanitizing||this.sanitize(),o){if("endDate"in t){var a=Zt.clearTime(t.endDate.value),s=o.exceptionDates;if(o.removeOccurrencesFrom(a),s)for(var u in s){Zt.parseKey(u)>=a&&delete s[u]}}this.isTimeSpanNotifyingSuspended||o.onRecurrenceChanged()}return i}},{key:"suspendTimeSpanNotifying",value:function(){this._suspendedTimeSpanNotifying++}},{key:"resumeTimeSpanNotifying",value:function(){this._suspendedTimeSpanNotifying&&this._suspendedTimeSpanNotifying--}},{key:"isRecurrenceModel",get:function(){return!0}},{key:"dateFormat",get:function(){return this._dateFormat||"YYYYMMDDTHHmmss"},set:function(e){this._dateFormat=e}},{key:"recurrenceIterator",get:function(){return FD[this.frequency]}},{key:"timeSpan",get:function(){return this._timeSpan},set:function(e){this._timeSpan=e}},{key:"rule",get:function(){var e=this,t=[];return e.frequency&&(t.push("FREQ=".concat(e.frequency)),e.interval>1&&t.push("INTERVAL=".concat(e.interval)),e.days&&e.days.length&&t.push("BYDAY="+e.days.join(",")),e.monthDays&&e.monthDays.length&&t.push("BYMONTHDAY="+e.monthDays.join(",")),e.months&&e.months.length&&t.push("BYMONTH="+e.months.join(",")),e.count&&t.push("COUNT=".concat(e.count)),e.endDate&&t.push("UNTIL="+Zt.format(e.endDate,e.dateFormat)),e.positions&&e.positions.length&&t.push("BYSETPOS="+e.positions.join(","))),t.join(";")},set:function(e){var t=this;if(t.beginBatch(),e){for(var n=e.split(";"),r=0,i=n.length;r<i;r++){var o=n[r].split("="),a=o[1];switch(o[0]){case"FREQ":t.frequency=a;break;case"INTERVAL":t.interval=a;break;case"COUNT":t.count=a,t.until=null;break;case"UNTIL":t.endDate=a?Zt.parse(a,t.dateFormat):null,t.count=null;break;case"BYDAY":t.days=a;break;case"BYMONTHDAY":t.monthDays=a;break;case"BYMONTH":t.months=a;break;case"BYSETPOS":t.positions=a}}t.sanitize()}else t.set({frequency:null,interval:null,count:null,endDate:null,days:null,monthDays:null,months:null,positions:null});t.endBatch()}},{key:"count",get:function(){return this.get("count")},set:function(e){e&&(this.endDate=null),this.set("count",e)}},{key:"endDate",get:function(){return this.get("endDate")},set:function(e){e&&(this.count=null),this.set("endDate",e)}},{key:"isTimeSpanNotifyingSuspended",get:function(){return Boolean(this._suspendedTimeSpanNotifying)}}],[{key:"fields",get:function(){return[{name:"frequency",defaultValue:"DAILY"},{name:"interval",defaultValue:1,convert:BD},{name:"endDate",type:"date"},{name:"count",allowNull:!0,convert:BD},{name:"days",convert:jD,isEqual:_D},{name:"monthDays",convert:LD,isEqual:_D},{name:"months",convert:LD,isEqual:_D},{name:"positions",convert:LD,isEqual:_D}]}}]),n}(Bi);function $D(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}HD._$name="RecurrenceModel";function ND(e){var t={},n=this.dateFormat;return e&&(e="string"==typeof e?e.split(","):Array.isArray(e)?e:[e]).forEach((function(e){"string"==typeof e&&(e=Zt.parse(e,n)),isNaN(e)||(t[Zt.makeKey(e)]=1)})),t}function VD(e){var t=[],n=this.dateFormat;for(var r in e)e[r]&&t.push(Zt.format(Zt.parseKey(r),n));return t}var zD=[],WD=function(e){return function(e){fe()(n,e);var t=$D(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"remove",value:function(){if(!this.isOccurrence)return we()(pe()(n.prototype),"remove",this).apply(this,arguments);this.cancelBatch(),this.detachFromRecurringEvent()}},{key:"setRecurrence",value:function(e,t,n){var r;e&&(e.isRecurrenceModel||("string"==typeof e&&(e={frequency:e},t&&(e.interval=t),n&&(n instanceof Date?e.endDate=n:e.count=n)),e=new this.recurrenceModel(e)),e.timeSpan=this,r=e.rule),this.recurrence=e,this.recurrenceRule=r}},{key:"getOccurrencesForDateRange",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e;return this.eventStore.getOccurrencesForTimeSpan(this,e,t)}},{key:"removeOccurrence",value:function(e){var t,n=e.isTimeSpan?e.occurrenceDate:e;null===(t=this.eventStore)||void 0===t||t.globalOccurrences.delete(this.createRecurrenceKey(n)),this.occurrenceMap.delete(Zt.makeKey(n))}},{key:"removeOccurrencesFrom",value:function(e){var t=this;this.occurrenceMap.forEach((function(n,r){Zt.parseKey(r)>=e&&t.removeOccurrence(n)}))}},{key:"removeOccurrences",value:function(){var e=this;[this].concat(d()(this.occurrences)).forEach((function(t){return e.removeOccurrence(t)}))}},{key:"onRecurrenceChanged",value:function(){var e;this.recurrenceRule=(null===(e=this.recurrence)||void 0===e?void 0:e.rule)||null}},{key:"buildOccurrence",value:function(e,t){var n,r=this,i=r.occurrenceMap,o=r.recurrence,a=r.meta,s=null===(n=r.eventStore)||void 0===n?void 0:n.globalOccurrences,u=r.createRecurrenceKey(e),c=!(e-r.startDate),l=r.constructor.fieldMap,f=null==s?void 0:s.get(u),d=r.duration;!r.endDate||!r.allDay&&d||(d=Zt.as(r.durationUnit,r.endDate.getTime()-r.startDate.getTime()));var h=void 0!==d?Zt.add(e,d,r.durationUnit):void 0;if(!f){var v;if(t||c)f=r,c||(r.setStartEndDate(e,h,!0),o.suspendTimeSpanNotifying(),o.sanitize(),o.resumeTimeSpanNotifying()),a.isSyncedWithRule=!0;else(f=r.copy((v={},ke()(v,l.id.dataSource,u),ke()(v,l.startDate.dataSource,e),ke()(v,l.endDate.dataSource,h),ke()(v,l.duration.dataSource,d),v))).recurringTimeSpan=r;null==s||s.set(u,f),i.set(Zt.makeKey(e),f)}return f}},{key:"createRecurrenceKey",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.startDate;return"_generated:".concat(this.id,":").concat(Zt.format(e,"YYYYMMDD"))}},{key:"afterChange",value:function(e,t,r){var i,o=this,a=o.eventStore;if("recurrenceRule"in t&&(o._recurrence=null,null==a||a.recurringEvents[t.recurrenceRule.value?"add":"delete"](o)),o.isOccurrence){var s,u=o.recurringTimeSpan,c=o.resource,l=(null===(s=t.startDate)||void 0===s?void 0:s.value)||o.startDate;u.beginBatch(),o.detachFromRecurringEvent(),o.clearChanges(),o.setData("id",o.generateId(u.eventStore)),u.eventStore.add(o,!0),o.startDate=l,"resourceId"in o.data||o.assign(c),u.endBatch()}else"newExceptionDate"in t&&(o.meta.modified.exceptionDates=!0,delete o.meta.modified.newExceptionDate,o.removeOccurrence(t.newExceptionDate.value));for(var f=arguments.length,d=new Array(f>3?f-3:0),h=3;h<f;h++)d[h-3]=arguments[h];return(i=we()(pe()(n.prototype),"afterChange",this)).call.apply(i,[this,e,t,r].concat(d))}},{key:"detachFromRecurringEvent",value:function(){var e=this,t=e.recurringTimeSpan,n=e.occurrenceDate,r=e.startDate;e.recurringTimeSpan=null,t.addExceptionDate(n),e.recurrenceRule&&(t.recurrence.endDate=Zt.add(r,-1,"minute"))}},{key:"addExceptionDate",value:function(e){return this.set({newExceptionDate:e})}},{key:"hasException",value:function(e){var t;return null===(t=this.exceptionDates)||void 0===t?void 0:t[Zt.makeKey(e)]}},{key:"supportsRecurring",get:function(){return!0}},{key:"eventStore",get:function(){var e,t=this.isOccurrence?this.recurringEvent.eventStore:we()(pe()(n.prototype),"eventStore",this);return!t&&(null===(e=this.firstStore)||void 0===e?void 0:e.isRecurringTimeSpansMixin)&&(t=this.firstStore),t}},{key:"recurrenceModel",get:function(){return this._recurrenceModel||HD},set:function(e){this._recurrenceModel=e}},{key:"recurrence",get:function(){var e=this,t=e.recurrenceRule;return!e._recurrence&&t&&(e._recurrence=new e.recurrenceModel({rule:t,timeSpan:e,id:"".concat(e.id,"-recurrence")})),e._recurrence},set:function(e){var t=this;t._recurrence=e,e?(e.timeSpan=t,t.recurrenceRule=e.rule):t.isOccurrence?t.setData("recurrenceRule",null):t.recurrenceRule=null}},{key:"isRecurring",get:function(){return Boolean(!this.isOccurrence&&this.recurrence)}},{key:"isOccurrence",get:function(){return Boolean(this.recurringTimeSpan)}},{key:"recurringTimeSpan",get:function(){return this._recurringTimeSpan},set:function(e){this._recurringTimeSpan=e}},{key:"isPersistable",get:function(){return!this.supportsRecurring||!this.isOccurrence}},{key:"occurrences",get:function(){var e=this;if(this.isRecurring){var t=[];return this.occurrenceMap.forEach((function(n){n!==e&&t.push(n)})),t}return zD}},{key:"occurrenceMap",get:function(){return this._occurrencesMap||(this._occurrencesMap=new Map)}},{key:"occurrenceDate",get:function(){var e;return(null===(e=this.meta.modified)||void 0===e?void 0:e.startDate)||this.startDate}},{key:"newExceptionDate",set:function(e){e&&((this.exceptionDates||(this.exceptionDates={}))[Zt.makeKey(e)]=1)}}],[{key:"$name",get:function(){return"RecurringTimeSpan"}},{key:"fields",get:function(){return[{name:"recurrenceRule"},{name:"exceptionDates",convert:ND,serialize:VD}]}}]),n}(e||Qy)};function GD(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return YD(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return YD(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function YD(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function UD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var qD=function(e){return function(e){fe()(n,e);var t=UD(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"forEachResource",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,r=GD(this.resources);try{for(r.s();!(t=r.n()).done;){var i=t.value;if(!1===e.call(n,i))return}}catch(e){r.e(e)}finally{r.f()}}},{key:"getResource",value:function(e){return null==e?this.resource:this.resourceStore?this.resourceStore.getById(e):null}},{key:"applyResourceId",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r=n.assignments,i=n.assignmentStore,o=n.eventStore;if(o)if(null!=e)if(n.skipEnforcingSingleAssignment||(o.usesSingleAssignment=!0),(null==r?void 0:r.length)&&e!==r[0].resourceId){var a=Boolean(o.eventsSuspended);a&&i.suspendEvents(),r[0].resource=e,a&&i.resumeEvents()}else i.assignEventToResource(n,e);else i.remove(n.assignments);else t||n.set({resourceId:e})}},{key:"applyValue",value:function(e,t,r,i,o){if(o&&"resourceId"===o.name&&!this.meta.isAssigning){var a=this.eventStore;a&&(a.isAssigning=!0),this.applyResourceId(r,!0),a&&(a.isAssigning=!1)}we()(pe()(n.prototype),"applyValue",this).call(this,e,t,r,i,o)}},{key:"assign",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.eventStore;n&&!n.usesSingleAssignment?n.assignEventToResource(this,e,t):(this.resourceId=this.constructor.asId(e),n||(this.meta.skipEnforcingSingleAssignment=!0))}},{key:"unassign",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=this;e=r.constructor.asId(e),r.meta.removingResource=n,null===(t=r.eventStore)||void 0===t||t.unassignEventFromResource(r,e),r.meta.removingResource=null}},{key:"reassign",value:function(e,t){this.eventStore&&this.eventStore.reassignEventFromResourceToResource(this,e,t)}},{key:"isAssignedTo",value:function(e){var t=this.constructor.asId(e);return this.assignments.some((function(e){return e.resourceId===t}))}},{key:"normalize",value:function(){}},{key:"inSetNormalize",value:function(){}},{key:"resources",get:function(){return this.assignments.reduce((function(e,t){return t.resource&&e.push(t.resource),e}),[])},set:function(e){Array.isArray(e)||(e=[e]);var t=this,n=e.map(t.constructor.asId),r=t.assignments.map((function(e){return e.resource.id})),i=De.delta(n,r),o=i.onlyInA,a=i.onlyInB;t.assignmentStore.add(o.map((function(e){return{resource:e,event:t}}))),t.assignmentStore.remove(a.map((function(e){return t.assignments.find((function(t){return t.resource.id===e}))})))}},{key:"startDate",get:function(){var e=we()(pe()(n.prototype),"startDate",this);return this.isOccurrence&&(e=this.get("startDate")),this.allDay&&(e=this.constructor.getAllDayStartDate(e)),e},set:function(e){this.batching?this.set({startDate:e}):sc()(pe()(n.prototype),"startDate",e,this,!0)}},{key:"endDate",get:function(){var e=we()(pe()(n.prototype),"endDate",this);return this.isOccurrence&&(e=this.get("endDate")),this.allDay&&(e=this.constructor.getAllDayEndDate(e)),e},set:function(e){this.batching?this.set({endDate:e}):sc()(pe()(n.prototype),"endDate",e,this,!0)}},{key:"isEvent",get:function(){return!0}},{key:"isDraggable",get:function(){return this.draggable}},{key:"isResizable",get:function(){return!this.isMilestone&&this.resizable}},{key:"isPersistable",get:function(){return we()(pe()(n.prototype),"isPersistable",this)}},{key:"usesSingleAssignment",get:function(){return!this.eventStore||this.eventStore.usesSingleAssignment}},{key:"persistableData",get:function(){var e=we()(pe()(n.prototype),"persistableData",this);return this.usesSingleAssignment||delete e.resourceId,e}},{key:"resource",get:function(){var e=this.resources;return e.length?e[0]:null},set:function(e){this.resourceId=this.constructor.asId(e)}},{key:"resourceId",get:function(){var e;return this.usesSingleAssignment?this.get("resourceId"):null===(e=this.resource)||void 0===e?void 0:e.id},set:function(e){this.applyResourceId(e)}},{key:"assignments",get:function(){return d()(this.assigned||[])}},{key:"predecessors",get:function(){return d()(this.incomingDeps)}},{key:"successors",get:function(){return d()(this.outgoingDeps)}},{key:"dependencies",get:function(){return[].concat(d()(this.incomingDeps),d()(this.outgoingDeps))}},{key:"recurringEvent",get:function(){return this.recurringTimeSpan}},{key:"isInterDay",get:function(){var e=this.durationMS;if(e>=864e5)return!0;var t=this.endDate,n=this.startDate,r=Zt.clearTime(n);return r.setDate(r.getDate()+1),(t||Zt.add(n,e))>r}}],[{key:"getAllDayStartDate",value:function(e){return e&&e.isEvent&&(e=e.get("startDate")),e&&(e=Zt.clearTime(e,!0)),e}},{key:"getAllDayEndDate",value:function(e){return e&&e.isEvent&&(e=e.get("endDate")),e&&(e.getHours()>0||e.getMinutes()>0||e.getSeconds()>0||e.getMilliseconds()>0)&&(e=Zt.getNext(e,"d",1)),e}},{key:"getAllDayDisplayStartDate",value:function(e){return e&&e.isEvent&&(e=e.get("startDate")),Zt.clearTime(e,!0)}},{key:"getAllDayDisplayEndDate",value:function(e,t){return e&&e.isEvent&&(t=e.get("endDate"),e=e.get("startDate")),t&&(e=this.constructor.getAllDayDisplayStartDate(e),Zt.clearTime(t,!0).valueOf()===t.valueOf()?t=Zt.add(t,Zt.DAY,-1):e.valueOf()!==t.valueOf()&&(t=Zt.clearTime(t,!0))),t}},{key:"$name",get:function(){return"EventModelMixin"}},{key:"isEventModel",get:function(){return!0}},{key:"fields",get:function(){return["resourceId",{name:"draggable",type:"boolean",persist:!1,defaultValue:!0},{name:"resizable",persist:!1,defaultValue:!0},{name:"allDay",defaultValue:!1},"eventStyle","eventColor","milestoneWidth"]}}]),n}(e)},KD=(Symbol("RequiredProperties"),sk()),XD=sk();function ZD(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return JD(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return JD(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function JD(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function QD(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var eR,tR=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":l()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},nR=0,rR=nR++,iR=function(e){fe()(n,e);var t=QD(n);function n(){var e;return v()(this,n),(e=t.apply(this,arguments)).formulaId=nR++,e.inputs=new Set,e}return n}(qm),oR=function(e){fe()(n,e);var t=QD(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"collectNext",value:function(e,t){if(e instanceof iR)t.push({node:e.output,from:e,label:void 0});else{var n=this.cache.formulasByInput.get(e);n&&n.forEach((function(n){return t.push({node:n,from:e,label:void 0})}))}}}]),n}(Qk),aR=function(e){fe()(n,e);var t=QD(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([qm],(function(e){return function(e){fe()(n,e);var t=QD(n);function n(){var e;return v()(this,n),(e=t.apply(this,arguments)).variables=new Set,e.formulas=new Set,e.$formulasByInput=void 0,e.$formulasByOutput=void 0,e}return g()(n,[{key:"add",value:function(e){this.$formulasByInput=void 0,this.$formulasByOutput=void 0,this.formulas.add(e)}},{key:"has",value:function(e){return this.formulas.has(e)}},{key:"fillCache",value:function(){var e=this;this.$formulasByInput=new Map,this.$formulasByOutput=new Map,this.formulas.forEach((function(t){var n=e.$formulasByOutput.get(t.output);n||(n=new Set,e.$formulasByOutput.set(t.output,n)),n.add(t),t.inputs.forEach((function(n){var r=e.$formulasByInput.get(n);r||(r=new Set,e.$formulasByInput.set(n,r)),r.add(t)}))}))}},{key:"allInputVariables",value:function(){return Rm(Mm(Dm(this.formulas,(function(e){return e.inputs.values()}))))}},{key:"isCyclic",value:function(){var e=!1;return oR.new({cache:this,onCycle:function(){return e=!0,Zk.Cancel}}).startFrom(Array.from(this.allInputVariables())),e}},{key:"formulasByInput",get:function(){return void 0!==this.$formulasByInput||this.fillCache(),this.$formulasByInput}},{key:"formulasByOutput",get:function(){return void 0!==this.$formulasByOutput||this.fillCache(),this.$formulasByOutput}}]),n}(e)}))),sR=function(e){fe()(n,e);var t=QD(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(aR),uR=function(e){fe()(n,e);var t=QD(n);function n(){var e;return v()(this,n),(e=t.apply(this,arguments)).description=void 0,e.defaultResolutionFormulas=new Set,e.resolutionsByInputHash=new Map,e}return g()(n,[{key:"clear",value:function(){this.resolutionsByInputHash.clear()}},{key:"resolve",value:function(e){var t=this.resolutionsByInputHash.get(e.hash);if(void 0!==t)return t;var n=this.buildResolution(e);return this.resolutionsByInputHash.set(e.hash,n),n}},{key:"buildResolution",value:function(e){var t=lR.new({context:this,input:e}),n=Array.from(t.next()).map((function(e){return{resolution:e.asResolution(),nbrOfDefaultFormulas:Array.from(e.activatedFormulas.formulas).reduce((function(t,n){return e.formulaIsDefault(n)?t+1:t}),0),unCoveredInputWeight:e.unCoveredInputWeight()}}));if(n.sort((function(e,t){return e.unCoveredInputWeight<t.unCoveredInputWeight?-1:e.unCoveredInputWeight>t.unCoveredInputWeight?1:t.nbrOfDefaultFormulas-e.nbrOfDefaultFormulas})),n.length>0)return n[0].resolution}}]),n}(qm);!function(e){e[e.NoInput=0]="NoInput",e[e.HasPreviousValue=1]="HasPreviousValue",e[e.HasProposedValue=2]="HasProposedValue",e[e.KeepIfPossible=4]="KeepIfPossible"}(eR||(eR={}));var cR=function(e){fe()(n,e);var t=QD(n);function n(){var e;return v()(this,n),(e=t.apply(this,arguments)).context=void 0,e.input=void 0,e.$hash="",e}return g()(n,[{key:"initialize",value:function(){for(var e,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];(e=we()(pe()(n.prototype),"initialize",this)).call.apply(e,[this].concat(r)),XD(this),this.input=new Map(Pm(this.description.variables).map((function(e){return[e,eR.NoInput]})))}},{key:"buildHash",value:function(){var e=this;return String.fromCharCode.apply(String,d()(Pm(this.description.variables).inBatchesBySize(5).map((function(t){return e.batchToCharCode(t)}))))}},{key:"batchToCharCode",value:function(e){var t=this;return e.reduceRight((function(e,n,r){return e|t.input.get(n)<<3*r}),0)}},{key:"addProposedValueFlag",value:function(e){var t=this.input.get(e);this.input.set(e,t|eR.HasProposedValue)}},{key:"hasProposedValue",value:function(e){return Boolean(this.input.get(e)&eR.HasProposedValue)}},{key:"hasProposedValueVars",value:function(){var e=this;return Pm(this.description.variables).filter((function(t){return e.hasProposedValue(t)}))}},{key:"addPreviousValueFlag",value:function(e){var t=this.input.get(e);this.input.set(e,t|eR.HasPreviousValue)}},{key:"hasPreviousValue",value:function(e){return Boolean(this.input.get(e)&eR.HasPreviousValue)}},{key:"hasPreviousValueVars",value:function(){var e=this;return Pm(this.description.variables).filter((function(t){return e.hasPreviousValue(t)}))}},{key:"addKeepIfPossibleFlag",value:function(e){var t=this.input.get(e);this.input.set(e,t|eR.KeepIfPossible)}},{key:"keepIfPossible",value:function(e){return Boolean(this.input.get(e)&eR.KeepIfPossible)}},{key:"keepIfPossibleVars",value:function(){var e=this;return Pm(this.description.variables).filter((function(t){return e.keepIfPossible(t)}))}},{key:"hash",get:function(){return""!==this.$hash?this.$hash:this.$hash=this.buildHash()}},{key:"description",get:function(){return this.context.description}},{key:"resolution",get:function(){return this.context.resolve(this)}}]),n}(qm);tR([KD],cR.prototype,"context",void 0);var lR=function(e){fe()(n,e);var t=QD(n);function n(){var e;return v()(this,n),(e=t.apply(this,arguments)).context=void 0,e.input=void 0,e.previous=void 0,e.activatedFormula=void 0,e.$activatedFormulas=void 0,e}return g()(n,[{key:"thisAndPreviousStates",value:Vr.a.mark((function e(){var t;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this;case 1:if(!t||!t.activatedFormula){e.next=7;break}return e.next=4,t;case 4:t=t.previous,e.next=1;break;case 7:case"end":return e.stop()}}),e,this)}))},{key:"formulaHasProposedValueInInput",value:function(e){var t=this;return Array.from(e.inputs).some((function(e){return t.input.hasProposedValue(e)}))}},{key:"unCoveredInputWeight",value:function(){var e=this,t=Dm(this.input.hasProposedValueVars(),(function(e){return{variable:e,isProposed:!0}})),n=Dm(this.input.keepIfPossibleVars(),(function(e){return{variable:e,isProposed:!1}}));return Pm([t,n]).concat().uniqueOnlyBy((function(e){return e.variable})).reduce((function(t,n){var r=n.variable,i=n.isProposed,o=0,a=e.activatedFormulas.formulasByOutput.get(r);if(a){var s=1===a.size?Array.from(a)[0]:null;s&&e.formulaIsDefault(s)&&e.formulaHasProposedValueInInput(s)?o+=i?1e6:1e4:o+=i?1e7:1e5}var u=e.activatedFormulas.formulasByInput.get(r);return u&&u.size>0||(o+=i?1e3:100),t+o}),0)}},{key:"preferFormula",value:function(e,t){var n=this.formulaAllInputsHasProposed(e),r=this.formulaAllInputsHasProposed(t);if(n&&!r)return-1;if(r&&!n)return 1;var i=this.formulaCountInputsWithProposedOrKeep(e),o=this.formulaCountInputsWithProposedOrKeep(t);return i>o?-1:i<o?1:this.formulaIsDefault(e)&&!this.formulaIsDefault(t)?-1:this.formulaIsDefault(t)&&!this.formulaIsDefault(e)?1:0}},{key:"formulaIsDefault",value:function(e){return this.context.defaultResolutionFormulas.has(e)}},{key:"formulaCountInputsWithProposedOrKeep",value:function(e){var t=this,n=0;return Array.from(e.inputs).forEach((function(e){(t.input.hasProposedValue(e)||t.input.keepIfPossible(e))&&n++})),n}},{key:"formulaAllInputsHasProposedOrKeep",value:function(e){var t=this;return Array.from(e.inputs).every((function(e){return t.input.hasProposedValue(e)||t.input.keepIfPossible(e)}))}},{key:"formulaAllInputsHasProposed",value:function(e){var t=this;return Array.from(e.inputs).every((function(e){return t.input.hasProposedValue(e)}))}},{key:"formulaIsApplicable",value:function(e){var t=this,n=Array.from(e.inputs).every((function(e){return t.input.hasProposedValue(e)||t.input.hasPreviousValue(e)||t.activatedFormulas.formulasByOutput.has(e)})),r=aR.new({formulas:new Set(this.activatedFormulas.formulas)});return r.add(e),n&&!r.isCyclic()}},{key:"formulaIsInsignificant",value:function(e){var t=this,n=this.activatedFormulas.formulasByOutput.has(e.output),r=this.input.hasPreviousValue(e.output);return n||r&&Array.from(e.inputs).some((function(e){return!t.input.hasPreviousValue(e)&&!t.input.hasProposedValue(e)}))}},{key:"unvisitedFormulas",value:function(){var e=this;return Array.from(this.description.formulas).filter((function(t){return!e.activatedFormulas.has(t)}))}},{key:"next",value:Vr.a.mark((function e(){var t,r,i,o,a,s;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=this.unvisitedFormulas()).sort(this.preferFormula.bind(this)),r=!0,i=ZD(t),e.prev=4,i.s();case 6:if((o=i.n()).done){e.next=15;break}if(a=o.value,this.formulaIsApplicable(a)&&!this.formulaIsInsignificant(a)){e.next=10;break}return e.abrupt("continue",13);case 10:return s=n.new({previous:this,context:this.context,input:this.input,activatedFormula:a}),e.delegateYield(s.next(),"t0",12);case 12:r=!1;case 13:e.next=6;break;case 15:e.next=20;break;case 17:e.prev=17,e.t1=e.catch(4),i.e(e.t1);case 20:return e.prev=20,i.f(),e.finish(20);case 23:if(!r){e.next=26;break}return e.next=26,this;case 26:case"end":return e.stop()}}),e,this,[[4,17,20,23]])}))},{key:"asResolution",value:function(){var e=this;return new Map(Pm(this.description.variables).map((function(t){var n=e.activatedFormulas.formulasByOutput.get(t);if(n){var r,i=ZD(n);try{for(i.s();!(r=i.n()).done;){return[t,r.value.formulaId]}}catch(e){i.e(e)}finally{i.f()}}return[t,rR]})))}},{key:"activatedFormulas",get:function(){if(void 0!==this.$activatedFormulas)return this.$activatedFormulas;var e=aR.new({variables:this.description.variables,formulas:Pm(this.thisAndPreviousStates()).map((function(e){return e.activatedFormula})).toSet()});return this.$activatedFormulas=e}},{key:"description",get:function(){return this.context.description}}]),n}(qm);function fR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var dR=function(e){fe()(n,e);var t=fR(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"collectInfo",value:function(e,t,n){null!=e(function(e){return Ek.new({identifier:e})}(t))&&this.addPreviousValueFlag(n),e(Pk(t))&&this.addProposedValueFlag(n)}}]),n}(cR);function hR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var vR;!function(e){e.KeepDuration="KeepDuration",e.KeepStartDate="KeepStartDate",e.KeepEndDate="KeepEndDate"}(vR||(vR={}));var pR=Symbol("StartDate"),gR=Symbol("EndDate"),yR=Symbol("Duration"),mR=iR.new({output:pR,inputs:new Set([yR,gR])}),kR=iR.new({output:gR,inputs:new Set([yR,pR])}),bR=iR.new({output:yR,inputs:new Set([pR,gR])}),wR=sR.new({variables:new Set([pR,gR,yR]),formulas:new Set([mR,kR,bR])}),CR=uR.new({description:wR,defaultResolutionFormulas:new Set([kR])}),SR=uR.new({description:wR,defaultResolutionFormulas:new Set([mR])}),DR=function(e){fe()(n,e);var t=hR(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"addInstruction",value:function(e){e===vR.KeepStartDate&&this.addKeepIfPossibleFlag(pR),e===vR.KeepEndDate&&this.addKeepIfPossibleFlag(gR),e===vR.KeepDuration&&this.addKeepIfPossibleFlag(yR)}}]),n}(dR),RR=function(e){fe()(n,e);var t=hR(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"equality",value:function(e,t){var n=e.resolution,r=t.resolution;return n.get(pR)===r.get(pR)&&n.get(gR)===r.get(gR)&&n.get(yR)===r.get(yR)}}]),n}(Zb.mix(kb));function xR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var ER=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":l()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},TR=function(e){fe()(n,e);var t=xR(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([_S],(function(e){e.prototype;var t,n=function(e){fe()(n,e);var t=xR(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"calculateDispatcher",value:Vr.a.mark((function e(t){var n,r,i,o,a,s,u,c;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,vk;case 2:return e.sent,e.delegateYield(this.prepareDispatcher(t),"t0",4);case 4:return n=e.t0,e.next=7,_k(this.$.startDate);case 7:return r=e.sent,(i=r?r[0]?vR.KeepDuration:vR.KeepEndDate:void 0)&&n.addInstruction(i),e.next=12,_k(this.$.endDate);case 12:return o=e.sent,(a=o?o[0]?vR.KeepDuration:vR.KeepStartDate:void 0)&&n.addInstruction(a),e.next=17,this.$.direction;case 17:return s=e.sent,e.next=20,_k(this.$.duration);case 20:if(!(u=e.sent)){e.next=29;break}e.t1=u[0],e.next=!0===e.t1?25:!1===e.t1?27:29;break;case 25:return c=vR.KeepStartDate,e.abrupt("break",29);case 27:return c=vR.KeepEndDate,e.abrupt("break",29);case 29:return!c&&n.hasProposedValue(yR)&&(c=s===nS.Forward||s===nS.None?vR.KeepStartDate:vR.KeepEndDate),c&&n.addInstruction(c),e.abrupt("return",n);case 32:case"end":return e.stop()}}),e,this)}))},{key:"prepareDispatcher",value:Vr.a.mark((function e(t){var n,r;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.dispatcherClass(t),(r=n.new({context:this.cycleResolutionContext(t)})).collectInfo(t,this.$.startDate,pR),r.collectInfo(t,this.$.endDate,gR),r.collectInfo(t,this.$.duration,yR),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e,this)}))},{key:"cycleResolutionContext",value:function(e){var t=e(this.$.direction);return t===nS.Forward||t===nS.None?CR:SR}},{key:"dispatcherClass",value:function(e){return DR}},{key:"buildProposedDispatcher",value:function(e,t,n){var r=this.dispatcherClass(n.onEffectSync).new({context:this.cycleResolutionContext(n.onEffectSync)});return r.addPreviousValueFlag(pR),r.addPreviousValueFlag(gR),r.addPreviousValueFlag(yR),r}},{key:"skipNonWorkingTime",value:Vr.a.mark((function e(t,n){var r,i;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.effectiveCalendar;case 2:if(r=e.sent,t){e.next=5;break}return e.abrupt("return",null);case 5:if(!((i=r.skipNonWorkingTime(t,n))instanceof Date)){e.next=10;break}return e.abrupt("return",i);case 10:return e.next=12,yk("Empty calendar");case 12:case"end":return e.stop()}}),e,this)}))},{key:"skipWorkingTime",value:Vr.a.mark((function e(t,n,r,i){var o;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.durationUnit;case 2:if(o=e.sent,!i||i===o){e.next=6;break}return e.delegateYield(this.getProject().$convertDuration(r,i,o),"t0",5);case 5:r=e.t0;case 6:return e.delegateYield(this.calculateProjectedXDateWithDuration(t,n,r),"t1",7);case 7:return e.abrupt("return",e.t1);case 8:case"end":return e.stop()}}),e,this)}))},{key:"setStartDate",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(this.graph)return this.graph.write(this.$.startDate,e,t),this.graph.commitAsync();this.$.startDate.DATA=e}},{key:"writeStartDate",value:function(e,t,n,r){var i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];if(t.baseRevision.hasIdentifier(e)||null!=r){i?vR.KeepDuration:vR.KeepEndDate;e.constructor.prototype.write.call(this,e,t,n,r,i)}}},{key:"calculateStartDate",value:Vr.a.mark((function e(){var t,n;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.dispatcher;case 2:if(t=e.sent,(n=t.resolution.get(pR))!==rR){e.next=9;break}return e.delegateYield(this.calculateStartDateProposed(),"t0",6);case 6:return e.abrupt("return",e.t0);case 9:if(n!==mR.formulaId){e.next=14;break}return e.delegateYield(this.calculateStartDatePure(),"t1",11);case 11:return e.abrupt("return",e.t1);case 14:throw new Error("Unknown formula for `startDate`");case 15:case"end":return e.stop()}}),e,this)}))},{key:"calculateStartDatePure",value:Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=this,e.next=3,this.$.endDate;case 3:return e.t1=e.sent,e.next=6,this.$.duration;case 6:return e.t2=e.sent,e.delegateYield(e.t0.calculateProjectedXDateWithDuration.call(e.t0,e.t1,!1,e.t2),"t3",8);case 8:return e.abrupt("return",e.t3);case 9:case"end":return e.stop()}}),e,this)}))},{key:"calculateStartDateProposed",value:Vr.a.mark((function e(){var t;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,vk;case 2:return t=e.sent,e.delegateYield(this.skipNonWorkingTime(t,!0),"t0",4);case 4:return e.abrupt("return",e.t0);case 5:case"end":return e.stop()}}),e,this)}))},{key:"calculateProjectedXDateWithDuration",value:Vr.a.mark((function e(t,n,r){var i,o,a;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.durationUnit;case 2:return i=e.sent,e.next=5,this.$.effectiveCalendar;case 5:if(o=e.sent,a=this.getProject(),t&&(s=r,Number(s)===s)){e.next=9;break}return e.abrupt("return",null);case 9:if(!(n=void 0===n||n)){e.next=18;break}return e.t0=o,e.t1=t,e.delegateYield(a.$convertDuration(r,i,KC.Millisecond),"t2",14);case 14:return e.t3=e.t2,e.abrupt("return",e.t0.calculateEndDate.call(e.t0,e.t1,e.t3));case 18:return e.t4=o,e.t5=t,e.delegateYield(a.$convertDuration(r,i,KC.Millisecond),"t6",21);case 21:return e.t7=e.t6,e.abrupt("return",e.t4.calculateStartDate.call(e.t4,e.t5,e.t7));case 23:case"end":return e.stop()}var s}),e,this)}))},{key:"setEndDate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.graph)return this.graph.write(this.$.endDate,e,t),this.graph.commitAsync();this.$.endDate.DATA=e}},{key:"writeEndDate",value:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]&&arguments[4];(t.baseRevision.hasIdentifier(e)||null!=r)&&e.constructor.prototype.write.call(this,e,t,n,r,i)}},{key:"calculateEndDate",value:Vr.a.mark((function e(){var t,n;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.dispatcher;case 2:if(t=e.sent,(n=t.resolution.get(gR))!==rR){e.next=9;break}return e.delegateYield(this.calculateEndDateProposed(),"t0",6);case 6:return e.abrupt("return",e.t0);case 9:if(n!==kR.formulaId){e.next=14;break}return e.delegateYield(this.calculateEndDatePure(),"t1",11);case 11:return e.abrupt("return",e.t1);case 14:throw new Error("Unknown formula for `endDate`");case 15:case"end":return e.stop()}}),e,this)}))},{key:"calculateEndDatePure",value:Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.t0=this,e.next=3,this.$.startDate;case 3:return e.t1=e.sent,e.next=6,this.$.duration;case 6:return e.t2=e.sent,e.delegateYield(e.t0.calculateProjectedXDateWithDuration.call(e.t0,e.t1,!0,e.t2),"t3",8);case 8:return e.abrupt("return",e.t3);case 9:case"end":return e.stop()}}),e,this)}))},{key:"calculateEndDateProposed",value:Vr.a.mark((function e(){var t;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,vk;case 2:return t=e.sent,e.delegateYield(this.skipNonWorkingTime(t,!1),"t0",4);case 4:return e.abrupt("return",e.t0);case 5:case"end":return e.stop()}}),e,this)}))},{key:"getDuration",value:function(e){var t=this.duration;return void 0!==e?this.getProject().convertDuration(t,this.durationUnit,e):t}},{key:"setDuration",value:function(e,t,n){if(this.graph){if(void 0!==e)return this.graph.write(this.$.duration,e,t,n),this.graph.commitAsync()}else this.$.duration.DATA=e,null!=t&&(this.$.durationUnit.DATA=t)}},{key:"setDurationUnit",value:function(e){throw new Error("Use `setDuration` instead")}},{key:"writeDuration",value:function(e,t,n,r,i){var o=arguments.length>5&&void 0!==arguments[5]?arguments[5]:void 0;r<0&&(r=0),(t.baseRevision.hasIdentifier(e)||null!=r)&&(e.constructor.prototype.write.call(this,e,t,n,r,o),null!=i&&t.write(this.$.durationUnit,i))}},{key:"calculateDuration",value:Vr.a.mark((function e(){var t,n;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.dispatcher;case 2:if(t=e.sent,(n=t.resolution.get(yR))!==rR){e.next=9;break}return e.delegateYield(this.calculateDurationProposed(),"t0",6);case 6:return e.abrupt("return",e.t0);case 9:if(n!==bR.formulaId){e.next=14;break}return e.delegateYield(this.calculateDurationPure(),"t1",11);case 11:return e.abrupt("return",e.t1);case 14:throw new Error("Unknown formula for `duration`");case 15:case"end":return e.stop()}}),e,this)}))},{key:"calculateDurationPure",value:Vr.a.mark((function e(){var t,n;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.startDate;case 2:return t=e.sent,e.next=5,this.$.endDate;case 5:if(n=e.sent,t&&n){e.next=8;break}return e.abrupt("return",null);case 8:if(!(t>n)){e.next=13;break}return e.next=11,Sk(this.$.duration,0,null);case 11:e.next=15;break;case 13:return e.delegateYield(this.calculateProjectedDuration(t,n),"t0",14);case 14:return e.abrupt("return",e.t0);case 15:case"end":return e.stop()}}),e,this)}))},{key:"calculateDurationProposed",value:Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,vk;case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))},{key:"calculateProjectedDuration",value:Vr.a.mark((function e(t,n,r){var i,o;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t&&n){e.next=2;break}return e.abrupt("return",null);case 2:if(r){e.next=6;break}return e.next=5,this.$.durationUnit;case 5:r=e.sent;case 6:return e.next=8,this.$.effectiveCalendar;case 8:return i=e.sent,o=this.getProject(),e.delegateYield(o.$convertDuration(i.calculateDurationMs(t,n),KC.Millisecond,r),"t0",11);case 11:return e.abrupt("return",e.t0);case 12:case"end":return e.stop()}}),e,this)}))},{key:"calculateEffectiveDuration",value:Vr.a.mark((function e(){var t,n,r;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.dispatcher;case 2:if(t=e.sent,(r=t.resolution.get(yR))!==rR){e.next=10;break}return e.next=7,this.$.duration;case 7:n=e.sent,e.next=20;break;case 10:if(r!==bR.formulaId){e.next=20;break}return e.t0=this,e.next=14,Fk(this.$.startDate);case 14:return e.t1=e.sent,e.next=17,Fk(this.$.endDate);case 17:return e.t2=e.sent,e.delegateYield(e.t0.calculateProjectedDuration.call(e.t0,e.t1,e.t2),"t3",19);case 19:n=e.t3;case 20:return e.abrupt("return",n);case 21:case"end":return e.stop()}}),e,this)}))}]),n}(e);return ER([Vw({type:"date"},{converter:Gw})],n.prototype,"startDate",void 0),ER([Vw({type:"date"},{converter:Gw})],n.prototype,"endDate",void 0),ER([Vw({type:"number",allowNull:!0})],n.prototype,"duration",void 0),ER([Vw({type:"string",defaultValue:KC.Day},{converter:Zt.normalizeUnit})],n.prototype,"durationUnit",void 0),ER([Vw({type:"string",defaultValue:nS.Forward},{sync:!0})],n.prototype,"direction",void 0),ER([lw({identifierCls:RR})],n.prototype,"dispatcher",void 0),ER([Vw({type:"boolean",defaultValue:!1})],n.prototype,"manuallyScheduled",void 0),ER([fw("dispatcher")],n.prototype,"calculateDispatcher",null),ER([(t="dispatcher",function(e,n,r){uw(e),(e.$buildProposed?e.hasOwnProperty("$buildProposed")?e.$buildProposed:e.$buildProposed=Object.create(e.$buildProposed):e.$buildProposed={})[t]=n})],n.prototype,"buildProposedDispatcher",null),ER([dw("startDate")],n.prototype,"writeStartDate",null),ER([fw("startDate")],n.prototype,"calculateStartDate",null),ER([dw("endDate")],n.prototype,"writeEndDate",null),ER([fw("endDate")],n.prototype,"calculateEndDate",null),ER([dw("duration")],n.prototype,"writeDuration",null),ER([fw("duration")],n.prototype,"calculateDuration",null),n})));function MR(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return AR(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return AR(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function AR(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function PR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var IR=function(e){fe()(n,e);var t=PR(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([oC],(function(e){var t=e.prototype;return function(e){fe()(o,e);var n,r,i=PR(o);function o(){return v()(this,o),i.apply(this,arguments)}return g()(o,[{key:"getAssignmentFor",value:function(e){var t,n=MR(this.assigned);try{for(n.s();!(t=n.n()).done;){var r=t.value;if(r.resource===e)return r}}catch(e){n.e(e)}finally{n.f()}return null}},{key:"isAssignedTo",value:function(e){return Boolean(this.getAssignmentFor(e))}},{key:"assign",value:(r=Wr()(Vr.a.mark((function e(t){var n;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.getAssignmentFor(t)){e.next=2;break}throw new Error("Resource can't be assigned twice to the same task");case 2:return n=this.project.assignmentStore.modelClass,this.addAssignment(new n({event:this,resource:t})),e.abrupt("return",this.commitAsync());case 5:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"unassign",value:(n=Wr()(Vr.a.mark((function e(t){var n;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.getAssignmentFor(t)){e.next=3;break}throw new Error("Can't unassign resource `".concat(t,"` from task `").concat(this,"` - resource is not assigned to the task!"));case 3:return this.removeAssignment(n),e.abrupt("return",this.commitAsync());case 5:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"leaveProject",value:function(){var e;if(this.assigned){var n=this.getEventStore();this.assigned.forEach((function(e){return n.assignmentsForRemoval.add(e)}))}(e=t.leaveProject).call.apply(e,[this].concat(Array.prototype.slice.call(arguments)))}},{key:"remove",value:function(){if(!this.parent)return t.remove.call(this);var e=this.getEventStore();t.remove.call(this),e&&e.afterEventRemoval()}},{key:"addAssignment",value:function(e){return this.getProject().assignmentStore.add(e),e}},{key:"removeAssignment",value:function(e){return this.getProject().assignmentStore.remove(e),e}}]),o}(e)})));function OR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var FR=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":l()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},LR=function(e){fe()(n,e);var t=OR(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([TR,IR],(function(e){e.prototype;var t=function(e){fe()(n,e);var t=OR(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"assignments",get:function(){return this.assigned?d()(this.assigned):[]}}]),n}(e);return FR([cw({},Ow)],t.prototype,"assigned",void 0),t})));function jR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var _R=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":l()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},BR=function(e){fe()(n,e);var t=jR(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([TR],(function(e){var t=e.prototype,n=function(e){fe()(r,e);var n=jR(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"leaveProject",value:function(){var e=this.getEventStore();this.outgoingDeps&&this.outgoingDeps.forEach((function(t){return e.dependenciesForRemoval.add(t)})),this.incomingDeps&&this.incomingDeps.forEach((function(t){return e.dependenciesForRemoval.add(t)})),t.leaveProject.call(this)}}]),r}(e);return _R([cw({},Ow)],n.prototype,"outgoingDeps",void 0),_R([cw({},Ow)],n.prototype,"incomingDeps",void 0),n})));function HR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var $R=function(e){fe()(n,e);var t=HR(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([TR,LR,BR],(function(e){e.prototype;return function(e){fe()(n,e);var t=HR(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(e)})));function NR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var VR=function(e){fe()(n,e);var t=NR(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([mC,IR],(function(e){var t=e.prototype;return function(e){fe()(r,e);var n=NR(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"applyValue",value:function(e,n,r,i,o){var a;"id"===n&&(null===(a=this.assigned)||void 0===a||a.forEach((function(e){return e.set("eventId",r)}))),t.applyValue.call(this,e,n,r,i,o)}},{key:"copy",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=t.copy.call(this,e,n);return(an.isObject(n)&&!n.skipFieldIdentifiers||!an.isObject(n))&&(r.$cachedAssignments=this.assigned),r}},{key:"assigned",get:function(){var e,t=null===(e=this.project)||void 0===e?void 0:e.assignmentStore.getEventsAssignments(this);return t?this.$cachedAssignments=t:this.$cachedAssignments}}]),r}(e)})));function zR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var WR=function(e){fe()(n,e);var t=zR(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([mC],(function(e){var t=e.prototype;return function(e){fe()(r,e);var n=zR(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"leaveProject",value:function(){var e=this.eventStore;this.outgoingDeps&&this.outgoingDeps.forEach((function(t){return e.dependenciesForRemoval.add(t)})),this.incomingDeps&&this.incomingDeps.forEach((function(t){return e.dependenciesForRemoval.add(t)})),t.leaveProject.call(this)}},{key:"outgoingDeps",get:function(){return this.project.dependencyStore.getOutgoingDepsForEvent(this)}},{key:"incomingDeps",get:function(){return this.project.dependencyStore.getIncomingDepsForEvent(this)}}]),r}(e)})));function GR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var YR,UR=function(e){fe()(n,e);var t=GR(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([mC,VR,WR],(function(e){e.prototype;return function(e){fe()(n,e);var t=GR(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(e)})));function qR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var KR=function(e){fe()(n,e);var t=qR(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(((null===(YR=window.bryntum)||void 0===YR?void 0:YR.useBasicEngine)?$R:UR).derive(Qy).mixin(WD,om,qD));function XR(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return ZR(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ZR(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function ZR(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function JR(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}KR.exposeProperties(),KR._$name="EventModel";var QR=function(e){fe()(n,e);var t=JR(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([tC],(function(e){var t=e.prototype;return function(e){fe()(r,e);var n=JR(r);function r(){var e;return v()(this,r),(e=n.apply(this,arguments)).assignmentsForRemoval=new Set,e.dependenciesForRemoval=new Set,e}return g()(r,[{key:"remove",value:function(e,n){var r=t.remove.call(this,e);return this.afterEventRemoval(),r}},{key:"afterEventRemoval",value:function(){var e=this.assignmentsForRemoval,t=this.dependenciesForRemoval;if(e){var n=this.getAssignmentStore();if(n&&!n.allAssignmentsForRemoval&&e.size){var r=d()(e).filter((function(e){return!n.assignmentsForRemoval.has(e)}));r.length>0&&n.remove(r)}e.clear();var i=this.getDependencyStore();if(i&&!i.allDependenciesForRemoval&&t.size){var o=d()(t).filter((function(e){return!i.dependenciesForRemoval.has(e)}));o.length>0&&i.remove(o)}t.clear()}}},{key:"removeAll",value:function(e){var n=t.removeAll.call(this,e);return this.afterEventRemoval(),n}},{key:"processRecord",value:function(e){var t;if(!(null===(t=this.project)||void 0===t?void 0:t.isRepopulatingStores)){var n=this.getById(e.id),r=n&&n!==e;if(r){var i,o=XR(n.assigned);try{for(o.s();!(i=o.n()).done;){var a=i.value;a.event=e}}catch(e){o.e(e)}finally{o.f()}}}return e}}]),r}(e)})));function ex(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var tx=function(e){fe()(n,e);var t=ex(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([QR,rC],(function(e){e.prototype;return function(e){fe()(n,e);var t=ex(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"data",set:function(e){sc()(pe()(n.prototype),"data",e,this,!0),this.afterEventRemoval()}}],[{key:"defaultConfig",get:function(){return{modelClass:$R}}}]),n}(e)}))),nx=function(e){fe()(n,e);var t=ex(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([tx],(function(e){e.prototype;return function(e){fe()(n,e);var t=ex(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"buildRootNode",value:function(){return this.getProject()||{}}}],[{key:"defaultConfig",get:function(){return{tree:!0}}}]),n}(e)})));function rx(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var ix,ox=function(e){fe()(n,e);var t=rx(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([QR,_C],(function(e){e.prototype;return function(e){fe()(n,e);var t=rx(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"joinProject",value:function(){var e;null===(e=this.assignmentStore)||void 0===e||e.linkAssignments(this,"event")}},{key:"afterLoadData",value:function(){var e;this.afterEventRemoval(),null===(e=this.assignmentStore)||void 0===e||e.linkAssignments(this,"event")}}],[{key:"defaultConfig",get:function(){return{modelClass:UR}}}]),n}(e)})));function ax(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var sx=function(e){fe()(n,e);var t=ax(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"defaultConfig",get:function(){return{modelClass:KR,defaultCalendar:null}}}]),n}(((null===(ix=window.bryntum)||void 0===ix?void 0:ix.useBasicEngine)?EC(tx.derive(Uo)):om(ox.derive(Uo))).mixin(cD,hD,sD));function ux(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}sx._$name="EventStore";var cx=["SS","SF","FS","FF"],lx=function(e){fe()(n,e);var t=ux(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e){null!=e.from&&(e.fromEvent=e.from),null!=e.to&&(e.toEvent=e.to),we()(pe()(n.prototype),"construct",this).apply(this,arguments)}},{key:"getHardType",value:function(){return this.get("type")}},{key:"setHardType",value:function(e){var t;return e!==this.getHardType()&&(t=this.set({type:e,fromSide:null,toSide:null})),t}},{key:"setLag",value:function(e,t){1!==arguments.length?(e=parseFloat(e),this.set({lag:e,lagUnit:t})):"number"==typeof e?this.lag=e:(e=Zt.parseDuration(e),this.set({lag:e.magnitude,lagUnit:e.unit}))}},{key:"getLag",value:function(){return this.lag?"".concat(this.lag<0?"-":"+").concat(Math.abs(this.lag)).concat(Zt.getShortNameOfUnit(this.lagUnit)):""}},{key:"getSourceEvent",value:function(){return this.fromEvent}},{key:"getTargetEvent",value:function(){return this.toEvent}},{key:"getDateRange",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.fromEvent,r=this.toEvent;if(t&&r&&t.isScheduled&&r.isScheduled){var i,o,a=n.Type;switch(this.type){case a.StartToStart:i=t.startDate,o=r.startDate;break;case a.StartToEnd:i=t.startDate,o=r.endDate;break;case a.EndToEnd:i=t.endDate,o=r.endDate;break;case a.EndToStart:i=t.endDate,o=r.startDate}return{start:e?i:Zt.min(i,o),end:e?o:Zt.max(i,o)}}return null}},{key:"highlight",value:function(e){var t=this.highlighted?this.highlighted.split(" "):[];t.includes(e)||(this.highlighted=t.concat(e).join(" "))}},{key:"unhighlight",value:function(e){var t=this.highlighted;if(t){var n=t.split(" "),r=n.findIndex((function(t){return t===e}));r>=0&&(n.splice(r,1),this.highlighted=n.join(" "))}}},{key:"isHighlightedWith",value:function(e){return this.highlighted&&this.highlighted.split(" ").includes(e)}},{key:"getConnectorString",value:function(e){var t=cx[this.type];return e?t:this.type===n.Type.EndToStart?"":t}},{key:"toString",value:function(){return"".concat(this.from).concat(this.getConnectorString()).concat(this.getLag())}},{key:"sourceEvent",get:function(){return y.a.deprecate("scheduler","5.0.0","Deprecated in favor of fromEvent"),this.fromEvent},set:function(e){this.fromEvent=e}},{key:"targetEvent",get:function(){return y.a.deprecate("scheduler","5.0.0","Deprecated in favor of toEvent"),this.toEvent},set:function(e){this.targetEvent=e}},{key:"eventStore",get:function(){var e=this.unjoinedStores;return this.eventStore||e[0]&&e[0].eventStore}},{key:"from",set:function(e){var t=this.fromEvent;t&&t.isModel&&t.id===e?this.set("from",e):this.fromEvent=e},get:function(){return this.get("from")}},{key:"to",set:function(e){var t=this.toEvent;t&&t.isModel&&t.id===e?this.set("to",e):this.toEvent=e},get:function(){return this.get("to")}},{key:"hardType",get:function(){return this.getHardType()},set:function(e){this.setHardType(e)}},{key:"lag",get:function(){return this.get("lag")},set:function(e){"number"==typeof e?this.set({lag:e}):this.setLag(e)}},{key:"fullLag",get:function(){return new Ko({unit:this.lagUnit,magnitude:this.lag})},set:function(e){"string"==typeof e?this.setLag(e):this.setLag(e.magnitude,e.unit)}},{key:"isPersistable",get:function(){var e,t=this.stores,n=this.unjoinedStores,r=t[0];if(r){var i=this.fromEvent,o=this.toEvent,a=r.crudManager;e=i&&(a||!i.hasGeneratedId)&&o&&(a||!o.hasGeneratedId)}else e=Boolean(n[0]);return e}},{key:"isValid",get:function(){var e=this.from,t=this.to;return"number"==typeof this.type&&e&&""!==e&&null!=t&&""!==t&&e!==t}}],[{key:"Type",get:function(){return{StartToStart:0,StartToEnd:1,EndToStart:2,EndToEnd:3}}},{key:"fields",get:function(){return[{name:"from"},{name:"to"},{name:"type",type:"int",defaultValue:2},{name:"cls",defaultValue:""},{name:"bidirectional",type:"boolean"},{name:"fromSide",type:"string"},{name:"toSide",type:"string"},{name:"lag",type:"number",allowNull:!0,defaultValue:0},{name:"lagUnit",type:"string",defaultValue:"d"}]}}]),n}(Bi);function fx(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}lx.exposeProperties(),lx._$name="DependencyBaseModel";var dx=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":l()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},hx=function(e){fe()(n,e);var t=fx(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([sC],(function(e){e.prototype;var t=function(e){fe()(n,e);var t=fx(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(e);return dx([cw({bucket:"outgoingDeps",resolver:function(e){return this.getEventById(e)},modelFieldConfig:{persist:!0,serialize:function(e){return null==e?void 0:e.id},isEqual:Aw}},Iw)],t.prototype,"fromEvent",void 0),dx([cw({bucket:"incomingDeps",resolver:function(e){return this.getEventById(e)},modelFieldConfig:{persist:!0,serialize:function(e){return null==e?void 0:e.id},isEqual:Aw}},Iw)],t.prototype,"toEvent",void 0),dx([Vw({type:"int",defaultValue:QC.EndToStart})],t.prototype,"type",void 0),t})));function vx(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var px,gx=function(e){fe()(n,e);var t=vx(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([vC],(function(e){var t=e.prototype;return function(e){fe()(r,e);var n=vx(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"setChanged",value:function(e,n,r){var i,o,a,s=!1;if("fromEvent"===e||"toEvent"===e){var u=Gm(n,mC)?n:null===(i=this.eventStore)||void 0===i?void 0:i.getById(n);u&&(s=!0),n=u||n}t.setChanged.call(this,e,n,r,!0),!s||this.project.isPerformingCommit||(null===(o=this.dependencyStore)||void 0===o?void 0:o.isLoadingData)||null===(a=this.dependencyStore)||void 0===a||a.updateIndices()}},{key:"joinProject",value:function(){t.joinProject.call(this),this.setChanged("fromEvent",this.get("fromEvent")),this.setChanged("toEvent",this.get("toEvent"))}},{key:"calculateInvalidated",value:function(){var e,t,n=this.$changed,r=n.fromEvent,i=n.toEvent;if(null!==r&&!Gm(r,mC)){var o=null===(e=this.eventStore)||void 0===e?void 0:e.getById(r);o&&(this.$changed.fromEvent=o)}if(null!==i&&!Gm(i,mC)){var a=null===(t=this.eventStore)||void 0===t?void 0:t.getById(i);a&&(this.$changed.toEvent=a)}}},{key:"fromEvent",set:function(e){this.setChanged("fromEvent",e)},get:function(){var e=this.get("fromEvent");return Gm(e,mC)?e:null}},{key:"toEvent",set:function(e){this.setChanged("toEvent",e)},get:function(){var e=this.get("toEvent");return Gm(e,mC)?e:null}}],[{key:"fields",get:function(){return[{name:"fromEvent",isEqual:function(e,t){return e===t},persist:!1},{name:"toEvent",isEqual:function(e,t){return e===t},persist:!1}]}}]),r}(e)})));function yx(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var mx=function(e){fe()(n,e);var t=yx(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"getTypeFromSides",value:function(e,t,n){var r=lx.Type,i=n?"right":"left",o=n?"left":"right";return e===i?t===i?r.StartToStart:r.StartToEnd:t===o?r.EndToEnd:r.EndToStart}}]),n}(om(((null===(px=window.bryntum)||void 0===px?void 0:px.useBasicEngine)?hx:gx).derive(lx)));function kx(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}mx.exposeProperties(),mx._$name="DependencyModel";var bx=function(e){return function(e){fe()(n,e);var t=kx(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"reduceEventDependencies",value:function(e,t,n){var r=this,i=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],o=arguments.length>4?arguments[4]:void 0;return o=o||function(e){return r.getEventDependencies(e)},(e=Array.isArray(e)?e:[e]).reduce((function(e,n){n.children&&!i?n.traverse((function(n){e=o(n).reduce(t,e)})):e=o(n).reduce(t,e)}),n),n}},{key:"mapEventDependencies",value:function(e,t,n,r,i){return this.reduceEventDependencies(e,(function(e,t){return n(t)&&e.push(t),e}),[],r,i)}},{key:"mapEventPredecessors",value:function(e,t,n,r){return this.reduceEventPredecessors(e,(function(e,t){return n(t)&&e.push(t),e}),[],r)}},{key:"mapEventSuccessors",value:function(e,t,n,r){return this.reduceEventSuccessors(e,(function(e,t){return n(t)&&e.push(t),e}),[],r)}},{key:"getEventDependencies",value:function(e){return[].concat(e.predecessors||[],e.successors||[])}},{key:"getEventPredecessors",value:function(e){return y.a.deprecate("scheduler","5.0.0","Superfluous, will be removed in favour of `event.predecessors`"),e.predecessors}},{key:"getEventSuccessors",value:function(e){return y.a.deprecate("scheduler","5.0.0","Superfluous, will be removed in favour of `event.successors`"),e.successors}},{key:"removeEventDependencies",value:function(e){this.remove(this.getEventDependencies(e))}},{key:"removeEventPredecessors",value:function(e){this.remove(e.predecessors)}},{key:"removeEventSuccessors",value:function(e,t){this.remove(e.successors)}},{key:"getBySourceTargetId",value:function(e){var t=this;return this.records.find((function(n){return e==t.constructor.makeDependencySourceTargetCompositeKey(n.from,n.to)}))}},{key:"getDependencyForSourceAndTargetEvents",value:function(e,t){return e=Bi.asId(e),t=Bi.asId(t),this.getBySourceTargetId(this.constructor.makeDependencySourceTargetCompositeKey(e,t))}},{key:"getEventsLinkingDependency",value:function(e,t){return this.getDependencyForSourceAndTargetEvents(e,t)||this.getDependencyForSourceAndTargetEvents(t,e)}},{key:"isValidDependency",value:function(e,t,n){return 1===arguments.length&&(t=e.to||e.toEvent,e=e.from||e.fromEvent),e instanceof Qy&&t instanceof Qy?this.project.isValidDependency(e,t,n):null!=e&&null!=t&&e!==t}},{key:"isValidDependencyToCreate",value:function(e,t,n){return this.isValidDependency(e,t,n)}},{key:"getHighlightedDependencies",value:function(e){return this.records.reduce((function(t,n){return n.isHighlightedWith(e)&&t.push(n),t}),[])}},{key:"getTimeSpanDependencies",value:function(e){return this.getEventDependencies(e)}}],[{key:"makeDependencySourceTargetCompositeKey",value:function(e,t){return"source(".concat(e,")-target(").concat(t,")")}},{key:"$name",get:function(){return"DependencyStoreMixin"}},{key:"defaultConfig",get:function(){return{loadPriority:400,syncPriority:400,storeId:"dependencies"}}}]),n}(e)};function wx(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var Cx=function(e){fe()(n,e);var t=wx(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([tC],(function(e){var t=e.prototype;return function(e){fe()(r,e);var n=wx(r);function r(){var e;return v()(this,r),(e=n.apply(this,arguments)).dependenciesForRemoval=new Set,e.allDependenciesForRemoval=!1,e}return g()(r,[{key:"remove",value:function(e,n){this.dependenciesForRemoval=AC(e).toSet();var r=t.remove.call(this,e);return this.dependenciesForRemoval.clear(),r}},{key:"removeAll",value:function(e){this.allDependenciesForRemoval=!0;var n=t.removeAll.call(this,e);return this.allDependenciesForRemoval=!1,n}}]),r}(e)})));function Sx(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var Dx=function(e){fe()(n,e);var t=Sx(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([Cx,rC],(function(e){e.prototype;return function(e){fe()(n,e);var t=Sx(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"data",set:function(e){this.allDependenciesForRemoval=!0,sc()(pe()(n.prototype),"data",e,this,!0),this.allDependenciesForRemoval=!1}}]),n}(e)})));function Rx(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var xx,Ex=new Set,Tx=function(e){fe()(n,e);var t=Rx(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([Cx,_C],(function(e){e.prototype;return function(e){fe()(n,e);var t=Rx(n);function n(){var e;return v()(this,n),(e=t.apply(this,arguments)).dependenciesForRemoval=new Set,e.allDependenciesForRemoval=!1,e}return g()(n,[{key:"getIncomingDepsForEvent",value:function(e){return this.storage.findItem("toEvent",e)||Ex}},{key:"getOutgoingDepsForEvent",value:function(e){return this.storage.findItem("fromEvent",e)||Ex}},{key:"updateIndices",value:function(){this.storage.rebuildIndices()}},{key:"onCommitAsync",value:function(){this.updateIndices()}},{key:"data",set:function(e){this.allDependenciesForRemoval=!0,sc()(pe()(n.prototype),"data",e,this,!0),this.allDependenciesForRemoval=!1}}],[{key:"defaultConfig",get:function(){return{modelClass:gx,storage:{extraKeys:[{property:"fromEvent",unique:!1},{property:"toEvent",unique:!1}]}}}}]),n}(e)})));function Mx(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var Ax=function(e){fe()(n,e);var t=Mx(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"defaultConfig",get:function(){return{modelClass:mx}}}]),n}(bx(((null===(xx=window.bryntum)||void 0===xx?void 0:xx.useBasicEngine)?EC(Dx.derive(Uo)):om(Tx.derive(Uo))).derive(Uo)));function Px(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Ax._$name="DependencyStore";var Ix=function(e){fe()(n,e);var t=Px(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"startConfigure",value:function(e){e.scheduler&&(e.scheduler._crudManager=this),we()(pe()(n.prototype),"startConfigure",this).call(this,e)}},{key:"afterConstruct",value:function(){var e=this,t=e.scheduler;if(t){var r=t.features.timeRanges;r&&(e.addCrudStore(r.store),e._timeRangesStore=r.store)}else e.project||(e.project=null);we()(pe()(n.prototype),"afterConstruct",this).call(this)}},{key:"setFeaturedStore",value:function(e,t,n){var r,i,o=this,a=null===(r=o[e])||void 0===r?void 0:r.store;a!==t&&(t=No.getStore(t,(null===(i=t)||void 0===i?void 0:i.storeClass)||n),a&&o.removeStore(a),o[e]=t&&{store:t}||null,o.addPrioritizedStore(o[e]));return o[e]}},{key:"getChangeSetPackage",value:function(){var e=we()(pe()(n.prototype),"getChangeSetPackage",this).call(this);return e&&this.eventStore.usesSingleAssignment&&(delete e[this.assignmentStore.storeId],!this.crudStores.some((function(t){return e[t.storeId]})))?null:e}},{key:"project",set:function(e){var t=this;t._project=e,e&&(t.eventStore=e.eventStore,t.resourceStore=e.resourceStore,t.assignmentStore=e.assignmentStore,t.dependencyStore=e.dependencyStore,t.resourceTimeRangeStore=e.resourceTimeRangeStore),t.eventStore||(t.eventStore={}),t.resourceStore||(t.resourceStore={}),t.assignmentStore||(t.assignmentStore={}),t.dependencyStore||(t.dependencyStore={})},get:function(){return this._project}},{key:"timeRangesStore",get:function(){return this._timeRangesStore}},{key:"resourceStore",get:function(){var e;return null===(e=this._resourceStore)||void 0===e?void 0:e.store},set:function(e){this.setFeaturedStore("_resourceStore",e,this.resourceStoreClass)}},{key:"eventStore",get:function(){var e;return null===(e=this._eventStore)||void 0===e?void 0:e.store},set:function(e){this.setFeaturedStore("_eventStore",e,this.eventStoreClass)}},{key:"assignmentStore",get:function(){var e;return null===(e=this._assignmentStore)||void 0===e?void 0:e.store},set:function(e){this.setFeaturedStore("_assignmentStore",e,this.assignmentStoreClass)}},{key:"dependencyStore",get:function(){var e;return null===(e=this._dependencyStore)||void 0===e?void 0:e.store},set:function(e){this.setFeaturedStore("_dependencyStore",e,this.dependencyStoreClass)}},{key:"resourceTimeRangeStore",set:function(e){this._resourceTimeRangesStore=e,this.addCrudStore(e)},get:function(){return this._resourceTimeRangesStore}}],[{key:"defaultConfig",get:function(){return{resourceStoreClass:tD,eventStoreClass:sx,assignmentStoreClass:GC,dependencyStoreClass:Ax,resourceStore:{},eventStore:{},assignmentStore:{},dependencyStore:{},project:null,scheduler:null}}}]),n}(Ny.mixin(Ky,zy,Uy));function Ox(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return Fx(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Fx(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function Fx(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Lx(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Ix._$name="CrudManager";var jx=function(e){fe()(n,e);var t=Lx(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e){we()(pe()(n.prototype),"construct",this).apply(this,arguments),this.normalizeUnits()}},{key:"generateId",value:function(e){var t=this,n=t.headers,r=[],i=Object.getPrototypeOf(t.data).id;if(!i){for(var o=n.length-1;o>=0;o--)r.push(o?n[o].unit:E.capitalize(n[o].unit));i=r.join("And")}return e.includes(i)&&(i+="-".concat(t.tickWidth,"by").concat(t.tickHeight||t.tickWidth),e.includes(i)&&(i+="-".concat(t.bottomHeader.increment),e.includes(i)&&(i=zi.generateId("".concat(i,"-"))))),i}},{key:"normalizeUnits",value:function(){for(var e=this,t=e.timeResolution,n=e.headers,r=0,i=n.length;r<i;r++){var o=n[r];o.unit=Zt.normalizeUnit(o.unit),o.splitUnit&&(o.splitUnit=Zt.normalizeUnit(o.splitUnit)),"increment"in o||(n[r]=Object.assign({increment:1},o))}t&&(t.unit=Zt.normalizeUnit(t.unit)),e.shiftUnit&&(e.shiftUnit=Zt.normalizeUnit(e.shiftUnit))}},{key:"set",value:function(){}},{key:"inSet",value:function(){}},{key:"columnLinesFor",get:function(){return"columnLinesFor"in this.data?this.data.columnLinesFor:this.headers.length-1}},{key:"tickSize",get:function(){return this._tickSize||this.tickWidth}},{key:"tickWidth",get:function(){return"tickWidth"in this.data?this.data.tickWidth:50}},{key:"tickHeight",get:function(){return"tickHeight"in this.data?this.data.tickHeight:50}},{key:"headerConfig",get:function(){if(this.data.headerConfig)return this.data.headerConfig;var e={},t=this.headers;switch(t.length){case 1:e.middle=t[0];break;case 2:0===this.mainHeaderLevel?(e.middle=t[0],e.bottom=t[1]):(e.top=t[0],e.middle=t[1]);break;case 3:e.top=t[0],e.middle=t[1],e.bottom=t[2];break;default:throw new Error("headerConfig object not supported for >3 header levels")}return e}},{key:"mainHeaderLevel",set:function(e){this.data.mainHeaderLevel=e},get:function(){return"mainHeaderLevel"in this.data?this.data.mainHeaderLevel:3===this.data.headers.length?1:this.headers.length-1}},{key:"mainHeader",get:function(){return this.headers[this.mainHeaderLevel]}},{key:"bottomHeader",get:function(){return this.headers[this.headers.length-1]}},{key:"leafUnit",get:function(){return this.bottomHeader.unit}},{key:"mainUnit",get:function(){return this.mainHeader}},{key:"msPerPixel",get:function(){var e=this.bottomHeader;return Math.round(Zt.asMilliseconds(e.increment||1,e.unit)/this.tickWidth)}},{key:"isValid",get:function(){var e,t=this,n=!0,r=Ox(t.headers);try{for(r.s();!(e=r.n()).done;){var i=e.value;n=n&&Boolean(Zt.normalizeUnit(i.unit))}}catch(e){r.e(e)}finally{r.f()}return t.timeResolution&&(n=n&&Zt.normalizeUnit(t.timeResolution.unit)),t.shiftUnit&&(n=n&&Zt.normalizeUnit(t.shiftUnit)),n}}],[{key:"normalizeHeaderConfig",value:function(e){var t=e.headerConfig,n=e.columnLinesFor,r=e.mainHeaderLevel,i=e.headers=[];if(t.top&&("top"==n&&(e.columnLinesFor=0),"top"==r&&(e.mainHeaderLevel=0),i[0]=t.top),!t.middle)throw new Error("ViewPreset.headerConfig must be configured with a middle");"middle"==n&&(e.columnLinesFor=i.length),"middle"==r&&(e.mainHeaderLevel=i.length),i.push(t.middle),t.bottom&&(e.mainHeaderLevel=i.length-1,null==n?e.columnLinesFor=i.length-1:"bottom"==n&&(e.columnLinesFor=i.length),null==r&&(e.mainHeaderLevel=i.length-1),"bottom"==r&&(e.mainHeaderLevel=i.length),i.push(t.bottom))}},{key:"fields",get:function(){return[{name:"name",type:"string"},{name:"rowHeight",defaultValue:24},{name:"tickWidth",defaultValue:50},{name:"tickHeight",defaultValue:50},{name:"displayDateFormat",defaultValue:"HH:mm"},{name:"shiftUnit",defaultValue:"hour"},{name:"shiftIncrement",defaultValue:1},{name:"defaultSpan",defaultValue:12},"timeResolution","headers","mainHeaderLevel","columnLinesFor"]}}]),n}(Bi);function _x(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}jx._$name="ViewPreset";var Bx=function(e){fe()(n,e);var t=_x(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"createRecord",value:function(e){if(e.base){var t=this.getById(e.base)||$x.getById(e.base);Object.setPrototypeOf(e,t.data)}return we()(pe()(n.prototype),"createRecord",this).apply(this,arguments)}},{key:"updateLocalization",value:function(){we()(pe()(n.prototype),"updateLocalization",this).call(this);var e=this,t=e.allRecords;e.isPresetManager&&(t=new Set(t.concat(Object.values(e.basePresets)))),t.forEach((function(t){var n=e.optionalL(t.id);"string"==typeof n&&t.baseId&&(n=e.optionalL(t.baseId)),n&&"object"===l()(n)&&(t.originalDisplayDateFormat||(t.originalDisplayDateFormat=t.displayDateFormat),0===t.mainHeaderLevel&&n.topDateFormat&&(n.middleDateFormat=n.middleDateFormat||n.topDateFormat),t.setData("displayDateFormat",n.displayDateFormat||t.originalDisplayDateFormat),["top","middle","bottom"].forEach((function(e){var r=t.headerConfig[e],i=n[e+"DateFormat"];r&&(r.originalDateFormat||(r.originalDateFormat=r.dateFormat),i&&r.renderer&&(r.renderer=null),r.dateFormat=i||r.originalDateFormat)})))}))}},{key:"storage",set:function(e){var t=this;sc()(pe()(n.prototype),"storage",e,this,!0),this.storage.addSorter((function(e,n){var r=e.bottomHeader,i=n.bottomHeader;return(n.msPerPixel-e.msPerPixel||qt[r.unit]-qt[i.unit]||r.increment-i.increment)*t.zoomOrder}))},get:function(){return we()(pe()(n.prototype),"storage",this)}}],[{key:"defaultConfig",get:function(){return{useRawData:!0,modelClass:jx,zoomOrder:1}}}]),n}(lt(No));function Hx(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Bx._$name="PresetStore";var $x=new(function(e){fe()(n,e);var t=Hx(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"getById",value:function(e){return we()(pe()(n.prototype),"getById",this).call(this,e)||this.basePresets[e]}},{key:"registerPreset",value:function(e,t){var n=this.createRecord(Object.assign({id:e},t)),r=this.find((function(e){return e.equals(n)}));if(r)return r;if(!n.isValid)throw new Error("Invalid preset, please check your configuration");return this.add(n),n}},{key:"getPreset",value:function(e){return"number"==typeof e&&(e=this.getAt(e)),"string"==typeof e?e=this.getById(e):e instanceof jx||(e=this.createRecord(e)),e}},{key:"normalizePreset",value:function(e){if(!(e instanceof jx))if("string"==typeof e){if(!(e=this.getPreset(e)))throw new Error("You must define a valid view preset. See PresetManager for reference")}else if("object"===l()(e)){if(e.base){var t=this.getById(e.base);if(!t)throw new Error("ViewPreset base '".concat(e.base,"' does not exist"));e=an.merge(an.clone(t.data),e)}e.id?e=this.createRecord(e):(e=this.createRecord(an.assign({},e))).id=e.generateId(e)}return e}},{key:"deletePreset",value:function(e){"string"==typeof e?e=this.getById(e):"number"==typeof e&&(e=this.getAt(e)),e&&(this.remove(e),delete this.basePresets[e.id])}},{key:"basePresets",set:function(e){var t=this._basePresets={};for(var n in e)e[n].id=n,t[n]=this.createRecord(e[n])},get:function(){return this._basePresets}},{key:"defaultPresets",set:function(e){for(var t=0,n=e.length;t<n;t++){var r=e[t],i="string"==typeof r,o=i?r:r.preset,a=void 0;if(i)a=this.basePresets[o];else{var s=Object.setPrototypeOf(an.clone(this.basePresets[o].data),{id:o}),u=s.timeResolution,c=s.headers[s.headers.length-1];s.id=void 0,"width"in r&&(s.tickWidth=r.width),"height"in r&&(s.tickHeight=r.height),"increment"in r&&(c.increment=r.increment),"resolution"in r&&(u.increment=r.resolution),"resolutionUnit"in r&&(u.unit=Zt.getUnitByName(r.resolutionUnit)),(a=this.createRecord(s)).baseId=o}this.add(a)}}}],[{key:"defaultConfig",get:function(){return{preventSubClassingModel:!0,basePresets:{secondAndMinute:{name:"Seconds",tickWidth:30,tickHeight:40,displayDateFormat:"ll LTS",shiftIncrement:10,shiftUnit:"minute",defaultSpan:24,timeResolution:{unit:"second",increment:5},headers:[{unit:"minute",dateFormat:"llll"},{unit:"second",increment:10,dateFormat:"ss"}]},minuteAndHour:{name:"Minutes",tickWidth:60,tickHeight:60,displayDateFormat:"ll LT",shiftIncrement:1,shiftUnit:"hour",defaultSpan:24,timeResolution:{unit:"minute",increment:30},headers:[{unit:"hour",dateFormat:"ddd MM/DD, hA"},{unit:"minute",increment:30,dateFormat:"mm"}]},hourAndDay:{name:"Hours",tickWidth:70,tickHeight:40,displayDateFormat:"ll LT",shiftIncrement:1,shiftUnit:"day",defaultSpan:24,timeResolution:{unit:"minute",increment:30},headers:[{unit:"day",dateFormat:"ddd DD/MM"},{unit:"hour",dateFormat:"LT"}]},day:{name:"Hours 2",displayDateFormat:"LT",shiftIncrement:1,shiftUnit:"day",defaultSpan:1,timeResolution:{unit:"minute",increment:30},mainHeaderLevel:0,headers:[{unit:"day",dateFormat:"ddd DD/MM",splitUnit:"day"},{unit:"hour",renderer:function(e){return'\n                                    <div class="b-sch-calendarcolumn-ct"><span class="b-sch-calendarcolumn-hours">'.concat(Zt.format(e,"HH"),'</span>\n                                    <span class="b-sch-calendarcolumn-minutes">').concat(Zt.format(e,"mm"),"</span></div>\n                                ")}}]},week:{name:"Week/hours",displayDateFormat:"LT",shiftIncrement:1,shiftUnit:"week",defaultSpan:24,timeResolution:{unit:"minute",increment:30},mainHeaderLevel:0,headers:[{unit:"week",dateFormat:"D d",splitUnit:"day"},{unit:"hour",dateFormat:"LT",renderer:function(e){return'\n                                    <div class="sch-calendarcolumn-ct">\n                                    <span class="sch-calendarcolumn-hours">'.concat(Zt.format(e,"HH"),'</span>\n                                    <span class="sch-calendarcolumn-minutes">').concat(Zt.format(e,"mm"),"</span>\n                                    </div>\n                                ")}}]},dayAndWeek:{name:"Days 2",tickWidth:100,tickHeight:80,displayDateFormat:"ll LT",shiftUnit:"day",shiftIncrement:1,defaultSpan:5,timeResolution:{unit:"hour",increment:1},headers:[{unit:"week",renderer:function(e){return Zt.getShortNameOfUnit("week")+"."+Zt.format(e,"WW MMM YYYY")}},{unit:"day",dateFormat:"dd DD"}]},weekAndDay:{name:"Days",tickWidth:100,tickHeight:80,displayDateFormat:"ll hh:mm A",shiftUnit:"week",shiftIncrement:1,defaultSpan:1,timeResolution:{unit:"day",increment:1},mainHeaderLevel:0,headers:[{unit:"week",dateFormat:"YYYY MMMM DD"},{unit:"day",increment:1,dateFormat:"DD MMM"}]},weekAndMonth:{name:"Weeks",tickWidth:100,tickHeight:105,displayDateFormat:"ll",shiftUnit:"week",shiftIncrement:5,defaultSpan:6,timeResolution:{unit:"day",increment:1},headers:[{unit:"month",dateFormat:"MMM YYYY"},{unit:"week",dateFormat:"DD MMM"}]},weekAndDayLetter:{name:"Weeks 2",tickWidth:20,tickHeight:50,displayDateFormat:"ll",shiftUnit:"week",shiftIncrement:1,defaultSpan:10,timeResolution:{unit:"day",increment:1},mainHeaderLevel:0,headers:[{unit:"week",dateFormat:"ddd DD MMM YYYY",verticalColumnWidth:115},{unit:"day",dateFormat:"d1",verticalColumnWidth:25}]},weekDateAndMonth:{name:"Weeks 3",tickWidth:30,tickHeight:40,displayDateFormat:"ll",shiftUnit:"week",shiftIncrement:1,defaultSpan:10,timeResolution:{unit:"day",increment:1},headers:[{unit:"month",dateFormat:"YYYY MMMM"},{unit:"week",dateFormat:"DD"}]},monthAndYear:{name:"Months",tickWidth:110,tickHeight:110,displayDateFormat:"ll",shiftIncrement:3,shiftUnit:"month",defaultSpan:12,timeResolution:{unit:"day",increment:1},headers:[{unit:"year",dateFormat:"YYYY"},{unit:"month",dateFormat:"MMM YYYY"}]},year:{name:"Years",tickWidth:100,tickHeight:100,resourceColumnWidth:100,displayDateFormat:"ll",shiftUnit:"year",shiftIncrement:1,defaultSpan:1,timeResolution:{unit:"month",increment:1},headers:[{unit:"year",dateFormat:"YYYY"},{unit:"quarter",renderer:function(e,t,n){return Zt.getShortNameOfUnit("quarter").toUpperCase()+(Math.floor(e.getMonth()/3)+1)}}]},manyYears:{name:"Years 2",tickWidth:40,tickHeight:50,displayDateFormat:"ll",shiftUnit:"year",shiftIncrement:1,defaultSpan:1,timeResolution:{unit:"year",increment:1},mainHeaderLevel:0,headers:[{unit:"year",dateFormat:"YYYY",increment:5},{unit:"year",dateFormat:"YY",increment:1}]}},defaultPresets:["manyYears",{width:80,increment:1,resolution:1,preset:"manyYears",resolutionUnit:"YEAR"},"year",{width:30,increment:1,resolution:1,preset:"year",resolutionUnit:"MONTH"},{width:50,increment:1,resolution:1,preset:"year",resolutionUnit:"MONTH"},{width:200,increment:1,resolution:1,preset:"year",resolutionUnit:"MONTH"},"monthAndYear","weekDateAndMonth","weekAndMonth","weekAndDayLetter","weekAndDay",{width:54,increment:1,resolution:1,preset:"weekAndDay",resolutionUnit:"HOUR"},"hourAndDay",{width:64,increment:6,resolution:30,preset:"hourAndDay",resolutionUnit:"MINUTE"},{width:100,increment:6,resolution:30,preset:"hourAndDay",resolutionUnit:"MINUTE"},{width:64,increment:2,resolution:30,preset:"hourAndDay",resolutionUnit:"MINUTE"},"minuteAndHour",{width:30,increment:15,resolution:5,preset:"minuteAndHour"},{width:130,increment:15,resolution:5,preset:"minuteAndHour"},{width:60,increment:5,resolution:5,preset:"minuteAndHour"},{width:100,increment:5,resolution:5,preset:"minuteAndHour"},"secondAndMinute",{width:60,increment:10,resolution:5,preset:"secondAndMinute"},{width:130,increment:5,resolution:5,preset:"secondAndMinute"}],listeners:{locale:"updateLocalization"}}}}]),n}(Bx));function Nx(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var Vx=function(e){fe()(n,e);var t=Nx(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e){var t=this;if(t.generateTicksValidatorFn=function(){return!0},we()(pe()(n.prototype),"construct",this).call(this,e),t.originalContinuous=t.continuous,t.on({change:function(e){"filter"!==e.action&&t.trigger("reconfigure",{supressRefresh:!1})},refresh:function(){return t.trigger("reconfigure",{supressRefresh:!1})},endreconfigure:function(e){return t.trigger("reconfigure",e)}}),t.startDate)t.internalOnReconfigure(),t.trigger("reconfigure");else if(t.viewPreset){var r=t.getAdjustedDates(new Date);t.startDate=r.startDate,t.endDate=r.endDate}}},{key:"reconfigure",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.getAdjustedDates(e.startDate,e.endDate);if(!1!==r.trigger("beforeReconfigure",{startDate:i.startDate,endDate:i.endDate,config:e})){if(r.trigger("beginReconfigure"),r._configuredStartDate=e.startDate,r._configuredEndDate=e.endDate,Object.assign(r,e),!1===r.internalOnReconfigure(n))return!1;r.trigger("endReconfigure",{suppressRefresh:t,config:e})}}},{key:"internalOnReconfigure",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;t.isConfigured=!0;var n=t.getAdjustedDates(t.startDate,t.endDate,!0),r=t.getAdjustedDates(t.startDate,t.endDate),i=r.startDate,o=r.endDate;if(i>=o)throw new Error("Invalid start/end dates. Start date must less than end date. Start date: ".concat(i,". End date: ").concat(o,"."));var a=t.unit,s=t.increment||1,u=t.generateTicks(i,o,a,s);t.suspendEvents(),t.data=u;var c=t.count;if(0===c){if(e)return t.resumeEvents(),!1;throw new Error("Invalid time axis configuration or filter, please check your input data.")}t.startDate=t.first.startDate,t.resumeEvents();var l=t.last.endDate;t.isContinuous?(t.adjustedStart=n.startDate,t.adjustedEnd=Zt.getNext(c>1?u[c-1].startDate:n.startDate,a,s,t.weekStartDay)):(t.adjustedStart=t.startDate,t.adjustedEnd=l);do{t.visibleTickStart=(t.startDate-t.adjustedStart)/(Zt.asMilliseconds(a)*s),t.autoAdjust&&(t.visibleTickStart=Math.floor(t.visibleTickStart)),t.visibleTickStart>=1&&(t.adjustedStart=Zt.getNext(t.adjustedStart,a,s,t.weekStartDay))}while(t.visibleTickStart>=1);do{t.visibleTickEnd=c-(t.adjustedEnd-l)/(Zt.asMilliseconds(a)*s),c-t.visibleTickEnd>=1&&(t.adjustedEnd=Zt.getNext(t.adjustedEnd,a,-1,t.weekStartDay))}while(c-t.visibleTickEnd>=1);t.updateTickCache(!0)}},{key:"setTimeSpan",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.getAdjustedDates(e,t),o=i.startDate,a=i.endDate;if(r.startDate-o!=0||r.endDate-a!=0)return r.reconfigure({startDate:o,endDate:a},!1,n)}},{key:"shift",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.shiftUnit,n=this,r=n.startDate,i=n.endDate;n.isFiltered&&(r=n.allRecords[0].startDate,i=n.allRecords[n.allCount-1].endDate);var o=0;do{r=Zt.add(r,e,t),i=Zt.add(i,e,t)}while(o++<100&&!1===n.setTimeSpan(r,i,!0))}},{key:"shiftNext",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.shiftIncrement;this.shift(e)}},{key:"shiftPrevious",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.shiftIncrement;this.shift(-e)}},{key:"filterBy",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,r=this;r.filters.clear(),we()(pe()(n.prototype),"filterBy",this).call(this,(function(n,r){return e.call(t,n.data,r)})),0===r.count&&(r.trigger("invalidFilter"),r.clearFilters())}},{key:"triggerFilterEvent",value:function(e){e.filters.count?this.continuous=!1:this.continuous=this.originalContinuous,this.updateTickCache(),we()(pe()(n.prototype),"triggerFilterEvent",this).call(this,e)}},{key:"getAdjustedDates",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this;return e=e||r.startDate,t=t||Zt.add(e,r.defaultSpan,r.mainUnit),r.autoAdjust||n?{startDate:r.floorDate(e,!1,r.autoAdjust?r.mainUnit:r.unit,1),endDate:r.ceilDate(t,!1,r.autoAdjust?r.mainUnit:r.unit,1)}:{startDate:e,endDate:t}}},{key:"floorDate",value:function(e,t,n,r){var i=this,o=(t=!1!==t)?Zt.clone(i.startDate):null,a=r||i.resolutionIncrement,s=n||(t?i.resolutionUnit:i.mainUnit),u=function(e,t){return Math.floor(e/t)*t};if(t){var c=u(Zt.diff(o,e,s),a);return Zt.add(o,c,s)}var l=Zt.clone(e);if("week"===s){var f=l.getDay()||7,d=i.weekStartDay||7;(l=Zt.add(Zt.startOf(l,"day"),f>=d?d-f:-(7-d+f),"day")).getDay()!==d&&23===l.getHours()&&(l=Zt.add(l,1,"hour"))}else{l=Zt.startOf(l,s);var h=["day","year"].includes(s)?1:0,v="day"===s?"date":s,p=u(Zt.get(l,v)-h,a)+h;l=Zt.set(l,v,p)}return l}},{key:"roundDate",value:function(e,t){var n=this,r=Zt.clone(e),i=n.resolutionIncrement||1;switch(t=Zt.clone(t||n.startDate),n.resolutionUnit){case"week":Zt.startOf(r,"day");var o,a=r.getDay()-n.weekStartDay;return a<0&&(a=7+a),o=1===Math.round(a/7)?7-a:-a,Zt.add(r,o,"day");case"month":var s=Zt.diff(t,r,"month")+Zt.as("month",r.getDay()/Zt.daysInMonth(r)),u=Math.round(s/i)*i;return Zt.add(t,u,"month");case"quarter":return Zt.startOf(r,"month"),Zt.add(r,"month",3-r.getMonth()%3);default:var c=Zt.as(n.resolutionUnit,Zt.diff(t,r)),l=Zt.as(n.resolutionUnit,t.getTimezoneOffset()-r.getTimezoneOffset(),"minute"),f=Math.round((c+l)/i)*i;return Zt.add(t,f-l,n.resolutionUnit)}}},{key:"ceilDate",value:function(e,t,n,r){t=!1!==t,r=r||(t?this.resolutionIncrement:1);var i=Zt.clone(e),o=!1,a=n||(t?this.resolutionUnit:this.mainUnit);switch(a){case"minute":o=!Zt.isStartOf(i,"minute");break;case"hour":o=!Zt.isStartOf(i,"hour");break;case"day":case"date":o=!Zt.isStartOf(i,"day");break;case"week":o=(i=Zt.startOf(i,"day")).getDay()!==this.weekStartDay||!Zt.isEqual(i,e);break;case"month":o=1!==(i=Zt.startOf(i,"day")).getDate()||!Zt.isEqual(i,e);break;case"quarter":o=(i=Zt.startOf(i,"day")).getMonth()%3!=0||1!==i.getDate()||!Zt.isEqual(i,e);break;case"year":o=0!==(i=Zt.startOf(i,"day")).getMonth()||1!==i.getDate()||!Zt.isEqual(i,e)}return o?Zt.getNext(i,a,r,this.weekStartDay):i}},{key:"processExclusion",value:function(e,t,n){var r=this.include;return!!r&&Object.entries(r).some((function(r){var i=ye()(r,2),o=i[0],a=i[1];if(!a)return!1;var s=a.from,u=a.to;if(Zt.compareUnits("day",n)>=0&&Zt.getLargerUnit(o)===n&&(s&&Zt.set(e,o,s),u)){var c,l=n;"day"===n&&(l="date"),Zt.set(t,(c={},ke()(c,l,Zt.get(t,l)-1),ke()(c,o,u),c))}if(Zt.compareUnits(o,n)>=0){var f="day"===o?e.getDay():Zt.get(e,o);if(s&&f<s||u&&f>=u)return!0}}))}},{key:"initExclusion",value:function(){Object.entries(this.include).forEach((function(e){var t=ye()(e,2),n=t[0],r=t[1];if(r){var i=r.from,o=r.to;r.lengthFactor=Zt.getUnitToBaseUnitRatio(n,Zt.getLargerUnit(n))/(o-i),r.lengthFactorExcl=Zt.getUnitToBaseUnitRatio(n,Zt.getLargerUnit(n))/(o-i-1),r.center=i+i/(r.lengthFactor-1)}}))}},{key:"generateTicks",value:function(e,t){var n,r,i,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this.unit,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.increment,s=this,u=[],c=Boolean(s.include),l=0,f=s.getAdjustedDates(e,t),d=f.startDate,h=f.endDate;for(s.tickCache={},c&&s.initExclusion();d<h;){if(n=Zt.getNext(d,o,a,s.weekStartDay),!s.autoAdjust&&n>h&&(n=h),"hour"===o&&a>1&&u.length>0&&0===l){var v=u[u.length-1];0!==(l=(v.startDate.getHours()+a)%24-v.endDate.getHours())&&(n=Zt.add(n,l,"hour"))}i=!1,c?(r=new Date(n.getTime()),i=s.processExclusion(d,n,o)):r=n,s.generateTicksValidatorFn(d)&&!i&&(u.push({id:u.length+1,startDate:d,endDate:n}),s.tickCache[d.getTime()]=u.length-1),d=r}return u}},{key:"getTickFromDate",value:function(e){var t,n,r,i,o=this.records,a=e.getTime(),s=0,u=o.length-1;if(!o.length||e<o[0].startDate||e>o[u].endDate)return-1;if(this.isContinuous){for(;s<u;)a>o[t=s+u+1>>1].endDate.getTime()?s=t+1:a<o[t].startDate.getTime()?u=t-1:s=t;return a>(r=(n=o[s]).startDate.getTime())&&(s+=(a-r)/((i=n.endDate.getTime())-r)),Math.min(Math.max(s,this.visibleTickStart),this.visibleTickEnd)}for(var c=0;c<=u;c++)if(e<=(i=o[c].endDate))return n=c+(e>(r=o[c].startDate)?(e-r)/(i-r):0)}},{key:"getDateFromTick",value:function(e,t){var n=this;if(e===n.visibleTickEnd)return n.endDate;var r=Math.floor(e),i=e-r,o=n.getAt(r);if(!o)return null;var a=0===r?n.adjustedStart:o.startDate,s=r===n.count-1&&n.isContinuous?n.adjustedEnd:o.endDate,u=Zt.add(a,i*(s-a),"millisecond");return t&&(u=n[t+"Date"](u)),u}},{key:"updateTickCache",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;t.count?(t._start=t.first.startDate,t._end=t.last.endDate,t._startMS=t.startDate.getTime(),t._endMS=t.endDate.getTime()):t._start=t._end=t._startMs=t._endMS=null,e||(t.tickCache={},t.forEach((function(e,n){return t.tickCache[e.startDate.getTime()]=n})))}},{key:"dateInAxis",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r=n.startDate,i=n.endDate;if(n.isContinuous)return t?Zt.betweenLesserEqual(e,r,i):Zt.betweenLesser(e,r,i);for(var o,a,s,u=n.getCount(),c=0;c<u;c++)if(o=(s=n.getAt(c)).startDate,a=s.endDate,t&&e<=a||!t&&e<a)return e>=o;return!1}},{key:"timeSpanInAxis",value:function(e,t){var n=this;return t&&t.getTime()!==e.getTime()?n.isContinuous?Zt.intersectSpans(e,t,n.startDate,n.endDate):e<n.startDate&&t>n.endDate||n.getTickFromDate(e)!==n.getTickFromDate(t):this.dateInAxis(e,!0)}},{key:"isTimeSpanInAxis",value:function(e){var t=this,n=t.startMS,r=t.endMS,i=e.startDateMS,o=e.endDateMS;if(!i||!o)return!1;if(o===i)return t.dateInAxis(e.startDate,!0);if(t.isContinuous)return o>n&&i<r;var a=t.getTickFromDate(e.startDate),s=t.getTickFromDate(e.endDate);return!(a===t.count&&Zt.isEqual(e.startDate,t.last.endDate)||0===s&&Zt.isEqual(e.endDate,t.first.startDate))&&(i<n&&o>r||a!==s)}},{key:"forEachAuxInterval",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2?arguments[2]:void 0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this,o=this.endDate,a=this.startDate,s=0;if(a>o)throw new Error("Invalid time axis configuration");for(;a<o;)t=Zt.min(Zt.getNext(a,e,n,this.weekStartDay),o),r.call(i,a,t,s),a=t,s++}},{key:"isTimeAxis",get:function(){return!0}},{key:"viewPreset",get:function(){return this._viewPreset},set:function(e){if(!((e=$x.getPreset(e))instanceof jx))throw new Error("TimeAxis must be configured with the ViewPreset instance that the Scheduler is using");this._viewPreset=e,Object.assign(this,{unit:e.bottomHeader.unit,increment:e.bottomHeader.increment||1,resolutionUnit:e.timeResolution.unit,resolutionIncrement:e.timeResolution.increment,mainUnit:e.mainHeader.unit,shiftUnit:e.shiftUnit,shiftIncrement:e.shiftIncrement||1,defaultSpan:e.defaultSpan||1,presetName:e.id,headers:e.headers})}},{key:"weekStartDay",set:function(e){this._weekStartDay=e},get:function(){return null==this._weekStartDay?Zt.weekStartDay:this._weekStartDay}},{key:"resolution",get:function(){return{unit:this.resolutionUnit,increment:this.resolutionIncrement}},set:function(e){this.resolutionUnit=e.unit,this.resolutionIncrement=e.increment}},{key:"resolutionUnit",get:function(){return this._resolutionUnit},set:function(e){this._resolutionUnit=e}},{key:"resolutionIncrement",get:function(){return this._resolutionIncrement},set:function(e){this._resolutionIncrement=e||1}},{key:"mainUnit",set:function(e){this._mainUnit=e},get:function(){return this._mainUnit}},{key:"shiftUnit",set:function(e){this._shiftUnit=e},get:function(){return this._shiftUnit||this._mainUnit}},{key:"shiftIncrement",set:function(e){this._shiftIncrement=e},get:function(){return this._shiftIncrement||1}},{key:"unit",set:function(e){this._unit=e},get:function(){return this._unit}},{key:"increment",set:function(e){this._increment=e},get:function(){return this._increment}},{key:"defaultSpan",get:function(){return this._defaultSpan},set:function(e){this._defaultSpan=e}},{key:"isContinuous",get:function(){return!1!==this.continuous&&!this.filtered}},{key:"startDate",get:function(){return this._start||(this.first?new Date(this.first.startDate):null)},set:function(e){this._start=Zt.parse(e)}},{key:"endDate",get:function(){return this._end||(this.last?new Date(this.last.endDate):null)},set:function(e){e&&(this._end=Zt.parse(e))}},{key:"startMS",get:function(){return this._startMS}},{key:"endMS",get:function(){return this._endMS}},{key:"include",get:function(){return this._include},set:function(e){var t=this;t._include=e,t.continuous=!e,t.isConfiguring||(t.startDate=t._configuredStartDate,t.endDate=t._configuredEndDate,t.internalOnReconfigure(),t.trigger("includeChange"))}},{key:"visibleTickTimeSpan",get:function(){return this.isContinuous?this.visibleTickEnd-this.visibleTickStart:this.count}},{key:"ticks",get:function(){return this.records}}],[{key:"defaultConfig",get:function(){return{modelClass:Qy,continuous:!0,originalContinuous:null,include:null,autoAdjust:!0,unit:null,increment:null,resolutionUnit:null,resolutionIncrement:null,weekStartDay:null,mainUnit:null,shiftUnit:null,shiftIncrement:1,adjustedStart:null,adjustedEnd:null,visibleTickStart:null,visibleTickEnd:null,defaultSpan:1,tickCache:{},viewPreset:null}}}]),n}(No);function zx(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Vx._$name="TimeAxis";var Wx=function(e){fe()(n,e);var t=zx(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e,t){e.useBackgroundCanvas=!0,e.on({visibleRangeChange:"onRangeChange",thisObj:this}),we()(pe()(n.prototype),"construct",this).call(this,e,t)}},{key:"doDisable",value:function(e){we()(pe()(n.prototype),"doDisable",this).call(this,e),this.isConfiguring||this.refresh()}},{key:"render",value:function(){this.refresh()}},{key:"refresh",value:function(){var e=this,t=e.client,n=t.timeAxis,r=t.timeAxisViewModel,i=t.isHorizontal;if(n.startDate&&e.startDate){var o=r.columnLinesFor,a=Math.max(o-1,0),s=e.startDate.getTime(),u=e.endDate.getTime(),c=[],l=new Set;if(e.element||(e.element=Cr.createElement({parent:t.backgroundCanvas,className:"b-column-lines-canvas"})),!e.disabled){var f=function(e,t){var n=e.end.getTime();n>s&&n<u&&!l.has(n)&&(l.add(n),c.push({className:t?"b-column-line-major":"b-column-line",style:ke()({},i?"left":"top",e.coord+e.width-1),dataset:{line:t?"major-".concat(e.index):"line-".concat(e.index)}}))};o!==a&&r.columnConfig[a].forEach((function(e){return f(e,!0)})),r.columnConfig[o].forEach((function(e){return f(e,!1)}))}Gs.sync({targetElement:e.element,onlyChildren:!0,domConfig:{children:c,syncOptions:{releaseThreshold:4}},syncIdField:"line"})}}},{key:"onRangeChange",value:function(e){var t=e.startDate,n=e.endDate;this.startDate=t,this.endDate=n,this.refresh()}},{key:"updateCanvasSize",value:function(){this.refresh()}}],[{key:"$name",get:function(){return"ColumnLines"}},{key:"pluginConfig",get:function(){return{after:["render","updateCanvasSize"]}}}]),n}(qr);function Gx(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Wx._$name="ColumnLines",fv.registerFeature(Wx,!0,["Scheduler","Gantt"]);var Yx=function(e){return function(e){fe()(n,e);var t=Gx(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e,t){we()(pe()(n.prototype),"construct",this).call(this,e,t);var r=this;r.view=e,r.eventName=e.scheduledEventName,e.on("readOnly",(function(){return r.updateCreateListeners()})),r.updateCreateListeners()}},{key:"doDestroy",value:function(){var e,t,r=this;r.detachListeners("view"),r.creationData=null,null===(e=r.mouseDetacher)||void 0===e||e.call(r),null===(t=r.creationTooltip)||void 0===t||t.destroy(),we()(pe()(n.prototype),"doDestroy",this).call(this)}},{key:"updateCreateListeners",value:function(){var e,t=this;t.view&&(t.detachListeners("view"),t.isCreateAllowed&&t.view.on((e={name:"view"},ke()(e,"".concat(t.eventName,"mouseenter"),"onTimeSpanMouseEnter"),ke()(e,"".concat(t.eventName,"mouseleave"),"onTimeSpanMouseLeave"),ke()(e,"thisObj",t),e)))}},{key:"onTimeSpanMouseEnter",value:function(e){var t=e["".concat(this.eventName,"Record")],n=e["".concat(this.eventName,"Element")];this.showTerminals(t,Cr.down(n,e.source.eventInnerSelector))}},{key:"onTimeSpanMouseLeave",value:function(e){var t=e["".concat(this.eventName,"Element")];this.creationData&&Cr.isDescendant(t,this.creationData.sourceTerminal.parentElement)||this.hideTerminals(t)}},{key:"onTerminalMouseOut",value:function(e){var t=this,n=Cr.up(e.target,t.view.eventSelector);!n||Cr.isDescendant(n,t.showingTerminalsFor)||t.creationData&&n===t.creationData.sourceTerminal.parentElement||(t.hideTerminals(n),t.view.unhover(e))}},{key:"onTerminalMouseDown",value:function(e){var t=this;if(0===e.button&&!t.creationData){var n,r=t.view,i=r.timeAxisSubGridElement,o=e.target,a=o.parentElement.closest(r.eventSelector),s=En.from(r.element,document.body);e.preventDefault(),e.stopPropagation(),t.creationData={source:r.resolveTimeSpanRecord(a),sourceTerminal:o,startPoint:En.from(o,i).center,startX:e.pageX-s.x+r.scrollLeft,startY:e.pageY-s.y+r.scrollTop,valid:!1,sourceResource:null===(n=r.resolveResourceRecord)||void 0===n?void 0:n.call(r,a)},t.mouseDetacher=nu.on({mouseup:{element:t.listenersTarget,handler:"onMouseUp"},mousemove:{element:i,handler:"onMouseMove"},thisObj:t})}}},{key:"onMouseMove",value:function(e){var t=this,n=t.view,r=t.creationData,i=En.from(n.element,document.body),o=e.pageX-i.x+n.scrollLeft-r.startX,a=e.pageY-i.y+n.scrollTop-r.startY,s=Math.round(Math.sqrt(o*o+a*a))-3,u=Math.atan2(a,o),c=t.connector;if(!c){if(!1===t.onRequestDragCreate())return;c=t.connector}c.style.width="".concat(s,"px"),c.style.transform="rotate(".concat(u,"rad)"),t.lastMouseMoveEvent=e}},{key:"onRequestDragCreate",value:function(){var e=this,t=e.view,n=e.creationData;if(!1===t.trigger("beforeDependencyCreateDrag",{data:n}))return e.abort(),!1;t.element.classList.add("b-creating-dependency"),e.connector=e.createConnector(n.startPoint.x,n.startPoint.y),t.trigger("dependencyCreateDragStart",{data:n}),e.showCreationTooltip&&(e.creationTooltip=e.creationTooltip||e.createDragTooltip(),e.creationTooltip.disabled=!1,e.creationTooltip.show()),t.scrollManager.startMonitoring({element:t.timeAxisSubGridElement,callback:function(){return e.lastMouseMoveEvent&&e.onMouseMove(e.lastMouseMoveEvent)},thisObj:e})}},{key:"onOverTargetTerminal",value:function(e){var t=this,n=e.target,r=t.view,i=t.creationData,o=t.connector;if(!an.isPromise(i.valid))if(n!==i.sourceTerminal){if(n!==i.targetTerminal){i.targetTerminal=n,i.target=r.resolveTimeSpanRecord(n),r.resolveResourceRecord&&(i.targetResource=r.resolveResourceRecord(n));var a,s=i.sourceTerminal.dataset.side,u=i.targetTerminal.dataset.side,c=function(e){t.isDestroyed||(i.valid=e,n.classList.add(e?"b-valid":"b-invalid"),o.classList.add(e?"b-valid":"b-invalid"),r.trigger("dependencyValidationComplete",{data:i}))};switch(!0){case"left"===s&&"left"===u:a=lx.Type.StartToStart;break;case"left"===s&&"right"===u:a=lx.Type.StartToEnd;break;case"right"===s&&"left"===u:a=lx.Type.EndToStart;break;case"right"===s&&"right"===u:a=lx.Type.EndToEnd}r.trigger("dependencyValidationStart",{data:i}),i.valid=t.dependencyStore.isValidDependency(i.source,i.target,a),an.isPromise(i.valid)?i.valid.then(c):c(i.valid)}}else o.classList.remove("b-valid"),o.classList.remove("b-invalid")}},{key:"onMouseUp",value:function(e){var t=this,n=t.creationData,r=e.target;t.abort();var i=function(){var r=Wr()(Vr.a.mark((function r(){var i;return Vr.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(n.targetTerminal=e.target,i=t.createDependency(n),!an.isPromise(i)){r.next=5;break}return r.next=5,i;case 5:t.view.trigger("dependencyCreateDrop",{data:n});case 6:case"end":return r.stop()}}),r)})));return function(){return r.apply(this,arguments)}}(),o=function(e){t.view.trigger("afterDependencyCreateDrop",{data:e})};n.valid&&r.matches(".".concat(t.terminalCls))?an.isPromise(n.valid)?n.valid.then((function(e){n.valid=e,e?i().then((function(){return o(n)})):o(n)})):i().then((function(){return o(n)})):(n.valid=!1,o(n))}},{key:"abort",value:function(){var e,t=this,n=t.view,r=t.creationData;if(r){var i=r.source,o=r.sourceResource,a=r.target,s=r.targetResource;if(i){var u=n.getElementFromEventRecord(i,o);u&&t.hideTerminals(u)}if(a){var c=n.getElementFromEventRecord(a,s);c&&t.hideTerminals(c)}}t.creationTooltip&&(t.creationTooltip.disabled=!0),t.creationData=t.lastMouseMoveEvent=null,null===(e=t.mouseDetacher)||void 0===e||e.call(t),t.removeConnector()}},{key:"createConnector",value:function(e,t){var n=this.view;return this.connector=Cr.createElement({parent:n.timeAxisSubGridElement,className:"".concat(this.baseCls,"-connector"),style:"left:".concat(e,"px;top:").concat(t,"px")}),n.element.classList.add("b-creating-dependency"),this.connector}},{key:"createDragTooltip",value:function(){var e=this,t=e.view;return e.creationTooltip=new Kl(Object.assign({id:"".concat(t.id,"-dependency-drag-tip"),cls:"b-sch-dependency-creation-tooltip",loadingMsg:"",autoShow:!0,anchorToTarget:!1,forSelector:".b-sch-terminal",forElement:t.timeAxisSubGridElement,trackMouse:!0,constrainTo:null,getHtml:function(t){var n=t.tip,r=t.event;if(e.creationData)return r&&e.onOverTargetTerminal(r),e.generateTooltipContent(n,e.creationData)},header:{dock:"right"},listeners:{pointerout:function(t){var n=t.source,r=e.creationData;return r.target=r.targetTerminal=null,r.valid=!1,n.html=n.getHtml({tip:n}),!1},beforeShow:function(e){var t=e.source;t.html=t.getHtml({tip:t})}}},e.creationTooltip||{}))}},{key:"removeConnector",value:function(e){var t=this,n=t.connector,r=t.view;n&&(n.classList.add("b-removing"),n.style.width="0",t.setTimeout((function(){n.remove(),t.connector=null,e&&e.call(t)}),200)),r.element.classList.remove("b-creating-dependency"),t.creationTooltip&&t.creationTooltip.hide(),r.scrollManager.stopMonitoring(r.timeAxisSubGridElement)}},{key:"showTerminals",value:function(e,t){var n=this;if(n.isCreateAllowed){var r=n.terminalCls,i="".concat(r,"s-visible");(t=Cr.down(t,n.view.eventInnerSelector)).classList.contains(i)||this.view.element.classList.contains("b-resizing-event")||n.view.readOnly||(n.terminalSides.forEach((function(e){var i=Cr.createElement({parent:t,className:"".concat(r," ").concat(r,"-").concat(e),dataset:{side:e,feature:!0}});i.detacher=nu.on({element:i,mouseout:"onTerminalMouseOut",mousedown:{handler:"onTerminalMouseDown",capture:!0},thisObj:n})})),t.classList.add(i),e.cls.add(i),n.showingTerminalsFor=t)}}},{key:"hideTerminals",value:function(e){var t=this,n=t.client.getTimeSpanMouseEventParams(e),r=null==n?void 0:n["".concat(t.eventName,"Record")],i="".concat(t.terminalCls,"s-visible");Cr.forEachSelector(e,".".concat(t.terminalCls),(function(e){e.detacher&&e.detacher(),e.remove()})),Cr.down(e,t.view.eventInnerSelector).classList.remove(i),r.cls.remove(i),t.showingTerminalsFor=null}},{key:"createDependency",value:function(e){var t=e.source,n=e.target,r=e.sourceTerminal.dataset.side,i=e.targetTerminal.dataset.side,o=("left"===r?0:2)+("right"===i?1:0);return this.dependencyStore.add({from:t.id,to:n.id,type:o,fromSide:r,toSide:i})[0]}},{key:"generateTooltipContent",value:function(e,t){var n,r,i,o,a,s,u=this,c=t.valid,l=e.element.classList;return Object.assign(t,{fromText:t.source.name,toText:null!==(n=null===(r=t.target)||void 0===r?void 0:r.name)&&void 0!==n?n:"",fromSide:t.sourceTerminal.dataset.side,toSide:null!==(i=null===(o=t.targetTerminal)||void 0===o?void 0:o.dataset.side)&&void 0!==i?i:""}),an.isPromise(c)?(l.remove("b-invalid"),l.add("b-checking"),new Promise((function(n){return c.then((function(r){t.valid=r,e.isDestroyed||n(u.generateTooltipContent(e,t))}))}))):(!0===c?(l.remove("b-invalid"),l.remove("b-checking"),a="valid",s=u.L("L{Dependencies.valid}")):(l.remove("b-checking"),l.add("b-invalid"),a="invalid",s=u.L("L{Dependencies.invalid}")),e.title='<i class="b-icon b-icon-'.concat(a,'"></i>').concat(s),'<table class="b-sch-dependency-creation-tooltip">\n                        <tr><td>'.concat(u.L("L{Dependencies.from}"),": </td><td>").concat(t.fromText,'</td><td><div class="b-sch-box b-').concat(t.fromSide,'"></div></td></tr>\n                        <tr><td>').concat(u.L("L{Dependencies.to}"),": </td><td>").concat(t.toText,'</td><td><div class="b-sch-box b-').concat(t.toSide,'"></div></td></tr>\n                    </table>'))}},{key:"allowCreate",set:function(e){this._allowCreate=e,this.updateCreateListeners()},get:function(){return this._allowCreate}},{key:"isCreateAllowed",get:function(){return this.allowCreate&&!this.view.readOnly&&!this.disabled}},{key:"listenersTarget",get:function(){return document.body}}],[{key:"$name",get:function(){return"DependencyCreation"}},{key:"defaultConfig",get:function(){return{showCreationTooltip:!0,creationTooltip:null,terminalCls:"b-sch-terminal",terminalSides:["left","top","right","bottom"],allowCreate:!0}}}]),n}(e||ue)};function Ux(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var qx=function(e){fe()(n,e);var t=Ux(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"menuConfig",get:function(){return an.assign({},we()(pe()(n.prototype),"menuConfig",this),{clippedBy:[this.client.timeAxisSubGridElement,this.client.bodyContainer]})}}]),n}(av);function Kx(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}qx._$name="TimeSpanMenuBase";var Xx=function(e){fe()(n,e);var t=Kx(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"onElementKeyDown",value:function(e){!e.handled&&e.target.matches(this.client.eventSelector)&&" "===e.key&&this.internalShowContextMenu(this.createContextMenuEventForElement(e.target))}},{key:"getDataFromEvent",value:function(e){var t=we()(pe()(n.prototype),"getDataFromEvent",this).call(this,e),r=t.targetElement,i=this.client,o=i.resolveEventRecord(r),a=o&&(i.resolveResourceRecord(r)||i.resourceStore.last),s=o&&i.resolveAssignmentRecord(r);return an.assign(t,{eventElement:r,eventRecord:o,resourceRecord:a,assignmentRecord:s})}},{key:"getTargetElementFromEvent",value:function(e){var t=e.target;return Cr.up(t,this.client.eventSelector)||t}},{key:"shouldShowMenu",value:function(e){return e.eventRecord}},{key:"showContextMenuFor",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.targetElement,r=t.event;this.disabled||(n||(n=this.getElementFromRecord(e)))&&(r=r||this.createContextMenuEventForElement(n),this.internalShowContextMenu(r))}},{key:"getElementFromRecord",value:function(e){return this.client.getElementsFromEventRecord(e)[0]}},{key:"populateEventMenu",value:function(e){var t=e.items,n=this.client;n.readOnly||(t.deleteEvent={text:"L{SchedulerBase.Delete event}",icon:"b-icon b-icon-trash",weight:200,onItem:function(e){var t,r=e.menu,i=e.eventRecord,o=null===(t=r.focusInEvent)||void 0===t?void 0:t.relatedTarget;o&&(o.focus(),n.navigator.activeItem=o),n.removeRecords([i])}},n.eventStore.usesSingleAssignment||(t.unassignEvent={text:"L{SchedulerBase.Unassign event}",icon:"b-icon b-icon-unassign",weight:300,name:"unassignEvent",onItem:function(e){var t,r=e.menu,i=e.eventRecord,o=e.resourceRecord,a=null===(t=r.focusInEvent)||void 0===t?void 0:t.relatedTarget;a&&(a.focus(),n.navigator.activeItem=a),i.unassign(o)}}))}}],[{key:"$name",get:function(){return"EventMenu"}},{key:"defaultConfig",get:function(){return{type:"event"}}},{key:"pluginConfig",get:function(){var e=we()(pe()(n),"pluginConfig",this);return e.chain.push("populateEventMenu"),e}}]),n}(qx);function Zx(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Xx.featureClass="",Xx._$name="EventMenu",fv.registerFeature(Xx,!0,"Scheduler");var Jx=function(e){fe()(n,e);var t=Zx(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e,t){we()(pe()(n.prototype),"construct",this).apply(this,arguments),this.scheduler=e,y.a.deprecate("Scheduler","5.0.0","`EventContextMenu` feature is deprecated, in favor of `EventMenu` feature. Please see https://bryntum.com/docs/scheduler/#guides/upgrades/3.1.0.md for more information."),e.features.eventMenu&&(e.features.eventMenu.disabled=!0)}}],[{key:"$name",get:function(){return"EventContextMenu"}}]),n}(Xx);function Qx(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Jx.featureClass="",Jx._$name="EventContextMenu",fv.registerFeature(Jx);var eE=function(e){fe()(n,e);var t=Qx(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"generateContent",value:function(e){var t=e.date,n=this.template(e),r=this.div;return r.innerHTML=n,this.updateDateIndicator(r,t),r.innerHTML}},{key:"updateDateIndicator",value:function(e,t){var n=e.querySelector(".b-sch-hour-indicator"),r=e.querySelector(".b-sch-minute-indicator");t&&n&&r&&("hour"===this.mode?(n.style.transform="rotate(".concat(t.getHours()%12*30,"deg)"),r.style.transform="rotate(".concat(6*t.getMinutes(),"deg)")):(n.style.transform="none",r.style.transform="none"))}},{key:"mode",set:function(e){this._mode=e},get:function(){if(this._mode)return this._mode;var e=Zt.compareUnits(this.scheduler.timeAxisViewModel.timeResolution.unit,"day")<0,t=Zt.formatContainsHourInfo(this.scheduler.displayDateFormat);return e&&t?"hour":"day"}},{key:"template",set:function(e){this._template=e},get:function(){return this._template}}],[{key:"defaultConfig",get:function(){return{minuteHeight:8,minuteTop:2,hourHeight:8,hourTop:2,handLeft:10,div:document.createElement("div"),scheduler:null,template:function(e){return'<div class="b-sch-clockwrap b-sch-clock-'.concat(e.mode||this.mode," ").concat(e.cls||"",'">\n                    <div class="b-sch-clock">\n                        <div class="b-sch-hour-indicator">').concat(Zt.format(e.date,"MMM"),'</div>\n                        <div class="b-sch-minute-indicator">').concat(Zt.format(e.date,"D"),'</div>\n                        <div class="b-sch-clock-dot"></div>\n                    </div>\n                    <span class="b-sch-clock-text">').concat(e.text,"</span>\n                </div>")}}}}]),n}(ue);function tE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}eE._$name="ClockTemplate";var nE=function(e){fe()(r,e);var t,n=tE(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"render",value:function(){var e,t,n=this,r=n.client,i=n.constrainDragToTimeline;null===(e=n.drag)||void 0===e||e.destroy(),n.drag=new hu(Object.assign((t={name:n.constructor.name,mode:"translateXY"},ke()(t,r.isHorizontal?"lockY":"lockX",n.constrainDragToResource),ke()(t,r.isHorizontal?"lockX":"lockY",n.constrainDragToTimeSlot),ke()(t,"minX",!0),ke()(t,"maxX",!0),ke()(t,"constrain",!1),ke()(t,"cloneTarget",!i),ke()(t,"dragWithin",i?null:document.body),ke()(t,"hideOriginalElement",!0),ke()(t,"outerElement",r.timeAxisSubGridElement),ke()(t,"targetSelector",r.eventSelector),ke()(t,"isElementDraggable",(function(e,t){return!r.readOnly&&(!n.dragHelperConfig||!n.dragHelperConfig.isElementDraggable||n.dragHelperConfig.isElementDraggable(e,t))&&n.isElementDraggable(e,t)})),ke()(t,"scrollManager",i?r.scrollManager:null),ke()(t,"transitionDuration",r.transitionDuration),ke()(t,"listeners",{beforedragstart:"onBeforeDragStart",dragstart:"onDragStart",drag:"onDrag",drop:"onDrop",abort:"onDragAbort",reset:"onDragReset",thisObj:n}),t),n.dragHelperConfig)),r.rowManager.on({changeTotalHeight:"updateYConstraint",thisObj:n}),n.showTooltip&&(n.clockTemplate=new eE({scheduler:r}))}},{key:"doDestroy",value:function(){var e,t,n;null===(e=this.drag)||void 0===e||e.destroy(),null===(t=this.clockTemplate)||void 0===t||t.destroy(),null===(n=this.tip)||void 0===n||n.destroy(),we()(pe()(r.prototype),"doDestroy",this).call(this)}},{key:"onBeforeDragStart",value:function(e){var t=e.context,n=this.client,r=n.scheduledEventName,i=n.resolveEventRecord(t.element);if(this.disabled||!i||!1===i.isDraggable)return!1;t.pointerStartDate=n.getDateFromXY([t.startClientX,t.startPageY],null,!1);var o=!1!==n.trigger("before".concat(r,"Drag"),{eventRecord:i,context:this.dragData});return!1!==o&&this.updateYConstraint(i),o}},{key:"onDragStart",value:function(e){var t=e.context,n=e.event,r=this,i=r.client;r.currentOverClient=i,r.scrollClients={},r.onMouseOverNewTimeline(i);var o=r.dragData=r.getDragData(t,n);if(t.element.retainElement=!0,r.showTooltip){var a=o.context.dragProxy?o.context.dragProxy.firstChild:t.element;r.tip?r.tip.showBy(a):(r.tip=new Kl({id:"".concat(i.id,"-event-drag-tip"),align:"b-t",autoShow:!0,updateContentOnMouseMove:!0,clippedBy:r.constrainDragToTimeline?[i.timeAxisSubGridElement,i.bodyContainer]:null,forElement:a,getHtml:r.getTipHtml.bind(r),style:"pointer-events:none",cls:r.tooltipCls}),r.tip.on("innerhtmlupdate",r.updateDateIndicator,r))}r.triggerDragStart(o)}},{key:"updateDateIndicator",value:function(){var e=this.dragData,t=e.startDate,n=e.endDate,r=this.tip,i=r.element.querySelector(".b-sch-tooltip-enddate");this.clockTemplate.updateDateIndicator(r.element,t),i&&this.clockTemplate.updateDateIndicator(i,n)}},{key:"onDrag",value:function(e){var t,n=e.context,r=e.event,i=this,o=i.dragData,a=o.startDate;if(i.constrainDragToTimeline)t=i.client;else{var s=r.target;if(/^touch/.test(r.type)){var u=En.from(o.context.element,null,!0).center;s=Cr.elementFromPoint(u.x,u.y)}t=oc.fromElement(s,"timelinebase")}var c=i.client.features.dependencies,l=n.newX,f=n.newY;if(t){if(t!==i.currentOverClient&&i.onMouseOverNewTimeline(t),i.updateDragContext(n,r),i.constrainDragToTimeline&&!i.constrainDragToTimeSlot&&(i.showExactDropPosition||i.client.timeAxisViewModel.snap)){var d=t.getDateFromCoordinate(i.getCoordinate(o.draggedEntities[0],n.element,[l,f]))-o.sourceDate,h=new Date(o.origStart-0+d),v=t.timeAxisViewModel.getDistanceBetweenDates(h,o.startDate);o.startDate>=t.timeAxis.startDate&&null!=v&&(i.client.isVertical?Cr.addTranslateY(n.element,v):Cr.addTranslateX(n.element,v))}i.triggerEventDrag(o,a);var p=i.checkDragValidity(o,r);p&&"boolean"!=typeof p&&(n.message=p.message||"",p=p.valid),n.valid=!1!==p,i.showTooltip&&i.tip.realign(),c&&c.updateDependenciesForTimeSpan(o.draggedEntities[0],o.context.element.querySelector(t.eventInnerSelector),o.newResource)}else c&&c.updateDependenciesForTimeSpan(o.draggedEntities[0],o.context.element)}},{key:"onMouseOverNewTimeline",value:function(e){var t=this.scrollClients||{};(this.currentOverClient.element.classList.remove("b-dragging-"+this.currentOverClient.scheduledEventName),e.element.classList.add("b-dragging-"+e.scheduledEventName),e.id in t)||(e.scrollManager.startMonitoring({element:e.timeAxisSubGridElement}),t[e.id]=e);this.currentOverClient=e}},{key:"onDrop",value:function(e){var t,n=e.context,r=e.event,i=this,o=i.currentOverClient,a=i.dragData,s=!1;i.updateDragContext(n,r),null===(t=i.tip)||void 0===t||t.hide(),n.valid&&a.startDate&&a.endDate&&(a.finalize=function(){i.finalize.apply(i,arguments),n.finalize.apply(n,arguments)},o.trigger("before".concat(o.capitalizedEventName,"DropFinalize"),{context:a,event:r}),n.async=a.async,!n.async&&i.isValidDrop(a)&&(s=a.startDate-a.origStart!=0||a.newResource!==a.resourceRecord)),n.async||i.finalize(a.valid&&n.valid&&s)}},{key:"onDragAbort",value:function(e){var t,n=e.context,r=this;r.client.currentOrientation.onDragAbort({context:n,dragData:r.dragData}),r.resumeElementRedrawing(r.dragData.record),null===(t=r.tip)||void 0===t||t.hide(),r.triggerDragAbort(r.dragData)}},{key:"onDragReset",value:function(e){var t,n,r=e.source,i=this,o=i.scrollClients||{};for(var a in o)o[a].scrollManager.stopMonitoring(o[a].timeAxisSubGridElement);r.context&&r.context.started&&i.dragData.eventBarEls[0].classList.remove("b-drag-main");i.scrollClients=null,null===(t=i.currentOverClient)||void 0===t||t.element.classList.remove("b-dragging-"+i.currentOverClient.scheduledEventName),!1===(null===(n=i.dragData)||void 0===n?void 0:n.context.valid)&&i.currentOverClient.features.dependencies&&i.currentOverClient.features.dependencies.scheduleDraw(!0)}},{key:"onInternalInvalidDrop",value:function(){var e;null===(e=this.tip)||void 0===e||e.hide(),this.drag.abort(),this.triggerAfterDrop(this.dragData,!1)}},{key:"finalize",value:(t=Wr()(Vr.a.mark((function e(t){var n,r,i,o;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(n=this).dragData,i=r.context,r.draggedEntities.forEach((function(e,t){n.resumeElementRedrawing(e),r.eventBarEls[t].classList.remove(n.drag.draggingCls),r.eventBarEls[t].retainElement=!1})),!t){e.next=11;break}if(o=n.updateRecords(r),!an.isPromise(o)){e.next=8;break}return i.async=!0,e.next=8,o;case 8:r.valid?(n.drag.reset(),n.triggerAfterDrop(r,!0)):n.onInternalInvalidDrop(),e.next=12;break;case 11:n.onInternalInvalidDrop();case 12:return e.abrupt("return",o);case 13:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"updateDragContext",value:function(e,t){var n=this,r=n.drag,i=n.dragData,o=n.currentOverClient,a=o.isHorizontal,s=e.element,u=En.from(s,o.timeAxisSubGridElement),c=i.draggedEntities[0],l=c.isAssignment?c.event:c,f=n.constrainDragToTimeSlot||(a?r.lockX:r.lockY);if(i.browserEvent=t,f)i.timeDiff=0;else{if(o.timeAxis.isContinuous){var d=i.dateConstraints,h=o.timeAxisSubGrid.scrollable,v=h.viewport,p=o.isHorizontal?e.pageX-v.x+h.x:e.pageY-v.y+h.y,g=o.timeAxisViewModel.getDateFromPosition(p,null,!0),y=i.timeDiff=g-e.pointerStartDate;i.startDate=n.adjustStartDate(i.origStart,y),d&&(i.startDate=Zt.constrain(i.startDate,d.start,new Date(d.end-l.durationMS))),i.endDate=new Date(i.startDate-0+i.duration)}else{var m=n.resolveStartEndDates(u);i.valid=Boolean(m.startDate&&m.endDate),i.valid&&(i.startDate=m.startDate,i.endDate=m.endDate)}i.valid&&(i.timeDiff=i.startDate-i.origStart)}if(Object.assign(i,n.getProductDragContext(i)),i.valid)if(i.endDate<=o.timeAxis.startDate||i.startDate>=o.timeAxis.endDate)i.context.valid=!1,i.context.message=n.L("L{EventDrag.noDropOutsideTimeline}");else{var k=!t||n.checkDragValidity(i,t);k&&"boolean"!=typeof k?(i.context.valid=!1!==k.valid,i.context.message=k.message):(i.context.valid=!1!==k,i.context.message="")}else i.context.valid=!1}},{key:"suspendElementRedrawing",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.getRecordElement(e);n&&(n.retainElement=t),e.instanceMeta(this.client).retainElement=t}},{key:"resumeElementRedrawing",value:function(e){this.suspendElementRedrawing(e,!1)}},{key:"getDragData",value:function(e,t){var n=this,r=n.client,i=n.drag,o=n.setupProductDragData(e),a=o.record,s=o.dateConstraints,u=o.eventBarEls,c=o.draggedEntities,l=a.isAssignment?a.event:a,f=l.startDate,d=l.endDate,h=r.timeAxis,v=f<h.startDate,p=d>h.endDate,g=n.getCoordinate(l,e.element,[e.elementStartX,e.elementStartY]),y=n.getCoordinate(l,e.element,[e.startClientX,e.startClientY]);c.forEach((function(e){return n.suspendElementRedrawing(e)})),i.startEvent.ctrlKey&&(a.isAssignment?r.selectAssignment(a,!0):r.selectEvent(a,!0));var m={context:e,dateConstraints:s,eventBarEls:u,record:a,draggedEntities:c,sourceDate:v?f:r.getDateFromCoordinate(g),screenSourceDate:r.getDateFromCoordinate(y,null,!1),origStart:f,origEnd:d,startDate:f,endDate:d,timeDiff:0,startsOutsideView:v,endsOutsideView:p,duration:d-f,browserEvent:t};if(u.forEach((function(e){e.classList.add(i.draggingCls),e.classList.remove("b-sch-event-hover"),e.classList.remove("b-active")})),u.length>1)if(n.constrainDragToTimeline?e.relatedElements=u.slice(1):e.relatedElements=u.slice(1).map((function(e){var t=Cr.getOffsetX(e,i.dragWithin),n=Cr.getOffsetY(e,i.dragWithin),r=e.offsetWidth,o=e.offsetHeight,a=i.createProxy(e);return Cr.setTranslateXY(a,t,n),a.style.width="".concat(r,"px"),a.style.height="".concat(o,"px"),i.dragWithin.appendChild(a),e.classList.add("b-drag-original"),i.hideOriginalElement&&e.classList.add("b-hidden"),a})),e.relatedElStartPos=[],e.relatedElDragFromPos=[],n.unifiedDrag){n.client.isAnimating=!0,nu.on({element:u[1],transitionend:function(){n.client.isAnimating=!1},once:!0}),u[0].classList.add("b-drag-main");var k=Cr.getTranslateXY(e.element),b=ye()(k,2),w=b[0],C=b[1];e.relatedElements.forEach((function(t,n){e.relatedElStartPos[n]=Cr.getTranslateXY(t),w+=10,C+=10,Cr.setTranslateXY(t,w,C),e.relatedElDragFromPos[n]=[w,C]}))}else e.relatedElements.forEach((function(t,n){e.relatedElStartPos[n]=e.relatedElDragFromPos[n]=Cr.getTranslateXY(t)}));return m}},{key:"getRelatedRecords",value:function(e){return[]}},{key:"setupConstraints",value:function(e,t,n,r){var i=!this.showExactDropPosition&&n>1?n:0;r?this.setXConstraint(e.left,e.right-t.width,i):this.setXConstraint(!0,!0,i),this.setYConstraint(e.top,e.bottom-t.height,0)}},{key:"updateYConstraint",value:function(e){var t=this,n=t.client,r=t.drag.context,i=n.timeAxisViewModel.snapPixelAmount;if(r&&!t.drag.lockY){var o;if(!t.constrainDragToTimeline)return void t.setYConstraint(null,null,i);o=n.getScheduleRegion(null,e),t.setYConstraint(o.top,o.bottom-r.element.offsetHeight,i)}else t.setYConstraint(null,null,i)}},{key:"setXConstraint",value:function(e,t,n){var r=this.drag;r.leftConstraint=e,r.rightConstraint=t,r.minX=e,r.maxX=t}},{key:"setYConstraint",value:function(e,t,n){var r=this.drag;r.topConstraint=e,r.bottomConstraint=t,r.minY=e,r.maxY=t}},{key:"adjustStartDate",value:function(e,t){return this.client.timeAxis.roundDate(new Date(e-0+t),!!this.client.snapRelativeToEventStartDate&&e)}},{key:"resolveStartEndDates",value:function(e){var t=this.client.getStartEndDatesFromRectangle(e,"round",this.dragData.duration);return{startDate:t.start,endDate:t.end}}},{key:"getTipHtml",value:function(){var e,t=this,n=t.dragData,r=t.client,i=n.startDate,o=n.endDate,a=n.draggedEntities,s=r.getFormattedDate(i),u=r.getFormattedEndDate(o,i),c=n.context,l=c.valid,f=c.message,d=a[0],h=d.isTask?d:d.event;return t.dragTipTemplate((e={valid:l,startDate:i,endDate:o,startText:s,endText:u,dragData:n,message:f||""},ke()(e,r.scheduledEventName+"Record",h),ke()(e,"startClockHtml",t.clockTemplate.template({date:i,text:s,cls:"b-sch-tooltip-startdate"})),ke()(e,"endClockHtml",h.isMilestone?"":t.clockTemplate.template({date:o,text:u,cls:"b-sch-tooltip-enddate"})),e))}},{key:"isValidDrop",value:function(e){throw new Error("Implement in subclass")}},{key:"checkDragValidity",value:function(e){throw new Error("Implement in subclass")}},{key:"updateRecords",value:function(e){throw new Error("Implement in subclass")}},{key:"isElementDraggable",value:function(e,t){throw new Error("Implement in subclass")}},{key:"getCoordinate",value:function(e,t,n){throw new Error("Implement in subclass")}},{key:"setupProductDragData",value:function(e){throw new Error("Implement in subclass")}},{key:"getProductDragContext",value:function(e){throw new Error("Implement in subclass")}},{key:"getRecordElement",value:function(e){throw new Error("Implement in subclass")}},{key:"constrainDragToTimeSlot",set:function(e){var t=this.client.isHorizontal?"lockX":"lockY";this._constrainDragToTimeSlot=e,this.drag&&(this.drag[t]=e)},get:function(){return this._constrainDragToTimeSlot}},{key:"constrainDragToResource",set:function(e){var t=this.client.isHorizontal?"lockY":"lockX";this._constrainDragToResource=e,this.drag&&(this.drag[t]=e)},get:function(){return this._constrainDragToResource}}],[{key:"defaultConfig",get:function(){return{dragTipTemplate:function(e){return'\n                <div class="b-sch-tip-'.concat(e.valid?"valid":"invalid",'">\n                    ').concat(e.startClockHtml,"\n                    ").concat(e.endClockHtml,'\n                    <div class="b-sch-tip-message">').concat(e.message,"</div>\n                </div>\n            ")},constrainDragToResource:!0,showTooltip:!0,showExactDropPosition:!1,constrainDragToTimeline:!0,store:null,dragHelperConfig:null,tooltipCls:null}}},{key:"pluginConfig",get:function(){return{chain:["render"]}}}]),r}(qr);function rE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}nE._$name="DragBase";var iE=function(e){fe()(i,e);var t,n,r=rE(i);function i(){return v()(this,i),r.apply(this,arguments)}return g()(i,[{key:"isElementDraggable",value:function(e,t){var n=this.scheduler,r=Cr.up(e,n.eventSelector),i=n.features.eventResize;if(!r||this.disabled)return!1;if(e.matches('[class$="-handle"]'))return!1;var o=n.resolveEventRecord(r);return!(i&&o.resizable&&!o.isMilestone&&i.resize.overAnyHandle(t,r))}},{key:"getTriggerParams",value:function(e){var t=e.assignmentRecords,n=e.eventRecords;return{context:e,draggedRecords:n,eventRecords:n,assignmentRecords:t}}},{key:"triggerEventDrag",value:function(e,t){e.startDate-t==0&&e.newResource===e.resourceRecord||this.scheduler.trigger("eventDrag",Object.assign(this.getTriggerParams(e),{startDate:e.startDate,endDate:e.endDate,newResource:e.newResource}))}},{key:"triggerDragStart",value:function(e){this.scheduler.trigger("eventDragStart",this.getTriggerParams(e))}},{key:"triggerDragAbort",value:function(e){this.scheduler.trigger("eventDragAbort",this.getTriggerParams(e))}},{key:"triggerAfterDrop",value:function(e,t){this.currentOverClient.trigger("afterEventDrop",Object.assign(this.getTriggerParams(e),{valid:t}))}},{key:"onDragStart",value:function(e){var t=e.context,n=e.event,r=this.client.features,o=r.eventMenu,a=r.eventContextMenu,s=o&&!o.disabled?o:a;we()(pe()(i.prototype),"onDragStart",this).call(this,{context:t,event:n}),null==s||s.hideContextMenu(!1)}},{key:"isValidDrop",value:function(e){var t=e.newResource,n=e.resourceRecord,r=e.draggedEntities[0];return!(!t||t.isSpecialRow)&&(n===t||!r.event.resources.includes(t))}},{key:"checkDragValidity",value:function(e,t){var n=this,r=n.currentOverClient,i=n.dragData.context.valid;return i&&(i=r.allowOverlap||r.isDateRangeAvailable(e.startDate,e.endDate,e.draggedEntities[0],e.newResource)?n.validatorFn.call(n.validatorFnThisObj||n,e,t):{valid:!1,message:n.L("L{eventOverlapsExisting}")}),i}},{key:"updateRecords",value:(n=Wr()(Vr.a.mark((function e(t){var n,r,i,o,a;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=(n=this).scheduler,i=n.currentOverClient,o=!1,r.eventStore.suspendAutoCommit(),i.eventStore.suspendAutoCommit(),e.next=5,n.updateAssignments(r,i,t,o);case 5:return a=e.sent,r.eventStore.resumeAutoCommit(),i.eventStore.resumeAutoCommit(),i.trigger("eventDrop",Object.assign(n.getTriggerParams(t),{isCopy:o,event:t.browserEvent,targetEventRecord:t.targetEventRecord,targetResourceRecord:t.newResource})),e.abrupt("return",a);case 10:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"updateAssignments",value:(t=Wr()(Vr.a.mark((function e(t,n,r,i){var o,a,s,u,c,l,f,d,h,v,p,g,y,m,k,b,w,C,S,D,R,x,E,T,M,A,P,I,O,F,L,j,_,B,H,$,N,V,z,W,G,Y,U;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:for(a=this,s=t!==n,u="vertical"===n.mode,c=t.assignmentStore,l=t.eventStore,f=t.resourceStore,d=n.assignmentStore,h=n.eventStore,v=r.eventRecords,p=r.assignmentRecords,g=r.timeDiff,y=r.resourceRecord,m=r.newResource,k=a.unifiedDrag||s&&p.length>1,b=a.constrainDragToResource?0:f.indexOf(y)-f.indexOf(m),w=a.adjustStartDate(p[0].event.startDate,g),C=[],S=[],D=[],R=[],x=[],E=new Set,T=new Set,t.suspendRefresh(),n.suspendRefresh(),M=!1,A=!1,u&&v.forEach((function(e,n){var i=r.eventBarEls[n];delete e.instanceMeta(t).hasTemporaryDragElement,i.dataset.transient&&i.remove()})),P=0;P<p.length;P++)I=p[P],O=I.event,F=r.eventBarEls[P],j=(L=O).startDate,_=I.resource,B=this.constrainDragToTimeSlot?j:k?w:a.adjustStartDate(j,g),H=n.isInTimeAxis(L),E.add(_),F.querySelector(t.eventInnerSelector).classList.add(t.committingCls),i?(I=I.copy(null),D.push(I)):c!==d&&($=L.assignments.length>1,N=I.copy(),R.push(I),$||S.push(L),h.getById(L.id)||(V=Object.assign({},L.data,{id:L.id,calendar:null}),O=V,C.push(V)),h.usesSingleAssignment||D.push(N),I=N),z=k||s?m:_,k||s||0===b||(W=Math.max(Math.min(f.indexOf(_)-b,f.count-1),0),z=f.getAt(W)),E.add(z),a.constrainDragToTimeline||(Gs.removeChild(t.foregroundCanvas,F),n.rowManager.getRowFor(z)&&H&&(G=0===P?r.context.element:r.context.relatedElements[P-1],Y=En.from(G,n.foregroundCanvas,!0),Cr.setTranslateXY(G,Y.x,Y.y),G.classList.remove("b-sch-event-hover"),G.classList.remove("b-active"),G.classList.remove("b-drag-proxy"),G.classList.remove("b-dragging"),G.retainElement=!1,Gs.addChild(n.foregroundCanvas,G,I.id))),I.resource!==z&&(I.resource=z,O.isEvent&&T.add(O),M=!0,O.isOccurrence&&(O.newResource=z),s&&h.usesSingleAssignment&&(O.resourceId=z.id)),Zt.isEqual(O.startDate,B)||(x.push({draggedEvent:O,originalStartDate:j}),O.startDate=B,O.isEvent&&T.add(O),A=!0,null===(U=O.resources)||void 0===U||U.forEach((function(e){return E.add(e)})));if(c.remove(R),l.remove(S),d.add(D),null===(o=h.add(C))||void 0===o||o.forEach((function(e){return T.add(e)})),(R.length||S.length||D.length||C.length)&&(M=!0),!M&&!A){e.next=16;break}return h.usesSingleAssignment&&T.forEach((function(e){return e.beginBatch()})),e.next=15,Promise.all([n.project!==t.project?n.project.commitAsync():null,t.project.commitAsync()]);case 15:h.usesSingleAssignment&&T.forEach((function(e){return e.endBatch(!1,!0)}));case 16:M||(M=x.some((function(e){var t=e.draggedEvent,n=e.originalStartDate;return!Zt.isEqual(t.startDate,n)}))),n.resumeRefresh(),t.resumeRefresh(),M?(n.refreshWithTransition(),s&&t.refreshWithTransition()):r.valid=!1;case 20:case"end":return e.stop()}}),e,this)}))),function(e,n,r,i){return t.apply(this,arguments)})},{key:"getProductDragContext",value:function(e){var t,n=this.scheduler.resolveEventRecord(e.browserEvent.target);t=this.constrainDragToResource?e.resourceRecord:this.constrainDragToTimeline?this.resolveResource()||e.newResource||e.resourceRecord:this.resolveResource();var r=e.assignmentRecords,i=e.eventRecords;return{valid:Boolean(t),draggedRecords:i,eventRecords:i,assignmentRecords:r,newResource:t,targetEventRecord:n}}},{key:"setupProductDragData",value:function(e){var t=this,n=t.scheduler,r=e.grabbed,i=n.resolveEventRecord(r),o=n.resolveResourceRecord(r),a=n.resolveAssignmentRecord(r),s=En.from(r),u=[a],c=[];if(t.constrainDragToResource&&!o)throw new Error("Resource could not be resolved for event: "+i.id);var l=n.getDateConstraints(t.constrainDragToResource?o:null,i);return t.constrainDragToTimeline&&t.setupConstraints(n.getScheduleRegion(t.constrainDragToResource?o:null,i),s,n.timeAxisViewModel.snapPixelAmount,Boolean(l)),n.multiEventSelect&&(n.isAssignmentSelected(u[0])||t.drag.startEvent.ctrlKey)&&u.push.apply(u,t.getRelatedRecords(a)),u.forEach((function(e){var t=n.getElementFromAssignmentRecord(e);t||(t=(t=n.currentOrientation.addTemporaryDragElement(e.event,e.resource)).innerElement),c.push(t)})),c.forEach((function(e,t){return c[t]=e.parentNode})),{record:a,dateConstraints:l,eventBarEls:c,draggedEntities:u}}},{key:"getDragData",value:function(e,t){var n=we()(pe()(i.prototype),"getDragData",this).call(this,e,t),r=n.draggedEntities,o=d()(new Set(r.map((function(e){return e.event}))));return an.assign(n,{resourceRecord:this.scheduler.resolveResourceRecord(e.grabbed),eventRecords:o,assignmentRecords:r})}},{key:"getRelatedRecords",value:function(e){return this.scheduler.selectedAssignments.filter((function(t){return t!==e&&t.event.isDraggable}))}},{key:"getCoordinate",value:function(e,t,n){var r=this.currentOverClient;if(r.isHorizontal){var i=n[0];if("default"!==r.milestoneLayoutMode&&e.isMilestone)switch(r.milestoneAlign){case"center":i+=t.offsetWidth/2;break;case"end":i+=t.offsetWidth}return i}var o=n[1];if("default"!==r.milestoneLayoutMode&&e.isMilestone)switch(r.milestoneAlign){case"center":o+=t.offsetHeight/2;break;case"end":o+=t.offsetHeight}return o}},{key:"resolveResource",value:function(){var e=this.currentOverClient,t=e.isHorizontal,n=this.dragData.context,r=n.dragProxy||n.element,i=En.from(r,null,!0),o=e.isVertical||this.unifiedDrag?n.clientY:i.center.y,a=En.from(r,this.currentOverClient.timeAxisSubGridElement,!0).center,s=a.x,u=a.y;if(t){var c=e.rowManager.getRowAt(o);return c&&e.resourceStore.getAt(c.dataIndex)}return e.resolveResourceRecord(e.timeAxisSubGridElement.querySelector(".b-sch-timeaxis-cell"),[s,u])}},{key:"adjustStartDate",value:function(e,t){var n=this.currentOverClient;return n.timeAxis.roundDate(new Date(e-0+t),!!n.snapRelativeToEventStartDate&&e)}},{key:"resolveStartEndDates",value:function(e){var t=this.currentOverClient,n=t.timeAxis,r=this.dragData,i=t.getStartEndDatesFromRectangle(e,"round",r.duration,!n.isContinuous),o=i.start,a=i.end;if(o&&a)if(r.startsOutsideView)r.endsOutsideView||(o=a&&Zt.add(a,-r.duration,"ms"));else{if(o&&!t.timeAxis.dateInAxis(o,!1)){var s=t.timeAxis.getTickFromDate(o);s>=0&&(o=t.timeAxis.getDateFromTick(s))}a=o&&Zt.add(o,r.duration,"ms")}return{startDate:o,endDate:a}}},{key:"getRecordElement",value:function(e){return this.scheduler.getElementFromAssignmentRecord(e,!0)}},{key:"scheduler",get:function(){return this.client}}],[{key:"$name",get:function(){return"EventDrag"}},{key:"defaultConfig",get:function(){return{constrainDragToResource:!1,constrainDragToTimeSlot:!1,validatorFn:function(){},validatorFnThisObj:null,unifiedDrag:null}}}]),i}(nE);function oE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}iE._$name="EventDrag",fv.registerFeature(iE,!0,"Scheduler");var aE=function(e){fe()(n,e);var t=oE(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"doDestroy",value:function(){var e,t;null===(e=this.tip)||void 0===e||e.destroy(),null===(t=this.resize)||void 0===t||t.destroy(),we()(pe()(n.prototype),"doDestroy",this).call(this)}},{key:"addProxy",value:function(e){var t,n,r,i,o=this,a=o.client,s=a.barMargin,u=a.currentOrientation.getRowRegion(e.rowRecord);return a.isHorizontal?(r="currentX"in e?Math.min(e.startX,e.currentX+1):e.startX,i=u.y+s,t=e.width||o.dragTolerance,n=u.height-2*s):(r=u.x+s,i="currentY"in e?Math.min(e.startY,e.currentY+1):e.startY,t=u.width-2*s,n=e.height||o.dragTolerance),a.element.classList.add("b-dragcreating"),a.element.classList.add("b-dragcreating-proxy-sizing"),o.proxy=Cr.createElement({parent:a.foregroundCanvas,className:o.proxyCls,style:"transform:translate(".concat(r,"px, ").concat(i,"px);width:").concat(t,"px;height:").concat(n,"px"),retainElement:!0})}},{key:"removeProxy",value:function(){var e,t=this;t.proxy&&(t.proxy.remove(),t.resize.destroy(),t.proxy=t.resize=null,t.client.element.classList.remove("b-dragcreating"),t.client.element.classList.remove("b-dragcreating-proxy-sizing"),null===(e=t.tip)||void 0===e||e.hide())}},{key:"initResizer",value:function(e,t){var n,r,i=this,o=i.client;r=o.isHorizontal?t.currentX>t.startX?"right":"left":t.currentY>t.startY?"bottom":"top",null===(n=i.resize)||void 0===n||n.destroy(),i.resize=new Su({name:i.constructor.name,direction:o.isVertical?"vertical":"horizontal",isTouch:e.type.startsWith("touch"),dragThreshold:i.dragTolerance,grab:{element:i.proxy,edge:r,event:t.startEvent},allowEdgeSwitch:!0,outerElement:o.timeAxisSubGridElement,scrollManager:o.scrollManager,scroller:o.timeAxisSubGrid.scrollable,listeners:{resizing:"onResizing",resize:"onResize",cancel:"onCancel",thisObj:i}}),i.resize.context.resource=t.resource}},{key:"initTooltip",value:function(){var e=this,t=e.client;e.showTooltip&&(e.tip?e.tip.showBy(e.getTooltipTarget()):(e.clockTemplate=new eE({scheduler:t}),e.tip=new Kl({id:"".concat(t.id,"-drag-create-tip"),autoShow:!0,trackMouse:!1,updateContentOnMouseMove:!0,getHtml:e.getTipHtml.bind(e),align:t.isVertical?"t-b":"b100-t100",hideDelay:0,axisLock:!0}),e.tip.on("innerhtmlupdate",e.updateDateIndicator,e)))}},{key:"updateDateIndicator",value:function(){var e=this.createContext,t=e.startDate,n=e.endDate,r=this.tip,i=r.element.querySelector(".b-sch-tooltip-enddate");t&&n&&(this.clockTemplate.updateDateIndicator(r.element,t),i&&this.clockTemplate.updateDateIndicator(i,n))}},{key:"getTipHtml",value:function(){if(this.resize.context){var e,t,n=this,r=n.client,i=n.resize.context,o=i.edge,a=i.newX,s=i.newY,u=i.elementStartX,c=i.elementStartY,l=i.elementWidth,f=i.elementHeight,d=i.newWidth,h=i.newHeight,v=i.valid,p=i.message;if(r.isHorizontal){var g="left"===o?a:u,y=Math.min(Math.max(g+(d||l)-1,0),r.timeAxisViewModel.totalSize-1);e=r.getDateFromCoordinate(g,"round",!0),t=r.getDateFromCoordinate(y,"round",!0)}else{var m="top"===o?s:c,k=Math.min(Math.max(m+(h||f)-1,0),r.timeAxisViewModel.totalSize-1);e=r.getDateFromCoordinate(m,"round",!0),t=r.getDateFromCoordinate(k,"round",!0)}var b=Zt.min(e,t),w=Zt.max(e,t),C=b&&r.getFormattedDate(b),S=w&&t&&r.getFormattedEndDate(w,b);return n.tipTemplate({startDate:b,endDate:w,startClockHtml:n.clockTemplate.template({date:b,text:C,cls:"b-sch-tooltip-startdate"}),endClockHtml:n.clockTemplate.template({date:r.getDisplayEndDate(w,b),text:S,cls:"b-sch-tooltip-enddate"}),valid:v,startText:C,endText:S,message:p})}}},{key:"finalize",value:function(e){var t=this,n=function(){t.proxy.retainElement=!1,t.reset()},r=function(){t.client.trigger("afterDragCreate",{proxyElement:t.proxy}),n()};if(e){var i=t.finalizeDragCreate(t.createContext);an.isPromise(i)?i.then(r,n):r()}else r()}},{key:"onElementMouseDown",value:function(e){var t=this,n=t.client;if(0===e.button&&e.target.matches(".b-sch-timeaxis-cell")&&!t.disabled&&!n.readOnly){var r=n.isVertical?n.resolveResourceRecord(e):n.getRecordFromElement(e.target);if(r.isSpecialRow)return;if(t.preventMultiple&&!t.isRowEmpty(r))return;t.monitorMove=!0,t.createContext={startEvent:e,startScreenX:e.screenX,startScreenY:e.screenY,startX:e.offsetX,startY:e.offsetY,cellElement:e.target,rowRecord:r},t.mouseUpDetacher=nu.on({element:document.body,mouseup:"onMouseUp",once:!0,thisObj:this})}}},{key:"onElementMouseMove",value:function(e){var t=this;if(t.monitorMove){var n=t.createContext,r=t.client,i=r.isVertical?n.startScreenY-e.screenY:n.startScreenX-e.screenX;if(Math.abs(i)>t.dragTolerance){var o=r.getDateFromDomEvent(e),a=En.from(r.timeAxisSubGridElement,null,!0);if(!1===t.handleBeforeDragCreate(o,e))return void(t.monitorMove=!1);n.currentX=Math.max(e.clientX-a.x+r.timeAxisSubGrid.scrollable.x,0),n.currentY=Math.max(e.clientY-a.y+r.timeAxisSubGrid.scrollable.y,0),t.addProxy(t.createContext),t.initResizer(e,t.createContext),t.initTooltip(),t.monitorMove=!1,r.trigger("dragCreateStart",{proxyElement:t.proxy})}}t.proxy&&t.showTooltip&&t.resize.context&&t.tip.alignTo(t.getTooltipTarget())}},{key:"getTooltipTarget",value:function(){var e=this,t=En.from(e.proxy,null,!0);return e.client.isVertical?("bottom"===e.resize.context.edge&&(t.y=t.bottom-1),t.height=e.tip.anchorSize[1]/2):("right"===e.resize.context.edge&&(t.x=t.right-1),t.width=e.tip.anchorSize[0]/2),{target:t}}},{key:"onMouseUp",value:function(){this.client.element.classList.remove("b-dragcreating-proxy-sizing"),this.monitorMove=!1}},{key:"onElementContextMenu",value:function(){if(this.proxy)return!1}},{key:"onResizing",value:function(e){var t=e.context,n=e.event,r=this,i=r.client,o="left"===t.edge?t.newX:t.elementStartX,a="top"===t.edge?t.newY:t.elementStartY,s=Math.min(o+Math.max((t.newWidth||t.elementWidth)-1,0),i.timeAxisViewModel.totalSize-1),u=Math.min(a+Math.max((t.newHeight||t.elementHeight)-1,0),i.timeAxisViewModel.totalSize-1),c=i.isVertical?a:o,l=i.isVertical?u:s,f=i.getDateFromCoordinate(c,"round",!0),d=i.getDateFromCoordinate(l,"round",!0),h=r.dateConstraints,v=Zt.min(f,d),p=Zt.max(f,d);h&&(p=Zt.constrain(p,h.start,h.end),v=Zt.constrain(v,h.start,h.end)),Object.assign(r.createContext,{startDate:v,endDate:p}),t.valid=r.checkValidity(r.createContext,n),t.message="",t.valid&&"boolean"!=typeof t.valid&&(t.message=t.valid.message,t.valid=t.valid.valid),t.valid=!1!==t.valid}},{key:"onResize",value:function(e){var t=e.context.valid,n=e.event,r=this,i=r.createContext,o=i.startDate,a=i.endDate;(!o||!a||a-o<=0)&&(t=!1),r.createContext=r.prepareCreateContextForFinalization(r.createContext,n,r.finalize.bind(r)),t&&r.client.trigger("beforeDragCreateFinalize",{context:r.createContext,event:n,proxyElement:r.proxy}),r.createContext&&(r.resize.context.async=r.createContext.async,r.createContext.async?r.resize.removeListeners():r.finalize(t))}},{key:"prepareCreateContextForFinalization",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return Object.assign({},e,{async:r,event:t,finalize:n})}},{key:"onCancel",value:function(){this.cancel()}},{key:"cancel",value:function(){this.reset(),this.mouseUpDetacher&&this.mouseUpDetacher()}},{key:"reset",value:function(){this.removeProxy(),this.createContext=null,this.monitorMove=!1}},{key:"checkValidity",value:function(e,t){throw new Error("Implement in subclass")}},{key:"triggerDragCreateEnd",value:function(e,t){throw new Error("Implement in subclass")}},{key:"handleBeforeDragCreate",value:function(e,t){throw new Error("Implement in subclass")}},{key:"isRowEmpty",value:function(e){throw new Error("Implement in subclass")}},{key:"dragging",get:function(){return this.resize}}],[{key:"defaultConfig",get:function(){return{showTooltip:!0,dragTolerance:2,preventMultiple:!1,validatorFn:function(){},validatorFnThisObj:null,proxyCls:"b-sch-dragcreator-proxy",tipTemplate:function(e){return'\n                <div class="b-sch-tip-'.concat(e.valid?"valid":"invalid",'">\n                    ').concat(e.startClockHtml,"\n                    ").concat(e.endClockHtml,'\n                    <div class="b-sch-tip-message">').concat(e.message,"</div>\n                </div>\n            ")}}}},{key:"pluginConfig",get:function(){return{chain:["onElementMouseDown","onElementMouseMove"],before:["onElementContextMenu"]}}}]),n}(qr);function sE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}aE._$name="DragCreateBase";var uE=function(e){fe()(n,e);var t=sE(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e,t){this.scheduler=e,we()(pe()(n.prototype),"construct",this).call(this,e,t)}},{key:"finalizeDragCreate",value:function(e){var t=new this.store.modelClass({startDate:e.startDate,duration:null,endDate:e.endDate});this.proxy.dataset.eventId=t.id,this.scheduler.trigger("dragCreateEnd",{newEventRecord:t,resourceRecord:e.rowRecord,event:e.event,proxyElement:this.proxy})}},{key:"handleBeforeDragCreate",value:function(e,t){var n=this,r=n.scheduler.trigger("beforeDragCreate",{resourceRecord:n.createContext.rowRecord,date:e,event:t});if(r){var i,o=n.scheduler.features.scheduleTooltip;null==o||null===(i=o.hoverTip)||void 0===i||i.hide()}return n.dateConstraints=n.scheduler.getDateConstraints(n.createContext.rowRecord,e),r}},{key:"checkValidity",value:function(e,t){var n=this.client;return e.resourceRecord=e.rowRecord,(n.allowOverlap||n.isDateRangeAvailable(e.startDate,e.endDate,null,e.resourceRecord))&&this.validatorFn.call(this.validatorFnThisObj||this,e,t)}},{key:"isRowEmpty",value:function(e){var t=this.store.getEventsForResource(e);return!t||!t.length}},{key:"store",get:function(){return this.scheduler.eventStore}}],[{key:"$name",get:function(){return"EventDragCreate"}},{key:"defaultConfig",get:function(){return{validatorFn:function(){}}}}]),n}(aE);function cE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}uE._$name="EventDragCreate",fv.registerFeature(uE,!0,"Scheduler");var lE=function(e){fe()(n,e);var t=cE(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e,t){if(this.timeline=e,e.multiEventSelect=!0,e.features.eventDragCreate||e.features.pan)throw new Error("Cannot combine this feature with Pan or EventDragCreate features");this.targetSelector=[".b-timeline-subgrid .b-grid-cell",".b-timeline-subgrid"].join(","),we()(pe()(n.prototype),"construct",this).call(this,e,t)}},{key:"onElementMouseDown",value:function(e){var t=this,n=t.client;e.touches||0!==e.button||t.disabled||e.target.matches(t.targetSelector)&&(t.startX=e.clientX,t.startY=e.clientY,t.element=Cr.createElement({tag:"div",className:"b-dragselect-rect"},!0)[0],oc.floatRoot.appendChild(t.element),n.element.classList.add("b-dragselecting"),t.eventRectangles=Array.from(n.element.querySelectorAll(n.eventSelector)).map((function(e){return{rectangle:En.from(e,!0),record:n.resolveEventRecord(e)}})),n.clearEventSelection(),t.subGridElementRect=En.from(n.timeAxisSubGrid.element,!0),n.navigator.disabled=!0)}},{key:"onElementMouseMove",value:function(e){var t=this;if(0!==e.buttons||j.a.isSafari||j.a.isIE11&&!e.isTrusted){if("number"==typeof t.startX){var n=Math.max(e.clientX,t.subGridElementRect.left),r=Math.max(e.clientY,t.subGridElementRect.top),i=Math.min(t.startX,n),o=Math.min(t.startY,r),a=Math.abs(t.startX-n),s=Math.abs(t.startY-r),u=new En(i,o,a,s).constrainTo(t.subGridElementRect);Cr.setTranslateXY(t.element,u.left,u.top),t.element.style.width=u.width+"px",t.element.style.height=u.height+"px",t.rectangle=u,t.updateSelection()}}else t.onElementMouseUp(e)}},{key:"onElementMouseUp",value:function(){var e=this;"number"==typeof e.startX&&(e.element&&e.element.remove(),e.client.element.classList.remove("b-dragselecting"),e.startX=e.startY=null,e.setTimeout((function(){return e.client.navigator.disabled=!1}),100))}},{key:"updateSelection",value:function(){for(var e=this.eventRectangles,t=this.rectangle,n=0,r=e.length;n<r;n++){var i=e[n],o=t.intersect(i.rectangle,!0);o&&!i.selected?(i.selected=!0,this.client.selectEvent(i.record,!0)):!o&&i.selected&&(i.selected=!1,this.client.deselectEvent(i.record))}}}],[{key:"$name",get:function(){return"EventDragSelect"}},{key:"pluginConfig",get:function(){return{chain:["onElementMouseDown","onElementMouseMove","onElementMouseUp"]}}}]),n}(_a(qr));function fE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function dE(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?fE(Object(n),!0).forEach((function(t){ke()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):fE(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function hE(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return vE(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return vE(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function vE(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function pE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}lE._$name="EventDragSelect",fv.registerFeature(lE,!1,"Scheduler");var gE=Zt,yE=function(e){if(1===e.length)return e[0].value;if(2===e.length){var t=e[0]instanceof pd?e:e.reverse(),n=ye()(t,2),r=n[0],i=n[1],o=gE.parse(r.value);return o&&o.setHours(i.value.getHours(),i.value.getMinutes(),i.value.getSeconds(),i.value.getMilliseconds()),o?Zt.clone(o):null}return null},mE=function(e,t,n){if(e&&t){var r=gE.add((i=n.startDateField.value,o=n.startTimeField.value,(a=new Date(i.getTime())).setHours(o.getHours(),o.getMinutes()),a),n.eventRecord.durationMS,"milliseconds");n.endDateField.value=r,n.endTimeField.value=gE.clone(r)}var i,o,a},kE=function(e){fe()(o,e);var t,n,r,i=pE(o);function o(){return v()(this,o),i.apply(this,arguments)}return g()(o,[{key:"construct",value:function(e,t){var n,r=this;e.eventEdit=r,we()(pe()(o.prototype),"construct",this).call(this,e,an.assign({weekStartDay:e.weekStartDay},t)),r.clientListenersDetacher=e.on((n={},ke()(n,r.triggerEvent,r.onActivateEditor),ke()(n,"dragcreateend",r.onDragCreateEnd),ke()(n,"thisObj",r),n))}},{key:"doDestroy",value:function(){var e;this.clientListenersDetacher(),null===(e=this.editor)||void 0===e||e.destroy(),we()(pe()(o.prototype),"doDestroy",this).call(this)}},{key:"changeEditorConfig",value:function(e){var t=this.items;return this.extraItems?(e=F.clone(e),e=this.insertExtraWidgetsIntoDefaultWidgets(e)):t&&((e=F.clone(e)).items=Y.merge(t,e.items)),e}},{key:"insertExtraWidgetsIntoDefaultWidgets",value:function(e){y.a.deprecate("Scheduler","5.0.0","extraItems replaced by items in EditFeature.");var t=this.extraItems,n=e.items,r=Array.isArray(t)?t:t&&Object.values(t);if(!t||!Object.keys(r).length)return e;if(Object.values(r).some((function(e){return"index"in e}))){var i=Array.isArray(t)?t:t&&an.transformNamedObjectToArray(t);y.a.deprecate("Scheduler","5.0.0","index in extraItems replaced by weight to sort editor items");var o,a=an.transformNamedObjectToArray(n),s=a[a.length-1],u=a.findIndex((function(e){return"extraItems"===e.type}));u>-1&&(a.splice(u,1),o=a.splice(u));var c=i.filter((function(e){return e.index>=0})),l=i.filter((function(e){return!(e.index>=0)}));l.forEach((function(e,t){return e.weight=s.weight+100*t})),a=a.concat(l),c.sort((function(e,t){return e.index-t.index})),c.forEach((function(e){var t=a[Math.min(e.index,a.length)-1];e.weight=t?t.weight+1:-100,a.splice(e.index,0,e)})),o&&o.length&&(a=a.concat(o)),e.items=an.transformArrayToNamedObject(a)}else{var f,d=900,h=hE(Array.isArray(t)?t:Object.values(t));try{for(h.s();!(f=h.n()).done;){var v=f.value;v.ref||(v.ref=v.id),v.weight=d+=100}}catch(e){h.e(e)}finally{h.f()}e.items=dE(dE({},n),Array.isArray(t)?an.transformArrayToNamedObject(t):t)}return e}},{key:"onDatesChange",value:function(e){var t=this,n=e.source,r=e.value;switch(n.ref){case"startDateField":t.startTimeField&&mE(r,t.startTimeField.value,t);break;case"startTimeField":t.startDateField&&mE(t.startDateField.value,r,t)}t.endTimeField&&(gE.isEqual(gE.clearTime(t.startDateField.value),gE.clearTime(t.endDateField.value))?t.endTimeField.min=t.startTimeField.value:t.endTimeField.min=null)}},{key:"save",value:(r=Wr()(Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Implement in subclass");case 1:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)})},{key:"onBeforeSave",value:function(e){}},{key:"onAfterSave",value:function(e){}},{key:"updateRecord",value:function(e){var t=this.values;this.scheduler.assignmentStore&&delete t.resource,e.set(t)}},{key:"resetEditingContext",value:function(){var e=this;e.isEditing=!1,e.targetEventElement=null,e.client.element.classList.remove("b-eventeditor-editing"),e.phantomEventElement&&e.phantomEventElement.remove(),e.phantomEventElement=null}},{key:"onPopupKeyDown",value:function(e){var t=e.event;!this.readOnly&&"Enter"===t.key&&this.saveAndCloseOnEnter&&"input"===t.target.tagName.toLowerCase()&&(t.preventDefault(),"startDate"===t.target.name&&mE(this.startDateField.value,this.startTimeField.value,this),this.onSaveClick())}},{key:"onSaveClick",value:(n=Wr()(Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.save();case 2:e.sent&&this.editor.close();case 4:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"onDeleteClick",value:(t=Wr()(Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.deleteEvent();case 2:e.sent&&(this.editor.autoClose&&!this.editor.containsFocus||this.editor.close());case 4:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"onCancelClick",value:function(){this.editor.close()}},{key:"isValid",get:function(){return Object.values(this.editor.widgetMap).every((function(e){return!(e.name&&!e.hidden)||!1!==e.isValid}))}},{key:"values",get:function(){var e=this,t=e.editor,n=[],r=[],i={};return t.eachWidget((function(o){var a,s=o.name;if(s&&!o.hidden&&!o.up((function(t){return t===e.recurrenceEditor})))switch(s){case"startDate":n.push(o);break;case"endDate":r.push(o);break;case"resource":i[s]=o.record;break;case"recurrenceRule":i[s]="none"===(null===(a=t.widgetMap.recurrenceCombo)||void 0===a?void 0:a.value)?"":o.value;break;default:i[s]=o.value}}),!0),n.length&&(i.startDate=yE(n)),r.length&&(i.endDate=yE(r)),"startDate"in i&&"endDate"in i&&(i.duration=gE.diff(i.startDate,i.endDate,e.editor.record.durationUnit,!0)),i}}],[{key:"configurable",get:function(){return{autoClose:!0,saveAndCloseOnEnter:!0,triggerEvent:null,showDeleteButton:!0,showNameField:!0,startTimeConfig:null,startDateConfig:null,endTimeConfig:null,endDateConfig:null,dateFormat:"L",timeFormat:"LT",editorConfig:null,extraItems:null,items:null,weekStartDay:null}}}]),o}(qr);function bE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}kE._$name="EditBase";var wE=function(e){fe()(n,e);var t=bE(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"updateLocalization",value:function(){we()(pe()(n.prototype),"updateLocalization",this).apply(this,arguments),this.initialTitle=this.title||""}},{key:"processWidgetConfig",value:function(e){var t,r=this.eventEditFeature;if((null===(t=e.type)||void 0===t?void 0:t.includes("date"))&&null==e.weekStartDay&&(e.weekStartDay=this.weekStartDay),"extraItems"===e.type)return!1;var i={};if("resourceField"===e.ref){if(!r.showResourceField)return!1;this.resourceStore=e.store=r.resourceStore.makeChained((function(e){return!e.isSpecialRow}),null,{excludeCollapsedRecords:!1}),e.multiSelect=!r.eventStore.usesSingleAssignment,r.resourceFieldConfig&&(i=r.resourceFieldConfig)}return!("nameField"===e.ref&&!r.showNameField)&&(!("deleteButton"===e.ref&&!r.showDeleteButton)&&("startDate"!==e.name&&"endDate"!==e.name||"date"!==e.type||(i.format=r.dateFormat),"startDate"!==e.name&&"endDate"!==e.name||"time"!==e.type||(i.format=r.timeFormat),r.startDateConfig&&"startDate"===e.name&&"date"===e.type&&(i=r.startDateConfig),r.startTimeConfig&&"startDate"===e.name&&"time"===e.type&&(i=r.startTimeConfig),r.endDateConfig&&"endDate"===e.name&&"date"===e.type&&(i=r.endDateConfig),r.endTimeConfig&&"endDate"===e.name&&"time"===e.type&&(i=r.endTimeConfig),Object.assign(e,i),we()(pe()(n.prototype),"processWidgetConfig",this).call(this,e)))}},{key:"show",value:function(){var e;this.resourceStore&&this.resourceStore.fillFromMaster();for(var t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];(e=we()(pe()(n.prototype),"show",this)).call.apply(e,[this].concat(r))}},{key:"onBeforeShow",value:function(){var e,t=this,r=t.record,i=t.titleRenderer,o=t.widgetMap.deleteButton;o&&(o.hidden=t.readOnly||!r.stores.length&&!r.isOccurrence),t.title=i?t.callback(i,t,[r]):t.initialTitle;for(var a=arguments.length,s=new Array(a),u=0;u<a;u++)s[u]=arguments[u];we()(pe()(n.prototype),"onBeforeShow",this)&&(e=we()(pe()(n.prototype),"onBeforeShow",this)).call.apply(e,[this].concat(s))}},{key:"onInternalKeyDown",value:function(e){this.trigger("keyDown",{event:e}),we()(pe()(n.prototype),"onInternalKeyDown",this).call(this,e)}},{key:"updateReadOnly",value:function(e){var t=this.widgetMap,r=t.deleteButton,i=t.saveButton,o=t.cancelButton;we()(pe()(n.prototype),"updateReadOnly",this).call(this,e),r&&(r.hidden=e),i&&(i.hidden=e),o&&(o.hidden=e)}}],[{key:"type",get:function(){return"eventeditor"}},{key:"$name",get:function(){return"EventEditor"}},{key:"configurable",get:function(){return{items:[],draggable:{handleSelector:":not(button,.b-field-inner)"},axisLock:"flexible",scrollable:{overflowY:!0},readOnly:null,titleRenderer:null}}}]),n}(zl);function CE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}wE.initClass(),wE._$name="EventEditor";var SE=function(e){fe()(n,e);var t=CE(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"onChangeMultipleButtonClick",value:function(){this.processMultipleRecords(),this.hide()}},{key:"onChangeSingleButtonClick",value:function(){this.processSingleRecord(),this.hide()}},{key:"onCancelButtonClick",value:function(){this.cancelFn&&this.cancelFn.call(this.thisObj),this.hide()}},{key:"onRecurrenceClose",value:function(){this.cancelFn&&this.cancelFn.call(this.thisObj),this.hide()}},{key:"confirm",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this;return["actionType","eventRecord","title","html","changerFn","cancelFn","thisObj"].forEach((function(n){n in e&&(t[n]=e[n])})),t.updatePopupContent(),we()(pe()(n.prototype),"show",this).call(this,e)}},{key:"updatePopupContent",value:function(){var e=this,t=e.widgetMap,n=t.changeMultipleButton,r=t.changeSingleButton,i=t.cancelButton,o=e.eventRecord,a=e.actionType,s=void 0===a?"update":a,u=o&&o.isRecurring;u?(n.text=e.L("L{Object.Yes}"),e.html=e.L("".concat(s,"-all-message"))):(n.text=e.L("".concat(s,"-further-btn-text")),e.html=e.L("".concat(s,"-further-message"))),r.text=e.L("".concat(s,"-only-this-btn-text")),i.text=e.L("L{Object.Cancel}"),u?r.hide():r.show(),e.width=e.L("L{width}"),e.title=e.L("".concat(s,"-title"))}},{key:"processMultipleRecords",value:function(){var e=this.eventRecord,t=this.changerFn,n=this.thisObj;e.beginBatch(),this.callback(t,n,[e]),e.endBatch()}},{key:"processSingleRecord",value:function(){var e=this.eventRecord,t=this.changerFn,n=this.thisObj;e.beginBatch(),e.recurrence=null,this.callback(t,n,[e]),e.recurrenceRule=null,e.endBatch()}},{key:"updateLocalization",value:function(){this.updatePopupContent(),we()(pe()(n.prototype),"updateLocalization",this).call(this)}},{key:"changeMultipleButton",get:function(){return this.widgetMap.changeMultipleButton}},{key:"changeSingleButton",get:function(){return this.widgetMap.changeSingleButton}},{key:"cancelButton",get:function(){return this.widgetMap.cancelButton}}],[{key:"$name",get:function(){return"RecurrenceConfirmationPopup"}},{key:"type",get:function(){return"recurrenceconfirmation"}},{key:"defaultConfig",get:function(){return{localizableProperties:[],align:"b-t",autoShow:!1,autoClose:!1,closeAction:"onRecurrenceClose",modal:!0,centered:!0,scrollAction:"realign",constrainTo:window,draggable:!0,closable:!0,floating:!0,eventRecord:null,cls:"b-sch-recurrenceconfirmation",bbar:{defaults:{localeClass:this},items:{changeMultipleButton:{weight:100,color:"b-green",text:"L{Object.Yes}",onClick:"up.onChangeMultipleButtonClick"},changeSingleButton:{weight:200,color:"b-gray",text:"L{update-only-this-btn-text}",onClick:"up.onChangeSingleButtonClick"},cancelButton:{weight:300,color:"b-gray",text:"L{Object.Cancel}",onClick:"up.onCancelButtonClick"}}}}}}]),n}(zl);function DE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}SE.initClass(),SE._$name="RecurrenceConfirmationPopup";var RE=function(e){fe()(n,e);var t=DE(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"buildLocalizedItems",value:function(){return[{value:"DAILY",text:this.L("L{Daily}")},{value:"WEEKLY",text:this.L("L{Weekly}")},{value:"MONTHLY",text:this.L("L{Monthly}")},{value:"YEARLY",text:this.L("L{Yearly}")}]}}],[{key:"$name",get:function(){return"RecurrenceFrequencyCombo"}},{key:"type",get:function(){return"recurrencefrequencycombo"}},{key:"defaultConfig",get:function(){return{editable:!1,displayField:"text",valueField:"value"}}}]),n}(xp(Xf));function xE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}RE.initClass(),RE._$name="RecurrenceFrequencyCombo";var EE=function(e){fe()(n,e);var t=xE(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"buildLocalizedItems",value:function(){return[{value:"none",text:this.L("L{None}")}].concat(d()(we()(pe()(n.prototype),"buildLocalizedItems",this).call(this)),[{value:this.customValue,text:this.L("L{Custom}"),cls:this.splitCls}])}},{key:"isCustomRecurrence",value:function(e){var t=e.interval,n=e.days,r=e.monthDays,i=e.months;return Boolean(t>1||n&&n.length||r&&r.length||i&&i.length)}},{key:"value",set:function(e){e=e||"none",sc()(pe()(n.prototype),"value",e,this,!0)},get:function(){return we()(pe()(n.prototype),"value",this)}},{key:"recurrence",set:function(e){this.value=e?this.isCustomRecurrence(e)?this.customValue:e.frequency:null}}],[{key:"$name",get:function(){return"RecurrenceCombo"}},{key:"type",get:function(){return"recurrencecombo"}},{key:"defaultConfig",get:function(){return{customValue:"custom",placeholder:"None",splitCls:"b-recurrencecombo-split",items:!0,highlightExternalChange:!1}}}]),n}(RE);function TE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}EE.initClass(),EE._$name="RecurrenceCombo";var ME=function(e){fe()(n,e);var t=TE(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"getLegend",value:function(e,t){var n,r=this,i=e.timeSpan,o=e.interval,a=e.days,s=e.monthDays,u=e.months,c=e.positions,l=t||i.startDate,f={interval:o};switch(e.frequency){case"DAILY":return 1===o?r.L("L{Daily}"):r.L("L{Every {0} days}",f);case"WEEKLY":return a&&a.length?f.days=r.getDaysLegend(a):l&&(f.days=Zt.getDayName(l.getDay())),r.L(1===o?"L{Weekly on {1}}":"L{Every {0} weeks on {1}}",f);case"MONTHLY":return a&&a.length&&c&&c.length?f.days=r.getDaysLegend(a,c):s&&s.length?(s.sort((function(e,t){return e-t})),f.days=r.arrayToText(s)):l&&(f.days=l.getDate()),r.L(1===o?"L{Monthly on {1}}":"L{Every {0} months on {1}}",f);case"YEARLY":return a&&a.length&&c&&c.length?f.days=r.getDaysLegend(a,c):f.days=l.getDate(),u&&u.length?(u.sort((function(e,t){return e-t})),n=u.length>2?function(e){return Zt.getMonthShortName(e-1)}:function(e){return Zt.getMonthName(e-1)},f.months=r.arrayToText(u,n)):f.months=Zt.getMonthName(l.getMonth()),r.L(1===o?"L{Yearly on {1} of {2}}":"L{Every {0} years on {1} of {2}}",f)}}},{key:"getDaysLegend",value:function(e,t){var n,r=this,i={position:""};if(t&&t.length&&(i.position=r.arrayToText(t,(function(e){return r.L("L{position".concat(e,"}"))}))),e.length)switch(e.sort((function(e,t){return yD.decodeDay(e)[0]-yD.decodeDay(t)[0]})),e.join(",")){case r.allDaysValue:i.days=r.L("L{day}");break;case r.workingDaysValue:i.days=r.L("L{weekday}");break;case r.nonWorkingDaysValue:i.days=r.L("L{weekend day}");break;default:n=e.length>2?function(e){return Zt.getDayShortName(yD.decodeDay(e)[0])}:function(e){return Zt.getDayName(yD.decodeDay(e)[0])},i.days=r.arrayToText(e,n)}return r.L("L{daysFormat}",i)}},{key:"arrayToText",value:function(e,t){return t&&(e=e.map(t)),e.join(", ").replace(/,(?=[^,]*$)/,this.L("L{ and }"))}},{key:"$name",get:function(){return"RecurrenceLegend"}},{key:"allDaysValue",get:function(){return"SU,MO,TU,WE,TH,FR,SA"}},{key:"workingDaysValue",get:function(){return"MO,TU,WE,TH,FR"}},{key:"nonWorkingDaysValue",get:function(){return"SU,SA"}}]),n}(lt());function AE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}ME._$name="RecurrenceLegend";var PE=function(e){fe()(n,e);var t=AE(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"updateLegend",value:function(){var e=this.recurrence;this.text=e?ME.getLegend(e,this.eventStartDate):""}},{key:"onLocaleChange",value:function(){this.updateLegend()}},{key:"updateLocalization",value:function(){this.onLocaleChange(),we()(pe()(n.prototype),"updateLocalization",this).call(this)}},{key:"recurrence",set:function(e){this._recurrence=e,this.updateLegend()},get:function(){return this._recurrence}},{key:"eventStartDate",set:function(e){this._eventStartDate=e,this.updateLegend()},get:function(){return this._eventStartDate}}],[{key:"$name",get:function(){return"RecurrenceLegendButton"}},{key:"type",get:function(){return"recurrencelegendbutton"}},{key:"defaultConfig",get:function(){return{localizableProperties:[],recurrence:null}}}]),n}(Fl);function IE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}PE.initClass(),PE._$name="RecurrenceLegendButton";var OE=function(e){fe()(n,e);var t=IE(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"buildLocalizedItems",value:function(){var e=this;return e._weekDays=null,e.weekDays.concat([{value:e.allDaysValue,text:e.L("L{day}"),cls:e.splitCls},{value:e.workingDaysValue,text:e.L("L{weekday}")},{value:e.nonWorkingDaysValue,text:e.L("L{weekend day}")}])}},{key:"weekDays",get:function(){if(!this._weekDays){var e=Zt.weekStartDay,t=Zt.getDayNames().map((function(e,t){return{text:e,value:yD.encodeDay(t)}}));this._weekDays=t.slice(e).concat(t.slice(0,e))}return this._weekDays}},{key:"value",set:function(e){e&&Array.isArray(e)&&(e=e.join(",")),e&&this.store.findRecord("value",e)||(e=this.defaultValue),sc()(pe()(n.prototype),"value",e,this,!0)},get:function(){var e=we()(pe()(n.prototype),"value",this);return e&&Array.isArray(e)&&(e=e.join(",")),e}}],[{key:"$name",get:function(){return"RecurrenceDaysCombo"}},{key:"type",get:function(){return"recurrencedayscombo"}},{key:"defaultConfig",get:function(){return{allDaysValue:"SU,MO,TU,WE,TH,FR,SA",editable:!1,defaultValue:"SU,MO,TU,WE,TH,FR,SA",workingDaysValue:"MO,TU,WE,TH,FR",nonWorkingDaysValue:"SU,SA",splitCls:"b-recurrencedays-split",displayField:"text",valueField:"value"}}}]),n}(xp(Xf));function FE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}OE.initClass(),OE._$name="RecurrenceDaysCombo";var LE=function(e){fe()(n,e);var t=FE(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this;e.columns=7,e.items=t.buildItems(),we()(pe()(n.prototype),"construct",this).call(this,e)}},{key:"updateItemText",value:function(e){var t=yD.decodeDay(e.value)[0];e.text=Zt.getDayName(t).substring(0,3)}},{key:"buildItems",value:function(){if(!this.__items){var e=Zt.weekStartDay,t=Zt.getDayNames().map((function(e,t){return{text:e.substring(0,3),value:yD.encodeDay(t)}}));this.__items=t.slice(e).concat(t.slice(0,e))}return this.__items}},{key:"onLocaleChange",value:function(){this.items.forEach(this.updateItemText,this)}},{key:"updateLocalization",value:function(){this.onLocaleChange(),we()(pe()(n.prototype),"updateLocalization",this).call(this)}},{key:"value",set:function(e){e&&Array.isArray(e)&&(e=e.join(",")),sc()(pe()(n.prototype),"value",e,this,!0)},get:function(){var e=we()(pe()(n.prototype),"value",this);return e&&Array.isArray(e)&&(e=e.join(",")),e}},{key:"widgetClassList",get:function(){var e=we()(pe()(n.prototype),"widgetClassList",this);return e.push("b-field"),e}}],[{key:"$name",get:function(){return"RecurrenceDaysButtonGroup"}},{key:"type",get:function(){return"recurrencedaysbuttongroup"}},{key:"defaultConfig",get:function(){return{defaults:{cls:"b-raised",toggleable:!0}}}}]),n}(nd);function jE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}LE.initClass(),LE._$name="RecurrenceDaysButtonGroup";var _E=function(e){fe()(n,e);var t=jE(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this;e.columns=7,e.items=t.buildItems(),we()(pe()(n.prototype),"construct",this).call(this,e)}},{key:"buildItems",value:function(){for(var e=[],t=this.minValue;t<=this.maxValue;t++)e.push({text:t+"",value:t});return e}},{key:"minValue",get:function(){return 1}},{key:"maxValue",get:function(){return 31}},{key:"widgetClassList",get:function(){var e=we()(pe()(n.prototype),"widgetClassList",this);return e.push("b-field"),e}}],[{key:"$name",get:function(){return"RecurrenceMonthDaysButtonGroup"}},{key:"type",get:function(){return"recurrencemonthdaysbuttongroup"}},{key:"defaultConfig",get:function(){return{defaults:{toggleable:!0,cls:"b-raised"}}}}]),n}(nd);function BE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}_E.initClass(),_E._$name="RecurrenceMonthDaysButtonGroup";var HE=function(e){fe()(n,e);var t=BE(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this;e.columns=4,e.items=t.buildItems(),we()(pe()(n.prototype),"construct",this).call(this,e)}},{key:"buildItems",value:function(){return Zt.getMonthNames().map((function(e,t){return{text:e.substring(0,3),value:t+1}}))}},{key:"updateItemText",value:function(e){e.text=Zt.getMonthName(e.value-1).substring(0,3)}},{key:"onLocaleChange",value:function(){this.items.forEach(this.updateItemText,this)}},{key:"updateLocalization",value:function(){this.onLocaleChange(),we()(pe()(n.prototype),"updateLocalization",this).call(this)}},{key:"widgetClassList",get:function(){var e=we()(pe()(n.prototype),"widgetClassList",this);return e.push("b-field"),e}}],[{key:"$name",get:function(){return"RecurrenceMonthsButtonGroup"}},{key:"type",get:function(){return"recurrencemonthsbuttongroup"}},{key:"defaultConfig",get:function(){return{defaults:{toggleable:!0,cls:"b-raised"}}}}]),n}(nd);function $E(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}HE.initClass(),HE._$name="RecurrenceMonthsButtonGroup";var NE=function(e){fe()(n,e);var t=$E(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"buildLocalizedItems",value:function(){return[{value:"never",text:this.L("L{Never}")},{value:"count",text:this.L("L{After}")},{value:"date",text:this.L("L{On date}")}]}},{key:"value",set:function(e){e=e||"never",sc()(pe()(n.prototype),"value",e,this,!0)},get:function(){return we()(pe()(n.prototype),"value",this)}},{key:"recurrence",get:function(){return this._recurrence},set:function(e){var t=null;e.endDate?t="date":e.count&&(t="count"),this._recurrence=e,this.value=t}}],[{key:"$name",get:function(){return"RecurrenceStopConditionCombo"}},{key:"type",get:function(){return"recurrencestopconditioncombo"}},{key:"defaultConfig",get:function(){return{editable:!1,placeholder:"Never",displayField:"text",valueField:"value"}}}]),n}(xp(Xf));function VE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}NE.initClass(),NE._$name="RecurrenceStopConditionCombo";var zE=function(e){fe()(n,e);var t=VE(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"buildLocalizedItems",value:function(){return this.buildDayNumbers().concat([{value:"-1",text:this.L("L{position-1}"),cls:this.splitCls}])}},{key:"buildDayNumbers",value:function(){var e=this;return De.populate(e.maxPosition,(function(t){return{value:t,text:e.L("position".concat(t+1))}}))}},{key:"value",set:function(e){e&&Array.isArray(e)&&(e=e.join(",")),e&&this.store.findRecord("value",e)||(e=this.defaultValue),sc()(pe()(n.prototype),"value",e,this,!0)},get:function(){var e=we()(pe()(n.prototype),"value",this);return e?"".concat(e).split(",").map((function(e){return parseInt(e,10)})):[]}}],[{key:"$name",get:function(){return"RecurrencePositionsCombo"}},{key:"type",get:function(){return"recurrencepositionscombo"}},{key:"defaultConfig",get:function(){return{editable:!1,splitCls:"b-sch-recurrencepositions-split",displayField:"text",valueField:"value",defaultValue:1,maxPosition:5}}}]),n}(xp(Xf));function WE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}zE.initClass(),zE._$name="RecurrencePositionsCombo";var GE=function(e){fe()(n,e);var t=WE(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"updateReadOnly",value:function(e){we()(pe()(n.prototype),"updateReadOnly",this).call(this,e),this.bbar.hidden=e}},{key:"updateRecord",value:function(e){we()(pe()(n.prototype),"updateRecord",this).call(this,e);var t=e.timeSpan,r=t&&t.startDate,i=this.widgetMap,o=i.daysButtonField,a=i.monthDaysButtonField,s=i.monthsButtonField,u=i.monthDaysRadioField,c=i.positionAndDayRadioField,l=i.stopRecurrenceField;r&&(e.days&&e.days.length||(o.value=[yD.encodeDay(r.getDay())]),e.monthDays&&e.monthDays.length||(a.value=r.getDate()),e.months&&e.months.length||(s.value=r.getMonth()+1)),e.days&&e.positions?(c.check(),this.isPainted||u.uncheck()):(u.check(),this.isPainted||c.uncheck()),l.recurrence=e}},{key:"onSaveClick",value:function(){var e=this;e.saveHandler?e.saveHandler.call(e.thisObj||e,e,e.record):(e.syncEventRecord(),e.close())}},{key:"onCancelClick",value:function(){var e=this;e.cancelHandler?e.cancelHandler.call(e.thisObj||e,e,e.record):e.close()}},{key:"syncEventRecord",value:function(e){var t=this.getValues((function(t){return t.name in e&&!t.disabled}));e.set(t)}},{key:"toggleStopFields",value:function(){var e=this.widgetMap,t=e.countField,n=e.endDateField;switch(this.widgetMap.stopRecurrenceField.value){case"count":t.show(),t.enable(),n.hide(),n.disable();break;case"date":t.hide(),t.disable(),n.show(),n.enable();break;default:t.hide(),n.hide(),t.disable(),n.disable()}}},{key:"onMonthDaysRadioFieldChange",value:function(e){var t=e.checked,n=this.widgetMap.monthDaysButtonField;n.disabled=!t||!this.isWidgetAvailableForFrequency(n)}},{key:"onPositionAndDayRadioFieldChange",value:function(e){var t=e.checked,n=this.widgetMap,r=n.daysCombo,i=n.positionsCombo;r.disabled=i.disabled=!t||!this.isWidgetAvailableForFrequency(r)}},{key:"onStopRecurrenceFieldChange",value:function(){this.toggleStopFields()}},{key:"isWidgetAvailableForFrequency",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.widgetMap.frequencyField.value;return!e.forFrequency||e.forFrequency.indexOf(t)>-1}},{key:"onFrequencyFieldChange",value:function(e){var t=e.value,n=e.valid,r=this,i=r.queryAll((function(e){return"forFrequency"in e}));if(n&&t){for(var o=0;o<i.length;o++){var a=i[o];r.isWidgetAvailableForFrequency(a,t)?(a.show(),a.enable()):(a.hide(),a.disable())}r.widgetMap.intervalField.hint=r.L("".concat(t,"intervalUnit")),r.toggleFieldsState()}}},{key:"toggleFieldsState",value:function(){var e=this.widgetMap;this.onMonthDaysRadioFieldChange({checked:e.monthDaysRadioField.checked}),this.onPositionAndDayRadioFieldChange({checked:e.positionAndDayRadioField.checked}),this.onStopRecurrenceFieldChange()}},{key:"updateLocalization",value:function(){var e=this.widgetMap,t=e.countField,r=e.intervalField,i=e.frequencyField;t.hint=this.L("L{time(s)}"),i.value&&(r.hint=this.L("".concat(i.value,"intervalUnit"))),we()(pe()(n.prototype),"updateLocalization",this).call(this)}}],[{key:"$name",get:function(){return"RecurrenceEditor"}},{key:"type",get:function(){return"recurrenceeditor"}},{key:"configurable",get:function(){return{draggable:!0,closable:!0,floating:!0,cls:"b-recurrenceeditor",title:"L{Repeat event}",autoClose:!0,width:400,defaults:{localeClass:this},items:{frequencyField:{type:"recurrencefrequencycombo",name:"frequency",label:"L{Frequency}",weight:10,onChange:"up.onFrequencyFieldChange"},intervalField:{type:"numberfield",weight:15,name:"interval",label:"L{Every}",min:1,required:!0},daysButtonField:{type:"recurrencedaysbuttongroup",weight:20,name:"days",forFrequency:"WEEKLY"},monthDaysRadioField:{type:"checkbox",weight:30,toggleGroup:"radio",forFrequency:"MONTHLY",label:"L{Each}",checked:!0,onChange:"up.onMonthDaysRadioFieldChange"},monthDaysButtonField:{type:"recurrencemonthdaysbuttongroup",weight:40,name:"monthDays",forFrequency:"MONTHLY"},monthsButtonField:{type:"recurrencemonthsbuttongroup",weight:50,name:"months",forFrequency:"YEARLY"},positionAndDayRadioField:{type:"checkbox",weight:60,toggleGroup:"radio",forFrequency:"MONTHLY|YEARLY",label:"L{On the}",onChange:"up.onPositionAndDayRadioFieldChange"},positionsCombo:{type:"recurrencepositionscombo",weight:80,name:"positions",forFrequency:"MONTHLY|YEARLY"},daysCombo:{type:"recurrencedayscombo",weight:90,name:"days",forFrequency:"MONTHLY|YEARLY",flex:1},stopRecurrenceField:{type:"recurrencestopconditioncombo",weight:100,label:"L{End repeat}",onChange:"up.onStopRecurrenceFieldChange"},countField:{type:"numberfield",weight:110,name:"count",min:2,required:!0,disabled:!0,label:" "},endDateField:{type:"datefield",weight:120,name:"endDate",hidden:!0,disabled:!0,label:" ",required:!0}},bbar:{defaults:{localeClass:this},items:{foo:{type:"widget",cls:"b-label-filler",weight:100},saveButton:{color:"b-green",text:"L{Save}",onClick:"up.onSaveClick",weight:200},cancelButton:{color:"b-gray",text:"L{Object.Cancel}",onClick:"up.onCancelClick",weight:300}}}}}}]),n}(zl);function YE(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function UE(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?YE(Object(n),!0).forEach((function(t){ke()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):YE(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function qE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}GE.initClass(),GE._$name="RecurrenceEditor";function KE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var XE=function(e){fe()(n,e);var t=KE(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"changeShowEventColor",value:function(e){return Boolean(e)}},{key:"updateShowEventColor",value:function(e){this.element.classList[e?"add":"remove"]("b-show-event-color")}},{key:"changePicker",value:function(e,t){return(e=we()(pe()(n.prototype),"changePicker",this).call(this,e,t))&&e.element.classList[this.showEventColor?"add":"remove"]("b-show-event-color"),e}},{key:"syncInputFieldValue",value:function(){var e,t,r=this,i=r.resourceIcon,o=r.lastResourceIconCls,a=i.classList,s=null!==(e=null===(t=r.selected)||void 0===t?void 0:t.eventColor)&&void 0!==e?e:"";we()(pe()(n.prototype),"syncInputFieldValue",this).call(this),i.style.color="",o&&a.remove(o),r.lastResourceIconCls=null,s?(s.startsWith("#")?i.style.color=s:(r.lastResourceIconCls="b-sch-foreground-".concat(s),a.add(r.lastResourceIconCls)),a.remove("b-hide-display")):a.add("b-hide-display")}},{key:"innerElements",get:function(){return[{class:"b-icon b-resource-icon b-icon-square b-hide-display",reference:"resourceIcon"},this.inputElement]}}],[{key:"$name",get:function(){return"ResourceCombo"}},{key:"type",get:function(){return"resourcecombo"}},{key:"configurable",get:function(){return{showEventColor:!1,picker:{cls:"b-resourcecombo-picker",itemIconTpl:function(e,t){var n=e.eventColor,r=null==n?void 0:n.startsWith("#"),i=n?r?' style="color:'.concat(n,'"'):"":' style="display:none"',o=!n||r?"":" b-sch-foreground-".concat(n);return'<div class="b-icon b-icon-square'.concat(o,'"').concat(i,"></div>")}}}}}]),n}(Xf);function ZE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}XE.initClass(),XE._$name="ResourceCombo";var JE=function(e){fe()(r,e);var t,n=ZE(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"construct",value:function(e,t){this.scheduler=e,this.readOnly=e.readOnly,we()(pe()(r.prototype),"construct",this).call(this,e,t),e.on({projectChange:"onChangeProject",readOnly:"onClientReadOnlyToggle",thisObj:this})}},{key:"updateReadOnly",value:function(e){this.editor&&(this.editor.readOnly=e)}},{key:"onClientReadOnlyToggle",value:function(e){var t=e.readOnly;this.readOnly=t}},{key:"getEditor",value:function(){var e,t,n,r,i,o=this,a=o.editor;return a||((a=o.editor=oc.create(o.getEditorConfig())).readOnly=o._readOnly,0===a.items.length&&console.warn("Event Editor configured without any `items`"),a.on({beforehide:"resetEditingContext",beforeshow:"onBeforeEditorShow",keydown:"onPopupKeyDown",thisObj:o}),this.scheduler.relayEvents(a,["beforeSetRecord"],"eventEdit"),Object.values(a.widgetMap).forEach((function(e){var t=e.ref||e.id;if(t&&!o[t])switch(o[t]=e,e.name){case"startDate":case"endDate":e.on("change",o.onDatesChange,o)}})),null===(e=o.onEditorConstructed)||void 0===e||e.call(o,a),null===(t=o.eventTypeField)||void 0===t||t.on("change",o.onEventTypeChange,o),null===(n=o.saveButton)||void 0===n||n.on("click",o.onSaveClick,o),null===(r=o.deleteButton)||void 0===r||r.on("click",o.onDeleteClick,o),null===(i=o.cancelButton)||void 0===i||i.on("click",o.onCancelClick,o),o.editor)}},{key:"getEditorConfig",value:function(){var e=this,t=e.autoClose,n=e.cls,r=e.scheduler;return an.assign({owner:r,eventEditFeature:e,weekStartDay:e.weekStartDay,align:"b-t",id:"".concat(r.id,"-event-editor"),autoShow:!1,anchor:!0,scrollAction:"realign",clippedBy:[r.timeAxisSubGridElement,r.bodyContainer],constrainTo:window,autoClose:t,cls:n},e.editorConfig)}},{key:"internalShowEditor",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=this,o=i.scheduler,a=n||Cr.down(o.getElementFromEventRecord(e,t),o.eventInnerSelector);if(a||!e.isPartOfStore(o.eventStore)){var s;if(!1===o.trigger("beforeEventEdit",{eventEdit:i,eventRecord:e,resourceRecord:t,eventElement:a}))return o.element.classList.remove("b-eventeditor-editing"),null===(s=i.phantomEventElement)||void 0===s||s.remove(),void(i.phantomEventElement=null);i.resourceRecord=t;var u=i.getEditor(e);i.editingContext={eventRecord:e,resourceRecord:t,eventElement:a,editor:u},we()(pe()(r.prototype),"internalShowEditor",this)&&we()(pe()(r.prototype),"internalShowEditor",this).call(this,e,t,n),i.typeField&&i.toggleEventType(e.get(i.typeField)),i.isEditing=!0,i.loadRecord(e,t),u.centered||!u.anchor?u.show():a?(i.targetEventElement=a,u.showBy({target:a,anchor:!0})):u.showBy({target:o.element,anchor:!1,align:"c-c"});var c=o.timeAxisViewModel.timeResolution;"hour"!==c.unit&&"minute"!==c.unit||(i.startTimeField.step=i.endTimeField.step="".concat(c.increment).concat(c.unit))}}},{key:"onBeforeEditorShow",value:function(){this.scheduler.trigger("beforeEventEditShow",Object.assign({eventEdit:this},this.editingContext))}},{key:"updateTargetEventElement",value:function(e,t){e&&e.classList.add("b-editing"),t&&t.classList.remove("b-editing")}},{key:"editEvent",value:function(e,t){var n=this;if(n.isEditing&&n.resetEditingContext(),!n.disabled)return n.scheduler.element.classList.add("b-eventeditor-editing"),n.doEditEvent.apply(n,arguments)}},{key:"doEditEvent",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=this,i=r.scheduler,o=!e.isOccurrence&&i.eventStore.indexOf(e)<0;t||(t=e.resource||r.resourceStore.getById(e.resourceId)),o&&(this.phantomEventElement=n,Qy.prototype.normalize.call(e)),n||o?r.internalShowEditor(e,t,n):i.scrollResourceEventIntoView(t,e,null,{animate:!0,edgeOffset:0,extendTimeAxis:!1}).then((function(){return r.internalShowEditor(e,t)}),(function(){return i.element.classList.remove("b-eventeditor-editing")}))}},{key:"loadRecord",value:function(e,t){this.loadingRecord=!0,this.internalLoadRecord(e,t),this.loadingRecord=!1}},{key:"internalLoadRecord",value:function(e,t){var n=this,i=n.client.eventStore,o=n.editor;if(n.eventRecord=e,n.resourceRecord=t,o.record=e,n.resourceField){var a=i.getResourcesForEvent(e);o._isSettingValues=!0,!i.storage.includes(e,!0)&&n.resourceRecord?n.resourceField.value=n.resourceRecord[n.resourceField.valueField]:n.assignmentStore&&(n.resourceField.value=a.map((function(e){return e[n.resourceField.valueField]}))),o._isSettingValues=!1}we()(pe()(r.prototype),"internalLoadRecord",this).call(this,e,t)}},{key:"toggleEventType",value:function(e){this.editor.element.dataset.eventType=e||"",this.editor.eachWidget((function(t){var n;(null===(n=t.dataset)||void 0===n?void 0:n.eventType)&&(t.hidden=t.dataset.eventType!==e)}))}},{key:"finalizeEventSave",value:(t=Wr()(Vr.a.mark((function e(t,n,r,i){var o,a,s,u,c,l,f,d;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=(o=this).scheduler,s=o.eventStore,u=o.assignmentStore,c=o.phantomEventElement,u.suspendAutoCommit(),a.suspendRefresh(),o.onBeforeSave(t),t.beginBatch(),o.updateRecord(t),t.endBatch(),t.isOccurrence){e.next=20;break}if(!s||t.stores.length){e.next=19;break}if(!1===a.trigger("beforeEventAdd",{eventRecord:t,resourceRecords:n,resources:n})){e.next=15;break}s.add(t),l=s.assignEventToResource(t,n),f=ye()(l,1),d=f[0],c&&(o.eventStore.includes(t)?Gs.addChild(a.foregroundCanvas,c,d.id):c.remove(),o.phantomEventElement=null),e.next=17;break;case 15:return r(!1),e.abrupt("return");case 17:e.next=20;break;case 19:s.assignEventToResource(t,n,!0);case 20:return e.next=22,a.project.commitAsync();case 22:u.resumeAutoCommit(),a.resumeRefresh(!0),a.trigger("afterEventSave",{eventRecord:t}),o.onAfterSave(t),r(t);case 27:case"end":return e.stop()}}),e,this)}))),function(e,n,r,i){return t.apply(this,arguments)})},{key:"save",value:function(){var e=this;return new Promise((function(t,n){var r,i=e,o=i.scheduler,a=i.eventRecord;if(a&&i.isValid){var s=i.eventStore,u=i.values,c=(null===(r=i.resourceField)||void 0===r?void 0:r.records)||(i.resourceRecord?[i.resourceRecord]:[]),l=c[0];if(!i.scheduler.allowOverlap&&s)if(c.some((function(e){return!s.isDateRangeAvailable(u.startDate,u.endDate,a,e)})))return void t(!1);var f={finalize:function(e){try{!1!==e?i.finalizeEventSave(a,c,t,n):t(!1)}catch(e){n(e)}}};!1!==o.trigger("beforeEventSave",{eventRecord:a,resourceRecords:c,resourceRecord:l,values:u,context:f})?f.finalize():f.async||t()}else t(!1)}))}},{key:"deleteEvent",value:function(){var e=this;return new Promise((function(t,n){var r=e,i=r.eventRecord,o=r.editor;r.scheduler.removeRecords([i],(function(e){e&&o.containsFocus&&o.revertFocus(),t(e)}))}))}},{key:"onChangeProject",value:function(e){var t=e.project;this.resourceField&&(this.resourceField.store=t.resourceStore)}},{key:"onActivateEditor",value:function(e){var t=e.eventRecord,n=e.resourceRecord,r=e.eventElement;this.editEvent(t,n,r)}},{key:"onDragCreateEnd",value:function(e){var t=e.newEventRecord,n=e.resourceRecord,r=e.proxyElement;if(!this.disabled){this.scheduler.onEventCreated(t);var i=r.cloneNode(!0);i.removeAttribute("id"),r.parentElement.appendChild(i),this.editEvent(t,n,i)}}},{key:"onEventEnterKey",value:function(e){var t=e.assignmentRecord,n=e.eventRecord,r=e.target.closest(this.client.eventInnerSelector);t?this.editEvent(n,t.resource,r):n&&this.editEvent(n,n.resource,r)}},{key:"onEventTypeChange",value:function(e){var t=e.value;this.toggleEventType(t)}},{key:"populateEventMenu",value:function(e){var t=this,n=e.eventRecord,r=e.resourceRecord,i=e.items;this.scheduler.readOnly||(i.editEvent={text:"L{EventEdit.Edit event}",localeClass:this,icon:"b-icon b-icon-edit",weight:100,onItem:function(){t.editEvent(n,r)}})}},{key:"readOnly",get:function(){return this.editor?this.editor.readOnly:this._readOnly}},{key:"resourceStore",set:function(e){this._resourceStore=e},get:function(){return this.scheduler.project.resourceStore}},{key:"eventStore",get:function(){return this.scheduler.project.eventStore}},{key:"assignmentStore",get:function(){return this.scheduler.project.assignmentStore}}],[{key:"$name",get:function(){return"EventEdit"}},{key:"configurable",get:function(){return{triggerEvent:"eventdblclick",showResourceField:!0,resourceFieldConfig:null,typeField:"eventType",eventRecord:null,readOnly:null,editorConfig:{type:"eventeditor",title:"L{EventEdit.Edit event}",closable:!0,localeClass:this,defaults:{localeClass:this},items:{nameField:{type:"text",label:"L{Name}",clearable:!0,name:"name",weight:100,required:!0},resourceField:{type:"resourcecombo",label:"L{Resource}",name:"resource",editable:!0,valueField:"id",displayField:"name",highlightExternalChange:!1,weight:200},startDateField:{type:"date",cls:"b-inline",clearable:!1,required:!0,label:"L{Start}",name:"startDate",flex:"1 0 60%",weight:300},startTimeField:{type:"time",clearable:!1,required:!0,name:"startDate",cls:"b-match-label",flex:"1 0 40%",weight:400},endDateField:{type:"date",cls:"b-inline",clearable:!1,required:!0,label:"L{End}",name:"endDate",flex:"1 0 60%",weight:500},endTimeField:{type:"time",clearable:!1,required:!0,name:"endDate",cls:"b-match-label",flex:"1 0 40%",weight:600}},bbar:{hideWhenEmpty:!0,defaults:{localeClass:this},items:{saveButton:{color:"b-green",text:"L{Save}",weight:100},deleteButton:{color:"b-gray",text:"L{Delete}",weight:200},cancelButton:{color:"b-gray",text:"L{Object.Cancel}",weight:300}}}},targetEventElement:null}}},{key:"pluginConfig",get:function(){return{chain:["populateEventMenu","onEventEnterKey"],assign:["editEvent"]}}}]),r}(kE.mixin((function(e){return function(e){fe()(n,e);var t=qE(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"changeEditorConfig",value:function(e){return e.items=UE(UE({},e.items),this.recurringEventsItems),e=we()(pe()(n.prototype),"changeEditorConfig",this).call(this,e)}},{key:"construct",value:function(e,t){we()(pe()(n.prototype),"construct",this).call(this,e,t),this.scheduler.on({beforeEventDelete:this.onRecurrableEventBeforeDelete,beforeEventSave:this.onRecurrableEventBeforeSave,thisObj:this})}},{key:"doDestroy",value:function(){this._recurrenceConfirmation&&this.recurrenceConfirmation.destroy(),this._recurrenceEditor&&this.recurrenceEditor.destroy(),we()(pe()(n.prototype),"doDestroy",this).call(this)}},{key:"onEditorConstructed",value:function(e){var t=this;e.on("hide",t.onRecurringEventEditorHide,t),e.widgetMap.editRecurrenceButton.menu=t.recurrenceEditor,t.recurrenceCombo.on("change",t.onRecurrenceComboChange.bind(t))}},{key:"internalShowEditor",value:function(){this.toggleRecurringFieldsVisibility(this.client.enableRecurringEvents&&!1!==this.showRecurringUI)}},{key:"toggleRecurringFieldsVisibility",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=e?"show":"hide";this.editRecurrenceButton&&this.editRecurrenceButton[t](),this.recurrenceCombo&&this.recurrenceCombo[t]()}},{key:"onRecurringEventEditorHide",value:function(e){e.source;var t=this.recurrenceEditor,n=this.recurrenceConfirmation;t&&t.isVisible&&t.hide(),n&&n.isVisible&&n.hide()}},{key:"makeRecurrence",value:function(e){var t=this.eventRecord,n=t.copy(),r=t.recurrence;return(r=!e&&r?r.copy():new t.recurrenceModel(e?{rule:e}:{})).timeSpan=n,n.setStartDate(this.values.startDate),r.suspendTimeSpanNotifying(),r}},{key:"onRecurrableEventBeforeSave",value:function(e){var t=e.eventRecord,n=e.context;if(t.supportsRecurring&&(t.isRecurring||t.isOccurrence))return this.recurrenceConfirmation.confirm({actionType:"update",eventRecord:t,changerFn:function(){n.finalize(!0)},cancelFn:function(){n.finalize(!1)}}),n.async=!0,!1}},{key:"showDisplayConfirmationOnEventDelete",value:function(e){return this.isEditing&&this.eventRecord===e&&e.supportsRecurring&&(e.isRecurring||e.isOccurrence)}},{key:"onRecurrableEventBeforeDelete",value:function(e){var t=e.eventRecords,n=e.context,r=ye()(t,1)[0];if(this.showDisplayConfirmationOnEventDelete(r))return this.recurrenceConfirmation.confirm({actionType:"delete",eventRecord:r,changerFn:function(){n.finalize(!0)},cancelFn:function(){n.finalize(!1)}}),!1}},{key:"onBeforeShowRecurrenceEditor",value:function(){var e=this,t=e.recurrenceEditor,n=e.eventRecord;t&&n&&n.supportsRecurring&&(e.recurrence||(e.recurrence=e.makeRecurrence()),e.recurrence.timeSpan.setStartDate(e.values.startDate),t.record=e.recurrence,t.centered=!0)}},{key:"loadRecurrenceData",value:function(e){this.recurrence=e,this.updateRecurrenceFields(e)}},{key:"updateRecurrenceFields",value:function(e){var t=this,n=t.editRecurrenceButton;t.recurrenceCombo&&(t.recurrenceCombo.recurrence=e),n&&(n.recurrence=e,n.value=e?e.rule:null,e&&t.client.enableRecurringEvents&&!1!==t.showRecurringUI?n.show():n.hide())}},{key:"onRecurrenceComboChange",value:function(e){var t=e.source,n=e.value,r=e.userAction,i=this,o=i.recurrenceEditor;n==t.customValue?r&&(i.recurrenceCombo.recurrence=i.makeRecurrence(),o.centered?o.show():o.show((i.editRecurrenceButton||t).element)):i.loadRecurrenceData(n?i.makeRecurrence("FREQ=".concat(n)):null)}},{key:"recurrenceEditorSaveHandler",value:function(e,t){e.syncEventRecord(t),this.updateRecurrenceFields(t),e.close()}},{key:"onDatesChange",value:function(){for(var e,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];(e=we()(pe()(n.prototype),"onDatesChange",this)).call.apply(e,[this].concat(r));var o=this,a=o.editRecurrenceButton;if(!o.loadingRecord&&a){var s=o.values.startDate;s&&(a.eventStartDate=s)}}},{key:"internalLoadRecord",value:function(e,t){this.recurrenceCombo&&e&&e.supportsRecurring&&this.loadRecurrenceData(e.recurrence?this.makeRecurrence():null)}},{key:"recurrenceConfirmation",set:function(e){this._recurrenceConfirmation=e},get:function(){var e=this._recurrenceConfirmation;return e&&e.$$name||(e=oc.create(Object.assign({type:"recurrenceconfirmation",owner:this.getEditor()},e)),this._recurrenceConfirmation=e),e}},{key:"recurrenceEditor",set:function(e){this._recurrenceEditor=e},get:function(){var e=this,t=e._recurrenceEditor;return t&&t.$$name||(t=oc.create(Object.assign({type:"recurrenceeditor",autoShow:!1,clippedBy:[e.scheduler.timeAxisSubGridElement,e.scheduler.bodyContainer],centered:!0,modal:!0,constrainTo:window,anchor:!1,saveHandler:e.recurrenceEditorSaveHandler,onBeforeShow:e.onBeforeShowRecurrenceEditor.bind(e),thisObj:e},t)),e._recurrenceEditor=t,t.readOnly=e._readOnly),t}}],[{key:"$name",get:function(){return"RecurringEventEdit"}},{key:"configurable",get:function(){return{recurringEventsItems:{recurrenceCombo:{type:"recurrencecombo",label:"L{EventEdit.Repeat}",ref:"recurrenceCombo",weight:700},editRecurrenceButton:{type:"recurrencelegendbutton",ref:"editRecurrenceButton",name:"recurrenceRule",color:"b-gray",flex:"1",weight:800}},showRecurringUI:null}}}]),n}(e||ue)}),_a));function QE(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}JE._$name="EventEdit",fv.registerFeature(JE,!0,"Scheduler"),fv.registerFeature(JE,!1,"SchedulerPro"),JE.initClass();var eT=function(e){fe()(n,e);var t=QE(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e,t){we()(pe()(n.prototype),"construct",this).call(this,e,t),this.scheduler=e}},{key:"populateHeaderMenu",value:function(e){var t=e.column;e.items;"timeAxis"===t.type&&this.populateTimeAxisHeaderMenu.apply(this,arguments)}},{key:"populateTimeAxisHeaderMenu",value:function(e){e.column;var t=e.items,n=this;t.eventsFilter={text:"L{filterEvents}",icon:"b-fw-icon b-icon-filter",disabled:n.disabled,localeClass:this,weight:100,menu:{type:"popup",localeClass:this,items:{nameFilter:{weight:110,type:"textfield",cls:"b-eventfilter b-last-row",clearable:!0,keyStrokeChangeDelay:300,label:"L{byName}",localeClass:this,width:200,listeners:{change:n.onEventFilterChange,thisObj:n}}},onBeforeShow:function(e){var t=e.source,r=ye()(t.items,1)[0],i=n.scheduler.eventStore.filters.getBy("property","name");r.value=i&&i.value||""}}}}},{key:"onEventFilterChange",value:function(e){var t=e.value;""!==t?this.scheduler.eventStore.filter("name",t):this.scheduler.eventStore.removeFilter("name")}}],[{key:"$name",get:function(){return"EventFilter"}},{key:"pluginConfig",get:function(){return{chain:["populateHeaderMenu","populateTimeAxisHeaderMenu"]}}}]),n}(qr);function tT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}eT.featureClass="b-event-filter",eT._$name="EventFilter",fv.registerFeature(eT,!0,["Scheduler","Gantt"]);var nT={top:"b-t",right:"b100-t100",bottom:"t-b",left:"b0-t0"},rT=function(e){fe()(r,e);var t,n=tT(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"render",value:function(){var e=this;e.resize&&e.resize.destroy(),e.resize=e.createResizeHelper(),e.showTooltip&&(e.clockTemplate=new eE({scheduler:e.client}))}},{key:"doDestroy",value:function(){var e=this;e.tip&&e.tip.destroy(),e.clockTemplate&&e.clockTemplate.destroy(),e.resize&&e.resize.destroy(),we()(pe()(r.prototype),"doDestroy",this).call(this)}},{key:"isElementResizable",value:function(e,t){var n=this.client,r=this.resize,i=n.resolveTimeSpanRecord(e);if(n.readOnly)return!1;var o=i&&i.isResizable,a=(e=Cr.up(t.target,n.eventSelector))?e.firstElementChild:e,s=t.target.closest('[class$="-handle"]');if(!o||s&&s!==a)return!1;var u=e.classList.contains("b-sch-event-startsoutside"),c=e.classList.contains("b-sch-event-endsoutside");if(!0===o){if(u&&c)return!1;if(u)o="end";else{if(!c)return r.overStartHandle(t,e)||r.overEndHandle(t,e);o="start"}}return!(u&&"start"===o||c&&"end"===o)&&!!(r.overStartHandle(t,e)&&"start"===o||r.overEndHandle(t,e)&&"end"===o)}},{key:"onBeforeResizeStart",value:function(e){var t,n=e.element,r=e.event,i=this.client,o=i.scheduledEventName,a=i.resolveTimeSpanRecord(n);return!this.disabled&&!1!==i.trigger("before".concat(i.capitalizedEventName,"Resize"),(t={},ke()(t,o+"Record",a),ke()(t,"event",r),t))}},{key:"onResizeStart",value:function(e){var t,n=e.context,r=e.event,i=this,o=i.client,a=o.resolveTimeSpanRecord(n.element),s=o.scheduledEventName;o.element.classList.add("b-resizing-event"),i.setupProductResizeContext(n,r),i.showTooltip&&(i.tip?(i.tip.align=nT[n.edge],i.tip.showBy(i.getTooltipTarget())):(i.tip=new Kl({id:"".concat(o.id,"-event-resize-tip"),autoShow:!0,axisLock:!0,trackMouse:!1,updateContentOnMouseMove:!0,getHtml:i.getTipHtml.bind(i),align:nT[n.edge],hideDelay:0}),i.tip.on("innerhtmlupdate",i.updateDateIndicator,i))),a.instanceMeta(o).retainElement=!0,o.trigger("".concat(s,"ResizeStart"),(t={},ke()(t,"".concat(s,"Record"),a),ke()(t,"event",r),t))}},{key:"updateDateIndicator",value:function(){var e=this.resize.context,t=e.edge,n=e.startDate,r=e.endDate,i=this.tip.element;(n||r)&&("right"===t||"bottom"===t?this.clockTemplate.updateDateIndicator(i.querySelector(".b-sch-tooltip-enddate"),r):this.clockTemplate.updateDateIndicator(i,n))}},{key:"getTooltipTarget",value:function(){var e=this,t=En.from(e.resize.context.element,null,!0);return"horizontal"===e.resize.direction?("right"===e.resize.context.edge&&(t.x=t.right-1),t.width=e.tip.anchorSize[0]/2):("bottom"===e.resize.context.edge&&(t.y=t.bottom-1),t.height=e.tip.anchorSize[1]/2),{target:t}}},{key:"onResizing",value:function(e){var t,n,r,i=e.context,o=e.event,a=this,s=a.client,u=s.features.dependencies,c=a.getTimespanRecord(i),l=s.scheduledEventName,f=i.element,d=i.edge,h=Cr.getTranslateXY(f);if("top"===d||"left"===d?(r=c.endDate,s.snapRelativeToEventStartDate?(n=s.getDateFromXY(h,null,!0),n=s.timeAxis.roundDate(n,c.startDate)):n=s.getDateFromXY(h,"round",!0)):(h[0]+=f.offsetWidth,h[1]+=f.offsetHeight,n=c&&c.startDate,s.snapRelativeToEventStartDate?(r=s.getDateFromXY(h,null,!0),r=s.timeAxis.roundDate(r,c.endDate)):r=s.getDateFromXY(h,"round",!0)),n=n||i.startDate,r=r||i.endDate,i.dateConstraints&&(n=Zt.constrain(n,i.dateConstraints.start,i.dateConstraints.end),r=Zt.constrain(r,i.dateConstraints.start,i.dateConstraints.end)),a.showExactResizePosition||s.timeAxisViewModel.snap){var v="top"===d||"left"===d?s.timeAxisViewModel.getDistanceBetweenDates(n,c.endDate):s.timeAxisViewModel.getDistanceBetweenDates(c.startDate,r);switch(d){case"top":Cr.setTranslateY(f,i.elementStartY+i.elementWidth-v),f.style.height=v+"px";break;case"right":f.style.width=v+"px";break;case"bottom":f.style.height=v+"px";break;case"left":Cr.setTranslateX(f,i.elementStartX+i.elementWidth-v),f.style.width=v+"px"}}var p=i.endDate-r!=0||i.startDate-n!=0;i.endDate=r,i.startDate=n,p&&(i.valid=a.checkValidity(i,o)),s.trigger("".concat(l,"PartialResize"),(t={},ke()(t,"".concat(l,"Record"),c),ke()(t,"startDate",n),ke()(t,"endDate",r),ke()(t,"element",f),ke()(t,"context",i),t)),u&&u.updateDependenciesForTimeSpan(c,f),a.showTooltip&&a.tip.alignTo(a.getTooltipTarget())}},{key:"checkValidity",value:function(e,t){var n=e.startDate&&e.endDate>e.startDate&&this.validatorFn.call(this.validatorFnThisObj||this,e,t);return n&&"boolean"!=typeof n&&(e.message=n.message||"",n=n.valid),!1!==n}},{key:"onFinishResize",value:function(e){e.source;var t=e.context,n=e.event,r=this,i=r.getTimespanRecord(t),o=i.startDate,a=i.endDate,s=t.startDate||o,u=t.endDate||a,c=r.client,l=!1;r.tip&&r.tip.hide(),i.instanceMeta(c).retainElement=!1,t.oldFinalize=t.finalize,t.finalize=function(){t.async&&r.finalize.apply(r,arguments)},t.valid=s&&u&&u-s>0&&(s-o!=0||u-a!=0)&&!1!==t.valid,t.valid&&(c.trigger("before".concat(c.scheduledEventName,"ResizeFinalize"),{context:t,event:n}),l=!0),t.async||r.finalize(l)}},{key:"onCancelResize",value:function(e){var t=e.context,n=this.getTimespanRecord(t);n&&(n.instanceMeta(this.client).retainElement=!1),this.finalize(!1)}},{key:"finalize",value:(t=Wr()(Vr.a.mark((function e(t){var n,r,i,o,a,s,u;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(n=this).client,i=n.resize.context,o=n.getTimespanRecord(i),a=r.scheduledEventName,s=!1,n.tip&&n.tip.hide(),!i.started){e.next=9;break}if(!t){e.next=8;break}return e.next=7,n.internalUpdateRecord(i,o);case 7:s=e.sent;case 8:t&&s?i.oldFinalize():(u=r.features.dependencies,n.resize.abortResize(null,!0),u&&u.scheduleDraw(!0));case 9:r.element.classList.remove("b-resizing-event"),r.trigger("".concat(a,"ResizeEnd"),ke()({changed:s},"".concat(a,"Record"),o||r.resolveEventRecord(i.element)));case 11:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"getTipHtml",value:function(e){var t=e.tip,n=this,r=n.resize.context,i=r.startDate,o=r.endDate,a=r.valid,s=r.message;if(!i||!o)return t.html;void 0===s&&(s=""),o=n.client.getDisplayEndDate(o,i);var u=n.client.getFormattedDate(i),c=n.client.getFormattedDate(o);return n.tipTemplate({valid:a,startDate:i,endDate:o,startText:u,endText:c,message:s,startClockHtml:n.clockTemplate.template({date:i,text:u,cls:"b-sch-tooltip-startdate"}),endClockHtml:n.clockTemplate.template({date:o,text:c,cls:"b-sch-tooltip-enddate"})})}},{key:"getRowRecord",value:function(e){throw new Error("Implement in subclass")}},{key:"getTimespanRecord",value:function(e){throw new Error("Implement in subclass")}},{key:"setupProductResizeContext",value:function(e,t){throw new Error("Implement in subclass")}},{key:"store",get:function(){throw new Error("Implement in subclass")}}],[{key:"defaultConfig",get:function(){return{showTooltip:!0,showExactResizePosition:!1,validatorFn:function(){},validatorFnThisObj:null,tip:null,tipTemplate:function(e){return'\n                <div class="b-sch-tip-'.concat(e.valid?"valid":"invalid",'">\n                    ').concat(e.startClockHtml,"\n                    ").concat(e.endClockHtml,'\n                    <div class="b-sch-tip-message">').concat(e.message,"</div>\n                </div>\n            ")}}}},{key:"pluginConfig",get:function(){return{chain:["render"]}}}]),r}(qr);function iT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}rT._$name="ResizeBase";var oT=function(e){fe()(r,e);var t,n=iT(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"createResizeHelper",value:function(){var e=this,t=e.client;return new Su({direction:t.isVertical?"vertical":"horizontal",name:e.constructor.$$name,isElementResizable:function(t,n){return e.isElementResizable(t,n)},targetSelector:t.eventSelector,handleContainerSelector:t.eventInnerSelector,resizingCls:"b-sch-event-wrap-resizing",allowResize:e.isElementResizable.bind(e),outerElement:t.timeAxisSubGridElement,scrollManager:t.scrollManager,dragThreshold:0,dynamicHandleSize:!0,reservedSpace:5,scroller:t.timeAxisSubGrid.scrollable,listeners:{beforeresizestart:e.onBeforeResizeStart,resizestart:e.onResizeStart,resizing:e.onResizing,resize:e.onFinishResize,cancel:e.onCancelResize,thisObj:e}})}},{key:"getTimespanRecord",value:function(e){return e.eventRecord}},{key:"getRowRecord",value:function(e){return e.resourceRecord}},{key:"setupProductResizeContext",value:function(e,t){var n=this.client,r=n.resolveEventRecord(e.element),i=n.resolveResourceRecord(e.element);Object.assign(e,{eventRecord:r,resourceRecord:i,dateConstraints:n.getDateConstraints(i,r)})}},{key:"onResizeStart",value:function(e){var t=e.context,n=e.event;we()(pe()(r.prototype),"onResizeStart",this).call(this,{context:t,event:n}),this.client.features.dependencies&&this.client.features.dependencies.hideTerminals(t.element),t.element.querySelector(".b-sch-event").classList.add("b-sch-event-resizing")}},{key:"checkValidity",value:function(e,t){return(this.client.allowOverlap||this.client.isDateRangeAvailable(e.startDate,e.endDate,e.eventRecord,e.resourceRecord))&&we()(pe()(r.prototype),"checkValidity",this).call(this,e,t)}},{key:"onFinishResize",value:function(e){var t=e.source,n=e.context,i=e.event;we()(pe()(r.prototype),"onFinishResize",this).call(this,{source:t,context:n,event:i}),this.client.features.dependencies&&this.client.features.dependencies.showTerminals(n.eventRecord,n.element)}},{key:"internalUpdateRecord",value:(t=Wr()(Vr.a.mark((function e(t,n){var r;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=n.generation,!n.isOccurrence){e.next=5;break}n.set(Qy.prototype.inSetNormalize.call(n,{startDate:t.startDate,endDate:t.endDate})),e.next=12;break;case 5:if("left"!==t.edge&&"top"!==t.edge){e.next=10;break}return e.next=8,n.setStartDate(t.startDate,!1);case 8:e.next=12;break;case 10:return e.next=12,n.setEndDate(t.endDate,!1);case 12:if(n.generation===r){e.next=14;break}return e.abrupt("return",!0);case 14:return e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e)}))),function(e,n){return t.apply(this,arguments)})},{key:"finalize",value:function(e){this.resize.context.element.querySelector(".b-sch-event").classList.remove("b-sch-event-resizing"),we()(pe()(r.prototype),"finalize",this).call(this,e)}},{key:"store",get:function(){return this.client.eventStore}}],[{key:"$name",get:function(){return"EventResize"}}]),r}(rT);function aT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}oT._$name="EventResize",fv.registerFeature(oT,!0,"Scheduler");var sT=function(e){fe()(n,e);var t=aT(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e,t){var r=this;t=r.processConfig(t),we()(pe()(n.prototype),"construct",this).call(this,e,t),r.forSelector||(r.forSelector="".concat(e.eventInnerSelector,":not(.b-dragproxy)")),r.clockTemplate=new eE({scheduler:e}),e.on(ke()({},"before".concat(e.scheduledEventName,"drag"),(function(){var e;return null===(e=r.tooltip)||void 0===e?void 0:e.hide()})))}},{key:"processConfig",value:function(e){return"function"==typeof e?{template:e}:e}},{key:"setConfig",value:function(e){we()(pe()(n.prototype),"setConfig",this).call(this,this.processConfig(e))}},{key:"doDestroy",value:function(){var e,t;null===(e=this.clockTemplate)||void 0===e||e.destroy(),null===(t=this.tooltip)||void 0===t||t.destroy(),we()(pe()(n.prototype),"doDestroy",this).call(this)}},{key:"doDisable",value:function(e){this.tooltip&&(this.tooltip.disabled=e),we()(pe()(n.prototype),"doDisable",this).call(this,e)}},{key:"render",value:function(){var e=this,t=e.client,n=[".b-dragselecting",".b-eventeditor-editing",".b-taskeditor-editing",".b-resizing-event",".b-dragcreating",".b-dragging-".concat(t.scheduledEventName),".b-creating-dependency",".b-dragproxy"].map((function(e){return":not(".concat(e,")")})).join("");e.tooltip&&e.tooltip.destroy(),e.tooltip=new Kl(Object.assign({axisLock:"flexible",id:e.tipId||"".concat(e.client.id,"-event-tip"),cls:e.tipCls,forSelector:".b-timelinebase".concat(n," .b-grid-body-container:not(.b-scrolling) ").concat(e.forSelector),scrollAction:"realign",clippedBy:[t.timeAxisSubGridElement,t.bodyContainer],forElement:t.timeAxisSubGridElement,showOnHover:!0,hoverDelay:0,hideDelay:100,anchorToTarget:!0,allowOver:Boolean(e.config.items||e.config.tools),getHtml:e.getTipHtml.bind(e),disabled:e.disabled},e.config)),e.tooltip.on("innerhtmlupdate",e.updateDateIndicator,e)}},{key:"updateDateIndicator",value:function(){var e=this.client,t=this.tooltip,n=t.activeTarget&&e.resolveTimeSpanRecord(t.activeTarget),r=t.element.querySelector(".b-sch-tooltip-enddate");n&&(this.clockTemplate.updateDateIndicator(t.element,n.startDate),r&&this.clockTemplate.updateDateIndicator(r,n.endDate))}},{key:"resolveTimeSpanRecord",value:function(e){return this.client.resolveTimeSpanRecord(e)}},{key:"getTipHtml",value:function(e){var t=e.tip,n=e.activeTarget,r=this,i=r.client,o=r.recordType||"".concat(i.scheduledEventName,"Record"),a=r.resolveTimeSpanRecord(n);if((null==a?void 0:a.startDate)instanceof Date){var s,u=a.startDate,c=a.endDate,l=i.getFormattedDate(u),f=i.getDisplayEndDate(c,u),d=i.getFormattedDate(f);return t.eventRecord=a,r.template((s={tip:t},ke()(s,"".concat(o),a),ke()(s,"startDate",u),ke()(s,"endDate",c),ke()(s,"startText",l),ke()(s,"endText",d),ke()(s,"startClockHtml",r.clockTemplate.template({date:u,text:l,cls:"b-sch-tooltip-startdate"})),ke()(s,"endClockHtml",a.isMilestone?"":r.clockTemplate.template({date:f,text:d,cls:"b-sch-tooltip-enddate"})),s))}return t.hide(),""}}],[{key:"defaultConfig",get:function(){return{autoUpdate:!1,template:null,cls:null,align:{align:"b-t"},clockTemplate:null}}},{key:"pluginConfig",get:function(){return{chain:["render"]}}}]),n}(qr);function uT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}sT._$name="TooltipBase";var cT=function(e){fe()(n,e);var t=uT(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e,t){we()(pe()(n.prototype),"construct",this).call(this,e,t),"string"==typeof this.align&&(this.align={align:this.align})}},{key:"render",value:function(){var e=this.client.features.dependencies;if(we()(pe()(n.prototype),"render",this).call(this),e){var t=this.align.offset;this.tooltip.on("beforeshow",(function(n){var r=n.source;e.disabled?r.align.offset=t:r.align.offset=[0,10]}))}}}],[{key:"$name",get:function(){return"EventTooltip"}},{key:"defaultConfig",get:function(){return{template:function(e){return"\n                ".concat(e.eventRecord.name?'<div class="b-sch-event-title">'.concat(e.eventRecord.name,"</div>"):"","\n                ").concat(e.startClockHtml,"\n                ").concat(e.endClockHtml)},cls:"b-sch-event-tooltip"}}}]),n}(sT);function lT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}cT._$name="EventTooltip",fv.registerFeature(cT,!0,"Scheduler");var fT=function(e){fe()(n,e);var t=lT(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"refreshContent",value:function(){this.headersElement&&0===this.headersElement.childNodes.length&&we()(pe()(n.prototype),"refreshContent",this).call(this)}}],[{key:"$name",get:function(){return"SchedulerHeader"}}]),n}(Bg);function dT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}fT._$name="Header";var hT=function(e){fe()(n,e);var t=dT(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e){var t=this;t.unitToPixelsCache={},we()(pe()(n.prototype),"construct",this).call(this,e);var r=t.timeAxis.viewPreset||t.viewPreset;if(r)if(r instanceof jx)t.consumeViewPreset(r);else{var i=$x.getPreset(r);i&&t.consumeViewPreset(i)}t.timeAxis.on("reconfigure",t.onTimeAxisReconfigure,t),t.configured=!0}},{key:"doDestroy",value:function(){this.timeAxis.un("reconfigure",this.onTimeAxisReconfigure,this)}},{key:"reconfigure",value:function(e){this.headers=null,this.setConfig(e),this.trigger("reconfigure")}},{key:"onTimeAxisReconfigure",value:function(e){var t=e.source,n=e.suppressRefresh;this.viewPreset!==t.viewPreset&&this.consumeViewPreset(t.viewPreset),n||this.update()}},{key:"update",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.timeAxis,o=r.headers;if(r.isConfiguring||r._availableSpace===e)n&&r.trigger("update");else{if(r._availableSpace=Math.max(e||r.availableSpace||0,0),"number"!=typeof r.availableSpace)throw new Error("Invalid available space provided to TimeAxisModel");r.columnConfig=[];var a=r._tickSize=r.calculateTickSize(r.originalTickSize);if("number"!=typeof a||a<=0)throw new Error("Invalid timeAxis tick size");r.unitToPixelsCache={},r._totalSize=null;for(var s=0,u=o.length;s<u;s++){var c=o[s];if(c.cellGenerator){var l=c.cellGenerator.call(r,i.startDate,i.endDate);r.columnConfig[s]=r.createHeaderRow(s,c,l)}else r.columnConfig[s]=r.createHeaderRow(s,c)}t||r.trigger("update")}}},{key:"getDistanceBetweenDates",value:function(e,t){return Math.round(this.getPositionFromDate(t)-this.getPositionFromDate(e))}},{key:"getDistanceForDuration",value:function(e){var t=this.timeAxis.getAt(0);return this.tickSize/(t.endDate-t.startDate)*e}},{key:"getPositionFromDate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this,r=n.getScaledTick(e,t);return-1===r?-1:Math.round(n.tickSize*(r-n.timeAxis.visibleTickStart))}},{key:"getScaledTick",value:function(e,t){var n=t.respectExclusion,r=t.snapToNextIncluded,i=t.isEnd,o=t.min,a=t.max,s=this.timeAxis,u=s.include,c=s.unit,l=s.getTickFromDate(e);if(-1!==l&&n&&u){var f=!1;if(u.hour&&Zt.compareUnits(c,"hour")>0&&"day"!==c){var d=u.hour,h=d.from,v=d.to,p=d.lengthFactor,g=d.center,y=e.getHours(),m=Math.min(Math.max(y,h),v);if(!r&&m!==y)return-1;var k=g-(g-(m+e.getMinutes()/60))*p;e=Zt.add(e,k-y,"h"),f=!0}if(u.day&&Zt.compareUnits(c,"day")>0){var b=u.day,w=b.from,C=b.to,S=b.lengthFactor,D=b.center,R=e.getDay();i&&0===e.getHours()&&0===e.getMinutes()&&0===e.getSeconds()&&0===e.getMilliseconds()&&--R<0&&(R=6);var x=0;if(R<w||R>=C){if(!r)return-1;if(x=i?(C-R-8)%7:(w-R+7)%7,e=Zt.add(e,x,"d"),e=Zt.startOf(e,"d",!1),a&&e.getTime()>=a||o&&e.getTime()<=o)return-1}var E=s.weekStartDay,T=0===e.getDay()?0:D,M=e.getDay()+e.getHours()/24,A=T-(T-M)*S;e=Zt.add(e,A-M+E,"d"),f=!0}f&&(e=Zt.constrain(e,s.startDate,s.endDate),l=s.getTickFromDate(e))}return l}},{key:"getDateFromPosition",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.timeAxis,o=r.getScaledPosition(e)/r.tickSize+i.visibleTickStart;return o<0||o>i.count?n?o<0?Zt.add(i.startDate,o,i.unit):Zt.add(i.endDate,o-i.count,i.unit):null:i.getDateFromTick(o,t)}},{key:"getScaledPosition",value:function(e){var t=this.timeAxis,n=t.include,r=t.unit,i=t.weekStartDay;if(n){var o=this.getSingleUnitInPixels("day");if(n.day&&Zt.compareUnits(r,"day")>0){var a=n.day,s=a.from,u=e%(7*o);e=u/a.lengthFactor+(s-i)*o+(e-u)}if(n.hour&&Zt.compareUnits(r,"hour")>0&&"day"!==r){var c=n.hour,l=c.from,f=e%o;e=f/c.lengthFactorExcl+l*this.getSingleUnitInPixels("hour")+(e-f)}}return e}},{key:"getSingleUnitInPixels",value:function(e){var t=this;return t.unitToPixelsCache[e]||(t.unitToPixelsCache[e]=Zt.getUnitToBaseUnitRatio(t.timeAxis.unit,e,!0)*t.tickSize/t.timeAxis.increment)}},{key:"setTickSize",value:function(e,t){this._tickSize=this.originalTickSize=e,this.update(void 0,t)}},{key:"calculateTickSize",value:function(e){var t=this,n=t.forceFit,r=t.timeAxis,i=t.suppressFit,o=r.unit,a=0,s=1;if(t.snap){var u=r.resolution;s=Zt.getUnitToBaseUnitRatio(o,u.unit)*u.increment}if(i)a=e;else{var c=r.visibleTickTimeSpan,l=Math[n?"floor":"round"](t.availableSpace/c);if(a=n||e<l?l:e,s>0&&(!n||s<1)){var f=n?"floor":"round";a=Math.round(Math.max(1,Math[f](s*a))/s)}}return a}},{key:"getDates",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.columnLinesFor,t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=[],o=t?r.lowestHeader:e,a=r.majorHeaderLevel,s=r.headers&&r.headers[e].unit,u=null!=a&&r.headers&&r.headers[a].unit,c=null!=a&&Zt.doesUnitsAlign(u,s),l=!(!r.headers||!r.headers[o].cellGenerator);if(l)for(var f=r.columnConfig[o],d=1,h=f.length;d<h;d++)i.push({date:f[d].startDate});else r.forEachInterval(o,(function(t,o){i.push({date:n?o:t,isMajor:a!==e&&c&&r.isMajorTick(n?o:t)})}));return i}},{key:"fitToAvailableSpace",value:function(e){var t=Math.floor(this.availableSpace/this.timeAxis.visibleTickTimeSpan);this.setTickSize(t,e)}},{key:"createHeaderRow",value:function(e,t,n){var r=this,i=this,o=[],a=t.align,s=Zt.clearTime(new Date),u=t.headerCellCls||"",c=function(n,c,f,d){var h=Zt.format(n,t.dateFormat),v={align:a,start:n,end:c,value:d?d.header:h,headerCellCls:u,width:r.getDistanceBetweenDates(n,c),index:f};0!==v.width&&(v.coord=l,l+=v.width,i.headersDatesCache[e][n.getTime()]=1,t.renderer&&(h=t.renderer.call(t.thisObj||i,n,c,v,f,i.eventStore),v.value=null==h?"":h),"day"!==t.unit||t.increment&&1!==t.increment||(v.headerCellCls+=" b-sch-dayheadercell-"+n.getDay(),i.calendar&&i.calendar.isWeekend(n)&&(v.headerCellCls+=" b-sch-dayheadercell-nonworking"),Zt.clearTime(n,!0)-s==0&&(v.headerCellCls+=" b-sch-dayheadercell-today")),o.push(v))},l=0;return i.headersDatesCache[e]={},n?n.forEach((function(e,t){return c(e.start,e.end,t,e)})):i.forEachInterval(e,c),o}},{key:"isMajorTick",value:function(e){var t=this.majorHeaderLevel;return null!=t&&this.headersDatesCache[t]&&this.headersDatesCache[t][e.getTime()]||!1}},{key:"forEachInterval",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:this,r=this.headers;if(r)if(e===r.length-1)this.timeAxis.forEach((function(e,r){return t.call(n,e.startDate,e.endDate,r)}));else{var i=r[e];this.timeAxis.forEachAuxInterval(i.unit,i.increment,t,n)}}},{key:"forEachMainInterval",value:function(e,t){this.forEachInterval(this.mainHeaderLevel,e,t)}},{key:"consumeViewPreset",value:function(e){var t=this;t.headers=null,t._thisIsAUsedExpression(t.tickSize),t.viewPreset=e,Object.assign(t,{headers:e.headers,columnLinesFor:e.columnLinesFor,mainHeaderLevel:e.mainHeaderLevel,_tickSize:t.isHorizontal?e.tickWidth:e.tickHeight}),t.originalTickSize=t.tickSize}},{key:"columnConfig",get:function(){return this._columnConfig},set:function(e){this._columnConfig=e}},{key:"headers",get:function(){return this._headers},set:function(e){if(e&&e.length&&e[e.length-1].cellGenerator)throw new Error("`cellGenerator` cannot be used for the bottom level of your headers. Use TimeAxis#generateTicks() instead.");this._headers=e}},{key:"isTimeAxisViewModel",get:function(){return!0}},{key:"isHorizontal",get:function(){return"vertical"!==this.mode}},{key:"isVertical",get:function(){return"vertical"===this.mode}},{key:"forceFit",set:function(e){e!==this._forceFit&&(this._forceFit=e,this.update())},get:function(){return this._forceFit}},{key:"snapPixelAmount",get:function(){if(this.snap){var e=this.timeAxis.resolution;return(e.increment||1)*this.getSingleUnitInPixels(e.unit)}return 1}},{key:"tickSize",get:function(){return this._tickSize},set:function(e){this.setTickSize(e,!1)}},{key:"timeResolution",get:function(){return this.timeAxis.resolution}},{key:"totalSize",get:function(){return this._totalSize||(this._totalSize=Math.round(this.tickSize*this.timeAxis.visibleTickTimeSpan))}},{key:"availableSpace",get:function(){return this._availableSpace},set:function(e){var t=this;if(t._availableSpace=Math.max(0,e),t._availableSpace>0){var n=t.calculateTickSize(t.originalTickSize);n>0&&n!==t.tickSize&&t.update()}}},{key:"snap",get:function(){return this._snap},set:function(e){e!==this._snap&&(this._snap=e,this.configured&&this.update())}},{key:"mainHeader",get:function(){return"mainHeaderLevel"in this?this.headers[this.mainHeaderLevel]:this.bottomHeader}},{key:"bottomHeader",get:function(){return this.headers[this.headers.length-1]}},{key:"lowestHeader",get:function(){return this.headers.length-1}},{key:"majorHeaderLevel",get:function(){var e=this.headers;return e?Math.max(e.length-2,0):null}}],[{key:"defaultConfig",get:function(){return{timeAxis:null,availableSpace:null,tickSize:100,snap:!1,forceFit:!1,headers:null,calendar:null,mode:"horizontal",suppressFit:!1,columnConfig:[],viewPreset:null,columnLinesFor:null,eventStore:null,originalTickSize:null,headersDatesCache:[]}}}]),n}(Ge());function vT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}hT._$name="TimeAxisViewModel";var pT=new Date;function gT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var yT={mousedown:"MouseDown",mouseup:"MouseUp",click:"Click",dblclick:"DblClick",contextmenu:"ContextMenu",mouseover:"MouseOver",mouseout:"MouseOut"};function mT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var kT=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t-e};function bT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}function wT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}function CT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}function ST(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}function DT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var RT=["viewPreset","eventBarTextField","eventRenderer","eventRendererThisObj","eventBodyTemplate"],xT={fn:"exitTransition",delay:0,cancelOutstanding:!0},ET=function(e){fe()(r,e);var t,n=DT(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=this,n=e.schedulerRegion||"normal",i=e.subGridConfigs,o=void 0===i?{}:i;e.subGridConfigs=o,o[n]=o[n]||{},o[n].headerClass=fT,"flex"in o[n]||"width"in o[n]||(o[n].flex=1),e.startDate&&(e.startDate=Zt.parse(e.startDate)),e.endDate&&(e.endDate=Zt.parse(e.endDate)),we()(pe()(r.prototype),"construct",this).call(this,e),t.$firstVerticalOverflow=!0,t.onSchedulerViewportResize=t.throttle(t.onSchedulerViewportResize,250),t.initDomEvents(),t.currentOrientation.init(),t.rowManager.on("refresh",(function(){t.forceLayout=!1}))}},{key:"doDestroy",value:function(){var e=this,t=this.currentOrientation;t&&t.destroy(),e.partneredWith&&(e.partneredWith.forEach((function(t){e.removePartner(t)})),e.partneredWith.destroy()),we()(pe()(r.prototype),"doDestroy",this).call(this)}},{key:"startConfigure",value:function(e){we()(pe()(r.prototype),"startConfigure",this).call(this,e),this._thisIsAUsedExpression(this.partner)}},{key:"refreshVirtualScrollbars",value:function(){if(we()(pe()(r.prototype),"refreshVirtualScrollbars",this).call(this),!this.hasVerticalOverflow){var e=this.scrollable;this.partners.some((function(e){return e.hasVerticalOverflow}))?e.overflowY="scroll":e.overflowY=!0}}},{key:"onPaint",value:function(e){var t=e.firstPaint;if(t){var n=this.timeAxisSubGrid,i=this.isVertical?this.bodyContainer.offsetHeight:n.width;this.timeAxisViewModel.update(i,!1,!0)}we()(pe()(r.prototype),"onPaint",this).call(this,Array.prototype.slice.call(arguments))}},{key:"changeSubGridConfigs",value:function(e){we()(pe()(r.prototype),"changeSubGridConfigs",this).call(this,e);var t=this,n=t.timeAxisSubGrid=t.subGrids[t.timeAxisColumn.region];n.sealedColumns=!0,n.on({resize:t.onTimeAxisSubGridResize,thisObj:t})}},{key:"onSchedulerHorizontalScroll",value:function(e,t){this.currentOrientation.updateFromHorizontalScroll(t),we()(pe()(r.prototype),"onSchedulerHorizontalScroll",this).call(this,e,t)}},{key:"initScroll",value:function(){var e=this,t=0;we()(pe()(r.prototype),"initScroll",this).call(this),j.a.isMobileSafari&&(e.scrollable.element.style.transform="translate3d(0, 0, 0)"),e.on("horizontalscroll",(function(n){var r=n.subGrid,i=n.scrollLeft;!e.isPainted||r!==e.timeAxisSubGrid||e.isDestroying||e.refreshSuspended||e.onSchedulerHorizontalScroll(r,i),t++})),"horizontal"===e.testPerformance&&e.setTimeout((function(){var n=performance.now(),r=5,i=1,o=e.setInterval((function(){if(r+=5,e.scrollLeft+=(10+Math.floor(r))*i,1===i&&e.scrollLeft>5500&&(i=-1,r=5),-1===i&&e.scrollLeft<=0){var a=1e3/((performance.now()-n)/t);a=Math.round(10*a)/10,clearInterval(o),console.log(e.eventPositionMode,e.eventScrollMode,a+"fps")}}),0)}),500)}},{key:"preserveViewCenter",value:function(e){for(var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this,n=arguments.length,r=new Array(n>2?n-2:0),i=2;i<n;i++)r[i-2]=arguments[i];var o=this,a=o.viewportCenterDate,s=e.apply(t,r),u=o.isVertical,c=u?o.scrollable:o.timeAxisSubGrid.scrollable,l=c[u?"clientHeight":"clientWidth"],f=Math.max(Math.floor(o.getCoordinateFromDate(a,!0)-l/2),0);return o.scrollingToCenter=!0,o[u?"scrollVerticallyTo":"scrollHorizontallyTo"](f,!1).then((function(){return o.scrollingToCenter=!1})),s}},{key:"noFeatureElementsInAxis",value:function(){}},{key:"removePartner",value:function(e){var t=this,n=t.partneredWith;(null==n?void 0:n.includes(e))&&(n.remove(e),e.partneredWith.remove(t),e.scrollable.removePartner(t.scrollable),e.un({presetchange:"onPartnerPresetChange",thisObj:t}),t.un({presetchange:"onPartnerPresetChange",thisObj:e}))}},{key:"onPartnerPresetChange",value:function(e){var t=e.preset,n=e.startDate,r=e.endDate,i=e.centerDate;this._viewPresetChanging||this.viewPreset===t||(t.options={startDate:n,endDate:r,centerDate:i},this.viewPreset=t)}},{key:"applyWorkingTime",value:function(e){var t,n=this,r=n._workingTime;if(r){var i=null;r.fromHour>=0&&r.fromHour<24&&r.toHour>r.fromHour&&r.toHour<=24&&r.toHour-r.fromHour<24&&(i={from:r.fromHour,to:r.toHour});var o=null;r.fromDay>=0&&r.fromDay<7&&r.toDay>r.fromDay&&r.toDay<=7&&r.toDay-r.fromDay<7&&(o={from:r.fromDay,to:r.toDay}),e.include=i||o?{hour:i,day:o}:null}else e.include=null;n.isPainted&&(n.timeAxisColumn.refreshHeader(),null===(t=n.features.columnLines)||void 0===t||t.refresh(),n.refreshWithTransition())}},{key:"setStartDate",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this,r=n._timeAxis||{},i=r.startDate,o=r.endDate,a=r.mainUnit;if("string"==typeof e&&(e=Zt.parse(e)),n._timeAxis&&o){if(e){var s=o;if(t&&i){var u=Zt.diff(i,o,a,!0);s=Zt.add(e,u,a)}r.setTimeSpan(e,s)}}else n._tempStartDate=e}},{key:"setEndDate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r=n._timeAxis||{},i=r.startDate,o=r.endDate,a=r.mainUnit;if("string"==typeof e&&(e=Zt.parse(e)),n._timeAxis&&i){if(e){var s=i;if(t&&o){var u=Zt.diff(i,o,a,!0);s=Zt.add(e,-u,a)}r.setTimeSpan(s,e)}}else n._tempEndDate=e}},{key:"onLocaleChange",value:function(){we()(pe()(r.prototype),"onLocaleChange",this).call(this),this.timeAxisColumn.refreshHeader()}},{key:"onInternalResize",value:function(e,t,n,i,o){var a=this._bodyRectangle;we()(pe()(r.prototype),"onInternalResize",this).call(this,e,t,n,i,o),!a||n===o&&t===i||this.onSchedulerViewportResize(t,n,a.width,a.height)}},{key:"onTimeAxisSubGridResize",value:function(e){var t=e.width,n=(e.height,e.oldWidth),r=(e.oldHeight,this);if(r.isPainted&&t!==n){var i=r._bodyRectangle;r.hasVerticalOverflow&&r.$firstVerticalOverflow?(r.onSchedulerViewportResize.now(t,i.height,n,i.height),r.$firstVerticalOverflow=!1):r.onSchedulerViewportResize(t,i.height,n,i.height)}}},{key:"onSchedulerViewportResize",value:function(e,t,n,r){if(this.isPainted){var i=this,o=i.timeAxisSubGrid;i.currentOrientation.onViewportResize(e,t,n,r),null!=i._lastOverflow&&i._lastOverflow!==o.overflowingHorizontally||(i.setTimeout((function(){i.timeAxisViewModel.availableSpace=i.isHorizontal?o.width:i._bodyRectangle.height}),0),i.partneredWith&&!i.isSyncingFromPartner&&i.partneredWith.forEach((function(e){e.isSyncingFromPartner||(e.isSyncingFromPartner=!0,i.eachSubGrid((function(t){var n=e.subGrids[t.region];n.width!==t.width&&(t.collapsed?n.collapse():(n.collapsed&&n.expand(),t.flex?t.flex!==n.flex&&(n.flex=t.flex):n.width=t.width))})),e.isSyncingFromPartner=!1)}))),i.trigger("timelineViewportResize",{width:e,height:t,oldWidth:n,oldHeight:r}),i._lastOverflow=o.overflowingHorizontally}}},{key:"onTimeAxisViewModelUpdate",value:function(){this.updateCanvasSize(),this.currentOrientation.onTimeAxisViewModelUpdate()}},{key:"updateCanvasSize",value:function(){var e=this,t=e.isHorizontal?e.timeAxisViewModel.totalSize:e.timeAxisColumn.width,n=!1;return e.isVertical&&e.suppressFit&&(Cr.setLength(e.foregroundCanvas,"height",e.timeAxisViewModel.totalSize),n=!0),t!==e.$canvasWidth&&(e.backgroundCanvas&&Cr.setLength(e.backgroundCanvas,"width",t),Cr.setLength(e.foregroundCanvas,"width",t),e.$canvasWidth=e.timeAxisViewModel.totalSize,n=!0),n}},{key:"getHeaderDomConfigs",value:function(e){}},{key:"getForegroundDomConfigs",value:function(e){}},{key:"refresh",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this;t.isPainted&&!t.refreshSuspended&&(t.hasVisibleEvents?t.isEngineReady?t.refreshRows(!1,e):(t.refreshAfterProjectRefresh=!0,t.currentOrientation.refreshAllWhenReady=!0):t.rowManager.trigger("refresh"))}},{key:"render",value:function(){var e=this,t=e.timeAxisSubGridElement;e.useBackgroundCanvas&&(e._backgroundCanvas=Cr.createElement({className:"b-sch-background-canvas",parent:t,nextSibling:t.firstElementChild}));var n=e._foregroundCanvas=Cr.createElement({className:"b-sch-foreground-canvas",style:"font-size:".concat(e.rowHeight-2*e.resourceMargin,"px"),parent:t});e.timeAxisSubGrid.insertRowsBefore=n,e.isVertical&&e.suppressFit&&e.updateCanvasSize(),we()(pe()(r.prototype),"render",this).apply(this,arguments)}},{key:"refreshRows",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this;n.isConfiguring||(n.currentOrientation.refreshRows(t),we()(pe()(r.prototype),"refreshRows",this).call(this,e))}},{key:"getDateConstraints",value:function(){}},{key:"runWithTransition",value:function(e,t){var n=this;n.isVisible&&(null!=t&&!0!==t||(t=n.transitionDuration),t&&n.enableEventAnimations&&(n.isAnimating=!0,xT.delay=t,n.setTimeout(xT))),e()}},{key:"exitTransition",value:function(){this.isAnimating=!1,this.trigger("transitionend")}},{key:"waitForTransition",value:(t=Wr()(Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isAnimating){e.next=2;break}return e.abrupt("return",this.await("transitionend"));case 2:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"refreshWithTransition",value:function(e,t){var n=this;this.runWithTransition((function(){return n.refresh(e)}),t)}},{key:"getVisibleDateRange",value:function(){return y.a.deprecate("scheduler","5.0.0","Deprecated in favor of `get visibleDateRange`"),this.visibleDateRange}},{key:"formatDuration",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.durationDisplayPrecision,n=Math.pow(10,t);return Math.round(e*n)/n}},{key:"hasVisibleEvents",get:function(){var e=this;return!this.noFeatureElementsInAxis()||this.eventStore.storage.values.some((function(t){return e.timeAxis.isTimeSpanInAxis(t)}))}},{key:"capitalizedEventName",get:function(){return this._capitalizedEventName||(this._capitalizedEventName=E.capitalize(this.scheduledEventName)),this._capitalizedEventName}},{key:"partner",set:function(e){var t=this,n=t.partneredWith||(t.partneredWith=new no);if(t._partner=e,!n.includes(e)){n.add(e),(e.partneredWith||(e.partneredWith=new no)).add(t),t.getConfig("viewPreset"),e.on({presetchange:"onPartnerPresetChange",thisObj:t});var r=t.partnerSharedConfigs.reduce((function(t,n){return t[n]=e[n],t}),{});t.setConfig(r),t.on({presetchange:"onPartnerPresetChange",thisObj:e}),t.initScroll=xe.createSequence(t.initScroll,(function(){t.scrollable.addPartner(e.scrollable,"x")}),t)}},get:function(){return this._partner}},{key:"partners",get:function(){var e=this.partner?[this.partner]:[];return this.partneredWith&&e.push.apply(e,this.partneredWith.all),e}},{key:"timeAxisColumn",get:function(){return this.columns&&this._timeAxisColumn}},{key:"columns",get:function(){return we()(pe()(r.prototype),"columns",this)},set:function(e){var t,n,i,o,a=this;if(e){var s=Array.isArray(e),u=e;s||(u=e.data),t=u&&u.length,u.some((function(e,r){if("timeAxis"===e.type)return t=r,n=an.assign(e,a.timeAxisColumn),!0})),a.isVertical?(a._horizontalColumns=e,u=[an.assign({type:"verticalTimeAxis",locked:!0,timeline:a},a.verticalTimeAxisColumn),u[t]],t=1):u=u.slice(),n=u[t]=Object.assign({type:"timeAxis",locked:!1,timeline:a,cellCls:a.timeCellCls,mode:a.mode},n),RT.forEach((function(e){null!=(o=a[e])&&(n[e]=o)})),s?e=u:e.data=u}sc()(pe()(r.prototype),"columns",e,this,!0),e&&(i=a._timeAxisColumn=a.columns.getAt(t),a.isVertical&&(a.verticalTimeAxisColumn=a.columns.getAt(t-1)),i.relayAll(a))}},{key:"timeView",get:function(){var e=this;return e.columns&&e.isVertical?e.verticalTimeAxisColumn&&e.verticalTimeAxisColumn.view:e.timeAxisColumn&&e.timeAxisColumn.timeAxisView}},{key:"eventCls",set:function(e){var t=this;t._eventCls=e,t.eventSelector||(t.eventSelector=".".concat(e,"-wrap"),t.unreleasedEventSelector="".concat(t.eventSelector)),t.eventInnerSelector||(t.eventInnerSelector="."+e)},get:function(){return this._eventCls}},{key:"timeAxisViewModel",set:function(e){var t=this,n={update:"onTimeAxisViewModelUpdate",prio:100,thisObj:t};t.partner&&!e||(e&&e.isTimeAxisViewModel?e.on(n):(e=Object.assign({mode:t._mode,snap:t.snap,forceFit:t.forceFit,timeAxis:t.timeAxis,suppressFit:t.suppressFit,listeners:n},e),e=new hT(e)),t._timeAxisViewModel=e)},get:function(){return this._timeAxisViewModel||(this.timeAxisViewModel=null),this._timeAxisViewModel}},{key:"suppressFit",get:function(){var e,t;return null!==(e=null===(t=this._timeAxisViewModel)||void 0===t?void 0:t.suppressFit)&&void 0!==e?e:this._suppressFit},set:function(e){this._timeAxisViewModel?this.timeAxisViewModel.suppressFit=e:this._suppressFit=e}},{key:"timeAxis",set:function(e){var t=this;t.partner&&!e||(t.detachListeners("timeAxis"),e&&e.isTimeAxis||(e=an.assign({viewPreset:t.viewPreset,autoAdjust:t.autoAdjustTimeAxis,mode:"plain",weekStartDay:t.weekStartDay},e),t.startDate&&(e.startDate=t.startDate),t.endDate&&(e.endDate=t.endDate),t.workingTime&&t.applyWorkingTime(e),e=new Vx(e)),e.on({name:"timeAxis",reconfigure:function(e){var n=e.config;t.trigger("timeAxisChange",{config:n})},thisObj:t}),t._timeAxis=e)},get:function(){return this._timeAxis||(this.timeAxis=null),this._timeAxis}},{key:"workingTime",set:function(e){this._workingTime=e,this.isConfiguring||this.applyWorkingTime(this.timeAxis)},get:function(){return this._workingTime}},{key:"startDate",set:function(e){this.setStartDate(e)},get:function(){return this._timeAxis?this._timeAxis.startDate:this._tempStartDate||new Date}},{key:"endDate",set:function(e){this.setEndDate(e)},get:function(){var e=this;return e._timeAxis?e._timeAxis.endDate:e._tempEndDate||Zt.add(e.startDate,e.viewPreset.defaultSpan,e.viewPreset.mainHeader.unit)}},{key:"features",get:function(){return we()(pe()(r.prototype),"features",this)},set:function(e){"regionResize"in(e=!0===e?{}:e)||(e.regionResize=!0),sc()(pe()(r.prototype),"features",e,this,!0)}},{key:"eventStyle",get:function(){return this._eventStyle},set:function(e){this._eventStyle=e,this.isPainted&&this.refreshWithTransition()}},{key:"eventColor",get:function(){return this._eventColor},set:function(e){this._eventColor=e,this.isPainted&&this.refreshWithTransition()}},{key:"currentOrientation",get:function(){throw new Error("Implement in subclass")}},{key:"isHorizontal",get:function(){return!0}},{key:"backgroundCanvas",get:function(){return this._backgroundCanvas}},{key:"foregroundCanvas",get:function(){return this._foregroundCanvas}},{key:"svgCanvas",get:function(){var e=this;if(!e._svgCanvas){var t=e._svgCanvas=document.createElementNS("http://www.w3.org/2000/svg","svg");t.setAttribute("id",zi.generateId("svg")),t.retainElement=!0,e.foregroundCanvas.appendChild(t),e.trigger("svgCanvasCreated")}return e._svgCanvas}},{key:"timeAxisSubGridElement",get:function(){return this.getConfig("regions"),this.timeAxisColumn&&this.timeAxisColumn.subGridElement}},{key:"visibleDateRange",get:function(){return this.currentOrientation.visibleDateRange}}],[{key:"$name",get:function(){return"TimelineBase"}},{key:"type",get:function(){return"timelinebase"}},{key:"configurable",get:function(){return{partnerSharedConfigs:{value:["viewPreset","timeAxis","timeAxisViewModel"],$config:{merge:"distinct"}}}}},{key:"defaultConfig",get:function(){return{workingTime:null,timeAxis:null,verticalTimeAxisColumn:{},timeAxisViewModel:null,autoAdjustTimeAxis:!0,startDate:null,endDate:null,snap:!1,snapRelativeToEventStartDate:!1,forceFit:!1,suppressFit:!1,eventCls:null,getDateConstraints:null,timeCellCls:null,timeCellSelector:null,scheduledEventName:null,createEventOnDblClick:!0,overScheduledEventClass:null,preventOverCls:!1,hoveredEventNode:null,useBackgroundCanvas:!1,enableEventAnimations:!j.a.isIE11,disableGridRowModelWarning:!0,animateRemovingRows:!1,partner:null,schedulerRegion:"normal",transitionDuration:200,animationTimeout:null,milestoneLayoutMode:"default",defaultRegion:"locked",durationDisplayPrecision:1,asyncEventSuffix:"PreCommit"}}}]),r}(Cy.mixin((function(e){return function(e){fe()(n,e);var t=vT(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"getDateFromCoordinate",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return n||(e=this.currentOrientation.translateToScheduleCoordinate(e)),this.timeAxisViewModel.getDateFromPosition(e,t,r)}},{key:"getDateFromXY",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return this.currentOrientation.getDateFromXY(e,t,n,r)}},{key:"getDateFromDomEvent",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.getDateFromXY([e.pageX,e.pageY],t,!1,n)}},{key:"getStartEndDatesFromRectangle",value:function(e,t,n){var r,i,o=arguments.length>3&&void 0!==arguments[3]&&arguments[3],a=this,s=a.isHorizontal,u=s?a.timeAxisSubGrid.width:a.timeAxisSubGrid.height,c=s?e.x:e.top,l=s?e.right:e.bottom;return c>=0&&l<u?(r=a.getDateFromCoordinate(c,null,!0),i=a.getDateFromCoordinate(l,null,!0)):c<0?r=(i=a.getDateFromCoordinate(l,t,!0,o))&&Zt.add(i,-n,"ms"):i=(r=a.getDateFromCoordinate(c,t,!0,o))&&Zt.add(r,n,"ms"),{start:r,end:i}}},{key:"getFormattedDate",value:function(e){return Zt.format(e,this.displayDateFormat)}},{key:"getDisplayEndDate",value:function(e,t){return 0!==e.getHours()||0!==e.getMinutes()||t&&e.getYear()===t.getYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()||Zt.formatContainsHourInfo(this.displayDateFormat)||(e=Zt.add(e,-1,"day")),e}},{key:"getFormattedEndDate",value:function(e,t){return this.getFormattedDate(this.getDisplayEndDate(e,t))}},{key:"getCoordinateFromDate",value:function(e){var t,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this,i=r.timeAxisViewModel,o=r.timeAxis,a=o.isContinuous,s=o.startMS,u=o.endMS,c=o.startDate,l=o.unit,f=e.valueOf();if(!0===n?n={local:!0}:n?"local"in n||(n.local=!0):n={local:!1},e instanceof Date||(pT.setTime(e),e=pT),a&&e.getTimezoneOffset()===c.getTimezoneOffset()&&-1!==Zt.getUnitToBaseUnitRatio(l,"day")){if(f<s||f>u)return-1;t=Math.round((f-s)/(u-s)*i.totalSize)}else t=i.getPositionFromDate(e,n);return n.local||(t=r.currentOrientation.translateToPageCoordinate(t)),t}},{key:"getTimeSpanDistance",value:function(e,t){return this.timeAxisViewModel.getDistanceBetweenDates(e,t)}},{key:"onSchedulerHorizontalScroll",value:function(e){e.subGrid,e.scrollLeft;this.scrollingToCenter||(this.cachedCenterDate=null)}},{key:"displayDateFormat",get:function(){return this._displayDateFormat},set:function(e){this._displayDateFormat=e,this.trigger("displayDateFormatChange",{format:e})}},{key:"viewportCenterDate",get:function(){var e=this,t=e.isHorizontal,n=e.timeAxis,r=t?e.timeAxisSubGrid.scrollable:e.scrollable,i=r.x+r.clientWidth/2,o=r.y+r.clientHeight/2;if(n.isContinuous){var a=t?i/r.scrollWidth:o/r.scrollHeight,s=n.startMS+(n.endMS-n.startMS)*a;return new Date(s)}var u=t?[i,0]:[0,o];return e.getDateFromXY(u,null,!0)}},{key:"viewportCenterDateCached",get:function(){return this.cachedCenterDate||(this.cachedCenterDate=this.viewportCenterDate)}},{key:"timeResolution",get:function(){return this.timeAxis.resolution},set:function(e){this.timeAxis.resolution="number"==typeof e?{increment:e,unit:this.timeAxis.resolution.unit}:e}},{key:"snap",set:function(e){this.isConfiguring?this._snap=e:this.timeAxisViewModel.snap=e},get:function(){return this.isConfiguring?this._snap:this.timeAxisViewModel.snap}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"TimelineDateMapper"}}]),n}(e||ue)}),(function(e){return function(e){fe()(n,e);var t=gT(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"initDomEvents",value:function(){var e=this;e.scheduledBarEvents.element=e.schedulerEvents.element=e.timeAxisSubGridElement,e.scheduledBarEvents.thisObj=e.schedulerEvents.thisObj=e,nu.on(e.scheduledBarEvents),nu.on(e.schedulerEvents)}},{key:"getTimeSpanMouseEventParams",value:function(e,t){throw new Error("Implement in subclass")}},{key:"getScheduleMouseEventParams",value:function(e,t){throw new Error("Implement in subclass")}},{key:"handleScheduledBarEvent",value:function(e){var t=Cr.up(e.target,this.eventInnerSelector),n=yT[e.type]||E.capitalize(e.type);t&&this.trigger(this.scheduledEventName+n,this.getTimeSpanMouseEventParams(t,e))}},{key:"handleScheduleEvent",value:function(e){var t=this,n=!Cr.up(e.target,t.eventSelector)&&Cr.up(e.target,"."+t.timeCellCls),r=yT[e.type]||E.capitalize(e.type);if(n){var i=t.getDateFromDomEvent(e,"floor");if(!i)return;var o=qo.get(n),a=o.row.dataIndex,s=t.timeAxis.getTickFromDate(i),u=t.timeAxis.getAt(Math.floor(s));u&&t.trigger("schedule"+r,Object.assign({date:i,tickStartDate:u.startDate,tickEndDate:u.endDate,row:o.row,index:a,event:e},t.getScheduleMouseEventParams(o,e)))}}},{key:"onElementMouseOver",value:function(e){we()(pe()(n.prototype),"onElementMouseOver",this).call(this,e);var t=this,r=e.target;if(r.closest(t.eventInnerSelector)){var i=r.closest(t.eventSelector);if(i.classList.add(t.overScheduledEventClass),i!==t.hoveredEventNode&&!t.preventOverCls){t.hoveredEventNode=i;var o=t.getTimeSpanMouseEventParams(i,e);o&&t.trigger(t.scheduledEventName+"MouseEnter",o)}}else t.hoveredEventNode=null}},{key:"onElementMouseOut",value:function(e){we()(pe()(n.prototype),"onElementMouseOut",this).call(this,e);var t=this;if(e.target.closest(t.eventInnerSelector)&&t.resolveTimeSpanRecord(e.target)&&t.hoveredEventNode){if(e.relatedTarget&&Cr.isDescendant(e.target.closest(t.eventInnerSelector),e.relatedTarget))return;t.unhover(e)}}},{key:"unhover",value:function(e){var t=this,n=t.hoveredEventNode;n&&(n.classList.remove(t.overScheduledEventClass),t.trigger(t.scheduledEventName+"MouseLeave",t.getTimeSpanMouseEventParams(n,e)),t.hoveredEventNode=null)}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"TimelineDomEvents"}},{key:"defaultConfig",get:function(){return{scheduledBarEvents:{mousedown:"handleScheduledBarEvent",mouseup:"handleScheduledBarEvent",click:"handleScheduledBarEvent",dblclick:"handleScheduledBarEvent",contextmenu:"handleScheduledBarEvent",mouseover:"handleScheduledBarEvent",mouseout:"handleScheduledBarEvent"},schedulerEvents:{click:"handleScheduleEvent",dblclick:"handleScheduleEvent",contextmenu:"handleScheduleEvent",mousemove:"handleScheduleEvent"}}}}]),n}(e||ue)}),(function(e){return function(e){fe()(n,e);var t=CT(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"barMargin",get:function(){return this._barMargin},set:function(e){var t=this;an.assertNumber(e,"barMargin"),t.isHorizontal&&t.rowHeight&&(e=Math.min(Math.ceil(t.rowHeight/2),e)),t._barMargin!==e&&(t._barMargin=e,t.rendered&&(t.currentOrientation.onBeforeRowHeightChange(),t.refreshWithTransition()))}},{key:"resourceMargin",get:function(){return null==this._resourceMargin?this.barMargin:this._resourceMargin},set:function(e){var t=this;an.assertNumber(e,"resourceMargin"),t.isHorizontal&&t.rowHeight&&(e=Math.min(Math.ceil(t.rowHeight/2),e)),t._resourceMargin!==e&&(t._resourceMargin=e,t.rendered&&(t.currentOrientation.onBeforeRowHeightChange(),t.refreshWithTransition()))}},{key:"tickSize",set:function(e){an.assertNumber(e,"tickSize"),this.timeAxisViewModel.tickSize=e},get:function(){return this.timeAxisViewModel.tickSize}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"TimelineEventRendering"}},{key:"defaultConfig",get:function(){return{barMargin:10,resourceMargin:null,managedEventSizing:!0,generatedIdCls:"b-sch-dirty-new",dirtyCls:"b-sch-dirty",committingCls:"b-sch-committing",endsOutsideViewCls:"b-sch-event-endsoutside",startsOutsideViewCls:"b-sch-event-startsoutside",fixedEventCls:"b-sch-event-fixed",eventStyle:"plain",eventColor:"green"}}},{key:"eventColors",get:function(){return["red","pink","purple","violet","indigo","blue","cyan","teal","green","lime","yellow","orange","deep-orange","gray"]}},{key:"eventStyles",get:function(){return["plain","border","hollow","colored","line","dashed","minimal","rounded"]}}]),n}(e||ue)}),(function(e){return function(e){fe()(r,e);var t,n=ST(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"scrollToDate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this,r=n.timeAxisSubGrid.scrollable,i=r.viewport,o=n.getCoordinateFromDate(e,!0),a=n.isHorizontal?new En(n.getCoordinateFromDate(e,!1),i.y,n.timeAxisViewModel.tickSize,i.height):new En(i.x,n.getCoordinateFromDate(e,!1),i.width,n.timeAxisViewModel.tickSize);return n.scrollToCoordinate(o,a,e,t)}},{key:"scrollToNow",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.scrollToDate(new Date,e)}},{key:"scrollToCoordinate",value:(t=Wr()(Vr.a.mark((function e(t,n,r){var i,o,a,s,u,c,l,f,d=arguments;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(i=d.length>3&&void 0!==d[3]?d[3]:{},o=this,!(t<0)){e.next=8;break}if(a=(o.timeAxis.endDate-o.timeAxis.startDate)/2,s=o.timeAxis,u=s.unit,c=s.increment,l=Zt.snap("floor",new Date(r.getTime()-a),c+" "+u),f=Zt.snap("ceil",new Date(r.getTime()+a),c+" "+u),l-o.startDate==0||f-o.endDate==0){e.next=7;break}return o.setTimeSpan(l,f),e.abrupt("return",o.scrollToDate(r,i));case 7:return e.abrupt("return");case 8:return e.next=10,o.timeAxisSubGrid.scrollable.scrollIntoView(n,i);case 10:return e.abrupt("return",o.nextAnimationFrame());case 11:case"end":return e.stop()}}),e,this)}))),function(e,n,r){return t.apply(this,arguments)})},{key:"scrollHorizontallyTo",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.timeAxisSubGrid.scrollable.scrollTo(e,null,t)}},{key:"scrollVerticallyTo",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.scrollable.scrollTo(null,e,t)}},{key:"scrollTo",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.timeAxisSubGrid.scrollable.scrollTo(e,null,t)}},{key:"scrollLeft",set:function(e){this.timeAxisSubGrid.scrollable.x=e},get:function(){return this.timeAxisSubGrid.scrollable.x}},{key:"scrollTop",set:function(e){this.scrollable.y=e},get:function(){return this.scrollable.y}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"TimelineScroll"}}]),r}(e||ue)}),(function(e){return function(e){fe()(n,e);var t=mT(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"normalizePreset",value:function(e){var t=e,n=this.presets;if(!(e instanceof jx)){if("object"===l()(e)){if(e.base){var r=n.getById(e.base)||$x.getById(e.base);if(!r)throw new Error("ViewPreset base '".concat(e.base,"' does not exist"));e=an.merge(an.clone(r.data),$x.createRecord(e).data)}e.id?e=n.createRecord(e):(e=n.createRecord(an.assign({},e))).id=e.generateId(n)}else e="number"==typeof e?n.getAt(e):n.getById(e)||$x.getById(e);if(!e)throw new Error("Invalid ViewPreset requested: ".concat(t))}return n.add(e)[0]}},{key:"changeViewPreset",value:function(e,t){var n=this;if(!(e instanceof jx)&&e.name&&!e.base)throw new Error("ViewPreset name config replaced by base config. See https://www.bryntum.com/docs/scheduler/#guides/upgrades/3.0.0.md");e=n.normalizePreset(e);var r=n.lastViewPresetOptions||{},i=e.options||(e.options={}),o=i.event={startDate:i.startDate,endDate:i.endDate,from:t,to:e,preset:e},a=!n._viewPreset||!n._viewPreset.equals(e),s=kT(i.startDate,r.startDate)||kT(i.endDate,r.endDate)||kT(i.centerDate,r.centerDate)||i.startDate&&kT(i.startDate,n.startDate)||i.endDate&&kT(i.endDate,n.endDate);if((a||s)&&(a||(n._viewPreset=null),n.isConfiguring||!1!==n.trigger("beforePresetChange",o)))return e}},{key:"updateViewPreset",value:function(e){var t=this,n=e.options,r=n.event,i=n.startDate,o=n.endDate,a=t.isHorizontal,s=t._timeAxis,u=n.centerDate;if(t._viewPresetChanging=!0,t.displayDateFormat=t.config.displayDateFormat||e.displayDateFormat,s){if(t.lastViewPresetOptions=n,s.isConfigured){t.suspendRefresh();var c={weekStartDay:t.weekStartDay,startTime:t.startTime,endTime:t.endTime};i?(c.startDate=i,c.endDate=o,!u&&o&&(u=new Date((i.getTime()+o.getTime())/2))):(c.startDate=s.startDate,c.endDate=o||s.endDate,u||(u=t.viewportCenterDate)),s.isConfigured=!1,s.viewPreset=e,s.reconfigure(c,!0),t.timeAxisViewModel.reconfigure({viewPreset:t.viewPreset,headers:e.headers,columnLinesFor:null!=e.columnLinesFor?e.columnLinesFor:e.headers.length-1,tickSize:a?e.tickWidth:e.tickHeight||e.tickWidth||60}),t.resumeRefresh()}if(t.refresh(),!n.notScroll&&t.isPainted)if(u){t.cachedCenterDate=u,r.centerDate=u;var l=t.isHorizontal?t.timeAxisSubGrid.width:t.timeAxisSubGrid.height,f=Math.max(Math.floor(t.getCoordinateFromDate(u,!0)-l/2),0);t.viewPresetActiveScroll=t.isHorizontal?{left:f}:{top:f},t.scrollingToCenter=!0,t.isHorizontal?t.scrollHorizontallyTo(f,!1):t.scrollVerticallyTo(f,!1),t.setTimeout((function(){t.scrollingToCenter=!1}),100)}else t.isHorizontal?t.scrollHorizontallyTo(0,!1):t.scrollVerticallyTo(0,!1)}t.trigger("presetChange",r),t._viewPresetChanging=!1}},{key:"presets",set:function(e){!0===e&&(e=$x.allRecords),this._presets=new Bx({data:e})},get:function(){return this._presets}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"TimelineViewPresets"}},{key:"configurable",get:function(){return{viewPreset:"weekAndDayLetter"}}},{key:"defaultConfig",get:function(){return{displayDateFormat:null,presets:!0}}}]),n}(e||ue)}),(function(e){return function(e){fe()(n,e);var t=bT(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e){var t=this;we()(pe()(n.prototype),"construct",this).call(this,e),t.zoomOnMouseWheel&&nu.on({element:t.timeAxisSubGridElement,wheel:"onWheel",throttled:{buffer:100,alt:function(e){e.ctrlKey&&e.preventDefault()}},thisObj:t,capture:!0,passive:!1}),t.zoomOnTimeAxisDoubleClick&&t.on("timeaxisheaderdblclick",(function(e){var n=e.startDate,r=e.endDate;t.isVertical||t.zoomToSpan({startDate:n,endDate:r})}))}},{key:"getMilliSecondsPerPixelForZoomLevel",value:function(e,t){var n=e.bottomHeader,r=this.isHorizontal?e.tickWidth:e.tickHeight;return Math.round((Zt.add(new Date(1,0,1),n.increment||1,n.unit)-new Date(1,0,1))/(t?r:e.actualWidth||r))}},{key:"zoomTo",value:function(e){"object"===l()(e)?e.preset?this.zoomToLevel(e.preset,e):null!=e.level?this.zoomToLevel(e.level,e):this.zoomToSpan(e):this.zoomToLevel(e)}},{key:"zoomToLevel",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};"number"==typeof e&&(e=Math.min(Math.max(e,this.minZoomLevel),this.maxZoomLevel));var n=this,r=n.isVertical?"tickHeight":"tickWidth",i=n.normalizePreset(e),o=i[r],a=t.startDate?new Date(t.startDate):null,s=t.endDate?new Date(t.endDate):null,u=a&&s?{startDate:a,endDate:s}:null,c=t.centerDate||(u?new Date((a.getTime()+s.getTime())/2):n.viewportCenterDateCached),l=n.timeAxisSubGrid.width;if(0===l)return null;u||(u=n.calculateOptimalDateRange(c,l,i)),"width"in t&&i.setData(r,t.width),n.isZooming=!0,i.options={startDate:u.startDate||n.startDate,endDate:u.endDate||n.endDate,centerDate:c},n.viewPreset=i,i.actualWidth=n.timeAxisViewModel.tickSize,n.isZooming=!1,i.setData(r,o)}},{key:"zoomToFit",value:function(e){var t=this.eventStore.getTotalTimeSpan();(e=Object.assign({leftMargin:0,rightMargin:0},e,t)).startDate&&e.endDate&&this.zoomToSpan(e)}},{key:"zoomToSpan",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if((e.leftMargin||e.rightMargin)&&(e.adjustStart=0,e.adjustEnd=0),e.leftMargin||(e.leftMargin=0),e.rightMargin||(e.rightMargin=0),!e.startDate||!e.endDate)throw new Error("zoomToSpan: must provide startDate + endDate dates");var t=this,n=e.adjustStart>=0||e.adjustEnd>=0,r=e.startDate,i=e.endDate;if(n&&(r=Zt.add(r,-e.adjustStart,t.timeAxis.mainUnit),i=Zt.add(i,e.adjustEnd,t.timeAxis.mainUnit)),r<=i){var o,a,s=t.timeAxisViewModel.availableSpace,u=t.presets.allRecords,c=i-r||1,l=t.zoomLevel;-1===l&&(l=0);for(var f,d=t.getMilliSecondsPerPixelForZoomLevel(u[l],!0),h=l+(o=c/d+e.leftMargin+e.rightMargin>s?-1:1),v=null;h>=0&&h<=u.length-1;){f=u[h];var p=c/(d=t.getMilliSecondsPerPixelForZoomLevel(f,!0))+e.leftMargin+e.rightMargin;if(-1===o){if(p<=s){v=h;break}}else{if(!(p<=s))break;l!==h-o&&(v=h)}h+=o}var g=(f=u[v=null!=v?v:h-o]).bottomHeader.unit;(e.leftMargin||e.rightMargin)&&(r=new Date(r.getTime()-d*e.leftMargin),i=new Date(i.getTime()+d*e.rightMargin));var y=Zt.getDurationInUnit(r,i,g,!0)/f.bottomHeader.increment;if(0===y)return null;var m=Math.floor(s/y),k=e.centerDate||new Date((r.getTime()+i.getTime())/2);return a=n?{startDate:r,endDate:i}:t.calculateOptimalDateRange(k,s,f),t.zoomToLevel(v,Object.assign(a,{width:m,centerDate:k}))}return null}},{key:"zoomIn",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this.zoomLevel;return t>=this.maxZoomLevel?null:this.zoomToLevel(t+e)}},{key:"zoomOut",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,t=this.zoomLevel;return t<=this.minZoomLevel?null:this.zoomToLevel(t-e)}},{key:"zoomInFull",value:function(){return this.zoomToLevel(this.maxZoomLevel)}},{key:"zoomOutFull",value:function(){return this.zoomToLevel(this.minZoomLevel)}},{key:"calculateOptimalDateRange",value:function(e,t,n,r){if(r)return r;var i=this.timeAxis,o=n.bottomHeader,a=this.isHorizontal?n.tickWidth:n.tickHeight;if(this.zoomKeepsOriginalTimespan)return{startDate:i.startDate,endDate:i.endDate};var s=o.unit,u=Math.ceil(t/a*o.increment*this.visibleZoomFactor/2),c=Zt.add(e,-u,s),l=Zt.add(e,u,s);return{startDate:i.floorDate(c,!1,s,o.increment),endDate:i.ceilDate(l,!1,s,o.increment)}}},{key:"onWheel",value:function(e){var t=this;e.ctrlKey&&(e.preventDefault(),t.preventScrollZoom||(e.deltaY>0?t.zoomOut():e.deltaY<0&&t.zoomIn(),t.preventScrollZoom=!0,t.setTimeout((function(){return t.preventScrollZoom=!1}),30)))}},{key:"setTimeSpan",value:function(e,t){this.timeAxis.setTimeSpan(e,t)}},{key:"shift",value:function(e,t){this.timeAxis.shift(e,t)}},{key:"shiftNext",value:function(e){this.timeAxis.shiftNext(e)}},{key:"shiftPrevious",value:function(e){this.timeAxis.shiftPrevious(e)}},{key:"maxZoomLevel",get:function(){return this._maxZoomLevel||this.presets.count-1},set:function(e){if("number"!=typeof e&&(e=this.presets.count-1),e<0||e>=this.presets.count)throw new Error("Invalid range for `maxZoomLevel`");this._maxZoomLevel=e}},{key:"minZoomLevel",get:function(){return this._minZoomLevel||0},set:function(e){if("number"!=typeof e&&(e=0),e<0||e>=this.presets.count)throw new Error("Invalid range for `minZoomLevel`");this._minZoomLevel=e}},{key:"zoomLevel",get:function(){return this.presets.indexOf(this.viewPreset)},set:function(e){this.zoomToLevel(e)}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"TimelineZoomable"}},{key:"defaultConfig",get:function(){return{zoomOnMouseWheel:!0,zoomOnTimeAxisDoubleClick:!0,preventScrollZoom:null,minZoomLevel:null,maxZoomLevel:null,visibleZoomFactor:5,zoomKeepsOriginalTimespan:null}}}]),n}(e||ue)}),(function(e){return function(e){fe()(n,e);var t=wT(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e){we()(pe()(n.prototype),"construct",this).call(this,e),this.on({beforeeventdropfinalize:"onBeforeEventDropFinalize",beforeeventresizefinalize:"onBeforeEventResizeFinalize",beforeEventDelete:"onRecurrableEventBeforeDelete",beforeAssignmentDelete:"onRecurrableAssignmentBeforeDelete",thisObj:this})}},{key:"changeRecurrenceConfirmationPopup",value:function(e,t){var n=this.constructor.reconfigure(t,e,"recurrenceconfirmation");return n.owner=this,n}},{key:"showDisplayConfirmationOnEventDelete",value:function(e){var t=this.features.eventEdit;return e.supportsRecurring&&(e.isRecurring||e.isOccurrence)&&(!t||!t.isEditing||t.eventRecord!==e)}},{key:"onRecurrableEventBeforeDelete",value:function(e){var t=e.eventRecords,n=e.context,r=ye()(t,1)[0];if(this.enableRecurringEvents&&this.showDisplayConfirmationOnEventDelete(r))return this.recurrenceConfirmationPopup.confirm({actionType:"delete",eventRecord:r,changerFn:function(){n.finalize(!0)},cancelFn:function(){n.finalize(!1)}}),!1}},{key:"onRecurrableAssignmentBeforeDelete",value:function(e){var t=e.assignmentRecords,n=e.context,r=t[0].event;if(this.enableRecurringEvents&&this.showDisplayConfirmationOnEventDelete(r))return this.recurrenceConfirmationPopup.confirm({actionType:"delete",eventRecord:r,changerFn:function(){n.finalize(!0)},cancelFn:function(){n.finalize(!1)}}),!1}},{key:"onBeforeEventDropFinalize",value:function(e){var t=e.context;if(this.enableRecurringEvents){var n=t.eventRecords.filter((function(e){return e.supportsRecurring&&(e.isRecurring||e.isOccurrence)}));n.length&&(t.async=!0,this.recurrenceConfirmationPopup.confirm({actionType:"update",eventRecord:n[0],changerFn:function(){t.finalize(!0)},cancelFn:function(){t.finalize(!1)}}))}}},{key:"onBeforeEventResizeFinalize",value:function(e){var t=e.context;if(this.enableRecurringEvents){var n=t.eventRecord;n.supportsRecurring&&(n.isRecurring||n.isOccurrence)&&(t.async=!0,this.recurrenceConfirmationPopup.confirm({actionType:"update",eventRecord:n,changerFn:function(){t.finalize(!0)},cancelFn:function(){t.finalize(!1)}}))}}},{key:"getOccurrencesFor",value:function(e){return this.eventStore.getOccurrencesForTimeSpan(e,this.timeAxis.startDate,this.timeAxis.endDate)}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"RecurringEvents"}},{key:"configurable",get:function(){return{enableRecurringEvents:!1,recurrenceConfirmationPopup:{$config:["lazy"],value:{type:"recurrenceconfirmation"}}}}}]),n}(e||ue)})));ET.initClass(),y.a.setVersion("scheduler","4.0.2"),ET._$name="TimelineBase";var TT=tt.mergeLocales(py,{ResourceInfoColumn:{eventCountText:function(e){return e+" event"+(1!==e?"s":"")}},Dependencies:{from:"From",to:"To",valid:"Valid",invalid:"Invalid"},DependencyType:{SS:"SS",SF:"SF",FS:"FS",FF:"FF",StartToStart:"Start-to-Start",StartToEnd:"Start-to-End",EndToStart:"End-to-Start",EndToEnd:"End-to-End",short:["SS","SF","FS","FF"],long:["Start-to-Start","Start-to-End","End-to-Start","End-to-End"]},DependencyEdit:{From:"From",To:"To",Type:"Type",Lag:"Lag","Edit dependency":"Edit dependency",Save:"Save",Delete:"Delete",Cancel:"Cancel",StartToStart:"Start to Start",StartToEnd:"Start to End",EndToStart:"End to Start",EndToEnd:"End to End"},EventEdit:{Name:"Name",Resource:"Resource",Start:"Start",End:"End",Save:"Save",Delete:"Delete",Cancel:"Cancel","Edit event":"Edit event",Repeat:"Repeat"},EventDrag:{eventOverlapsExisting:"Event overlaps existing event for this resource",noDropOutsideTimeline:"Event may not be dropped completely outside the timeline"},SchedulerBase:{"Add event":"Add event","Delete event":"Delete event","Unassign event":"Unassign event"},HeaderContextMenu:{pickZoomLevel:"Zoom",activeDateRange:"Date range",startText:"Start date",endText:"End date",todayText:"Today"},TimeAxisHeaderMenu:{pickZoomLevel:"Zoom",activeDateRange:"Date range",startText:"Start date",endText:"End date",todayText:"Today"},EventFilter:{filterEvents:"Filter tasks",byName:"By name"},TimeRanges:{showCurrentTimeLine:"Show current timeline"},PresetManager:{secondAndMinute:{displayDateFormat:"ll LTS"},minuteAndHour:{topDateFormat:"ddd MM/DD, hA",displayDateFormat:"ll LST"},hourAndDay:{topDateFormat:"ddd MM/DD",middleDateFormat:"LST",displayDateFormat:"ll LST"},weekAndDay:{displayDateFormat:"ll LST"},dayAndWeek:{displayDateFormat:"ll LST"}},RecurrenceConfirmationPopup:{"delete-title":"You are deleting an event","delete-all-message":"Do you want to delete all occurrences of this event?","delete-further-message":"Do you want to delete this and all future occurrences of this event, or only the selected occurrence?","delete-further-btn-text":"Delete All Future Events","delete-only-this-btn-text":"Delete Only This Event","update-title":"You are changing a repeating event","update-all-message":"Do you want to change all occurrences of this event?","update-further-message":"Do you want to change only this occurrence of the event, or this and all future occurrences?","update-further-btn-text":"All Future Events","update-only-this-btn-text":"Only This Event",Yes:"Yes",Cancel:"Cancel",width:600},RecurrenceLegend:{" and ":" and ",Daily:"Daily","Weekly on {1}":function(e){var t=e.days;return"Weekly on ".concat(t)},"Monthly on {1}":function(e){var t=e.days;return"Monthly on ".concat(t)},"Yearly on {1} of {2}":function(e){var t=e.days,n=e.months;return"Yearly on ".concat(t," of ").concat(n)},"Every {0} days":function(e){var t=e.interval;return"Every ".concat(t," days")},"Every {0} weeks on {1}":function(e){var t=e.interval,n=e.days;return"Every ".concat(t," weeks on ").concat(n)},"Every {0} months on {1}":function(e){var t=e.interval,n=e.days;return"Every ".concat(t," months on ").concat(n)},"Every {0} years on {1} of {2}":function(e){var t=e.interval,n=e.days,r=e.months;return"Every ".concat(t," years on ").concat(n," of ").concat(r)},position1:"the first",position2:"the second",position3:"the third",position4:"the fourth",position5:"the fifth","position-1":"the last",day:"day",weekday:"weekday","weekend day":"weekend day",daysFormat:function(e){var t=e.position,n=e.days;return"".concat(t," ").concat(n)}},RecurrenceEditor:{"Repeat event":"Repeat event",Cancel:"Cancel",Save:"Save",Frequency:"Frequency",Every:"Every",DAILYintervalUnit:"day(s)",WEEKLYintervalUnit:"week(s)",MONTHLYintervalUnit:"month(s)",YEARLYintervalUnit:"year(s)",Each:"Each","On the":"On the","End repeat":"End repeat","time(s)":"time(s)"},RecurrenceDaysCombo:{day:"day",weekday:"weekday","weekend day":"weekend day"},RecurrencePositionsCombo:{position1:"first",position2:"second",position3:"third",position4:"fourth",position5:"fifth","position-1":"last"},RecurrenceStopConditionCombo:{Never:"Never",After:"After","On date":"On date"},RecurrenceFrequencyCombo:{Daily:"Daily",Weekly:"Weekly",Monthly:"Monthly",Yearly:"Yearly"},RecurrenceCombo:{None:"None",Custom:"Custom..."},Summary:{"Summary for":function(e){return"Summary for ".concat(e)}},ScheduleRangeCombo:{completeview:"Complete schedule",currentview:"Visible schedule",daterange:"Date range",completedata:"Complete schedule (for all events)"},SchedulerExportDialog:{"Schedule range":"Schedule range","Export from":"From","Export to":"To"},ExcelExporter:{"No resource assigned":"No resource assigned"},CrudManagerView:{serverResponseLabel:"Server response:"}}),MT=TT;function AT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}rt.registerLocale("En",{desc:"English",locale:TT});function PT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}function IT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}function OT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var FT=function(e){fe()(n,e);var t=OT(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"clearCache",value:function(e){e?delete this.nbrOfBandsByResource[e.id]:this.nbrOfBandsByResource={}}},{key:"getNumberOfBands",value:function(e,t){var n=this.nbrOfBandsByResource;if(n.hasOwnProperty(e.id))return n[e.id];var r=("function"==typeof t?t():t).map((function(e){return{start:e.startDate,end:e.endDate,event:e}}));return this.applyLayout(r,e)}},{key:"applyLayout",value:function(e,t){var n=e.slice(),r=this.layoutEventsInBands(n);return this.nbrOfBandsByResource[t.id]=r}}],[{key:"defaultConfig",get:function(){return{nbrOfBandsByResource:{},bandIndexToPxConvertFn:null,bandIndexToPxConvertThisObj:null}}}]),n}(ue);function LT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}FT._$name="HorizontalLayout";var jT=function(e){fe()(n,e);var t=LT(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"layoutEventsInBands",value:function(e){var t=0;do{for(var n=0,r=e[0];r;)r.top=this.bandIndexToPxConvertFn.call(this.bandIndexToPxConvertThisObj||this,t,r.eventRecord),e.splice(n,1),r=e[n=this.findClosestSuccessor(r,e)];t++}while(e.length>0);return t}},{key:"findClosestSuccessor",value:function(e,t){for(var n,r,i,o=e.endMS,a=e.eventRecord&&0===e.eventRecord.duration,s=1/0,u=0,c=t.length;u<c;u++)(r=(i=t[u]).startMS-o)>=0&&r<s&&(r>0||i.endMS-i.startMS>0||!a)&&(n=u,s=r);return n}}]),n}(FT);function _T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}jT._$name="HorizontalLayoutStack";var BT=function(e){return function(e){fe()(n,e);var t=_T(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"applyLayout",value:function(e,t){for(var n,r,i,o,a=this,s=a.coordProp,u=a.sizeProp,c=0,l=e.length;c<l;c++){if(r=e[c],n=a.findStartSlot(e,r),(i=a.getCluster(e,c)).length>1){for(r[s]=n.start,r[u]=n.end-n.start,o=1;o<i.length-1&&i[o+1].start-r.start==0;)o++;var f=a.findStartSlot(e,i[o]);f&&f.start<.8&&(i.length=o)}var d=i.length,h=(n.end-n.start)/d;for(o=0;o<d;o++)t(i[o],o,n,h);c+=d-1}}},{key:"findStartSlot",value:function(e,t){var n,r=this.sizeProp,i=this.coordProp,o=this.getPriorOverlappingEvents(e,t);if(0===o.length)return{start:0,end:1};for(n=0;n<o.length;n++){if(0===n&&o[0][i]>0)return{start:0,end:o[0][i]};if(o[n][i]+o[n][r]<(n<o.length-1?o[n+1][i]:1))return{start:o[n][i]+o[n][r],end:n<o.length-1?o[n+1][i]:1}}return!1}},{key:"getPriorOverlappingEvents",value:function(e,t){for(var n=t.start,r=t.end,i=[],o=0,a=e.indexOf(t);o<a;o++)Zt.intersectSpans(n,r,e[o].start,e[o].end)&&i.push(e[o]);return i.sort(this.sortOverlappers.bind(this)),i}},{key:"sortOverlappers",value:function(e,t){return e[this.coordProp]<t[this.coordProp]?-1:1}},{key:"getCluster",value:function(e,t){var n=e[t];if(t>=e.length-1)return[n];for(var r=[n],i=e.length,o=n.start,a=n.end,s=t+1;s<i&&Zt.intersectSpans(o,a,e[s].start,e[s].end);)r.push(e[s]),o=Zt.max(o,e[s].start),a=Zt.min(e[s].end,a),s++;return r}}],[{key:"$name",get:function(){return"PackMixin"}},{key:"defaultConfig",get:function(){return{coordProp:"top",sizeProp:"height"}}}]),n}(e||ue)};function HT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var $T=function(e){fe()(n,e);var t=HT(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"applyLayout",value:function(e){var t=this;we()(pe()(n.prototype),"applyLayout",this).call(this,e,(function(e,t,n,r){e.height=r,e.top=n.start+t*r})),e.forEach((function(e){Object.assign(e,t.bandIndexToPxConvertFn.call(t.bandIndexToPxConvertThisObj||t,e.top,e.height,null,e.eventRecord))}))}}]),n}(BT(FT));function NT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}$T._$name="HorizontalLayoutPack";function VT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var zT=function(e){return function(e){fe()(n,e);var t=VT(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(){we()(pe()(n.prototype),"construct",this).apply(this,arguments);var e=this;e.timeRangeStore||(e.timeRangeStore=new e.timeRangeStoreClass({modelClass:e.timeRangeModelClass,storeId:"timeRanges"})),e.resourceTimeRangeStore||(e.resourceTimeRangeStore=new e.resourceTimeRangeStoreClass({modelClass:e.resourceTimeRangeModelClass})),e.resourceTimeRangesData&&(e.resourceTimeRangeStore.data=e.resourceTimeRangesData),e.timeRangesData&&(e.timeRangeStore.data=e.timeRangesData)}},{key:"toJSON",value:function(){var e=this,t={eventsData:e.eventStore.toJSON(),resourcesData:e.resourceStore.toJSON(),dependenciesData:e.dependencyStore.toJSON()};return e.eventStore.usesSingleAssignment||(t.assignmentsData=e.assignmentStore.toJSON()),t}},{key:"afterChange",value:function(e,t){we()(pe()(n.prototype),"afterChange",this).apply(this,arguments),t.calendar&&this.trigger("calendarChange")}},{key:"json",get:function(){return we()(pe()(n.prototype),"json",this)},set:function(e){"string"==typeof e&&(e=E.safeJsonParse(e)),this.loadInlineData(e)}}],[{key:"$name",get:function(){return"ProjectModelMixin"}},{key:"defaultConfig",get:function(){return{stm:{},eventModelClass:KR,dependencyModelClass:mx,timeRangeModelClass:Qy,resourceTimeRangeModelClass:tm,resourceModelClass:WS,assignmentModelClass:RC,eventStoreClass:sx,dependencyStoreClass:Ax,resourceStoreClass:tD,assignmentStoreClass:GC,timeRangeStoreClass:No,resourceTimeRangeStoreClass:rm,eventStore:{},assignmentStore:{},dependencyStore:{},resourceStore:{},timeRangeStore:null,resourceTimeRangeStore:null}}}]),n}(e||Bi)};function WT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var GT=function(e){fe()(n,e);var t=WT(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"onEventStoreBeforeSync",value:function(e){var t=e.changes;return this.removeNonPersistableRecordsToCreate(t),this.shallContinueSync(t)}},{key:"onResourceStoreBeforeSync",value:function(e){var t=e.changes;return this.removeNonPersistableRecordsToCreate(t),this.shallContinueSync(t)}},{key:"onAssignmentStoreBeforeSync",value:function(e){var t=e.changes;return this.removeNonPersistableRecordsToCreate(t),this.shallContinueSync(t)}},{key:"onDependencyStoreBeforeSync",value:function(e){var t=e.changes;return this.removeNonPersistableRecordsToCreate(t),this.shallContinueSync(t)}},{key:"removeNonPersistableRecordsToCreate",value:function(e){var t,n,r=e.added||[];for(n=r.length-1;n>=0;--n)(t=r[n]).isPersistable||r.splice(r.indexOf(t),1);0===r.length&&(e.added.length=0)}},{key:"shallContinueSync",value:function(e){return Boolean(e.added&&e.added.length>0||e.modified&&e.modified.length>0||e.removed&&e.removed.length>0)}},{key:"eventStore",set:function(e){var t=this;t.eventStoreDetacher&&t.eventStoreDetacher(),t._eventStore=e,e&&e.autoCommit&&(t.eventStoreDetacher=e.on({beforecommit:t.onEventStoreBeforeSync,thisObj:t,detachable:!0,prio:100}))},get:function(){return this._eventStore}},{key:"resourceStore",set:function(e){var t=this;t.resourceStoreDetacher&&t.resourceStoreDetacher(),t._resourceStore=e,e&&e.autoCommit&&(t.resourceStoreDetacher=e.on({beforecommit:t.onResourceStoreBeforeSync,thisObj:t,detachable:!0,prio:100}))},get:function(){return this._resourceStore}},{key:"assignmentStore",set:function(e){var t=this;t.assignmentStoreDetacher&&t.assignmentStoreDetacher(),t._assignmentStore=e,e&&e.autoSync&&(t.assignmentStoreDetacher=e.on({beforecommit:t.onAssignmentStoreBeforeSync,thisObj:t,detachable:!0,prio:100}))},get:function(){return this._assignmentStore}},{key:"dependencyStore",set:function(e){var t=this;t.dependencyStoreDetacher&&t.dependencyStoreDetacher(),t._dependencyStore=e,e&&e.autoSync&&(t.dependencyStoreDetacher=e.on({beforecommit:t.onDependencyStoreBeforeSync,thisObj:t,detachable:!0,prio:100}))},get:function(){return this._dependencyStore}}]),n}(ue);function YT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}GT._$name="ModelPersistencyManager";var UT=function(e){fe()(n,e);var t=YT(n);function n(){var e;return v()(this,n),(e=t.apply(this,arguments)).entities=new Map,e}return g()(n,[{key:"hasEntity",value:function(e){return this.entities.has(e)}},{key:"getEntity",value:function(e){return this.entities.get(e)}},{key:"addEntity",value:function(e){var t=e.name;if(!t)throw new Error("Entity must have a name");if(this.hasEntity(t))throw new Error("Entity with name [".concat(String(t),"] already exists"));return e.schema=this,this.entities.set(t,e),e}},{key:"getEntityDecorator",value:function(){var e=this;return function(t){var n=qT(t);return e.addEntity(n),t}}}]),n}(qm),qT=function(e){if(!e.name)throw new Error("Can't add entity - the target class has no name");return uw(e.prototype)};function KT(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var XT,ZT=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":l()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},JT=Symbol("ConflictSymbol");!function(e){e.Cancel="Cancel",e.Resume="Resume"}(XT||(XT={}));var QT=function(e){fe()(n,e);var t=KT(n);function n(){var e;return v()(this,n),(e=t.apply(this,arguments)).handler=JT,e}return n}(dk);ZT([nk(!1)],QT.prototype,"sync",void 0);function eM(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return tM(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tM(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function tM(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function nM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var rM=function(e){fe()(n,e);var t=nM(n);function n(){var e;return v()(this,n),(e=t.apply(this,arguments)).failedResolutionReferences=new Map,e}return n}(Db),iM=function(e){fe()(n,e);var t=nM(n);function n(){var e;return v()(this,n),(e=t.apply(this,arguments)).candidateClass=rM,e}return g()(n,[{key:"initialize",value:function(){for(var e,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];(e=we()(pe()(n.prototype),"initialize",this)).call.apply(e,[this].concat(r)),this.candidate.failedResolutionReferences=new Map(this.baseRevision.failedResolutionReferences)}},{key:"addIdentifier",value:function(e,t){var r;this.markFailedResolutionReferences();for(var i=arguments.length,o=new Array(i>2?i-2:0),a=2;a<i;a++)o[a-2]=arguments[a];return(r=we()(pe()(n.prototype),"addIdentifier",this)).call.apply(r,[this,e,t].concat(o))}},{key:"markFailedResolutionReferences",value:function(){var e=this;this.candidate.failedResolutionReferences.forEach((function(t,n){e.write(n,t)})),this.candidate.failedResolutionReferences.clear()}}]),n}(Bb),oM=function(e){fe()(n,e);var t=nM(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([Kb],(function(e){var t=e.prototype;return function(e){fe()(a,e);var n,r,i,o=nM(a);function a(){var e;return v()(this,a),(e=o.apply(this,arguments)).baseRevision=rM.new(),e.transactionClass=iM,e.autoCommitMode="async",e.onComputationCycle="reject",e.silenceInitialCommit=!0,e.ignoreInitialCommitComputationCycles=!0,e}return g()(a,[{key:"onPropagationProgressNotification",value:function(e){this.enableProgressNotifications&&this.project&&this.project.trigger("progress",e)}},{key:"propagate",value:function(e){return this.commitAsync(e)}},{key:"commitAsync",value:(i=Wr()(Vr.a.mark((function e(n){var r;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.project.trigger("beforeCommit"),this.isInitialCommit&&this.ignoreInitialCommitComputationCycles&&(this._onComputationCycle=this._onComputationCycle||this.onComputationCycle,this.onComputationCycle="ignore"),!(r=this.project.beforeCommitAsync())){e.next=5;break}return e.abrupt("return",r);case 5:return e.abrupt("return",t.commitAsync.call(this,n));case 6:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"finalizeCommitAsync",value:(r=Wr()(Vr.a.mark((function e(t){var n,r,i,o,a,s;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if((n=this.project)&&!n.isDestroyed){e.next=3;break}return e.abrupt("return");case 3:return r=t.entries,i=new Set,j.a.global.DEBUG&&console.timeEnd("Time to visible"),o=this.isInitialCommit,a=this.silenceInitialCommit,s=o&&a,o&&(n.isInitialCommitPerformed=!0,this.ignoreInitialCommitComputationCycles&&(this.onComputationCycle=this._onComputationCycle)),n.isWritingData=!0,n.hasLoadedDataToCommit=!1,n.trigger("refresh",{isInitialCommit:o}),e.next=14,new Promise((function(e){setTimeout((function(){var a,u;if(!n.isDestroyed&&!t.transaction.rejectedWith){null===(a=n.suspendChangesTracking)||void 0===a||a.call(n),j.a.global.DEBUG&&console.time("Finalize propagation");var c,l=new Set,f=eM(r.values());try{for(f.s();!(c=f.n()).done;){var d=c.value,h=d.identifier,v=d.getValue(),p=h.field;if(!(d.isShadow()||!h[Fw]||v===sb||p instanceof Ow)){var g=h.self,y=g.firstStore;l.has(g)||(g.beginBatch(),l.add(g)),(null==y?void 0:y.autoCommit)&&!i.has(y)&&(y.suspendAutoCommit(),i.add(y)),g.set(p.name,v)}}}catch(e){f.e(e)}finally{f.f()}var m,k=eM(l);try{for(k.s();!(m=k.n()).done;){var b=m.value;b.ignoreBag=s,b.endBatch(s,!0),b.ignoreBag=!1}}catch(e){k.e(e)}finally{k.f()}j.a.global.DEBUG&&console.timeEnd("Finalize propagation"),n.trigger("dataReady",{records:l,isInitialCommit:o}),null===(u=n.resumeChangesTracking)||void 0===u||u.call(n,s),i.forEach((function(e){return e.resumeAutoCommit()})),s&&[n.eventStore,n.dependencyStore,n.resourceStore,n.assignmentStore,n.calendarManagerStore].forEach((function(e){return e.acceptChanges()}))}n.isWritingData=!1,e()}),0)}));case 14:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:JT,value:(n=Wr()(Vr.a.mark((function e(t,n){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.project.onSchedulingConflict(t,n));case 1:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:pk,value:function(e,t){return we()(pe()(a.prototype),pk,this).call(this,e,t)}},{key:"isInitialCommit",get:function(){return this.project.isInitialCommit||we()(pe()(a.prototype),"isInitialCommit",this)},set:function(e){sc()(pe()(a.prototype),"isInitialCommit",e,this,!0)}}]),a}(e)})));function aM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var sM=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":l()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},uM=function(e){fe()(n,e);var t=aM(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([Uw],(function(e){e.prototype;var t=function(e){fe()(n,e);var t=aM(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"calculateUnitsInMs",value:Vr.a.mark((function e(){var t,n,r;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.hoursPerDay;case 2:return t=e.sent,e.next=5,this.$.daysPerWeek;case 5:return n=e.sent,e.next=8,this.$.daysPerMonth;case 8:return r=e.sent,e.abrupt("return",{millisecond:1,second:1e3,minute:6e4,hour:36e5,day:60*t*60*1e3,week:n*t*60*60*1e3,month:r*t*60*60*1e3,quarter:3*r*t*60*60*1e3,year:12*r*t*60*60*1e3});case 10:case"end":return e.stop()}}),e,this)}))},{key:"convertDuration",value:function(e,t,n){var r=e;return t!==n&&(r=e*this.unitsInMs[t]/this.unitsInMs[n]),r}},{key:"$convertDuration",value:Vr.a.mark((function e(t,n,r){var i,o;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n&&r){e.next=2;break}throw new Error("Conversion unit not provided");case 2:return e.next=4,this.$.unitsInMs;case 4:return i=e.sent,o=t,n!==r&&(o=t*i[n]/i[r]),e.abrupt("return",o);case 8:case"end":return e.stop()}}),e,this)}))}]),n}(e);return sM([lw()],t.prototype,"unitsInMs",void 0),sM([Vw({type:"number",defaultValue:24})],t.prototype,"hoursPerDay",void 0),sM([Vw({type:"number",defaultValue:7})],t.prototype,"daysPerWeek",void 0),sM([Vw({type:"number",defaultValue:30})],t.prototype,"daysPerMonth",void 0),sM([fw("unitsInMs")],t.prototype,"calculateUnitsInMs",null),t})));function cM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var lM=function(e){fe()(n,e);var t=cM(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([tC],(function(e){e.prototype;return function(e){fe()(n,e);var t=cM(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(e)})));function fM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var dM=function(e){fe()(n,e);var t=fM(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([lM,rC],(function(e){e.prototype;return function(e){fe()(n,e);var t=fM(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"defaultConfig",get:function(){return{tree:!0,modelClass:FS}}}]),n}(e)})));function hM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var vM=function(e){fe()(n,e);var t=hM(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([],Ge)),pM=function(e){fe()(n,e);var t=hM(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([],_a)),gM=function(e){fe()(n,e);var t=hM(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([vM,pM,Bi],(function(e){var t=e.prototype;return function(e){fe()(i,e);var n,r=hM(i);function i(){return v()(this,i),r.apply(this,arguments)}return g()(i,[{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.isInitialCommitPerformed=!1,this.isLoadingInlineData=!1,this.isWritingData=!1,this.hasLoadedDataToCommit=!1,t.construct.call(this,e),this.silenceInitialCommit=!("silenceInitialCommit"in e)||e.silenceInitialCommit}},{key:"repopulateStore",value:function(e){}},{key:"repopulateReplica",value:function(){}},{key:"commitAsync",value:(n=Wr()(Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Abstract method called");case 1:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})},{key:"isEngineReady",value:function(){throw new Error("Abstract method called")}},{key:"isRepopulatingStores",get:function(){return!1}},{key:"isInitialCommit",get:function(){return!this.isInitialCommitPerformed||this.hasLoadedDataToCommit}}]),i}(e)})));function yM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var mM=function(e){fe()(n,e);var t=yM(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([Uw,gM],(function(e){e.prototype;return function(e){fe()(i,e);var t,n,r=yM(i);function i(){return v()(this,i),r.apply(this,arguments)}return g()(i,[{key:"getGraph",value:function(){return this.replica}},{key:"beforeCommitAsync",value:function(){return null}},{key:"commitAsync",value:(n=Wr()(Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.replica.commitAsync());case 1:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"onSchedulingConflict",value:(t=Wr()(Vr.a.mark((function e(t,n){var r=this;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.hasListener("schedulingConflict")){e.next=2;break}return e.abrupt("return",new Promise((function(e,n){r.trigger("schedulingConflict",{continueWithResolutionResult:e,conflict:t})})));case 2:return e.abrupt("return",XT.Cancel);case 3:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})}]),i}(e)})));function kM(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return bM(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return bM(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function bM(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function wM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var CM=function(e){fe()(n,e);var t=wM(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([TR],(function(e){var t=e.prototype;return function(e){fe()(r,e);var n=wM(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"hasSubEvents",value:Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Abstract method `hasSubEvents` has been called");case 1:case"end":return e.stop()}}),e)}))},{key:"subEventsIterable",value:Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:throw new Error("Abstract method `subEventsIterable` has been called");case 1:case"end":return e.stop()}}),e)}))},{key:"calculateStartDatePure",value:Vr.a.mark((function e(){var n,r;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.manuallyScheduled;case 2:return n=e.sent,e.delegateYield(this.hasSubEvents(),"t0",4);case 4:if(r=e.t0,n||!r){e.next=10;break}return e.delegateYield(this.calculateMinChildrenStartDate(),"t1",7);case 7:return e.abrupt("return",e.t1);case 10:return e.delegateYield(t.calculateStartDatePure.call(this),"t2",11);case 11:return e.abrupt("return",e.t2);case 12:case"end":return e.stop()}}),e,this)}))},{key:"calculateEndDatePure",value:Vr.a.mark((function e(){var n,r;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.manuallyScheduled;case 2:return n=e.sent,e.delegateYield(this.hasSubEvents(),"t0",4);case 4:if(r=e.t0,n||!r){e.next=10;break}return e.delegateYield(this.calculateMaxChildrenEndDate(),"t1",7);case 7:return e.abrupt("return",e.t1);case 10:return e.delegateYield(t.calculateEndDatePure.call(this),"t2",11);case 11:return e.abrupt("return",e.t2);case 12:case"end":return e.stop()}}),e,this)}))},{key:"calculateStartDateProposed",value:Vr.a.mark((function e(){var n,r;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.manuallyScheduled;case 2:return n=e.sent,e.delegateYield(this.hasSubEvents(),"t0",4);case 4:if(r=e.t0,n||!r){e.next=10;break}return e.delegateYield(this.calculateStartDatePure(),"t1",7);case 7:return e.abrupt("return",e.t1);case 10:return e.delegateYield(t.calculateStartDateProposed.call(this),"t2",11);case 11:return e.abrupt("return",e.t2);case 12:case"end":return e.stop()}}),e,this)}))},{key:"calculateEndDateProposed",value:Vr.a.mark((function e(){var n,r;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.manuallyScheduled;case 2:return n=e.sent,e.delegateYield(this.hasSubEvents(),"t0",4);case 4:if(r=e.t0,n||!r){e.next=10;break}return e.delegateYield(this.calculateEndDatePure(),"t1",7);case 7:return e.abrupt("return",e.t1);case 10:return e.delegateYield(t.calculateEndDateProposed.call(this),"t2",11);case 11:return e.abrupt("return",e.t2);case 12:case"end":return e.stop()}}),e,this)}))},{key:"calculateDurationProposed",value:Vr.a.mark((function e(){var n,r;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.manuallyScheduled;case 2:return n=e.sent,e.delegateYield(this.hasSubEvents(),"t0",4);case 4:if(r=e.t0,n||!r){e.next=10;break}return e.delegateYield(this.calculateDurationPure(),"t1",7);case 7:return e.abrupt("return",e.t1);case 10:return e.delegateYield(t.calculateDurationProposed.call(this),"t2",11);case 11:return e.abrupt("return",e.t2);case 12:case"end":return e.stop()}}),e,this)}))},{key:"calculateMinChildrenStartDate",value:Vr.a.mark((function e(){var t,n,r,i,o,a;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this.subEventsIterable(),"t0",1);case 1:t=e.t0,n=[],r=kM(t),e.prev=4,r.s();case 6:if((i=r.n()).done){e.next=15;break}return o=i.value,e.t1=n,e.next=11,o.$.startDate;case 11:e.t2=e.sent,e.t1.push.call(e.t1,e.t2);case 13:e.next=6;break;case 15:e.next=20;break;case 17:e.prev=17,e.t3=e.catch(4),r.e(e.t3);case 20:return e.prev=20,r.f(),e.finish(20);case 23:if((a=n.reduce((function(e,t){return t?Math.min(e,t.getTime()):e}),sS.getTime()))!==aS.getTime()&&a!==sS.getTime()){e.next=26;break}return e.abrupt("return",null);case 26:return e.abrupt("return",new Date(a));case 27:case"end":return e.stop()}}),e,this,[[4,17,20,23]])}))},{key:"calculateMaxChildrenEndDate",value:Vr.a.mark((function e(){var t,n,r,i,o,a;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this.subEventsIterable(),"t0",1);case 1:t=e.t0,n=[],r=kM(t),e.prev=4,r.s();case 6:if((i=r.n()).done){e.next=15;break}return o=i.value,e.t1=n,e.next=11,o.$.endDate;case 11:e.t2=e.sent,e.t1.push.call(e.t1,e.t2);case 13:e.next=6;break;case 15:e.next=20;break;case 17:e.prev=17,e.t3=e.catch(4),r.e(e.t3);case 20:return e.prev=20,r.f(),e.finish(20);case 23:if((a=n.reduce((function(e,t){return t?Math.max(e,t.getTime()):e}),aS.getTime()))!==aS.getTime()&&a!==sS.getTime()){e.next=26;break}return e.abrupt("return",null);case 26:return e.abrupt("return",new Date(a));case 27:case"end":return e.stop()}}),e,this,[[4,17,20,23]])}))}]),r}(e)})));function SM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var DM=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":l()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},RM=function(e){fe()(n,e);var t=SM(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Um([mM,TR,CM,_S,uM,BS],(function(e){var t=e.prototype,n=function(e){fe()(f,e);var n,r,i,o,a,s,u,c,l=SM(f);function f(){return v()(this,f),l.apply(this,arguments)}return g()(f,[{key:"construct",value:function(){var e=this,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.enableProgressNotifications=n.enableProgressNotifications,"expanded"in n||(n.expanded=!0),t.construct.call(this,n),this.ignoreInitialCommitComputationCycles=!("ignoreInitialCommitComputationCycles"in n)||n.ignoreInitialCommitComputationCycles,!1!==this.repopulateOnDataset&&(this.repopulateOnDataset=!0),this.eventModelClass||(this.eventModelClass=this.getDefaultEventModelClass()),this.eventStoreClass||(this.eventStoreClass=this.getDefaultEventStoreClass()),this.dependencyModelClass||(this.dependencyModelClass=this.getDefaultDependencyModelClass()),this.dependencyStoreClass||(this.dependencyStoreClass=this.getDefaultDependencyStoreClass()),this.resourceModelClass||(this.resourceModelClass=this.getDefaultResourceModelClass()),this.resourceStoreClass||(this.resourceStoreClass=this.getDefaultResourceStoreClass()),this.assignmentModelClass||(this.assignmentModelClass=this.getDefaultAssignmentModelClass()),this.assignmentStoreClass||(this.assignmentStoreClass=this.getDefaultAssignmentStoreClass()),this.calendarModelClass||(this.calendarModelClass=this.getDefaultCalendarModelClass()),this.calendarManagerStoreClass||(this.calendarManagerStoreClass=this.getDefaultCalendarManagerStoreClass()),this.replica=this.createReplica(),this.replica.addEntity(this),this.defaultCalendar=new this.calendarModelClass({unspecifiedTimeIsWorking:this.unspecifiedTimeIsWorking}),this.defaultCalendar.project=this,this.replica.addEntity(this.defaultCalendar);var r,i,o=this.stm=new Fs(Object.assign({disabled:!0},this.stm));this.stm.on({restoringStop:(r=Wr()(Vr.a.mark((function t(){return Vr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.stm.disable(),t.next=3,e.commitAsync();case 3:e.isDestroyed||(e.stm.enable(),e.trigger("stateRestoringDone"));case 4:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})}),this.on({beforeCommit:function(){o.isRecording&&o.autoRecord&&(i=!0,o.autoRecord=!1)},dataReady:function(){i&&(o.autoRecord=!0,i=!1)}}),this.setCalendarManagerStore(this.calendarManagerStore),this.setEventStore(this.eventStore),this.setDependencyStore(this.dependencyStore),this.setResourceStore(this.resourceStore),this.setAssignmentStore(this.assignmentStore);var a=Boolean(this.calendarsData||this.eventsData||this.dependenciesData||this.resourcesData||this.assignmentsData);a&&(this.loadInlineData({calendarsData:this.calendarsData,eventsData:this.eventsData,dependenciesData:this.dependenciesData,resourcesData:this.resourcesData,assignmentsData:this.assignmentsData}),delete this.calendarsData,delete this.eventsData,delete this.dependenciesData,delete this.resourcesData,delete this.assignmentsData)}},{key:"doDestroy",value:function(){var e,n,r,i,o,a,s=this;null===(e=s.eventStore)||void 0===e||e.destroy(),null===(n=s.dependencyStore)||void 0===n||n.destroy(),null===(r=s.assignmentStore)||void 0===r||r.destroy(),null===(i=s.resourceStore)||void 0===i||i.destroy(),null===(o=s.calendarManagerStore)||void 0===o||o.destroy(),s.replica.clear(),null===(a=s.stm)||void 0===a||a.destroy(),t.doDestroy.call(this)}},{key:"createReplica",value:function(){return oM.mix(Kb).new({project:this,schema:UT.new(),enableProgressNotifications:this.enableProgressNotifications,silenceInitialCommit:this.silenceInitialCommit,ignoreInitialCommitComputationCycles:this.ignoreInitialCommitComputationCycles,onWriteDuringCommit:"ignore",readMode:qb.CurrentOrProposedOrPrevious})}},{key:"hasSubEvents",value:Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.getEventStore().count>0);case 1:case"end":return e.stop()}}),e,this)}))},{key:"subEventsIterable",value:Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.getEventStore().getRange());case 1:case"end":return e.stop()}}),e,this)}))},{key:"getType",value:function(){return tS.SchedulerBasic}},{key:"getDefaultEventModelClass",value:function(){return $R}},{key:"getDefaultEventStoreClass",value:function(){return tx}},{key:"getDefaultDependencyModelClass",value:function(){return hx}},{key:"getDefaultDependencyStoreClass",value:function(){return Dx}},{key:"getDefaultResourceModelClass",value:function(){return VS}},{key:"getDefaultResourceStoreClass",value:function(){return XS}},{key:"getDefaultAssignmentModelClass",value:function(){return lC}},{key:"getDefaultAssignmentStoreClass",value:function(){return LC}},{key:"getDefaultCalendarModelClass",value:function(){return FS}},{key:"getDefaultCalendarManagerStoreClass",value:function(){return dM}},{key:"loadInlineData",value:(c=Wr()(Vr.a.mark((function e(t){var n,r,i,o,a;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=this.calendarManagerStore,r=this.eventStore,i=this.dependencyStore,o=this.assignmentStore,a=this.resourceStore,this.replica.unScheduleAutoCommit(),!this.replica.enableProgressNotifications){e.next=8;break}return e.next=5,rk(0);case 5:return this.replica.onPropagationProgressNotification({total:0,remaining:0,phase:"storePopulation"}),e.next=8,rk(50);case 8:return this.isLoadingInlineData=!0,j.a.global.DEBUG&&(console.log("%cInitializing project","font-weight:bold;color:darkgreen;text-transform:uppercase;margin-top: 2em"),console.time("Time to visible"),console.time("Populating project")),t.calendarsData&&(this.repopulateStore(n),n.data=t.calendarsData),(t.eventsData||t.tasksData)&&(this.repopulateStore(r),r.data=t.eventsData||t.tasksData),t.dependenciesData&&(this.repopulateStore(i),i.data=t.dependenciesData),t.resourcesData&&(this.repopulateStore(a),a.data=t.resourcesData),t.assignmentsData&&(this.repopulateStore(o),o.data=t.assignmentsData),j.a.global.DEBUG&&console.timeEnd("Populating project"),e.next=18,this.commitLoad();case 18:return this.isLoadingInlineData=!1,e.abrupt("return");case 20:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"commitLoad",value:(u=Wr()(Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.commitAsync();case 2:this.isDestroyed||this.trigger("load");case 3:case"end":return e.stop()}}),e,this)}))),function(){return u.apply(this,arguments)})},{key:"repopulateStore",value:function(e){this.repopulateOnDataset&&e.count&&(this.repopulateStores||(this.repopulateStores=new Set),this.repopulateStores.add(e),this.repopulateReplica())}},{key:"repopulateReplica",value:function(){var e=this.calendarManagerStore,t=this.eventStore,n=this.dependencyStore,r=this.assignmentStore,i=this.resourceStore,o=this.replica;this.unlinkStoreRecords(e,t,n,i,r),this.unlinkRecord(this),this.unlinkRecord(this.defaultCalendar),o.clear();var a=this.replica=this.createReplica();a.addEntity(this),a.addEntity(this.defaultCalendar),this.joinStoreRecords(e,!0),this.joinStoreRecords(t,!0),this.joinStoreRecords(n,!0),this.joinStoreRecords(i,!0),this.joinStoreRecords(r,!0),this.repopulateStores.clear()}},{key:"beforeCommitAsync",value:function(){return this.repopulateReplica.isPending?(this.repopulateReplica.now(),this.replica.commitAsync()):null}},{key:"unlinkRecord",value:function(e){for(var t,n=this.replica.activeTransaction,r=e.$,i=Object.keys(r),o=0;o<i.length;o++){var a=i[o],s=r[a];if(s.field instanceof Iw){var u=e[a];s.DATA=null!==(t=null==u?void 0:u.id)&&void 0!==t?t:u}else{var c=n.getLatestStableEntryFor(s);c&&(s.DATA=c.getValue())}}e.graph=null}},{key:"unlinkStoreRecords",value:function(){for(var e=this,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];n.forEach((function(t){return t.traverse((function(n){e.repopulateStores.has(t)||e.unlinkRecord(n)}),!1)}))}},{key:"getGraph",value:function(){return this.replica}},{key:"addEvents",value:(s=Wr()(Vr.a.mark((function e(t){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.eventStore.add(t),e.abrupt("return",this.graph.commitAsync());case 2:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"addEvent",value:(a=Wr()(Vr.a.mark((function e(t){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.eventStore.add(t),e.abrupt("return",this.graph.commitAsync());case 2:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"includeEvent",value:function(e){this.eventStore.add(e)}},{key:"removeEvents",value:(o=Wr()(Vr.a.mark((function e(t){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.eventStore.remove(t),e.abrupt("return",this.graph.commitAsync());case 2:case"end":return e.stop()}}),e,this)}))),function(e){return o.apply(this,arguments)})},{key:"excludeEvent",value:function(e){this.eventStore.remove(e)}},{key:"removeEvent",value:(i=Wr()(Vr.a.mark((function e(t){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.eventStore.remove(t),e.abrupt("return",this.graph.commitAsync());case 2:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"getStm",value:function(){return this.stm}},{key:"calculateProject",value:function(){return this}},{key:"resolveCalendar",value:function(e){return we()(pe()(f.prototype),"resolveCalendar",this).call(this,e)||this.defaultCalendar}},{key:"joinStoreRecords",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=function(e){e.setProject(t),e.joinProject()};e.rootNode?e.rootNode.traverse(r,n):e.forEach(r)}},{key:"unJoinStoreRecords",value:function(e){var t=this,n=function(e){e.leaveProject(),e.setProject(t)};e.rootNode?e.rootNode.traverse((function(t){t!==e.rootNode&&n(t)})):e.forEach(n)}},{key:"setEventStore",value:function(e){var t=this.eventStore;if(t&&this.stm.hasStore(t)){this.stm.removeStore(t),this.unJoinStoreRecords(t);var n=t.assignmentsForRemoval;n.forEach((function(t){var r=t.event;if(r){var i=e.getById(r.id);i&&(t.event=i,n.delete(t))}})),t.afterEventRemoval()}if(e&&e instanceof No)this.eventStore=e,e.setProject(this),this.stm.addStore(e),e.tree&&e.rootNode!==this?(this.appendChild(e.rootNode.children||[]),e.rootNode=this):this.joinStoreRecords(e);else{var r=(null==e?void 0:e.storeClass)||this.eventStoreClass;this.eventStore=new r(Object.assign({modelClass:this.eventModelClass,project:this,stm:this.stm},e||{}))}this.trigger("eventStoreChange",{store:this.eventStore})}},{key:"setDependencyStore",value:function(e){var t=this.dependencyStore;if(t&&this.stm.hasStore(t)&&this.stm.removeStore(t),e&&e instanceof No)this.dependencyStore=e,e.setProject(this),this.stm.addStore(e),this.joinStoreRecords(e);else{var n=(null==e?void 0:e.storeClass)||this.dependencyStoreClass;this.dependencyStore=new n(Object.assign({modelClass:this.dependencyModelClass,project:this,stm:this.stm},e||{}))}this.trigger("dependencyStoreChange",{store:this.dependencyStore})}},{key:"setResourceStore",value:function(e){var t=this.resourceStore;if(t&&this.stm.hasStore(t)){this.stm.removeStore(t),this.unJoinStoreRecords(t);var n=t.assignmentsForRemoval;n.forEach((function(t){var r=t.resource;if(r){var i=e.getById(r.id);i&&(t.resource=i,n.delete(t))}})),t.afterResourceRemoval()}if(e&&e instanceof No)this.resourceStore=e,e.setProject(this),this.stm.addStore(e),this.joinStoreRecords(e);else{var r=(null==e?void 0:e.storeClass)||this.resourceStoreClass;this.resourceStore=new r(Object.assign({modelClass:this.resourceModelClass,project:this,stm:this.stm},e||{}))}this.trigger("resourceStoreChange",{store:this.resourceStore})}},{key:"setAssignmentStore",value:function(e){var t=this.assignmentStore;if(t&&this.stm.hasStore(t)&&(this.stm.removeStore(t),this.unJoinStoreRecords(t)),e&&e instanceof No)this.assignmentStore=e,e.setProject(this),this.stm.addStore(e),this.joinStoreRecords(e);else{var n=(null==e?void 0:e.storeClass)||this.assignmentStoreClass;this.assignmentStore=new n(Object.assign({modelClass:this.assignmentModelClass,project:this,stm:this.stm},e||{}))}this.trigger("assignmentStoreChange",{store:this.assignmentStore})}},{key:"setCalendarManagerStore",value:function(e){var t=this.calendarManagerStore;if(t&&this.stm.hasStore(t)&&this.stm.removeStore(t),e&&e instanceof No)this.calendarManagerStore=e,e&&(e.setProject(this),this.stm.addStore(e),this.joinStoreRecords(e));else{var n=(null==e?void 0:e.storeClass)||this.calendarManagerStoreClass;this.calendarManagerStore=new n(Object.assign({modelClass:this.calendarModelClass,project:this,stm:this.stm},e||{}))}this.trigger("calendarManagerStoreChange",{store:this.calendarManagerStore})}},{key:"isValidDependency",value:(r=Wr()(Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}}),e)}))),function(){return r.apply(this,arguments)})},{key:"tryPropagateWithChanges",value:(n=Wr()(Vr.a.mark((function e(t){var n,r,i,o,a,s,u,c;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.stm,o=function(){n.stopTransaction(),r&&n.resetQueue()},a=function(){n.transaction.length?(n.forEachStore((function(e){return e.beginBatch()})),n.rejectTransaction(),n.forEachStore((function(e){return e.endBatch()}))):n.stopTransaction()},s=function(){n.disabled=r,n.autoRecord=i},r=n.disabled,i=n.autoRecord,r?n.enable():(i&&(n.autoRecord=!1),n.isRecording&&n.stopTransaction()),n.startTransaction(),t(),u=!0,e.prev=9,e.next=12,this.commitAsync();case 12:c=e.sent,u=!c.rejectedWith,e.next=21;break;case 16:if(e.prev=16,e.t0=e.catch(9),/cycle/i.test(e.t0)){e.next=20;break}throw e.t0;case 20:u=!1;case 21:return u?o():(this.replica.reject(),a()),s(),e.abrupt("return",u);case 24:case"end":return e.stop()}}),e,this,[[9,16]])}))),function(e){return n.apply(this,arguments)})},{key:"isEngineReady",value:function(){var e=this.replica;return!(e.dirty&&(e.hasPendingAutoCommit()||e.isCommitting))}},{key:"enableProgressNotifications",get:function(){return this._enableProgressNotifications},set:function(e){this._enableProgressNotifications=e,this.replica&&(this.replica.enableProgressNotifications=e)}},{key:"isRepopulatingStores",get:function(){var e;return Boolean(null===(e=this.repopulateStores)||void 0===e?void 0:e.size)}}],[{key:"defaultConfig",get:function(){return{assignmentsData:null,calendarsData:null,dependenciesData:null,eventsData:null,resourcesData:null,eventStore:null,resourceStore:null,assignmentStore:null,dependencyStore:null,calendarManagerStore:null,eventModelClass:null,resourceModelClass:null,assignmentModelClass:null,dependencyModelClass:null,calendarModelClass:null,repopulateOnDataSet:!0}}},{key:"delayable",get:function(){return{repopulateReplica:10}}}]),f}(e);return n.applyConfigs=!0,DM([Vw({type:"boolean",defaultValue:!0})],n.prototype,"unspecifiedTimeIsWorking",void 0),n})));function xM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var EM=function(e){fe()(n,e);var t=xM(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([AS,vC],(function(e){e.prototype;return function(e){fe()(n,e);var t=xM(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(e)})));function TM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var MM=function(e){fe()(n,e);var t=TM(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([lM,_C],(function(e){e.prototype;return function(e){fe()(n,e);var t=TM(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"defaultConfig",get:function(){return{tree:!0,modelClass:EM}}}]),n}(e)})));function AM(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return PM(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return PM(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function PM(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function IM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var OM,FM=function(e){fe()(n,e);var t=IM(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([],Ge)),LM=function(e){fe()(n,e);var t=IM(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([],_a)),jM=function(e){fe()(n,e);var t=IM(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([gM,dC,FM,LM,Bi],(function(e){var t=e.prototype,n=function(e){fe()(h,e);var n,r,i,o,a,s,u,c,l,f,d=IM(h);function h(){return v()(this,h),d.apply(this,arguments)}return g()(h,[{key:"construct",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.$invalidated=new Set,this.isPerformingCommit=!1,this.silenceInitialCommit=!0,this.ongoing=Promise.resolve(),t.construct.call(this,e),this.defaultCalendar=new this.calendarManagerStore.modelClass({unspecifiedTimeIsWorking:this.unspecifiedTimeIsWorking}),this.defaultCalendar.project=this;var n=this.calendarsData,r=this.eventsData,i=this.dependenciesData,o=this.resourcesData,a=this.assignmentsData,s=Boolean(n||r||i||o||a);s?(this.loadInlineData({calendarsData:n,eventsData:r,dependenciesData:i,resourcesData:o,assignmentsData:a}),delete this.calendarsData,delete this.eventsData,delete this.dependenciesData,delete this.resourcesData,delete this.assignmentsData):this.bufferedCommitAsync()}},{key:"doDestroy",value:function(){var e,n,r,i,o,a,s=this;null===(e=s.eventStore)||void 0===e||e.destroy(),null===(n=s.dependencyStore)||void 0===n||n.destroy(),null===(r=s.assignmentStore)||void 0===r||r.destroy(),null===(i=s.resourceStore)||void 0===i||i.destroy(),null===(o=s.calendarManagerStore)||void 0===o||o.destroy(),null===(a=s.stm)||void 0===a||a.destroy(),t.doDestroy.call(this)}},{key:"loadInlineData",value:(f=Wr()(Vr.a.mark((function e(t){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isLoadingInlineData=!0,t.calendarsData&&(this.calendarManagerStore.data=t.calendarsData),t.resourcesData&&(this.resourceStore.data=t.resourcesData),t.assignmentsData&&(this.assignmentStore.data=t.assignmentsData),t.eventsData&&(this.eventStore.data=t.eventsData),t.dependenciesData&&(this.dependencyStore.data=t.dependenciesData),e.next=8,this.commitLoad();case 8:return this.isLoadingInlineData=!1,e.abrupt("return");case 10:case"end":return e.stop()}}),e,this)}))),function(e){return f.apply(this,arguments)})},{key:"commitLoad",value:(l=Wr()(Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.commitAsync();case 2:this.isDestroyed||this.trigger("load");case 3:case"end":return e.stop()}}),e,this)}))),function(){return l.apply(this,arguments)})},{key:"joinStoreRecords",value:function(e){var t=this,n=function(e){e.setProject(t),e.joinProject()};e.rootNode?e.rootNode.traverse(n):e.forEach(n)}},{key:"unJoinStoreRecords",value:function(e){var t=this,n=function(e){e.leaveProject(),e.setProject(t)};e.rootNode?e.rootNode.traverse((function(t){t!==e.rootNode&&n(t)})):e.forEach(n)}},{key:"resolveStoreAndModelClass",value:function(e,t){var n=(null==t?void 0:t.storeClass)||this["".concat(e,"StoreClass")],r=null==t?void 0:t.modelClass;return r||(r=this.getDefaultConfiguration()["".concat(e,"ModelClass")]!==n.defaultConfig.modelClass?n.defaultConfig.modelClass:this["".concat(e,"ModelClass")]),{storeClass:n,modelClass:r}}},{key:"setEventStore",value:function(e){this.eventStore=e}},{key:"setAssignmentStore",value:function(e){this.assignmentStore=e}},{key:"setResourceStore",value:function(e){this.resourceStore=e}},{key:"setDependencyStore",value:function(e){this.dependencyStore=e}},{key:"setCalendarManagerStore",value:function(e){this.calendarManagerStore=e}},{key:"addEvent",value:(c=Wr()(Vr.a.mark((function e(t){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.eventStore.add(t),e.abrupt("return",this.commitAsync());case 2:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"addAssignment",value:(u=Wr()(Vr.a.mark((function e(t){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.assignmentStore.add(t),e.abrupt("return",this.commitAsync());case 2:case"end":return e.stop()}}),e,this)}))),function(e){return u.apply(this,arguments)})},{key:"addResource",value:(s=Wr()(Vr.a.mark((function e(t){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.resourceStore.add(t),e.abrupt("return",this.commitAsync());case 2:case"end":return e.stop()}}),e,this)}))),function(e){return s.apply(this,arguments)})},{key:"addDependency",value:(a=Wr()(Vr.a.mark((function e(t){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.dependencyStore.add(t),e.abrupt("return",this.commitAsync());case 2:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"bufferedCommitAsync",value:function(){this.hasPendingAutoCommit||this.setTimeout({fn:"commitAsync",delay:10})}},{key:"unScheduleAutoCommit",value:function(){this.clearTimeout("commitAsync")}},{key:"commitAsync",value:(o=Wr()(Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.isPerformingCommit){e.next=2;break}return e.abrupt("return",this.ongoing);case 2:return e.abrupt("return",this.ongoing=this.doCommitAsync());case 3:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"doCommitAsync",value:(i=Wr()(Vr.a.mark((function e(){var t,n,r,i,o,a,s,u,c,l,f,d;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.isPerformingCommit=!0,this.unScheduleAutoCommit(),e.next=4,PC(0);case 4:if(this.isDestroyed){e.next=28;break}t=AM(this.$invalidated);try{for(t.s();!(n=t.n()).done;)n.value.calculateInvalidated()}catch(e){t.e(e)}finally{t.f()}r=this.isInitialCommit,i=this.silenceInitialCommit,o=r&&i,this.assignmentStore.onCommitAsync(),this.dependencyStore.onCommitAsync(),this.isInitialCommitPerformed=!0,this.hasLoadedDataToCommit=!1,this.isPerformingCommit=!1,(a=[this.assignmentStore,this.dependencyStore,this.eventStore,this.resourceStore,this.calendarManagerStore]).forEach((function(e){return e.suspendAutoCommit()})),this.isWritingData=!0,this.trigger("refresh",{isInitialCommit:r}),s=AM(this.$invalidated);try{for(s.s();!(u=s.n()).done;)(c=u.value).beginBatch(),c.finalizeInvalidated(r)}catch(e){s.e(e)}finally{s.f()}l=AM(this.$invalidated);try{for(l.s();!(f=l.n()).done;)(d=f.value).ignoreBag=o,d.endBatch(o,!0),d.ignoreBag=!1}catch(e){l.e(e)}finally{l.f()}return this.isWritingData=!1,this.$invalidated.clear(),this.trigger("dataReady"),a.forEach((function(e){return e.resumeAutoCommit()})),o&&[this.eventStore,this.dependencyStore,this.resourceStore,this.assignmentStore,this.calendarManagerStore].forEach((function(e){return e.acceptChanges()})),e.abrupt("return",!0);case 28:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"propagateAsync",value:(r=Wr()(Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.commitAsync());case 1:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"invalidate",value:function(e){this.$invalidated.add(e),this.bufferedCommitAsync()}},{key:"isValidDependency",value:(n=Wr()(Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",!0);case 1:case"end":return e.stop()}}),e)}))),function(){return n.apply(this,arguments)})},{key:"getStm",value:function(){return this.stm}},{key:"isEngineReady",value:function(){return!this.hasPendingAutoCommit&&!this.isPerformingCommit&&this.isInitialCommitPerformed}},{key:"eventStore",get:function(){return this.$eventStore},set:function(e){var t=this,n=t.stm,r=t.$eventStore;if(e instanceof No)e.project=t,n.addStore(e),t.joinStoreRecords(e);else{var i=t.resolveStoreAndModelClass("event",e),o=i.storeClass,a=i.modelClass;e=new o(Object.assign({modelClass:a,project:t,stm:n},e))}if(r&&n.hasStore(r)){n.removeStore(r),t.unJoinStoreRecords(r);var s=r.assignmentsForRemoval;s.forEach((function(t){var n=t.event;if(n){var r=e.getById(n.id);r&&(t.event=r,s.delete(t))}})),r.afterEventRemoval()}e.setProject(t),t.$eventStore=e,t.trigger("eventStoreChange",{store:e})}},{key:"assignmentStore",get:function(){return this.$assignmentStore},set:function(e){var t=this,n=t.stm,r=t.$assignmentStore;if(r&&n.hasStore(r)&&(n.removeStore(r),t.unJoinStoreRecords(r)),e instanceof No)e.project=t,n.addStore(e),t.joinStoreRecords(e);else{var i=t.resolveStoreAndModelClass("assignment",e),o=i.storeClass,a=i.modelClass;e=new o(Object.assign({modelClass:a,project:t,stm:n},e))}e.setProject(t),t.$assignmentStore=e,t.trigger("assignmentStoreChange",{store:e})}},{key:"resourceStore",get:function(){return this.$resourceStore},set:function(e){var t=this,n=t.stm,r=t.$resourceStore;if(e instanceof No)e.project=t,n.addStore(e),t.joinStoreRecords(e);else{var i=t.resolveStoreAndModelClass("resource",e),o=i.storeClass,a=i.modelClass;e=new o(Object.assign({modelClass:a,project:t,stm:n},e))}if(r&&n.hasStore(r)){n.removeStore(r),t.unJoinStoreRecords(r);var s=r.assignmentsForRemoval;s.forEach((function(t){var n=t.resource;if(n){var r=e.getById(n.id);r&&(t.resource=r,s.delete(t))}})),r.afterResourceRemoval()}e.setProject(t),t.$resourceStore=e,t.trigger("resourceStoreChange",{store:e})}},{key:"dependencyStore",get:function(){return this.$dependencyStore},set:function(e){var t=this;if(e instanceof No)e.project=t,t.stm.addStore(e),t.joinStoreRecords(e);else{var n=t.resolveStoreAndModelClass("dependency",e),r=n.storeClass,i=n.modelClass;e=new r(Object.assign({modelClass:i,project:t,stm:t.stm},e))}t.$dependencyStore=e,t.trigger("dependencyStoreChange",{store:e})}},{key:"calendarManagerStore",get:function(){return this.$calendarManagerStore},set:function(e){var t=this;if(e instanceof No)t.stm.addStore(e);else{var n=(null==e?void 0:e.storeClass)||t.calendarManagerStoreClass,r=(null==e?void 0:e.modelClass)||n.defaultConfig.modelClass||t.calendarModelClass;e=new n(Object.assign({modelClass:r,project:t,stm:t.stm},e))}e.setProject(t),t.$calendarManagerStore=e,t.trigger("calendarManagerStoreChange",{store:e})}},{key:"calendar",get:function(){return this.$calendar||this.defaultCalendar},set:function(e){this.$calendar=e}},{key:"effectiveCalendar",get:function(){return this.calendar}},{key:"hasPendingAutoCommit",get:function(){return this.hasTimeout("commitAsync")}},{key:"stm",set:function(e){var t,n=this;(e=this.$stm=new Fs(Object.assign({disabled:!0},e))).on({restoringStop:(t=Wr()(Vr.a.mark((function t(){return Vr.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.disable(),t.next=3,n.commitAsync();case 3:n.isDestroyed||(e.enable(),n.trigger("stateRestoringDone"));case 4:case"end":return t.stop()}}),t)}))),function(){return t.apply(this,arguments)})})},get:function(){return this.$stm}}],[{key:"defaultConfig",get:function(){return{stm:{},eventStore:{},assignmentStore:{},resourceStore:{},dependencyStore:{},calendarManagerStore:{},eventModelClass:UR,assignmentModelClass:SC,resourceModelClass:bC,dependencyModelClass:gx,calendarModelClass:EM,eventStoreClass:ox,assignmentStoreClass:zC,resourceStoreClass:QS,dependencyStoreClass:Tx,calendarManagerStoreClass:MM,assignmentsData:null,calendarsData:null,dependenciesData:null,eventsData:null,resourcesData:null}}}]),h}(e);return n.applyConfigs=!0,n})));function _M(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var BM=(null===(OM=window.bryntum)||void 0===OM?void 0:OM.useBasicEngine)?RM:jM,HM=function(e){fe()(n,e);var t=_M(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(){for(var e,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];(e=we()(pe()(n.prototype),"construct",this)).call.apply(e,[this].concat(r)),y.a.isTestEnv&&(window.bryntum.testProject=this),this.modelPersistencyManager=this.createModelPersistencyManager()}},{key:"createModelPersistencyManager",value:function(){return new GT({eventStore:this,resourceStore:this.resourceStore,assignmentStore:this.assignmentStore,dependencyStore:this.dependencyStore})}}]),n}(zT(BM));function $M(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return NM(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return NM(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function NM(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function VM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}HM.applyConfigs=!0,HM._$name="ProjectModel";var zM=function(e){return function(e){fe()(n,e);var t=VM(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"startConfigure",value:function(e){this.getConfig("project"),we()(pe()(n.prototype),"startConfigure",this).call(this,e)}},{key:"changeProject",value:function(e,t){var n=this,r=n.constructor,i=r.projectStoreNames,o=r.projectDataNames;if(n.projectCallbacks=new Set,e){if(n.buildingProjectConfig=!0,!e.isModel){if(n.isConfiguring){n._project=e;var a=n.crudManager;if(a){var s,u=a.isCrudManager,c=$M(i);try{for(c.s();!(s=c.n()).done;){var l=s.value;a[l]&&(n[l]=a[l],u||delete a[l])}}catch(e){c.e(e)}finally{c.f()}}n.getConfig("projectStores");var f,d=$M(o);try{for(d.s();!(f=d.n()).done;){var h=f.value;n.getConfig(h)}}catch(e){d.e(e)}finally{d.f()}}var v=e.eventStore;v&&!v.isEventStoreMixin&&v.autoLoad&&!v.count&&(v.autoLoad=!1,n.delayAutoLoad=!0),e=n._sharedProject||new n.projectModelClass(e),delete n._project}n.buildingProjectConfig=!1}return e}},{key:"updateProject",value:function(e,t){var n=this,r=n.projectListeners,i=n.crudManager;if(n.detachListeners("projectConsumer"),delete n._crudManager,e){r.thisObj=n,e.on(r),e.isCrudManager?n.crudManager=e:i&&(i.project=e,n.crudManager=i),n.projectSubscribers.forEach((function(t){return t.attachToProject(e)}));var o,a=$M(n.constructor.projectStoreNames);try{for(a.s();!(o=a.n()).done;){var s=o.value;n[s]=e[s]}}catch(e){a.e(e)}finally{a.f()}n.delayAutoLoad&&(e.eventStore.autoLoad=!0,e.eventStore.load())}n.trigger("projectChange",{project:e})}},{key:"changeCrudManager",value:function(e){if(!this.buildingProjectConfig)return we()(pe()(n.prototype),"changeCrudManager",this).call(this,e);this._crudManager=e.isCrudManager?e:Object.assign({},e)}},{key:"onProjectDataReady",value:function(){this.projectCallbacks.size&&(this.projectCallbacks.forEach((function(e){return e()})),this.projectCallbacks.clear())}},{key:"whenProjectReady",value:function(e){this.isEngineReady?e():this.projectCallbacks.add(e)}},{key:"doDestroy",value:function(){we()(pe()(n.prototype),"doDestroy",this).call(this),this.destroyStores&&!this.project.isDestroyed&&this.project.destroy()}},{key:"isEngineReady",get:function(){var e,t;return Boolean(null===(e=(t=this.project).isEngineReady)||void 0===e?void 0:e.call(t))}},{key:"projectStores",get:function(){var e=this;return this.constructor.projectStoreNames.map((function(t){return e[t]}))}},{key:"widgetClass",get:function(){}}],[{key:"setupProjectStores",value:function(e,t){var n=this,r=e.projectStores;if(r){var i={name:"projectConsumer",dataReady:"onProjectDataReady"},o={projectListeners:i},a=function(e){var a=r[e].dataName;o[e]=null,a&&Object.defineProperty(t.class.prototype,a,{get:function(){var t;return null===(t=this.project[e])||void 0===t?void 0:t.records},set:function(t){var n=this.project;this.buildingProjectConfig?n["".concat(a,"Data")]=t:n[e].data=t}}),n.createStoreDescriptor(t,e,r[e],i)};for(var s in r)a(s);this.setupConfigs(t,o)}}},{key:"createStoreDescriptor",value:function(e,t,n,r){var i=n.listeners,o=e.class.prototype,a=E.capitalize(t);r["".concat(t,"Change")]=function(e){var n=e.store;this[t]=n},o["change".concat(a)]=function(e,n){var r=this,o=r.project,s=e.project;return r.buildingProjectConfig?(s&&s.isProjectModel&&(r._sharedProject=s),void(o[t]=e)):(r.initializingProject||o[t]!==e&&(o["set".concat(a)](e),e=o[t]),e!==n&&(i&&(i.thisObj=r,i.name="".concat(t,"Listeners"),r.detachListeners(i.name),e.on(i)),r.projectSubscribers.forEach((function(n){n[t]!==e&&n["attachTo".concat(a)](e)}))),e)}}},{key:"$name",get:function(){return"ProjectConsumer"}},{key:"declarable",get:function(){return["projectStores"]}},{key:"configurable",get:function(){return{projectModelClass:HM,project:{},destroyStores:null,projectSubscribers:[]}}},{key:"projectStoreNames",get:function(){return Object.keys(this.projectStores)}},{key:"projectDataNames",get:function(){var e=this;return this.projectStoreNames.reduce((function(t,n){var r=e.projectStores[n].dataName;return r&&t.push(r),t}),[])}}]),n}(e||ue)};function WM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}function GM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var YM=Promise.resolve(),UM={block:"nearest",edgeOffset:20},qM={highlight:!1,focus:!1};function KM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}function XM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var ZM=["eventLayout","barMargin","mode","eventColor","eventStyle","fillTicks"];function JM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}function QM(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var eA=function(e){return e.preventDefault()},tA=function(e){return function(e){fe()(r,e);var t,n=QM(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"construct",value:function(e){var t=this;t.isInTimeAxis=t.isInTimeAxis.bind(t),t.onDeleteKey=t.throttle(t.onDeleteKey,t.onDeleteKeyBuffer,t),we()(pe()(r.prototype),"construct",this).call(this,e)}},{key:"changeNavigator",value:function(e){var t=this;return t.getConfig("subGridConfigs"),new _f(t.constructor.mergeConfigs({ownerCmp:t,target:t.timeAxisSubGridElement,processEvent:t.processEvent,itemSelector:".".concat(t.eventCls,"-wrap"),focusCls:t.focusCls,navigatePrevious:t.throttle(t.navigatePrevious,{delay:t.navigatePreviousBuffer,throttled:eA}),navigateNext:t.throttle(t.navigateNext,{delay:t.navigateNextBuffer,throttled:eA})},e))}},{key:"doDestroy",value:function(){this.navigator.destroy(),we()(pe()(r.prototype),"doDestroy",this).call(this)}},{key:"isInTimeAxis",value:function(e){return!e.instanceMeta(this).excluded&&this.timeAxis.isTimeSpanInAxis(e)}},{key:"accessibleFocusCell",value:function(e,t){if((e=this.normalizeCellContext(e)).columnId!==this.timeAxisColumn.id)return we()(pe()(r.prototype),"focusCell",this).call(this,e,t)}},{key:"normalizeTarget",value:function(e){return e.assignmentRecord}},{key:"getPrevious",value:function(e,t){var n=this,r=n.resourceStore,i=n.currentOrientation.eventSorter,o=n.timeAxis,a=o.startDate,s=o.endDate,u=e.event,c=n.eventStore.getEvents({resourceRecord:e.resource,startDate:a,endDate:s}).filter(this.isInTimeAxis).sort(i),l=e.resource,f=c[c.indexOf(u)-1];if(!f)for(var d=r.indexOf(l)-1;(!f||t&&f===u)&&d>=0;d--){l=r.getAt(d);var h=n.eventStore.getEvents({resourceRecord:l,startDate:a,endDate:s}).filter(n.isInTimeAxis).sort(i);f=h.length&&h[h.length-1]}return n.assignmentStore.getAssignmentForEventAndResource(f,l)}},{key:"navigatePrevious",value:function(e){var t=this.getPrevious(this.normalizeTarget(e));if(e.preventDefault(),t)return e.ctrlKey||this.clearEventSelection(),this.navigateTo(t,e)}},{key:"getNext",value:function(e,t){var n=this,r=n.resourceStore,i=n.currentOrientation.eventSorter,o=n.timeAxis,a=o.startDate,s=o.endDate,u=e.event,c=n.eventStore.getEvents({resourceRecord:e.resource,startDate:a,endDate:s}).filter(this.isInTimeAxis).sort(i),l=e.resource,f=c[c.indexOf(u)+1];if(!f)for(var d=r.indexOf(l)+1;(!f||t&&f===u)&&d<r.count;d++){l=r.getAt(d),f=n.eventStore.getEvents({resourceRecord:l,startDate:a,endDate:s}).filter(n.isInTimeAxis).sort(i)[0]}return n.assignmentStore.getAssignmentForEventAndResource(f,l)}},{key:"navigateNext",value:function(e){var t=this.getNext(this.normalizeTarget(e));if(e.preventDefault(),t)return e.ctrlKey||this.clearEventSelection(),this.navigateTo(t,e)}},{key:"navigateTo",value:(t=Wr()(Vr.a.mark((function e(t){var n,r,i=arguments;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=i.length>1&&void 0!==i[1]?i[1]:{},r=this,!t){e.next=7;break}return r.navigator.disabled=!0,e.next=6,r.scrollAssignmentIntoView(t,null,{animate:100});case 6:r.isDestroyed||(r.navigator.disabled=!1,r.activeAssignment=t,r.navigator.trigger("navigate",{event:n,item:Cr.up(r.getElementFromAssignmentRecord(t),r.navigator.itemSelector)}));case 7:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"processEvent",value:function(e){var t=this,n=Cr.up(e.target,t.eventSelector);return!t.navigator.disabled&&n&&(e.assignmentRecord=t.resolveAssignmentRecord(n),e.eventRecord=t.resolveEventRecord(n),e.resourceRecord=t.resolveResourceRecord(n)),e}},{key:"onDeleteKey",value:function(e){var t=this.eventStore.usesSingleAssignment?e.eventRecord:e.assignmentRecord;!this.readOnly&&this.enableDeleteKey&&t&&this.removeRecords([t])}},{key:"removeRecords",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!this.readOnly&&e.length){var n={finalize:function(){var n=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];t&&t(n),!1!==n&&e.forEach((function(e){e.isAssignment&&e.isOccurrenceAssignment?e.event.remove():e.remove()}))}};if(!1!==(e[0].isAssignment?this.trigger("beforeAssignmentDelete",{assignmentRecords:e,context:n}):this.trigger("beforeEventDelete",{eventRecords:e,context:n})))return n.finalize(),!0}return!1}},{key:"onEventSpaceKey",value:function(e){}},{key:"onEventEnterKey",value:function(e){}},{key:"activeAssignment",set:function(e){var t=this.getElementFromAssignmentRecord(e);this.navigator.activeItem=t.parentNode},get:function(){var e=this.navigator.activeItem;if(e)return this.resolveAssignmentRecord(e)}},{key:"previousActiveEvent",get:function(){var e=this.navigator.previousActiveItem;if(e)return this.resolveEventRecord(e)}},{key:"isActionableLocation",get:function(){if(!this.navigator.activeItem)return we()(pe()(r.prototype),"isActionableLocation",this)}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"EventNavigation"}},{key:"configurable",get:function(){return{navigator:{allowCtrlKey:!0,scrollSilently:!0,keys:{Space:"onEventSpaceKey",Enter:"onEventEnterKey",Delete:"onDeleteKey",Backspace:"onDeleteKey"}}}}},{key:"defaultConfig",get:function(){return{focusCls:"b-active",enableDeleteKey:!0,onDeleteKeyBuffer:500,navigatePreviousBuffer:200,navigateNextBuffer:200,testConfig:{onDeleteKeyBuffer:1}}}}]),r}(_a(e||ue))};function nA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var rA=function(e){return function(e){fe()(r,e);var t,n=nA(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"afterConstruct",value:(t=Wr()(Vr.a.mark((function e(){var t,n,i;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:we()(pe()(r.prototype),"afterConstruct",this).call(this),n=(t=this).client||t.grid,i=n.project,n.projectSubscribers.push(t),i&&(t.attachToProject(i),t.attachToResourceStore(i.resourceStore),t.attachToEventStore(i.eventStore),t.attachToAssignmentStore(i.assignmentStore),t.attachToDependencyStore(i.dependencyStore),t.attachToCalendarManagerStore(i.calendarManagerStore));case 4:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"attachToProject",value:function(e){this.detachListeners("project"),this._project=e}},{key:"attachToEventStore",value:function(e){this.detachListeners("eventStore"),this.eventStore=e}},{key:"attachToResourceStore",value:function(e){this.detachListeners("resourceStore"),this.resourceStore=e}},{key:"attachToAssignmentStore",value:function(e){this.detachListeners("assignmentStore"),this.assignmentStore=e}},{key:"attachToDependencyStore",value:function(e){this.detachListeners("dependencyStore"),this.dependencyStore=e}},{key:"attachToCalendarManagerStore",value:function(e){this.detachListeners("calendarManagerStore"),this.calendarManagerStore=e}},{key:"project",get:function(){return this._project}}],[{key:"$name",get:function(){return"AttachToProjectMixin"}}]),r}(e)};function iA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var oA=function(e){return function(e){fe()(n,e);var t=iA(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"getElementFromAssignmentRecord",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this.scheduler.isPainted&&e){var n,r=this.scheduler.foregroundCanvas.syncIdMap[e.id];return t?r:null==r||null===(n=r.syncIdMap)||void 0===n?void 0:n.event}return null}},{key:"getElementFromEventRecord",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.resource,n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.assignmentStore.getAssignmentForEventAndResource(e,t);return this.getElementFromAssignmentRecord(r,n)}},{key:"getElementsFromEventRecord",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this;return t?[r.getElementFromEventRecord(e,t,n)]:e.resources.reduce((function(t,i){var o=r.getElementFromEventRecord(e,i,n);return o&&t.push(o),t}),[])}}]),n}(e||ue)};function aA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var sA={releaseElement:1,reuseElement:1},uA={newElement:1,reuseOwnElement:1,reuseElement:1},cA=function(e,t){return e.startDateMS-t.startDateMS},lA={startDate:1,endDate:1,duration:1};function fA(e,t,n,r,i){if(e.fillTicks){var o=t.getTickFromDate(n);if(o>=0){i&&o===Math.round(o)&&o>0&&o--;var a=Math.floor(o);return t.getAt(a)[i?"endDate":"startDate"].getTime()}}return r}var dA=function(e){fe()(n,e);var t=aA(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e){var t=this;t.client=t.scheduler=e,t.eventSorter=t.eventSorter.bind(e),e.rowManager.on({name:"rowManager",renderDone:"onRenderDone",removeRows:"onRemoveRows",translateRow:"onTranslateRow",beforeRowHeight:"onBeforeRowHeightChange",thisObj:t}),t.toDrawOnProjectRefresh=new Set,t.toDrawOnDataReady=new Set,we()(pe()(n.prototype),"construct",this).call(this,{})}},{key:"init",value:function(){}},{key:"getDateFromXY",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=e[0];return n||(i=this.translateToScheduleCoordinate(i)),this.scheduler.timeAxisViewModel.getDateFromPosition(i,t,r)}},{key:"translateToScheduleCoordinate",value:function(e){return e-Math.floor(this.scheduler.timeAxisSubGridElement.getBoundingClientRect().left)+this.scheduler.scrollLeft}},{key:"translateToPageCoordinate",value:function(e){var t=this.scheduler.timeAxisSubGridElement;return e+t.getBoundingClientRect().left-t.scrollLeft}},{key:"getScheduleRegion",value:function(e,t){var n,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],i=this,o=i.scheduler,a=o.timeAxisSubGridElement,s=o.timeAxis;if(e){var u=t&&i.getElementsFromEventRecord(t,e)[0];if(n=En.from(o.getRowById(e.id).getElement("locked")),u){var c=En.from(u,a);n.y=c.y,n.bottom=c.bottom}else n.y=n.y+o.resourceMargin,n.bottom=n.bottom-o.resourceMargin}else(n=En.from(a).moveTo(null,0)).width=a.scrollWidth,n.y=n.y+o.resourceMargin,n.bottom=n.bottom-o.resourceMargin;var l=s.startDate,f=s.endDate,d=o.getDateConstraints(e,t)||{start:l,end:f},h=o.getCoordinateFromDate(Zt.max(l,d.start)),v=o.getCoordinateFromDate(Zt.min(f,d.end));return r||(h=i.translateToPageCoordinate(h),v=i.translateToPageCoordinate(v)),n.left=Math.min(h,v),n.right=Math.max(h,v),n}},{key:"getRowRegion",value:function(e,t,n){var r=this.scheduler,i=r.timeAxis,o=r.getRowById(e.id);if(!o)return null;var a=i.startDate,s=i.endDate,u=t?Zt.max(a,t):a,c=n?Zt.min(s,n):s,l=r.getCoordinateFromDate(u),f=r.getCoordinateFromDate(c,!0,!0),d=o.top,h=Math.min(l,f),v=d+o.offsetHeight;return new En(h,d,Math.max(l,f)-h,v-d)}},{key:"getResourceEventBox",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this.resourceMap.get(t.id),o=null,a=!1;if(i&&(o=i.eventsData.find((function(t){return t.eventRecord===e}))),o||(o=this.getTimeSpanRenderData(e,t,{viewport:!0,timeAxis:n}),a=!0),o){var s=this.scheduler.getRecordCoords(t,!0,r),u=o.top+s.top,c=new En(o.left,u,o.width,o.height);return a&&(c.layout=!1),c.rowTop=s.top,c.rowBottom=s.bottom,c}return null}},{key:"resolveRowRecord",value:function(e){var t=this.scheduler,n=e instanceof Event?e.target:e,r=3===n.nodeType?n.parentElement:n,i=Cr.up(r,t.eventSelector);return i?this.resourceStore.getById(i.dataset.resourceId):t.getRecordFromElement(r)}},{key:"attachToProject",value:function(e){we()(pe()(n.prototype),"attachToProject",this).call(this,e),this.refreshAllWhenReady=!0,e&&e.on({name:"project",refresh:"onProjectRefresh",dataReady:"onProjectDataReady",thisObj:this})}},{key:"onProjectDataReady",value:function(){var e=this.scheduler,t=this.toDrawOnDataReady;e.refreshSuspended||(t.size&&(this.clearResources(t),this.refreshResources(t)),t.clear())}},{key:"onProjectRefresh",value:function(){var e=this,t=e.scheduler,n=e.toDrawOnProjectRefresh;t.refreshSuspended||(e.refreshAllWhenReady?(t.calculateAllRowHeights(!0),t.rowManager.topRow?(e.clearAll(),t.refreshWithTransition(!1,!e.isFirstRefresh),e.isFirstRefresh=!1):t.rowManager.reinitialize(),e.refreshAllWhenReady=!1):n.size&&e.refreshResources(n),n.clear())}},{key:"attachToAssignmentStore",value:function(e){this.refreshAllWhenReady=!0,we()(pe()(n.prototype),"attachToAssignmentStore",this).call(this,e),e&&e.on({name:"assignmentStore",changePreCommit:"onAssignmentStoreChange",refreshPreCommit:"onAssignmentStoreRefresh",thisObj:this})}},{key:"onAssignmentStoreChange",value:function(e){var t=e.action,n=e.records,r=e.replaced,i=e.record,o=e.changes,a=this,s=new Set((n||(i?[i]:[])).map((function(e){return e.resourceId})));if(!a.resourceStore.isRemoving&&!a.resourceStore.isChangingId){switch(t){case"dataset":return void(a.eventStore.usesSingleAssignment||a.refreshResourcesWhenReady(s));case"add":case"remove":case"updateMultiple":return void a.refreshResourcesWhenReady(s);case"removeall":return void(a.refreshAllWhenReady=!0);case"replace":return r.forEach((function(e){var t=ye()(e,2),n=t[0],r=t[1];s.add(n.resourceId),s.add(r.resourceId)})),void a.refreshResourcesWhenReady(s);case"filter":return a.clearAll(),a.scheduler.calculateAllRowHeights(!0),void a.scheduler.refreshWithTransition();case"update":("eventId"in o||"resourceId"in o)&&("resourceId"in o&&s.add(o.resourceId.oldValue),a.refreshResources(s,!0))}}}},{key:"onAssignmentStoreRefresh",value:function(e){e.action,e.records}},{key:"attachToEventStore",value:function(e){this.refreshAllWhenReady=!0,we()(pe()(n.prototype),"attachToEventStore",this).call(this,e),e&&e.on({name:"eventStore",refreshPreCommit:"onEventStoreRefresh",thisObj:this})}},{key:"onEventStoreRefresh",value:function(e){"batch"===e.action&&this.scheduler.isEngineReady&&(this.clearAll(),this.scheduler.refreshWithTransition())}},{key:"onEventStoreChange",value:function(e){var t=e.action,n=e.records,r=e.record,i=e.replaced,o=e.changes,a=this,s=n||(r?[r]:[]),u=s[0]&&s[0].isResourceTimeRange,c=new Set;if(s.forEach((function(e){var t;null===(t=e.resources)||void 0===t||t.forEach((function(e){return c.add(e.id)}))})),u)a.refreshResources(c);else{switch(t){case"batch":case"sort":case"group":case"move":case"remove":return;case"clearchanges":case"dataset":return a.clearAll(),void(a.refreshAllWhenReady=!0);case"add":case"updateMultiple":break;case"replace":i.forEach((function(e){ye()(e,2)[1].resources.map((function(e){return c.add(e.id)}))}));break;case"removeall":case"filter":return a.scheduler.isEngineReady?(a.clearAll(),a.scheduler.calculateAllRowHeights(!0),void a.scheduler.refreshWithTransition()):void(a.refreshAllWhenReady=!0);case"update":var l,f=r.$entity?!Object.keys(o).some((function(e){return!r.$entity.getField(e)})):!Object.keys(o).some((function(e){return!lA[e]})),d=0;if("startDate"in o&&d++,"endDate"in o&&d++,"duration"in o&&d++,"resourceId"in o&&c.add(o.resourceId.oldValue),!f||d&&(!("duration"in o)||1!==d)||"percentDone"in o)(null===(l=a.project)||void 0===l?void 0:l.propagatingLoadChanges)?c.forEach((function(e){return a.toDrawOnDataReady.add(e)})):a.refreshResources(c);return}a.refreshResourcesWhenReady(c)}}},{key:"attachToResourceStore",value:function(e){this.refreshAllWhenReady=!0,we()(pe()(n.prototype),"attachToResourceStore",this).call(this,e),e&&e.on({name:"resourceStore",changePreCommit:"onResourceStoreChange",thisObj:this})}},{key:"onResourceStoreChange",value:function(e){var t=e.action,n=e.isExpand,r=e.record,i=e.records,o=e.changes,a=this,s=r?[r.id]:null==i?void 0:i.map((function(e){return e.id}));switch(t){case"add":return void(n||a.refreshResourcesWhenReady(s));case"update":return void(a.project.isBatchingChanges||o.isLeaf||a.refreshResources(s));case"filter":return;case"removeall":return void a.clearAll()}a.clearResources(s)}},{key:"onTranslateRow",value:function(e){var t=e.row;null!=t.id&&this.refreshRow(t,!1)}},{key:"calculateRowHeight",value:function(e){var t=this.scheduler;if("stack"===t.eventLayout&&t.isEngineReady&&!e.isSpecialRow&&e.events.length>1){var n=t.assignmentStore,r=t.eventStore,i=t.timeAxis,o=t.resourceMargin,a=t.barMargin,s=t.rowHeight-2*o,u=r.getEvents({resourceRecord:e,includeOccurrences:t.enableRecurringEvents,startDate:i.startDate,endDate:i.endDate,filter:function(t){return t.assignments.some((function(t){return t.resource===e&&n.includes(t)}))}}).sort(cA).map((function(e){return{eventRecord:e,startMS:e.startDateMS,endMS:e.endDate?e.endDateMS:e.startDateMS}})),c=t.currentEventLayout.layoutEventsInBands(u);return c*s+(c-1)*a+2*o}return t.rowHeight}},{key:"doUpdateTimeView",value:function(){this.updateFromHorizontalScroll(this.scheduler.timeAxisSubGrid.scrollable.x)}},{key:"onTimeAxisViewModelUpdate",value:function(){this.clearAll(),this.scheduler.refreshSuspended&&this.scheduler.on({resumeRefresh:function(){this.scheduler.isEngineReady&&this.doUpdateTimeView()},thisObj:this,once:!0}),this.doUpdateTimeView()}},{key:"getConnectorStartSide",value:function(e){return"left"}},{key:"getConnectorEndSide",value:function(e){return"right"}},{key:"refreshRows",value:function(e){e&&this.clearAll()}},{key:"onLocaleChange",value:function(){this.clearAll()}},{key:"onViewportResize",value:function(){}},{key:"onDragAbort",value:function(e){var t=e.context,n=e.dragData;this.resourceStore.indexOf(n.record.resource)<this.scheduler.topRow.dataIndex&&t.element.remove()}},{key:"toggleCls",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this.getElementFromAssignmentRecord(e,r),o=this.resourceMap.get(e.isModel?e.get("resourceId"):e.resourceId),a=null==o?void 0:o.eventsData.find((function(t){return t.eventId===e.eventId}));a&&(a[r?"wrapperCls":"cls"][t]=n),i&&(i.classList[n?"add":"remove"](t),i.lastDomConfig.className[t]=n)}},{key:"onRemoveRows",value:function(e){var t=this;e.rows.forEach((function(e){return t.rowMap.delete(e)})),this.onRenderDone()}},{key:"updateFromHorizontalScroll",value:function(e){var t=this,n=this.scheduler,r=n.timeAxisSubGrid,i=n.timeAxis,o=r.width,a=r.scrollable.maxX<=Math.round(e)+5,s=n.getDateFromCoordinate(Math.max(0,e-this.scrollBuffer)),u=a?i.endDate:n.getDateFromCoordinate(e+o+this.scrollBuffer)||i.endDate;if(s&&(this._visibleDateRange={startDate:s,endDate:u,startMS:s.getTime(),endMS:u.getTime()},n.timeView.range={startDate:s,endDate:u},n.trigger("visibleRangeChange",{startDate:s,endDate:u}),!n.refreshSuspended&&n.rowManager.rows.length)){if(null===n.rowManager.rows[0].id)return;n.rowManager.rows.forEach((function(e){return t.refreshRow(e,!1)})),this.onRenderDone()}}},{key:"repaintEventsForResource",value:function(e){this.refreshResources([e.id])}},{key:"onBeforeRowHeightChange",value:function(e){var t=this.scheduler,n=e?e.height:t.rowHeight;this.clearAll(),t.foregroundCanvas&&(t.foregroundCanvas.style.fontSize="".concat(n-2*t.resourceMargin,"px"))}},{key:"refreshResourcesWhenReady",value:function(e){var t=this;this.clearResources(e),e.forEach((function(e){return t.toDrawOnProjectRefresh.add(e)}))}},{key:"refreshResources",value:function(e){var t=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this,i=r.scheduler,o=[],a=[];r.clearResources(e),i.refreshSuspended||(e.forEach((function(e){var t=i.getRowById(e);t?o.push(t):a.push(t)})),i.runWithTransition((function(){i.calculateRowHeights(a.map((function(e){return t.resourceStore.getById(e)})),!0),i.rowManager.renderRows(o)}),n))}},{key:"layoutEventVerticallyStack",value:function(e){var t=this.scheduler,n=t.resourceMargin,r=t.rowHeight,i=t.barMargin;return 0===e?n:n+e*(r-2*n)+e*i}},{key:"layoutEventVerticallyPack",value:function(e,t){var n=this.scheduler,r=n.resourceMargin,i=n.rowHeight,o=n.barMargin,a=1/t,s=e*a,u=(i-2*r-(a-1)*o)*t;return{top:r+s*u+s*o,height:u}}},{key:"addTemporaryDragElement",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:e.resource,n=this.scheduler,r=n.generateRenderData(e,t,{timeAxis:!0,viewport:!0});r.absoluteTop=r.row?r.top+r.row.top:n.getResourceEventBox(e,t,!0).top;var i=this.renderEvent(r),o=i.dataset;delete i.tabIndex,delete o.eventId,delete o.resourceId,delete o.syncId,o.transient=!0,i.parent=this.scheduler.foregroundCanvas,i.retainElement=!0;var a=Cr.createElement(i);return a.innerElement=a.firstChild,e.instanceMeta(n).hasTemporaryDragElement=!0,a}},{key:"eventSorter",value:function(e,t){if(this.horizontalEventSorterFn)return this.horizontalEventSorterFn(e.eventRecord||e,t.eventRecord||t);var n=e.isModel?e.startDateMS:e.dataStartMS||e.startMS,r=e.isModel?e.endDateMS:e.dataEndMS||e.endMS,i=t.isModel?t.startDateMS:t.dataStartMS||t.startMS,o=t.isModel?t.endDateMS:t.dataEndMS||t.endMS,a=e.isModel?e.name:e.eventRecord.name,s=t.isModel?t.name:t.eventRecord.name;return n-i||o-r||(a<s?-1:a==s?0:1)}},{key:"calculateMS",value:function(e){var t=this.scheduler,n=t.timeAxis,r=t.timeAxisViewModel,i=fA(t,n,e.startDate,e.startDateMS,!1),o=fA(t,n,e.endDate,e.endDateMS,!0),a=o-i;if("default"!==t.milestoneLayoutMode&&0===a){var s=r.getSingleUnitInPixels("minute");switch(a=60*(t.getMilestoneLabelWidth(e)*(1/s))*1e3,t.milestoneAlign){case"start":case"left":o=i+a;break;case"end":case"right":i=(o=i)-a;break;default:i=(o=i+a/2)-a}}return{startMS:i,endMS:o,durationMS:a}}},{key:"getTimeSpanRenderData",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.scheduler,o=i.timeAxis,a=i.timeAxisViewModel,s=!0===n||n.timeAxis,u=!0===n||n.viewport;if(s||o.isTimeSpanInAxis(e)){var c=i.getRowById(t);if(c||u){var l,f=a.getSingleUnitInPixels("minute"),d=e.startDate,h=e.endDate||d,v=o.startMS,p=o.endMS,g=r.calculateMS(e),y=g.startMS,m=g.endMS,k=g.durationMS,b=y<v|(y>p)<<1,w=m>p|(m<=v)<<1,C=k/6e4,S=w?f*C:null,D=i.getCoordinateFromDate(m,{local:!0,respectExclusion:!0,isEnd:!0}),R=!1,x=!1;if(b?l=(y-v)/6e4*f:R=-1===(l=i.getCoordinateFromDate(y,{local:!0,respectExclusion:!0,isEnd:!1,snapToNextIncluded:-1!==D})),w?D=l+S:x=-1===D,x&&!R&&(D=i.getCoordinateFromDate(m,{local:!0,respectExclusion:!0,isEnd:!0,snapToNextIncluded:!0})),S>9999999&&(1===b?1===w?(l=-100,D=i.timeAxisColumn.width+100):l=D-9999999:1===w&&(D=l+9999999)),R&&x&&(l=i.getCoordinateFromDate(y,{local:!0,respectExclusion:!0,isEnd:!1,snapToNextIncluded:!0,max:m}))===(D=i.getCoordinateFromDate(m,{local:!0,respectExclusion:!0,isEnd:!0,snapToNextIncluded:!0,min:y})))return e.instanceMeta(i).excluded=!0,null;var E={eventRecord:e,taskRecord:e,left:Math.min(l,D),width:Math.abs(D-l)||(e.isMilestone?0:1),start:d,end:h,rowId:t.id,children:[],startMS:y,endMS:m,startsOutsideView:b,endsOutsideView:w,clippedStart:R,clippedEnd:x,row:c};return i.fillTicks&&(E.dataStartMS=E.start.getTime(),E.dataEndMS=E.end.getTime()),E.top=Math.max(0,i.resourceMargin),i.managedEventSizing&&(E.height=Math.max(i.rowManager.rowHeight-2*i.resourceMargin,1)),E}}}},{key:"layoutResourceEvents",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this,r=n.scheduler,i=r.eventStore,o=r.assignmentStore,a=r.timeAxis,s=i.getEvents({includeOccurrences:r.enableRecurringEvents,resourceRecord:e,startDate:a.startDate,endDate:a.endDate,filter:function(t){return t.assignments.some((function(t){return t.resource===e&&o.includes(t)}))}}),u=r.getEventsToRender(e,s)||[],c=u.reduce((function(n,i){if(t||a.isTimeSpanInAxis(i)){var o=r.generateRenderData(i,e,!1);o&&n.push(o)}return n}),[]);c.sort(n.eventSorter);var l=r.rowHeight,f=r.currentEventLayout,d=c.filter((function(e){return e.eventRecord.isEvent}));if("stack"===r.eventLayout){var h=f.applyLayout(d,e),v=r.rowHeight-2*r.resourceMargin;l=h*v+(h-1)*r.barMargin+2*r.resourceMargin}else"pack"===r.eventLayout&&f.applyLayout(d,e);return{rowHeight:l,eventsData:c}}},{key:"renderEvent",value:function(e,t){var n=this.scheduler,r=e.resourceRecord,i=e.assignmentRecord,o=e.eventRecord,a=i?this.assignmentStore.getOccurrence(i,o).id:e.eventId,s={className:e.wrapperCls,tabIndex:"0",children:[{className:e.cls,style:e.style||"",children:e.children,dataset:{taskFeature:"event"},syncOptions:{syncIdField:"taskBarFeature"}}].concat(d()(e.wrapperChildren)),style:{transform:"translate(".concat(e.left,"px, ").concat(e.absoluteTop,"px)"),height:e.fillSize?t:e.height,width:e.width>0?e.width:null,zIndex:e.zIndex,style:e.wrapperStyle},dataset:{resourceId:r.id,eventId:e.eventId,syncId:a},elementData:e,retainElement:(i||o).instanceMeta(n).retainElement,syncOptions:{syncIdField:"taskFeature",releaseThreshold:0}};return i&&(s.dataset.assignmentId=i.id),e.elementConfig=s,n.trigger("beforeRenderEvent",{renderData:e,domConfig:s}),s}},{key:"refreshRow",value:function(e){var t,n,r=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];e.isModel?(t=this.scheduler.rowManager.getRowFor(e),n=e):(t=e,n=this.resourceStore.getById(e.id)),r&&this.clearResources([e]),t&&(this.renderer({row:t,record:n}),r&&this.onRenderDone())}},{key:"renderer",value:function(e){var t=e.row,n=e.record,r=e.size,i=void 0===r?{}:r;if(n.isSpecialRow)this.rowMap.delete(t);else{var o=this,a=o.visibleDateRange,s=a.startMS,u=a.endMS,c=[],l=o.resourceMap.get(n.id);if(!l||l.invalid){if(o.suspended)return;l=o.layoutResourceEvents(n),o.resourceMap.set(n.id,l)}i.height=l.rowHeight,l.eventsData.forEach((function(e){e.endMS>=s&&e.startMS<=u&&(e.absoluteTop=e.top+t.top,c.push(o.renderEvent(e,l.rowHeight)))})),this.rowMap.set(t,c)}}},{key:"onRenderDone",value:function(){var e=this.scheduler,t=this.rowMap,n=[];t.forEach((function(e){return n.push.apply(n,e)})),Gs.sync({domConfig:{onlyChildren:!0,children:n},targetElement:e.foregroundCanvas,syncIdField:"syncId",callback:function(t){var n,r=t.action,i=t.domConfig,o=t.lastDomConfig,a=t.targetElement;if("none"!==r&&(null==i||null===(n=i.className)||void 0===n?void 0:n["".concat(e.eventCls,"-wrap")])){var s=uA[r];if(sA[r]&&(null==o?void 0:o.elementData)){var u=o.elementData,c=u.eventRecord,l=u.resourceRecord,f=u.assignmentRecord,d={renderData:o.elementData,element:a,eventRecord:c,resourceRecord:l,assignmentRecord:f};a===document.activeElement&&e.focusElement.focus(),e.trigger("releaseEvent",d)}if(s){var h=i.elementData,v=h.eventRecord,p=h.resourceRecord,g=h.assignmentRecord,y={renderData:i.elementData,tplData:i.elementData,element:a,isReusingElement:"reuseElement"===r,isRepaint:"reuseOwnElement"===r,eventRecord:v,resourceRecord:p,assignmentRecord:g};e.trigger("renderEvent",y)}}}})}},{key:"clearResources",value:function(e){var t=this;e instanceof Set?e=Array.from(e):Array.isArray(e)||(e=[e]),e.map(Bi.asId).forEach((function(e){var n=t.resourceMap.get(e);n&&(n.invalid=!0);var r=t.scheduler.getRowById(e);r&&t.rowMap.delete(r)}))}},{key:"clearAll",value:function(){this.resourceMap.clear(),this.rowMap.clear()}},{key:"visibleDateRange",get:function(){return this._visibleDateRange}}],[{key:"configurable",get:function(){return{scrollBuffer:0}}},{key:"properties",get:function(){return{resourceMap:new Map,rowMap:new Map,eventConfigs:[],isFirstRefresh:!0}}}]),n}(ue.mixin(oA,rA));function hA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}dA._$name="HorizontalRendering";var vA=function(e){fe()(n,e);var t=hA(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"applyLayout",value:function(e,t,r,i,o){var a=this;we()(pe()(n.prototype),"applyLayout",this).call(this,e,(function(e,n,o,s){if("none"===a.scheduler.eventLayout)e.width=t-2*r,e.left+=r;else{e.widthFactor=s;var u=e.leftFactor=o.start+n*s,c=Math.round(1/s),l=u/s,f=t-2*r-i*(c-1);"mixed"===a.scheduler.eventLayout&&2===c?(e.left+=u*t/5+i,e.width=t-u*t/5-2*i,e.zIndex=5+l):(e.width=s*f,e.left+=u*f+r+i*l)}}))}}],[{key:"defaultConfig",get:function(){return{coordProp:"leftFactor",sizeProp:"widthFactor"}}}]),n}(BT());function pA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}vA._$name="VerticalLayout";var gA={releaseElement:1,reuseElement:1},yA={newElement:1,reuseOwnElement:1,reuseElement:1},mA={startDate:1,endDate:1,duration:1},kA=function(e){fe()(n,e);var t=pA(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e){this.client=this.scheduler=e,this.timeAxisViewModel=e.timeAxisViewModel,this.verticalLayout=new vA({scheduler:e}),we()(pe()(n.prototype),"construct",this).call(this,{})}},{key:"init",value:function(){var e=this,t=e.scheduler;e.resourceColumns=t.timeAxisColumn.resourceColumns,e.resourceColumns.resourceStore=e.resourceStore,t.element.classList.add("b-sch-vertical"),e.resourceColumns.on({name:"resourceColumns",columnWidthChange:"onResourceColumnWidthChange",thisObj:e}),e.initialized=!0,t.isPainted&&e.renderer(),e.resourceColumns.availableWidth=t.timeAxisSubGridElement.offsetWidth}},{key:"resolveRowRecord",value:function(e,t){var n=this.scheduler,r=e instanceof Event?e:null,i=r?r.target:e,o=r?[r.offsetX,r.offsetY]:t,a=3===i.nodeType?i.parentElement:i,s=Cr.up(a,n.eventSelector);if(s)return n.resourceStore.getById(s.dataset.resourceId);if(!Cr.up(i,".b-sch-timeaxis-cell"))return null;if(!o)throw new Error("Vertical mode needs coordinates to resolve this element. Can also be called with a browser\n                event instead of element to extract element and coordinates from");var u=Math.floor(o[0]/this.resourceColumns.columnWidth);return n.resourceStore.getAt(u)}},{key:"toggleCls",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=an.getPath(this.eventMap,"".concat(e.eventId,".").concat(e.resourceId));if(i){i.renderData[r?"wrapperCls":"cls"][t]=n;var o=this.getElementFromAssignmentRecord(e,r);o&&o.classList[n?"add":"remove"](t)}}},{key:"getDateFromXY",value:function(e,t,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=e[1];return n||(i=this.translateToScheduleCoordinate(i)),this.timeAxisViewModel.getDateFromPosition(i,t,r)}},{key:"translateToScheduleCoordinate",value:function(e){return e-this.scheduler._bodyRectangle.y+this.scheduler.scrollTop}},{key:"translateToPageCoordinate",value:function(e){return e+this.scheduler._bodyRectangle.y-this.scheduler.scrollTop}},{key:"getResourceEventBox",value:function(e,t){var n=e.id,r=t.id,i=(an.getPath(this.eventMap,"".concat(n,".").concat(r))||{}).renderData;return i||(this.layoutResource(this.scheduler.resourceStore.getById(r)),i=an.getPath(this.eventMap,"".concat(n,".").concat(r)).renderData),i?new En(i.left,i.top,i.width,i.bottom-i.top):null}},{key:"getScheduleRegion",value:function(e,t,n){var r=this.scheduler,i=En.from(r.timeAxisSubGridElement);e&&(i.left=this.resourceStore.indexOf(e)*r.resourceColumnWidth,i.right=i.left+r.resourceColumnWidth);var o=r.timeAxis.startDate,a=r.timeAxis.endDate,s=r.getDateConstraints(e,t)||{start:o,end:a},u=r.getCoordinateFromDate(Zt.max(o,s.start)),c=r.getCoordinateFromDate(Zt.min(a,s.end));return n?(i.top=u,i.bottom=c):(i.top=this.translateToPageCoordinate(u),i.bottom=this.translateToPageCoordinate(c)),i}},{key:"getRowRegion",value:function(e,t,n){var r=this.scheduler,i=this.resourceStore.indexOf(e)*r.resourceColumnWidth,o=r.timeAxis.startDate,a=r.timeAxis.endDate,s=t?Zt.max(o,t):o,u=n?Zt.min(a,n):a,c=r.getCoordinateFromDate(s),l=r.getCoordinateFromDate(u,!0,!0),f=Math.min(c,l),d=Math.abs(c-l);return new En(i,f,r.resourceColumnWidth,d)}},{key:"onResourceColumnWidthChange",value:function(e){var t=e.width,n=e.oldWidth,r=this,i=r.scheduler;r.resourceColumns.width=i.timeAxisColumn.width=r.resourceStore.count*t,r.clearAll(),r.refresh(Math.abs(t-n)>30)}},{key:"attachToProject",value:function(e){we()(pe()(n.prototype),"attachToProject",this).call(this,e),e&&e.on({name:"project",refresh:"onProjectRefresh",thisObj:this})}},{key:"onProjectRefresh",value:function(){var e=this,t=e.scheduler,n=e.toDrawOnProjectRefresh;t.rendered&&!t.refreshSuspended&&(e.refreshAllWhenReady?(e.clearAll(),e.refresh(),e.refreshAllWhenReady=!1):n.size&&e.refresh(),n.clear())}},{key:"attachToEventStore",value:function(e){we()(pe()(n.prototype),"attachToEventStore",this).call(this,e),this.refreshAllWhenReady=!0,e&&e.on({name:"eventStore",refreshPreCommit:"onEventStoreRefresh",thisObj:this})}},{key:"onEventStoreRefresh",value:function(e){"batch"===e.action&&(this.refreshAllWhenReady=!0)}},{key:"onEventStoreChange",value:function(e){var t=e.action,n=e.records,r=e.record,i=e.replaced,o=e.changes,a=(e.isAssign,this),s=n||(r?[r]:[]),u=new Set;switch(s.forEach((function(e){e.resources.forEach((function(e){return u.add(e.id)}))})),t){case"sort":case"group":case"move":case"remove":return;case"dataset":return void a.refreshAllResourcesWhenReady();case"add":case"updateMultiple":break;case"replace":i.forEach((function(e){ye()(e,2)[1].resources.map((function(e){return u.add(e.id)}))})),a.clearResources(u);break;case"removeall":case"filter":return a.clearAll(),void a.refresh();case"update":var c=0;return"startDate"in o&&c++,"endDate"in o&&c++,"duration"in o&&c++,void((!(r.$entity?!Object.keys(o).some((function(e){return!r.$entity.getField(e)})):!Object.keys(o).some((function(e){return!mA[e]})))||c>1)&&(a.clearResources(u),a.refresh()))}a.refreshResourcesWhenReady(u)}},{key:"attachToResourceStore",value:function(e){var t=this;we()(pe()(n.prototype),"attachToResourceStore",this).call(this,e),t.refreshAllWhenReady=!0,t.resourceColumns&&(t.resourceColumns.resourceStore=e),e.on({name:"resourceStore",changePreCommit:"onResourceStoreChange",refreshPreCommit:"onResourceStoreRefresh",load:function(){return t.scheduler.unmaskBody()},thisObj:t,prio:1}),t.initialized&&(t.firstResource=t.lastResource=null,t.clearAll(),t.renderer())}},{key:"onResourceStoreChange",value:function(e){var t=e.source,n=e.action,r=e.records,i=e.record,o=e.replaced,a=e.changes,s=this,u=r||(o?o.map((function(e){return e[1]})):i?[i]:[]),c=new Set(u.map((function(e){return e.id})));if(s.firstResource=s.lastResource=null,s.scheduler.isEngineReady){switch(n){case"update":a&&a.id&&s.clearResources([a.id.oldValue,a.id.value]);break;case"filter":s.clearAll()}s.refresh(!0)}else{switch(n){case"dataset":case"remove":case"removeall":return void s.refreshAllResourcesWhenReady();case"replace":case"add":for(var l=u.reduce((function(e,n){return Math.min(e,t.indexOf(n))}),t.count);l<t.count;l++)c.add(t.getAt(l).id)}s.refreshResourcesWhenReady(c)}}},{key:"onResourceStoreRefresh",value:function(e){var t=e.action;if("group"===t)throw new Error("Grouping of resources not supported in vertical mode");"sort"===t&&(this.firstResource=this.lastResource=null,this.clearAll(),this.refresh())}},{key:"attachToAssignmentStore",value:function(e){we()(pe()(n.prototype),"attachToAssignmentStore",this).call(this,e),this.refreshAllWhenReady=!0,e&&e.on({name:"assignmentStore",changePreCommit:"onAssignmentStoreChange",refreshPreCommit:"onAssignmentStoreRefresh",thisObj:this})}},{key:"onAssignmentStoreChange",value:function(e){var t=e.action,n=e.records,r=e.replaced,i=e.record,o=e.changes,a=this,s=new Set((n||(i?[i]:[])).map((function(e){return e.resourceId})));if(a.scheduler.isEngineReady){switch(t){case"filter":a.clearAll();break;case"update":if("resourceId"in o&&s.add(o.resourceId.oldValue),!Object.keys(o).filter((function(e){return"resource"!==e&&"event"!==e})).length)return;a.clearResources(s)}a.refresh(!0)}else{switch(t){case"removeall":return void a.refreshAllResourcesWhenReady();case"replace":r.forEach((function(e){var t=ye()(e,2),n=t[0],r=t[1];s.add(n.resourceId),s.add(r.resourceId)}))}a.refreshResourcesWhenReady(s)}}},{key:"onAssignmentStoreRefresh",value:function(e){var t=e.action,n=e.records;"batch"===t&&(this.clearResources(n.map((function(e){return e.resourceId}))),this.renderer())}},{key:"refreshRows",value:function(e){e&&(this.clearAll(),this.scheduler.refreshFromRerender=!1)}},{key:"repaintEventsForResource",value:function(e){this.renderResource(e)}},{key:"updateFromHorizontalScroll",value:function(e){e!==this.prevScrollLeft&&(this.renderer(),this.prevScrollLeft=e)}},{key:"updateFromVerticalScroll",value:function(){this.renderer()}},{key:"scrollResourceIntoView",value:function(e,t){var n=this.scheduler,r=n.resourceStore.indexOf(e)*n.resourceColumnWidth;return n.scrollHorizontallyTo(r,t)}},{key:"onViewportResize",value:function(e){this.resourceColumns.availableWidth=e,this.renderer()}},{key:"onLocaleChange",value:function(){this.clearAll()}},{key:"onDragAbort",value:function(){}},{key:"onBeforeRowHeightChange",value:function(){}},{key:"onTimeAxisViewModelUpdate",value:function(){}},{key:"updateElementId",value:function(){}},{key:"releaseTimeSpanDiv",value:function(){}},{key:"refreshResourcesWhenReady",value:function(e){var t=this;this.clearResources(e),e.forEach((function(e){return t.toDrawOnProjectRefresh.add(e)}))}},{key:"refreshAllResourcesWhenReady",value:function(){this.clearAll(),this.refreshAllWhenReady=!0}},{key:"getTimeSpanRenderData",value:function(e,t){var n=this,r=n.scheduler,i=e.startDate,o=e.endDate,a=r.getCoordinateFromDate(i),s=n.resourceStore.indexOf(t)*r.resourceColumnWidth,u=r.resourceColumnWidth-2*r.resourceMargin,c=i.getTime(),l=o.getTime(),f=r.getCoordinateFromDate(o),d=f-a;return-1===f&&(f=a+(d=Math.round((l-c)*r.timeAxisViewModel.getSingleUnitInPixels("ms")))),{eventRecord:e,resourceRecord:t,left:s,top:a,bottom:f,width:u,height:d,startDate:i,endDate:o,startDateMS:c,endDateMS:l,children:[],start:i,end:o,startMs:c,endMs:l}}},{key:"eventSorter",value:function(e,t){var n=e.dataStartMs||e.startDateMS,r=e.dataEndMs||e.endDateMS,i=t.dataStartMs||t.startDateMS,o=t.dataEndMs||t.endDateMS,a=e.isModel?e.name:e.eventRecord.name,s=t.isModel?t.name:t.eventRecord.name;return n-i||o-r||(a<s?-1:a==s?0:1)}},{key:"layoutResource",value:function(e){var t=this,n=t.scheduler,r=n.assignmentStore,i=n.eventStore,o=t.resourceMap[e.id]={},a=n.resourceStore.indexOf(e),s=e.assignments.reduce((function(e,t){return r.isAvailable(t)&&i.isAvailable(t.event)&&e.push(t.event),e}),[]),u=(s=n.getEventsToRender(e,s)).reduce((function(r,i){var s=n.generateRenderData(i,e),u={renderData:s};return an.setPath(t.eventMap,"".concat(s.eventId,".").concat(e.id),u),o[s.eventId]=u,s.fillSize?(s.left=a*n.resourceColumnWidth,s.width=n.resourceColumnWidth):r.push(s),r}),[]);return u.sort(t.eventSorter),t.verticalLayout.applyLayout(u,n.resourceColumnWidth,n.resourceMargin,n.barMargin,a),o}},{key:"addTemporaryDragElement",value:function(e){var t=this.scheduler,n=t.generateRenderData(e,e.resource,{timeAxis:!0,viewport:!0});n.top=n.row?n.top+n.row.top:t.getResourceEventBox(e,e.resource,!0).top;var r=this.renderEvent({renderData:n}),i=r.dataset;delete r.tabIndex,delete i.eventId,delete i.resourceId,delete i.syncId,i.transient=!0,r.parent=this.scheduler.foregroundCanvas,r.retainElement=!0;var o=Cr.createElement(r);return o.innerElement=o.firstChild,e.instanceMeta(t).hasTemporaryDragElement=!0,o}},{key:"renderEvent",value:function(e){var t=e.renderData,n=t.resourceRecord,r=t.assignmentRecord,i={className:t.wrapperCls,tabIndex:"0",children:[{className:t.cls,style:(t.internalStyle||"")+(t.style||""),children:t.children,dataset:{taskFeature:"event"},syncOptions:{syncIdField:"taskBarFeature"}}].concat(d()(t.wrapperChildren)),style:{transform:"translate(".concat(t.left,"px, ").concat(t.top,"px)"),height:t.height,width:t.width,zIndex:t.zIndex,style:t.wrapperStyle||""},dataset:{resourceId:n.id,eventId:t.eventId,syncId:r?r.id:t.eventId},elementData:e,retainElement:(r||t.eventRecord).instanceMeta(this.scheduler).retainElement,syncOptions:{syncIdField:"taskFeature",releaseThreshold:0}};return r&&(i.dataset.assignmentId=r.id),this.scheduler.trigger("beforeRenderEvent",{renderData:t,domConfig:i}),e.elementConfig=i,i}},{key:"renderResource",value:function(e){var t=this,n=t.topDateMS,r=t.bottomDateMS,i=[],o=t.resourceMap[e.id];for(var a in o||(o=t.layoutResource(e)),o){var s=o[a],u=s.renderData,c=u.endDateMS,l=u.startDateMS,f=u.eventRecord;c>=n&&l<=r&&!f.instanceMeta(t.scheduler).hasTemporaryDragElement&&i.push(t.renderEvent(s))}return i}},{key:"isEventElement",value:function(e){var t=e&&e.className;return t&&t[this.scheduler.eventCls+"-wrap"]}},{key:"renderer",value:function(){var e=this,t=e.scheduler,n=t.resourceStore,r=e.resourceRange,i=r.firstResource,o=r.lastResource,a=e.dateRange,s=a.topDate,u=a.bottomDate,c=[],l=[];if(e.initialized&&e.scheduler.isEngineReady){if(Zt.isEqual(s,e.topDate)&&Zt.isEqual(u,e.bottomDate)||(e.topDate=s,e.bottomDate=u,e.topDateMS=s.getTime(),e.bottomDateMS=u.getTime(),e.timeView.range={startDate:s,endDate:u},t.trigger("visibleRangeChange",{startDate:s,endDate:u})),-1!==i&&-1!==o)for(var f=i;f<=o;f++)c.push.apply(c,e.renderResource(n.getAt(f)));t.getForegroundDomConfigs(l),c.push.apply(c,l),Gs.sync({domConfig:{onlyChildren:!0,children:c},targetElement:t.foregroundCanvas,syncIdField:"syncId",callback:function(n){var r=n.action,i=n.domConfig,o=n.lastDomConfig,a=n.targetElement;if(e.isEventElement(i)){var s=yA[r];if(gA[r]&&e.isEventElement(o)&&!o.isReleased){var u=o.elementData.renderData,c={renderData:u,assignmentRecord:u.assignmentRecord,eventRecord:u.eventRecord,resourceRecord:u.resourceRecord,element:a};a===document.activeElement&&t.focusElement.focus(),t.trigger("releaseEvent",c)}if(s){var l=i.elementData.renderData,f={renderData:l,tplData:l,assignmentRecord:l.assignmentRecord,eventRecord:l.eventRecord,resourceRecord:l.resourceRecord,element:a,isReusingElement:"reuseElement"===r,isRepaint:"reuseOwnElement"===r};f.reusingElement="reuseElement"===r,t.trigger("renderEvent",f)}}}}),e.firstResource===i&&e.lastResource===o||(e.resourceColumns.range={firstResource:i,lastResource:o},e.firstResource=i,e.lastResource=o)}}},{key:"refresh",value:function(e){var t=this;this.scheduler.runWithTransition((function(){return t.renderer()}),e)}},{key:"refreshResources",value:function(e){this.clearResources(e),this.refresh()}},{key:"clearResources",value:function(e){var t=this;e.forEach((function(e){t.resourceMap[e]&&(Object.keys(t.resourceMap[e]).forEach((function(n){delete t.eventMap[n][e]})),delete t.resourceMap[e])}))}},{key:"clearAll",value:function(){this.resourceMap={},this.eventMap={}}},{key:"visibleDateRange",get:function(){var e=this.scheduler,t=e.scrollable.y,n=e.scrollable.clientHeight;return{startDate:e.getDateFromCoordinate(t),endDate:e.getDateFromCoordinate(t+n)||e.timeAxis.endDate}}},{key:"resourceRange",get:function(){var e=this.scheduler,t=this.resourceStore;return t&&t.count?{firstResource:Math.max(Math.floor(e.scrollLeft/e.resourceColumnWidth)-1,0),lastResource:Math.min(Math.floor((e.scrollLeft+e.timeAxisSubGrid.width)/e.resourceColumnWidth)+1,t.count-1)}:{firstResource:-1,lastResource:-1}}},{key:"dateRange",get:function(){var e=this.scheduler,t=e.getDateFromCoordinate(Math.min(e.scrollTop+e.bodyHeight+e.tickSize-1,(e.virtualScrollHeight||e.scrollable.scrollHeight)-1));t||(t=e.timeAxis.last.endDate);var n=e.getDateFromCoordinate(Math.max(e.scrollTop-e.tickSize,0));return n||(n=e.timeAxis.first.startDate,t=e.getDateFromCoordinate(e.bodyHeight+e.tickSize-1)),{topDate:n,bottomDate:t}}},{key:"timeView",get:function(){return this.scheduler.timeView}}],[{key:"properties",get:function(){return{eventMap:{},resourceMap:{},releasedElements:{},toDrawOnProjectRefresh:new Set}}}]),n}(ue.mixin(_a,oA,rA));function bA(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function wA(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?bA(Object(n),!0).forEach((function(t){ke()(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):bA(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function CA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}kA._$name="VerticalRendering";function SA(e,t){return e===t.length-1}function DA(e,t){return t===e.cells[e.cells.length-1]}var RA=function(e){fe()(n,e);var t=CA(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"buildCells",value:function(){var e,t=this,n=t.sizeProperty,r=[],i=t.levels.map((function(e,r){var i,o;return{className:(i={"b-sch-header-row":1},ke()(i,"b-sch-header-row-".concat(e.position),1),ke()(i,"b-sch-header-row-main",r===t.model.viewPreset.mainHeaderLevel),ke()(i,"b-lowest",SA(r,t.levels)),i),syncOptions:{releaseThreshold:5,syncIdField:"tickIndex"},dataset:{headerFeature:"headerRow".concat(r),headerPosition:e.position},children:null===(o=e.cells)||void 0===o?void 0:o.filter((function(e){return e.start<t.endDate&&e.end>t.startDate})).map((function(r){var i,o;return{className:(i={"b-sch-header-timeaxis-cell":1},ke()(i,r.headerCellCls,r.headerCellCls),ke()(i,"b-align-".concat(r.align),r.align),ke()(i,"b-last",DA(e,r)),i),dataset:wA({tickIndex:r.index},window.DEBUG&&{date:r.start.getTime()}),style:(o={},ke()(o,t.positionProperty,r.coord),ke()(o,n,r.width),ke()(o,"min-".concat(n),r.width),o),children:t.wrapText?[{className:"b-sch-header-text",html:r.value}]:null,html:t.wrapText?null:r.value}}))}}));return null===(e=t.client)||void 0===e||e.getHeaderDomConfigs(r),i.push.apply(i,r),{className:"b-widget ".concat(t.cls),syncOptions:{releaseThreshold:0},style:ke()({},n,t.size),children:i}}},{key:"render",value:function(e){we()(pe()(n.prototype),"render",this).call(this,e),this.refresh(!0)}},{key:"refresh",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:!this.levels.length,t=this,n=t.model.columnConfig,r=t.levels,i=r.length;if(e){r.length=0,n.forEach((function(e,t){return r[t]={position:t,cells:e}})),t.size=r[0].cells.reduce((function(e,t){return e+t.width}),0);var o=t.element.parentElement;o&&(o.classList.remove("b-sch-timeaxiscolumn-levels-".concat(i)),o.classList.add("b-sch-timeaxiscolumn-levels-".concat(r.length)))}t.startDate&&t.endDate&&(Gs.sync({domConfig:t.buildCells(),targetElement:t.element,syncIdField:"headerFeature"}),t.trigger("refresh"))}},{key:"range",set:function(e){this.startDate=e.startDate,this.endDate=e.endDate,this.refresh()}},{key:"widgetClass",get:function(){}}],[{key:"defaultConfig",get:function(){return{compactCellWidthThreshold:15,model:null,cls:null,sizeProperty:null,positionProperty:null,wrapText:null}}},{key:"properties",get:function(){return{startDate:null,endDate:null,levels:[],size:null}}}]),n}(oc);function xA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}RA._$name="TimeAxisBase";var EA=function(e){fe()(n,e);var t=xA(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(){we()(pe()(n.prototype),"construct",this).apply(this,arguments),this.model.on({update:this.onModelUpdate,thisObj:this})}},{key:"onModelUpdate",value:function(){this.model.availableSpace!==this.width&&this.refresh(!0)}},{key:"width",get:function(){return this.size}}],[{key:"$name",get:function(){return"HorizontalTimeAxis"}},{key:"defaultConfig",get:function(){return{cls:"b-horizontaltimeaxis",sizeProperty:"width",positionProperty:"left",wrapText:!1}}}]),n}(RA);function TA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}EA._$name="HorizontalTimeAxis";var MA=function(e){fe()(n,e);var t=TA(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e){we()(pe()(n.prototype),"construct",this).call(this,e);var t=this;null!=t.imagePath&&(nu.on({element:t.element,delegate:".b-resource-image",capture:!0,error:function(e){return t.setDefaultResourceImage(e.target)},thisObj:t}),t.element.classList.add("b-has-images")),nu.on({element:t.element,delegate:".b-resourceheader-cell",capture:!0,click:"onResourceMouseEvent",dblclick:"onResourceMouseEvent",contextmenu:"onResourceMouseEvent",thisObj:t})}},{key:"onResourceStoreDataChange",value:function(e){var t=e.action,n=this,r=n.resourceStore.count*n.columnWidth;r!==n.width&&(n.element.style.width=r+"px",n.column.set("width",r,n.column.grid.isConfiguring)),"removeall"===t&&(n.element.innerHTML=""),"remove"!==t&&"add"!==t&&"filter"!==t||n.refreshWidths()}},{key:"setDefaultResourceImage",value:function(e){if(this.defaultImageName){var t=this.getImageURL(this.defaultImageName);e.src&&!e.src.endsWith(t.replace(/^[./]*/gm,""))&&(e.src=t)}}},{key:"getImageURL",value:function(e){return E.joinPaths([this.imagePath||"",e||""])}},{key:"refreshWidths",value:function(){var e=this,t=e.availableWidth,n=e._originalColumnWidth,r=e.resourceStore&&e.resourceStore.count;if(t&&r){e.refreshingWidths=!0;var i=e.fitWidth||e.fillWidth&&n*r<t?Math.floor(t/r):n,o=e.column.grid.enableEventAnimations&&Math.abs(e._columnWidth-i)>30;Cr.addTemporaryClass(e.element,"b-animating",o?300:0,e),e.columnWidth=i,e.refreshingWidths=!1}}},{key:"refresh",value:function(){var e=this,t=e.firstResource,n=e.lastResource;if(!(e.column.grid.isConfiguring||-1===t||-1===n||n>=e.resourceStore.count)){for(var r=[],i=t;i<=n;i++){var o=e.resourceStore.getAt(i),a={className:new An({"b-resourceheader-cell":1}),dataset:{resourceId:o.id},style:{left:i*e.columnWidth,width:e.columnWidth},children:[]};if(e.headerRenderer){var s=e.headerRenderer({elementConfig:a,resourceRecord:o});null!=s&&(a.html=s)}else{var u=void 0;if(o.imageUrl)u=o.imageUrl;else if(null!=e.imagePath){var c=o.image||o.name&&o.name.toLowerCase()+e.imageExtension||e.defaultImageName;u=e.getImageURL(c)}null!=u&&a.children.push({tag:"img",className:"b-resource-image",src:u}),o.iconCls&&a.children.push({tag:"i",className:o.iconCls}),a.children.push({tag:"span",className:"b-resource-name",html:o.name})}r.push(a)}Gs.sync({domConfig:{onlyChildren:!0,children:r},targetElement:e.element,syncIdField:"resourceId"})}}},{key:"onResourceMouseEvent",value:function(e){var t=e.target.closest(".b-resourceheader-cell"),n=this.resourceStore.getById(t.dataset.resourceId);this.trigger("resourceHeader"+E.capitalize(e.type),{resourceRecord:n,event:e})}},{key:"resourceStore",set:function(e){var t,n=this;e!==n._resourceStore&&(null===(t=n.resourceStoreDetacher)||void 0===t||t.call(n),n._resourceStore=e,n.resourceStoreDetacher=e.on({changePreCommit:"onResourceStoreDataChange",thisObj:n}),e.count&&n.onResourceStoreDataChange({}))},get:function(){return this._resourceStore}},{key:"columnWidth",get:function(){return this._columnWidth},set:function(e){var t=this;if(e!==t._columnWidth){var n=t._columnWidth;t._columnWidth=e,t.refreshingWidths||(t._originalColumnWidth=e,t.refreshWidths()),t.isConfiguring||(t.refresh(),t.trigger("columnWidthChange",{width:t._columnWidth,oldWidth:n}))}}},{key:"fillWidth",get:function(){return this._fillWidth},set:function(e){this._fillWidth=e,this.refreshWidths()}},{key:"fitWidth",get:function(){return this._fitWidth},set:function(e){this._fitWidth=e,this.refreshWidths()}},{key:"imagePath",get:function(){return this._imagePath},set:function(e){this._imagePath=e,this.refresh()}},{key:"availableWidth",get:function(){return this._availableWidth},set:function(e){this._availableWidth=e,this.refreshWidths()}},{key:"range",set:function(e){this.firstResource=e.firstResource,this.lastResource=e.lastResource,this.refresh()}}],[{key:"$name",get:function(){return"ResourceHeader"}},{key:"defaultConfig",get:function(){return{resourceStore:null,columnWidth:150,headerRenderer:null,fillWidth:!0,fitWidth:!1,imagePath:null,imageExtension:null,defaultImageName:null}}},{key:"properties",get:function(){return{firstResource:-1,lastResource:-1}}}]),n}(oc);function AA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}MA._$name="ResourceHeader";var PA=function(e){fe()(n,e);var t=AA(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(){var e=this;we()(pe()(n.prototype),"construct",this).apply(this,arguments),e.initialRender=!0,e.thisObj=e,e.timeAxisViewModel=e.timeline.timeAxisViewModel,e.mode=e.mode,e.grid.on({paint:"onTimelinePaint",thisObj:e,once:!0}),e.timeAxisViewModel.on({update:e.onViewModelUpdate,thisObj:e})}},{key:"doDestroy",value:function(){this.resourceColumns&&this.resourceColumns.destroy(),we()(pe()(n.prototype),"doDestroy",this).call(this)}},{key:"onViewModelUpdate",value:function(e){var t=e.source,n=this;"horizontal"===n.mode?(n.refreshHeader(!0),n.width=t.totalSize,n.timeline.refresh()):"vertical"===n.mode&&n.timeline.refreshRows()}},{key:"onTimelinePaint",value:function(e){var t=e.firstPaint,n=this;n.subGrid.insertRowsBefore&&t&&(n.subGridElement.classList.add("b-timeline-subgrid"),n.element&&nu.on({element:n.element,thisObj:n,click:"onContainerElementClick",dblclick:"onContainerElementClick",contextmenu:"onContainerElementClick"}),"vertical"===n.mode&&n.refreshHeader())}},{key:"refreshHeader",value:function(e){var t=this,n=t.element;n&&("horizontal"===t.mode?(!e&&t.timeAxisViewModel.update(null,!0),t.timeAxisView.rendered?t.timeAxisView.refresh(!0):(n.innerHTML="",t.timeAxisView.render(n))):"vertical"===t.mode&&(t.resourceColumns.currentElement||(n.innerHTML="",t.resourceColumns.render(n))))}},{key:"renderer",value:function(e){if(this.timeline.project.isInitialCommitPerformed)return this.timeline.currentOrientation.renderer(e)}},{key:"onContainerElementClick",value:function(e){var t=Cr.up(e.target,".b-sch-header-timeaxis-cell");if(t){var n=t.dataset.tickIndex,r=t.parentElement.dataset.headerPosition,i=this.timeAxisViewModel.columnConfig[r][n],o=this.grid.features.contextMenu;o&&e.type===o.triggerEvent||this.trigger("timeAxisHeader"+E.capitalize(e.type),{startDate:i.start,endDate:i.end,event:e})}}},{key:"mode",set:function(e){var t=this,n=t.timeline;t.set("mode",e),"horizontal"===e?t.timeAxisView=new EA({model:t.timeAxisViewModel,compactCellWidthThreshold:t.compactCellWidthThreshold,owner:t.grid,client:t.grid}):"vertical"===e&&(t.resourceColumns=new MA(an.assign({column:t,resourceStore:n.resourceStore,imagePath:n.resourceImagePath,imageExtension:n.resourceImageExtension,defaultImageName:n.defaultResourceImageName},n.resourceColumns||{})),t.relayEvents(t.resourceColumns,["resourceheaderclick","resourceheaderdblclick","resourceheadercontextmenu"]))},get:function(){return this.get("mode")}}],[{key:"autoExposeFields",get:function(){return!0}},{key:"fields",get:function(){return["mode"]}},{key:"defaults",get:function(){return{draggable:!1,groupable:!1,hideable:!1,showColumnPicker:!1,filterable:!1,sortable:!1,resizable:!1,searchable:!1,editor:!1,enableCellContextMenu:!1,tooltipRenderer:!1,cls:"b-sch-timeaxiscolumn",needWidth:!0,mode:null,region:"normal",exportable:!1}}},{key:"type",get:function(){return"timeAxis"}}]),n}(Ge(Dh));function IA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Th.registerColumnType(PA),PA._$name="TimeAxisColumn";var OA=function(e){fe()(n,e);var t=IA(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"height",get:function(){return this.size}}],[{key:"$name",get:function(){return"VerticalTimeAxis"}},{key:"defaultConfig",get:function(){return{cls:"b-verticaltimeaxis",sizeProperty:"height",positionProperty:"top",wrapText:!0}}}]),n}(RA);function FA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}OA._$name="VerticalTimeAxis";var LA=function(e){fe()(n,e);var t=FA(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e){var t=this;we()(pe()(n.prototype),"construct",this).apply(this,arguments),t.timeAxisViewModel=e.timeline.timeAxisViewModel,t.view=new OA({model:t.timeAxisViewModel,client:e.timeline})}},{key:"renderer",value:function(e){var t=e.cellElement,n=e.size;this.view.render(t),n.height=this.view.height}},{key:"isFocusable",get:function(){return!1}}],[{key:"type",get:function(){return"verticalTimeAxis"}},{key:"defaults",get:function(){return{draggable:!1,groupable:!1,hideable:!1,showColumnPicker:!1,filterable:!1,sortable:!1,searchable:!1,editor:!1,enableCellContextMenu:!1,tooltipRenderer:!1,cellCls:"b-verticaltimeaxiscolumn"}}}]),n}(Dh);function jA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Th.registerColumnType(LA),LA._$name="VerticalTimeAxisColumn";var _A=function(e){fe()(i,e);var t,n,r=jA(i);function i(){return v()(this,i),r.apply(this,arguments)}return g()(i,[{key:"afterConstruct",value:function(){we()(pe()(i.prototype),"afterConstruct",this).call(this),this.createEventOnDblClick&&this.on("scheduledblclick",this.onSchedulerDblClick)}},{key:"onLocaleChange",value:function(){this.currentOrientation.onLocaleChange(),we()(pe()(i.prototype),"onLocaleChange",this).call(this)}},{key:"onSchedulerDblClick",value:function(e){var t=e.date,n=e.resourceRecord,r=e.row;this.readOnly||n.isSpecialRow||this.internalAddEvent(t,n,r)}},{key:"onColumnsChanged",value:function(e){e.action;var t=e.changes,n=e.record;n===this.timeAxisColumn&&"width"in t&&this.updateCanvasSize(),we()(pe()(i.prototype),"onColumnsChanged",this).apply(this,arguments)}},{key:"onVerticalScroll",value:function(e){var t=e.scrollTop;this.currentOrientation.updateFromVerticalScroll(t)}},{key:"onEventCreated",value:function(e){}},{key:"onElementKeyDown",value:function(e){we()(pe()(i.prototype),"onElementKeyDown",this).call(this,e)}},{key:"onElementKeyUp",value:function(e){we()(pe()(i.prototype),"onElementKeyUp",this).call(this,e)}},{key:"onElementMouseOver",value:function(e){we()(pe()(i.prototype),"onElementMouseOver",this).call(this,e)}},{key:"onElementMouseOut",value:function(e){we()(pe()(i.prototype),"onElementMouseOut",this).call(this,e)}},{key:"populateEventMenu",value:function(){}},{key:"populateScheduleMenu",value:function(){}},{key:"internalAddEvent",value:(n=Wr()(Vr.a.mark((function e(t,n,r){var i,o,a,s,u;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=[n],a=new(i=this).eventStore.modelClass({startDate:t,endDate:Zt.add(t,1,i.timeAxis.unit)}),i.onEventCreated(a),!i.eventEdit){e.next=9;break}return s=i.currentOrientation.getTimeSpanRenderData(a,n),u=Cr.createElement({parent:i.foregroundCanvas,className:"b-sch-dragcreator-proxy",style:"width:".concat(s.width,"px;height:").concat(s.height,"px")}),Cr.setTranslateXY(u,s.left,(r&&r.top||0)+s.top),i.editEvent(a,n,u),e.abrupt("return");case 9:if(!i.taskEdit){e.next=12;break}return i.editEvent(a,n),e.abrupt("return");case 12:if(!1===i.trigger("beforeEventAdd",{eventRecord:a,resourceRecords:o,resources:o})){e.next=19;break}if(i.eventStore.add(a),i.assignmentStore.assignEventToResource(a,n),!i.taskEdit){e.next=19;break}return e.next=18,i.project.commitAsync();case 18:i.editEvent(a,n);case 19:case"end":return e.stop()}}),e,this)}))),function(e,t,r){return n.apply(this,arguments)})},{key:"isDateRangeAvailable",value:function(e,t,n,r){return this.eventStore.isDateRangeAvailable(e,t,n,r)}},{key:"resumeRefresh",value:(t=Wr()(Vr.a.mark((function e(t){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(we()(pe()(i.prototype),"resumeRefresh",this).call(this,!1),this.refreshSuspended||!t){e.next=6;break}if(this.isEngineReady){e.next=5;break}return this.currentOrientation.refreshAllWhenReady=!0,e.abrupt("return",this.project.commitAsync());case 5:this.isDestroyed||this.refreshWithTransition();case 6:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"toggleEmptyText",value:function(){var e=this;e.bodyContainer&&Cr.toggleClasses(e.bodyContainer,"b-grid-empty",!(e.rowManager.rowCount||e.crudManager&&e.crudManager.isLoading))}},{key:"getRowHeight",value:function(e){if(this.currentOrientation.calculateRowHeight){var t=this.currentOrientation.calculateRowHeight(e);return this.rowManager.storeKnownHeight(e.id,t),t}}},{key:"calculateRowHeights",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.forEach((function(e){return e&&t.getRowHeight(e)})),n||this.rowManager.estimateTotalHeight(!0)}},{key:"calculateAllRowHeights",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this.store,n=this.rowManager,r=Math.min(t.count,this.preCalculateHeightLimit);if(r){n.clearKnownHeights();for(var i=0;i<r;i++)this.getRowHeight(t.getAt(i));e||n.estimateTotalHeight(!0)}}},{key:"timeAxisViewModel",set:function(e){sc()(pe()(i.prototype),"timeAxisViewModel",e,this,!0),this.eventStore&&(this.timeAxisViewModel.eventStore=this.eventStore)},get:function(){return we()(pe()(i.prototype),"timeAxisViewModel",this)}},{key:"store",get:function(){return we()(pe()(i.prototype),"store",this)},set:function(e){sc()(pe()(i.prototype),"store",e,this,!0)}},{key:"isHorizontal",get:function(){return"horizontal"===this.mode}},{key:"isVertical",get:function(){return"vertical"===this.mode}},{key:"mode",get:function(){return this._mode},set:function(e){var t=this;t._mode=e,t[e]||("horizontal"===e?(t.horizontal=new dA(t),t.isPainted&&t.horizontal.init(),t.un("scroll",t.onVerticalScroll,t)):"vertical"===e&&(t.zoomOnTimeAxisDoubleClick=t.zoomOnMouseWheel=!1,t.vertical=new kA(t),t.rendered&&t.vertical.init(),t.on("scroll",t.onVerticalScroll,t)))}},{key:"currentOrientation",get:function(){return this[this.mode]}}],[{key:"$name",get:function(){return"SchedulerBase"}},{key:"type",get:function(){return"schedulerbase"}},{key:"defaultConfig",get:function(){return{mode:"horizontal",eventCls:"b-sch-event",timeCellCls:"b-sch-timeaxis-cell",timeCellSelector:".b-sch-timeaxis-cell",scheduledEventName:"event",overScheduledEventClass:"b-sch-event-hover",allowOverlap:!0,rowHeight:60,milestoneCharWidth:10,milestoneAlign:"center",preCalculateHeightLimit:1e4,milestoneMinWidth:40,crudManagerClass:Ix,testConfig:{loadMaskError:{autoClose:10,showDelay:0}}}}},{key:"deprecatedEvents",get:function(){return{eventContextMenuBeforeShow:{product:"Scheduler",invalidAsOfVersion:"5.0.0",message:"`eventContextMenuBeforeShow` event is deprecated, in favor of `eventMenuBeforeShow` event. Please see https://bryntum.com/docs/scheduler/#guides/upgrades/3.1.0.md for more information."},eventContextMenuShow:{product:"Scheduler",invalidAsOfVersion:"5.0.0",message:"`eventContextMenuShow` event is deprecated, in favor of `eventMenuShow` event. Please see https://bryntum.com/docs/scheduler/#guides/upgrades/3.1.0.md for more information."},eventContextMenuItem:{product:"Scheduler",invalidAsOfVersion:"5.0.0",message:"`eventContextMenuItem` event is deprecated, in favor of `eventMenuItem` event. Please see https://bryntum.com/docs/scheduler/#guides/upgrades/3.1.0.md for more information."},scheduleContextMenuBeforeShow:{product:"Scheduler",invalidAsOfVersion:"5.0.0",message:"`scheduleContextMenuBeforeShow` event is deprecated, in favor of `scheduleMenuBeforeShow` event. Please see https://bryntum.com/docs/scheduler/#guides/upgrades/3.1.0.md for more information."},scheduleContextMenuShow:{product:"Scheduler",invalidAsOfVersion:"5.0.0",message:"`scheduleContextMenuShow` event is deprecated, in favor of `scheduleMenuShow` event. Please see https://bryntum.com/docs/scheduler/#guides/upgrades/3.1.0.md for more information."},scheduleContextMenuItem:{product:"Scheduler",invalidAsOfVersion:"5.0.0",message:"`scheduleContextMenuItem` event is deprecated, in favor of `scheduleMenuItem` event. Please see https://bryntum.com/docs/scheduler/#guides/upgrades/3.1.0.md for more information."}}}}]),i}(ET.mixin(Gy,(function(e){return function(e){fe()(n,e);var t=AT(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"getElementFromAssignmentRecord",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this.currentOrientation.getElementFromAssignmentRecord(e,t)}},{key:"getElementFromEventRecord",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.currentOrientation.getElementFromEventRecord(e,t,n)}},{key:"getElementsFromEventRecord",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];return this.currentOrientation.getElementsFromEventRecord(e,t,n)}},{key:"resolveResourceRecord",value:function(e,t){return this.currentOrientation.resolveRowRecord(e,t)}},{key:"resolveEventRecord",value:function(e){if(e=Cr.up(e,this.eventSelector)){if(e.dataset.eventId)return this.eventStore.getById(e.dataset.eventId);if(e.dataset.assignmentId)return this.assignmentStore.getById(e.dataset.assignmentId).event}return null}},{key:"resolveTimeSpanRecord",value:function(e){return this.resolveEventRecord(e)}},{key:"resolveAssignmentRecord",value:function(e){var t=Cr.up(e,this.eventSelector),n=t&&this.assignmentStore.getById(t.dataset.assignmentId),r=t&&this.eventStore.getById(t.dataset.eventId);return this.assignmentStore.getOccurrence(n,r)}},{key:"isRowVisible",value:function(e){return this.store.indexOf(e)>=0}},{key:"getMilestoneLabelWidth",value:function(e){var t=this,n=t.milestoneLayoutMode;if("measure"===n){var r=t.milestoneMeasureElement||(t.milestoneMeasureElement=Cr.createElement({className:"b-sch-event-wrap b-milestone-wrap b-measure",children:[{className:"b-sch-event b-milestone",children:[{className:"b-sch-event-content"}]}],parent:t.foregroundCanvas}));return r.retainElement=!0,r.firstElementChild.firstElementChild.innerHTML=e.name,r.offsetWidth}return"estimate"===n?Math.max(e.name.length*t.milestoneCharWidth,t.milestoneMinWidth):"data"===n?Math.max(e.milestoneWidth,t.milestoneMinWidth):0}},{key:"milestoneLayoutMode",set:function(e){this._milestoneLayoutMode=e,this.element.classList["default"!==e?"add":"remove"]("b-sch-layout-milestones"),this.isConfiguring||this.refreshWithTransition()},get:function(){return this._milestoneLayoutMode}},{key:"milestoneAlign",set:function(e){this._milestoneAlign=e,this.isConfiguring||this.refreshWithTransition()},get:function(){return this._milestoneAlign}},{key:"milestoneCharWidth",set:function(e){this._milestoneCharWidth=e,this.isConfiguring||this.refreshWithTransition()},get:function(){return this._milestoneCharWidth}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"SchedulerDom"}}]),n}(e||ue)}),(function(e){return function(e){fe()(n,e);var t=PT(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"getTimeSpanMouseEventParams",value:function(e,t){var n=this.resolveEventRecord(e);return n&&{eventRecord:n,resourceRecord:this.resolveResourceRecord(e),assignmentRecord:this.resolveAssignmentRecord(e),eventElement:e,event:t}}},{key:"getScheduleMouseEventParams",value:function(e,t){return{resourceRecord:this.isVertical?this.resolveResourceRecord(t):this.store.getById(e.id)}}},{key:"onElementKeyDown",value:function(e){we()(pe()(n.prototype),"onElementKeyDown",this).call(this,e);var t=this;t.selectedEvents.length&&t.trigger(t.scheduledEventName+"KeyDown",{eventRecord:t.selectedEvents,assignmentRecord:t.selectedAssignments})}},{key:"onElementKeyUp",value:function(e){we()(pe()(n.prototype),"onElementKeyUp",this).call(this,e);var t=this;t.selectedEvents.length&&t.trigger(t.scheduledEventName+"KeyUp",{eventRecord:t.selectedEvents,assignmentRecord:t.selectedAssignments})}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"SchedulerDomEvents"}}]),n}(e||ue)}),(function(e){return function(e){fe()(n,e);var t=IT(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e){we()(pe()(n.prototype),"construct",this).call(this,e),this.hasFeature("eventDragCreate")&&this.on({dragCreateEnd:"internalOnDragCreateEnd",thisObj:this})}},{key:"internalOnDragCreateEnd",value:function(e){var t=e.newEventRecord,n=e.resourceRecord,r=this;if((!r.hasFeature("eventEdit")||r.features.eventEdit.disabled)&&(!r.hasFeature("taskEdit")||r.features.taskEdit.disabled)){var i=n?[n]:[];!1!==r.trigger("beforeEventAdd",{eventRecord:t,resources:i,resourceRecords:i})&&(r.onEventCreated(t),r.eventStore.add(t),t.assign(n))}}},{key:"eventEditor",get:function(){return this._eventEditor},set:function(e){this._eventEditor=e}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"SchedulerDragResize"}}]),n}(e||ue)}),(function(e){return function(e){fe()(n,e);var t=WM(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"updateProject",value:function(e,t){we()(pe()(n.prototype),"updateProject",this).call(this,e,t),this.detachListeners("schedulerStores"),e.on({name:"schedulerStores",refresh:"onProjectRefresh",thisObj:this})}},{key:"onProjectRefresh",value:function(e){var t=this;e.isInitialCommit&&t.isVertical&&(t.refreshAfterProjectRefresh=!1,t.refreshWithTransition()),t.navigateToAfterRefresh&&(t.navigateTo(t.navigateToAfterRefresh),t.navigateToAfterRefresh=null),t.refreshAfterProjectRefresh&&(t.refreshWithTransition(),t.refreshAfterProjectRefresh=!1)}},{key:"refreshFromRowOnStoreAdd",value:function(e,t){var r=this,i=t.isExpand,o=arguments;this.runWithTransition((function(){var t;r.currentOrientation.suspended=!i,(t=we()(pe()(n.prototype),"refreshFromRowOnStoreAdd",r)).call.apply(t,[r,e].concat(d()(o))),r.currentOrientation.suspended=!1}),!i)}},{key:"onStoreAdd",value:function(e){we()(pe()(n.prototype),"onStoreAdd",this).call(this,e),this.calculateRowHeights(e.records)}},{key:"onStoreUpdateRecord",value:function(e){e.source,e.record;var t=e.changes,r=0;"assigned"in t&&r++,"calendar"in t&&r++,r!==Object.keys(t).length&&we()(pe()(n.prototype),"onStoreUpdateRecord",this).apply(this,arguments)}},{key:"updateResourceStore",value:function(e){e&&this.isHorizontal&&(e.metaMapId=this.id,this.store=e)}},{key:"onEventIdChange",value:function(e){this.currentOrientation.onEventStoreIdChange&&this.currentOrientation.onEventStoreIdChange(e)}},{key:"onInternalEventStoreChange",value:function(e){!this._mode||e.isAssign||this.assignmentStore.isRemovingAssignment||this.currentOrientation.onEventStoreChange(e)}},{key:"onEventCommit",value:function(e){var t=this,n=e.changes,r=[].concat(d()(n.added),d()(n.modified)).map((function(e){return t.eventStore.getResourcesForEvent(e)}));r=Array.prototype.concat.apply([],r),new Set(r).forEach((function(e){return t.repaintEventsForResource(e)}))}},{key:"onEventBeforeCommit",value:function(e){var t=e.changes,n=this.currentOrientation,r=this.committingCls;[].concat(d()(t.added),d()(t.modified)).forEach((function(e){return e.assignments.forEach((function(e){return n.toggleCls(e,r,!0)}))}))}},{key:"onEventException",value:function(e){var t=this;if("commit"===e.action){var n=this.eventStore.changes;[].concat(d()(n.added),d()(n.modified),d()(n.removed)).forEach((function(e){return t.repaintEvent(e)}))}}},{key:"onEventClearChanges",value:function(){this.refresh()}},{key:"onAssignmentBeforeRemove",value:function(e){e.source;var t=e.records;if(!e.removingAll){var n,r=this;if(!r.isConfiguring&&r.activeAssignment&&t.includes(r.activeAssignment)){if("key"===$r.lastInteractionType)for(var i=0,o=t.length;i<o&&(!n||t.includes(n));i++){var a=t[i];a.resource&&a.resource.isModel&&(n=r.getNext(a)||r.getPrevious(a))}n?(r.navigateTo(n),r.navigateToAfterRefresh=n):Cr.focusWithoutScrolling(r.focusElement)}}}},{key:"applyStartEndParameters",value:function(e){var t=e.source,n=e.params,r=this,i=t.modelClass.fieldMap.startDate;r.passStartEndParameters&&(n[r.startParamName]=i.print(r.startDate),n[r.endParamName]=i.print(r.endDate))}},{key:"store",get:function(){return!this._store&&this.isVertical&&(this._store=new No({data:[{id:"verticalTimeAxisRow"}]})),we()(pe()(n.prototype),"store",this)},set:function(e){sc()(pe()(n.prototype),"store",e,this,!0)}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"SchedulerStores"}},{key:"projectStores",get:function(){return{resourceStore:{dataName:"resources"},eventStore:{dataName:"events",listeners:{changePreCommit:"onInternalEventStoreChange",clearChanges:"onEventClearChanges",beforeCommit:"onEventBeforeCommit",commit:"onEventCommit",exception:"onEventException",idchange:"onEventIdChange",beforeLoad:"applyStartEndParameters"}},assignmentStore:{dataName:"assignments",listeners:{changePreCommit:"onAssignmentChange",beforeRemove:{fn:"onAssignmentBeforeRemove",prio:-1e3}}},dependencyStore:{dataName:"dependencies"},calendarManagerStore:{}}}},{key:"configurable",get:function(){return{timeRanges:null,resourceTimeRanges:null,store:null,startParamName:"startDate",endParamName:"endDate",passStartEndParameters:!1,removeUnassignedEvent:!0}}}]),n}(zM(e||ue))}),(function(e){return function(e){fe()(n,e);var t=GM(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"scrollEventIntoView",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:UM,n=this,r=e.resources||[e];if(r.length>1)throw new Error("scrollEventIntoView() is not applicable for events with multiple assignments, please use scrollResourceEventIntoView() instead.");return r.length?n.scrollResourceEventIntoView(r[0],e,null,t):(console.warn("You have asked to scroll to an event which is not assigned to a resource"),YM)}},{key:"scrollAssignmentIntoView",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];return this.scrollResourceEventIntoView.apply(this,[e.resource,e.event].concat(n))}},{key:"scrollResourceEventIntoView",value:function(e,t,n){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:UM,o=this,a=t.startDate,s=t.endDate,u=t.isScheduled&&a<o.timeAxis.startDate|(s>o.timeAxis.endDate)<<1;if(null==i.edgeOffset&&(i.edgeOffset=20),u&&!1!==i.extendTimeAxis){var c,l,f=o.timeAxis.endDate-o.timeAxis.startDate;3===u?o.timeAxis.setTimeSpan(new Date(a.valueOf()-f/2),new Date(s.getTime()+f/2)):(c=1&u?o.getCoordinateFromDate(t.endDate):o.getCoordinateFromDate(t.startDate),1&u?o.timeAxis.setTimeSpan(new Date(a),new Date(a.valueOf()+f)):o.timeAxis.setTimeSpan(new Date(s.valueOf()-f),new Date(s)),l=1&u?o.getCoordinateFromDate(t.endDate):o.getCoordinateFromDate(t.startDate),o.timeAxisSubGrid.scrollable.scrollBy(l-c))}if(r=o.getElementFromEventRecord(t,e)){Cr.isFocusable(r)||(r=r.parentNode);var d=o.timeAxisSubGrid.scrollable;return o.timeAxisSubGrid.forceScrollUpdate=!0,d.scrollIntoView(r,i)}return u&&!1===i.extendTimeAxis?(console.warn("You have asked to scroll to an event which is outside the current view and extending timeaxis is disabled"),YM):t.isOccurrence||o.eventStore.isAvailable(t)?t.isScheduled?o.scrollUnrenderedEventIntoView(e,t,i):o.scrollResourceIntoView(e,i):(console.warn("You have asked to scroll to an event which is not available"),YM)}},{key:"scrollUnrenderedEventIntoView",value:function(e,t){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:UM;return new Promise((function(i){var o=n,a=Object.assign({edgeOffset:20},r,qM),s=o.timeAxisSubGrid.scrollable,u=o.getResourceEventBox(t,e),c=s.viewport;if(c)var l=u.translate(c.x-s.x,c.y-s.y),f=s.getDeltaTo(l,a)[o.isHorizontal?"xDelta":"yDelta"],d=function(){var e=Wr()(Vr.a.mark((function e(n){var o,a,u,c;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o=n.eventRecord,a=n.element,u=n.targetElement,o!==t){e.next=12;break}return c=a||u,h(),e.next=6,v;case 6:if(!(f>0)){e.next=9;break}return e.next=9,s.scrollIntoView(c,{edgeOffset:r.edgeOffset});case 9:r.highlight&&Cr.highlight(c),r.focus&&c.focus(),i();case 12:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),h=o.on({renderEvent:d}),v=s.scrollIntoView(l,a);else i()}))}},{key:"scrollResourceIntoView",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:UM;return this.isVertical?this.currentOrientation.scrollResourceIntoView(e,t):this.scrollRowIntoView(e,t)}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"SchedulerScroll"}}]),n}(e||ue)}),(function(e){return function(e){fe()(n,e);var t=XM(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"getState",value:function(){var e=this,t=an.copyProperties(we()(pe()(n.prototype),"getState",this).call(this),e,ZM);return t.zoomLevel=e.zoomLevel,t.zoomLevelOptions={startDate:e.startDate,endDate:e.endDate,viewportCenterDate:e.viewportCenterDate,width:e.tickSize},t}},{key:"applyState",value:function(e){this.suspendRefresh(),e.zoomLevel&&this.zoomToLevel(e.zoomLevel,e.zoomLevelOptions),an.copyProperties(this,e,ZM),we()(pe()(n.prototype),"applyState",this).call(this,e),this.resumeRefresh(!0)}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"SchedulerState"}}]),n}(e||ue)}),(function(e){return function(e){fe()(n,e);var t=NT(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"getEventsToRender",value:function(e,t){return t}},{key:"repaintEventsForResource",value:function(e){this.currentOrientation.repaintEventsForResource(e)}},{key:"repaintEvent",value:function(e){var t=this;this.eventStore.getResourcesForEvent(e).forEach((function(e){return t.repaintEventsForResource(e)}))}},{key:"generateRenderData",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{viewport:!0},r=this,i=r.currentOrientation.getTimeSpanRenderData(e,t,n),o=e.isEvent,a=e.isMilestone,s=o&&e.assignments.find((function(e){return e.resourceId===t.id})),u={className:"b-sch-event-content",dataset:{taskBarFeature:"content"}};if(i){var c,f=e.isResizable;i.startsOutsideView&&(!0===f?f="end":"start"===f&&(f=!1)),i.endsOutsideView&&(!0===f?f="start":"end"===f&&(f=!1));var h=e.isResourceTimeRange?new An:e.cls.clone(),v=e.isResourceTimeRange?e.cls.clone():new An;if(Object.assign(h,(c={},ke()(c,t.cls,t.cls),ke()(c,r.generatedIdCls,e.hasGeneratedId),ke()(c,r.dirtyCls,Boolean(e.hasPersistableChanges||s&&s.hasPersistableChanges)),ke()(c,r.committingCls,e.isCommitting),ke()(c,r.endsOutsideViewCls,i.endsOutsideView),ke()(c,r.startsOutsideViewCls,i.startsOutsideView),ke()(c,"b-clipped-start",i.clippedStart),ke()(c,"b-clipped-end",i.clippedEnd),c)),Object.assign(v,ke()({},"".concat(r.eventCls,"-parent"),t.isParent)),i.wrapperStyle="",o){var p,g,y=s&&r.isAssignmentSelected(s);Object.assign(h,(p={},ke()(p,r.eventCls,1),ke()(p,"b-milestone",a),ke()(p,"b-sch-event-narrow",i.width<10),ke()(p,r.fixedEventCls,!1===e.isDraggable),ke()(p,"b-sch-event-resizable-".concat(f),Boolean(r.features.eventResize)),ke()(p,r.eventSelectedCls,y),ke()(p,r.eventAssignHighlightCls,r.isEventSelected(e)&&!y),ke()(p,"b-recurring",e.isRecurring),ke()(p,"b-occurrence",e.isOccurrence),p)),i.eventId=e.id;var m=e.eventStyle||t.eventStyle||r.eventStyle,k=e.eventColor||t.eventColor||r.eventColor,b=r.isFirstRender&&r.useInitialAnimation;if(Object.assign(v,(g={},ke()(g,"".concat(r.eventCls,"-wrap"),1),ke()(g,"b-milestone-wrap",a),g)),b){var w=i.row?i.row.index:i.top/r.tickSize;i.wrapperStyle="animation-delay: ".concat(w/20,"s;"),r.initialAnimationDetacher||(r.initialAnimationDetacher=nu.on({element:r.foregroundCanvas,delegate:r.eventSelector,animationend:"stopInitialAnimation",expires:{alt:"stopInitialAnimation",delay:r.initialAnimationDuration},thisObj:r}))}i.eventColor=k,i.eventStyle=m,i.assignmentRecord=i.assignment=s}if(i.wrapperCls=v,i.cls=h,i.iconCls=new An(e.get(r.eventBarIconClsField)||e.iconCls),e.isResourceTimeRange?(i.style="",i.wrapperStyle+=e.style||""):i.style=e.style||"",i.resource=i.resourceRecord=t,i.resourceId=i.rowId,o){var C,S=null,D=null;if(r.eventRenderer){var R=r.eventRenderer.call(r.eventRendererThisObj||r,{eventRecord:e,resourceRecord:t,assignmentRecord:i.assignmentRecord,tplData:i,renderData:i});"string"==typeof i.cls&&(i.cls=new An(i.cls)),"string"==typeof i.wrapperCls&&(i.wrapperCls=new An(i.wrapperCls)),"string"==typeof i.iconCls&&(i.iconCls=new An(i.iconCls)),C=r.eventBodyTemplate?r.eventBodyTemplate(R):R}else r.eventBodyTemplate?C=r.eventBodyTemplate(e):r.eventBarTextField&&(C=e[r.eventBarTextField]||"");if(r.eventBodyTemplate)u.html=C,i.children.push(u);else{var x,E;if(u.children=[],a&&"default"===r.milestoneLayoutMode&&null!=C&&""!==C&&u.children.unshift(D={tag:"label",children:[]}),(null===(x=i.iconCls)||void 0===x?void 0:x.length)&&u.children.unshift({tag:"i",className:i.iconCls}),Array.isArray(C))(E=(D||u).children).push.apply(E,d()(C));else"string"==typeof C&&C.includes("<")?S={html:C}:"string"==typeof C||"object"===l()(C)?S=C:null!=C&&(S=String(C));null!=S&&((D||u).children.push(S),i.cls.add("b-has-content")),u.children.length&&i.children.push(u)}var T=i.eventStyle,M=i.eventColor;if(i.wrapperCls["b-sch-style-".concat(T)]=T,null==M?void 0:M.startsWith("#")){var A=T?"color":"background-color";i.style="".concat(A,":").concat(M,";")+i.style,i.wrapperCls["b-sch-custom-color"]=1}else i.wrapperCls["b-sch-color-".concat(M)]=M;i.style&&a&&u&&(u.style=i.style,delete i.style)}i.cls["b-sch-event-withicon"]=i.iconCls.length,i.eventContent=u,i.wrapperChildren=[],r.onEventDataGenerated(i)}return i}},{key:"onEventDataGenerated",value:function(e){}},{key:"restartInitialAnimation",value:function(e){var t,n=this;null===(t=n.initialAnimationDetacher)||void 0===t||t.call(n),n.initialAnimationDetacher=null,n.useInitialAnimation=e,n.isFirstRender=!0,n.refresh()}},{key:"stopInitialAnimation",value:function(){var e=this;e.initialAnimationDetacher(),e.isFirstRender=!1,e.useInitialAnimation=!1,j.a.isFirefox&&e.setTimeout((function(){return e.element.classList.remove("b-prevent-event-transitions")}),100)}},{key:"eventPrefix",get:function(){return this._eventPrefix},set:function(e){this._eventPrefix=e||this.id+"-"}},{key:"layouts",get:function(){var e=this;return e._eventLayout||(e._eventLayout={},e.horizontalLayoutPackClass&&(e._eventLayout.horizontalPack=new e.horizontalLayoutPackClass(Object.assign({scheduler:e,timeAxisViewModel:e.timeAxisViewModel,bandIndexToPxConvertFn:e.horizontal.layoutEventVerticallyPack,bandIndexToPxConvertThisObj:e.horizontal}))),e.horizontalLayoutStackClass&&(e._eventLayout.horizontalStack=new e.horizontalLayoutStackClass(Object.assign({scheduler:e,timeAxisViewModel:e.timeAxisViewModel,bandIndexToPxConvertFn:e.horizontal.layoutEventVerticallyStack,bandIndexToPxConvertThisObj:e.horizontal})))),e._eventLayout}},{key:"eventLayout",get:function(){return this._overlapMode},set:function(e){var t=this;e!==t._overlapMode&&(t.element.classList.remove("b-eventlayout-".concat(t._overlapMode)),t._overlapMode=e,t.element.classList.add("b-eventlayout-".concat(e)),t.isConfiguring||t.refreshWithTransition())}},{key:"fillTicks",get:function(){return this._fillTicks},set:function(e){e!==this._fillTicks&&(this._fillTicks=e,this.isConfiguring||this.refreshWithTransition())}},{key:"currentEventLayout",get:function(){if(!this.isHorizontal)return null;switch(this.eventLayout){case"stack":return this.layouts.horizontalStack;case"pack":return this.layouts.horizontalPack;default:return null}}},{key:"useInitialAnimation",get:function(){return this._useInitialAnimation},set:function(e){var t=this;t._useInitialAnimation&&t.element.classList.remove("b-initial-".concat(t._useInitialAnimation)),t._useInitialAnimation=!0===e?"fade-in":e,e&&(t.element.classList.add("b-initial-".concat(t._useInitialAnimation)),j.a.isFirefox&&t.element.classList.add("b-prevent-event-transitions"))}},{key:"horizontalEventSorterFn",set:function(e){this._horizontalEventSorterFn=e,this.rendered&&this.refreshWithTransition()},get:function(){return this._horizontalEventSorterFn}},{key:"resourceColumns",set:function(e){this._resourceColumns=e},get:function(){var e;return(null===(e=this.timeAxisColumn)||void 0===e?void 0:e.resourceColumns)||this._resourceColumns}},{key:"resourceColumnWidth",get:function(){return this.resourceColumns?this.resourceColumns.columnWidth:null}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"SchedulerEventRendering"}},{key:"defaultConfig",get:function(){return{eventRenderer:null,eventRendererThisObj:null,eventPrefix:"",eventLayout:"stack",horizontalLayoutPackClass:$T,horizontalLayoutStackClass:jT,horizontalEventSorterFn:null,eventBarTextField:"name",eventBodyTemplate:null,eventPositionMode:"translate",eventScrollMode:"move",fillTicks:!1,useInitialAnimation:!0,resourceColumns:null,resourceImagePath:null,defaultResourceImageName:"none.png",resourceImageExtension:".jpg",resourceMargin:null,isFirstRender:!0,initialAnimationDuration:2e3}}}]),n}(e||ue)}),(function(e){return function(e){fe()(n,e);var t=KM(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"getScheduleRegion",value:function(e,t){var n=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return this.currentOrientation.getScheduleRegion(e,t,n)}},{key:"getResourceRegion",value:function(e,t,n){return this.currentOrientation.getRowRegion(e,t,n)}},{key:"getAssignmentEventBox",value:function(e,t){return this.getResourceEventBox(e.event,e.resource,t)}},{key:"getResourceEventBox",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];return this.currentOrientation.getResourceEventBox(e,t,n,r)}},{key:"getItemBox",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e.resources.map((function(r){return t.getResourceEventBox(e,r,n)}))}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"SchedulerRegions"}}]),n}(e||ue)}),(function(e){return function(e){fe()(n,e);var t=JM(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"afterConstruct",value:function(){we()(pe()(n.prototype),"afterConstruct",this).call(this),this.navigator.on({navigate:"onEventNavigate",thisObj:this})}},{key:"getEventsFromAssignments",value:function(e){return De.unique(e.map((function(e){return e.event})))}},{key:"isEventSelected",value:function(e){return this.selectedEvents.includes(e)}},{key:"isAssignmentSelected",value:function(e){return this.selectedCollection.includes(e)}},{key:"select",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];e.isAssignment?this.selectAssignment(e,t):this.selectEvent(e,t)}},{key:"selectEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.isEventSelected(e)||(t?this.selectedCollection.add(e.assignments):this.selectedEvents=e)}},{key:"selectAssignment",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.isAssignmentSelected(e)||(t?this.selectedCollection.add(e):this.selectedAssignments=e)}},{key:"deselect",value:function(e){e.isAssignment?this.deselectAssignment(e):this.deselectEvent(e)}},{key:"deselectEvent",value:function(e){var t;this.isEventSelected(e)&&(t=this.selectedCollection).remove.apply(t,d()(e.assignments))}},{key:"deselectAssignment",value:function(e){this.isAssignmentSelected(e)&&this.selectedCollection.remove(e)}},{key:"selectEvents",value:function(e){this.selectedCollection.add(e.reduce((function(e,t){return e.push.apply(e,d()(t.assignments)),e}),[]))}},{key:"deselectEvents",value:function(e){this.selectedCollection.remove(e.reduce((function(e,t){return e.push.apply(e,d()(t.assignments)),e}),[]))}},{key:"selectAssignments",value:function(e){this.selectedCollection.add(e)}},{key:"deselectAssignments",value:function(e){this.selectedCollection.remove(e)}},{key:"clearEventSelection",value:function(){this.selectedAssignments=[]}},{key:"onSelectedCollectionChange",value:function(e){var t=e.added,n=e.removed,r=this,i=r.selectedAssignments,o=t||[],a=n||[];function s(e,t){var n=e.event;if(n){var i=r.getElementFromAssignmentRecord(e);r.currentOrientation.toggleCls(e,r.eventSelectedCls,t),r.getElementsFromEventRecord(n).forEach((function(e){if(e!==i){var n=r.resolveAssignmentRecord(e);r.currentOrientation.toggleCls(n,r.eventAssignHighlightCls,t),e.classList[t?"add":"remove"](r.eventAssignHighlightCls)}}))}}if(o.forEach((function(e){return s(e,!0)})),a.forEach((function(e){return s(e,!1)})),r.$selectedAssignments=i.map((function(e){return{eventId:e.eventId,resourceId:e.resourceId}})),!r.silent){var u=i.length>0?o.length>0&&a.length>0?"update":o.length>0?"select":"deselect":"clear";r.trigger("assignmentSelectionChange",{action:u,selection:i,selected:o,deselected:a}),r.trigger("eventSelectionChange",{action:u,selection:r.selectedEvents,selected:r.getEventsFromAssignments(o),deselected:r.getEventsFromAssignments(a)})}}},{key:"onAssignmentChange",value:function(e){var t=e.action,n=e.records,r=this;if(r.silent=!r.triggerSelectionChangeOnRemove,"remove"===t)r.deselectAssignments(n);else if("removeall"!==t||r.eventStore.isSettingData){if("dataset"===t&&r.$selectedAssignments)if(r.maintainSelectionOnDatasetChange){var i=r.$selectedAssignments.map((function(e){return n.find((function(t){return t.eventId===e.eventId&&t.resourceId===e.resourceId}))}));r.selectedAssignments=De.clean(i)}else r.clearEventSelection()}else r.clearEventSelection();r.silent=!1}},{key:"onInternalEventStoreChange",value:function(e){var t=e.action,r=e.records;"dataset"!==t||r.length||this.clearEventSelection(),we()(pe()(n.prototype),"onInternalEventStoreChange",this).apply(this,arguments)}},{key:"onAssignmentSelectionClick",value:function(e,t){var n=this;n.isAssignmentSelected(t)?e.ctrlKey&&n.deselectAssignment(t,n.multiEventSelect):n.selectAssignment(t,e.ctrlKey&&n.multiEventSelect)}},{key:"onEventNavigate",value:function(e){var t=e.event,n=e.item;if(!this.eventSelectionDisabled){var r=n&&(1===n.nodeType?this.resolveAssignmentRecord(n):n);r?this.onAssignmentSelectionClick(t,r):this.clearEventSelection()}}},{key:"selectedCollection",set:function(e){e instanceof no||(e=new no(e)),this._selectedCollection=e,e.on({change:"onSelectedCollectionChange",thisObj:this})},get:function(){return this._selectedCollection}},{key:"selectedEvents",get:function(){return this.getEventsFromAssignments(this.selectedCollection.values)},set:function(e){var t=[];e&&!Array.isArray(e)&&(e=[e]),e&&e.forEach((function(e){t.push.apply(t,d()(e.assignments))})),this.selectedCollection.splice(0,this.selectedCollection.count,t)}},{key:"selectedAssignments",get:function(){return this.selectedCollection.values},set:function(e){this.selectedCollection.splice(0,this.selectedCollection.count,e||[])}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"EventSelection"}},{key:"defaultConfig",get:function(){return{multiEventSelect:!1,eventSelectionDisabled:!1,eventSelectedCls:"b-sch-event-selected",triggerSelectionChangeOnRemove:!1,maintainSelectionOnDatasetChange:!0,eventAssignHighlightCls:"b-sch-event-assign-selected",selectedCollection:{}}}}]),n}(e||ue)}),tA));function BA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}_A.initClass(),_A._$name="SchedulerBase";var HA={add:1,remove:1,update:1,removeAll:1,filter:1},$A=function(e){fe()(n,e);var t=BA(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e,t){var r=this;if(e.isVertical)throw new Error("GroupSummary feature is not supported in vertical mode");r.scheduler=e,we()(pe()(n.prototype),"construct",this).call(this,e,t),!r.summaries&&r.renderer&&(r.summaries=[{renderer:r.renderer}]),r.isScheduler=e instanceof _A,r.isScheduler&&(e.eventStore.on({change:r.onEventStoreChange,thisObj:r}),e.timeAxis.on({reconfigure:r.onTimeAxisChange,thisObj:r}),e.timeAxisViewModel.on({update:r.onTimeAxisChange,thisObj:r}))}},{key:"doDestroy",value:function(){this._tip&&this._tip.destroy(),we()(pe()(n.prototype),"doDestroy",this).call(this)}},{key:"onTimeAxisChange",value:function(){this.rerenderGroupSummaries()}},{key:"onEventStoreChange",value:function(e){var t=e.action;HA[t]&&this.rerenderGroupSummaries()}},{key:"rerenderGroupSummaries",value:function(){this.scheduler.rowManager.rows.forEach((function(e){e.isGroupFooter&&e.render()}))}},{key:"onBeforeRenderRow",value:function(e){var t=e.row,r=e.record;if(t.isGroupFooter&&!r.meta.hasOwnProperty("groupFooterFor")){var i=t.elements.normal.querySelector(".b-sch-timeaxis-cell");i&&(i.innerHTML="")}we()(pe()(n.prototype),"onBeforeRenderRow",this).apply(this,arguments)}},{key:"generateHtml",value:function(e,t,r){if("timeAxis"===e.type){var i=this,o=i.scheduler,a=o.tickSize,s="";return o.isEngineReady&&o.timeAxis.forEach((function(e){var n=o.eventStore.getEvents({startDate:e.startDate,endDate:e.endDate,allowPartial:!0,onlyAssigned:!0}).filter((function(e){return e.resources.some((function(e){return t.includes(e)}))})),r=i.summaries.map((function(t){var r=t.renderer({startDate:e.startDate,endDate:e.endDate,eventStore:o.eventStore,resourceStore:o.resourceStore,events:n});return'<div class="b-timeaxis-summary-value">'.concat(r,"</div>")})).join("");s+='<div class="b-timeaxis-tick" style="width: '.concat(a,'px">').concat(r,"</div>")})),'<div class="b-timeaxis-group-summary">'.concat(s,"</div>")}return we()(pe()(n.prototype),"generateHtml",this).call(this,e,t,r)}},{key:"updateSummaryHtml",value:function(e,t,r){var i=we()(pe()(n.prototype),"updateSummaryHtml",this).call(this,e,t,r);if("timeAxis"===t.type){var o={count:0,height:0};return this.summaries.forEach((function(e){e.height?o.height+=e.height:o.count++})),o}return i}},{key:"getTipHtml",value:function(e){var t=e.activeTarget,n=this,r=Array.from(t.parentElement.children).indexOf(t),i=n.scheduler.timeAxis.getAt(r),o="<header>".concat(n.L("L{Summary.Summary for}",n.scheduler.getFormattedDate(i.startDate)),"</header>"),a=!1;return Cr.forEachSelector(t,".b-timeaxis-summary-value",(function(e,t){var r=n._labels[t],i=e.innerText.trim();o+="<label>".concat(r||"",'</label><div class="b-timeaxis-summary-value">').concat(i,"</div>"),e.innerHTML&&(a=!0)})),a?o:null}},{key:"render",value:function(){var e=this,t=e.scheduler;e.isScheduler&&e.summaries&&e.summaries.some((function(e){return e.label}))&&e.showTooltip&&!e._tip&&(e._labels=e.summaries.map((function(e){return e.label||""})),e._tip=new Kl({id:"".concat(t.id,"-groupsummary-tip"),cls:"b-timeaxis-summary-tip",hoverDelay:0,hideDelay:0,forElement:t.timeAxisSubGridElement,anchorToTarget:!0,forSelector:".b-timeaxis-group-summary .b-timeaxis-tick",clippedBy:[t.timeAxisSubGridElement,t.bodyContainer],getHtml:e.getTipHtml.bind(e)}))}}],[{key:"$name",get:function(){return"GroupSummary"}},{key:"defaultConfig",get:function(){return{showTooltip:!0,summaries:null,renderer:null}}},{key:"pluginConfig",get:function(){return{chain:["render"]}}}]),n}(Gv);function NA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}$A._$name="GroupSummary",fv.registerFeature($A,!1,"Scheduler");var VA=function(e){fe()(n,e);var t=NA(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e,t){we()(pe()(n.prototype),"construct",this).call(this,e,t),this.scheduler=e,y.a.deprecate("Scheduler","5.0.0","`HeaderContextMenu` feature is deprecated, in favor of `TimeAxisHeaderMenu` feature. Please see https://bryntum.com/docs/scheduler/#guides/upgrades/3.1.0.md for more information."),e.features.timeAxisHeaderMenu&&(e.features.timeAxisHeaderMenu.disabled=!0),e.features.headerMenu&&(e.features.headerMenu._showForTimeAxis=!0)}},{key:"populateHeaderMenu",value:function(e){var t=e.column,n=e.items,r=e.menu,i=this;if("timeAxis"===t.type){r&&(r.scrollAction="realign"),an.merge(n,i.defaultItems);var o=an.transformNamedObjectToArray(n);i.extraItems&&o.push.apply(o,d()(i.extraItems)),i.processItems&&i.processItems({items:o});var a=an.transformArrayToNamedObject(o);an.removeAllProperties(n),an.merge(n,a)}}},{key:"onZoomSliderChange",value:function(e){var t=e.value;this.scheduler.zoomLevel=t}},{key:"initDates",value:function(){var e=this;e.startDateField.suspendEvents(),e.endDateField.suspendEvents(),e.startDateField.value=e.startDateFieldInitialValue=e.scheduler.startDate,e.endDateField.value=e.endDateFieldInitialValue=e.scheduler.endDate,e.startDateField.resumeEvents(),e.endDateField.resumeEvents()}},{key:"onRangeDateFieldChange",value:function(e){var t=this,n=e.source===t.startDateField,r=t.client,i=r.timeAxis,o=t.startDateFieldInitialValue&&!n?t.startDateFieldInitialValue:t.startDateField.value,a=t.endDateFieldInitialValue&&n?t.endDateFieldInitialValue:t.endDateField.value;n?t.startDateFieldInitialValue=null:t.endDateFieldInitialValue=null,a-o?a<o&&(a=Zt.add(o,i.shiftIncrement,i.shiftUnit)):a=Zt.add(a,i.shiftIncrement,i.shiftUnit),r.preserveViewCenter((function(){return r.timeAxis.setTimeSpan(o,a)})),t.initDates()}},{key:"onLeftShiftBtnClick",value:function(){this.scheduler.timeAxis.shiftPrevious(),this.initDates()}},{key:"onTodayBtnClick",value:function(){var e=Zt.clearTime(new Date);this.scheduler.timeAxis.setTimeSpan(e,Zt.add(e,1,"day")),this.initDates()}},{key:"onRightShiftBtnClick",value:function(){this.scheduler.timeAxis.shiftNext(),this.initDates()}},{key:"defaultItems",get:function(){var e=this,t=e.scheduler,n=t.timeAxis,r={magnitude:n.shiftIncrement,unit:n.shiftUnit},i={};return i.pickZoomLevel={text:"L{pickZoomLevel}",localeClass:this,icon:"b-fw-icon b-icon-search-plus",disabled:!t.presets.count||e.disabled,menu:{type:"popup",items:[{type:"slider",showValue:!1,listeners:{input:e.onZoomSliderChange,thisObj:e},minWidth:130}],onBeforeShow:function(e){var n=e.source,r=ye()(n.items,1)[0];r.min=t.minZoomLevel,r.max=t.maxZoomLevel,r.value=t.zoomLevel}}},e.startDateField=new pd({label:e.L("L{startText}"),labelWidth:"6em",required:!0,step:r,listeners:{change:e.onRangeDateFieldChange,thisObj:e}}),e.endDateField=new pd({label:e.L("L{endText}"),labelWidth:"6em",required:!0,step:r,listeners:{change:e.onRangeDateFieldChange,thisObj:e}}),i.activeDateRange={text:"L{activeDateRange}",localeClass:this,icon:"b-fw-icon b-icon-calendar",disabled:e.disabled,menu:{type:"popup",width:"20em",items:[e.startDateField,e.endDateField,{type:"button",cls:"b-left-nav-btn",icon:"b-icon b-icon-prev",color:"b-blue b-raised",flex:1,margin:0,listeners:{click:e.onLeftShiftBtnClick,thisObj:e}},{type:"button",cls:"b-today-nav-btn",color:"b-blue b-raised",text:"L{todayText}",localeClass:this,flex:4,margin:"0 8",listeners:{click:e.onTodayBtnClick,thisObj:e}},{type:"button",cls:"b-right-nav-btn",icon:"b-icon b-icon-next",color:"b-blue b-raised",flex:1,listeners:{click:e.onRightShiftBtnClick,thisObj:e}}],onBeforeShow:function(){return e.initDates()}}},i}}],[{key:"$name",get:function(){return"HeaderContextMenu"}},{key:"defaultConfig",get:function(){return{extraItems:null,processItems:null}}},{key:"pluginConfig",get:function(){return{chain:["populateHeaderMenu"]}}}]),n}(qr);function zA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}VA.featureClass="",VA._$name="HeaderContextMenu",fv.registerFeature(VA);var WA=function(e){fe()(n,e);var t=zA(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"onElementMouseDown",value:function(e){var t=this,n=t.client;if(!e.touches&&0===e.button&&!t.disabled&&e.target.matches(".b-sch-header-timeaxis-cell")){var r=n.subGrids.normal.header.headersElement;t.startX=e.clientX,t.element=Cr.createElement({parent:r,tag:"div",className:"b-headerzoom-rect"}),t.headerElementRect=En.from(r)}}},{key:"onElementMouseMove",value:function(e){var t=this;if(0!==e.buttons||j.a.isSafari||j.a.isIE11&&!e.isTrusted){if("number"==typeof t.startX){var n=Math.max(e.clientX,t.headerElementRect.left),r=Math.min(t.startX,n),i=Math.abs(t.startX-n),o=new En(r-t.headerElementRect.x+t.client.scrollLeft,0,i,t.headerElementRect.height);Cr.setTranslateX(t.element,o.left),t.element.style.width=o.width+"px"}}else t.onElementMouseUp(e)}},{key:"onElementMouseUp",value:function(e){var t=this;if("number"==typeof t.startX){var n=t.client,r=En.from(t.element),i=n.getDateFromCoordinate(r.left,"round",!1),o=n.getDateFromCoordinate(r.right,"round",!1);t.element&&t.element.remove(),t.startX=null,t.client.zoomToSpan({startDate:i,endDate:o})}}}],[{key:"$name",get:function(){return"HeaderZoom"}},{key:"pluginConfig",get:function(){return{chain:["onElementMouseDown","onElementMouseMove","onElementMouseUp"]}}}]),n}(qr);function GA(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return YA(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return YA(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function YA(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function UA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}WA._$name="HeaderZoom",fv.registerFeature(WA,!1,"Scheduler");var qA=function(e){fe()(n,e);var t=UA(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e,t){var r=this;we()(pe()(n.prototype),"construct",this).call(this,e,t),r.cls=r.cls||"b-timerange-".concat(r.constructor.$$name),r.baseSelector=".".concat(r.baseCls,".").concat(r.cls),r.enableResizing&&(r.showHeaderElements=!0)}},{key:"doDestroy",value:function(){var e,t,r,i,o,a=this;null===(e=a.storeDetacher)||void 0===e||e.call(a),a.detachListeners("timeAxisViewModel"),a.detachListeners("timeAxis"),null===(t=a.clockTemplate)||void 0===t||t.destroy(),null===(r=a.tip)||void 0===r||r.destroy(),null===(i=a.drag)||void 0===i||i.destroy(),null===(o=a.resize)||void 0===o||o.destroy(),we()(pe()(n.prototype),"doDestroy",this).call(this)}},{key:"doDisable",value:function(e){this.client.isPainted&&this.renderRanges(),we()(pe()(n.prototype),"doDisable",this).call(this,e)}},{key:"onPaint",value:function(){var e=this,t=e.client;e.isPainted||(e.timeAxisViewModel=t.timeAxisViewModel,e.timeAxisViewModel.on({name:"timeAxisViewModel",update:"onTimeAxisViewModelUpdate",thisObj:e}),t.timeAxis.on({name:"timeAxis",includeChange:"onTimeAxisViewModelUpdate",thisObj:e}),e.enableResizing&&!t.hideHeaders&&(e.drag=new hu({name:"rangeDrag",mode:t.isVertical?"translateY":"translateX",constrain:!0,outerElement:e.headerContainerElement,targetSelector:"".concat(e.baseSelector),isElementDraggable:function(n,r){return!t.readOnly&&e.isElementDraggable(n,r)},transitionDuration:t.transitionDuration,listeners:{dragstart:"onDragStart",drag:"onDrag",drop:"onDrop",abort:"onInvalidDrop",thisObj:e}}),e.resize=new Su({direction:t.mode,targetSelector:"".concat(e.baseSelector,".b-sch-range"),outerElement:e.headerContainerElement,isElementResizable:function(e){return!e.closest(".b-dragging")},listeners:{resizestart:"onResizeStart",resizing:"onResizeDrag",resize:"onResize",cancel:"onInvalidResize",thisObj:e}})),e.renderRanges())}},{key:"renderRanges",value:function(){var e=this,t=e.client.foregroundCanvas;if(t){var n=e.headerContainerElement;if(Cr.removeEachSelector(t,e.baseSelector),n&&Cr.removeEachSelector(n,e.baseSelector),!e.disabled){var r,i=GA(e.timeRanges);try{for(i.s();!(r=i.n()).done;){var o=r.value;e.renderRange(o,!0)}}catch(e){i.e(e)}finally{i.f()}}}}},{key:"shouldRenderRange",value:function(e){var t=this.client.timeAxis;return e.duration&&t.timeSpanInAxis(e.startDate,e.endDate)||e.startDate&&t.dateInAxis(e.startDate)}},{key:"renderRange",value:function(e,t){var n=this,r=n.client;if(n.shouldRenderRange(e)){var i,o,a=r.getCoordinateFromDate(Zt.max(e.startDate,r.timeAxis.startDate),{respectExclusion:!0}),s=e.duration&&r.getCoordinateFromDate(Zt.min(e.endDate,r.timeAxis.endDate),{respectExclusion:!0,isEnd:!0}),u=s-a,c="<label>".concat(e.iconCls?'<i class="'.concat(e.iconCls,'"></i>'):""," ").concat(e.name||"&nbsp;","</label>"),l={className:(i={},ke()(i,n.baseCls,1),ke()(i,n.cls,n.cls),ke()(i,n.rangeCls,s),ke()(i,n.lineCls,!s),ke()(i,e.cls,e.cls),ke()(i,"b-narrow-range",s&&u<n.narrowThreshold),i),dataset:{id:e.id},style:r.isVertical?"transform: translateY(".concat(a,"px); ").concat(s?"height:".concat(u,"px"):"",";"):"transform: translateX(".concat(a,"px); ").concat(s?"width:".concat(u,"px"):"",";"),retainElement:!0},f=Cr.createElement(Object.assign({},l,{parent:t&&r.foregroundCanvas,style:l.style+(e.style||""),html:n.showHeaderElements&&!n.showLabelInBody?"":c}));n.showHeaderElements&&(o=Cr.createElement(Object.assign({parent:t&&n.headerContainerElement,html:e.name&&!n.showLabelInBody?c:""},l)));var d={bodyElement:f,headerElement:o};return t&&n.rotateLabel(e,d),d}}},{key:"rotateLabel",value:function(e,t){var n=t.bodyElement;if(e.iconCls||e.name){var r=n.firstChild;if(r){r.classList.remove("b-vertical");var i=this.client.isVertical?r.offsetHeight<n.offsetHeight:r.offsetWidth>n.offsetWidth;r.classList[i?"add":"remove"]("b-vertical")}}}},{key:"getElementsByRecord",value:function(e){var t="object"!==l()(e)?e:e.id,n=this.client.foregroundCanvas.querySelector("".concat(this.baseSelector,'[data-id="').concat(t,'"]')),r=this.headerContainerElement.querySelector("".concat(this.baseSelector,'[data-id="').concat(t,'"]'));return n?{bodyElement:n,headerElement:r}:null}},{key:"getBodyElementByRecord",value:function(e){var t="string"==typeof e?e:e.id;return this.client.foregroundCanvas.querySelector("".concat(this.baseSelector,'[data-id="').concat(t,'"]'))}},{key:"getRecordByElement",value:function(e){return this.store.getById(e.dataset.id)}},{key:"populateHeaderMenu",value:function(e){var t=e.column;e.items;"timeAxis"===t.type&&this.populateTimeAxisHeaderMenu.apply(this,arguments)}},{key:"populateTimeAxisHeaderMenu",value:function(e){e.column,e.items}},{key:"onTimeAxisViewModelUpdate",value:function(){this.renderRanges()}},{key:"onStoreChanged",value:function(e){var t=this;if(!(t.disabled||t.isConfiguring||"refresh"===e.type&&"batch"!==e.action))if("update"===e.action){var n=e.record,r=e.changes.hasOwnProperty("id")?e.changes.id.oldValue:n.id,i=t.getElementsByRecord(r),o=t.renderRange(n,!i);if(i&&!o&&(i.bodyElement.remove(),i.headerElement&&i.headerElement.remove()),!i||!o)return;t.client.runWithTransition((function(){Cr.sync(o.bodyElement,i.bodyElement),t.showHeaderElements&&Cr.sync(o.headerElement,i.headerElement),t.rotateLabel(n,i)}))}else t.renderRanges()}},{key:"showTip",value:function(e){var t=this;t.showTooltip&&(t.clockTemplate=new eE({scheduler:t.client}),t.tip=new Kl({id:"".concat(t.client.id,"-time-range-tip"),cls:"b-interaction-tooltip",align:"b-t",autoShow:!0,updateContentOnMouseMove:!0,forElement:e.element,getHtml:function(){return t.getTipHtml(e.record,e.element)}}))}},{key:"isElementDraggable",value:function(e){return(e=e.closest(this.baseSelector+":not(.b-resizing)"))&&!e.classList.contains("b-over-resize-handle")}},{key:"onDragStart",value:function(e){var t=e.context,n=this,r=n.getRecordByElement(t.element.closest(n.baseSelector)),i=n.getBodyElementByRecord(r),o=n.drag;Object.assign(t,{record:r,rangeBodyEl:i,originRangeX:Cr.getTranslateX(i),originRangeY:Cr.getTranslateY(i)}),n.client.isVertical?(o.minY=0,o.maxY=n.timeAxisViewModel.totalSize-t.rangeBodyEl.offsetHeight,o.minX=0,o.maxX=Number.MAX_SAFE_INTEGER):(o.minX=0,o.maxX=n.timeAxisViewModel.totalSize-t.rangeBodyEl.offsetWidth,o.minY=0,o.maxY=Number.MAX_SAFE_INTEGER),n.client.element.classList.add("b-dragging-timerange"),n.showTip(t)}},{key:"onDrag",value:function(e){var t=e.context;this.client.isVertical?Cr.setTranslateY(t.rangeBodyEl,Cr.getTranslateY(t.element)):Cr.setTranslateX(t.rangeBodyEl,Cr.getTranslateX(t.element))}},{key:"onDrop",value:function(e){var t=e.context;if(!t.valid)return this.onInvalidDrop({context:t});var n=this,r=t.record,i=t.rangeBodyEl.getBoundingClientRect(),o=n.client.getDateFromCoordinate(n.client.isVertical?i.top:i.left,"round",!1);r.startDate-o!=0?r.setStartDate(o):n.onInvalidDrop(),n.tip&&(n.tip.destroy(),n.tip=null),n.client.element.classList.remove("b-dragging-timerange")}},{key:"onInvalidDrop",value:function(){var e=this;e.drag.reset(),e.renderRanges(),e.client.element.classList.remove("b-dragging-timerange"),e.tip&&(e.tip.destroy(),e.tip=null)}},{key:"onResizeStart",value:function(e){var t=e.context,n=this.getRecordByElement(t.element.closest(this.baseSelector)),r=this.getBodyElementByRecord(n);Object.assign(t,{record:n,rangeBodyEl:r}),this.showTip(t)}},{key:"onResizeDrag",value:function(e){var t=e.context;this.client.isVertical?("top"===t.edge&&Cr.setTranslateY(t.rangeBodyEl,t.newY),t.rangeBodyEl.style.height=t.newHeight+"px"):("left"===t.edge&&Cr.setTranslateX(t.rangeBodyEl,t.newX),t.rangeBodyEl.style.width=t.newWidth+"px")}},{key:"onResize",value:function(e){var t=e.context;if(!t.valid)return this.onInvalidDrop({context:t});var n=this,r=n.client,i=t.record,o=t.element.getBoundingClientRect(),a=r.isVertical?o.top:o.left,s=r.isVertical?o.bottom:o.right,u=r.getDateFromCoordinate(a,"round",!1),c="left"===t.edge||"top"===t.edge,l=r.getDateFromCoordinate(s,"round",!1);(c&&i.startDate-u!=0||l&&i.endDate-l!=0)&&l>u?c?i.setStartDate(u,!1):i.setEndDate(l,!1):n.onInvalidResize(),n.tip&&(n.tip.destroy(),n.tip=null)}},{key:"onInvalidResize",value:function(){var e=this;e.resize.reset(),e.renderRanges(),e.tip&&(e.tip.destroy(),e.tip=null)}},{key:"getTipHtml",value:function(e,t){var n=this.client,r=t.getBoundingClientRect(),i=n.isVertical?r.top:r.left,o=n.isVertical?r.bottom:r.right,a=n.getDateFromCoordinate(i,"round",!1),s=e.endDate&&n.getDateFromCoordinate(o,"round",!1),u=n.getFormattedDate(a),c=s&&n.getFormattedEndDate(s,a);return this.dragTipTemplate({name:e.name||"",startDate:a,endDate:s,startText:u,endText:c,startClockHtml:this.clockTemplate.template({date:a,text:u,cls:"b-sch-tooltip-startdate"}),endClockHtml:c&&this.clockTemplate.template({date:s,text:c,cls:"b-sch-tooltip-enddate"})})}},{key:"timeRanges",get:function(){return this.store.records}},{key:"headerContainerElement",get:function(){var e=this.client,t=e.isVertical,n=e.timeView,r=e.timeAxisColumn,i=null;return t&&n.element?i=n.element.parentElement:t||(i=r.element),i}},{key:"showHeaderElements",get:function(){return this._showHeaderElements},set:function(e){this._showHeaderElements=e,this.client.isPainted&&(e?this.client.element.classList.add("b-sch-timeranges-with-headerelements"):this.client.element.classList.remove("b-sch-timeranges-with-headerelements"),this.renderRanges())}},{key:"store",get:function(){return this._store},set:function(e){var t=this;t._store=No.getStore(e,No);var n=!1;t.storeDetacher&&(t.storeDetacher(),n=!0),t.storeDetacher=t._store.on({change:t.onStoreChanged,refresh:t.onStoreChanged,thisObj:t}),n&&this.renderRanges()}}],[{key:"defaultConfig",get:function(){return{rangeCls:"b-sch-range",lineCls:"b-sch-line",store:{modelClass:Qy},enableResizing:!1,showTooltip:!0,showHeaderElements:!0,dragTipTemplate:function(e){return'\n                <div class="b-sch-tip-'.concat(e.valid?"valid":"invalid",'">\n                    <div class="b-sch-tip-name">').concat(e.name||"","</div>\n                    ").concat(e.startClockHtml,"\n                    ").concat(e.endClockHtml||"","\n                </div>\n            ")},baseCls:"b-sch-timerange",cls:"",narrowThreshold:80}}},{key:"pluginConfig",get:function(){return{chain:["onPaint","populateHeaderMenu","populateTimeAxisHeaderMenu"]}}}]),n}(qr.mixin(_a));function KA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}qA._$name="AbstractTimeRanges";var XA=function(e){fe()(n,e);var t=KA(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"doDestroy",value:function(){this.attachToCalendar(null),we()(pe()(n.prototype),"doDestroy",this).call(this)}},{key:"attachToProject",value:function(e){var t=this;we()(pe()(n.prototype),"attachToProject",this).call(this,e),this.attachToCalendar(e.effectiveCalendar),e.on({name:"project",calendarChange:function(){return t.attachToCalendar(t.project.effectiveCalendar)},thisObj:this})}},{key:"onTimeAxisViewModelUpdate",value:function(){return this._timeAxisUnitDurationMs=null,we()(pe()(n.prototype),"onTimeAxisViewModelUpdate",this).call(this)}},{key:"attachToCalendar",value:function(e){var t=this,n=t.project,r=t.client;t.detachListeners("calendar"),e&&(r.isSchedulerPro||r.isGantt||e!==n.defaultCalendar||n.defaultCalendar.intervalStore.count||e.addIntervals([{recurrentStartDate:"on Sat at 0:00",recurrentEndDate:"on Mon at 0:00",isWorking:!1}]),e.intervalStore.on({name:"calendar",change:t.renderRanges,delay:1,thisObj:t})),r.isEngineReady?t.renderRanges():n.isDestroyed||n.on({refresh:t.renderRanges,thisObj:t,once:!0})}},{key:"shouldRenderRange",value:function(e){return we()(pe()(n.prototype),"shouldRenderRange",this).call(this,e)&&e.durationMS>=this.timeAxisUnitDurationMs}},{key:"renderRanges",value:function(){var e=this,t=e.store,r=e.calendar,i=e.client,o=i.timeAxis,a=i.foregroundCanvas;if(r&&a&&t&&!t.isDestroyed){if(!e.disabled){var s=!e.maxTimeAxisUnit||Zt.compareUnits(o.unit,e.maxTimeAxisUnit)<=0;if(t.removeAll(!0),r&&e.highlightWeekends&&s&&o.count){var u,c=r.getNonWorkingTimeRanges(o.startDate,o.endDate).map((function(e,t){return{name:e.name,cls:"b-nonworkingtime",startDate:e.startDate,endDate:e.endDate}})),l=[];c.forEach((function(e){u&&e.startDate<=u.endDate&&e.name===u.name?u.endDate=e.endDate:(l.push(e),e.id="nonworking-".concat(l.length),u=e)})),t.add(l,!0)}}we()(pe()(n.prototype),"renderRanges",this).call(this)}}},{key:"calendar",get:function(){var e;return null===(e=this.project)||void 0===e?void 0:e.effectiveCalendar}},{key:"timeAxisUnitDurationMs",get:function(){return this._timeAxisUnitDurationMs||(this._timeAxisUnitDurationMs=Zt.as("ms",1,this.client.timeAxis.unit)),this._timeAxisUnitDurationMs}}],[{key:"$name",get:function(){return"NonWorkingTime"}},{key:"defaultConfig",get:function(){return{highlightWeekends:!0,showHeaderElements:!0,showLabelInBody:!0,cls:"b-sch-nonworkingtime",maxTimeAxisUnit:"week"}}},{key:"pluginConfig",get:function(){return{chain:["onPaint","attachToProject"]}}}]),n}(qA.mixin(rA));function ZA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}XA._$name="NonWorkingTime",fv.registerFeature(XA,!1,"Scheduler"),fv.registerFeature(XA,!0,"SchedulerPro"),fv.registerFeature(XA,!0,"Gantt");var JA=function(e){fe()(n,e);var t=ZA(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e,t){if(this.timeline=e,e.features.eventDragCreate&&!e.features.eventDragCreate.disabled)throw new Error("Cannot combine Pan and eventDragCreate features");this.targetSelector=[".b-grid-cell",".b-timeline-subgrid"].join(","),we()(pe()(n.prototype),"construct",this).call(this,e,t)}},{key:"onElementMouseDown",value:function(e){var t=this,n=t.timeline,r=Object.values(n.features).find((function(e){return e instanceof nE})),i=n.readOnly||!r||r.disabled;e.touches||0!==e.button||t.disabled||(e.target.matches(t.targetSelector)||i&&e.target.closest(n.eventSelector))&&(t.mouseX=e.clientX,t.mouseY=e.clientY)}},{key:"onElementMouseMove",value:function(e){var t=this;if(0!==e.buttons||j.a.isSafari||j.a.isIE11&&!e.isTrusted){if("number"==typeof t.mouseX){var n=t.timeline.subGrids.normal.scrollable,r=t.timeline.scrollable,i=e.clientX,o=e.clientY;e.preventDefault(),t.vertical&&r.scrollBy(0,t.mouseY-o),n.scrollBy(t.mouseX-i),t.mouseX=i,t.mouseY=o}}else t.onElementMouseUp()}},{key:"onElementMouseUp",value:function(e){this.mouseX=this.mouseY=null}}],[{key:"$name",get:function(){return"Pan"}},{key:"defaultConfig",get:function(){return{vertical:!0}}},{key:"pluginConfig",get:function(){return{chain:["onElementMouseDown","onElementMouseMove","onElementMouseUp"]}}}]),n}(qr);function QA(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}JA._$name="Pan",fv.registerFeature(JA,!1,["Scheduler","Gantt"]);var eP=function(e){fe()(n,e);var t=QA(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"noFeatureElementsInAxis",value:function(){var e=this.scheduler.timeAxis;return this.store&&!this.store.storage.values.some((function(t){return e.isTimeSpanInAxis(t)}))}},{key:"construct",value:function(e,t){this.scheduler=e,we()(pe()(n.prototype),"construct",this).call(this,e,t)}},{key:"doDisable",value:function(e){this.client.isPainted&&this.client.refresh(),we()(pe()(n.prototype),"doDisable",this).call(this,e)}},{key:"getEventsToRender",value:function(e,t){throw new Error("Implement in subclass")}},{key:"onEventDataGenerated",value:function(e){var t=this,n=e.eventRecord;t.shouldInclude(n)&&(t.scheduler.isVertical?e.width=t.scheduler.resourceColumnWidth:e.top=0,e.fillSize=!0,e.wrapperCls[t.rangeCls]=1,e.wrapperCls["b-sch-color-".concat(n.timeRangeColor)]=n.timeRangeColor,e.children.push(n.name),e.eventId="".concat(t.idPrefix,"-").concat(n.id))}},{key:"shouldInclude",value:function(e){throw new Error("Implement in subclass")}},{key:"onStoreChange",value:function(e){this.scheduler.onInternalEventStoreChange(e)}}],[{key:"pluginConfig",get:function(){return{chain:["getEventsToRender","onEventDataGenerated","noFeatureElementsInAxis"]}}}]),n}(qr.mixin(rA));function tP(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}eP.featureClass="",eP._$name="ResourceTimeRangesBase";var nP=function(e){fe()(n,e);var t=tP(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"attachToProject",value:function(e){var t=this,r=t.scheduler;if(we()(pe()(n.prototype),"attachToProject",this).call(this,e),!e.resourceTimeRangeStore){e.resourceTimeRangeStore=t._store||r.resourceTimeRangeStore||new rm;var i=r.crudManager;i&&!i.resourceTimeRangeStore&&(i.resourceTimeRangeStore=e.resourceTimeRangeStore)}var o=e.resourceTimeRangeStore;t.exposedOnScheduler||(r.resourceTimeRanges&&(o.add(r.resourceTimeRanges),delete r.resourceTimeRanges),Object.defineProperty(r,"resourceTimeRanges",{get:function(){return o.records},set:function(e){return o.data=e}}),Object.defineProperty(r,"resourceTimeRangeStore",{get:function(){return o}}),t.exposedOnScheduler=!0),o.resourceStore||(o.resourceStore=e.resourceStore),t.detachListeners("store"),o.on({name:"store",change:t.onStoreChange,thisObj:t})}},{key:"getEventsToRender",value:function(e,t){return e.timeRanges&&e.timeRanges.length&&!this.disabled&&t.push.apply(t,d()(e.timeRanges)),t}},{key:"shouldInclude",value:function(e){return e.isResourceTimeRange&&!e.isNonWorking}},{key:"store",set:function(e){this._store=e},get:function(){return this.project.resourceTimeRangeStore}}],[{key:"$name",get:function(){return"ResourceTimeRanges"}},{key:"defaultConfig",get:function(){return{idPrefix:"resourcetimerange",rangeCls:"b-sch-resourcetimerange",store:!1,resourceTimeRanges:null}}}]),n}(eP);function rP(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}nP.featureClass="",nP._$name="ResourceTimeRanges",fv.registerFeature(nP,!1,"Scheduler");var iP=function(e){fe()(n,e);var t=rP(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"shouldShowMenu",value:function(e){var t=this.client,n=e.column,r=e.targetElement,i=e.resourceRecord;return(n?n===t.timeAxisColumn:t.timeAxisSubGrid.element===r)&&!(i&&i.isSpecialRow)}},{key:"getDataFromEvent",value:function(e){var t=this.client,r=t.getCellDataFromEvent(e),i=t.getDateFromDomEvent(e,"floor"),o=t.resolveResourceRecord(e)||t.resourceStore.last;return an.assign(we()(pe()(n.prototype),"getDataFromEvent",this).call(this,e),r,{date:i,resourceRecord:o})}},{key:"populateScheduleMenu",value:function(e){var t=e.items,n=this.client;n.readOnly||(t.addEvent={text:"L{SchedulerBase.Add event}",icon:"b-icon b-icon-add",disabled:0===n.resourceStore.count,weight:100,onItem:function(e){var t=e.date,r=e.resourceRecord;n.internalAddEvent(t,r,n.getRowFor(r))}})}}],[{key:"$name",get:function(){return"ScheduleMenu"}},{key:"defaultConfig",get:function(){return{type:"schedule"}}},{key:"pluginConfig",get:function(){var e=we()(pe()(n),"pluginConfig",this);return e.chain.push("populateScheduleMenu"),e}}]),n}(qx);function oP(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}iP.featureClass="",iP._$name="ScheduleMenu",fv.registerFeature(iP,!0,"Scheduler");var aP=function(e){fe()(n,e);var t=oP(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e,t){we()(pe()(n.prototype),"construct",this).call(this,e,t),this.scheduler=e,y.a.deprecate("Scheduler","5.0.0","`ScheduleContextMenu` feature is deprecated, in favor of `ScheduleMenu` feature. Please see https://bryntum.com/docs/scheduler/#guides/upgrades/3.1.0.md for more information."),e.features.scheduleMenu&&(e.features.scheduleMenu.disabled=!0)}}],[{key:"$name",get:function(){return"ScheduleContextMenu"}}]),n}(iP);function sP(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}aP.featureClass="",aP._$name="ScheduleContextMenu",fv.registerFeature(aP);var uP=function(e){fe()(n,e);var t=sP(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"findPath",value:function(e,t){var n,r,i,o,a,s,u,c,l,f,d,h,v,p,g,y,m,k,b,w,C,S,D,R,x,E,T,M,A,P,I,O=this;for(t&&!Array.isArray(t)&&(t=[t]),I=0;e&&!P;)for(r=(n=Object.assign(O.config,e)).startBox,i=n.endBox,o=n.startShift,a=n.endShift,s=n.startSide,u=n.endSide,c=n.startArrowSize,l=n.endArrowSize,f=n.startArrowMargin,d=n.endArrowMargin,h=n.horizontalMargin,v=n.verticalMargin,p=n.hasOwnProperty("startHorizontalMargin")?n.startHorizontalMargin:h,g=n.hasOwnProperty("startVerticalMargin")?n.startVerticalMargin:v,y=n.hasOwnProperty("endHorizontalMargin")?n.endHorizontalMargin:h,m=n.hasOwnProperty("endVerticalMargin")?n.endVerticalMargin:v,k=n.hasOwnProperty("otherHorizontalMargin")?n.otherHorizontalMargin:h,b=n.hasOwnProperty("otherVerticalMargin")?n.otherVerticalMargin:v,w=n.otherBoxes,s=O.normalizeSide(s),u=O.normalizeSide(u),C=O.getConnectionCoordinatesFromBoxSideShift(r,s,o),S=O.getConnectionCoordinatesFromBoxSideShift(i,u,a),T=O.calcGridBaseBoxFromBoxAndDrawParams(r,s,c,f,p,g),M=O.calcGridBaseBoxFromBoxAndDrawParams(i,u,l,d,y,m),w=w&&w.map((function(e){return O.calcGridBaseBoxFromBoxAndDrawParams(e,!1,0,0,k,b)})),D=O.getConnectionCoordinatesFromBoxSideShift(T,s,o),R=O.getConnectionCoordinatesFromBoxSideShift(M,u,a),A=O.buildPathGrid(T,M,D,R,s,u,w),x=O.convertDecartPointToGridPoint(A,D),E=O.convertDecartPointToGridPoint(A,R),P=O.findPathOnGrid(A,x,E,s,u),e=!1;!P&&!e&&t&&I<t.length;I++)e=t[I](n);return P&&(P=O.prependPathWithArrowStaffSegment(P,C,c,s),P=O.appendPathWithArrowStaffSegment(P,S,l,u),P=O.optimizePath(P)),P}},{key:"getConnectionCoordinatesFromBoxSideShift",value:function(e,t,n){var r;switch(t){case"left":r={x:e.start,y:(e.top+e.bottom)/2+n};break;case"right":r={x:e.end,y:(e.top+e.bottom)/2+n};break;case"top":r={x:(e.start+e.end)/2+n,y:e.top};break;case"bottom":r={x:(e.start+e.end)/2+n,y:e.bottom}}return r}},{key:"calcGridBaseBoxFromBoxAndDrawParams",value:function(e,t,n,r,i,o){var a;switch(t){case"left":a={start:e.start-Math.max(n+r,i),end:e.end+i,top:e.top-o,bottom:e.bottom+o};break;case"right":a={start:e.start-i,end:e.end+Math.max(n+r,i),top:e.top-o,bottom:e.bottom+o};break;case"top":a={start:e.start-i,end:e.end+i,top:e.top-Math.max(n+r,o),bottom:e.bottom+o};break;case"bottom":a={start:e.start-i,end:e.end+i,top:e.top-o,bottom:e.bottom+Math.max(n+r,o)};break;default:a={start:e.start-i,end:e.end+i,top:e.top-o,bottom:e.bottom+o}}return a}},{key:"buildPathGrid",value:function(e,t,n,r,i,o,a){var s,u,c,l,f,h,v,p,g,y,m,k,b,w={},C=[];for(s=[e.start,"left"===i||"right"===i?(e.start+e.end)/2:n.x,e.end,t.start,"left"===o||"right"===o?(t.start+t.end)/2:r.x,t.end],u=[e.top,"top"===i||"bottom"===i?(e.top+e.bottom)/2:n.y,e.bottom,t.top,"top"===o||"bottom"===o?(t.top+t.bottom)/2:r.y,t.bottom],a&&a.forEach((function(e){s.push(e.start,(e.start+e.end)/2,e.end),u.push(e.top,(e.top+e.bottom)/2,e.bottom)})),s=d()(new Set(s.sort((function(e,t){return e-t})))),h=0,p=(u=d()(new Set(u.sort((function(e,t){return e-t}))))).length;h<p;++h)for(w[h]=w[h]||{},c=u[h],f=0,v=s.length;f<v;++f){if(k=((l=s[f])<=e.start||l>=e.end||c<=e.top||c>=e.bottom)&&(l<=t.start||l>=t.end||c<=t.top||c>=t.bottom),a)for(g=0,y=a.length;k&&g<y;++g)k=l<=(m=a[g]).start||l>=m.end||c<=m.top||c>=m.bottom||l===n.x&&c===n.y||l===r.x&&c===r.y;b={distance:Math.pow(2,53)-1,permitted:k,x:l,y:c,ix:f,iy:h},w[h][f]=b,C.push(b)}return{width:s.length,height:u.length,xs:s,ys:u,points:w,linearPoints:C}}},{key:"convertDecartPointToGridPoint",value:function(e,t){var n=e.xs.indexOf(t.x),r=e.ys.indexOf(t.y);return e.points[r][n]}},{key:"findPathOnGrid",value:function(e,t,n,r,i){var o=!1;return t.permitted&&n.permitted&&(e=this.waveForward(e,t,0),o=this.collectPath(e,n,i)),o}},{key:"getGridPointNeighbors",value:function(e,t,n){var r,i=t.ix,o=t.iy,a=[];return o<e.height-1&&(r=e.points[o+1][i],(!n||n(r))&&a.push(r)),o>0&&(r=e.points[o-1][i],(!n||n(r))&&a.push(r)),i<e.width-1&&(r=e.points[o][i+1],(!n||n(r))&&a.push(r)),i>0&&(r=e.points[o][i-1],(!n||n(r))&&a.push(r)),a}},{key:"waveForward",value:function(e,t,n){var r=this;return Fo.preWalkUnordered([t,n],(function(t){var n=ye()(t,2),i=n[0],o=n[1];return r.getGridPointNeighbors(e,i,(function(e){return e.permitted&&e.distance>o+1})).map((function(e){return[e,o+1]}))}),(function(e){var t=ye()(e,2),n=t[0],r=t[1];return n.distance=r})),e}},{key:"collectPath",value:function(e,t,n){for(var r,i,o,a,s=!0,u=[];s&&t.distance;)if(s=(r=this.getGridPointNeighbors(e,t,(function(e){return e.permitted&&e.distance==t.distance-1}))).length>0){switch(i=(r=r.sort((function(e,r){var i,o;i=e.ix-t.ix,o=e.iy-t.iy;var a=("left"===n||"right"===n)&&0===o||("top"===n||"bottom"===n)&&0===i?-1:1;i=r.ix-t.ix,o=r.iy-t.iy;var s=("left"===n||"right"===n)&&0===o||("top"===n||"bottom"===n)&&0===i?-1:1;return a>s?1:a<s?-1:a===s?e.y>r.y?-1:1:void 0})))[0],u.push({x1:i.x,y1:i.y,x2:t.x,y2:t.y}),o=i.ix-t.ix,a=i.iy-t.iy,!0){case!a&&o>0:n="left";break;case!a&&o<0:n="right";break;case!o&&a>0:n="top";break;case!o&&a<0:n="bottom"}t=i}return s&&u.reverse()||!1}},{key:"prependPathWithArrowStaffSegment",value:function(e,t,n,r){var i,o;if(e.length>0){switch(i={x2:(o=e[0]).x1,y2:o.y1},r){case"left":i.x1=t.x-n,i.y1=o.y1;break;case"right":i.x1=t.x+n,i.y1=o.y1;break;case"top":i.x1=o.x1,i.y1=t.y-n;break;case"bottom":i.x1=o.x1,i.y1=t.y+n}e.unshift(i)}return e}},{key:"appendPathWithArrowStaffSegment",value:function(e,t,n,r){var i,o;if(e.length>0){switch(i={x1:(o=e[e.length-1]).x2,y1:o.y2},r){case"left":i.x2=t.x-n,i.y2=o.y2;break;case"right":i.x2=t.x+n,i.y2=o.y2;break;case"top":i.x2=o.x2,i.y2=t.y-n;break;case"bottom":i.x2=o.x2,i.y2=t.y+n}e.push(i)}return e}},{key:"optimizePath",value:function(e){var t,n,r=[];if(e.length>0)for(t=e.shift(),r.push(t);e.length>0;)n=e.shift(),t.x1==n.x1&&t.y1==n.y1&&t.x2==n.x2&&t.y2==n.y2?t=n:t.y1-t.y2==0&&n.y1-n.y2==0?t.x2=n.x2:t.x1-t.x2==0&&n.x1-n.x2==0?t.y2=n.y2:(r.push(n),t=n);return r}},{key:"normalizeSide",value:function(e){return n.sideToSide[e]||e}}],[{key:"defaultConfig",get:function(){return{startSide:"right",startArrowSize:0,startArrowMargin:12,startShift:0,endSide:"left",endArrowSize:0,endArrowMargin:12,endShift:0,verticalMargin:2,horizontalMargin:5,otherBoxes:null}}},{key:"sideToSide",get:function(){return{l:"left",r:"right",t:"top",b:"bottom"}}}]),n}(ue);function cP(){var e=El()(['\n             <table class="b-sch-dependency-tooltip">\n                <tr>\n                    <td>',": </td>\n                    <td>",'</td>\n                    <td>\n                        <div class="b-sch-box b-','"></div>\n                    </td>\n                </tr>\n                <tr>\n                    <td>',": </td>\n                    <td>",'</td>\n                    <td><div class="b-sch-box b-','"></div></td>\n                </tr>\n            </table>\n        ']);return cP=function(){return e},e}function lP(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return fP(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return fP(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function fP(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function dP(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}uP._$name="RectangularPathFinder";var hP=["left","left","right","right"],vP=["left","right","left","right"],pP=function(e){fe()(r,e);var t,n=dP(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"construct",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=this;if(e.isVertical)throw new Error("Dependencies feature is not supported in vertical mode");n.doScheduleDraw=n.createOnFrame("draw",[],n,!0),we()(pe()(r.prototype),"construct",this).call(this,e,t),n.pathFinder=new uP(n.pathFinderConfig),delete n.pathFinderConfig,n.lineDefAdjusters=n.createLineDefAdjusters(),e.rowManager.on({refresh:"onRefresh",thisObj:n})}},{key:"doDestroy",value:function(){var e;null===(e=this.tooltip)||void 0===e||e.destroy(),we()(pe()(r.prototype),"doDestroy",this).call(this)}},{key:"doDisable",value:function(e){var t=this,n=t.project;t.updateCreateListeners(),(n||e)&&(t.attachToResourceStore(e?null:n.resourceStore),t.attachToEventStore(e?null:n.eventStore),t.attachToAssignmentStore(e?null:n.assignmentStore),t.attachToDependencyStore(e?null:n.dependencyStore)),t.client.isPainted&&(t.dependencyStore=t.dependencyStore||n.dependencyStore,t.draw()),we()(pe()(r.prototype),"doDisable",this).call(this,e)}},{key:"findDependencyIndex",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0,n=arguments.length>2?arguments[2]:void 0;return e.findIndex((function(e){return e.dependency===t&&(e.assignmentData===n||e.assignmentData&&n&&e.assignmentData.from===n.from&&e.assignmentData.to===n.to)}))}},{key:"includesDependency",value:function(){return this.findDependencyIndex.apply(this,arguments)>=0}},{key:"attachToResourceStore",value:function(e){we()(pe()(r.prototype),"attachToResourceStore",this).call(this,e),e&&!this.disabled&&e.on({name:"resourceStore",changePreCommit:"onResourceStoreChange",refreshPreCommit:"onResourceStoreRefresh",thisObj:this})}},{key:"attachToDependencyStore",value:function(e){var t=this;we()(pe()(r.prototype),"attachToDependencyStore",this).call(this,e),t.resetGridCache(),t.resetBoundsCache(),e&&!t.disabled&&(e.metaMapId=t.client.id,e.on({name:"dependencyStore",changePreCommit:"onDependencyChange",thisObj:t}))}},{key:"attachToAssignmentStore",value:function(e){we()(pe()(r.prototype),"attachToAssignmentStore",this).call(this,e),e&&!this.disabled&&e.on({name:"assignmentStore",changePreCommit:"onAssignmentChange",refreshPreCommit:"onAssignmentRefresh",thisObj:this})}},{key:"attachToEventStore",value:function(e){we()(pe()(r.prototype),"attachToEventStore",this).call(this,e),e&&!this.disabled&&e.on({name:"eventStore",changePreCommit:"onEventChange",thisObj:this})}},{key:"createMarkers",value:function(){var e=this,t=e.client.svgCanvas,n=e.endMarker=e.initMarkerElement("arrowEnd","8","M0,0 L0,6 L9,3 z");if(j.a.isEdge||j.a.isIE11){var r=e.startMarker=e.initMarkerElement("arrowStart","1","M0,3 L9,6 L9,0 z");t.appendChild(r)}else n.setAttribute("orient","auto-start-reverse");t.appendChild(n)}},{key:"initMarkerElement",value:function(e,t,n){return Cr.createElement({id:e,tag:"marker",ns:"http://www.w3.org/2000/svg",markerHeight:9,markerWidth:9,refX:t,refY:3,viewBox:"0 0 9 6",orient:"auto",markerUnits:"userSpaceOnUse",children:[{tag:"path",ns:"http://www.w3.org/2000/svg",d:n}]})}},{key:"createLineDefAdjusters",value:function(){var e=this.client;return[function(t){var n=!1;return(t.startArrowMargin>e.barMargin||t.endArrowMargin>e.barMargin)&&(t.startArrowMargin=t.endArrowMargin=e.barMargin,n=!0),n?t:n},function(e){var t=!1;return(e.startArrowMargin>0||e.endArrowMargin>0)&&(e.startArrowMargin=e.endArrowMargin=0,t=!0),t?e:t}]}},{key:"getElementForDependency",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.getElementsForDependency(e,t)[0]}},{key:"getElementsForDependency",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n='[depId="'.concat(e.id,'"]');return t&&(n+='[fromId="'.concat(t.from.id,'"][toId="').concat(t.to.id,'"]')),Array.from(this.client.svgCanvas.querySelectorAll(n))}},{key:"resolveDependencyRecord",value:function(e){var t="string"==typeof e?e:e.getAttribute("depId");return t?this.dependencyStore.getById(t):null}},{key:"onRefresh",value:function(){this.client.isEngineReady&&this.onProjectRefresh()}},{key:"onProjectRefresh",value:function(){var e=this;if(!e.client.refreshSuspended)if(e.refreshAllWhenReady)e.resetGridCache(),e.scheduleDraw(!0),e.refreshAllWhenReady=!1;else if(e.toDrawOnProjectRefresh.size){var t=e._dependencyGridCache;t&&e.toDrawOnProjectRefresh.forEach((function(t){e.addToGridCache(t)})),t||e._thisIsAUsedExpression(e.dependencyGridCache),e.toDrawOnProjectRefresh.clear(),e.scheduleDraw()}}},{key:"onToggleNode",value:function(){this.resetGridCache(),this.scheduleDraw(!0)}},{key:"onViewportResize",value:function(){this.scheduleDraw(!0)}},{key:"onTranslateRow",value:function(e){var t=e.row;t.lastTop>=0&&t.top!==t.lastTop&&this.scheduleDraw(!0)}},{key:"onChangeTotalHeight",value:function(){this.client.isEngineReady&&this.scheduleDraw(!0)}},{key:"onHorizontalScroll",value:function(e){var t=e.subGrid;this.isDrawn&&t===this.client.timeAxisSubGrid&&this.scheduleDraw(!1)}},{key:"onVerticalScroll",value:function(){this.isDrawn&&this.scheduleDraw(!1)}},{key:"onRowsRefresh",value:function(){this.scheduleDraw(!0)}},{key:"onResourceStoreChange",value:function(e){var t=e.action;this.client.project.propagatingLoadChanges||"add"!==t&&"remove"!==t&&"removeall"!==t||(this.refreshAllWhenReady=!0)}},{key:"onResourceStoreRefresh",value:function(e){var t=e.action;if(!this.client.project.propagatingLoadChanges)switch(t){case"sort":case"filter":case"batch":this.resetGridCache(),this.scheduleDraw(!0)}}},{key:"onDependencyChange",value:(t=Wr()(Vr.a.mark((function e(t){var n,r,i,o,a;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.action,r=t.record,i=t.records,(a=(o=this).client).isPainted&&!a.suspendRendering&&!this.client.project.propagatingLoadChanges){e.next=4;break}return e.abrupt("return");case 4:e.t0=n,e.next="dataset"===e.t0?7:"add"===e.t0?10:"update"===e.t0?12:"remove"===e.t0?19:"removeall"===e.t0||"filter"===e.t0?22:24;break;case 7:return o.dependencyGridCache={},o.toDrawOnProjectRefresh=new Set(i),e.abrupt("return");case 10:return i.forEach((function(e){return o.toDrawOnProjectRefresh.add(e)})),e.abrupt("return");case 12:if(o.drawnDependencies.some((function(e){return e.dependency===r}))){e.next=17;break}o.addToGridCache(r),o.scheduleDraw(),e.next=18;break;case 17:return e.abrupt("return",o.scheduleRefreshDependency(r));case 18:return e.abrupt("break",24);case 19:return i.forEach((function(e){o.releaseDependency(e,!0),o.removeFromCache(e),o.dependenciesToRefresh.delete(e)})),a.trigger("dependenciesDrawn"),e.abrupt("return");case 22:return o.resetGridCache(),e.abrupt("break",24);case 24:o.scheduleDraw(!0);case 25:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"onEventChange",value:function(e){var t=e.action,n=e.record,r=e.changes,i=this;if(!i.client.project.propagatingLoadChanges)switch(t){case"filter":i.scheduleDraw(!0);break;case"update":if(1===Object.keys(r).length&&(r.startDate||r.endDate||r.duration))return;if(n.isEvent){var o=[n];n.resources.forEach((function(e){return o.push.apply(o,d()(e.events))})),new Set(o).forEach((function(e){return i.drawForTimeSpan(e,!0)}))}else i.drawForTimeSpan(n,!0);break;case"removeall":i.resetGridCache(),i.scheduleDraw(!0)}}},{key:"onAssignmentRefresh",value:function(e){var t=e.action;this.client.project.propagatingLoadChanges||"dataset"===t&&(this.resetGridCache(),this.scheduleDraw(!0))}},{key:"onAssignmentChange",value:function(e){var t=e.action,n=e.record,r=e.records,i=e.changes,o=this;if(!o.client.project.propagatingLoadChanges&&(n&&(r=[n]),"filter"===t&&(o.resetGridCache(),o.scheduleDraw(!0)),"add"===t||"remove"===t||"update"===t)){if("update"===t&&2===Object.keys(i).length&&i.event&&i.resource&&!i.event.isModel&&!i.resource.isModel)return;r.forEach((function(e){var r=o.client,i=r.assignmentStore,a=r.eventStore.getById(e.eventId);a&&a.dependencies.forEach((function(r){if("add"===t)o.toDrawOnProjectRefresh.add(r);else if("remove"===t){(r.fromEvent===a?r.toEvent.assignments.map((function(t){return{from:e,to:t}})):r.fromEvent.assignments.map((function(t){return{from:t,to:e}}))).forEach((function(e){o.releaseDependency(r,e),o.removeFromCache(r,e)}))}else"update"===t&&o.getDependencyAssignmentsAsFromToArray({dependency:r,assignmentStore:i}).filter((function(e){return e.from===n||e.to===n})).forEach((function(e){o.scheduleRefreshDependency(r,e)}))}))}))}}},{key:"getDependencyAssignmentsAsFromToArray",value:function(e){var t=e.dependency,n=e.assignmentStore,r=t.fromEvent,i=t.toEvent,o=[];if(r&&i){var a=this.getEventAssignments(r,n),s=this.getEventAssignments(i,n);a.forEach((function(e){s.forEach((function(t){o.push({from:e,to:t})}))}))}return o}},{key:"getEventAssignments",value:function(e,t){if(e.isRemoved){var n,r=t.removed.values.filter((function(t){return t.event===e})),i=lP(t.assignmentsForRemoval);try{for(i.s();!(n=i.n()).done;){var o=n.value;o.event===e&&r.push(o)}}catch(e){i.e(e)}finally{i.f()}return r}return e.assignments}},{key:"onElementClick",value:function(e){if(e.target.matches("."+this.baseCls)){var t=qo.get(e.target).dependency,n="click"===e.type?"Click":"DblClick";this.client.trigger("dependency".concat(n),{dependency:t,event:e})}}},{key:"onElementDblClick",value:function(e){return this.onElementClick(e)}},{key:"onElementMouseOver",value:function(e){var t=this;if(e.target.matches("."+t.baseCls)){var n=qo.get(e.target).dependency;t.client.trigger("dependencyMouseOver",{dependency:n,event:e}),t.overCls&&t.highlight(n,t.overCls)}}},{key:"onElementMouseOut",value:function(e){if(e.target.matches("."+this.baseCls)){var t=qo.get(e.target).dependency;this.client.trigger("dependencyMouseOut",{dependency:t,event:e}),this.overCls&&!t.isRemoved&&this.unhighlight(t)}}},{key:"highlight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.overCls,n=this.getElementsForDependency(e);n.forEach((function(e){e.classList.add(t)})),e.highlight(t)}},{key:"unhighlight",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:this.overCls,n=this.getElementsForDependency(e);n.forEach((function(e){e.classList.remove(t)})),e.unhighlight(t)}},{key:"highlightEventDependencies",value:function(e){var t=this;e.dependencies.forEach((function(e){return t.highlight(e)}))}},{key:"unhighlightEventDependencies",value:function(e){var t=this;e.dependencies.forEach((function(e){return t.unhighlight(e)}))}},{key:"isDependencyVisible",value:function(e){var t,n,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=this,o=i.client,a=o.assignmentStore,s=o.resourceStore,u=o.eventStore,c=e.fromEvent,l=e.toEvent;if(!c||!l)return!1;if(r){var f=r.from,d=r.to;if(t=f.resource,n=d.resource,!1===f.drawDependencies||!1===d.drawDependencies||u.isFiltered&&(!u.includes(c)||!u.includes(l))||a.isFiltered&&(!a.includes(f)||!a.includes(d)))return!1}else t=c.resource,n=l.resource;return!(!s.isAvailable(t)||!s.isAvailable(n))&&(c.isModel&&!t.instanceMeta(s).hidden&&!n.instanceMeta(s).hidden)}},{key:"getBox",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=arguments.length>3&&void 0!==arguments[3]&&arguments[3],o=this.getTimeSpanRecordFromDependency(e,t);return n=r?r[t?"from":"to"].resource:o.resource,this.client.getResourceEventBox(o,n,!0,i)}},{key:"getRowRecordFromDependency",value:function(e,t,n){return n?n[t?"from":"to"].resource:this.getTimeSpanRecordFromDependency(e,t).resource}},{key:"getTimeSpanRecordFromDependency",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return e["".concat(t?"from":"to","Event")]}},{key:"getMetaId",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return e?"".concat(this.client.id,"-ass").concat(e.from.id,"-ass").concat(e.to.id):this.client.id}},{key:"getDependencyBounds",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this,i=r.client,o=e.getDateRange();if(!i.rowManager.rowCount||!r.isDependencyVisible(e,t))return null;if(!(o&&i.timeAxis.count&&Zt.intersectSpans(o.start,o.end,i.startDate,i.endDate)))return null;var a=r.getMetaId(t),s=e.instanceMeta(a),u=r.getBox(e,!0,t,n),c=r.getBox(e,!1,t,n);if(!u||!c)return null;if(r._resetBoundsCache||!s.bounds||!s.bounds.layout){var l=r.getTimeSpanRecordFromDependency(e,!0),f=r.getTimeSpanRecordFromDependency(e,!1),d=En.union(u,c);i.isGantt||[[l,u,t.from],[f,c,t.to]].map((function(e){var t=ye()(e,3),n=t[0],r=t[1],o=t[2];if("default"===i.milestoneLayoutMode&&n.isMilestone){if(!i.milestoneWidth){var a=i.getElementFromAssignmentRecord(o);a&&(i.milestoneWidth=a.offsetWidth)}var s=i.milestoneWidth||r.height;r.left-=s/2,r.right+=s/2}})),s.bounds={bounds:d,startRectangle:u,endRectangle:c,layout:u.layout||c.layout}}return e.instanceMeta(a).bounds}},{key:"getIteratableDependencyAssignments",value:function(e){return this.assignmentStore?this.getDependencyAssignmentsAsFromToArray({dependency:e,assignmentStore:this.assignmentStore}):[null]}},{key:"addToGridCache",value:function(e){var t=this,n=t.client,r=n.store,i=t.dependencyGridCache,o=t.cacheGridSize,a=t.getIteratableDependencyAssignments(e),s=n.startDate.getTime(),u=n.endDate.getTime(),c=Zt.asMilliseconds(n.timeAxis.unit)*o.ticks;a.forEach((function(n){var a=t.getMetaId(n),l=e.instanceMeta(a).gridCache=[],f=r.indexOf(t.getRowRecordFromDependency(e,!0,n)),d=r.indexOf(t.getRowRecordFromDependency(e,!1,n)),h=e.getDateRange(),v=null==h?void 0:h.start.getTime(),p=null==h?void 0:h.end.getTime();if(-1!==f&&-1!==d&&h&&p>s&&v<u){var g,y,m,k,b,w=Math.min(f,d),C=Math.max(f,d),S=Math.floor(w/o.index),D=Math.floor(C/o.index),R=Math.floor(Math.max(v-s,0)/c),x=Math.floor(Math.max(p-s,0)/c),E="".concat(e.id,".-.").concat(a);for(k=R;k<=x;k++)for(g=i[k]||(i[k]={}),b=S;b<=D;b++)(m=(y=g[b]||(g[b]=[])).cached||(y.cached={}))[E]||(m[E]=!0,y.push({dependency:e,assignmentData:n,metaId:a})),l.push([k,b])}}))}},{key:"removeFromCache",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this,r=n._dependencyGridCache;(t?[t]:this.getIteratableDependencyAssignments(e)).forEach((function(t){var i,o=n.getMetaId(t),a=e.instanceMeta(o),s="".concat(e.id,".-.").concat(o);r&&(null===(i=a.gridCache)||void 0===i||i.forEach((function(i){var o,a=ye()(i,2),u=a[0],c=a[1];if(null===(o=r[u])||void 0===o?void 0:o.hasOwnProperty(c)){var l=n._dependencyGridCache[u][c];if(null==l?void 0:l.cached[s]){var f=n.findDependencyIndex(l,e,t);delete l.cached[s],f>-1&&l.splice(f,1)}}}))),a.bounds=null,a.gridCache=null}))}},{key:"resetBoundsCache",value:function(){this._resetBoundsCache=!0}},{key:"resetGridCache",value:function(){this.dependencyGridCache=null}},{key:"generateBoundaryBoxes",value:function(e,t){var n=[];return"bottom"===t?n.push({start:e.left,end:e.left+e.width/2,top:e.rowTop,bottom:e.rowBottom},{start:e.left+e.width/2,end:e.right,top:e.rowTop,bottom:e.rowBottom}):n.push({start:e.left-this.pathFinder.startArrowMargin,end:e.right+this.pathFinder.startArrowMargin,top:e.rowTop,bottom:e.rowBottom}),n}},{key:"getDependencyStartSide",value:function(e){var t=this,n=t.getTimeSpanRecordFromDependency(e,!0),r=e.type,i=e.fromSide;if(!i)switch(!0){case r===mx.Type.StartToEnd:case r===mx.Type.StartToStart:i=t.getConnectorStartSide(n);break;case r===mx.Type.EndToStart:case r===mx.Type.EndToEnd:i=t.getConnectorEndSide(n);break;default:throw new Error("Invalid dependency type: "+r)}return i}},{key:"getDependencyEndSide",value:function(e){var t=this,n=t.getTimeSpanRecordFromDependency(e,!1),r=e.type,i=e.toSide;if(!i)switch(!0){case r===mx.Type.StartToEnd:i=t.getConnectorEndSide(n);break;case r===mx.Type.StartToStart:case r===mx.Type.EndToStart:i=t.getConnectorStartSide(n);break;case r===mx.Type.EndToEnd:i=t.getConnectorEndSide(n);break;default:throw new Error("Invalid dependency type: "+r)}return i}},{key:"prepareLineDef",value:function(e,t){var n=this,r=n.getDependencyStartSide(e),i=n.getDependencyEndSide(e),o=t.startRectangle,a=t.endRectangle,s=null!=o.rowTop&&o.rowTop!==a.rowTop,u=[];s&&u.push.apply(u,d()(n.generateBoundaryBoxes(o,r)));var c=n.pathFinder,l=c.startArrowMargin,f=c.verticalMargin;return e.bidirectional||(/(top|bottom)/.test(r)&&(l=n.client.barMargin/2),f=n.client.barMargin/2),{startBox:{start:o.x,end:o.right,top:o.y,bottom:o.bottom},endBox:{start:a.x,end:a.right,top:a.y,bottom:a.bottom},otherBoxes:u,startArrowMargin:l,verticalMargin:f,otherVerticalMargin:0,otherHorizontalMargin:0,startSide:r,endSide:i}}},{key:"drawLine",value:function(e,t,n){var r,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=this.client,s=this.getMetaId(i),u=t.instanceMeta(s).lineElement;(u&&o||(u=document.createElementNS("http://www.w3.org/2000/svg","polyline"),o&&(t.instanceMeta(s).lineElement=u),u.setAttribute("depId",t.id),i&&(u.setAttribute("fromId",i.from.id),u.setAttribute("toId",i.to.id)),e.appendChild(u)),u.classList.length&&u.classList.remove.apply(u.classList,u.getAttribute("class").split(" ")),u.classList.add(this.baseCls),t.cls&&u.classList.add(t.cls),t.bidirectional&&u.classList.add("b-sch-bidirectional-line"),t.highlighted)&&(r=u.classList).add.apply(r,d()(t.highlighted.split(" ")));if(j.a.isIE11){var c=t.getDateRange(!0),l=a.startDate;c.start<l&&u.classList.add("b-no-start-marker"),c.end<l&&u.classList.add("b-no-end-marker")}return u.setAttribute("points",n?n.map((function(e,t){return t!==n.length-1?"".concat(e.x1,",").concat(e.y1):"".concat(e.x1,",").concat(e.y1," ").concat(e.x2,",").concat(e.y2)})).join(" "):""),qo.set(u,{dependency:t}),u}},{key:"refreshDependency",value:function(e){var t=this,n=t.getIteratableDependencyAssignments(e);t.releaseDependency(e,null!==n[0]),t.removeFromCache(e),t.addToGridCache(e),n.forEach((function(n){return t.drawDependency(e,null,n)}))}},{key:"refreshDependencyAssignment",value:function(e,t){this.releaseDependency(e,t),this.removeFromCache(e,t),this.addToGridCache(e),this.drawDependency(e,null,t)}},{key:"scheduleRefreshDependency",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=this,r=n.dependenciesToRefresh;if(!n.drawnDependencies.find((function(t){return t.dependency===e})))return n.removeFromCache(e),void n.addToGridCache(e);t?r.has(e)?!0!==r.get(e)&&r.get(e).add(t):r.set(e,new Set([t])):r.set(e,!0),1===r.size&&n.requestAnimationFrame((function(){return n.refreshDependencyOnFrame()}))}},{key:"getSortedDependenciesToRefresh",value:function(){return this.dependenciesToRefresh}},{key:"refreshDependencyOnFrame",value:function(){var e=this,t=e.getSortedDependenciesToRefresh();e.client.isPainted&&(t.forEach((function(t,n){if(!0===t){var r=e.getIteratableDependencyAssignments(n);e.releaseDependency(n,null!==r[0]),e.removeFromCache(n)}else t.forEach((function(t){e.releaseDependency(n,t),e.removeFromCache(n,t)}))})),t.forEach((function(t,n){e.addToGridCache(n)})),t.forEach((function(t,n){!0===t&&(t=e.getIteratableDependencyAssignments(n)),t.forEach((function(t){e.drawDependency(n,null,t)}))})),e.dependenciesToRefresh.clear(),e.client.trigger("dependenciesDrawn",{partial:!0}))}},{key:"drawDependency",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:this.client.svgCanvas,i=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],o=this,a=o.drawnDependencies,s=o.oldDrawnDependencies,u=t||o.getDependencyBounds(e,n);if(!o.disabled&&u){var c=o.prepareLineDef(e,u),l=o.pathFinder.findPath(c,o.lineDefAdjusters);o.drawLine(r,e,l,n,i),i&&!this.includesDependency(a,e,n)&&a.push({dependency:e,assignmentData:n})}var f=this.findDependencyIndex(s,e,n);f>=0&&s.splice(f,1)}},{key:"drawForTimeSpan",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this;n.client.isAnimating?n.client.on({transitionend:function(){!e.isRemoved&&n.drawForTimeSpan(e,!0)},once:!0}):n.dependencyStore.getTimeSpanDependencies(e).forEach((function(e){t?n.scheduleRefreshDependency(e):n.refreshDependency(e)}))}},{key:"drawForEvent",value:function(e){this.drawForTimeSpan(e)}},{key:"updateDependenciesForTimeSpan",value:function(e,t){var n,r=this,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,o=this,a=e.isAssignment?e.event:e,s=o.dependencyStore.getTimeSpanDependencies(a),u=o.getMetaId(),c=o.client,l=En.from(t,c.timeAxisSubGridElement),f=i&&c.getRowFor(i);s.forEach((function(t){r.getIteratableDependencyAssignments(t).forEach((function(r){var i,s,c=l.clone();f&&(c.rowTop=f.top,c.rowBottom=f.bottom),r&&r.from!==e&&r.to!==e||o.isDependencyVisible(t,r)&&(o.getTimeSpanRecordFromDependency(t,!0)===a?(i=c,s=(n=t.instanceMeta(u).bounds)?n.endRectangle:o.getBox(t,!1,r)):(i=(n=t.instanceMeta(u).bounds)?n.startRectangle:o.getBox(t,!0,r),s=c),i&&s&&o.drawDependency(t,{startRectangle:i,endRectangle:s},r))}))}))}},{key:"scheduleDraw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this;t.disabled||(e&&t.resetBoundsCache(),t.client.isAnimating?t.clientTransitionRemover||(t.clientTransitionRemover=t.client.on({transitionend:function(){t.clientTransitionRemover(),t.clientTransitionRemover=null,t.draw()},once:!0})):t.doScheduleDraw())}},{key:"draw",value:function(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],t=this,n=t.client;if((t.oldDrawnDependencies||t.dependencyStore.count)&&n.isPainted)if(n.isAnimating)n.on({transitionend:function(){t.scheduleDraw(!0)},once:!0});else{var r=n.timeAxisSubGrid.viewRectangle;if(e&&t.resetBoundsCache(),r.width&&r.height){if(t.oldDrawnDependencies=t.drawnDependencies,t.drawnDependencies=[],r.inflate(t.bufferSize),!t.disabled&&!n.suspendRendering&&n.store.count&&n.rowManager.rowCount){if(!n.project.isInitialCommitPerformed)return t.drawnDependencies=t.oldDrawnDependencies,void(t.refreshAllWhenReady=!0);var i,o,a,s={},u=t.dependencyGridCache,c=t.cacheGridSize,l=n.startDate,f=n.visibleDateRange,d=Zt.asMilliseconds(n.timeAxis.unit)*c.ticks,h=f.startDate.getTime()-l.getTime(),v=f.endDate.getTime()-l.getTime(),p=Math.floor(h/d),g=Math.floor(v/d),y=Math.floor(n.rowManager.topRow.dataIndex/c.index),m=Math.floor(n.rowManager.bottomRow.dataIndex/c.index),k=[];for(i=p;i<=g;i++)for(o=y;o<=m;o++){var b=u[i],w=null==b?void 0:b[o];for(a=0;w&&a<w.length;a++){var C=w[a],S=C.dependency,D=C.assignmentData,R=C.metaId,x=S.id+"-"+R;if(!s[x]){var E=t.getDependencyBounds(S,D);((null==E?void 0:E.bounds.intersect(r,!0,!0))||n.ignoreViewBox)&&k.push([S,E,D]),s[x]=!0}}}k.forEach((function(e){var n=ye()(e,3),r=n[0],i=n[1],o=n[2];t.drawDependency(r,i,o)}))}t._resetBoundsCache=!1,t.oldDrawnDependencies.forEach((function(e){return t.releaseDependency(e.dependency,e.assignmentData)})),n.trigger("dependenciesDrawn"),t.isDrawn=!0}}}},{key:"releaseDependency",value:function(e){var t=this,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(!0===n){var r=Object.keys(e.meta.map||{}).filter((function(e){return e.startsWith(t.client.id)}));r.forEach((function(t){var n=e.meta.map[t];n.lineElement&&(n.lineElement.remove(),n.lineElement=null)}))}else{var i=this.getMetaId(n),o=e.instanceMeta(i).lineElement;o&&(e.instanceMeta(i).lineElement=null,o.remove())}}},{key:"render",value:function(){var e=this,t=e.client;e.showTooltip&&(e.tooltip=e.createTooltip()),t.timeAxis.on({endreconfigure:"resetGridCache",thisObj:e}),t.rowManager.on({refresh:"onRowsRefresh",changetotalheight:"onChangeTotalHeight",thisObj:e}),t.on({horizontalscroll:"onHorizontalScroll",svgcanvascreated:"createMarkers",togglenode:"onToggleNode",scroll:"onVerticalScroll",timelineviewportresize:"onViewportResize",thisObj:e}),e.highlightDependenciesOnEventHover&&(t.on(t.scheduledEventName+"MouseEnter",(function(t){return e.highlightEventDependencies(t.eventRecord||t.taskRecord)})),t.on(t.scheduledEventName+"MouseLeave",(function(t){return e.unhighlightEventDependencies(t.eventRecord||t.taskRecord)})))}},{key:"renderContents",value:function(){this.draw()}},{key:"getConnectorStartSide",value:function(e){return this.client.currentOrientation.getConnectorStartSide(e)}},{key:"getConnectorEndSide",value:function(e){return this.client.currentOrientation.getConnectorEndSide(e)}},{key:"createTooltip",value:function(){var e=this,t=e.client;return new Kl(Object.assign({align:"b-t",id:"".concat(t.id,"-dependency-tip"),forSelector:".b-timelinebase:not(.b-eventeditor-editing):not(.b-resizing-event):not(.b-dragcreating):not(.b-dragging-event):not(.b-creating-dependency) .".concat(e.baseCls),clippedBy:[t.timeAxisSubGridElement,t.bodyContainer],forElement:t.timeAxisSubGridElement,showOnHover:!0,hoverDelay:0,hideDelay:0,anchorToTarget:!1,textContent:!1,trackMouse:!1,getHtml:e.getHoverTipHtml.bind(e)},e.tooltip||{}))}},{key:"getHoverTipHtml",value:function(e){var t=e.activeTarget,n=this.resolveDependencyRecord(t),r=n.fromEvent,i=n.toEvent;return Iu.tpl(cP(),this.L("L{from}"),r.name,hP[n.type],this.L("L{to}"),i.name,vP[n.type])}},{key:"dependencyGridCache",get:function(){var e=this;return e._dependencyGridCache||(e._dependencyGridCache={},e.dependencyStore.forEach((function(t){return e.addToGridCache(t)}))),e._dependencyGridCache},set:function(e){this._dependencyGridCache=e}}],[{key:"getLocalizedDependencyType",value:function(e){return e?this.L("L{DependencyType.".concat(e,"}")):""}},{key:"$name",get:function(){return"Dependencies"}},{key:"defaultConfig",get:function(){return{pathFinderConfig:null,overCls:"b-sch-dependency-over",baseCls:"b-sch-dependency",highlightDependenciesOnEventHover:!1,showTooltip:!0,tooltip:null,bufferSize:50,cacheGridSize:{ticks:25,index:25}}}},{key:"properties",get:function(){return{toDrawOnProjectRefresh:new Set,dependenciesToRefresh:new Map,drawnDependencies:[],drawnLines:[]}}},{key:"pluginConfig",get:function(){return{chain:["render","renderContents","onElementClick","onElementDblClick","onElementMouseOver","onElementMouseOut","onProjectRefresh"],assign:["getElementForDependency","getElementsForDependency","resolveDependencyRecord"]}}}]),r}(qr.mixin(Yx,rA,_a));function gP(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}pP._$name="Dependencies",fv.registerFeature(pP,!1,"Scheduler"),fv.registerFeature(pP,!0,"SchedulerPro"),document.createElementNS&&!("classList"in document.createElementNS("http://www.w3.org/2000/svg","g"))&&function(e){if("Element"in e){var t=e.Element.prototype,n=Object,r=String.prototype.trim||function(){return this.replace(/^\s+|\s+$/g,"")},i=Array.prototype.indexOf||function(e){for(var t=0,n=this.length;t<n;t++)if(t in this&&this[t]===e)return t;return-1},o=function(e,t){this.name=e,this.code=DOMException[e],this.message=t},a=function(e,t){if(""===t)throw new o("SYNTAX_ERR","The token must not be empty.");if(/\s/.test(t))throw new o("INVALID_CHARACTER_ERR","The token must not contain space characters.");return i.call(e,t)},s=function(e){for(var t=r.call(e.getAttribute("class")||""),n=t?t.split(/\s+/):[],i=0,o=n.length;i<o;i++)this.push(n[i]);this._updateClassName=function(){e.setAttribute("class",this.toString())}},u=s.prototype=[],c=function(){return new s(this)};if(o.prototype=Error.prototype,u.item=function(e){return this[e]||null},u.contains=function(e){return~a(this,e+"")},u.add=function(){var e,t=arguments,n=0,r=t.length,i=!1;do{e=t[n]+"",~a(this,e)||(this.push(e),i=!0)}while(++n<r);i&&this._updateClassName()},u.remove=function(){var e,t,n=arguments,r=0,i=n.length,o=!1;do{for(e=n[r]+"",t=a(this,e);~t;)this.splice(t,1),o=!0,t=a(this,e)}while(++r<i);o&&this._updateClassName()},u.toggle=function(e,t){var n=this.contains(e),r=n?!0!==t&&"remove":!1!==t&&"add";return r&&this[r](e),!0===t||!1===t?t:!n},u.replace=function(e,t){var n=a(e+"");~n&&(this.splice(n,1,t),this._updateClassName())},u.toString=function(){return this.join(" ")},n.defineProperty){var l={get:c,enumerable:!0,configurable:!0};try{n.defineProperty(t,"classList",l)}catch(e){void 0!==e.number&&-2146823252!==e.number||(l.enumerable=!1,n.defineProperty(t,"classList",l))}}else n.prototype.__defineGetter__&&t.__defineGetter__("classList",c)}}(window),function(){var e=document.createElement("_");if(e.classList.add("c1","c2"),!e.classList.contains("c2")){var t=function(e){var t=DOMTokenList.prototype[e];DOMTokenList.prototype[e]=function(e){for(var n=0,r=arguments.length;n<r;n++)e=arguments[n],t.call(this,e)}};t("add"),t("remove")}if(e.classList.toggle("c3",!1),e.classList.contains("c3")){var n=DOMTokenList.prototype.toggle;DOMTokenList.prototype.toggle=function(e,t){return 1 in arguments&&!this.contains(e)==!t?t:n.call(this,e)}}"replace"in document.createElement("_").classList||(DOMTokenList.prototype.replace=function(e,t){var n=this.toString().split(" "),r=n.indexOf(e+"");~r&&(n=n.slice(r),this.remove.apply(this,n),this.add(t),this.add.apply(this,n.slice(1)))}),e=null}();var yP=function(e){fe()(n,e);var t=gP(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"processWidgetConfig",value:function(e){var t=this.dependencyEditFeature;return!("lagField"===e.ref&&!t.showLagField)&&(!("deleteButton"===e.ref&&!t.showDeleteButton)&&(Object.assign(e,{}),we()(pe()(n.prototype),"processWidgetConfig",this).call(this,e)))}},{key:"afterShow",value:function(){var e,t=this.widgetMap.deleteButton;t&&(t.hidden=!this.record.isPartOfStore());for(var r=arguments.length,i=new Array(r),o=0;o<r;o++)i[o]=arguments[o];(e=we()(pe()(n.prototype),"afterShow",this)).call.apply(e,[this].concat(i))}},{key:"onInternalKeyDown",value:function(e){this.trigger("keyDown",{event:e}),we()(pe()(n.prototype),"onInternalKeyDown",this).call(this,e)}}],[{key:"$name",get:function(){return"DependencyEditor"}},{key:"defaultConfig",get:function(){return{items:[],draggable:{handleSelector:":not(button,.b-field-inner)"},axisLock:"flexible"}}}]),n}(zl);function mP(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}yP._$name="DependencyEditor";var kP=function(e){fe()(i,e);var t,n,r=mP(i);function i(){return v()(this,i),r.apply(this,arguments)}return g()(i,[{key:"construct",value:function(e,t){var n,r=this;if(e.dependencyEdit=r,r.dependencyStore=e.dependencyStore,we()(pe()(i.prototype),"construct",this).call(this,e,t),!e.features.dependencies)throw new Error("Dependencies feature required when using DependencyEdit");r.clientListenersDetacher=e.on((n={},ke()(n,r.triggerEvent,r.onActivateEditor),ke()(n,"thisObj",r),n))}},{key:"doDestroy",value:function(){var e;this.clientListenersDetacher(),null===(e=this.editor)||void 0===e||e.destroy(),we()(pe()(i.prototype),"doDestroy",this).call(this)}},{key:"onBeforeSave",value:function(e){}},{key:"onAfterSave",value:function(e){}},{key:"updateRecord",value:function(e){var t=this.values;t.lag&&(t.lagUnit=t.lag.unit,t.lag=t.lag.magnitude),"type"in t&&(null!=e.fromSide&&(t.fromSide=null),null!=e.toSide&&(t.toSide=null)),an.cleanupProperties(t,!0),e.set(t)}},{key:"onPopupKeyDown",value:function(e){var t=e.event;"Enter"===t.key&&this.saveAndCloseOnEnter&&"input"===t.target.tagName.toLowerCase()&&(t.preventDefault(),this.onSaveClick())}},{key:"onSaveClick",value:function(){this.save()&&this.editor.hide()}},{key:"onDeleteClick",value:function(){this.deleteDependency(),this.editor.hide()}},{key:"onCancelClick",value:function(){this.editor.hide()}},{key:"internalShowEditor",value:function(e){var t=this,n=t.client,r=t.lastPointerDownCoordinate;if(!1!==n.trigger("beforeDependencyEdit",{dependencyEdit:t,dependencyRecord:e})){var i=t.getEditor(e);if(t.loadRecord(e),n.trigger("beforeDependencyEditShow",{dependencyEdit:t,dependencyRecord:e,editor:i}),!r){var o=En.from(t.client.element).center;r=[o.x-i.width/2,o.y-i.height/2]}i.showByPoint(r)}}},{key:"editDependency",value:function(e){this.client.readOnly||this.internalShowEditor(e)}},{key:"getEditor",value:function(){var e,t,n,r=this,i=r.editor;return i||(0===(i=r.editor=new yP(an.assign({dependencyEditFeature:r,autoShow:!1,anchor:!0,scrollAction:"realign",clippedBy:[r.client.timeAxisSubGridElement,r.client.bodyContainer],constrainTo:window,autoClose:r.autoClose,cls:r.cls,listeners:{keydown:r.onPopupKeyDown,thisObj:r}},r.editorConfig))).items.length&&console.warn("Editor configured without any `items`"),i.eachWidget((function(e){var t=e.ref||e.id;t&&!r[t]&&(r[t]=e)})),null===(e=r.saveButton)||void 0===e||e.on("click",r.onSaveClick,r),null===(t=r.deleteButton)||void 0===t||t.on("click",r.onDeleteClick,r),null===(n=r.cancelButton)||void 0===n||n.on("click",r.onCancelClick,r),r.editor)}},{key:"loadRecord",value:function(e){var t=this;t.fromNameField.value=e.fromEvent.name,t.toNameField.value=e.toEvent.name,t.lagField&&(t.lagField.unit=e.lagUnit),t.editor.record=t.dependencyRecord=e}},{key:"save",value:(n=Wr()(Vr.a.mark((function e(){var t,n,r,i,o,a;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(t=this).client,(r=t.dependencyRecord)&&t.isValid){e.next=3;break}return e.abrupt("return");case 3:if(i=t.dependencyStore,o=t.values,!1===n.trigger("beforeDependencySave",{dependencyRecord:r,values:o})){e.next=15;break}if(t.onBeforeSave(r),t.updateRecord(r),!i||r.stores.length){e.next=11;break}if(!1!==n.trigger("beforeDependencyAdd",{dependencyRecord:r,dependencyEdit:t})){e.next=10;break}return e.abrupt("return");case 10:i.add(r);case 11:return e.next=13,null===(a=n.project)||void 0===a?void 0:a.commitAsync();case 13:n.trigger("afterDependencySave",{dependencyRecord:r}),t.onAfterSave(r);case 15:return e.abrupt("return",r);case 16:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"deleteDependency",value:(t=Wr()(Vr.a.mark((function e(){var t,n,r,i;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.client,n=this.editor,r=this.dependencyRecord,!1===t.trigger("beforeDependencyDelete",{dependencyRecord:r})){e.next=7;break}return n.containsFocus&&n.revertFocus(),t.dependencyStore.remove(r),e.next=6,null===(i=t.project)||void 0===i?void 0:i.commitAsync();case 6:return e.abrupt("return",!0);case 7:return e.abrupt("return",!1);case 8:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"onActivateEditor",value:function(e){var t=e.dependency,n=e.event;this.disabled||(this.lastPointerDownCoordinate=[n.clientX,n.clientY],this.editDependency(t))}},{key:"editorConfig",get:function(){return this._editorConfig},set:function(e){var t=this.getDefaultConfiguration().editorConfig;(e=an.assign({},t,e)).items=e.items||[],this._editorConfig=e}},{key:"isValid",get:function(){return Object.values(this.editor.widgetMap).every((function(e){return!(e.name&&!e.hidden)||!1!==e.isValid}))}},{key:"values",get:function(){var e={};return this.editor.eachWidget((function(t){t.name&&!t.hidden&&(e[t.name]=t.value)}),!0),e}}],[{key:"$name",get:function(){return"DependencyEdit"}},{key:"defaultConfig",get:function(){var e=this;return{autoClose:!0,saveAndCloseOnEnter:!0,showDeleteButton:!0,triggerEvent:"dependencydblclick",showLagField:!1,dependencyRecord:null,editorConfig:{title:"L{Edit dependency}",localeClass:this,closable:!0,defaults:{localeClass:this},items:{fromNameField:{type:"display",label:"L{From}",editable:!1},toNameField:{type:"display",label:"L{To}"},typeField:{type:"combo",label:"L{Type}",name:"type",editable:!1,valueField:"id",displayField:"name",items:Object.keys(mx.Type).map((function(t){return{id:mx.Type[t],name:e.L(t)}}))},lagField:{type:"duration",label:"L{Lag}",name:"lag",allowNegative:!0}},bbar:{defaults:{localeClass:this},items:{foo:{type:"widget",cls:"b-label-filler"},saveButton:{color:"b-green",text:"L{Save}"},deleteButton:{color:"b-gray",text:"L{Delete}"},cancelButton:{color:"b-gray",text:"L{Object.Cancel}"}}}}}}}]),i}(qr);function bP(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return wP(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return wP(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function wP(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function CP(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}kP._$name="DependencyEdit",fv.registerFeature(kP,!1);var SP=["top","left","right","bottom"],DP={top:"b-b",right:"l-l",bottom:"t-t",left:"r-r"},RP={top:1,bottom:1},xP=function(e){fe()(n,e);var t=CP(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e,t){var r=this;if(e.isVertical)throw new Error("Labels feature is not supported in vertical mode");r.scheduler=e,we()(pe()(n.prototype),"construct",this).call(this,e,t),(r.top||r.bottom||r.left||r.right)&&r.updateHostClasslist()}},{key:"updateHostClasslist",value:function(){var e=this.top,t=this.bottom,n=this.scheduler.element.classList;n.remove("b-labels-topbottom"),n.remove("b-labels-top"),n.remove("b-labels-bottom"),(e||t)&&(n.add("b-labels-topbottom"),e&&n.add("b-labels-top"),t&&n.add("b-labels-bottom"))}},{key:"onLabelDblClick",value:function(e){var t=e.target;if(t&&!this.scheduler.readOnly){var n=t.dataset.side,r=this[n],i=r.editor,o=r.field;if(i){var a=this.scheduler.resolveEventRecord(e.target);return i instanceof fd||(r.editor=new fd({appendTo:this.scheduler.element,blurAction:this.blurAction,inputField:i,scrollAction:"realign"})),r.editor.startEdit({target:t,align:DP[n],matchSize:!1,record:a,field:o}),e.stopImmediatePropagation(),!1}}}},{key:"processLabelSpec",value:function(e,t){if("function"==typeof e)e={renderer:e};else if("string"==typeof e)e={field:e};else{if(!e)return;e=Object.setPrototypeOf({},e)}var n=this.scheduler,r=n.eventStore,i=n.resourceStore,o=n.taskStore,a=(n.id,e),s=a.field,u=a.editor;if(RP[t]&&(n.milestoneWidth=null),e.recordType=r&&!o?"event":"task",s){var c;r&&!o&&((c=r.modelClass.fieldMap[s])?(e.fieldDef=c,e.recordType="event",!0):Reflect.has(r.modelClass.prototype,s)&&(e.recordType="event",!0)),!c&&o&&((c=o.modelClass.fieldMap[s])?(e.fieldDef=c,e.recordType="task",!0):Reflect.has(i.modelClass.prototype,s)&&(e.recordType="task",!0)),!c&&i&&((c=i.modelClass.fieldMap[s])?(e.fieldDef=c,e.recordType="resource",!0):Reflect.has(i.modelClass.prototype,s)&&(e.recordType="resource",!0)),u&&("boolean"==typeof u?n.editor={type:"textfield"}:"string"==typeof u&&(n.editor={type:u}),nu.on({element:n.timeAxisSubGrid.element,delegate:".b-sch-label",dblclick:"onLabelDblClick",thisObj:this}))}return e}},{key:"doDisable",value:function(e){we()(pe()(n.prototype),"doDisable",this).call(this,e),this.client.isPainted&&this.client.refresh()}},{key:"onEventDataGenerated",value:function(e){var t=this;if(!t.disabled){var n,r=bP(SP);try{for(r.s();!(n=r.n()).done;){var i=n.value;if(t[i]){var o,a,s=t[i],u=s.field,c=s.fieldDef,l=s.recordType,f=s.renderer,d=s.thisObj,h={tag:"label",className:(o={},ke()(o,t.labelCls,1),ke()(o,"".concat(t.labelCls,"-").concat(i),1),o),dataset:{side:i,taskFeature:"label-".concat(i)}},v=void 0,p="".concat(l,"Record"),g=e[p];if(f)v=f.call(d||t.thisObj||t,(a={},ke()(a,p,g),ke()(a,"resourceRecord",e.resourceRecord),ke()(a,"assignmentRecord",e.assignmentRecord),ke()(a,"domConfig",h),a));else v=g[u],c&&"date"===c.type&&!f&&(v=Zt.format(v,t.client.displayDateFormat));h.html=v||"",e.wrapperChildren.push(h)}}}catch(e){r.e(e)}finally{r.f()}}}},{key:"top",set:function(e){this._top=this.processLabelSpec(e,"top"),this.updateHostClasslist()},get:function(){return this._top}},{key:"right",set:function(e){this._right=this.processLabelSpec(e,"right"),this.updateHostClasslist()},get:function(){return this._right}},{key:"bottom",set:function(e){this._bottom=this.processLabelSpec(e,"bottom"),this.updateHostClasslist()},get:function(){return this._bottom}},{key:"left",set:function(e){this._left=this.processLabelSpec(e,"left"),this.updateHostClasslist()},get:function(){return this._left}}],[{key:"$name",get:function(){return"Labels"}},{key:"defaultConfig",get:function(){return{labelCls:"b-sch-label",top:null,right:null,bottom:null,left:null,thisObj:null,blurAction:"cancel"}}},{key:"pluginConfig",get:function(){return{chain:["onEventDataGenerated"]}}}]),n}(qr);function EP(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}xP.featureClass="b-sch-labels",xP._$name="Labels",fv.registerFeature(xP,!1,"Scheduler");var TP=function(e){fe()(n,e);var t=EP(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"render",value:function(){var e,t=this,n=t.client;t.hoverTip&&t.hoverTip.destroy();var r=t.hoverTip=new Kl({id:"".concat(n.id,"-schedule-tip"),cls:"b-sch-scheduletip",allowOver:!0,hoverDelay:0,hideDelay:100,showOnHover:!0,forElement:n.timeAxisSubGridElement,anchorToTarget:!1,trackMouse:!0,updateContentOnMouseMove:!0,monitorResize:!1,textContent:!1,forSelector:".b-schedulerbase:not(.b-animating):not(.b-dragging-event):not(.b-dragcreating) .b-grid-body-container:not(.b-scrolling) .b-timeline-subgrid:not(.b-scrolling) > :not(.b-sch-foreground-canvas):not(.b-group-footer):not(.b-group-row) *",constrainTo:null,getHtml:t.getHoverTipHtml.bind(t),onDocumentMouseDown:function(t){r.forElement.contains(t.event.target)&&(e=nu.on({element:n.timeAxisSubGridElement,mousemove:function(e){return r.internalOnPointerOver(e)},capture:!0}));var i=r.hideAnimation;r.hideAnimation=!1,r.constructor.prototype.onDocumentMouseDown.call(r,t),r.hideAnimation=i},listeners:{pointerover:function(n){var r=n.event,i="buttons"in r?r.buttons>0:r.which>0;return!i&&e&&e(),!t.disabled&&!i}}});t.clockTemplate=new eE({scheduler:n})}},{key:"doDestroy",value:function(){this.destroyProperties("clockTemplate","hoverTip"),we()(pe()(n.prototype),"doDestroy",this).call(this)}},{key:"getHoverTipHtml",value:function(e){var t=e.tip,n=e.event,r=this,i=r.client,o=n&&i.getDateFromDomEvent(n,"floor",!0),a=r.lastHtml;if(o){var s=i.resolveResourceRecord(n);!s||o-r.lastTime==0&&s===r.lastResource||(r.lastResource=s,a=r.lastHtml=r.generateTipContent({date:o,event:n,resourceRecord:s}))}else t.hide(),r.lastTime=null,r.lastResource=null;return a}},{key:"generateTipContent",value:function(e){var t=e.date,n=e.event,r=e.resourceRecord,i=this,o=i.clockTemplate.generateContent({date:t,text:i.client.getFormattedDate(t)}),a=i.messageTemplate({message:i.getText(t,n,r)||""});return i.lastTime=t,o+a}},{key:"getText",value:function(e,t,n){}}],[{key:"$name",get:function(){return"ScheduleTooltip"}},{key:"defaultConfig",get:function(){return{messageTemplate:function(e){return'<div class="b-sch-hovertip-msg">'.concat(e.message,"</div>")}}}},{key:"pluginConfig",get:function(){return{chain:["render"]}}}]),n}(qr);function MP(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}TP.featureClass="b-scheduletip",TP._$name="ScheduleTooltip",fv.registerFeature(TP,!0,"Scheduler");var AP=function(e){fe()(n,e);var t=MP(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e,t){var r,i=this;i.scheduler=e,e.eventEdit=i,we()(pe()(n.prototype),"construct",this).call(this,e,t),i.clientListenersDetacher=e.on((r={},ke()(r,i.triggerEvent,(function(e){var t=e.eventRecord,n=e.eventElement;return i.editEvent(t,t.resource,n)})),ke()(r,"dragcreateend",i.onDragCreateEnd),ke()(r,"thisObj",i),r))}},{key:"doDestroy",value:function(){var e;this.clientListenersDetacher(),null===(e=this.editor)||void 0===e||e.destroy(),we()(pe()(n.prototype),"doDestroy",this).call(this)}},{key:"editEvent",value:function(e,t,n){var r=this,i=r.scheduler;i.readOnly||r.disabled||(n=Cr.down(n,i.eventInnerSelector)||n,e=e instanceof RC?e.event:e,r.resource=t,r.event=e,r.element=n,i.element.classList.add("b-eventeditor-editing"),r.editor||(r.editor=new fd(Object.assign({owner:r.scheduler.timeAxisSubGrid,appendTo:r.scheduler.timeAxisSubGridElement,scrollAction:"realign",cls:"b-simpleeventeditor",listeners:{complete:r.onEditorComplete,cancel:r.onEditorCancel,thisObj:r}},r.editorConfig)),r.relayEvents(r.editor,["beforestart","start","beforecomplete","complete","beforecancel","cancel"])),r.editor.startEdit({target:n,record:e,field:r.field}),r.scheduler.navigator.disabled=!0)}},{key:"onEditorComplete",value:function(){var e,t=this;0===t.event.stores.length&&(t.eventStore.add(t.editor.record),t.event.assign(t.resource)),(null===(e=t.element)||void 0===e?void 0:e.classList.contains("b-sch-dragcreator-proxy"))&&t.element.remove(),t.reset()}},{key:"onEditorCancel",value:function(){0===this.event.stores.length&&this.element.remove(),this.reset()}},{key:"reset",value:function(){this.scheduler.element.classList.remove("b-eventeditor-editing"),this.scheduler.navigator.disabled=!1}},{key:"onEventEnterKey",value:function(e){var t=e.assignmentRecord,n=e.eventRecord,r=t?this.scheduler.getElementFromAssignmentRecord(t):this.scheduler.getElementFromEventRecord(n),i=(t||n).resource;this.editEvent(n,i,r)}},{key:"onDragCreateEnd",value:function(e){var t=e.newEventRecord,n=e.resourceRecord,r=e.proxyElement;this.scheduler.onEventCreated(t);var i=r.cloneNode(!0);i.removeAttribute("id"),r.parentElement.appendChild(i),this.element=i,this.editEvent(t,n,i)}},{key:"eventStore",get:function(){return this.scheduler.eventStore}}],[{key:"$name",get:function(){return"SimpleEventEdit"}},{key:"defaultConfig",get:function(){return{triggerEvent:"eventdblclick",eventRecord:null,field:"name",editorConfig:null}}},{key:"pluginConfig",get:function(){return{chain:["onEventEnterKey"],assign:["editEvent"]}}}]),n}(qr);function PP(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}AP._$name="SimpleEventEdit",fv.registerFeature(AP,!1,"Scheduler");var IP=function(e){fe()(n,e);var t=PP(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e,t){var r=this;if(e.isVertical)throw new Error("Summary feature is not supported in vertical mode");r.scheduler=e,we()(pe()(n.prototype),"construct",this).call(this,e,t),r.summaries||(r.summaries=[{renderer:r.renderer}]),e instanceof _A&&(e.eventStore.on({filter:"updateScheduleSummaries",thisObj:r}),e.resourceStore.on({filter:"updateScheduleSummaries",thisObj:r}),e.project.on({refresh:"updateScheduleSummaries",thisObj:r}),e.timeAxisViewModel.on({update:r.renderRows,thisObj:r}))}},{key:"renderRows",value:function(){we()(pe()(n.prototype),"renderRows",this).call(this),this.render()}},{key:"updateScheduleSummaries",value:function(){var e=this,t=e.scheduler,n=t.bodyElement.querySelector(".b-grid-footer.b-sch-timeaxiscolumn");n&&t.isEngineReady&&Array.from(n.children).forEach((function(n,r){var i=t.timeAxis.getAt(r),o=t.eventStore.getEvents({startDate:i.startDate,endDate:i.endDate,allowPartial:!0,onlyAssigned:!0}),a="",s="<header>".concat(e.L("L{Summary for}",t.getFormattedDate(i.startDate)),"</header>");e.summaries.forEach((function(r){var u=r.renderer({startDate:i.startDate,endDate:i.endDate,eventStore:t.eventStore,resourceStore:t.resourceStore,events:o,element:n}),c='<div class="b-timeaxis-summary-value">'.concat(u,"</div>");(e.summaries.length>1||""!==u)&&(a+=c),s+="<label>".concat(r.label||"","</label>")+c})),n.innerHTML=a,n._tipHtml=s}))}},{key:"render",value:function(){var e=this,t=e.scheduler,n=t.element.querySelector(".b-grid-footer.b-sch-timeaxiscolumn");n&&(e.summaries.some((function(e){return e.label}))&&e.showTooltip&&!e._tip&&(e._tip=new Kl({id:"".concat(t.id,"-summary-tip"),cls:"b-timeaxis-summary-tip",hoverDelay:0,hideDelay:100,forElement:n,anchorToTarget:!0,trackMouse:!1,forSelector:".b-timeaxis-tick",getHtml:function(e){return e.activeTarget._tipHtml}})),n.innerHTML='<div class="b-timeaxis-tick" style="width: '.concat(t.tickSize,'px"></div>').repeat(t.timeAxis.count),e.updateScheduleSummaries())}}],[{key:"$name",get:function(){return"Summary"}},{key:"defaultConfig",get:function(){return{showTooltip:!0,summaries:null,renderer:null}}}]),n}(Uv);function OP(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}IP._$name="Summary",fv.registerFeature(IP,!1,"Scheduler");var FP=function(e){fe()(n,e);var t=OP(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(){we()(pe()(n.prototype),"construct",this).apply(this,arguments),this.triggerEvent.includes("click")&&this.client.zoomOnTimeAxisDoubleClick&&(this.client.zoomOnTimeAxisDoubleClick=!1)}},{key:"shouldShowMenu",value:function(e){var t=e.column;return t&&!1!==t.enableHeaderContextMenu&&t===this.client.timeAxisColumn}},{key:"showContextMenu",value:function(e){we()(pe()(n.prototype),"showContextMenu",this).apply(this,arguments),this.menu&&(this.menu.scrollAction="realign")}},{key:"populateTimeAxisHeaderMenu",value:function(e){var t=e.items,n=this,r=n.client,i={magnitude:r.timeAxis.shiftIncrement,unit:r.timeAxis.shiftUnit};Object.assign(t,{zoomLevel:{text:"L{pickZoomLevel}",localeClass:n,icon:"b-fw-icon b-icon-search-plus",disabled:!r.presets.count||n.disabled,weight:200,menu:{type:"popup",items:{zoomSlider:{weight:210,type:"slider",showValue:!1,listeners:{input:n.onZoomSliderChange,thisObj:n},minWidth:130}},onBeforeShow:function(e){var t=e.source,n=ye()(t.items,1)[0];n.min=r.minZoomLevel,n.max=r.maxZoomLevel,n.value=r.zoomLevel}}},dateRange:{text:"L{activeDateRange}",localeClass:n,icon:"b-fw-icon b-icon-calendar",weight:300,menu:{type:"popup",width:"20em",defaults:{localeClass:n},items:{startDateField:{type:"datefield",label:"L{startText}",weight:310,labelWidth:"6em",required:!0,step:i,listeners:{change:n.onRangeDateFieldChange,thisObj:n}},endDateField:{type:"datefield",label:"L{endText}",weight:320,labelWidth:"6em",required:!0,step:i,listeners:{change:n.onRangeDateFieldChange,thisObj:n}},leftShiftBtn:{type:"button",weight:330,cls:"b-left-nav-btn",icon:"b-icon b-icon-prev",color:"b-blue b-raised",flex:1,margin:0,listeners:{click:n.onLeftShiftBtnClick,thisObj:n}},todayBtn:{type:"button",weight:340,cls:"b-today-nav-btn",color:"b-blue b-raised",text:"L{todayText}",flex:4,margin:"0 8",listeners:{click:n.onTodayBtnClick,thisObj:n}},rightShiftBtn:{type:"button",weight:350,cls:"b-right-nav-btn",icon:"b-icon b-icon-next",color:"b-blue b-raised",flex:1,listeners:{click:n.onRightShiftBtnClick,thisObj:n}}},listeners:{paint:n.initDateRangeFields,thisObj:n}}}})}},{key:"onZoomSliderChange",value:function(e){var t=e.value,n=this;n.menu.scrollAction="realign",n.client.zoomLevel=t,n.menu.setTimeout({fn:function(){return n.menu.scrollAction="hide"},delay:100,cancelOutstanding:!0})}},{key:"initDateRangeFields",value:function(e){var t=e.source;if(e.firstPaint){var n=t.widgetMap;this.startDateField=n.startDateField,this.endDateField=n.endDateField}this.initDates()}},{key:"initDates",value:function(){var e=this;e.startDateField.suspendEvents(),e.endDateField.suspendEvents(),e.startDateField.value=e.startDateFieldInitialValue=e.client.startDate,e.endDateField.value=e.endDateFieldInitialValue=e.client.endDate,e.startDateField.resumeEvents(),e.endDateField.resumeEvents()}},{key:"onRangeDateFieldChange",value:function(e){var t=this,n=e.source===t.startDateField,r=t.client,i=r.timeAxis,o=t.startDateFieldInitialValue&&!n?t.startDateFieldInitialValue:t.startDateField.value,a=t.endDateFieldInitialValue&&n?t.endDateFieldInitialValue:t.endDateField.value;n?t.startDateFieldInitialValue=null:t.endDateFieldInitialValue=null,a-o?a<o&&(a=Zt.add(o,i.shiftIncrement,i.shiftUnit)):a=Zt.add(a,i.shiftIncrement,i.shiftUnit),r.preserveViewCenter((function(){return r.timeAxis.setTimeSpan(o,a)})),t.initDates()}},{key:"onLeftShiftBtnClick",value:function(){this.client.timeAxis.shiftPrevious(),this.initDates()}},{key:"onTodayBtnClick",value:function(){var e=Zt.clearTime(new Date);this.client.timeAxis.setTimeSpan(e,Zt.add(e,1,"day")),this.initDates()}},{key:"onRightShiftBtnClick",value:function(){this.client.timeAxis.shiftNext(),this.initDates()}}],[{key:"$name",get:function(){return"TimeAxisHeaderMenu"}},{key:"defaultConfig",get:function(){return{type:"timeAxisHeader"}}},{key:"pluginConfig",get:function(){var e=we()(pe()(n),"pluginConfig",this);return e.chain.push("populateTimeAxisHeaderMenu"),e}}]),n}(Qv);function LP(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}FP._$name="TimeAxisHeaderMenu",fv.registerFeature(FP,!0,["Scheduler","Gantt"]);var jP=function(e){fe()(n,e);var t=LP(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e,t){var r=this;we()(pe()(n.prototype),"construct",this).call(this,e,t),e._timeRangesExposed||(Object.defineProperty(e,"timeRanges",{get:function(){return r.timeRanges},set:function(e){return r.store.data=e}}),e._timeRangesExposed=!0),r.getConfig("timeRanges")}},{key:"startConfigure",value:function(e){var t=this.client;if(t.project&&!this.initialConfig.store){var n=t.project.timeRangeStore;if(n){var r=an.getPath(e,"store.data");r&&(n.data=r),e.store=n}}}},{key:"initCurrentTimeLine",value:function(){var e=this,t=new Date;!e.currentTimeLine&&e.showCurrentTimeLine&&(e.currentTimeLine=new e.store.modelClass({id:"currentTime",cls:"b-sch-current-time",startDate:t,name:Zt.format(t,e.currentDateFormat)}),e.updateCurrentTimeLine=e.updateCurrentTimeLine.bind(e),e.currentTimeInterval=e.setInterval(e.updateCurrentTimeLine,e.updateCurrentTimeLineInterval),e.client.isPainted&&e.renderRanges())}},{key:"updateCurrentTimeLine",value:function(){var e=this;e.currentTimeLine.startDate=new Date,e.currentTimeLine.name=Zt.format(e.currentTimeLine.startDate,e.currentDateFormat),e.onStoreChanged({action:"update",record:e.currentTimeLine,changes:{}})}},{key:"hideCurrentTimeLine",value:function(){var e=this;e.currentTimeLine&&(e.clearInterval(e.currentTimeInterval),e.currentTimeLine=null,e.client.isPainted&&e.renderRanges())}},{key:"renderRanges",value:function(){we()(pe()(n.prototype),"renderRanges",this).call(this),this.showCurrentTimeLine&&!this.disabled&&this.renderRange(this.currentTimeLine,!0)}},{key:"populateHeaderMenu",value:function(e){var t=e.column;e.items;"timeAxis"===t.type&&this.populateTimeAxisHeaderMenu.apply(this,arguments)}},{key:"populateTimeAxisHeaderMenu",value:function(e){e.column;var t=e.items,n=this;t.currentTimeLine={weight:400,text:n.L("L{showCurrentTimeLine}"),checked:n.showCurrentTimeLine,onToggle:function(e){var t=e.checked;n.showCurrentTimeLine=t}}}},{key:"timeRanges",set:function(e){var t=this.getConfig("store");t?t.data=e:this._timeRanges=e},get:function(){var e=this.store,t=e.records;if(e.recurringEvents){var n=[],r=this.client.timeAxis,i=r.startDate,o=r.endDate;return t.forEach((function(e){e.isRecurring?n.push.apply(n,e.getOccurrencesForDateRange(i,o)):n.push(e)})),n}return t}},{key:"showCurrentTimeLine",get:function(){return this._showCurrentTimeLine},set:function(e){this._showCurrentTimeLine=e,e?this.initCurrentTimeLine():this.hideCurrentTimeLine()}},{key:"disabled",get:function(){return this._disabled},set:function(e){this._disabled=e,this.client.isPainted&&this.renderRanges()}},{key:"store",get:function(){return this._store},set:function(e){var t=this,r=t.client;e.storeId||(e.storeId="timeRanges"),sc()(pe()(n.prototype),"store",e,this,!0),r.timeRanges&&!r._timeRangesExposed&&(t._store.add(r.timeRanges),delete r.timeRanges),t.timeRanges&&(t._store.add(t.timeRanges),delete t.timeRanges)}}],[{key:"$name",get:function(){return"TimeRanges"}},{key:"defaultConfig",get:function(){return{store:{modelClass:Qy,storeId:"timeRanges"},updateCurrentTimeLineInterval:1e4,currentDateFormat:"HH:mm",timeRanges:null,showCurrentTimeLine:!1}}}]),n}(qA);function _P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}jP._$name="TimeRanges",fv.registerFeature(jP,!1,["Scheduler","Gantt"]);var BP=function(e){fe()(n,e);var t=_P(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e,t){we()(pe()(n.prototype),"construct",this).call(this,e,t),y.a.deprecate("Scheduler","5.0.0","`TimeSpanRecordContextMenuBase` feature is deprecated, in favor of `TimeSpanMenuBase` feature. Please see https://bryntum.com/docs/scheduler/#guides/upgrades/3.1.0.md for more information.")}},{key:"doDestroy",value:function(){this.menu&&this.menu.destroy()}},{key:"onElementContextMenu",value:function(e){"contextmenu"===this.triggerEvent&&this.showEventContextMenu(e)}},{key:"onElementClick",value:function(e){"click"===this.triggerEvent&&this.showEventContextMenu(e)}},{key:"onElementDblClick",value:function(e){"dblclick"===this.triggerEvent&&this.showEventContextMenu(e)}},{key:"onEventSpaceKey",value:function(e){var t=En.from(e.target).center,n=new MouseEvent("contextmenu",Object.assign({clientX:t.x,clientY:t.y},e));Object.defineProperty(n,"target",{get:function(){return e.target}}),this.showEventContextMenu(n)}},{key:"showEventContextMenu",value:function(e){var t=this.client,n=e.target,r=Cr.up(n,t.eventSelector),i=r||n;if(i){var o=this.resolveRecord(i);o&&(e.preventDefault(),this.showContextMenuFor(o,{targetElement:i,eventElement:r,event:e}))}}},{key:"resolveRecord",value:function(){}},{key:"showContextMenuFor",value:function(e,t){}},{key:"beforeContextMenuShow",value:function(){}},{key:"showContextMenu",value:function(e){if(!this.disabled){var t=this,n=e.event,r=e.menuType.toLowerCase(),i=E.uncapitalize(r),o="get".concat(E.capitalize(r),"MenuItems"),a=t.client,s=t.processItems,u=t.defaultItems,c=t.namedItems,f=n?[n.clientX+1,n.clientY+1]:En.from(e.targetElement).center,d=e.items=an.isEmpty(t.items)?an.clone(u):an.merge(an.clone(u),t.items);e.namedItems=c,e.selection=a.selectedRecords,function e(t,n){for(var r in t){var i=t[r];if(i){r in n&&(i=t[r]="object"===l()(i)?an.merge(an.clone(n[r]),i):n[r]);var o=i.menu;o&&e("items"in o?o.items:o,n)}}}(d,c),a[o]&&a[o](e,d),s&&!1===s(e)||an.isEmpty(e.items)||!1!==t.beforeContextMenuShow(e)&&!1!==a.trigger("".concat(i,"ContextMenuBeforeShow"),e)&&(t.menu=lc.showContextMenu(f,{owner:a,scrollAction:"hide",clippedBy:[a.timeAxisSubGridElement,a.bodyContainer],constrainTo:window,items:d,onDestroy:function(){t.menu=null},onBeforeItem:function(t){Object.assign(t,e)},onItem:function(e){return a.trigger("".concat(i,"ContextMenuItem"),e)},listeners:{show:function(t){var n=t.source;e.menu=n,a.trigger("".concat(i,"ContextMenuShow"),e)}}}))}}},{key:"hideContextMenu",value:function(e){this.menu&&this.menu.hide(e)}},{key:"defaultItems",set:function(e){this._defaultItems=e},get:function(){var e=an.clone(this._defaultItems);if(this.client.readOnly)for(var t in e)e[t]=!1;return e}},{key:"triggerEvent",get:function(){return this._triggerEvent||this.client.contextMenuTriggerEvent},set:function(e){this._triggerEvent=e}}],[{key:"defaultConfig",get:function(){return{defaultItems:null,items:null,processItems:null,triggerEvent:null}}},{key:"pluginConfig",get:function(){return{assign:["showEventContextMenu"],chain:["onElementContextMenu","onElementClick","onElementDblClick","onEventSpaceKey"]}}}]),n}(qr);BP._$name="TimeSpanRecordContextMenuBase";var HP={completeview:"completeview",currentview:"currentview",daterange:"daterange"};function $P(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var NP=function(e){fe()(n,e);var t=$P(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"buildLocalizedItems",value:function(){var e=this;return Object.entries(HP).map((function(t){var n=ye()(t,2),r=n[0],i=n[1];return{id:r,text:e.L(i)}}))}}],[{key:"$name",get:function(){return"ScheduleRangeCombo"}},{key:"type",get:function(){return"schedulerangecombo"}},{key:"defaultConfig",get:function(){return{editable:!1}}}]),n}(Tp);function VP(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}NP.initClass(),NP._$name="ScheduleRangeCombo";var zP=function(e){fe()(n,e);var t=VP(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"onLocaleChange",value:function(){var e=this.L("labelWidth");this.width=this.L("L{width}"),this.items.forEach((function(t){t instanceof Pf?t.labelWidth=e:"rangeFieldsContainer"===t.ref&&(t.items[0].width=e)}))}},{key:"buildDialogItems",value:function(e){var t=this,r=e.client,i=t.getDefaultFieldValues(e).scheduleRange,o=we()(pe()(n.prototype),"buildDialogItems",this).call(this,e),a=t.L("labelWidth");t.columnsStore=r.columns.chain((function(e){return e.isLeaf&&e.exportable}));var s=o.find((function(e){return"columnsField"===e.ref}));return s.store=t.columnsStore,s.value=t.columnsStore.allRecords,o.splice(1,0,{labelWidth:a,type:"schedulerangecombo",ref:"scheduleRangeField",label:"L{Schedule range}",localeClass:t,value:i,onChange:function(e){var t=e.value!==HP.daterange,n=this.owner.widgetMap;n.rangeStartField.hidden=n.rangeEndField.hidden=t}},{type:"container",ref:"rangeFieldsContainer",flex:"1 0 100%",defaults:{localeClass:t},items:[{type:"widget",width:a},{type:"datefield",ref:"rangeStartField",label:"L{Export from}",labelWidth:"3em",hidden:!0,flex:"1 0 25%",localeClass:t,value:r.startDate,max:Zt.max(r.startDate,Zt.add(r.endDate,-1,"d")),onChange:function(e){var t=e.value;this.owner.widgetMap.rangeEndField.min=Zt.add(t,1,"d")}},{type:"widget",width:"0.5em"},{type:"datefield",ref:"rangeEndField",label:"L{Export to}",labelWidth:"1em",hidden:!0,flex:"1 0 25%",localeClass:t,value:r.endDate,min:Zt.min(r.endDate,Zt.add(r.startDate,1,"d")),onChange:function(e){var t=e.value;this.owner.widgetMap.rangeStartField.max=Zt.add(t,-1,"d")}}]}),o}},{key:"fieldProperties",get:function(){return["scheduleRange"].concat(d()(we()(pe()(n.prototype),"fieldProperties",this)))}}],[{key:"$name",get:function(){return"SchedulerExportDialog"}},{key:"defaultConfig",get:function(){return{scheduleRange:"completeview"}}}]),n}(Fp);function WP(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}zP._$name="SchedulerExportDialog";var GP=Promise.resolve(),YP=function(e){return function(e){fe()(u,e);var t,n,r,i,o,a,s=WP(u);function u(){return v()(this,u),s.apply(this,arguments)}return g()(u,[{key:"scrollRowIntoView",value:(a=Wr()(Vr.a.mark((function e(t,n){var r,i,o;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.rowManager,i=t.scrollable,o=i.y,!(n<t.store.count)){e.next=5;break}if(i.scrollTo(null,r.calculateTop(n)),i.y===o){e.next=5;break}return e.abrupt("return",new Promise((function(e){var i=t.on({scroll:function(t){null!=t.scrollTop&&r.getRow(n)&&(i(),e())}})})));case 5:return e.abrupt("return",GP);case 6:case"end":return e.stop()}}),e)}))),function(e,t){return a.apply(this,arguments)})},{key:"scrollToDate",value:(o=Wr()(Vr.a.mark((function e(t,n){var r,i,o;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=!1,i=[],o=t.timeAxisSubGrid.scrollable.on({scrollstart:function(e){null!=e.x&&(r=!0)}}),i.push(t.scrollToDate(n,{block:"start"})),o(),r&&(i.push(t.timeView.await("refresh",{checkLog:!1})),i.push(t.timeAxisSubGrid.header.scrollable.await("scrollEnd",{checkLog:!1}))),e.next=8,Promise.all(i);case 8:case"end":return e.stop()}}),e)}))),function(e,t){return o.apply(this,arguments)})},{key:"prepareComponent",value:(i=Wr()(Vr.a.mark((function e(t){var n,r,i,o,a,s,c,l,f,d,h,v,p;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this,r=t.client,i=r.timeAxisSubGrid.width>0,e.t0=t.scheduleRange,e.next=e.t0===HP.completeview?4:e.t0===HP.currentview?7:11;break;case 4:return t.rangeStart=r.startDate,t.rangeEnd=r.endDate,e.abrupt("break",11);case 7:return o=r.visibleDateRange,a=o.startDate,s=o.endDate,t.rangeStart=a,t.rangeEnd=s,e.abrupt("break",11);case 11:return e.next=13,r.waitForTransition();case 13:return i&&(r.setTimeSpan(t.rangeStart,t.rangeEnd),r.svgCanvas),n._oldEnableEventAnimations=r.enableEventAnimations,r.enableEventAnimations=!1,r.currentOrientation.isHorizontalRendering&&(n._oldScrollBuffer=r.currentOrientation.scrollBuffer,r.currentOrientation.scrollBuffer=100),e.next=19,we()(pe()(u.prototype),"prepareComponent",this).call(this,t);case 19:if(c=n.exportMeta,l=n.element.querySelector(".b-sch-foreground-canvas"),f=n.element.querySelector(".b-horizontaltimeaxis"),c.includeTimeline=i,i&&t.scheduleRange!==HP.completeview&&(c.totalWidth-=c.subGrids.normal.width,c.totalWidth+=c.subGrids.normal.width=r.timeAxisViewModel.getDistanceBetweenDates(t.rangeStart,t.rangeEnd),d=Math.ceil(c.totalWidth/c.pageWidth),h=d*c.verticalPages,c.horizontalPages=d,c.totalPages=h,c.subGrids.normal.scrollLeft=r.getCoordinateFromDate(t.rangeStart)),c.timeAxisHeaders=[],c.timeAxisPlaceholders=[],c.headersColleted=!1,Cr.forEachSelector(f,".b-sch-header-row",(function(e){c.timeAxisPlaceholders.push(n.createPlaceholder(e)),c.timeAxisHeaders.push(new Map)})),c.subGrids.normal.eventsPlaceholder=n.createPlaceholder(l,!1),Cr.removeEachSelector(l,".b-sch-event-wrap"),Cr.removeEachSelector(n.element,".b-released"),c.eventsBoxes=new Map,c.client=r,r.features.columnLines&&!r.features.columnLines.disabled&&(v=n.element.querySelector(".b-column-lines-canvas"),c.columnLinesPlaceholder=n.createPlaceholder(v),c.columnLines={lines:new Map,majorLines:new Map}),r.features.dependencies&&!r.features.dependencies.disabled&&(p=n.element.querySelector('[id="'.concat(r.svgCanvas.getAttribute("id"),'"]')),(c.dependenciesPlaceholder=p)&&Cr.removeEachSelector(p,".b-sch-dependency")),!i||Zt.betweenLesser(t.rangeStart,r.startDate,r.endDate)){e.next=36;break}return e.next=36,n.scrollToDate(r,t.rangeStart);case 36:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"restoreState",value:(r=Wr()(Vr.a.mark((function e(t){var n,r,i,o;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=!1,r=t.client,i=[],o=r.timeAxisSubGrid.scrollable.on({scrollStart:function(e){var t=e.x;this.element.scrollLeft!==t&&(n=!0)}}),i.push(we()(pe()(u.prototype),"restoreState",this).call(this,t)),o(),n&&i.push(r.timeAxisSubGrid.header.scrollable.await("scrollEnd",{checkLog:!1})),e.next=8,Promise.all(i);case 8:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"restoreComponent",value:(n=Wr()(Vr.a.mark((function e(t){var n;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t.client).enableEventAnimations=this._oldEnableEventAnimations,n.currentOrientation.isHorizontalRendering&&(n.currentOrientation.scrollBuffer=this._oldScrollBuffer),e.next=5,we()(pe()(u.prototype),"restoreComponent",this).call(this,t);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"onRowsCollected",value:(t=Wr()(Vr.a.mark((function e(t,n){var r,i,o,a,s,c,l,f;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=this,e.next=3,we()(pe()(u.prototype),"onRowsCollected",this).call(this,t);case 3:if(!r.exportMeta.includeTimeline){e.next=29;break}return i=n.client,o=i.timeView,a=r.getCurrentPageDateRange(n),s=a.pageRangeStart,c=a.pageRangeEnd,l=!1,e.next=8,r.scrollToDate(i,s);case 8:if(l){e.next=27;break}if(r.collectLines(n),r.collectHeaders(n),r.collectEvents(t,n),!Zt.timeSpanContains(o.startDate,o.endDate,s,c)){e.next=16;break}l=!0,e.next=25;break;case 16:if(!(o.endDate.getTime()>=c.getTime())){e.next=20;break}l=!0,e.next=25;break;case 20:return f=o.endDate,e.next=23,r.scrollToDate(i,o.endDate);case 23:if(f.getTime()!==o.endDate.getTime()){e.next=25;break}throw new Error("Could not scroll to date");case 25:e.next=8;break;case 27:return e.next=29,r.scrollToDate(i,n.rangeStart);case 29:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"getCurrentPageDateRange",value:function(e){var t,n,r=e.rangeStart,i=e.rangeEnd,o=e.client,a=this.exportMeta,s=a.horizontalPages,u=a.horizontalPosition,c=a.pageWidth,l=a.subGrids;if(s>1){var f=u*c,d=(u+1)*c,h=l.locked.width+l.locked.splitterWidth;d<=h?n=t=null:(t=o.getDateFromCoordinate(Math.max(f-h,0)),n=o.getDateFromCoordinate(1.2*(d-h))||i)}else t=r,n=i;return{pageRangeStart:t,pageRangeEnd:n}}},{key:"prepareExportElement",value:function(){var e=this.element,t=this.exportMeta,n=t.subGrids.normal,r=n.id,i=n.headerId,o=n.footerId,a=n.scrollLeft,s=e.querySelector('[id="'.concat(r,'"]'));return[".b-sch-background-canvas",".b-sch-foreground-canvas"].forEach((function(e){var n=s.querySelector(e);n&&(t.lastExportedRowBottom?n.style.height="".concat(t.lastExportedRowBottom,"px"):n.style.height="",a&&(n.style.marginLeft="-".concat(a,"px")))})),a&&[i,o].forEach((function(t){var n=e.querySelector('[id="'.concat(t,'"] .b-widget-scroller'));n&&(n.style.marginLeft="-".concat(a,"px"))})),we()(pe()(u.prototype),"prepareExportElement",this).call(this)}},{key:"collectRow",value:function(e){var t=this.exportMeta.subGrids;Object.entries(e.elements).forEach((function(n){var r=ye()(n,2),i=r[0],o=[r[1].outerHTML,e.top,e.offsetHeight];"normal"===i&&o.push(new Map),t[i].rows.push(o)}))}},{key:"collectHeaders",value:function(e){var t=e.client,n=this.exportMeta;if(!n.headersCollected){var r=t.timeView.element,i=n.timeAxisHeaders;Cr.forEachSelector(r,".b-sch-header-row",(function(e,r,o){var a=i[r];Cr.forEachSelector(e,".b-sch-header-timeaxis-cell",(function(e){a.has(e.dataset.tickIndex)||a.set(e.dataset.tickIndex,e.outerHTML)})),r===o.length-1&&a.has(String(t.timeAxis.count-1))&&(n.headersCollected=!0)}))}}},{key:"collectLines",value:function(e){var t=e.client,n=this.exportMeta,r=n.columnLines;if(!n.headersCollected&&r){var i=t.backgroundCanvas;Cr.forEachSelector(i,".b-column-line, .b-column-line-major",(function(e){if(e.classList.contains("b-column-line")){var t=Number(e.dataset.line.replace(/line-/,""));r.lines.set(t,e.outerHTML)}else{var n=Number(e.dataset.line.replace(/major-/,""));r.majorLines.set(n,e.outerHTML)}}))}}},{key:"collectEvents",value:function(e,t){var n=e.length,r=t.client,i=this.exportMeta.subGrids.normal.rows;e.forEach((function(e,t){var o=i[i.length-n+t],a=r.store.getAt(e.dataIndex),s=o[3];a.events&&a.events.forEach((function(e){if(e.isScheduled){var t=r.getElementFromEventRecord(e,a);t&&(t=t.parentElement)&&!s.has(e.id)&&s.set(e.id,[t.outerHTML,En.from(t,t.offsetParent)])}}))}))}},{key:"buildPageHtml",value:function(){var e=this,t=e.exportMeta,n=t.subGrids,r=t.timeAxisHeaders,i=t.timeAxisPlaceholders,o=t.columnLines,a=t.columnLinesPlaceholder,s=e.prepareExportElement();if(Object.values(n).forEach((function(t){var n=t.placeHolder,r=t.eventsPlaceholder,i=t.rows,o=n.outerHTML,a=e.positionRows(i),u=a.resources,c=a.events;s=s.replace(o,u.join("")),r&&(s=s.replace(r.outerHTML,c.join("")))})),r.forEach((function(e,t){s=s.replace(i[t].outerHTML,Array.from(e.values()).join(""))})),o){var u=Array.from(o.lines.values()).concat(Array.from(o.majorLines.values()));s=s.replace(a.outerHTML,u.join(""))}return s=e.buildDependenciesHtml(s)}},{key:"getDependenciesOuterHTML",value:function(){var e,t=this.exportMeta.dependenciesPlaceholder;if(j.a.isIE11){var n=document.createElement("div"),r=t.cloneNode(!0);n.appendChild(r),e=n.innerHTML}else e=t.outerHTML;return e}},{key:"renderDependencies",value:function(){var e=this.exportMeta,t=e.client,n=e.dependenciesPlaceholder,r=e.eventsBoxes,i=t.dependencies,o=t.features.dependencies,a=Array.from(r.keys());i.filter((function(e){return a.includes(String(e.from))||a.includes(String(e.to))})).forEach((function(e){var t=r.get(String(e.from)),i=r.get(String(e.to)),a=o.getIteratableDependencyAssignments(e),s=e.fromEvent,u=e.toEvent;a.forEach((function(r){var a,c;if(!t&&s){var l=o.getBox(e,!0,r);l&&(t=l instanceof En?l:new En(l.start,l.top,l.end-l.start,l.bottom-l.top))}if(!i&&u){var f=o.getBox(e,!1,r);f&&(i=f instanceof En?f:new En(f.start,f.top,f.end-f.start,f.bottom-f.top))}var d={startRectangle:null===(a=t)||void 0===a?void 0:a.clone(),endRectangle:null===(c=i)||void 0===c?void 0:c.clone()};t&&i&&o.drawDependency(e,d,r,n,!1)}))}));var s=this.getDependenciesOuterHTML();return Cr.removeEachSelector(n,".b-sch-dependency"),s}},{key:"buildDependenciesHtml",value:function(e){var t=this.exportMeta,n=t.dependenciesPlaceholder,r=t.includeTimeline;if(n&&r){var i=this.getDependenciesOuterHTML();e=e.replace(i,this.renderDependencies())}return e}}]),u}(e)};function UP(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var qP=function(e){fe()(r,e);var t,n=UP(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"stateNextPage",value:(t=Wr()(Vr.a.mark((function e(t){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,we()(pe()(r.prototype),"stateNextPage",this).call(this,t);case 2:this.exportMeta.eventsBoxes.clear();case 3:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"positionRows",value:function(e){var t=this,n=[],r=[];return e.forEach((function(e){var i=ye()(e,4),o=i[0],a=(i[1],i[2],i[3]);n.push(o),a&&Array.from(a.entries()).forEach((function(e){var n=ye()(e,2),i=n[0],o=ye()(n[1],2),a=o[0],s=o[1];r.push(a),t.exportMeta.eventsBoxes.set(String(i),s)}))})),{resources:n,events:r}}}],[{key:"$name",get:function(){return"MultiPageExporter"}}]),r}(YP(zp));function KP(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}qP._$name="MultiPageExporter";var XP=function(e){fe()(i,e);var t,n,r=KP(i);function i(){return v()(this,i),r.apply(this,arguments)}return g()(i,[{key:"stateNextPage",value:(n=Wr()(Vr.a.mark((function e(t){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,we()(pe()(i.prototype),"stateNextPage",this).call(this,t);case 2:this.exportMeta.eventsBoxes.clear();case 3:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"prepareComponent",value:(t=Wr()(Vr.a.mark((function e(t){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,we()(pe()(i.prototype),"prepareComponent",this).call(this,t);case 2:t.scheduleRange!==HP.completeview&&this.estimateTotalPages(t);case 3:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"positionRows",value:function(e){var t=this,n=[],r=[];return e.forEach((function(e){var i=ye()(e,4),o=i[0],a=(i[1],i[2],i[3]);n.push(o),a&&Array.from(a.entries()).forEach((function(e){var n=ye()(e,2),i=n[0],o=ye()(n[1],2),a=o[0],s=o[1];r.push(a),t.exportMeta.eventsBoxes.set(String(i),s)}))})),{resources:n,events:r}}}],[{key:"$name",get:function(){return"MultiPageVerticalExporter"}}]),i}(YP(Gp));function ZP(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}XP._$name="MultiPageVerticalExporter";var JP=function(e){fe()(n,e);var t=ZP(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"collectDependencies",value:function(){}},{key:"positionRows",value:function(e){var t=this,n=0,r=[],i=[],o=/translate\((\d+.?\d*)px, (\d+.?\d*)px\)/;return e.forEach((function(e){var a=ye()(e,4),s=a[0],u=a[1],c=a[2],l=a[3];r.push(s.replace(o,"translate($1px, ".concat(n,"px)")));var f=n-u;l&&Array.from(l.entries()).forEach((function(e){var n=ye()(e,2),r=n[0],a=ye()(n[1],2),s=a[0],u=a[1];u.translate(0,f),t.exportMeta.eventsBoxes.set(String(r),u),i.push(s.replace(o,"translate($1px, ".concat(u.y,"px)")))})),n+=c})),{resources:r,events:i}}}],[{key:"$name",get:function(){return"SinglePageExporter"}}]),n}(YP(Up));function QP(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}JP._$name="SinglePageExporter";var eI=function(e){fe()(n,e);var t=QP(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"showExportDialog",value:function(){var e=this;e.exportDialog||(e.exportDialog=new zP(Object.assign({},e.defaultExportDialogConfig,{listeners:{export:e.onExportDialogExport,thisObj:e}}))),e.exportDialog.show()}},{key:"buildExportConfig",value:function(e){e=we()(pe()(n.prototype),"buildExportConfig",this).call(this,e);var t=this.scheduleRange,r=this.rangeStart,i=this.rangeEnd;return e.columns&&!e.columns.find((function(e){return"timeAxis"===e.type}))&&e.columns.push(e.client.timeAxisColumn.id),an.assign({scheduleRange:t,rangeStart:r,rangeEnd:i},e)}},{key:"defaultExportDialogConfig",get:function(){return an.copyProperties(we()(pe()(n.prototype),"defaultExportDialogConfig",this),this,["scheduleRange"])}}],[{key:"$name",get:function(){return"PdfExport"}},{key:"defaultConfig",get:function(){return{exporters:[JP,qP,XP],scheduleRange:"completeview",rangeStart:null,rangeEnd:null}}}]),n}(Kp);function tI(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}eI._$name="PdfExport",fv.registerFeature(eI,!1,"Scheduler");var nI=function(e){fe()(n,e);var t=tI(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(){for(var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},r=arguments.length,i=new Array(r>1?r-1:0),o=1;o<r;o++)i[o-1]=arguments[o];(e=we()(pe()(n.prototype),"construct",this)).call.apply(e,[this,t].concat(i)),this.eventSortFn||(this.eventSortFn=function(e,t){return e.internalId-t.internalId})}},{key:"normalizeColumns",value:function(e){we()(pe()(n.prototype),"normalizeColumns",this).call(this,e),e.eventColumns=e.eventColumns.map((function(e){return"string"==typeof e?{field:e}:e}))}},{key:"generateExportData",value:function(e){var t=this.target instanceof _A,n=this.generateColumns(e),r=t?this.generateEventColumns(e):[];return{columns:n.concat(r),rows:this.generateRows(e)}}},{key:"generateEventColumns",value:function(e){var t=this;return e.eventColumns.map((function(n){return t.processEventColumn(n,e)}))}},{key:"processEventColumn",value:function(e,t){var n=e.width,r=e.minWidth,i=t.defaultColumnWidth;return{field:e.field,value:e.text,width:Math.max(n||i,r||i),eventColumn:!0,type:this.getColumnType(e,this.target.eventStore)}}},{key:"generateRows",value:function(e){var t,r=this,i=r.target;if(i instanceof _A){if(t=[],i.resourceStore.map((function(n){var i=n.events||[];i.sort(r.eventSortFn),i.length||i.push(""),i.forEach((function(i){return t.push(r.getRowData(e,n,i))}))})),e.includeUnassigned&&e.eventColumns.length){var o=i.eventStore.query((function(e){return!e.resources.length}));if(o.length){var a=new Array(e.columns.length).fill("");a.push(r.L("L{ExcelExporter.No resource assigned}")),t.push(a),o.forEach((function(n){return t.push(r.getRowData(e,null,n))}))}}t=t.filter((function(e){return e.length}))}else t=we()(pe()(n.prototype),"generateRows",this).call(this,e);return t}},{key:"getRowData",value:function(e,t,n){var r=e.columns,i=e.eventColumns,o=[],a=this.processRecord(t,r,e);if(a&&o.push.apply(o,d()(a)),!t||!t.isSpecialRow){var s=this.processRecord(n,i,e);s&&o.push.apply(o,d()(s))}return o}}],[{key:"defaultConfig",get:function(){return{includeUnassigned:!0,eventColumns:[{text:"Task",field:"name"},{text:"Starts",field:"startDate",width:140},{text:"Ends",field:"endDate",width:140}],eventSortFn:null}}}]),n}(lt(Zp));function rI(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}nI._$name="ScheduleTableExporter";var iI=function(e){fe()(n,e);var t=rI(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"$name",get:function(){return"ExcelExporter"}},{key:"defaultConfig",get:function(){return{exporterClass:nI,exporterConfig:null}}}]),n}(eg);function oI(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}iI._$name="ExcelExporter",fv.registerFeature(iI,!1,"Scheduler");var aI=function(e){fe()(n,e);var t=oI(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(){var e=this;we()(pe()(n.prototype),"construct",this).apply(this,arguments),e.grid.isPainted?e.addErrorListener():e.grid.on({paint:e.addErrorListener,thisObj:e,once:!0})}},{key:"getImageURL",value:function(e){return E.joinPaths([this.grid.resourceImagePath||"",e||""])}},{key:"addErrorListener",value:function(){var e=this;nu.on({element:this.grid.element,delegate:".b-resource-image",error:function(t){return e.setDefaultResourceImage(t.target)},capture:!0})}},{key:"setDefaultResourceImage",value:function(e){var t=this.grid.defaultResourceImageName;if(t){var n=this.getImageURL(t);e.src&&!e.src.endsWith(n.replace(/^[./]*/gm,""))&&(e.src=n)}}},{key:"template",value:function(e){var t,n=this,r=n.showImage,i=n.showRole,o=n.showEventCount,a=n.grid,s=a.timeAxis,u=a.resourceImageExtension,c=a.defaultResourceImageName,l="string"==typeof i?i:"role",f=e.eventStore.getEvents({includeOccurrences:a.enableRecurringEvents,resourceRecord:e,startDate:s.startDate,endDate:s.endDate}).length,d=e.get(n.field);if(r&&!1!==e.image)if(e.imageUrl)t=e.imageUrl;else{var h="string"==typeof r?r:e.image||d&&d.toLowerCase()+u||c;t=n.getImageURL(h),h.includes(".")||(!n.validNames||n.validNames.includes(h)?t+=u:e.iconCls||(t=n.getImageURL(c)))}return{class:"b-resource-info",children:[t?{tag:"img",draggable:"false",class:"b-resource-image",src:t}:null,e.iconCls?{tag:"i",className:"b-resource-icon ".concat(e.iconCls)}:null,{tag:"dl",children:[{tag:"dt",html:d},i?{tag:"dd",class:"b-resource-role",html:e[l]}:null,o?{tag:"dd",class:"b-resource-events",html:n.L("L{eventCountText}",f)}:null]}]}}},{key:"defaultRenderer",value:function(e){var t,n=e.grid,r=e.record,i=e.cellElement,o=e.value,a=e.isExport;return r.isSpecialRow?t="":a?t=o:(this.autoScaleThreshold&&n.rowHeight<this.autoScaleThreshold?i.style.fontSize=n.rowHeight/40+"em":i.style.fontSize="",t=this.template(r)),t}}],[{key:"$name",get:function(){return"ResourceInfoColumn"}},{key:"type",get:function(){return"resourceInfo"}},{key:"fields",get:function(){return["showEventCount","showRole","showImage","validNames","autoScaleThreshold"]}},{key:"defaults",get:function(){return{showImage:!0,showEventCount:!0,showRole:!1,validNames:["amit","angelo","arcady","arnold","celia","chang","dan","dave","emilia","george","gloria","henrik","hitomi","jong","kate","lee","linda","lisa","lola","macy","madison","malik","mark","maxim","mike","rob","steve"],autoScaleThreshold:40,field:"name",htmlEncode:!1,width:140,cellCls:"b-resourceinfo-cell",editor:!y.a.isTestEnv&&"text"}}}]),n}(Dh);function sI(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Th.registerColumnType(aI),aI._$name="ResourceInfoColumn";var uI=function(e){fe()(n,e);var t=sI(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"$name",get:function(){return"Scheduler"}},{key:"type",get:function(){return"scheduler"}}]),n}(_A);function cI(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}uI.initClass(),uI._$name="Scheduler";var lI=function(e){return e.isProjectConsumer},fI=function(e){fe()(r,e);var t,n=cI(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"construct",value:function(){we()(pe()(r.prototype),"construct",this).apply(this,arguments),this.stm||(this.scheduler=this.up(lI)),this.stm.on({recordingstop:"updateUndoRedoControls",restoringstop:"updateUndoRedoControls",queueReset:"updateUndoRedoControls",disabled:"updateUndoRedoControls",thisObj:this})}},{key:"changeItems",value:function(e){var t=e.undoBtn,n=e.redoBtn;return this.color&&(t&&(t.color=this.color),n&&(n.color=this.color)),this.text&&(t&&(t.text="Undo"),n&&(n.text="Redo")),we()(pe()(r.prototype),"changeItems",this).call(this,e)}},{key:"changeScheduler",value:function(e){return e.isProjectConsumer?e:bryntum.get(e)}},{key:"updateScheduler",value:function(e){var t=e.crudManager;t?t.on({load:"onCrudManagerLoad",thisObj:this}):this.onCrudManagerLoad(),this.stm=e.project.stm}},{key:"updateProject",value:function(e){this.stm=e.stm}},{key:"onCrudManagerLoad",value:(t=Wr()(Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.scheduler.project.commitAsync();case 2:this.isDestroyed||(this.stm.enable(),this.fillUndoRedoCombo());case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"fillUndoRedoCombo",value:function(){this.widgetMap.transactionsCombo&&(this.widgetMap.transactionsCombo.items=this.stm.queue.map((function(e,t){return[t,e||"Transaction ".concat(t)]})))}},{key:"updateUndoRedoControls",value:function(){var e=this.stm,t=this.showZeroActionBadge,n=this.widgetMap,r=n.undoBtn,i=n.redoBtn;r.badge=e.position||(t?"0":""),i.badge=e.length-e.position||(t?"0":""),r.disabled=!e.canUndo,i.disabled=!e.canRedo,this.fillUndoRedoCombo()}},{key:"transactionsDisplayValueRenderer",value:function(e,t){var n,r=(null===(n=this.stm)||void 0===n?void 0:n.position)||0;return"".concat(r," undo actions / ").concat(t.store.count-r," redo actions")}},{key:"onUndo",value:function(){this.stm.canUndo&&this.stm.undo()}},{key:"onRedo",value:function(){this.stm.canRedo&&this.stm.redo()}},{key:"onTransactionSelected",value:function(e){var t=this.stm,n=e.value;n>=0&&(t.canUndo&&n<t.position?t.undo(t.position-n):t.canRedo&&n>=t.position&&t.redo(n-t.position+1))}}],[{key:"$name",get:function(){return"UndoRedo"}},{key:"type",get:function(){return"undoredo"}},{key:"configurable",get:function(){return{scheduler:null,project:null,text:null,color:null,showZeroActionBadge:null,cls:"b-undo-controls b-toolbar",layoutStyle:{alignItems:"stretch",flexFlow:"row nowrap",overflow:"visible"},items:{undoBtn:{type:"button",icon:"b-fa-undo",tooltip:"Undo last action",disabled:!0,onAction:"up.onUndo"},transactionsCombo:{type:"combo",valueField:"idx",editable:!1,store:{},emptyText:"No items in the undo queue",onAction:"up.onTransactionSelected",displayValueRenderer:"up.transactionsDisplayValueRenderer"},redoBtn:{type:"button",icon:"b-fa-redo",tooltip:"Redo last undone action",disabled:!0,onAction:"up.onRedo"}}}}}]),r}(Rl);function dI(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}fI.initClass(),fI._$name="UndoRedo";var hI=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":l()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},vI=function(e){fe()(n,e);var t=dI(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([lC],(function(e){e.prototype;var t=function(e){fe()(n,e);var t=dI(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(e);return hI([Vw({type:"number",defaultValue:100})],t.prototype,"units",void 0),t})));function pI(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var gI=function(e,t){if(e!==t)throw new Error("Store set is prohibited for Scheduler Pro entity!")},yI=function(e){return function(e){fe()(n,e);var t=pI(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"taskStore",get:function(){return this.eventStore},set:function(e){this.eventStore=e}},{key:"eventStore",get:function(){var e;return null===(e=this.project)||void 0===e?void 0:e.eventStore},set:function(e){gI(this.eventStore,e)}},{key:"leftProjectEventStore",get:function(){var e=this.leftProject;return(null==e?void 0:e.getEventStore())||null}},{key:"dependencyStore",get:function(){var e;return null===(e=this.project)||void 0===e?void 0:e.dependencyStore},set:function(e){gI(this.dependencyStore,e)}},{key:"assignmentStore",get:function(){var e;return null===(e=this.project)||void 0===e?void 0:e.assignmentStore},set:function(e){gI(this.assignmentStore,e)}},{key:"resourceStore",get:function(){var e;return null===(e=this.project)||void 0===e?void 0:e.resourceStore},set:function(e){gI(this.resourceStore,e)}},{key:"calendarManagerStore",get:function(){var e;return null===(e=this.project)||void 0===e?void 0:e.calendarManagerStore},set:function(e){gI(this.calendarManagerStore,e)}}],[{key:"$name",get:function(){return"PartOfProject"}}]),n}(e||ue)};function mI(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var kI=function(e){fe()(n,e);var t=mI(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"$name",get:function(){return"AssignmentModel"}},{key:"isProAssignmentModel",get:function(){return!0}}]),n}(yI(sm(vI.derive(Bi))));function bI(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}kI._$name="AssignmentModel";var wI=function(e){fe()(n,e);var t=bI(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"defaultConfig",get:function(){return{modelClass:kI}}}]),n}(yI(MC(LC.derive(Uo))));function CI(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}wI._$name="AssignmentStore";var SI=function(e){fe()(n,e);var t=CI(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"$name",get:function(){return"CalendarIntervalModel"}}]),n}(yI(wS.derive(Bi)));function DI(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}SI._$name="CalendarIntervalModel";var RI=function(e){fe()(n,e);var t=DI(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"toString",value:function(){return this.name||""}}],[{key:"$name",get:function(){return"CalendarModel"}},{key:"fields",get:function(){return[]}},{key:"defaultConfig",get:function(){return{calendarIntervalModelClass:SI}}}]),n}(yI(FS.derive(Bi)));function xI(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}RI._$name="CalendarModel";var EI=function(e){fe()(n,e);var t=xI(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"defaultConfig",get:function(){return{tree:!0,modelClass:RI,loadPriority:100,syncPriority:100,storeId:"calendars"}}}]),n}(yI(dM.derive(Uo)));function TI(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}EI._$name="CalendarManagerStore";var MI=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":l()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},AI=function(e){fe()(n,e);var t=TI(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([hx],(function(e){e.prototype;var t=function(e){fe()(r,e);var t,n=TI(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"calculateCalendar",value:Vr.a.mark((function e(){var t,n,r,i,o;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.getProject(),e.next=3,t.$.dependenciesCalendar;case 3:n=e.sent,e.t0=n,e.next=e.t0===eS.Project?7:e.t0===eS.FromEvent?11:e.t0===eS.ToEvent?23:35;break;case 7:return e.next=9,t.$.effectiveCalendar;case 9:return r=e.sent,e.abrupt("break",35);case 11:return e.next=13,this.$.fromEvent;case 13:if(!(i=e.sent)||ek(i)){e.next=20;break}return e.next=17,i.$.effectiveCalendar;case 17:e.t1=e.sent,e.next=21;break;case 20:e.t1=null;case 21:return r=e.t1,e.abrupt("break",35);case 23:return e.next=25,this.$.toEvent;case 25:if(!(o=e.sent)||ek(o)){e.next=32;break}return e.next=29,o.$.effectiveCalendar;case 29:e.t2=e.sent,e.next=33;break;case 32:e.t2=null;case 33:return r=e.t2,e.abrupt("break",35);case 35:if(r){e.next=39;break}return e.next=38,t.$.effectiveCalendar;case 38:r=e.sent;case 39:return e.abrupt("return",r);case 40:case"end":return e.stop()}}),e,this)}))},{key:"setLag",value:(t=Wr()(Vr.a.mark((function e(t,n){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.graph){e.next=5;break}return this.graph.write(this.$.lag,t,n),e.abrupt("return",this.graph.commitAsync());case 5:this.$.lag.DATA=t,null!=n&&(this.$.lagUnit.DATA=n);case 7:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})},{key:"writeLag",value:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0;e.constructor.prototype.write.call(this,e,t,n,r),null!=i&&t.write(this.$.lagUnit,i)}}]),r}(e);return MI([Vw({type:"number",defaultValue:0})],t.prototype,"lag",void 0),MI([Vw({type:"string",defaultValue:KC.Day},{converter:Zt.normalizeUnit})],t.prototype,"lagUnit",void 0),MI([lw()],t.prototype,"calendar",void 0),MI([fw("calendar")],t.prototype,"calculateCalendar",null),MI([dw("lag")],t.prototype,"writeLag",null),t})));function PI(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var II=function(e){fe()(n,e);var t=PI(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"$name",get:function(){return"DependencyModel"}},{key:"isProDependencyModel",get:function(){return!0}}]),n}(yI(AI.derive(lx)));function OI(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}II._$name="DependencyModel";var FI=function(e){fe()(n,e);var t=OI(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"defaultConfig",get:function(){return{modelClass:II}}}]),n}(yI(bx(Dx.derive(Uo))));function LI(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}FI._$name="DependencyStore";var jI=function(e){return function(e){fe()(n,e);var t=LI(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"copy",value:function(){var e=we()(pe()(n.prototype),"copy",this).apply(this,arguments);return e.percentDone=0,e}},{key:"isStarted",get:function(){return this.percentDone>0}},{key:"isCompleted",get:function(){return this.percentDone>=100}},{key:"isInProgress",get:function(){return this.isStarted&&!this.isCompleted}},{key:"renderedPercentDone",get:function(){var e="number"!=typeof this.percentDone||isNaN(this.percentDone)?0:this.percentDone;return e<=99?Math.round(e):Math.floor(e)},set:function(e){this.percentDone=e}}],[{key:"$name",get:function(){return"PercentDoneMixin"}}]),n}(e)};function _I(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var BI=function(e){fe()(n,e);var t=_I(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"initialize",value:function(){for(var e,t=arguments.length,r=new Array(t),i=0;i<t;i++)r[i]=arguments[i];(e=we()(pe()(n.prototype),"initialize",this)).call.apply(e,[this].concat(r)),this.startDate||(this.startDate=aS),this.endDate||(this.endDate=sS)}},{key:"equalTo",value:function(e){return this.startDate.getTime()===e.startDate.getTime()&&this.endDate.getTime()===e.endDate.getTime()}},{key:"startDateIsFinite",value:function(){return!this.isIntervalEmpty()&&this.startDate.getTime()!==aS.getTime()}},{key:"endDateIsFinite",value:function(){return!this.isIntervalEmpty()&&this.endDate.getTime()!==sS.getTime()}},{key:"containsDate",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:oS.Left;return t===oS.Left&&e>=this.startDate&&e<this.endDate||t===oS.Right&&e>this.startDate&&e<=this.endDate}},{key:"isIntervalEmpty",value:function(){return this.startDate>this.endDate}},{key:"intersect",value:function(e){var t=e.startDate,n=e.endDate,r=this.startDate,i=this.endDate;if(i<t||r>n)return HI;var o=new Date(Math.max(r.getTime(),t.getTime())),a=new Date(Math.min(i.getTime(),n.getTime()));return this.constructor.new({startDate:o,endDate:a})}},{key:"intersectMut",value:function(e){var t=e.startDate,n=e.endDate,r=this.startDate,i=this.endDate;return i<t||r>n?(this.startDate=sS,this.endDate=aS,this):(this.startDate=new Date(Math.max(r.getTime(),t.getTime())),this.endDate=new Date(Math.min(i.getTime(),n.getTime())),this)}}]),n}(qm),HI=BI.new({startDate:sS,endDate:aS}),$I=function(e){return e.reduce((function(e,t){return e.intersectMut(t)}),BI.new())};function NI(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return VI(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return VI(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function VI(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function zI(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var WI=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":l()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},GI=Vr.a.mark((function e(t,n,r,i){var o,a;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!r.isIntervalEmpty()){e.next=2;break}return e.abrupt("return",HI);case 2:if(!r.startDateIsFinite()){e.next=7;break}return e.delegateYield(t.calculateProjectedXDateWithDuration(r.startDate,!1,i),"t1",4);case 4:e.t0=e.t1,e.next=8;break;case 7:e.t0=null;case 8:if(o=e.t0,!r.endDateIsFinite()){e.next=14;break}return e.delegateYield(t.calculateProjectedXDateWithDuration(r.endDate,!1,i),"t3",11);case 11:e.t2=e.t3,e.next=15;break;case 14:e.t2=null;case 15:return a=e.t2,e.abrupt("return",$I([n,BI.new({startDate:o,endDate:a})]));case 17:case"end":return e.stop()}}),e)})),YI=Vr.a.mark((function e(t,n,r,i){var o,a;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n.isIntervalEmpty()){e.next=2;break}return e.abrupt("return",HI);case 2:if(!n.startDateIsFinite()){e.next=7;break}return e.delegateYield(t.calculateProjectedXDateWithDuration(n.startDate,!0,i),"t1",4);case 4:e.t0=e.t1,e.next=8;break;case 7:e.t0=null;case 8:if(o=e.t0,!n.endDateIsFinite()){e.next=14;break}return e.delegateYield(t.calculateProjectedXDateWithDuration(n.endDate,!0,i),"t3",11);case 11:e.t2=e.t3,e.next=15;break;case 14:e.t2=null;case 15:return a=e.t2,e.abrupt("return",$I([r,BI.new({startDate:o,endDate:a})]));case 17:case"end":return e.stop()}}),e)})),UI=function(e){fe()(n,e);var t=zI(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([CM],(function(e){var t=e.prototype,n=function(e){fe()(r,e);var n=zI(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"maybeSkipNonWorkingTime",value:Vr.a.mark((function e(t){var n,r,i=arguments;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(i.length>1&&void 0!==i[1])||i[1],e.delegateYield(this.calculateEffectiveDuration(),"t0",2);case 2:if(r=e.t0,!(t&&r>0)){e.next=8;break}return e.delegateYield(this.skipNonWorkingTime(t,n),"t2",5);case 5:e.t1=e.t2,e.next=9;break;case 8:e.t1=t;case 9:return e.abrupt("return",e.t1);case 10:case"end":return e.stop()}}),e,this)}))},{key:"calculateEffectiveConstraintInterval",value:Vr.a.mark((function e(t,n,r){var i,o,a;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this.calculateEffectiveDuration(),"t0",1);case 1:if(null!=(i=e.t0)){e.next=4;break}return e.abrupt("return",null);case 4:return o=t?GI:YI,e.delegateYield(o(this,$I(n),$I(r),i),"t1",6);case 6:return a=e.t1,e.abrupt("return",a);case 8:case"end":return e.stop()}}),e,this)}))},{key:"calculateStartDateConstraintIntervals",value:Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",[]);case 1:case"end":return e.stop()}}),e)}))},{key:"calculateEndDateConstraintIntervals",value:Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",[]);case 1:case"end":return e.stop()}}),e)}))},{key:"calculateEarlyStartDateConstraintIntervals",value:Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",[]);case 1:case"end":return e.stop()}}),e)}))},{key:"calculateEarlyEndDateConstraintIntervals",value:Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",[]);case 1:case"end":return e.stop()}}),e)}))},{key:"calculateEarlyEffectiveStartDateInterval",value:Vr.a.mark((function e(){var t,n;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.earlyStartDateConstraintIntervals;case 2:return t=e.sent,e.next=5,this.$.earlyEndDateConstraintIntervals;case 5:return n=e.sent,e.t0=this,e.t1=t,e.next=10,this.$.startDateConstraintIntervals;case 10:return e.t2=e.sent,e.t3=e.t1.concat.call(e.t1,e.t2),e.t4=n,e.next=15,this.$.endDateConstraintIntervals;case 15:return e.t5=e.sent,e.t6=e.t4.concat.call(e.t4,e.t5),e.delegateYield(e.t0.calculateEffectiveConstraintInterval.call(e.t0,!0,e.t3,e.t6),"t7",18);case 18:return e.abrupt("return",e.t7);case 19:case"end":return e.stop()}}),e,this)}))},{key:"calculateEarlyEffectiveEndDateInterval",value:Vr.a.mark((function e(){var t,n;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.earlyStartDateConstraintIntervals;case 2:return t=e.sent,e.next=5,this.$.earlyEndDateConstraintIntervals;case 5:return n=e.sent,e.t0=this,e.t1=t,e.next=10,this.$.startDateConstraintIntervals;case 10:return e.t2=e.sent,e.t3=e.t1.concat.call(e.t1,e.t2),e.t4=n,e.next=15,this.$.endDateConstraintIntervals;case 15:return e.t5=e.sent,e.t6=e.t4.concat.call(e.t4,e.t5),e.delegateYield(e.t0.calculateEffectiveConstraintInterval.call(e.t0,!1,e.t3,e.t6),"t7",18);case 18:return e.abrupt("return",e.t7);case 19:case"end":return e.stop()}}),e,this)}))},{key:"calculateEarlyStartDateRaw",value:Vr.a.mark((function e(){var t,n,r,i,o,a,s,u;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this.hasSubEvents(),"t0",1);case 1:if(!e.t0){e.next=25;break}return t=sS,e.delegateYield(this.subEventsIterable(),"t1",4);case 4:n=e.t1,r=NI(n),e.prev=6,r.s();case 8:if((i=r.n()).done){e.next=16;break}return o=i.value,e.next=12,o.$.earlyStartDate;case 12:(a=e.sent)&&a<t&&(t=a);case 14:e.next=8;break;case 16:e.next=21;break;case 18:e.prev=18,e.t2=e.catch(6),r.e(e.t2);case 21:return e.prev=21,r.f(),e.finish(21);case 24:return e.abrupt("return",t.getTime()-sS.getTime()?t:null);case 25:return e.next=27,this.$.manuallyScheduled;case 27:if(!e.sent){e.next=31;break}return e.next=30,this.$.startDate;case 30:return e.abrupt("return",e.sent);case 31:return e.delegateYield(this.isConstrainedEarly(),"t3",32);case 32:if(e.t3){e.next=36;break}return e.next=35,this.$.startDate;case 35:return e.abrupt("return",e.sent);case 36:return e.next=38,this.$.earlyEffectiveStartDateInterval;case 38:if(null!==(s=e.sent)){e.next=43;break}return e.abrupt("return",null);case 43:if(!s.isIntervalEmpty()){e.next=55;break}return u=QT.new(),e.next=47,u;case 47:if(e.t4=e.sent,e.t5=XT.Cancel,e.t4!==e.t5){e.next=54;break}return e.next=52,yk(u);case 52:e.next=55;break;case 54:return e.abrupt("return",null);case 55:return e.abrupt("return",uS(s.startDate)?s.startDate:null);case 56:case"end":return e.stop()}}),e,this,[[6,18,21,24]])}))},{key:"calculateEarlyStartDate",value:Vr.a.mark((function e(){var t;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.earlyStartDateRaw;case 2:return t=e.sent,e.delegateYield(this.maybeSkipNonWorkingTime(t,!0),"t0",4);case 4:return e.abrupt("return",e.t0);case 5:case"end":return e.stop()}}),e,this)}))},{key:"calculateEarlyEndDateRaw",value:Vr.a.mark((function e(){var t,n,r,i,o,a,s,u;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this.hasSubEvents(),"t0",1);case 1:if(!e.t0){e.next=25;break}return t=aS,e.delegateYield(this.subEventsIterable(),"t1",4);case 4:n=e.t1,r=NI(n),e.prev=6,r.s();case 8:if((i=r.n()).done){e.next=16;break}return o=i.value,e.next=12,o.$.earlyEndDate;case 12:(a=e.sent)&&a>t&&(t=a);case 14:e.next=8;break;case 16:e.next=21;break;case 18:e.prev=18,e.t2=e.catch(6),r.e(e.t2);case 21:return e.prev=21,r.f(),e.finish(21);case 24:return e.abrupt("return",t.getTime()-aS.getTime()?t:null);case 25:return e.next=27,this.$.manuallyScheduled;case 27:if(!e.sent){e.next=31;break}return e.next=30,this.$.endDate;case 30:return e.abrupt("return",e.sent);case 31:return e.delegateYield(this.isConstrainedEarly(),"t3",32);case 32:if(e.t3){e.next=36;break}return e.next=35,this.$.endDate;case 35:return e.abrupt("return",e.sent);case 36:return e.next=38,this.$.earlyEffectiveEndDateInterval;case 38:if(null!==(s=e.sent)){e.next=43;break}return e.abrupt("return",null);case 43:if(!s.isIntervalEmpty()){e.next=55;break}return u=QT.new(),e.next=47,u;case 47:if(e.t4=e.sent,e.t5=XT.Cancel,e.t4!==e.t5){e.next=54;break}return e.next=52,yk(u);case 52:e.next=55;break;case 54:return e.abrupt("return",null);case 55:return e.abrupt("return",uS(s.startDate)?s.startDate:null);case 56:case"end":return e.stop()}}),e,this,[[6,18,21,24]])}))},{key:"calculateEarlyEndDate",value:Vr.a.mark((function e(){var t;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.earlyEndDateRaw;case 2:return t=e.sent,e.delegateYield(this.maybeSkipNonWorkingTime(t,!1),"t0",4);case 4:return e.abrupt("return",e.t0);case 5:case"end":return e.stop()}}),e,this)}))},{key:"isConstrainedEarly",value:Vr.a.mark((function e(){var t,n,r,i;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.startDateConstraintIntervals;case 2:return t=e.sent,e.next=5,this.$.endDateConstraintIntervals;case 5:return n=e.sent,e.next=8,this.$.earlyStartDateConstraintIntervals;case 8:return r=e.sent,e.next=11,this.$.earlyEndDateConstraintIntervals;case 11:return i=e.sent,e.abrupt("return",Boolean((null==t?void 0:t.length)||(null==n?void 0:n.length)||(null==r?void 0:r.length)||(null==i?void 0:i.length)));case 13:case"end":return e.stop()}}),e,this)}))},{key:"calculateStartDatePure",value:Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.direction;case 2:if(e.sent!==nS.Forward){e.next=26;break}return e.delegateYield(this.isConstrainedEarly(),"t2",5);case 5:if(e.t1=!e.t2,e.t1){e.next=10;break}return e.next=9,this.$.manuallyScheduled;case 9:e.t1=e.sent;case 10:if(e.t0=e.t1,e.t0){e.next=14;break}return e.delegateYield(this.hasSubEvents(),"t3",13);case 13:e.t0=e.t3;case 14:if(!e.t0){e.next=17;break}return e.delegateYield(t.calculateStartDatePure.call(this),"t4",16);case 16:return e.abrupt("return",e.t4);case 17:return e.next=19,this.$.earlyStartDate;case 19:if(e.t5=e.sent,e.t5){e.next=23;break}return e.delegateYield(t.calculateStartDatePure.call(this),"t6",22);case 22:e.t5=e.t6;case 23:return e.abrupt("return",e.t5);case 26:return e.delegateYield(t.calculateStartDatePure.call(this),"t7",27);case 27:return e.abrupt("return",e.t7);case 28:case"end":return e.stop()}}),e,this)}))},{key:"calculateStartDateProposed",value:Vr.a.mark((function e(){var n,r,i,o;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.direction;case 2:n=e.sent,e.t0=n,e.next=e.t0===nS.Forward?6:37;break;case 6:return e.delegateYield(this.isConstrainedEarly(),"t3",7);case 7:if(e.t2=!e.t3,e.t2){e.next=12;break}return e.next=11,this.$.manuallyScheduled;case 11:e.t2=e.sent;case 12:if(e.t1=e.t2,e.t1){e.next=16;break}return e.delegateYield(this.hasSubEvents(),"t4",15);case 15:e.t1=e.t4;case 16:if(!e.t1){e.next=19;break}return e.delegateYield(t.calculateStartDateProposed.call(this),"t5",18);case 18:return e.abrupt("return",e.t5);case 19:return e.next=21,this.$.earlyStartDate;case 21:if(!(r=e.sent)){e.next=35;break}if(!uS(r)){e.next=25;break}return e.abrupt("return",r);case 25:return e.delegateYield(t.calculateStartDateProposed.call(this),"t6",26);case 26:return i=e.t6,e.next=29,this.$.earlyEffectiveStartDateInterval;case 29:if(!(o=e.sent).containsDate(i)){e.next=32;break}return e.abrupt("return",i);case 32:return e.abrupt("return",uS(o.endDate)?o.endDate:i);case 35:return e.delegateYield(t.calculateStartDateProposed.call(this),"t7",36);case 36:return e.abrupt("return",e.t7);case 37:return e.delegateYield(t.calculateStartDateProposed.call(this),"t8",38);case 38:return e.abrupt("return",e.t8);case 39:case"end":return e.stop()}}),e,this)}))},{key:"calculateEndDatePure",value:Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.direction;case 2:if(e.sent!==nS.Forward){e.next=26;break}return e.delegateYield(this.isConstrainedEarly(),"t2",5);case 5:if(e.t1=!e.t2,e.t1){e.next=10;break}return e.next=9,this.$.manuallyScheduled;case 9:e.t1=e.sent;case 10:if(e.t0=e.t1,e.t0){e.next=14;break}return e.delegateYield(this.hasSubEvents(),"t3",13);case 13:e.t0=e.t3;case 14:if(!e.t0){e.next=17;break}return e.delegateYield(t.calculateEndDatePure.call(this),"t4",16);case 16:return e.abrupt("return",e.t4);case 17:return e.next=19,this.$.earlyEndDate;case 19:if(e.t5=e.sent,e.t5){e.next=23;break}return e.delegateYield(t.calculateEndDatePure.call(this),"t6",22);case 22:e.t5=e.t6;case 23:return e.abrupt("return",e.t5);case 26:return e.delegateYield(t.calculateEndDatePure.call(this),"t7",27);case 27:return e.abrupt("return",e.t7);case 28:case"end":return e.stop()}}),e,this)}))},{key:"calculateEndDateProposed",value:Vr.a.mark((function e(){var n,r,i,o;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.direction;case 2:n=e.sent,e.t0=n,e.next=e.t0===nS.Forward?6:37;break;case 6:return e.delegateYield(this.isConstrainedEarly(),"t3",7);case 7:if(e.t2=!e.t3,e.t2){e.next=12;break}return e.next=11,this.$.manuallyScheduled;case 11:e.t2=e.sent;case 12:if(e.t1=e.t2,e.t1){e.next=16;break}return e.delegateYield(this.hasSubEvents(),"t4",15);case 15:e.t1=e.t4;case 16:if(!e.t1){e.next=19;break}return e.delegateYield(t.calculateEndDateProposed.call(this),"t5",18);case 18:return e.abrupt("return",e.t5);case 19:return e.next=21,this.$.earlyEndDate;case 21:if(!(r=e.sent)){e.next=35;break}if(!uS(r)){e.next=25;break}return e.abrupt("return",r);case 25:return e.delegateYield(t.calculateEndDateProposed.call(this),"t6",26);case 26:return i=e.t6,e.next=29,this.$.earlyEffectiveEndDateInterval;case 29:if(!(o=e.sent).containsDate(i)){e.next=32;break}return e.abrupt("return",i);case 32:return e.abrupt("return",uS(o.endDate)?o.endDate:i);case 35:return e.delegateYield(t.calculateEndDateProposed.call(this),"t7",36);case 36:return e.abrupt("return",e.t7);case 37:return e.delegateYield(t.calculateEndDateProposed.call(this),"t8",38);case 38:return e.abrupt("return",e.t8);case 39:case"end":return e.stop()}}),e,this)}))},{key:"calculateDirection",value:Vr.a.mark((function e(){var t;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.getProject(),e.next=3,t.$.direction;case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}}),e,this)}))}]),r}(e);return WI([lw({lazy:!0})],n.prototype,"earlyStartDateRaw",void 0),WI([Vw({type:"date",persist:!1},{lazy:!0,converter:Gw,persistent:!1})],n.prototype,"earlyStartDate",void 0),WI([lw({lazy:!0})],n.prototype,"earlyEndDateRaw",void 0),WI([Vw({type:"date",persist:!1},{lazy:!0,converter:Gw,persistent:!1})],n.prototype,"earlyEndDate",void 0),WI([lw()],n.prototype,"startDateConstraintIntervals",void 0),WI([lw()],n.prototype,"endDateConstraintIntervals",void 0),WI([lw({lazy:!0})],n.prototype,"earlyStartDateConstraintIntervals",void 0),WI([lw({lazy:!0})],n.prototype,"earlyEndDateConstraintIntervals",void 0),WI([lw()],n.prototype,"earlyEffectiveStartDateInterval",void 0),WI([lw()],n.prototype,"earlyEffectiveEndDateInterval",void 0),WI([fw("startDateConstraintIntervals")],n.prototype,"calculateStartDateConstraintIntervals",null),WI([fw("endDateConstraintIntervals")],n.prototype,"calculateEndDateConstraintIntervals",null),WI([fw("earlyStartDateConstraintIntervals")],n.prototype,"calculateEarlyStartDateConstraintIntervals",null),WI([fw("earlyEndDateConstraintIntervals")],n.prototype,"calculateEarlyEndDateConstraintIntervals",null),WI([fw("earlyEffectiveStartDateInterval")],n.prototype,"calculateEarlyEffectiveStartDateInterval",null),WI([fw("earlyEffectiveEndDateInterval")],n.prototype,"calculateEarlyEffectiveEndDateInterval",null),WI([fw("earlyStartDateRaw")],n.prototype,"calculateEarlyStartDateRaw",null),WI([fw("earlyStartDate")],n.prototype,"calculateEarlyStartDate",null),WI([fw("earlyEndDateRaw")],n.prototype,"calculateEarlyEndDateRaw",null),WI([fw("earlyEndDate")],n.prototype,"calculateEarlyEndDate",null),WI([fw("direction")],n.prototype,"calculateDirection",null),n})));function qI(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var KI=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":l()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},XI=function(e){fe()(n,e);var t=qI(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([CM],(function(e){e.prototype;var t=function(e){fe()(n,e);var t=qI(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"hasSubEvents",value:Vr.a.mark((function e(){var t;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.childEvents;case 2:return t=e.sent,e.abrupt("return",t.size>0);case 4:case"end":return e.stop()}}),e,this)}))},{key:"subEventsIterable",value:Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.childEvents;case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))},{key:"parent",get:function(){return this._parent},set:function(e){this._parent=e,this.parentEvent=e}}]),n}(e);return KI([gw({bucket:"childEvents"})],t.prototype,"parentEvent",void 0),KI([Sw()],t.prototype,"childEvents",void 0),t})));function ZI(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var JI=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":l()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},QI=function(e){fe()(n,e);var t=ZI(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([UI,XI],(function(e){var t=e.prototype,n=function(e){fe()(i,e);var n,r=ZI(i);function i(){return v()(this,i),r.apply(this,arguments)}return g()(i,[{key:"writeStartDate",value:function(e,n,r,i){var o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4],a=this.getProject();if(n.graph.hasIdentifier(this.$.direction)&&(!a||!a.getStm().isRestoring)){var s=this.getStartDatePinConstraintType();s&&(this.constraintType=s,this.constraintDate=i)}return t.writeStartDate.call(this,e,n,r,i,o)}},{key:"writeEndDate",value:function(e,n,r,i){var o=arguments.length>4&&void 0!==arguments[4]&&arguments[4],a=this.getProject();if(n.graph.hasIdentifier(this.$.direction)&&o&&(!a||!a.getStm().isRestoring)){var s=this.getEndDatePinConstraintType();s&&(this.constraintType=s,this.constraintDate=i)}return t.writeEndDate.call(this,e,n,r,i,o)}},{key:"calculateConstraintType",value:Vr.a.mark((function e(){var t;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,vk;case 2:return t=e.sent,e.delegateYield(this.isConstraintTypeApplicable(t),"t0",4);case 4:if(e.t0){e.next=6;break}t=null;case 6:return e.abrupt("return",t);case 7:case"end":return e.stop()}}),e,this)}))},{key:"calculateConstraintDate",value:Vr.a.mark((function e(t){var n,r;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,vk;case 2:return n=e.sent,e.next=5,this.$.constraintType;case 5:return(r=e.sent)?n||(n=this.getConstraintTypeDefaultDate(t,r)):n=null,e.abrupt("return",n);case 8:case"end":return e.stop()}}),e,this)}))},{key:"getStartDatePinConstraintType",value:function(){var e=this.direction;if(!this.isTaskPinnableWithConstraint())return null;switch(e){case nS.Forward:return XC.StartNoEarlierThan;case nS.Backward:return XC.FinishNoLaterThan}}},{key:"getEndDatePinConstraintType",value:function(){var e=this.direction;if(!this.isTaskPinnableWithConstraint())return null;switch(e){case nS.Forward:return XC.FinishNoEarlierThan;case nS.Backward:return XC.FinishNoLaterThan}}},{key:"isTaskPinnableWithConstraint",value:function(){var e=this.manuallyScheduled,t=this.constraintType,n=!1;if(!e)if(t)switch(t){case XC.StartNoEarlierThan:case XC.StartNoLaterThan:case XC.FinishNoEarlierThan:case XC.FinishNoLaterThan:n=!0}else n=!0;return n}},{key:"getConstraintTypeDefaultDate",value:function(e,t){switch(t){case XC.StartNoEarlierThan:case XC.StartNoLaterThan:case XC.MustStartOn:return e(Fk(this.$.startDate));case XC.FinishNoEarlierThan:case XC.FinishNoLaterThan:case XC.MustFinishOn:return e(Fk(this.$.endDate))}return null}},{key:"isConstraintTypeApplicable",value:Vr.a.mark((function e(t){var n,r;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.childEvents;case 2:n=e.sent,r=n.size>0,e.t0=t,e.next=e.t0===XC.FinishNoEarlierThan||e.t0===XC.StartNoLaterThan||e.t0===XC.MustFinishOn||e.t0===XC.MustStartOn?7:8;break;case 7:return e.abrupt("return",!r);case 8:return e.abrupt("return",!0);case 9:case"end":return e.stop()}}),e,this)}))},{key:"setConstraint",value:(n=Wr()(Vr.a.mark((function e(t,n){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.constraintType=t,void 0!==n&&(this.constraintDate=n),e.abrupt("return",this.commitAsync());case 3:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"calculateEndDateConstraintIntervals",value:Vr.a.mark((function e(){var n,r,i;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(t.calculateEndDateConstraintIntervals.call(this),"t0",1);case 1:return n=e.t0,e.next=4,this.$.constraintType;case 4:return r=e.sent,e.next=7,this.$.constraintDate;case 7:if(i=e.sent,!r||!i){e.next=18;break}e.t1=r,e.next=e.t1===XC.MustFinishOn?12:e.t1===XC.FinishNoEarlierThan?14:e.t1===XC.FinishNoLaterThan?16:18;break;case 12:return n.unshift(BI.new({startDate:i,endDate:i})),e.abrupt("break",18);case 14:return n.unshift(BI.new({startDate:i})),e.abrupt("break",18);case 16:return n.unshift(BI.new({endDate:i})),e.abrupt("break",18);case 18:return e.abrupt("return",n);case 19:case"end":return e.stop()}}),e,this)}))},{key:"calculateStartDateConstraintIntervals",value:Vr.a.mark((function e(){var n,r,i;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(t.calculateStartDateConstraintIntervals.call(this),"t0",1);case 1:return n=e.t0,e.next=4,this.$.constraintType;case 4:return r=e.sent,e.next=7,this.$.constraintDate;case 7:if(i=e.sent,!r||!i){e.next=18;break}e.t1=r,e.next=e.t1===XC.MustStartOn?12:e.t1===XC.StartNoEarlierThan?14:e.t1===XC.StartNoLaterThan?16:18;break;case 12:return n.unshift(BI.new({startDate:i,endDate:i})),e.abrupt("break",18);case 14:return n.unshift(BI.new({startDate:i})),e.abrupt("break",18);case 16:return n.unshift(BI.new({endDate:i})),e.abrupt("break",18);case 18:return e.abrupt("return",n);case 19:case"end":return e.stop()}}),e,this)}))}]),i}(e);return JI([Vw({type:"string"},{sync:!0})],n.prototype,"constraintType",void 0),JI([Vw({type:"date"},{converter:Gw,sync:!0})],n.prototype,"constraintDate",void 0),JI([fw("constraintType")],n.prototype,"calculateConstraintType",null),JI([fw("constraintDate")],n.prototype,"calculateConstraintDate",null),n})));function eO(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return tO(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tO(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function tO(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function nO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var rO=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":l()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},iO=function(e){fe()(n,e);var t=nO(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([XI],(function(e){e.prototype;var t=function(e){fe()(n,e);var t=nO(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"calculatePercentDone",value:Vr.a.mark((function e(){var t,n,r,i;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.childEvents;case 2:return t=e.sent,n=this.getProject(),e.next=6,n.$.autoCalculatePercentDoneForParentTasks;case 6:if(r=e.sent,!t.size||!r){e.next=22;break}return e.next=10,this.$.percentDoneSummaryData;case 10:if(!((i=e.sent).totalDuration>0)){e.next=15;break}return e.abrupt("return",i.completedDuration/i.totalDuration);case 15:if(!(i.milestonesNum>0)){e.next=19;break}return e.abrupt("return",i.milestonesTotalPercentDone/i.milestonesNum);case 19:return e.abrupt("return",null);case 20:e.next=25;break;case 22:return e.next=24,vk;case 24:return e.abrupt("return",e.sent);case 25:case"end":return e.stop()}}),e,this)}))},{key:"calculatePercentDoneSummaryData",value:Vr.a.mark((function e(){var t,n,r,i,o,a,s,u,c;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.childEvents;case 2:if(!(t=e.sent).size){e.next=27;break}n={totalDuration:0,completedDuration:0,milestonesNum:0,milestonesTotalPercentDone:0},r=eO(t),e.prev=6,r.s();case 8:if((i=r.n()).done){e.next=16;break}return o=i.value,e.next=12,o.$.percentDoneSummaryData;case 12:(a=e.sent)&&(n.totalDuration+=a.totalDuration,n.completedDuration+=a.completedDuration,n.milestonesNum+=a.milestonesNum,n.milestonesTotalPercentDone+=a.milestonesTotalPercentDone);case 14:e.next=8;break;case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(6),r.e(e.t0);case 21:return e.prev=21,r.f(),e.finish(21);case 24:return e.abrupt("return",n);case 27:return e.next=29,this.$.duration;case 29:if("number"!=typeof(s=e.sent)){e.next=45;break}return e.t1=this.getProject(),e.t2=s,e.next=35,this.$.durationUnit;case 35:return e.t3=e.sent,e.t4=KC.Millisecond,e.delegateYield(e.t1.$convertDuration.call(e.t1,e.t2,e.t3,e.t4),"t5",38);case 38:return u=e.t5,e.next=41,this.$.percentDone;case 41:return c=e.sent,e.abrupt("return",{totalDuration:u,completedDuration:u*c,milestonesNum:0===u?1:0,milestonesTotalPercentDone:0===u?c:0});case 45:return e.abrupt("return",null);case 46:case"end":return e.stop()}}),e,this,[[6,18,21,24]])}))}]),n}(e);return rO([Vw({type:"number",defaultValue:0})],t.prototype,"percentDone",void 0),rO([lw()],t.prototype,"percentDoneSummaryData",void 0),rO([fw("percentDone")],t.prototype,"calculatePercentDone",null),rO([fw("percentDoneSummaryData")],t.prototype,"calculatePercentDoneSummaryData",null),t})));function oO(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return aO(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return aO(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function aO(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function sO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var uO=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":l()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},cO=function(e){fe()(n,e);var t=sO(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([UI,BR],(function(e){var t=e.prototype,n=function(e){fe()(r,e);var n=sO(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"calculateEarlyStartDateConstraintIntervals",value:Vr.a.mark((function e(){var n,r,i,o,a,s,u,c,l,f,d,h,v,p,g;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(t.calculateEarlyStartDateConstraintIntervals.call(this),"t0",1);case 1:return n=e.t0,r=this.getProject(),e.t1=oO,e.next=6,this.$.incomingDeps;case 6:e.t2=e.sent,i=(0,e.t1)(e.t2),e.prev=8,i.s();case 10:if((o=i.n()).done){e.next=70;break}return a=o.value,e.next=14,a.$.fromEvent;case 14:if(null!=(s=e.sent)&&!ek(s)){e.next=17;break}return e.abrupt("continue",68);case 17:return u=void 0,e.next=20,a.$.type;case 20:e.t3=e.sent,e.next=e.t3===QC.EndToStart?23:e.t3===QC.StartToStart?45:67;break;case 23:return e.next=25,s.$.earlyEndDateRaw;case 25:if(!(c=e.sent)){e.next=44;break}return e.next=29,a.$.lag;case 29:return l=e.sent,e.next=32,a.$.lagUnit;case 32:return f=e.sent,e.next=35,a.$.calendar;case 35:return d=e.sent,e.t4=BI,e.t5=d,e.t6=c,e.delegateYield(r.$convertDuration(l,f,KC.Millisecond),"t7",40);case 40:e.t8=e.t7,e.t9=e.t5.calculateEndDate.call(e.t5,e.t6,e.t8),e.t10={startDate:e.t9,endDate:null},u=e.t4.new.call(e.t4,e.t10);case 44:return e.abrupt("break",67);case 45:return e.next=47,s.$.earlyStartDateRaw;case 47:if(!(h=e.sent)){e.next=66;break}return e.next=51,a.$.lag;case 51:return v=e.sent,e.next=54,a.$.lagUnit;case 54:return p=e.sent,e.next=57,a.$.calendar;case 57:return g=e.sent,e.t11=BI,e.t12=g,e.t13=h,e.delegateYield(r.$convertDuration(v,p,KC.Millisecond),"t14",62);case 62:e.t15=e.t14,e.t16=e.t12.calculateEndDate.call(e.t12,e.t13,e.t15),e.t17={startDate:e.t16,endDate:null},u=e.t11.new.call(e.t11,e.t17);case 66:return e.abrupt("break",67);case 67:u&&n.unshift(u);case 68:e.next=10;break;case 70:e.next=75;break;case 72:e.prev=72,e.t18=e.catch(8),i.e(e.t18);case 75:return e.prev=75,i.f(),e.finish(75);case 78:return e.abrupt("return",n);case 79:case"end":return e.stop()}}),e,this,[[8,72,75,78]])}))},{key:"calculateEarlyEndDateConstraintIntervals",value:Vr.a.mark((function e(){var n,r,i,o,a,s,u,c,l,f,d,h,v,p,g;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(t.calculateEarlyEndDateConstraintIntervals.call(this),"t0",1);case 1:return n=e.t0,r=this.getProject(),e.t1=oO,e.next=6,this.$.incomingDeps;case 6:e.t2=e.sent,i=(0,e.t1)(e.t2),e.prev=8,i.s();case 10:if((o=i.n()).done){e.next=70;break}return a=o.value,e.next=14,a.$.fromEvent;case 14:if(null!=(s=e.sent)&&!ek(s)){e.next=17;break}return e.abrupt("continue",68);case 17:return u=void 0,e.next=20,a.$.type;case 20:e.t3=e.sent,e.next=e.t3===QC.EndToEnd?23:e.t3===QC.StartToEnd?45:67;break;case 23:return e.next=25,s.$.earlyEndDateRaw;case 25:if(!(c=e.sent)){e.next=44;break}return e.next=29,a.$.lag;case 29:return l=e.sent,e.next=32,a.$.lagUnit;case 32:return f=e.sent,e.next=35,a.$.calendar;case 35:return d=e.sent,e.t4=BI,e.t5=d,e.t6=c,e.delegateYield(r.$convertDuration(l,f,KC.Millisecond),"t7",40);case 40:e.t8=e.t7,e.t9=e.t5.calculateEndDate.call(e.t5,e.t6,e.t8),e.t10={startDate:e.t9,endDate:null},u=e.t4.new.call(e.t4,e.t10);case 44:return e.abrupt("break",67);case 45:return e.next=47,s.$.earlyStartDateRaw;case 47:if(!(h=e.sent)){e.next=66;break}return e.next=51,a.$.lag;case 51:return v=e.sent,e.next=54,a.$.lagUnit;case 54:return p=e.sent,e.next=57,a.$.calendar;case 57:return g=e.sent,e.t11=BI,e.t12=g,e.t13=h,e.delegateYield(r.$convertDuration(v,p,KC.Millisecond),"t14",62);case 62:e.t15=e.t14,e.t16=e.t12.calculateEndDate.call(e.t12,e.t13,e.t15),e.t17={startDate:e.t16,endDate:null},u=e.t11.new.call(e.t11,e.t17);case 66:return e.abrupt("break",67);case 67:u&&n.unshift(u);case 68:e.next=10;break;case 70:e.next=75;break;case 72:e.prev=72,e.t18=e.catch(8),i.e(e.t18);case 75:return e.prev=75,i.f(),e.finish(75);case 78:return e.abrupt("return",n);case 79:case"end":return e.stop()}}),e,this,[[8,72,75,78]])}))}]),r}(e);return uO([fw("earlyEndDateIntervals")],n.prototype,"calculateEarlyEndDateConstraintIntervals",null),n})));function lO(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return fO(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return fO(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function fO(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function dO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var hO=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":l()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},vO=function(e){fe()(n,e);var t=dO(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([LR],(function(e){var t=e.prototype,n=function(e){fe()(i,e);var n,r=dO(i);function i(){return v()(this,i),r.apply(this,arguments)}return g()(i,[{key:"assign",value:(n=Wr()(Vr.a.mark((function e(t){var n,r,i=arguments;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=i.length>1&&void 0!==i[1]?i[1]:100,!this.getAssignmentFor(t)){e.next=3;break}throw new Error("Resource can't be assigned twice to the same task");case 3:return r=this.getProject().assignmentStore.modelClass,this.addAssignment(new r({event:this,resource:t,units:n})),e.abrupt("return",this.commitAsync());case 6:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"forEachAvailabilityInterval",value:Vr.a.mark((function e(t,n){var r,i,o;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.effectiveCalendar;case 2:return r=e.sent,e.next=5,this.$.assignmentsByCalendar;case 5:return i=e.sent,e.next=8,this.$.effectiveCalendarsCombination;case 8:return o=e.sent,e.abrupt("return",o.forEachAvailabilityInterval(t,(function(e,o,a){var s=a.getCalendarsWorkStatus(),u=a.getCalendarsWorking();if(s.get(r)&&(t.ignoreResourceCalendars||u.some((function(e){return i.has(e)}))))return n(e,o,a)})));case 10:case"end":return e.stop()}}),e,this)}))},{key:"calculateEffectiveCalendarsCombination",value:Vr.a.mark((function e(){var t,n;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.assignmentsByCalendar;case 2:return t=e.sent,e.t0=[],e.t1=d()(t.keys()),e.next=7,this.$.effectiveCalendar;case 7:return e.t2=e.sent,e.t3=[e.t2],n=e.t0.concat.call(e.t0,e.t1,e.t3),e.abrupt("return",this.getProject().combineCalendars(n));case 11:case"end":return e.stop()}}),e,this)}))},{key:"calculateAssignmentsByCalendar",value:Vr.a.mark((function e(){var t,n,r,i,o,a,s,u;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.assigned;case 2:t=e.sent,n=new Map,r=lO(t),e.prev=5,r.s();case 7:if((i=r.n()).done){e.next=21;break}return o=i.value,e.next=11,o.$.resource;case 11:if(!(a=e.sent)){e.next=19;break}return e.next=15,a.$.effectiveCalendar;case 15:s=e.sent,(u=n.get(s))||(u=[],n.set(s,u)),u.push(o);case 19:e.next=7;break;case 21:e.next=26;break;case 23:e.prev=23,e.t0=e.catch(5),r.e(e.t0);case 26:return e.prev=26,r.f(),e.finish(26);case 29:return e.abrupt("return",n);case 30:case"end":return e.stop()}}),e,this,[[5,23,26,29]])}))},{key:"getBaseOptionsForDurationCalculations",value:Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{ignoreResourceCalendars:!1});case 1:case"end":return e.stop()}}),e)}))},{key:"skipNonWorkingTime",value:Vr.a.mark((function e(n){var r,i,o,a,s=arguments;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=!(s.length>1&&void 0!==s[1])||s[1],n){e.next=3;break}return e.abrupt("return",null);case 3:return e.next=5,this.$.assignmentsByCalendar;case 5:if(!(e.sent.size>0)){e.next=20;break}return e.t0=Object,e.delegateYield(this.getBaseOptionsForDurationCalculations(),"t1",9);case 9:return e.t2=e.t1,e.t3=r?{startDate:n,isForward:r}:{endDate:n,isForward:r},i=e.t0.assign.call(e.t0,e.t2,e.t3),e.delegateYield(this.forEachAvailabilityInterval(i,(function(e,t,n){return o=r?e:t,!1})),"t4",13);case 13:if((a=e.t4)!==cS.MaxRangeReached&&a!==cS.FullRangeIterated){e.next=17;break}return e.next=17,yk("Empty calendar");case 17:return e.abrupt("return",new Date(o));case 20:return e.delegateYield(t.skipNonWorkingTime.call(this,n,r),"t5",21);case 21:return e.abrupt("return",e.t5);case 22:case"end":return e.stop()}}),e,this)}))},{key:"calculateProjectedDuration",value:Vr.a.mark((function e(n,r,i){var o,a;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n&&r){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,this.$.assignmentsByCalendar;case 4:if(!(e.sent.size>0)){e.next=21;break}return e.t0=Object,e.delegateYield(this.getBaseOptionsForDurationCalculations(),"t1",8);case 8:return e.t2=e.t1,e.t3={startDate:n,endDate:r,isForward:!0},o=e.t0.assign.call(e.t0,e.t2,e.t3),a=0,e.delegateYield(this.forEachAvailabilityInterval(o,(function(e,t){a+=t.getTime()-e.getTime()})),"t4",13);case 13:if(i){e.next=17;break}return e.next=16,this.$.durationUnit;case 16:i=e.sent;case 17:return e.delegateYield(this.getProject().$convertDuration(a,KC.Millisecond,i),"t5",18);case 18:return e.abrupt("return",e.t5);case 21:return e.delegateYield(t.calculateProjectedDuration.call(this,n,r,i),"t6",22);case 22:return e.abrupt("return",e.t6);case 23:case"end":return e.stop()}}),e,this)}))},{key:"calculateProjectedXDateWithDuration",value:Vr.a.mark((function e(t){var n,r,i,o,a,s,u,c,l=arguments;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=!(l.length>1&&void 0!==l[1])||l[1],null!=(r=l.length>2?l[2]:void 0)&&!isNaN(r)&&null!=t){e.next=4;break}return e.abrupt("return",null);case 4:if(0!=r){e.next=6;break}return e.abrupt("return",t);case 6:return e.next=8,this.$.durationUnit;case 8:return i=e.sent,e.delegateYield(this.getProject().$convertDuration(r,i,KC.Millisecond),"t0",10);case 10:return o=e.t0,a=t.getTime(),s=o,e.next=15,this.$.effectiveCalendar;case 15:return u=e.sent,e.next=18,this.$.assignmentsByCalendar;case 18:if(!(e.sent.size>0)){e.next=29;break}return e.t1=Object,e.delegateYield(this.getBaseOptionsForDurationCalculations(),"t2",22);case 22:return e.t3=e.t2,e.t4=n?{startDate:t,isForward:n}:{endDate:t,isForward:n},c=e.t1.assign.call(e.t1,e.t3,e.t4),e.delegateYield(this.forEachAvailabilityInterval(c,(function(e,t,r){var i=e.getTime(),o=t.getTime(),u=o-i;if(u>=s)return a=n?i+s:o-s,!1;var c=e.getTimezoneOffset()-t.getTimezoneOffset();s-=u+60*c*1e3})),"t5",26);case 26:return e.abrupt("return",new Date(a));case 29:return e.abrupt("return",u.accumulateWorkingTime(t,o,n).finalDate);case 30:case"end":return e.stop()}}),e,this)}))}]),i}(e);return hO([lw()],n.prototype,"effectiveCalendarsCombination",void 0),hO([lw()],n.prototype,"assignmentsByCalendar",void 0),hO([fw("effectiveCalendarsCombination")],n.prototype,"calculateEffectiveCalendarsCombination",null),hO([fw("assignmentsByCalendar")],n.prototype,"calculateAssignmentsByCalendar",null),n})));function pO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var gO=function(e){fe()(n,e);var t=pO(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([$R,QI,iO,vO,UI,cO],(function(e){e.prototype;return function(e){fe()(n,e);var t=pO(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(e)})));function yO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var mO=function(e){fe()(n,e);var t=yO(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"$name",get:function(){return"EventModel"}},{key:"isProEventModel",get:function(){return!0}},{key:"fields",get:function(){return[{name:"showInTimeline",type:"boolean"},"note"]}}]),n}(gO.derive(Qy).mixin(WD,yI,qD,jI));function kO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}mO._$name="EventModel";var bO=function(e){fe()(n,e);var t=kO(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"defaultConfig",get:function(){return{modelClass:mO}}}]),n}(yI(cD(hD(sD(tx.derive(Uo))))));function wO(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return CO(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return CO(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function CO(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function SO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}bO._$name="EventStore";var DO=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":l()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},RO=function(e){fe()(n,e);var t=SO(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"fields",get:function(){return[{name:"isWorking",type:"boolean",defaultValue:!0}]}}]),n}(wS),xO=function(e){fe()(n,e);var t=SO(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"defaultConfig",get:function(){return{modelClass:RO}}}]),n}(SS),EO=function(e){fe()(n,e);var t=SO(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"intervalStoreClass",get:function(){return xO}}]),n}(FS);DO([Vw({type:"boolean",defaultValue:!1})],EO.prototype,"unspecifiedTimeIsWorking",void 0);var TO=function(e){fe()(n,e);var t=SO(n);function n(){var e;return v()(this,n),(e=t.apply(this,arguments)).assignments=null,e.effort=0,e.maxEffort=0,e.units=0,e.isOverallocated=!1,e.isUnderallocated=!1,e}return n}(qm),MO=function(e){fe()(n,e);var t=SO(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"calculateAllocation",value:Vr.a.mark((function e(){var t,n,r,i,o,a,s,u,c,l,f,h,v,p,g,y,m,k,b;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.next=3,this.ticks;case 3:return n=e.sent,e.next=6,this.$.resource;case 6:return r=e.sent,e.next=9,r.$.assigned;case 9:i=e.sent,o=new Map,a=[],s=wO(i),e.prev=13,s.s();case 15:if((u=s.n()).done){e.next=38;break}return c=u.value,e.next=19,c.$.event;case 19:return l=e.sent,e.next=22,c.$.units;case 22:if(!l){e.next=36;break}return e.next=25,l.$.startDate;case 25:return f=e.sent,e.next=28,l.$.endDate;case 28:return h=e.sent,a.push({startDate:f,endDate:h,assignment:c}),e.next=32,l.$.effectiveCalendar;case 32:v=e.sent,(p=o.get(v))||(p=[],o.set(v,p)),p.push(c);case 36:e.next=15;break;case 38:e.next=43;break;case 40:e.prev=40,e.t0=e.catch(13),s.e(e.t0);case 43:return e.prev=43,s.f(),e.finish(43);case 46:return g=new EO({intervals:a}),y=[n,g].concat(d()(o.keys())),m=new Map,n.intervalStore.forEach((function(e){var n=TO.new({tick:e,resource:r});m.set(e,n),t.push(n)})),e.delegateYield(r.forEachAvailabilityInterval({startDate:t[0].tick.startDate,endDate:t[t.length-1].tick.endDate,calendars:y},(function(e,t,r){var i=r.getCalendarsWorkStatus();if(i.get(n)){var o=r.intervalsByCalendar.get(n)[0],a=t.getTime()-e.getTime(),s=m.get(o),u=s.assignments||new Set;s.assignments||(k=0,b=0);var c,l=0;r.intervalsByCalendar.get(g).forEach((function(n){var r=n.assignment;if(r&&i.get(r.event.effectiveCalendar)){var o=Math.max(e.getTime(),r.event.startDate.getTime()),a=Math.min(t.getTime(),r.event.endDate.getTime());c=a-o,s.effort+=c*r.units/100,l+=r.units,u.add(r)}})),s.maxEffort+=a,l&&(c?(k+=c*l,b+=c,s.units=k/b):k||(s.units=l)),u.size&&(s.assignments=u,s.isOverallocated=s.isOverallocated||l>100,s.isUnderallocated=s.isUnderallocated||l<100)}})),"t1",51);case 51:return e.abrupt("return",t);case 52:case"end":return e.stop()}}),e,this,[[13,40,43,46]])}))}]),n}(aw.mix(qm));DO([lw()],MO.prototype,"resource",void 0),DO([lw()],MO.prototype,"allocation",void 0),DO([fw("allocation")],MO.prototype,"calculateAllocation",null);var AO=function(e){fe()(n,e);var t=SO(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([VS],(function(e){var t=e.prototype;return function(e){fe()(r,e);var n=SO(r);function r(){var e;return v()(this,r),(e=n.apply(this,arguments)).observers=new Set,e.entities=new Set,e}return g()(r,[{key:"leaveGraph",value:function(e){var n,r=this.graph,i=wO(this.entities);try{for(i.s();!(n=i.n()).done;){var o=n.value;r.removeEntity(o)}}catch(e){i.e(e)}finally{i.f()}var a,s=wO(this.observers);try{for(s.s();!(a=s.n()).done;){var u=a.value;r.removeIdentifier(u)}}catch(e){s.e(e)}finally{s.f()}t.leaveGraph.call(this,e)}},{key:"forEachAvailabilityInterval",value:Vr.a.mark((function e(t,n){var r,i;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.effectiveCalendar;case 2:return r=e.sent,i=this.getProject().combineCalendars([r].concat(t.calendars||[])),e.abrupt("return",i.forEachAvailabilityInterval(t,(function(e,t,i){if(i.getCalendarsWorkStatus().get(r))return n(e,t,i)})));case 5:case"end":return e.stop()}}),e,this)}))}]),r}(e)})));function PO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var IO=function(e){fe()(n,e);var t=PO(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"$name",get:function(){return"ResourceModel"}}]),n}(yI(rS(AO.derive(iv))));function OO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}IO._$name="ResourceModel";var FO=function(e){fe()(n,e);var t=OO(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"defaultConfig",get:function(){return{modelClass:IO}}}]),n}(yI(UC(XS.derive(Uo))));function LO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}FO._$name="ResourceStore";var jO=function(e){return function(e){fe()(r,e);var t,n=LO(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"construct",value:function(){for(var e,t=this,n=arguments.length,i=new Array(n),o=0;o<n;o++)i[o]=arguments[o];(e=we()(pe()(r.prototype),"construct",this)).call.apply(e,[this].concat(i)),t.addPrioritizedStore(t.calendarManagerStore),t.addPrioritizedStore(t.assignmentStore),t.addPrioritizedStore(t.dependencyStore),t.addPrioritizedStore(t.resourceStore),t.addPrioritizedStore(t.eventStore),t.timeRangeStore&&t.addPrioritizedStore(t.timeRangeStore),t.resourceTimeRangeStore&&t.addPrioritizedStore(t.resourceTimeRangeStore)}},{key:"adjustDeprecatedResponse",value:function(e){var t=null==e?void 0:e.project,n=null==t?void 0:t.calendar,r=this.deprecatedProjectCalendarProperties;return r&&n&&e.calendars&&function(){for(var i,o,a=(null===(i=e.calendars.rows)||void 0===i?void 0:i.slice())||[];o=a.shift();){if(o.id==n){r.forEach((function(e){!t[e]&&o[e]&&(t[e]=o[e])}));break}o.children&&a.push.apply(a,d()(o.children))}}(),e}},{key:"applyResponse",value:(t=Wr()(Vr.a.mark((function e(t,n,i){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.isDestroyed){e.next=3;break}return n=this.adjustDeprecatedResponse(n),e.abrupt("return",we()(pe()(r.prototype),"applyResponse",this).call(this,t,n,i));case 3:case"end":return e.stop()}}),e,this)}))),function(e,n,r){return t.apply(this,arguments)})},{key:"project",get:function(){return this},set:function(e){sc()(pe()(r.prototype),"project",e,this,!0)}}],[{key:"properties",get:function(){return{deprecatedProjectCalendarProperties:["hoursPerDay","daysPerWeek","daysPerMonth"]}}}]),r}((e||ue).mixin(Ky))};function _O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var BO=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":l()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},HO=function(e){fe()(n,e);var t=_O(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([RM,UI],(function(e){e.prototype;var t=function(e){fe()(a,e);var t,n,r,i,o=_O(a);function a(){return v()(this,a),o.apply(this,arguments)}return g()(a,[{key:"calculateDirection",value:Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,vk;case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))},{key:"getType",value:function(){return tS.SchedulerPro}},{key:"getDefaultEventModelClass",value:function(){return gO}},{key:"getDefaultDependencyModelClass",value:function(){return AI}},{key:"getDefaultAssignmentModelClass",value:function(){return vI}},{key:"getDefaultResourceModelClass",value:function(){return AO}},{key:"validateDependency",value:(i=Wr()(Vr.a.mark((function e(t,n,r,i){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!Pm(t.outgoingDeps).some((function(e){return e.toEvent===n&&i!==e}))){e.next=3;break}return e.abrupt("return",JC.DuplicatingDependency);case 3:return e.next=5,this.isDependencyCyclic(t,n,r,i);case 5:if(!e.sent){e.next=7;break}return e.abrupt("return",JC.CyclicDependency);case 7:return e.abrupt("return",JC.NoError);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r){return i.apply(this,arguments)})},{key:"isValidDependency",value:(r=Wr()(Vr.a.mark((function e(t,n,r,i){var o;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.validateDependency(t,n,r,i);case 2:return o=e.sent,e.abrupt("return",o===JC.NoError);case 4:case"end":return e.stop()}}),e,this)}))),function(e,t,n,i){return r.apply(this,arguments)})},{key:"isDependencyCyclic",value:(n=Wr()(Vr.a.mark((function e(t,n,r,i){var o,a,s;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=this.getDependencyStore().modelClass,a=new o({fromEvent:t,toEvent:n,type:r}),s=this.replica.branch({autoCommit:!1,onComputationCycle:"throw"}),i&&s.removeEntity(i),s.addEntity(a),e.prev=5,e.next=8,s.readAsync(t.$.startDate);case 8:return e.abrupt("return",!1);case 11:if(e.prev=11,e.t0=e.catch(5),!/cycle/i.test(e.t0)){e.next=15;break}return e.abrupt("return",!0);case 15:throw e.t0;case 16:case"end":return e.stop()}}),e,this,[[5,11]])}))),function(e,t,r,i){return n.apply(this,arguments)})},{key:"isValidExistingDependency",value:(t=Wr()(Vr.a.mark((function e(t){var n,r,i;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this.getDependencyStore().modelClass,r=new n({fromEvent:t.fromEvent,toEvent:t.toEvent,type:t.type}),e.next=4,this.replica.commitAsync();case 4:return(i=this.replica.branch({autoCommit:!1,onComputationCycle:"throw"})).removeEntity(t),i.addEntity(r),e.prev=7,e.next=10,i.readAsync(r.fromEvent.$.startDate);case 10:return e.abrupt("return",!0);case 13:if(e.prev=13,e.t0=e.catch(7),!/cycle/i.test(e.t0)){e.next=17;break}return e.abrupt("return",!1);case 17:throw e.t0;case 18:case"end":return e.stop()}}),e,this,[[7,13]])}))),function(e){return t.apply(this,arguments)})}]),a}(e);return BO([Vw({type:"string",defaultValue:eS.ToEvent})],t.prototype,"dependenciesCalendar",void 0),BO([Vw({type:"boolean",defaultValue:!0})],t.prototype,"autoCalculatePercentDoneForParentTasks",void 0),t})));function $O(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var NO=function(e){fe()(n,e);var t=$O(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"$name",get:function(){return"ProjectModel"}},{key:"defaultConfig",get:function(){return{calendarModelClass:RI,dependencyModelClass:II,eventModelClass:mO,assignmentModelClass:kI,resourceModelClass:IO,calendarManagerStoreClass:EI,dependencyStoreClass:FI,eventStoreClass:bO,assignmentStoreClass:wI,resourceStoreClass:FO}}}]),n}(jO(HO.derive(zT())));function VO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}NO._$name="ProjectModel";var zO=function(e){fe()(n,e);var t=VO(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(){var e=this;we()(pe()(n.prototype),"construct",this).apply(this,arguments);var t=this.sortable;this.sortable=function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return t.call.apply(t,[e].concat(r))}}},{key:"formatValue",value:function(e,t){var n="number"==typeof this.grid.durationDisplayPrecision?this.grid.durationDisplayPrecision:this.decimalPrecision,r=Math.pow(10,n);return Math.round(e*r)/r+" "+Zt.getLocalizedNameOfUnit(t,1!==e)}},{key:"canEdit",value:function(e){return e.isLeaf}},{key:"defaultRenderer",value:function(e){var t=e.record,n=e.isExport,r=t[this.field],i=l()(r),o="number"===i?r:r&&r.magnitude,a="number"===i?t[this.durationUnitField]:r&&r.unit;return"number"!=typeof o?n?"":null:this.formatValue(o,a)}},{key:"durationUnitField",get:function(){return"".concat(this.field,"Unit")}},{key:"defaultEditor",get:function(){return{type:"duration",name:this.field}}}],[{key:"$name",get:function(){return"DurationColumn"}},{key:"type",get:function(){return"duration"}},{key:"isGanttColumn",get:function(){return!0}},{key:"fields",get:function(){return[{name:"decimalPrecision",defaultValue:1}]}},{key:"defaults",get:function(){return{field:"fullDuration",text:"L{Duration}",min:0,step:1,instantUpdate:!0,filterType:"duration",sortable:function(e,t){return e[this.field]-t[this.field]}}}}]),n}(Gh);function WO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Th.registerColumnType(zO),zO._$name="DurationColumn";var GO=function(e){fe()(n,e);var t=WO(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"value",get:function(){var e=we()(pe()(n.prototype),"value",this);return this.store.getById(e)||e},set:function(e){sc()(pe()(n.prototype),"value",e,this,!0)}}],[{key:"$name",get:function(){return"ModelCombo"}},{key:"type",get:function(){return"modelcombo"}}]),n}(Xf);function YO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}GO.initClass(),GO._$name="ModelCombo";var UO=function(e){fe()(n,e);var t=YO(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"value",get:function(){return we()(pe()(n.prototype),"value",this)},set:function(e){e&&e.isDefault&&e.isDefault()&&(e=null),sc()(pe()(n.prototype),"value",e,this,!0)}}],[{key:"$name",get:function(){return"CalendarField"}},{key:"type",get:function(){return"calendarfield"}},{key:"defaultConfig",get:function(){var e=this;return{valueField:"id",displayField:"name",editable:!1,store:null,listItemTpl:function(t){return t.name||e.L("L{Default calendar}")},displayValueRenderer:function(t){return t?t.name:e.L("L{Default calendar}")}}}}]),n}(GO);function qO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}UO.initClass(),UO._$name="CalendarField";var KO=function(e){fe()(n,e);var t=qO(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"attachToProject",value:function(e){e&&(this.defaultCalendar=e.defaultCalendar,this.editor.store=e.calendarManagerStore)}},{key:"attachToResourceStore",value:function(e){we()(pe()(n.prototype),"attachToResourceStore",this).call(this,e),e&&e.on({name:"resourceStore",update:"onResourceUpdate",thisObj:this})}},{key:"onResourceUpdate",value:function(e){var t=e.record,n=e.changes[this.field];if(n){if("string"==typeof n.oldValue&&n.value.id===n.oldValue)return;this.refreshCell(t)}}},{key:"renderer",value:function(e){var t=e.value;if(t===this.defaultCalendar)return"";if(t&&t.id){var n=this.editor.store.getById(t.id);return n&&n[this.editor.displayField]||""}return""}}],[{key:"$name",get:function(){return"ResourceCalendarColumn"}},{key:"type",get:function(){return"resourceCalendar"}},{key:"defaults",get:function(){return{field:"calendar",text:"Calendar",editor:{type:UO.type,clearable:!0,allowInvalid:!1}}}}]),n}(Dh.mixin(rA));function XO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Th.registerColumnType(KO),KO._$name="ResourceCalendarColumn";var ZO=function(e){return function(e){fe()(r,e);var t,n=XO(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"captureStm",value:function(){var e=this,t=e.project.getStm();e.stmInitiallyDisabled=t.disabled,e.stmInitiallyAutoRecord=t.autoRecord,e.stmInitiallyDisabled?(t.enable(),t.autoRecord=!1):(e.stmInitiallyAutoRecord&&(t.autoRecord=!1),t.isRecording&&t.stopTransaction())}},{key:"startStmTransaction",value:function(){this.project.getStm().startTransaction()}},{key:"commitStmTransaction",value:function(){var e=this.project.getStm();e.stopTransaction(),this.stmInitiallyDisabled&&e.resetQueue()}},{key:"rejectStmTransaction",value:(t=Wr()(Vr.a.mark((function e(){var t,n;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=this.project.getStm(),n=this.client,!t.transaction.length){e.next=10;break}return n.suspendRefresh(),t.forEachStore((function(e){return e.beginBatch()})),t.rejectTransaction(),t.forEachStore((function(e){return e.endBatch()})),e.next=8,n.resumeRefresh(!0);case 8:e.next=11;break;case 10:t.stopTransaction();case 11:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"enableStm",value:function(){this.project.getStm().enable()}},{key:"disableStm",value:function(){this.project.getStm().disable()}},{key:"freeStm",value:function(){var e=this.project.getStm();e.disabled=this.stmInitiallyDisabled,e.autoRecord=this.stmInitiallyAutoRecord}}],[{key:"$name",get:function(){return"TaskEditStm"}}]),r}(e||ue)};function JO(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var QO=function(e){fe()(n,e);var t=JO(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"updateLocalization",value:function(){we()(pe()(n.prototype),"updateLocalization",this).call(this),this.store.data=this.buildStoreData()}},{key:"buildStoreData",value:function(){var e=this;return[{id:"none",text:e.L("L{none}")},{id:"muststarton",text:e.L("L{muststarton}")},{id:"mustfinishon",text:e.L("L{mustfinishon}")},{id:"startnoearlierthan",text:e.L("L{startnoearlierthan}")},{id:"startnolaterthan",text:e.L("L{startnolaterthan}")},{id:"finishnoearlierthan",text:e.L("L{finishnoearlierthan}")},{id:"finishnolaterthan",text:e.L("L{finishnolaterthan}")}]}},{key:"value",set:function(e){sc()(pe()(n.prototype),"value",e,this,!0)},get:function(){var e=we()(pe()(n.prototype),"value",this);return"none"===e?null:e}},{key:"store",get:function(){return this._store||(this.store=new No({data:this.buildStoreData(),allowNullId:!0})),this._store},set:function(e){sc()(pe()(n.prototype),"store",e,this,!0)}}],[{key:"$name",get:function(){return"ConstraintTypePicker"}},{key:"type",get:function(){return"constrainttypepicker"}},{key:"configurable",get:function(){return{valueField:"id"}}}]),n}(Xf);function eF(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}QO.initClass(),QO._$name="ConstraintTypePicker";var tF=function(e){return e.map((function(e,t){return[t,e]}))},nF=function(e){fe()(n,e);var t=eF(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e){var t=this;we()(pe()(n.prototype),"construct",this).call(this,e),rt.on({locale:function(){t.items=tF(t.L("L{DependencyType.long}"))},thisObj:this})}},{key:"store",get:function(){return this._items||(this.items=this._items=tF(this.L("L{DependencyType.long}"))),we()(pe()(n.prototype),"store",this)},set:function(e){sc()(pe()(n.prototype),"store",e,this,!0)}}],[{key:"$name",get:function(){return"DependencyTypePicker"}},{key:"type",get:function(){return"dependencytypepicker"}}]),n}(Xf);function rF(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}nF.initClass(),nF._$name="DependencyTypePicker";var iF=function(e){fe()(n,e);var t=rF(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"$name",get:function(){return"EffortField"}},{key:"type",get:function(){return"effort"}},{key:"alias",get:function(){return"effortfield"}}]),n}(Rd);function oF(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}iF.initClass(),iF._$name="EffortField";var aF=function(e){fe()(n,e);var t=oF(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"transformTimeValue",value:function(e){var t=this.calendarProvider;if(t){var r=Zt.clearTime(e),i=Zt.add(r,1,"day"),o=t.run("skipNonWorkingTime",i,!1);if(Zt.isValidDate(o)&&Zt.isEqual(o,r,"day"))return Zt.copyTimeValues(r,o)}return we()(pe()(n.prototype),"transformTimeValue",this).call(this,e)}},{key:"calendarProvider",get:function(){return this.eventRecord||this.project}},{key:"backShiftDate",get:function(){var e=this,t=e.calendarProvider.run("skipWorkingTime",e.value,!1,e._step.magnitude,e._step.unit);return t=t&&e.calendarProvider.run("skipNonWorkingTime",t,!1)}},{key:"forwardShiftDate",get:function(){return this.calendarProvider.run("skipWorkingTime",this.value,!0,this._step.magnitude,this._step.unit)}}],[{key:"$name",get:function(){return"EndDateField"}},{key:"type",get:function(){return"enddatefield"}},{key:"alias",get:function(){return"enddate"}},{key:"defaultConfig",get:function(){return{project:null,eventRecord:null}}}]),n}(pd);function sF(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}aF.initClass(),aF._$name="EndDateField";var uF=function(e){return function(e){fe()(n,e);var t=sF(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"requestReadyStateChange",value:function(){this.trigger("readystatechange",{canSave:this.canSave})}},{key:"isReadyStatePropagator",get:function(){return!0}},{key:"canSave",get:function(){return!0}},{key:"widgetClass",get:function(){}}]),n}(e||Ge(ue))},cF=tt.mergeLocales(MT,{ConstraintTypePicker:{none:"None",muststarton:"Must start on",mustfinishon:"Must finish on",startnoearlierthan:"Start no earlier than",startnolaterthan:"Start no later than",finishnoearlierthan:"Finish no earlier than",finishnolaterthan:"Finish no later than"},CalendarField:{"Default calendar":"Default calendar"},TaskEditorBase:{Information:"Information",Save:"Save",Cancel:"Cancel",Delete:"Delete",calculateMask:"Calculating...",saveError:"Can't save, please correct errors first"},TaskEdit:{"Edit task":"Edit task",ConfirmDeletionTitle:"Confirm deletion",ConfirmDeletionMessage:"Are you sure you want to delete the event?"},TaskEditor:{editorWidth:"34em"},SchedulerTaskEditor:{editorWidth:"32em"},SchedulerGeneralTab:{labelWidth:"6em",General:"General",Name:"Name",Resources:"Resources","% complete":"% complete",Duration:"Duration",Start:"Start",Finish:"Finish"},GeneralTab:{labelWidth:"6.5em",General:"General",Name:"Name","% complete":"% complete",Duration:"Duration",Start:"Start",Finish:"Finish",Effort:"Effort",Dates:"Dates"},SchedulerAdvancedTab:{labelWidth:"13em",Calendar:"Calendar",Advanced:"Advanced","Manually scheduled":"Manually scheduled","Constraint type":"Constraint type","Constraint date":"Constraint date"},AdvancedTab:{labelWidth:"11.5em",Advanced:"Advanced",Calendar:"Calendar","Scheduling mode":"Scheduling mode","Effort driven":"Effort driven","Manually scheduled":"Manually scheduled","Constraint type":"Constraint type","Constraint date":"Constraint date",Constraint:"Constraint",Rollup:"Rollup"},DependencyTab:{Predecessors:"Predecessors",Successors:"Successors",ID:"ID",Name:"Name",Type:"Type",Lag:"Lag",cyclicDependency:"Cyclic dependency has been detected",invalidDependency:"Invalid dependency"},NotesTab:{Notes:"Notes"},ResourcesTab:{unitsTpl:function(e){var t=e.value;return"".concat(t,"%")},Resources:"Resources",Resource:"Resource",Units:"Units"},SchedulingModePicker:{Normal:"Normal","Fixed Duration":"Fixed Duration","Fixed Units":"Fixed Units","Fixed Effort":"Fixed Effort"},ResourceHistogram:{barTipInRange:"<b>{resource}</b> {startDate} - {endDate}<br>{allocated} of {available} allocated",barTipOnDate:"<b>{resource}</b> on {startDate}<br>{allocated} of {available} allocated"},DurationColumn:{Duration:"Duration"}}),lF=cF;function fF(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}rt.registerLocale("En",{desc:"English",locale:cF});var dF=function(e){fe()(r,e);var t,n=fF(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"processWidgetConfig",value:function(e){var t;if((null===(t=e.type)||void 0===t?void 0:t.includes("date"))&&null==e.weekStartDay&&(e.weekStartDay=this.weekStartDay),"deleteButton"===e.ref&&!this.showDeleteButton)return!1;if("tabs"===e.ref&&this.extraItems){var n={};for(var r in this.extraItems){n[r.replace("tab","Tab")]={items:Array.isArray(this.extraItems[r])?an.transformArrayToNamedObject(this.extraItems[r]):this.extraItems[r]}}an.merge(e.items,n)}return e}},{key:"changeItems",value:function(e){var t=this.tabsConfig,n=this.tabPanelItems,i=void 0===n?{}:n,o=an.clone(e),a=o.find((function(e){return"tabs"===e.ref}));if(t)for(var s in t){i[s.replace("tab","Tab")]=t[s]}return an.merge(a.items,i),we()(pe()(r.prototype),"changeItems",this).call(this,o)}},{key:"afterConfigure",value:function(){var e=this,t=this,n=t.widgetMap,r=t.bbar&&t.bbar.widgetMap||{},i=r.cancelButton,o=r.deleteButton,a=r.saveButton;null==a||a.on("click",t.onSaveClick,t),null==i||i.on("click",t.onCancelClick,t),null==o||o.on("click",t.onDeleteClick,t),Object.values(n).forEach((function(n){n.isDurationField?n.decimalPrecision=e.durationDisplayPrecision:"startDate"===n.ref||"endDate"===n.ref?n.project=e.project:"predecessorsTab"!==n.ref&&"successorsTab"!==n.ref||(n.grid.durationDisplayPrecision=e.durationDisplayPrecision),n.isReadyStatePropagator&&n.on("readystatechange",t.onReadyStateChange,t)})),n.tabs.on({beforeActiveItemChange:"onBeforeTabChange",thisObj:t})}},{key:"hide",value:(t=Wr()(Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this.detachListeners("project"),this.detachListeners("eventStore"),this._delayedAction=null,this.trigger("cancel"),e.abrupt("return",we()(pe()(r.prototype),"hide",this).call(this));case 5:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"loadEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.loadedRecord=e,this.callWidgetHook("loadEvent",e,t),this.detachListeners("project"),e.project.on({name:"project",beforeCommit:"onProjectBeforeCommit",dataReady:"onProjectDataReady",thisObj:this}),this.detachListeners("eventStore"),e.project.eventStore.on({name:"eventStore",remove:"onTaskRemove",thisObj:this})}},{key:"callWidgetHook",value:function(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];this.eachWidget((function(t){"function"==typeof t[e]&&t[e].apply(t,n)}))}},{key:"onBeforeTabChange",value:function(e){var t=e.source,n=e.prevActiveItem,r=this.widgetMap.generalTab;n===r&&t.eachWidget((function(e){e!==r&&(e.height=r.element.getBoundingClientRect().height)}),!1)}},{key:"onDocumentMouseDown",value:function(e){var t=this,n=null;if(Object.values(t.widgetMap).some((function(e){return e._activeCellEdit}))){var i=e.event,o=t.widgetMap,a=o.saveButton,s=o.cancelButton,u=o.deleteButton,c=i.target.closest("button");if(c)switch(c){case a&&a.element:n=t.onSaveClick;break;case s&&s.element:n=t.onCancelClick;break;case u&&u.element:n=t.onDeleteClick}}t._delayedAction=n,we()(pe()(r.prototype),"onDocumentMouseDown",this).call(this,e)}},{key:"onSaveClick",value:function(){this._delayedAction=null,this.canSave?this.trigger("save"):cc.show({html:this.L("L{saveError}")})}},{key:"onCancelClick",value:function(){this.hide()}},{key:"onDeleteClick",value:function(){this._delayedAction=null,this.trigger("delete")}},{key:"onPropagationRequested",value:function(){this.trigger("requestPropagation")}},{key:"onReadyStateChange",value:function(e){var t=e.source,n=e.canSave;this.requestReadyStateChange(),t.couldSaveTitle||(t.couldSaveTitle=t.title),t.parent===this.widgetMap.tabs&&(n?(t.titleElement.classList.remove("b-invalid"),t.title=t.couldSaveTitle,t.couldSaveTitle=null):(t.titleElement.classList.add("b-invalid"),t.title="<span class='b-icon b-icon-warning'></span>".concat(t.couldSaveTitle)))}},{key:"onTaskRemove",value:function(){this.afterDelete()}},{key:"onProjectBeforeCommit",value:function(){this.calculateMask&&this.mask({text:this.calculateMask,showDelay:this.calculateMaskDelay})}},{key:"onProjectDataReady",value:function(e){var t=e.records;this.calculateMask&&this.unmask(),t.has(this.loadedRecord)&&this.callWidgetHook("afterProjectChange"),this._delayedAction&&this._delayedAction()}},{key:"beforeSave",value:function(){this.callWidgetHook("beforeSave")}},{key:"afterSave",value:function(){this.callWidgetHook("afterSave")}},{key:"beforeCancel",value:function(){this.callWidgetHook("beforeCancel")}},{key:"afterCancel",value:function(){this.callWidgetHook("afterCancel")}},{key:"beforeDelete",value:function(){this.callWidgetHook("beforeDelete")}},{key:"afterDelete",value:function(){this.callWidgetHook("afterDelete")}},{key:"onInternalKeyDown",value:function(e){if("Enter"===e.key&&this.saveAndCloseOnEnter&&"input"===e.target.tagName.toLowerCase()){if(e.target.matches("input")){var t=oc.fromElement(e.target);(null==t?void 0:t.internalOnChange)&&t.internalOnChange()}e.preventDefault(),this.onSaveClick()}we()(pe()(r.prototype),"onInternalKeyDown",this).call(this,e)}},{key:"updateReadOnly",value:function(e){var t=this.widgetMap,n=t.deleteButton,i=t.saveButton,o=t.cancelButton,a=t.tabs.items;we()(pe()(r.prototype),"updateReadOnly",this).call(this,e),n&&(n.hidden=e),i&&(i.hidden=e),o&&(o.hidden=e);for(var s=0,u=a.length;s<u;s++)a[s].readOnly=e}},{key:"canSave",get:function(){var e=!0;return Object.values(this.widgetMap).forEach((function(t){t.isReadyStatePropagator&&(e=e&&t.canSave)})),e}},{key:"canCancel",get:function(){var e=!0;return Object.values(this.widgetMap).forEach((function(t){t.isReadyStatePropagator&&(e=e&&t.canCancel)})),e}}],[{key:"$name",get:function(){return"TaskEditorBase"}},{key:"configurable",get:function(){return{localizableProperties:["width"],width:{$config:{localeKey:"L{editorWidth}"}}}}},{key:"defaultConfig",get:function(){return{title:"L{Information}",cls:"b-schedulerpro-taskeditor",closable:!0,draggable:{handleSelector:":not(button,.b-field-inner)"},axisLock:"flexible",autoClose:!0,onChange:null,onCancel:null,onSave:null,autoShow:!1,scrollAction:"realign",items:null,bbar:{hideWhenEmpty:!0,defaults:{localeClass:this},items:{saveButton:{text:"L{Save}",color:"b-green",weight:100},deleteButton:{text:"L{Delete}",color:"b-gray",weight:200},cancelButton:{text:"L{Object.Cancel}",color:"b-gray",weight:300}}},durationDisplayPrecision:1,extraItems:null,tabsConfig:null,tabPanelItems:null,defaultTabs:null,calculateMask:null,calculateMaskDelay:100,localizableProperties:["calculateMask"],project:null}}}]),r}(uF(zl));function hF(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}dF.initClass(),dF._$name="TaskEditorBase";var vF=function(e){return function(e){fe()(n,e);var t=hF(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"loadEvent",value:function(e,t){this.setRecord(e,t)}},{key:"resetData",value:function(){this.record=null}},{key:"beforeSave",value:function(){}},{key:"afterSave",value:function(){this.resetData()}},{key:"beforeCancel",value:function(){}},{key:"afterCancel",value:function(){this.resetData()}},{key:"beforeDelete",value:function(){}},{key:"afterDelete",value:function(){this.resetData()}},{key:"project",get:function(){var e;return null===(e=this.record)||void 0===e?void 0:e.project}},{key:"widgetClass",get:function(){}}]),n}(e||Rl)};function pF(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var gF=function(e){fe()(n,e);var t=pF(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"$name",get:function(){return"EditorTab"}},{key:"type",get:function(){return"editortab"}}]),n}(uF(vF(Rl)));function yF(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}gF._$name="EditorTab";var mF=function(e){fe()(n,e);var t=yF(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"onFieldChange",value:function(e){var t=e.source,r=e.valid,i=e.userAction;i&&(r=void 0!==r?r:"function"==typeof t.isValid?t.isValid():t.isValid)&&we()(pe()(n.prototype),"onFieldChange",this).apply(this,arguments)}}],[{key:"$name",get:function(){return"FormTab"}},{key:"type",get:function(){return"formtab"}},{key:"defaultConfig",get:function(){return{layoutStyle:{flexFlow:"row wrap",alignItems:"flex-start",alignContent:"flex-start"},autoUpdateRecord:!0}}}]),n}(gF);function kF(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}mF.initClass(),mF._$name="FormTab";var bF=function(e){fe()(n,e);var t=kF(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"transformTimeValue",value:function(e){var t=this.calendarProvider;if(t){var r=Zt.clearTime(e),i=t.run("skipNonWorkingTime",r);if(Zt.isValidDate(i)&&Zt.isEqual(i,r,"day"))return Zt.copyTimeValues(r,i)}return we()(pe()(n.prototype),"transformTimeValue",this).call(this,e)}},{key:"calendarProvider",get:function(){return this.eventRecord||this.project}},{key:"backShiftDate",get:function(){return this.calendarProvider.run("skipWorkingTime",this.value,!1,this._step.magnitude,this._step.unit)}},{key:"forwardShiftDate",get:function(){var e=this,t=e.calendarProvider.run("skipWorkingTime",e.value,!0,e._step.magnitude,e._step.unit);return t=t&&e.calendarProvider.run("skipNonWorkingTime",t,!0)}}],[{key:"$name",get:function(){return"StartDateField"}},{key:"type",get:function(){return"startdatefield"}},{key:"alias",get:function(){return"startdate"}},{key:"defaultConfig",get:function(){return{project:null,eventRecord:null}}}]),n}(pd);function wF(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}bF.initClass(),bF._$name="StartDateField";var CF=function(e){fe()(n,e);var t=wF(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"loadEvent",value:function(e){var t={unit:e.durationUnit,magnitude:1},r=e.isParent,i=this.widgetMap,o=i.duration,a=i.percentDone,s=i.startDate,u=i.endDate,c=i.effort;o&&(o.disabled=r),a&&(a.disabled=r),s&&(s.step=t,s.eventRecord=e),u&&(u.step=t,u.eventRecord=e,u.disabled=r),c&&(c.unit=e.effortUnit,c.disabled=r),we()(pe()(n.prototype),"loadEvent",this).call(this,e)}}],[{key:"$name",get:function(){return"GeneralTab"}},{key:"type",get:function(){return"generaltab"}},{key:"defaultConfig",get:function(){return{title:"L{General}",cls:"b-general-tab",defaults:{localeClass:this},items:{name:{type:"text",weight:100,required:!0,label:"L{Name}",clearable:!0,name:"name",cls:"b-name"},percentDone:{type:"number",weight:200,label:"L{% complete}",name:"renderedPercentDone",cls:"b-percent-done b-inline",flex:"1 0 50%",min:0,max:100},effort:{type:"effort",weight:300,label:"L{Effort}",name:"fullEffort",flex:"1 0 50%"},divider:{html:"",weight:400,dataset:{text:this.L("L{Dates}")},cls:"b-divider",flex:"1 0 100%"},startDate:{type:"startdate",weight:500,label:"L{Start}",name:"startDate",cls:"b-start-date b-inline",flex:"1 0 50%"},endDate:{type:"enddate",weight:600,label:"L{Finish}",name:"endDate",cls:"b-end-date",flex:"1 0 50%"},duration:{type:"durationfield",weight:700,label:"L{Duration}",name:"fullDuration",flex:".5 0",cls:"b-inline"}}}}}]),n}(mF);function SF(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}CF.initClass(),CF._$name="GeneralTab";var DF=function(e,t){e.instanceMeta(t).valid=!0},RF=function(e,t){e.instanceMeta(t).valid=!1},xF=function(e,t){return!1!==e.instanceMeta(t).valid},EF=function(e){fe()(o,e);var t,n,r,i=SF(o);function o(){return v()(this,o),i.apply(this,arguments)}return g()(o,[{key:"finalizeLinkedTaskCellEdit",value:(r=Wr()(Vr.a.mark((function e(t){var n,r,i,o,a;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.grid,r=t.value,i=t.record,o=n.store.masterStore.project,e.next=4,o.validateDependency(r,i.toEvent,i.type,i);case 4:a=e.sent,e.t0=a,e.next=0===e.t0?8:1===e.t0?9:10;break;case 8:return e.abrupt("return",!0);case 9:return e.abrupt("return","L{DependencyTab.cyclicDependency}");case 10:return e.abrupt("return","L{DependencyTab.invalidDependency}");case 11:case"end":return e.stop()}}),e)}))),function(e){return r.apply(this,arguments)})},{key:"afterConstruct",value:function(){we()(pe()(o.prototype),"afterConstruct",this).call(this);var e=this,t=e.addButton=e.widgetMap.add,n=e.removeButton=e.widgetMap.remove,r=e.grid=e.widgetMap.grid;t&&t.on("click",e.onAddClick,e),n&&n.on("click",e.onRemoveClick,e),r.on({selectionChange:"onGridSelectionChange",startCellEdit:"onGridStartCellEdit",finishCellEdit:"onGridFinishCellEdit",cancelCellEdit:"onGridCancelCellEdit",thisObj:e})}},{key:"updateReadOnly",value:function(e){var t=this.widgetMap,n=t.add,r=t.remove;we()(pe()(o.prototype),"updateReadOnly",this).apply(this,arguments),n.hidden=r.hidden=e}},{key:"loadEvent",value:function(e){var t=this,n=t.grid,r=!n.store.isChained,i=!r&&e!==t.record;we()(pe()(o.prototype),"loadEvent",this).call(this,e);var a=t.taskCombo,s=t.project,u=s.dependencyStore,c=s.eventStore;r?(t.depStoreGeneration=u.storage.generation,t.eventStoreGeneration=c.storage.generation,n.store=u.makeChained((function(e){return e[t.negDirection]===t.record}),null),a.store=c.makeChained((function(e){return e!==t.record}),null,{doRelayToMaster:[],excludeCollapsedRecords:!1}),a.store.filterBy((function(e){return!n.store.find((function(n){return n[t.direction]===e}))})),a.on({thisObj:t,change:"onGridCellEditChange"})):((i||u.storage.generation!==t.depStoreGeneration)&&(n.store.fillFromMaster(),t.depStoreGeneration=u.storage.generation),(i||c.storage.generation!==t.eventStoreGeneration)&&(a.store.fillFromMaster(),t.eventStoreGeneration=c.storage.generation)),t.requestReadyStateChange()}},{key:"insertNewDependency",value:(n=Wr()(Vr.a.mark((function e(){var t,n,r,i,o,a,s;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(t=this).grid,r=n.store,i=t.project.dependencyStore,o=r.insert(0,ke()({type:QC.EndToStart,lag:0,lagUnit:KC.Day},t.negDirection,t.record)),a=ye()(o,1),s=a[0],t.depStoreGeneration=i.storage.generation,n.features.cellEdit.startEditing({field:t.direction,id:s.id}),RF(s,n),e.abrupt("return",s);case 6:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"onAddClick",value:function(){this.insertNewDependency()}},{key:"onRemoveClick",value:function(){var e=this,t=e.grid.selectedRecords;e.project.dependencyStore.remove(t),e.grid.selectedRecords=null,e.taskCombo.store.fillFromMaster(),e.removeButton.disable()}},{key:"onGridSelectionChange",value:function(e){var t=e.selection;t&&t.length&&!this.up((function(e){return e.readOnly}))?this.removeButton.enable():this.removeButton.disable()}},{key:"clearActiveEditorErrors",value:function(){var e=this._activeCellEdit;e&&e.column.field===this.direction&&e.editor.inputField.clearError()}},{key:"onGridCellEditChange",value:function(){this.clearActiveEditorErrors()}},{key:"onGridStartCellEdit",value:function(e){var t=e.editorContext,n=this,r=n._editingDependency=t.record,i=n.grid,o=n.direction;n._activeCellEdit=t,t.column.field===o&&(xF(r,i)?n.clearActiveEditorErrors():r[o]?t.editor.inputField.setError("L{DependencyTab.cyclicDependency}"):t.editor.inputField.setError("L{DependencyTab.invalidDependency}"))}},{key:"onGridFinishCellEdit",value:(t=Wr()(Vr.a.mark((function e(t){var n,r,i,o,a,s;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.editorContext,r=this,i=n.record,o=n.column,a=r.grid,s=r.direction,o.field===s?(DF(i,a),r.taskCombo.store.fillFromMaster()):r.redrawDependencyRow(i),r._activeCellEdit=r._editingDependency=null,r.requestReadyStateChange();case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"afterCancel",value:function(){this._activeCellEdit&&this.grid.features.cellEdit.cancelEditing()}},{key:"onGridCancelCellEdit",value:function(e){var t=this,n=t._editingDependency;n&&(n[t.direction]||(RF(n,t.grid),t.redrawDependencyRow(n)),t._activeCellEdit=t._editingDependency=null),t.requestReadyStateChange()}},{key:"redrawDependencyRow",value:function(e){var t=this.grid,n=t.rowManager.getRowById(e);n&&(t.store.indexOf(e)>=0&&n.render(t.store.indexOf(e),e))}},{key:"taskCombo",get:function(){var e=this.grid,t=e&&e.columns.get(this.direction);return t&&t.editor}},{key:"canSave",get:function(){var e=this.grid;return e.store.reduce((function(t,n){return t&&xF(n,e)}),!0)}}],[{key:"makeDefaultConfig",value:function(e){return{direction:e,negDirection:"fromEvent"===e?"toEvent":"fromEvent",title:"fromEvent"===e?"L{Predecessors}":"L{Successors}",layoutStyle:{flexFlow:"column nowrap"},items:{grid:{type:"grid",weight:100,flex:"1 1 auto",emptyText:"",features:{group:!1},columns:[{localeClass:this,text:"L{ID}",flex:1,editor:!1,htmlEncode:!1,hidden:!0,renderer:function(t){var n,r=t.record,i=t.row,o=t.grid;if(xF(r,o)){var a=r[e];n=!a||a.hasGeneratedId?"*":a.id}else i.addCls("b-invalid"),n='<div class="b-icon b-icon-warning"></div>';return n}},{localeClass:this,text:"L{Name}",field:e,flex:5,renderer:function(e){var t=e.value;return t&&t.name+(t.hasGeneratedId?"":" (".concat(t.id,")"))},finalizeCellEdit:"up.finalizeLinkedTaskCellEdit",editor:{type:"modelcombo",listItemTpl:function(e){return"".concat(e.name," (").concat(e.id,")")},displayField:"name",valueField:"id",editable:!1,allowInvalid:!0}},{localeClass:this,text:"L{Type}",field:"type",flex:3,sortable:!1,editor:"dependencytypepicker",renderer:function(e){var t=e.value;return this.L("L{DependencyType.long}")[t]}},{localeClass:this,text:"L{Lag}",type:"duration",field:"fullLag",flex:2,editor:{allowNegative:!0}}],disableGridRowModelWarning:!0,asyncEventSuffix:"PreCommit"},toolbar:{type:"toolbar",weight:200,flex:"0 0 auto",cls:"b-compact-bbar",items:{add:{type:"button",weight:210,cls:"b-add-button b-green",icon:"b-icon b-icon-add"},remove:{type:"button",weight:220,cls:"b-remove-button b-red",icon:"b-icon b-icon-trash",disabled:!0}}}}}}},{key:"$name",get:function(){return"DependencyTab"}}]),o}(gF);function TF(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}EF._$name="DependencyTab";var MF=function(e){fe()(n,e);var t=TF(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"$name",get:function(){return"SuccessorsTab"}},{key:"type",get:function(){return"successorstab"}},{key:"defaultConfig",get:function(){return Object.assign(this.makeDefaultConfig("toEvent"),{cls:"b-successors-tab"})}}]),n}(EF);function AF(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}MF.initClass(),MF._$name="SuccessorsTab";var PF=function(e){fe()(n,e);var t=AF(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"$name",get:function(){return"PredecessorsTab"}},{key:"type",get:function(){return"predecessorstab"}},{key:"defaultConfig",get:function(){return Object.assign(this.makeDefaultConfig("fromEvent"),{cls:"b-predecessors-tab"})}}]),n}(EF);function IF(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}PF.initClass(),PF._$name="PredecessorsTab";var OF=function(e){fe()(r,e);var t,n=IF(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"afterConstruct",value:function(){we()(pe()(r.prototype),"afterConstruct",this).call(this);var e=this,t=e.addButton=e.widgetMap.add,n=e.removeButton=e.widgetMap.remove,i=e.grid=e.widgetMap.grid;null==t||t.on("click",e.onAddClick,e),null==n||n.on("click",e.onRemoveClick,e),i.on({selectionChange:"onGridSelectionChange",startCellEdit:"onGridStartCellEdit",finishCellEdit:"onGridFinishCellEdit",cancelCellEdit:"onGridCancelCellEdit",thisObj:e})}},{key:"updateReadOnly",value:function(e){var t=this.widgetMap,n=t.add,i=t.remove;we()(pe()(r.prototype),"updateReadOnly",this).apply(this,arguments),n.hidden=i.hidden=e}},{key:"loadEvent",value:function(e){var t=this,n=t.grid,i=!n.store.isChained,o=!i&&e!==t.record;we()(pe()(r.prototype),"loadEvent",this).call(this,e);var a=t.resourceCombo,s=t.project,u=s.assignmentStore,c=s.resourceStore;e.isTask||n.columns.get("units").hide(),i?(t.assignmentStoreGeneration=u.storage.generation,t.resourceStoreGeneration=c.storage.generation,n.store=u.makeChained((function(e){return t.record&&e.event===t.record}),null),a.store=c.makeChained((function(e){return t.record&&!t.record.isAssignedTo(e)||!t.activeAssignment||t.activeAssignment.resource===e}))):((o||u.storage.generation!==t.assignmentStoreGeneration)&&n.store.fillFromMaster(),(o||c.storage.generation!==t.resourceStoreGeneration)&&a.store.fillFromMaster())}},{key:"insertNewAssignment",value:(t=Wr()(Vr.a.mark((function e(){var t,n,r,i,o,a,s;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=(t=this).project,r=t.grid,i=n.assignmentStore,o=i.insert(0,{event:t.record,resource:null,units:100}),a=ye()(o,1),s=a[0],t.assignmentStoreGeneration=i.storage.generation,r.features.cellEdit.startEditing({field:"resource",id:s.id}),e.abrupt("return",s);case 5:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"beforeSave",value:function(){this.pruneInvalidAssignments()}},{key:"onAddClick",value:function(){this.insertNewAssignment()}},{key:"onRemoveClick",value:function(){var e=this.grid;e.store.remove(e.selectedRecords),e.selectedRecords=null,this.removeButton.disable()}},{key:"onGridSelectionChange",value:function(e){var t=e.selection;this.removeButton.disabled=!(null==t?void 0:t.length)}},{key:"onGridStartCellEdit",value:function(e){var t=e.editorContext;"resource"===t.column.field&&(this.resourceCombo.store.fillFromMaster(),this._editingAssignment=t.record,this._activeCellEdit=t)}},{key:"onGridFinishCellEdit",value:function(){this._activeCellEdit=this._editingAssignment=null}},{key:"onGridCancelCellEdit",value:function(){this._activeCellEdit=this._editingAssignment=null}},{key:"pruneInvalidAssignments",value:function(){var e=this.grid.store;e.remove(e.query((function(e){return!e.isValid})))}},{key:"resourceCombo",get:function(){var e,t=null===(e=this.grid)||void 0===e?void 0:e.columns.get("resource");return null==t?void 0:t.editor}},{key:"activeAssignment",get:function(){return this.grid.features.cellEdit.activeRecord}}],[{key:"$name",get:function(){return"ResourcesTab"}},{key:"type",get:function(){return"resourcestab"}},{key:"defaultConfig",get:function(){var e=this;return{title:"L{Resources}",cls:"b-resources-tab",layoutStyle:{flexFlow:"column nowrap"},items:{grid:{type:"grid",weight:100,flex:"1 1 auto",columns:[{localeClass:this,text:"L{Resource}",field:"resource",flex:7,renderer:function(e){var t=e.value;return(null==t?void 0:t.name)||""},editor:{type:"modelcombo",displayField:"name",valueField:"id",editable:!1}},{localeClass:this,text:"L{Units}",field:"units",flex:3,renderer:function(t){return e.L("L{unitsTpl}",t)},editor:{type:"numberfield",min:0,max:100,step:10}}],disableGridRowModelWarning:!0,asyncEventSuffix:"PreCommit"},toolbar:{type:"toolbar",weight:200,flex:"0 0 auto",cls:"b-compact-bbar",items:{add:{type:"button",weight:210,cls:"b-add-button b-green",icon:"b-icon b-icon-add"},remove:{type:"button",weight:220,cls:"b-remove-button b-red",icon:"b-icon b-icon-trash",disabled:!0}}}}}}}]),r}(gF);function FF(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}OF.initClass(),OF._$name="ResourcesTab";var LF=function(e){fe()(n,e);var t=FF(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"buildStoreData",value:function(){return[{id:ZC.Normal,text:this.L("L{Normal}")},{id:ZC.FixedDuration,text:this.L("L{Fixed Duration}")},{id:ZC.FixedUnits,text:this.L("L{Fixed Units}")},{id:ZC.FixedEffort,text:this.L("L{Fixed Effort}")}]}},{key:"updateLocalization",value:function(){we()(pe()(n.prototype),"updateLocalization",this).call(this),this.store.data=this.buildStoreData()}},{key:"store",get:function(){return this._store||(this.store=new No({data:this.buildStoreData()})),this._store},set:function(e){sc()(pe()(n.prototype),"store",e,this,!0)}}],[{key:"$name",get:function(){return"SchedulingModePicker"}},{key:"type",get:function(){return"schedulingmodecombo"}}]),n}(Xf);function jF(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}LF.initClass(),LF._$name="SchedulingModePicker";var _F=function(e){fe()(n,e);var t=jF(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"loadEvent",value:function(e){var t=!this.record,r=this.calendarField;r&&t&&(r.store=e.project.calendarManagerStore),we()(pe()(n.prototype),"loadEvent",this).call(this,e)}},{key:"calendarField",get:function(){return this.widgetMap.calendarField}},{key:"constraintTypeField",get:function(){return this.widgetMap.constraintTypeField}},{key:"constraintDateField",get:function(){return this.widgetMap.constraintDateField}},{key:"effortDrivenField",get:function(){return this.widgetMap.effortDrivenField}},{key:"manuallyScheduledField",get:function(){return this.widgetMap.manuallyScheduledField}},{key:"rollupField",get:function(){return this.widgetMap.rollupField}},{key:"schedulingModeField",get:function(){return this.widgetMap.schedulingModeField}}],[{key:"$name",get:function(){return"AdvancedTab"}},{key:"type",get:function(){return"advancedtab"}},{key:"defaultConfig",get:function(){return{localeClass:this,title:"L{Advanced}",cls:"b-advanced-tab",defaults:{localeClass:this},items:{calendarField:{type:"calendarfield",weight:100,ref:"",name:"calendar",label:"L{Calendar}",flex:"1 0 50%",cls:"b-inline"},manuallyScheduledField:{type:"checkbox",weight:200,name:"manuallyScheduled",label:"L{Manually scheduled}",flex:"1 0 50%"},schedulingModeField:{type:"schedulingmodecombo",weight:300,name:"schedulingMode",label:"L{Scheduling mode}",flex:"1 0 50%",cls:"b-inline"},effortDrivenField:{type:"checkbox",weight:400,name:"effortDriven",label:"L{Effort driven}",flex:"1 0 50%"},divider:{weight:500,html:"",dataset:{text:this.L("L{Constraint}")},cls:"b-divider",flex:"1 0 100%"},constraintTypeField:{type:"constrainttypepicker",weight:600,name:"constraintType",label:"L{Constraint type}",pickerWidth:"14em",clearable:!0,flex:"1 0 50%",cls:"b-inline"},constraintDateField:{type:"date",weight:700,name:"constraintDate",label:"L{Constraint date}",flex:"1 0 50%",cls:"b-inline"},rollupField:{type:"checkbox",weight:800,name:"rollup",label:"L{Rollup}",flex:"1 0 50%",cls:"b-inline"}}}}}]),n}(mF);function BF(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}_F.initClass(),_F._$name="AdvancedTab";var HF=function(e){fe()(n,e);var t=BF(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"$name",get:function(){return"NotesTab"}},{key:"type",get:function(){return"notestab"}},{key:"defaultConfig",get:function(){return{title:'<i class="b-icon b-icon-note" data-btip="L{Notes}"></i>',cls:"b-notes-tab",layoutConfig:{alignItems:"flex-start",alignContent:"stretch"},items:{noteField:{weight:100,type:"textareafield",cls:"b-taskeditor-notes-field",name:"note"}}}}}]),n}(mF);function $F(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}HF.initClass(),HF._$name="NotesTab";var NF=function(e){fe()(n,e);var t=$F(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"processWidgetConfig",value:function(e){return"tabs"===e.ref&&this.extraItems&&y.a.deprecate("Gantt","5.0.0","`extraItems` config is deprecated, in favor of `items` config. Please see https://bryntum.com/docs/gantt/#guides/upgrades/4.0.0.md for more information."),we()(pe()(n.prototype),"processWidgetConfig",this).call(this,e)}},{key:"startConfigure",value:function(e){e.tabsConfig&&y.a.deprecate("Gantt","5.0.0","`tabsConfig` config is deprecated, in favor of `items` config. Please see https://bryntum.com/docs/gantt/#guides/upgrades/4.0.0.md for more information."),we()(pe()(n.prototype),"startConfigure",this).call(this,e)}}],[{key:"type",get:function(){return"gantttaskeditor"}},{key:"$name",get:function(){return"GanttTaskEditor"}},{key:"defaultConfig",get:function(){return{items:[{type:"tabpanel",defaultType:"formtab",ref:"tabs",flex:"1 0 100%",layoutConfig:{alignItems:"stretch",alignContent:"stretch"},items:{generalTab:{type:"generaltab",weight:100},predecessorsTab:{type:"predecessorstab",weight:200},successorsTab:{type:"successorstab",weight:300},resourcesTab:{type:"resourcestab",weight:400},advancedTab:{type:"advancedtab",weight:500},notesTab:{type:"notestab",weight:600}}}]}}}]),n}(dF);function VF(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}NF.initClass(),NF._$name="GanttTaskEditor";var zF=function(e){fe()(n,e);var t=VF(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"loadEvent",value:function(e){var t=this,r={unit:e.durationUnit,magnitude:1},i=e.isParent,o=e.project,a=t.widgetMap,s=a.durationField,u=a.percentDoneField,c=a.startDateField,l=a.endDateField,f=a.resourcesField;t.record;s&&(s.disabled=i),u&&(u.disabled=i),c&&(c.dateField.eventRecord=e,Zt.compareUnits(r.unit,"hour")>0?c.dateField.step=r:c.timeField.step=r),l&&(l.dateField.eventRecord=e,Zt.compareUnits(r.unit,"hour")>0?l.dateField.step=r:l.timeField.step=r,l.disabled=i),f&&(f.multiSelect=!o.eventStore.usesSingleAssignment,f.store=new o.resourceStore.constructor({chained:!0,masterStore:o.resourceStore,chainedFilterFn:function(e){return!e.isSpecialRow}})),we()(pe()(n.prototype),"loadEvent",this).apply(this,arguments)}},{key:"onFieldChange",value:function(e){var t=e.source,r=e.valid,i=e.userAction,o=e.value;if(i&&r){var a=this.record.eventStore,s="resources"===t.name&&0===o.length&&this.autoUpdateRecord&&a.removeUnassignedEvent;s&&(a.removeUnassignedEvent=!1),we()(pe()(n.prototype),"onFieldChange",this).apply(this,arguments),s&&(a.removeUnassignedEvent=!0)}}},{key:"beforeSave",value:function(){0===this.record.resources.length&&this.record.eventStore.removeUnassignedEvent&&this.record.remove(),we()(pe()(n.prototype),"beforeSave",this).call(this)}}],[{key:"$name",get:function(){return"SchedulerGeneralTab"}},{key:"type",get:function(){return"schedulergeneraltab"}},{key:"defaultConfig",get:function(){return{title:"L{General}",cls:"b-general-tab",defaults:{localeClass:this,weight:10},items:{nameField:{type:"text",required:!0,label:"L{Name}",clearable:!0,name:"name",cls:"b-name",weight:100},resourcesField:{type:"combo",label:"L{Resources}",name:"resources",editable:!0,valueField:"id",displayField:"name",highlightExternalChange:!1,multiSelect:!0,cls:"b-resources",weight:200},startDateField:{type:"datetime",label:"L{Start}",name:"startDate",cls:"b-start-date",flex:"1 0 100%",weight:300,dateField:{type:"startdatefield"}},endDateField:{type:"datetime",label:"L{Finish}",name:"endDate",cls:"b-end-date",flex:"1 0 100%",weight:400,dateField:{type:"enddatefield"}},durationField:{type:"durationfield",label:"L{Duration}",name:"fullDuration",flex:"1 0 50%",cls:"b-duration b-inline",weight:500},percentDoneField:{type:"number",label:"L{% complete}",name:"renderedPercentDone",cls:"b-percent-done",flex:"1 0 50%",min:0,max:100,weight:600}}}}}]),n}(mF);function WF(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}zF.initClass(),zF._$name="SchedulerGeneralTab";var GF=function(e){fe()(n,e);var t=WF(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"loadEvent",value:function(e){var t=this,r=(t.record,t.calendarField);r&&(r.store=e.project.calendarManagerStore,r.hidden=!e.project.calendarManagerStore.count),we()(pe()(n.prototype),"loadEvent",this).apply(this,arguments)}},{key:"calendarField",get:function(){return this.widgetMap.calendarField}},{key:"constraintTypeField",get:function(){return this.widgetMap.constraintTypeField}},{key:"constraintDateField",get:function(){return this.widgetMap.constraintDateField}},{key:"manuallyScheduledField",get:function(){return this.widgetMap.manuallyScheduledField}}],[{key:"$name",get:function(){return"SchedulerAdvancedTab"}},{key:"type",get:function(){return"scheduleradvancedtab"}},{key:"defaultConfig",get:function(){return{title:'<i class="b-icon b-icon-advanced" data-btip="L{Advanced}"></i>',cls:"b-advanced-tab",defaults:{localeClass:this},items:{calendarField:{type:"calendarfield",name:"calendar",label:"L{Calendar}",weight:100},constraintTypeField:{type:"constrainttypepicker",name:"constraintType",label:"L{Constraint type}",clearable:!0,weight:200},constraintDateField:{type:"date",name:"constraintDate",label:"L{Constraint date}",weight:300},manuallyScheduledField:{type:"checkbox",name:"manuallyScheduled",label:"L{Manually scheduled}",weight:400}}}}}]),n}(mF);function YF(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}GF.initClass(),GF._$name="SchedulerAdvancedTab";var UF=function(e){fe()(n,e);var t=YF(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"processWidgetConfig",value:function(e){return"tabs"===e.ref&&this.extraItems&&y.a.deprecate("SchedulerPro","5.0.0","`extraItems` config is deprecated, in favor of `items` config. Please see https://bryntum.com/docs/gantt/#guides/upgrades/4.0.0.md for more information."),we()(pe()(n.prototype),"processWidgetConfig",this).call(this,e)}},{key:"startConfigure",value:function(e){e.tabsConfig&&y.a.deprecate("SchedulerPro","5.0.0","`tabsConfig` config is deprecated, in favor of `items` config. Please see https://bryntum.com/docs/gantt/#guides/upgrades/4.0.0.md for more information."),we()(pe()(n.prototype),"startConfigure",this).call(this,e)}}],[{key:"type",get:function(){return"schedulertaskeditor"}},{key:"$name",get:function(){return"SchedulerTaskEditor"}},{key:"defaultConfig",get:function(){return{items:[{type:"tabpanel",defaultType:"formtab",ref:"tabs",flex:"1 0 100%",layoutConfig:{alignItems:"stretch",alignContent:"stretch"},items:{generalTab:{type:"schedulergeneraltab",weight:100},predecessorsTab:{type:"predecessorstab",weight:200},successorsTab:{type:"successorstab",weight:300},advancedTab:{type:"scheduleradvancedtab",weight:500},notesTab:{type:"notestab",weight:600}}}]}}}]),n}(dF);function qF(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}UF.initClass(),UF._$name="SchedulerTaskEditor";var KF=function(e){fe()(i,e);var t,n,r=qF(i);function i(){return v()(this,i),r.apply(this,arguments)}return g()(i,[{key:"construct",value:function(e){var t=this;if(t.startDateLabel=document.createElement("label"),t.startDateLabel.className="b-timeline-startdate",t.endDateLabel=document.createElement("label"),t.endDateLabel.className="b-timeline-enddate","project"in e){if(!e.project)throw new Error("You need to configure the Timeline with a Project");e.project instanceof HO&&(t.taskStore=e.project.eventStore,e.project.isInitialCommitPerformed||e.project.on({refresh:function(e){e.isInitialCommit&&this.fillFromTaskStore()},once:!0,thisObj:this}),delete e.project)}we()(pe()(i.prototype),"construct",this).call(this,e),t.features.timeRanges&&(t.features.timeRanges.store=new No),t.fillFromTaskStore.now(),t.taskStore.on({refreshPreCommit:t.fillFromTaskStore,changePreCommit:t.onTaskStoreChange,thisObj:t}),t.on({resize:t.onSizeChanged,thisObj:t}),t.bodyContainer.appendChild(t.startDateLabel),t.bodyContainer.appendChild(t.endDateLabel),rt.on({locale:"onLocaleChange",thisObj:t})}},{key:"onSizeChanged",value:function(e){var t=e.width,n=e.oldWidth;this.suspendRefresh(),this.updateRowHeight(),this.resumeRefresh(),t!==n&&this.fitTimeline()}},{key:"updateRowHeight",value:function(){this.rowHeight=this.bodyContainer.offsetHeight}},{key:"fitTimeline",value:function(){this.eventStore.count>0&&this.zoomToFit({leftMargin:50,rightMargin:50}),this.updateStartEndLabels()}},{key:"updateStartEndLabels",value:function(){var e=this;e.startDateLabel.innerHTML=e.getFormattedDate(e.startDate),e.endDateLabel.innerHTML=e.getFormattedDate(e.endDate)}},{key:"onTaskStoreChange",value:(n=Wr()(Vr.a.mark((function e(t){var n,r,i,o,a,s,u,c,l,f,d;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=t.action,r=t.record,i=t.records,o=t.changes,a=t.isCollapse,u=(s=this).eventStore,e.t0=n,e.next="add"===e.t0?5:"remove"===e.t0?7:"removeall"===e.t0?9:"update"===e.t0?11:14;break;case 5:return i.forEach((function(e){e.showInTimeline&&(u.add(s.cloneTask(e)),c=!0)})),e.abrupt("break",14);case 7:return a||i.forEach((function(e){e.showInTimeline&&(u.remove(e.id),c=!0)})),e.abrupt("break",14);case 9:return s.fillFromTaskStore(),e.abrupt("break",14);case 11:return l=r,o.showInTimeline?(l.showInTimeline?u.add(s.cloneTask(l)):u.remove(u.getById(l.id)),c=!0):l.showInTimeline&&(f=u.getById(l.id))&&(delete(d=Object.assign({},l.data)).expanded,delete d.duration,delete d.durationUnit,delete d.calendar,f.set(d),c=!0),e.abrupt("break",14);case 14:c&&s.fitTimeline();case 15:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"cloneTask",value:function(e){return{id:e.id,resourceId:1,startDate:e.startDate,endDate:e.endDate,name:e.name}}},{key:"render",value:function(){we()(pe()(i.prototype),"render",this).call(this),this.updateRowHeight()}},{key:"fillFromTaskStore",value:(t=Wr()(Vr.a.mark((function e(){var t,n;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=[],(t=this).taskStore.traverse((function(e){e.showInTimeline&&e.isScheduled&&n.push(t.cloneTask(e))})),t.suspendRefresh(),t.events=n,e.next=6,t.project.commitAsync();case 6:if(!t.isDestroyed){e.next=8;break}return e.abrupt("return");case 8:t.resumeRefresh(!0),t.fitTimeline();case 10:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"onLocaleChange",value:function(){this.updateStartEndLabels()}}],[{key:"$name",get:function(){return"Timeline"}},{key:"type",get:function(){return"timeline"}},{key:"defaultConfig",get:function(){return{height:"13em",eventLayout:"pack",barMargin:1,forceFit:!0,timeAxis:{autoAdjust:!1},readOnly:!0,zoomOnMouseWheel:!1,zoomOnTimeAxisDoubleClick:!1,eventColor:null,eventStyle:null,rowHeight:48,displayDateFormat:"L",features:{cellEdit:!1,cellMenu:!1,columnAutoWidth:!1,columnLines:!1,columnPicker:!1,columnReorder:!1,columnResize:!1,contextMenu:!1,eventContextMenu:!1,eventDrag:!1,eventDragCreate:!1,eventEdit:!1,eventFilter:!1,eventMenu:!1,eventResize:!1,eventTooltip:!1,group:!1,headerMenu:!1,regionResize:!1,scheduleContextMenu:!1,scheduleMenu:!1,scheduleTooltip:!1,sort:!1,timeAxisHeaderMenu:!1,timeRanges:{showCurrentTimeLine:!0}},resources:[{id:1}],columns:[]}}},{key:"delayable",get:function(){return{fillFromTaskStore:100}}}]),i}(_A);function XF(){var e=El()(["resizing-task"]);return XF=function(){return e},e}function ZF(){var e=El()(["resizing"]);return ZF=function(){return e},e}function JF(){var e=El()(["handle"]);return JF=function(){return e},e}function QF(){var e=El()([""]);return QF=function(){return e},e}function eL(){var e=El()(["outer"]);return eL=function(){return e},e}function tL(){var e=El()(["resizing-task"]);return tL=function(){return e},e}function nL(){var e=El()(["resizing"]);return nL=function(){return e},e}function rL(){var e=El()(["show-percentage"]);return rL=function(){return e},e}function iL(){var e=El()(["drag-disabled"]);return iL=function(){return e},e}function oL(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}KF.initClass(),KF._$name="Timeline";function aL(e){return"b-task-percent-bar".concat(e[0]?"-".concat(e[0]):"")}var sL=function(e){fe()(n,e);var t=oL(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"onPaint",value:function(){var e,t=this,n=t.client;t.drag&&t.drag.destroy(),t.drag=new hu({name:"percentBarHandle",mode:"translateX",targetSelector:"".concat(n.eventSelector,":not(.").concat(n.eventCls,"-parent) .b-task-percent-bar-handle"),dragThreshold:1,listeners:{beforeDragStart:"onBeforeDragStart",dragStart:"onDragStart",drag:"onDrag",drop:"onDrop",abort:"onDragAbort",thisObj:t}}),t.detachListeners("view"),t.client.on((e={name:"view"},ke()(e,"".concat(n.scheduledEventName,"mouseenter"),"onTimeSpanMouseEnter"),ke()(e,"".concat(n.scheduledEventName,"mouseleave"),"onTimeSpanMouseLeave"),ke()(e,"thisObj",t),e))}},{key:"updateAllowResize",value:function(e){this.client.element.classList[e?"remove":"add"](aL(iL()))}},{key:"updateShowPercentage",value:function(e){this.client.element.classList[e?"add":"remove"](aL(rL()))}},{key:"doDestroy",value:function(){this.drag&&this.drag.destroy(),we()(pe()(n.prototype),"doDestroy",this).call(this)}},{key:"doDisable",value:function(e){this.client.isPainted&&this.client.refresh(),we()(pe()(n.prototype),"doDisable",this).call(this,e)}},{key:"cleanup",value:function(e){var t=this;e.element.closest(t.client.eventSelector).classList.remove(aL(nL())),t.client.element.classList.remove(aL(tL())),t.isMouseInsideEvent||(t.handle.remove(),t.handle=null)}},{key:"appendDOMConfig",value:function(e,t){!e.isEvent&&!e.isTask||e.isMilestone||this.disabled||t.unshift({className:aL(eL()),dataset:{taskBarFeature:"percentBar"},children:[{className:aL(QF()),dataset:{percent:e.renderedPercentDone},style:{width:e.percentDone+"%"}}]})}},{key:"onEventDataGenerated",value:function(e){this.appendDOMConfig(e.eventRecord,e.children)}},{key:"onTaskDataGenerated",value:function(e){this.appendDOMConfig(e.task,e.children)}},{key:"onTimeSpanMouseEnter",value:function(e){var t=this,n=e["".concat(t.client.scheduledEventName,"Record")];if(t.drag.context)n===t.drag.context.taskRecord&&(t.isMouseInsideEvent=!0);else{var r=e["".concat(t.client.scheduledEventName,"Element")],i=Gs.getChild(r,t.client.scheduledEventName);t.handle||(t.handle=Cr.createElement({parent:i,className:aL(JF()),style:{left:n.percentDone+"%"},dataset:{percent:n.percentDone}})),t.isMouseInsideEvent=!0}}},{key:"onTimeSpanMouseLeave",value:function(){var e=this;!e.drag.context&&e.handle&&(e.handle.remove(),e.handle=null),e.isMouseInsideEvent=!1}},{key:"onBeforeDragStart",value:function(e){var t=e.source,n=e.context,r=Gs.getChild(n.element.parentElement,"percentBar"),i=r.firstElementChild,o=i.offsetWidth,a=r.offsetWidth,s=this.client.resolveEventRecord(n.element);t.minX=-o,t.maxX=a-o,Object.assign(n,{percentBar:i,initialX:o,outerWidth:a,taskRecord:s})}},{key:"onDragStart",value:function(e){var t=e.context,n=this.client;t.element.closest(n.eventSelector).classList.add(aL(ZF())),n.element.classList.add(aL(XF())),t.element.retainElement=!0}},{key:"onDrag",value:function(e){var t=e.context,n=Math.round((t.initialX+t.newX)/t.outerWidth*100);t.percent=t.percentBar.dataset.percent=t.element.dataset.percent=n,t.percentBar.style.width=n+"%"}},{key:"onDragAbort",value:function(e){var t=e.context;t.percentBar.style.width=t.taskRecord.percentDone+"%",this.cleanup(t)}},{key:"onDrop",value:function(e){var t=e.context;t.taskRecord.percentDone=t.percent,t.element.style.cssText="left: ".concat(t.percent,"%"),this.cleanup(t)}},{key:"featureClass",get:function(){}}],[{key:"$name",get:function(){return"PercentBar"}},{key:"configurable",get:function(){return{allowResize:!0,showPercentage:!0}}},{key:"pluginConfig",get:function(){return{chain:["onPaint","onTaskDataGenerated","onEventDataGenerated"]}}}]),n}(qr);function uL(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}sL._$name="PercentBar",fv.registerFeature(sL,!1,"SchedulerPro"),fv.registerFeature(sL,!0,"Gantt");var cL=function(e){fe()(n,e);var t=uL(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(){we()(pe()(n.prototype),"construct",this).apply(this,arguments),this.client.timeAxis.on({name:"timeAxis",reconfigure:"onTimeAxisReconfigure",prio:100,thisObj:this})}},{key:"attachToResourceStore",value:function(e){we()(pe()(n.prototype),"attachToResourceStore",this).call(this,e),e&&e.on({name:"resourceStore",changePreCommit:"onResourceChange",thisObj:this})}},{key:"attachToCalendarManagerStore",value:function(e){we()(pe()(n.prototype),"attachToCalendarManagerStore",this).call(this,e),e&&e.on({name:"calendarManagerStore",changePreCommit:"onCalendarChange",thisObj:this})}},{key:"onTimeAxisReconfigure",value:function(){this.resourceMap.clear()}},{key:"onResourceChange",value:function(e){var t=this,n=e.action,r=e.records,i=e.record,o=e.changes;if("update"===n){var a=o.calendar;!a||"string"==typeof a.oldValue&&a.value.id===a.oldValue||(this.resourceMap.delete(i.id),this.scheduler.currentOrientation.refreshRow(i))}"remove"===n&&r.forEach((function(e){return t.resourceMap.delete(e.id)})),"removeall"===n&&this.resourceMap.clear()}},{key:"onCalendarChange",value:function(e){e.action,e.records,e.record,e.changes}},{key:"getEventsToRender",value:function(e,t){var n=this.resourceMap,r=this.scheduler;if(e.calendar){if(!n.has(e.id)){var i=e.calendar.getNonWorkingTimeRanges(r.startDate,r.endDate).map((function(t,n){return new tm({id:"r".concat(e.id,"i").concat(n),startDate:t.startDate,endDate:t.endDate,resourceId:e.id,isNonWorking:!0})}));n.set(e.id,i)}t.push.apply(t,d()(n.get(e.id)))}return t}},{key:"shouldInclude",value:function(e){return e.isNonWorking}}],[{key:"$name",get:function(){return"ResourceNonWorkingTime"}},{key:"defaultConfig",get:function(){return{idPrefix:"resourcenonworkingtime",rangeCls:"b-sch-resourcetimerange b-sch-resourcenonworkingtime"}}},{key:"properties",get:function(){return{resourceMap:new Map}}}]),n}(eP);function lL(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}cL.featureClass="",cL._$name="ResourceNonWorkingTime",fv.registerFeature(cL,!1,"SchedulerPro");var fL=function(e){fe()(u,e);var t,n,r,i,o,a,s=lL(u);function u(){return v()(this,u),s.apply(this,arguments)}return g()(u,[{key:"construct",value:function(e,t){var n;e.taskEdit=this,we()(pe()(u.prototype),"construct",this).call(this,e,an.assign({weekStartDay:e.weekStartDay},t)),e.on((n={},ke()(n,this.triggerEvent,"onActivateEditor"),ke()(n,"readOnly","onClientReadOnlyToggle"),ke()(n,"dragCreateEnd","onDragCreateEnd"),ke()(n,"thisObj",this),n))}},{key:"doDestroy",value:function(){var e;this.detachFromProject(),null===(e=this.editor)||void 0===e||e.destroy(),this.deleteConfirmationPromise&&zd.hide(),we()(pe()(u.prototype),"doDestroy",this).call(this)}},{key:"onClientReadOnlyToggle",value:function(e){var t=e.readOnly;this.editor&&(this.editor.readOnly=t)}},{key:"getElementFromTaskRecord",value:function(e,t){return this.client.getElementFromEventRecord(e,t)}},{key:"scrollEventIntoView",value:function(e,t){this.client.scrollResourceEventIntoView(t,e)}},{key:"attachToProject",value:function(){var e=this;this.detachFromProject(),this.project.on({name:"project",loadstart:function(){return e.save()},dataReady:"onDataReady",thisObj:this})}},{key:"detachFromProject",value:function(){this.detachListeners("project")}},{key:"onDataReady",value:function(){var e=this.record;(null==e?void 0:e.project)?this.load(e,!0):this.save()}},{key:"onActivateEditor",value:function(e){var t=e.eventRecord,n=e.resourceRecord,r=e.eventElement;this.editEvent(t,n,r)}},{key:"editEvent",value:(a=Wr()(Vr.a.mark((function e(t){var n,r,i,o,a,s,u,c,l,f=arguments;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=f.length>1&&void 0!==f[1]?f[1]:null,r=f.length>2&&void 0!==f[2]?f[2]:null,o=(i=this).scheduler,i._editing&&i.cancel(),!i._canceling){e.next=7;break}return e.next=7,i._canceling;case 7:if(n||(n=t.resource||(null===(a=t.resources)||void 0===a?void 0:a[0])),i.disabled){e.next=45;break}if(s=o.taskStore,i._editing=!0,i.captureStm(),i.startStmTransaction(),o.project.suspendAutoSync(),"function"==typeof t&&(t=t()),t.isOccurrence||s.includes(t)){e.next=21;break}return u=!0,s.add(t),n&&o.assignmentStore.assignEventToResource(t,n),e.next=21,o.project.commitAsync();case 21:if(r||!s.includes(t)||!n){e.next=24;break}return e.next=24,i.scrollEventIntoView(t,n);case 24:if(c=r||Cr.down(i.getElementFromTaskRecord(t,n),o.eventInnerSelector),l=i.getEditor(t),!1===o.trigger("beforeTaskEdit",{taskEdit:i,taskRecord:t,taskElement:c})){e.next=40;break}if(o.element.classList.add("b-taskeditor-editing"),o.trigger("beforeTaskEditShow",{taskEdit:i,taskRecord:t,taskElement:c,editor:l}),i.load(t),i.getEditor().widgetMap.deleteButton&&(i.getEditor().widgetMap.deleteButton.hidden=o.readOnly||u||!i.showDeleteButton),i.attachToProject(),!c){e.next=36;break}return e.next=34,l.showBy({target:c,anchor:!0,offset:-5});case 34:e.next=38;break;case 36:return e.next=38,l.showBy({target:o.element,anchor:!1,align:"c-c"});case 38:e.next=45;break;case 40:return e.next=42,i.rejectStmTransaction();case 42:i.disableStm(),i.freeStm(),i._editing=!1;case 45:case"end":return e.stop()}}),e,this)}))),function(e){return a.apply(this,arguments)})},{key:"getEditor",value:function(){var e,t,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.record,r=this,i=(null==n?void 0:n.project)||r.project,o=i.getType(),a=(null===(e=r.editorClass)||void 0===e?void 0:e.type)||r.editorClassMap[o]||r.editorClassMap[tS.Unknown]||"schedulertaskeditor";r.editor&&r.editor.type===a||(null===(t=r.editor)||void 0===t||t.destroy(),r.editor=oc.create(an.merge({type:a,eventEditFeature:r,weekStartDay:r.weekStartDay,saveAndCloseOnEnter:r.saveAndCloseOnEnter,showDeleteButton:r.showDeleteButton,owner:r.client,project:r.project,durationDisplayPrecision:r.client.durationDisplayPrecision,tabPanelItems:r.items,listeners:{cancel:"onCancel",delete:"onDelete",save:"onSave",thisObj:r},tabsConfig:r.tabsConfig},r.editorConfig)));return r.editor.readOnly=r.client.readOnly,r.editor}},{key:"load",value:function(e,t){var n=this.getEditor(e);this._loading=!0,this.record=e,n.loadEvent(e,t),this._loading=!1}},{key:"save",value:(o=Wr()(Vr.a.mark((function e(){var t,n,r;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(t=this).scheduler,!t._editing){e.next=15;break}if(r=t.getEditor(),t.isValid&&!1!==t.trigger("beforeTaskSave",{taskRecord:t.record,editor:r})){e.next=5;break}return e.abrupt("return");case 5:t.detachFromProject(),r.beforeSave(),t.commitStmTransaction(),t.freeStm(),t._editing=!1,r.hide().then((function(){return r.afterSave()})),n.project.resumeAutoSync(!0),n.element.classList.remove("b-taskeditor-editing"),t.trigger("afterTaskSave",{taskRecord:t.record,editor:r}),n.trigger("afterTaskEdit",{taskRecord:t.record,editor:r});case 15:case"end":return e.stop()}}),e,this)}))),function(){return o.apply(this,arguments)})},{key:"doCancel",value:(i=Wr()(Vr.a.mark((function e(){var t,n,r,i,o;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(t=this).scheduler,!t._editing){e.next=23;break}if(t._editing=!1,t.detachFromProject(),r=t.record,i=t.project,(o=t.getEditor()).beforeCancel(),!t.isDestroyed){e.next=8;break}return e.abrupt("return");case 8:return e.next=10,t.rejectStmTransaction();case 10:if(!t.isDestroyed){e.next=12;break}return e.abrupt("return");case 12:return t.disableStm(),e.next=15,i.propagateAsync();case 15:if(!t.isDestroyed){e.next=17;break}return e.abrupt("return");case 17:t.freeStm(),o.afterCancel(),n.project.resumeAutoSync(!1),t.scheduler.element.classList.remove("b-taskeditor-editing"),n.trigger("taskEditCanceled",{taskRecord:r,editor:o}),n.trigger("afterTaskEdit",{taskRecord:r,editor:o});case 23:case"end":return e.stop()}}),e,this)}))),function(){return i.apply(this,arguments)})},{key:"cancel",value:(r=Wr()(Vr.a.mark((function e(){var t;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this,e.abrupt("return",t._canceling||(t._canceling=t.doCancel().finally((function(){return t._canceling=void 0}))));case 2:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"delete",value:(n=Wr()(Vr.a.mark((function e(){var t,n;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(t=this).getEditor(),!1!==t.trigger("beforeTaskDelete",{taskRecord:t.record,editor:n})){e.next=3;break}return e.abrupt("return");case 3:return t.detachFromProject(),n.beforeDelete(),t.record.remove(),t.freeStm(),e.next=9,t.project.commitAsync();case 9:if(!t.isDestroyed){e.next=11;break}return e.abrupt("return");case 11:t.scheduler.project.resumeAutoSync(!0),t._editing=!1,n.hide(),n.afterDelete(),t.scheduler.element.classList.remove("b-taskeditor-editing"),t.scheduler.trigger("afterTaskEdit",{editor:n});case 17:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"onSave",value:function(){var e=this;this.requestAnimationFrame((function(){return e.save()}))}},{key:"onCancel",value:function(){var e=this;this.requestAnimationFrame((function(){return e.cancel()}))}},{key:"onDelete",value:(t=Wr()(Vr.a.mark((function e(){var t,n,r,i;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t=this).confirmDelete){e.next=13;break}return n=t.editor,r=n.autoClose,n.autoClose=!1,t.deleteConfirmationPromise=zd.confirm({title:"L{TaskEdit.ConfirmDeletionTitle}",message:"L{TaskEdit.ConfirmDeletionMessage}"}),e.next=7,t.deleteConfirmationPromise;case 7:i=e.sent,n.autoClose=r,t.deleteConfirmationPromise=null,i===zd.yesButton&&t.delete(),e.next=14;break;case 13:t.requestAnimationFrame((function(){return t.delete()}));case 14:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"onDragCreateEnd",value:function(e){var t=e.newEventRecord,n=e.resourceRecord;e.proxyElement;this.disabled||(this.scheduler.onEventCreated(t),this.editEvent(t,n))}},{key:"getEventMenuItems",value:function(e){var t=this,n=e.eventRecord,r=e.resourceRecord,i=e.items;this.scheduler.readOnly||(i.editEvent={text:"L{Edit task}",localeClass:this,icon:"b-icon b-icon-edit",weight:-200,disabled:this.disabled,onItem:function(){return t.editEvent(n,r)}})}},{key:"onEventEnterKey",value:function(e){var t=e.assignmentRecord,n=e.eventRecord;t?this.editEvent(n,t.resource):n&&this.editEvent(n,n.resource)}},{key:"trigger",value:function(e,t){if(/task/i.test(e)){var n,r=(n=this.scheduler).trigger.apply(n,arguments),i=e.replace(/task/,"event").replace(/Task/,"Event");t.eventRecord=t.taskRecord,t.eventRecords=[t.taskRecord];var o=this.scheduler.trigger(i,t);return r&&o}return we()(pe()(u.prototype),"trigger",this).apply(this,arguments)}},{key:"scheduler",get:function(){return this.client}},{key:"isValid",get:function(){return this.editor.eachWidget((function(e){return!!(!0===e.isValid||e.hidden||e.disabled||e instanceof Pf&&!e.name)||!1!==e.isValid}),!0)}},{key:"project",get:function(){return this.scheduler.project}},{key:"isEditing",get:function(){return!!this._editing}}],[{key:"$name",get:function(){return"TaskEdit"}},{key:"pluginConfig",get:function(){return{chain:["getEventMenuItems","onEventEnterKey"],assign:["editEvent"]}}},{key:"defaultConfig",get:function(){var e;return{triggerEvent:"eventdblclick",editorClassMap:(e={},ke()(e,tS.SchedulerBasic,"schedulertaskeditor"),ke()(e,tS.SchedulerPro,"schedulertaskeditor"),ke()(e,tS.Gantt,"gantttaskeditor"),e),editorClass:null,editorConfig:null,showDeleteButton:!0,confirmDelete:!0,saveAndCloseOnEnter:!0,weekStartDay:null}}},{key:"configurable",get:function(){return{items:null}}}]),u}(qr.mixin(_a,ZO));function dL(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}fL._$name="TaskEdit",fv.registerFeature(fL,!0,"SchedulerPro");var hL=function(e){fe()(n,e);var t=dL(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"toggleEmptyText",value:function(){this.bodyContainer&&Cr.toggleClasses(this.bodyContainer,"b-grid-empty",!(this.rowManager.rowCount||this.project.isLoadingOrSyncing))}},{key:"internalAddEvent",value:function(e,t,r){var i=this;if(!this.taskEdit||!this.taskEdit.isEditing)return we()(pe()(n.prototype),"internalAddEvent",this).call(this,e,t,r);this.on({aftertaskedit:function(){return we()(pe()(n.prototype),"internalAddEvent",i).call(i,e,t,r)},once:!0})}},{key:"taskStore",get:function(){return this.project.eventStore}}],[{key:"$name",get:function(){return"SchedulerProBase"}},{key:"type",get:function(){return"schedulerprobase"}},{key:"configurable",get:function(){return{projectModelClass:NO}}},{key:"isSchedulerPro",get:function(){return!0}}]),n}(_A);function vL(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}hL.initClass(),y.a.setVersion("schedulerpro","4.0.2"),hL._$name="SchedulerProBase";var pL=function(e){fe()(n,e);var t=vL(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"onDestroy",value:function(){this.scaleWidget.destroy()}},{key:"applyValue",value:function(e,t,r){return"scalePoints"===t&&(this.scaleWidget[t]=r),we()(pe()(n.prototype),"applyValue",this).apply(this,arguments)}},{key:"renderer",value:function(e){var t=e.cellElement,n=this.scaleWidget;n.height=this.grid.rowHeight,n.refresh();var r=n.element.cloneNode(!0);r.removeAttribute("id"),r.classList.remove("b-hide-offscreen"),t.innerHTML="",t.appendChild(r)}},{key:"width",set:function(e){sc()(pe()(n.prototype),"width",e,this,!0),this.scaleWidget.width=e},get:function(){return we()(pe()(n.prototype),"width",this)}},{key:"scaleWidget",get:function(){var e=this;return e._scaleWidget||(e._scaleWidget=new wh({owner:e.grid,appendTo:oc.floatRoot,cls:"b-hide-offscreen",align:"right",scalePoints:e.scalePoints,monitorResize:!1}),Object.defineProperties(e._scaleWidget,{width:{get:function(){return e.width},set:function(t){this.element.style.width="".concat(t,"px"),this._width=e.width}},height:{get:function(){return this._height},set:function(e){this.element.style.height="".concat(e,"px"),this._height=e}}}),e._scaleWidget.width=e.width),e._scaleWidget}}],[{key:"$name",get:function(){return"ScaleColumn"}},{key:"type",get:function(){return"scale"}},{key:"isScaleColumn",get:function(){return!0}},{key:"fields",get:function(){return["scalePoints"]}},{key:"defaults",get:function(){return{text:"",width:40,minWidth:40,cellCls:"b-scale-cell",editor:!1,sortable:!1,groupable:!1,filterable:!1,scalePoints:[{value:4},{value:8,text:8}]}}}]),n}(Dh);function gL(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Th.registerColumnType(pL),pL._$name="ScaleColumn";var yL=function(e){fe()(n,e);var t=gL(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e){var t=this;t.allocationReportByResource=new Map,we()(pe()(n.prototype),"construct",this).call(this,e),t.scheduleRefreshRows=t.createOnFrame(t.refreshRows,[],t,!0),t.horizontal.refreshResourcesWhenReady=t.horizontal.onAssignmentStoreChange=t.horizontal.renderer=function(){},t.rowManager.on({beforeRowHeight:"onBeforeRowHeight",thisObj:t}),t.timeAxis.on({endReconfigure:"onTimeAxisEndReconfigure",thisObj:this})}},{key:"onDestroy",value:function(){this.histogramWidget.destroy()}},{key:"updateProject",value:function(e){this.detachListeners("resourceHistogramProject"),this._project=e,e.on({name:"resourceHistogramProject",startApplyResponse:"onProjectStartApplyResponse",refresh:"internalOnProjectRefresh",thisObj:this}),this.store=e.resourceStore}},{key:"scheduleRefreshRows",value:function(){}},{key:"getEventsToRender",value:function(){}},{key:"getRowHeight",value:function(){return this.rowHeight}},{key:"buildScalePointText",value:function(e){return"".concat(e.value).concat(Zt.getShortNameOfUnit(e.unit))}},{key:"generateScalePoints",value:function(){var e,t=this.project,n=this.timeAxis,r=[],i=n.unit,o=n.increment;1===o&&(i=Zt.getSmallerUnit(i),o=Math.round(t.convertDuration(o,n.unit,i)));for(var a=0,s=[7,5,4,3,2];a<s.length;a++){var u=s[a];if(!(o%u)){e=o/u;break}}e||(e=o);for(var c=e;c<=o;c+=e)r.push({value:c});var l=r[r.length-1];return l.unit=i,l.text=this.buildScalePointText(l),r}},{key:"updateViewPreset",value:function(e){var t=this;t._updatingViewPreset=!0,we()(pe()(n.prototype),"updateViewPreset",this).apply(this,arguments),t._updatingViewPreset=!1,t.project.isInitialCommitPerformed&&t.isPainted&&t.onTimeAxisEndReconfigure()}},{key:"buildTicksIdentifier",value:function(){var e=this,t=e.project.getGraph();return e.ticksIdentifier||(e.ticksIdentifier=t.addIdentifier(kb.new())),e.ticksIdentifier.writeToGraph(t,new FS({unspecifiedTimeIsWorking:!1,intervals:e.timeAxis.ticks.map((function(e){return{startDate:e.startDate,endDate:e.endDate,isWorking:!0}}))})),e.collectTicksWidth(),e.ticksIdentifier}},{key:"collectTicksWidth",value:function(){for(var e=this.timeAxis.ticks,t=e[0].endDate-e[0].startDate,n={0:t},r=t,i=!0,o=1,a=e.length;o<a;o++){var s=e[o],u=s.endDate-s.startDate;t!==u&&(i=!1),r+=u,n[o]=u}if(i)this.ticksWidth=null;else{for(var c={},l=0,f=e.length;l<f;l++)c[l]=n[l]/r;this.ticksWidth=c}}},{key:"resumeRefresh",value:function(e){we()(pe()(n.prototype),"resumeRefresh",this).call(this,!1),!this.refreshSuspended&&e&&(this.rowManager.topRow?this.refreshWithTransition():this.rowManager.reinitialize())}},{key:"internalOnProjectRefresh",value:function(){this.ticksIdentifier||this.onTimeAxisEndReconfigure(),this.resumeRefresh(!this.rowManager.topRow)}},{key:"onProjectStartApplyResponse",value:function(){this.suspendRefresh()}},{key:"getRectClass",value:function(e,t,n,r){if("effort"===e.id)switch(!0){case n.isOverallocated:return"b-overallocated";case n.isUnderallocated:return"b-underallocated"}return""}},{key:"getEffortText",value:function(e,t){var n=this.scaleUnit,r=this.project;t=t||n;var i=Zt.getShortNameOfUnit(t),o=r.convertDuration(e,KC.Millisecond,t);return"".concat(parseFloat(o.toFixed(1))).concat(i)}},{key:"getBarTipEffortUnit",value:function(e,t,n,r){var i=this.effortUnit,o=this.barTipEffortUnit,a=this.timeAxis,s=o||i;return Zt.compareUnits(a.unit,s)<0?a.unit:s}},{key:"getBarTip",value:function(e,t,n,r){var i=this.owner,o=i.showBarTip,a=i.timeAxis,s="";if(o&&n.effort){var u=i.getBarTipEffortUnit.apply(i,arguments),c=i.getEffortText(n.effort,u),l=i.getEffortText(n.maxEffort,u),f="L",d=i.L("L{barTipInRange}");0==Zt.compareUnits(a.unit,KC.Day)?d=i.L("L{barTipOnDate}"):Zt.compareUnits(a.unit,KC.Second)<=0?f="HH:mm:ss A":Zt.compareUnits(a.unit,KC.Hour)<=0&&(f="LT"),s=d.replace("{resource}",n.resource.name).replace("{startDate}",Zt.format(n.tick.startDate,f)).replace("{endDate}",Zt.format(n.tick.endDate,f)).replace("{allocated}",c).replace("{available}",l)}return s}},{key:"getBarTextEffortUnit",value:function(e,t,n,r){var i=this.effortUnit,o=this.barTextEffortUnit,a=this.timeAxis,s=o||i;return Zt.compareUnits(a.unit,s)<0?a.unit:s}},{key:"getBarText",value:function(e,t){var n=this.owner.showBarText,r="";if(n&&e.effort){var i,o=(i=this.owner).getBarTextEffortUnit.apply(i,arguments);r=this.owner.getEffortText(e.effort,o)}return r}},{key:"onTimeAxisEndReconfigure",value:function(){if(!this._updatingViewPreset){var e=this.timeAxis,t=e.unit,n=e.increment;t===this._lastTimeAxisUnit&&n===this._lastTimeAxisIncrement||(this._lastTimeAxisUnit=t,this._lastTimeAxisIncrement=n,this._generatedScalePoints=this.scalePoints=this.generateScalePoints()),this.buildTicksIdentifier()}}},{key:"onBeforeRowHeight",value:function(e){var t=e.height;if(this._timeAxisColumn){var n=this.histogramWidget;n.height=t,n.onElementResize(n.element)}}},{key:"onTimeAxisViewModelUpdate",value:function(){var e=this.histogramWidget;e.width=this.timeAxisViewModel.totalSize,e.onElementResize(e.element)}},{key:"renderResourceAllocationInfo",value:function(e,t){if(this.ticksWidth)for(var n=0,r=e.length;n<r;n++)e[n].width=this.ticksWidth[n];var i=this.histogramWidget;i.data=e,i.refresh();var o=i.element.cloneNode(!0);o.removeAttribute("id"),o.classList.remove("b-hide-offscreen"),t.innerHTML="",t.appendChild(o)}},{key:"renderRows",value:function(){return!this.ticksIdentifier&&this.project.isInitialCommitPerformed&&(this.onTimeAxisEndReconfigure(),this.timeView.startDate&&this.timeView.endDate||(this.timeView.range={startDate:this.startDate,endDate:this.endDate})),we()(pe()(n.prototype),"renderRows",this).call(this,Array.prototype.slice.call(arguments))}},{key:"buildResourceAllocationReport",value:function(e){return MO.new({resource:e,ticks:this.ticksIdentifier})}},{key:"renderResourceHistogram",value:function(e){var t=e.grid,n=e.cellElement,r=e.record;if(t.project.isInitialCommitPerformed&&!r.isSpecialRow){var i=t.allocationReportByResource,o=i.get(r);if(o)o.allocation&&(o.graph?t.renderResourceAllocationInfo(o.allocation,n):i.delete(r));else{var a=t.project.getGraph(),s=t.buildResourceAllocationReport(r),u=r.observers,c=r.entities;i.set(r,s),a.addEntity(s),c.add(s),u.add(a.observe(Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,s.$.allocation;case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})),(function(e){if(!t.isDestroying){var n=t.getCell({id:r.id,columnId:t.timeAxisColumn.id});t.renderResourceAllocationInfo(e,n)}})))}}}},{key:"updateLocalization",value:function(){var e=this;this._generatedScalePoints===this.scalePoints&&this.scalePoints&&this.scalePoints.forEach((function(t){t.text&&t.unit&&(t.text=e.buildScalePointText(t))})),we()(pe()(n.prototype),"updateLocalization",this).apply(this,arguments)}},{key:"scaleColumn",get:function(){return this.columns.query((function(e){return e.isScaleColumn}))[0]}},{key:"scalePoints",get:function(){return this._scalePoints},set:function(e){var t=this.project,n=this.histogramWidget,r=this.scaleColumn,i=e[e.length-1],o=i.value,a=i.unit;this.scaleUnit=a,this._scalePoints=e;var s=o;r&&(s+=r.scaleWidget.scaleMaxPadding*o);n.topValue=t.convertDuration(s,a,KC.Millisecond),r&&(r.scalePoints=e)}},{key:"columns",get:function(){return we()(pe()(n.prototype),"columns",this)},set:function(e){var t=this;sc()(pe()(n.prototype),"columns",e,this,!0),t.isDestroying||(t.timeAxisColumn.renderer=t.renderResourceHistogram,t.timeAxisColumn.cellCls="b-resourcehistogram-cell",t.columns.rootNode.insertChild({type:"scale"},t.timeAxisColumn))}},{key:"histogramWidget",get:function(){var e=this;if(!e._histogramWidget){var t=e.series;!e.showMaxEffort&&t.maxEffort&&(t.maxEffort=!1),e._histogramWidget=new gh({owner:e,appendTo:document.body,cls:"b-hide-offscreen b-resourcehistogram-histogram",height:e.rowHeight,width:e.timeAxisColumn?e.timeAxisColumn.width:0,omitZeroHeightBars:!0,data:[],getRectClass:e.getRectClass,getBarText:e.getBarText,getBarTip:e.getBarTip,series:t})}return e._histogramWidget}},{key:"showBarText",get:function(){return this._showBarText},set:function(e){this._showBarText=e,this.scheduleRefreshRows()}},{key:"showBarTip",get:function(){return this._showBarTip},set:function(e){this._showBarTip=e,this.scheduleRefreshRows()}},{key:"showMaxEffort",get:function(){return this._showMaxEffort},set:function(e){var t=this;if(t._showMaxEffort=e,t._histogramWidget){var n=t._histogramWidget.series;e?"object"===l()(e)?n.maxEffort=e:"object"===l()(t._seriesMaxEffort)?n.maxEffort=t._seriesMaxEffort:(n.maxEffort={type:"outline",field:"maxEffort"},n.maxEffort.id="maxEffort"):n.maxEffort&&(t._seriesMaxEffort=n.maxEffort,delete n.maxEffort),t.scheduleRefreshRows()}}}],[{key:"$name",get:function(){return"ResourceHistogram"}},{key:"type",get:function(){return"resourcehistogram"}},{key:"defaultConfig",get:function(){return{rowHeight:50,effortUnit:KC.Hour,barTextEffortUnit:null,barTipEffortUnit:null,showMaxEffort:!0,showBarText:!1,showBarTip:!1,series:{maxEffort:{type:"outline",field:"maxEffort"},effort:{type:"bar",field:"effort"}},features:{eventContextMenu:!1,eventFilter:!1,headerContextMenu:!1,scheduleTooltip:!1,scheduleMenu:!1,cellMenu:!1,nonWorkingTime:!0},getRectClass:null,getBarTip:null,getBarText:null,fixedRowHeight:!0}}}]),n}(hL);function mL(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}yL.initClass(),yL._$name="ResourceHistogram";var kL=function(e){fe()(r,e);var t,n=mL(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"internalUpdateRecord",value:(t=Wr()(Vr.a.mark((function e(t,n){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.run("calculateProjectedDuration",t.startDate,t.endDate)!==n.duration){e.next=3;break}return e.abrupt("return",!1);case 3:return e.abrupt("return",we()(pe()(r.prototype),"internalUpdateRecord",this).call(this,t,n));case 4:case"end":return e.stop()}}),e,this)}))),function(e,n){return t.apply(this,arguments)})}],[{key:"$name",get:function(){return"EventResize"}}]),r}(oT);function bL(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}kL._$name="EventResize",fv.registerFeature(kL,!0,"SchedulerPro");var wL=function(e){fe()(n,e);var t=bL(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"$name",get:function(){return"SchedulerPro"}},{key:"type",get:function(){return"schedulerpro"}}]),n}(hL);function CL(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}wL.initClass(),wL._$name="SchedulerPro";var SL=function(e){fe()(n,e);var t=CL(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"headerRenderer",value:function(e){var t=e.column,n=e.headerElement;if(!e.isExport){var r=t.columnCombo;r.render(n),r.picker.forElement=n}}},{key:"onKeyDown",value:function(e){"Enter"===e.key&&this.columnCombo.focus()}},{key:"updateLocalization",value:function(){this._columnCombo&&(this._columnCombo.destroy(),this._columnCombo=null),we()(pe()(n.prototype),"updateLocalization",this).call(this)}},{key:"columnCombo",get:function(){var e=this,t=e.grid.columns;return e._columnCombo||(e._columnCombo=new Xf({owner:e.grid,cls:"b-new-column-combo",placeholder:e.L("L{New Column}"),triggers:!1,autoExpand:!0,store:e.ganttColumnStore,displayField:"text",monitorResize:!1,picker:{align:{align:"t0-b0",axisLock:!0},minWidth:200,onItem:function(n){var r=new n.record.value({region:e.region},t);t.insert(t.indexOf(e),r),r.element.focus()}},syncInputFieldValue:function(){this.input.value=""},listeners:{keydown:function(e){e.event.stopImmediatePropagation()}}}))}},{key:"ganttColumnStore",get:function(){var e=this;return new No({data:Object.values(Th.columnTypes).reduce((function(e,t){return t.$meta.fields.exposedData||t.exposeProperties({}),t.isGanttColumn&&t.text&&e.push({id:t.type,text:t.optionalL(t.text),value:t}),e}),[]),filters:[function(t){return!e.grid.columns.some((function(e){return e.constructor===t.value}))}],sorters:[{field:"text"}]})}}],[{key:"$name",get:function(){return"AddNewColumn"}},{key:"type",get:function(){return"addnew"}},{key:"defaults",get:function(){return{text:"L{New Column}",cls:"b-new-column-column",draggable:!1,sortable:!1,exportable:!1,field:null,editor:null}}}]),n}(Dh);function DL(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Th.registerColumnType(SL),SL._$name="AddNewColumn";var RL=function(e){fe()(n,e);var t=DL(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"refreshCalendars",value:function(e){this.store.data=e.map((function(e){return{id:e.id,text:e.name}}))}},{key:"store",get:function(){return this._store||(this.store=new No),this._store},set:function(e){sc()(pe()(n.prototype),"store",e,this,!0)}},{key:"value",get:function(){return we()(pe()(n.prototype),"value",this)},set:function(e){e&&(e.isDefault&&e.isDefault()?e=null:e.id&&(e=e.id)),sc()(pe()(n.prototype),"value",e,this,!0)}}],[{key:"$name",get:function(){return"CalendarPicker"}},{key:"type",get:function(){return"calendarpicker"}}]),n}(Xf);function xL(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}RL.initClass(),RL._$name="CalendarPicker";var EL=function(e){fe()(n,e);var t=xL(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"afterConstruct",value:function(){var e=this;we()(pe()(n.prototype),"afterConstruct",this).call(this);var t=e.grid.project;e.defaultCalendar=t.defaultCalendar,e.refreshCalendars(),t.calendarManagerStore.on({changePreCommit:e.refreshCalendars,refresh:e.refreshCalendars,thisObj:e})}},{key:"refreshCalendars",value:function(){var e=this.grid.project;this.editor.refreshCalendars(e.calendarManagerStore.getRange())}},{key:"renderer",value:function(e){var t=e.value;if(t===this.defaultCalendar)return"";if(t&&t.id){var n=this.editor.store.getById(t.id);return n&&n[this.editor.displayField]||""}return""}}],[{key:"$name",get:function(){return"CalendarColumn"}},{key:"type",get:function(){return"calendar"}},{key:"isGanttColumn",get:function(){return!0}},{key:"defaults",get:function(){return{field:"calendar",text:"L{Calendar}",editor:{type:RL.type,clearable:!0,allowInvalid:!1}}}}]),n}(Dh);function TL(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Th.registerColumnType(EL),EL._$name="CalendarColumn";var ML=function(e){fe()(n,e);var t=TL(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e,t){var r=this;r.gantt=t.grid,we()(pe()(n.prototype),"construct",this).call(this,e,t),r.format?r.explicitFormat=!0:r.gantt.on({displayDateFormatChange:function(e){var t=e.format;r.explicitFormat||r.set("format",t)}})}},{key:"format",set:function(e){this.explicitFormat=!0,this.set("format",e)},get:function(){return this.explicitFormat&&this.data.format||this.gantt.displayDateFormat}}],[{key:"isGanttColumn",get:function(){return!0}},{key:"defaults",get:function(){return{instantUpdate:!0,width:130,step:null,format:"ll"}}}]),n}(Nh);function AL(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}ML._$name="GanttDateColumn";var PL=function(e){fe()(n,e);var t=AL(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"$name",get:function(){return"ConstraintDateColumn"}},{key:"type",get:function(){return"constraintdate"}},{key:"defaults",get:function(){return{field:"constraintDate",text:"L{Constraint Date}",width:146}}}]),n}(ML);function IL(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Th.registerColumnType(PL),PL._$name="ConstraintDateColumn";var OL=function(e){fe()(n,e);var t=IL(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"afterConstruct",value:function(){var e=this;we()(pe()(n.prototype),"afterConstruct",this).call(this),e.grid.on({startCellEdit:e.onStartCellEdit,finishCellEdit:e.onDoneCellEdit,cancelCellEdit:e.onDoneCellEdit,thisObj:e}),xe.createSequence(e.editor.updateLocalization,e.onEditorLocaleChange,e)}},{key:"onStartCellEdit",value:function(e){var t=e.editorContext,n=t.editor,r=t.record;n.inputField instanceof QO&&(n.inputField.store.filter((function(e){return r.run("isConstraintTypeApplicable",e.id)})),this._filterDetacher=function(){return n.inputField.store.clearFilters()})}},{key:"onDoneCellEdit",value:function(){this._filterDetacher&&this._filterDetacher()}},{key:"renderer",value:function(e){var t=e.value,n=null!=t&&"none"!==t&&this.editor.store.getById(t);return n&&n.text||""}},{key:"onEditorLocaleChange",value:function(){this.grid.refreshColumn(this)}}],[{key:"$name",get:function(){return"ConstraintTypeColumn"}},{key:"type",get:function(){return"constrainttype"}},{key:"isGanttColumn",get:function(){return!0}},{key:"defaults",get:function(){return{field:"constraintType",text:"L{Constraint Type}",width:146,editor:{type:QO.type,clearable:!0,allowInvalid:!1},filterable:{filterField:{type:"constrainttypepicker"}}}}}]),n}(Dh);function FL(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Th.registerColumnType(OL),OL._$name="ConstraintTypeColumn";var LL=function(e){fe()(n,e);var t=FL(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"$name",get:function(){return"DeadlineDateColumn"}},{key:"type",get:function(){return"deadlinedate"}},{key:"defaults",get:function(){return{field:"deadlineDate",text:"L{Deadline}",width:146}}}]),n}(ML);function jL(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Th.registerColumnType(LL),LL._$name="DeadlineDateColumn";var _L=function(e){fe()(n,e);var t=jL(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"canEdit",value:function(e){return!1}}],[{key:"$name",get:function(){return"EarlyEndDateColumn"}},{key:"type",get:function(){return"earlyenddate"}},{key:"defaults",get:function(){return{field:"earlyEndDate",text:"L{Early End}"}}}]),n}(ML);function BL(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Th.registerColumnType(_L),_L._$name="EarlyEndDateColumn";var HL=function(e){fe()(n,e);var t=BL(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"canEdit",value:function(e){return!1}}],[{key:"$name",get:function(){return"EarlyStartDateColumn"}},{key:"type",get:function(){return"earlystartdate"}},{key:"defaults",get:function(){return{field:"earlyStartDate",text:"L{Early Start}"}}}]),n}(ML);function $L(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Th.registerColumnType(HL),HL._$name="EarlyStartDateColumn";var NL=function(e){fe()(n,e);var t=$L(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"canEdit",value:function(e){return e.isLeaf}},{key:"defaultEditor",get:function(){return{type:iF.type,name:this.field}}}],[{key:"$name",get:function(){return"EffortColumn"}},{key:"type",get:function(){return"effort"}},{key:"defaults",get:function(){return{field:"fullEffort",text:"L{Effort}"}}}]),n}(zO);function VL(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Th.registerColumnType(NL),NL._$name="EffortColumn";var zL=function(e){fe()(n,e);var t=VL(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"canEdit",value:function(e){return e.isLeaf}},{key:"defaultEditor",get:function(){var e=we()(pe()(n.prototype),"defaultEditor",this);return e.type="enddate",e}},{key:"editor",get:function(){var e=this.data.editor,t=e&&!(e instanceof oc);return(e=we()(pe()(n.prototype),"editor",this))&&t&&(e.project=this.gantt.project),e}}],[{key:"$name",get:function(){return"EndDateColumn"}},{key:"type",get:function(){return"enddate"}},{key:"defaults",get:function(){return{field:"endDate",text:"L{Finish}"}}}]),n}(ML);function WL(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Th.registerColumnType(zL),zL._$name="EndDateColumn";var GL=function(e){fe()(n,e);var t=WL(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"canEdit",value:function(e){return!1}}],[{key:"$name",get:function(){return"LateEndDateColumn"}},{key:"type",get:function(){return"lateenddate"}},{key:"defaults",get:function(){return{field:"lateEndDate",text:"L{Late End}"}}}]),n}(ML);function YL(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Th.registerColumnType(GL),GL._$name="LateEndDateColumn";var UL=function(e){fe()(n,e);var t=YL(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"canEdit",value:function(e){return!1}}],[{key:"$name",get:function(){return"LateStartDateColumn"}},{key:"type",get:function(){return"latestartdate"}},{key:"defaults",get:function(){return{field:"lateStartDate",text:"L{Late Start}"}}}]),n}(ML);function qL(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Th.registerColumnType(UL),UL._$name="LateStartDateColumn";var KL=function(e){fe()(n,e);var t=qL(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"$name",get:function(){return"ManuallyScheduledColumn"}},{key:"type",get:function(){return"manuallyscheduled"}},{key:"isGanttColumn",get:function(){return!0}},{key:"defaults",get:function(){return{field:"manuallyScheduled",text:"L{Manually scheduled}"}}}]),n}(Hh);function XL(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Th.registerColumnType(KL),KL._$name="ManuallyScheduledColumn";var ZL=function(e){fe()(n,e);var t=XL(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"$name",get:function(){return"MilestoneColumn"}},{key:"type",get:function(){return"milestone"}},{key:"isGanttColumn",get:function(){return!0}},{key:"defaults",get:function(){return{field:"milestone",text:"L{Milestone}"}}}]),n}(Hh);function JL(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Th.registerColumnType(ZL),ZL._$name="MilestoneColumn";var QL=function(e){fe()(n,e);var t=JL(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"$name",get:function(){return"NameColumn"}},{key:"type",get:function(){return"name"}},{key:"isGanttColumn",get:function(){return!0}},{key:"defaults",get:function(){return{htmlEncode:!1,width:200,field:"name",text:"L{Name}"}}}]),n}(nv);function ej(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Th.registerColumnType(QL),QL._$name="NameColumn";var tj=function(e){fe()(n,e);var t=ej(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"renderer",value:function(e){return(e.value||"").trim()}},{key:"disableHtmlEncode",get:function(){return!0}}],[{key:"$name",get:function(){return"NoteColumn"}},{key:"type",get:function(){return"note"}},{key:"isGanttColumn",get:function(){return!0}},{key:"defaults",get:function(){return{field:"note",text:"L{Note}",width:150,editor:{type:"textareafield",inline:!1}}}}]),n}(Dh);function nj(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Th.registerColumnType(tj),tj._$name="NoteColumn";var rj=function(e){fe()(n,e);var t=nj(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e){we()(pe()(n.prototype),"construct",this).apply(this,arguments),this.showCircle&&(this.htmlEncode=!1)}},{key:"defaultRenderer",value:function(e){var t=e.record.renderedPercentDone;if(this.showCircle){var n=.8*this.grid.rowHeight;return{className:"b-percentdone-circle",style:{animationDelay:"-".concat(t-.1,"s"),width:n,height:n},dataset:{value:t}}}return t+this.unit}},{key:"canEdit",value:function(e){return e.isLeaf}}],[{key:"$name",get:function(){return"PercentDoneColumn"}},{key:"type",get:function(){return"percentdone"}},{key:"isGanttColumn",get:function(){return!0}},{key:"fields",get:function(){return["showCircle"]}},{key:"defaults",get:function(){return{field:"percentDone",text:"L{% Done}",unit:"%",step:1,min:0,max:100,width:90}}}]),n}(Gh);function ij(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Th.registerColumnType(rj),rj._$name="PercentDoneColumn";var oj={from:[2,3,0,1],to:[1,0,3,2]},aj=function(){return new RegExp("(".concat(sj.join("|"),")?((?:[+-])\\d+[a-z]*)?"),"i")},sj=["SS","SF","FS","FF"],uj=aj(),cj=function(e){fe()(n,e);var t=ij(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e){var t=this,r=(e.ourSide,e.otherSide);t.dependencies=new no({extraKeys:r}),t.startCollection=new no({extraKeys:r}),we()(pe()(n.prototype),"construct",this).call(this,e),t.delimiterRegEx=new RegExp("\\s*".concat(t.delimiter,"\\s*")),rt.on({locale:function(){sj=t.L("L{DependencyType.short}"),uj=aj(),t.syncInputFieldValue()},thisObj:t})}},{key:"internalOnInput",value:function(){this.isValid?(this.clearError(),Of.prototype.internalOnInput.call(this)):this.setError("L{invalidDependencyFormat}")}},{key:"onInternalKeyDown",value:function(e){var t=e.key;"Enter"!==t&&we()(pe()(n.prototype),"onInternalKeyDown",this)&&we()(pe()(n.prototype),"onInternalKeyDown",this).call(this,e),this.pickerVisible&&"ArrowDown"===t&&this.filterField.focus()}},{key:"onTriggerClick",value:function(){this.pickerVisible?we()(pe()(n.prototype),"onTriggerClick",this).call(this):this.doFilter(this.filterInput?this.filterInput.value:null)}},{key:"changePicker",value:function(e,t){var r=this,i=r.input,o=r.filterField||(r.filterField=new Of({cls:"b-dependency-list-filter",owner:r,clearable:!0,placeholder:"Filter",triggers:{filter:{cls:"b-icon b-icon-filter",align:"start"}},listeners:{input:function(e){var t=e.value;r.input=a,r.filterList(t),r.input=i},clear:function(){r.input=a,r.filterList(),r.input=i}}})),a=r.filterInput=o.input,s=n.reconfigure(t,e?F.merge({owner:r,store:r.store,cls:"b-dependency-list ".concat(r.listCls),itemTpl:r.listItemTpl,forElement:r[r.pickerAlignElement],align:{anchor:r.overlayAnchor,target:r[r.pickerAlignElement]},navigator:{keyEventTarget:a,processEvent:function(e){if("Escape"!==e.key)return e;r.hidePicker()}},onItem:r.onPredecessorClick.bind(r),getItemClasses:function(e){var t=Wf.prototype.getItemClasses.call(this,e),n=r.dependencies.getBy(r.otherSide+"Event",e);return t+(n?" b-selected b-".concat(n.getConnectorString(1).toLowerCase()):"")}},e):null,r);return s?o.render(s.contentElement):r.destroyProperties("filterField"),s}},{key:"showPicker",value:function(e){this.store.fillFromMaster(),we()(pe()(n.prototype),"showPicker",this).call(this,e)}},{key:"onPickerShow",value:function(e){var t=e.source,r=this,i=r.filterField,o=r.input;t.minWidth=r[r.pickerAlignElement].offsetWidth,t.contentElement.insertBefore(i.element,t.contentElement.firstChild),r.input=r.filterInput,we()(pe()(n.prototype),"onPickerShow",this).call(this),r.input=o}},{key:"listItemTpl",value:function(e){return'<div class="b-predecessor-item-text">'.concat(e.name,'</div>\n            <div class="b-sch-box b-from" data-side="from"></div>\n            <div class="b-sch-box b-to" data-side="to"></div>')}},{key:"onPredecessorClick",value:function(e){var t=e.source,n=e.item,r=e.record,i=e.event,o=this,a=o.dependencies,s=i.target.closest(".b-sch-box"),u=s&&s.dataset.side,c=a.getBy(o.otherSide+"Event",r);if(n.dataset.noselect=!0,c&&!s)a.remove(c);else if(c){var l=c,f=l.id,d=l.type;(c=c.copy({id:f,type:oj[u][d]},{skipFieldIdentifiers:!0}))["".concat(o.otherSide,"Event")]=r,a.add(c)}else{var h;a.add(o.dependencyStore.createRecord((h={},ke()(h,"".concat(o.otherSide,"Event"),r),ke()(h,"".concat(o.ourSide,"Event"),o.task),h),!0))}o.syncInputFieldValue(),t.refresh()}},{key:"parseDependencies",value:function(e){for(var t=this,n=t.grid,r=t.task,i=t.store,o=t.dependencyStore,a=e.split(t.delimiterRegEx),s=o.modelClass,u=[],c=0;c<a.length;c++){var l=a[c];if(l){for(var f,d=l.length+1,h=void 0,v=null;d&&!v;d--)h=l.substr(0,d),v=i.getById(h);if(!v)return null;var p=l.substr(d+1),g=(f={},ke()(f,"".concat(t.otherSide,"Event"),v),ke()(f,"".concat(t.ourSide,"Event"),r),ke()(f,"type",s.Type.EndToStart),f);if(p.length){var y=uj.exec(p);if(!y||!y[1]&&!y[2])return null;if(y[1]&&(g.type=sj.indexOf(y[1].toUpperCase())),y[2]){var m=Zt.parseDuration(y[2],!0,n.timeAxis.unit);g.lag=m.magnitude,g.lagUnit=m.unit}}u.push(g)}}return u}},{key:"store",set:function(e){var t=this;(e=e.makeChained((function(e){return!t.record||e.id!==t.record.id}))).tree=!1,sc()(pe()(n.prototype),"store",e,this,!0)},get:function(){return we()(pe()(n.prototype),"store",this)}},{key:"isValid",get:function(){return Boolean(!this.task||this.parseDependencies(this.input.value))}},{key:"value",set:function(e){var t=this,n=t.dependencies,r=t.startCollection;if("string"==typeof e){if(t.input.value=e,!(e=t.parseDependencies(e)))return void t.syncInvalid();for(var i=0;i<e.length;i++){var o=new t.dependencyStore.modelClass(e[i]),a=r.getBy(t.otherSide,o.fromEvent);a&&((a=a.copy(a.id)).type=o.type,a.fullLag=o.fullLag),e[i]=a||o}}else t.startCollection.clear(),t.startCollection.values=e;n.clear(),n.values=e,t.inputting||t.syncInputFieldValue()},get:function(){return this.dependencies.values}},{key:"inputValue",get:function(){return this.constructor.predecessorsToString(this.dependencies.values,this.otherSide,this.delimiter)}},{key:"task",get:function(){var e;return null===(e=this.owner)||void 0===e?void 0:e.record}}],[{key:"predecessorsToString",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:";",r=function(e){var n=e[t+"Event"];return n&&n.isModel?n.id:n||""};if(e&&e.length){var i=e.sort((function(e,t){return r(e)-r(t)})).map((function(e){return"".concat(r(e)).concat(pP.getLocalizedDependencyType(e.getConnectorString())).concat(e.getLag())}));return i.join(n)}return""}},{key:"$name",get:function(){return"DependencyField"}},{key:"type",get:function(){return"dependencyfield"}},{key:"configurable",get:function(){return{listCls:"b-predecessor-list",displayField:"name",valueField:"name",picker:{floating:!0,scrollAction:"realign",itemsFocusable:!1,activateOnMouseover:!0,align:{align:"t0-b0",axisLock:!0},maxHeight:324,minHeight:161,scrollable:{overflowY:!0},autoShow:!1,focusOnHover:!1},delimiter:";",dependencyStore:null,otherSide:null,ourSide:null}}}]),n}(Xf);function lj(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}cj.initClass(),cj._$name="DependencyField";var fj=function(e){return!e.project},dj=function(e){return e},hj=function(){var e=Wr()(Vr.a.mark((function e(t,n,r){var i;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(i=t.shift())){e.next=9;break}return e.t0=r,e.next=5,n.getProject().isValidExistingDependency(i);case 5:return e.t1=e.sent,e.t0.push.call(e.t0,e.t1),e.next=9,hj(t,n,r);case 9:case"end":return e.stop()}}),e)})));return function(t,n,r){return e.apply(this,arguments)}}(),vj=function(e){fe()(r,e);var t,n=lj(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"afterConstruct",value:function(){we()(pe()(r.prototype),"afterConstruct",this).call(this)}},{key:"finalizeCellEdit",value:(t=Wr()(Vr.a.mark((function e(t){var n,r,i,o,a,s,u,c,l,f,d;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.grid,r=t.record,i=t.inputField,o=t.value,a=t.oldValue,s=t.editorContext,!r||!o){e.next=9;break}return o=o.slice(),u=s.editor.dataField,c=o.filter(fj),l=[],e.next=6,hj(c,n.dependencyStore,l);case 6:return(f=l.every(dj))?(d="set".concat(E.capitalize(u)),r[d]?r[d](o):r[u]=o):(i.value=a,lc.toast(s.column.L("L{Invalid dependency}"))),e.abrupt("return",f);case 9:case"end":return e.stop()}}),e)}))),function(e){return t.apply(this,arguments)})},{key:"defaultEditor",get:function(){var e=this.grid,t="predecessors"===this.field;return{type:"dependencyfield",grid:e,name:this.field,delimiter:this.delimiter,ourSide:t?"to":"from",otherSide:t?"from":"to",store:e.eventStore||e.taskStore,dependencyStore:e.dependencyStore}}}],[{key:"$name",get:function(){return"DependencyColumn"}},{key:"type",get:function(){return"dependency"}},{key:"fields",get:function(){return[{name:"delimiter",defaultValue:";"}]}},{key:"defaults",get:function(){return{htmlEncode:!1,width:120,renderer:function(e){var t=e.record;return cj.predecessorsToString(t[this.field],"predecessors"===this.field?"from":"to",this.delimiter)}}}}]),r}(_a(Dh));function pj(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Th.registerColumnType(vj),vj._$name="DependencyColumn";var gj=function(e){fe()(n,e);var t=pj(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"$name",get:function(){return"PredecessorColumn"}},{key:"type",get:function(){return"predecessor"}},{key:"isGanttColumn",get:function(){return!0}},{key:"defaults",get:function(){return{text:"L{Predecessors}",field:"predecessors"}}}]),n}(vj);function yj(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Th.registerColumnType(gj),gj._$name="PredecessorColumn";var mj=function(e){fe()(n,e);var t=yj(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"name",get:function(){return this.resource?this.resource.name:""}},{key:"assigned",get:function(){return this.event&&this.firstStore.projectEvent===this.event},set:function(e){var t=this;e?t.assigned||t.set({event:t.firstStore.projectEvent,units:t.units||100}):t.set({event:null,units:0})}}],[{key:"fields",get:function(){return[{name:"assignment",type:"object"},{name:"resource",type:"object"},{name:"event",type:"object"},{name:"units",type:"number",defaultValue:0}]}}]),n}(Bi);mj._$name="AssignmentsManipulationModel";var kj=Rf.defineParser,bj=Rf.alt,wj=Rf.seq,Cj=Rf.string,Sj=Rf.regexp,Dj=Rf.succeed,Rj=Rf.red,xj=Rf.isSuccess,Ej=kj(Rj(Sj("[^\\[\\,]+"),(function(e){return{name:e.trim(),units:100,match:e}}))),Tj=kj(Rj(Sj("[0-9\\s]+"),(function(e){return{value:e.split(/\s*/).join(""),match:e}}))),Mj=kj(Rj(bj(Cj("."),Cj(",")),(function(e){return{value:e,match:e}}))),Aj=kj(bj(Rj(wj((function(){return Tj}),(function(){return Mj}),(function(){return Tj})),(function(e,t,n){return{value:Number("".concat(e.value,".").concat(n.value)),match:[e.match,t.match,n.match].join("")}})),Rj(wj((function(){return Mj}),(function(){return Tj})),(function(e,t){return{value:Number("0.".concat(t.value)),match:[e.match,t.match].join("")}})),Rj((function(){return Tj}),(function(e){return{value:Number("".concat(e.value)),match:e.match}})))),Pj=kj(bj(Rj(wj((function(){return Aj}),Sj("\\s*\\%")),(function(e,t){return{value:e.value,match:[e.match,t].join("")}})),Rj((function(){return Aj}),(function(e){return{value:e.value,match:e.match}})))),Ij=kj(Rj(wj(Sj("\\s*\\[\\s*"),(function(){return Pj}),Sj("\\s*\\]")),(function(e,t,n){return{units:t.value,match:[e,t.match,n].join("")}}))),Oj=kj(Rj(Sj("\\s*,\\s*"),(function(e){return{value:e,match:e}}))),Fj=kj(bj(wj((function(){return Ej}),(function(){return Ij}),bj(wj((function(){return Oj}),(function(){return Fj})),Dj(""))),wj((function(){return Ej}),bj(wj((function(){return Oj}),(function(){return Fj})),Dj(""))))),Lj=function(e){var t=!1,n=[],r="";Fj(e,(function(e){if(xj(e)){var i=ye()(e,3),o=i[1],a=i[2];o.length>n.length&&(n=o,r=a,t=!0)}}));var i=0;return!!t&&{rest:r,assignments:n.reduce((function(e,t){var n;return"object"==l()(t)&&(Object.prototype.hasOwnProperty.call(t,"name")?(n=Object.assign({position:i},t),e.push(n)):(n=e[e.length-1],Object.prototype.hasOwnProperty.call(t,"units")&&(n.units=t.units),n.match+=t.match),i+=t.match.length),e}),[])}},jj=function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n="";return e.assignments&&(n+=e.assignments.reduce((function(e,n){var r=n.name,i=n.units,o=n.match;return e+=o&&t?o:(e.length?", ":"")+"".concat(r," [").concat(i,"%]")}),n)),e.rest&&(n+=e.rest),t||(n=n.trim()),n},_j={parse:Lj,compose:jj,normalize:function(e){return jj(Lj(e))}};function Bj(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var Hj=_j.compose,$j=function(e){fe()(r,e);var t,n=Bj(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"afterConfigure",value:function(){we()(pe()(r.prototype),"afterConfigure",this).call(this),this.addSorter({fn:this.defaultSort.bind(this)})}},{key:"fillFromMaster",value:function(){this.projectEvent&&(this.data=this.resourceStore.map((function(e){return{resource:e}})))}},{key:"applyChanges",value:(t=Wr()(Vr.a.mark((function e(){var t,n,r,i,o,a,s,u,c;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=(t=this).projectEvent,r=t.assignmentStore,i=[],o=t.query((function(e){return e.event&&e.units}),!0),a=t.originalAssignmentManipulationRecords.filter((function(e){return!o.includes(e)})),!o.length&&!a.length){e.next=16;break}return u=n.project.replica,c=u.projectRefreshThreshold,o.forEach((function(e){var t=e.assignment;t?t.units=e.units:i.push({resource:e.resource,event:e.event,units:e.units})})),t.commit(),r.remove(a.map((function(e){return e.assignment}))),r.add(i),u.projectRefreshThreshold=0,e.next=10,n.commitAsync();case 10:s=e.sent,t._projectEventGeneration--,u.projectRefreshThreshold=c,r.trigger("refresh",{action:"dataset"}),t.floatAssignedResources&&t.sort(),t.trigger("changesApplied");case 16:return e.abrupt("return",s);case 17:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"getResourceAssignment",value:function(e){return this.storage.getBy("resource",e)}},{key:"toValueString",value:function(){var e=this.activeAssignments;return Hj({rest:"",assignments:e})}},{key:"defaultSort",value:function(e,t){return this.floatAssignedResources?!t.event&&e.event?-1:!e.event&&t.event?1:e.name.localeCompare(t.name):e.name.localeCompare(t.name)}},{key:"onUpdate",value:function(e){var t=e.changes;this.isConfiguring||Object.hasOwnProperty.call(t,"event")&&this.floatAssignedResources&&this.liveFloatAssignedResources&&this.sort()}},{key:"projectEvent",get:function(){return this._projectEvent},set:function(e){var t=this;if(e!=t._projectEvent||e&&e.generation!==t._projectEventGeneration)if(t._projectEvent=e,t._projectEventGeneration=e.generation,e){t.fillFromMaster();var n=e.assignments,r=[];n.forEach((function(n){var i=t.find((function(e){return e.resource===n.resource}));i&&(i.set({assignment:n,event:e,units:n.units||0}),r.push(i))})),t.originalAssignmentManipulationRecords=r,t.acceptChanges(),t.sort()}else t.removeAll()}},{key:"floatAssignedResources",get:function(){return this._floatAssignedResources},set:function(e){e!==this.floatAssignedResources&&(this._floatAssignedResources=e,this.sort())}},{key:"assignmentStore",get:function(){return this.projectEvent&&this.projectEvent.getAssignmentStore()||null}},{key:"resourceStore",get:function(){return this.projectEvent&&this.projectEvent.getResourceStore()||null}},{key:"activeAssignments",get:function(){var e=this.projectEvent;return this.query((function(t){return t.event===e}))}}],[{key:"defaultConfig",get:function(){return{modelClass:mj,storeId:"assignmentsmanipulation",storage:{extraKeys:["resource"]},callOnFunctions:!0,projectEvent:null,floatAssignedResources:!0,liveFloatAssignedResources:!1}}}]),r}(No);$j._$name="AssignmentsManipulationStore";var Nj=tt.mergeLocales(lF,{Object:{Save:"Save"},AddNewColumn:{"New Column":"New Column"},CalendarColumn:{Calendar:"Calendar"},EarlyStartDateColumn:{"Early Start":"Early Start"},EarlyEndDateColumn:{"Early End":"Early End"},LateStartDateColumn:{"Late Start":"Late Start"},LateEndDateColumn:{"Late End":"Late End"},TotalSlackColumn:{"Total Slack":"Total Slack"},ConstraintDateColumn:{"Constraint Date":"Constraint Date"},ConstraintTypeColumn:{"Constraint Type":"Constraint Type"},DeadlineDateColumn:{Deadline:"Deadline"},DependencyColumn:{"Invalid dependency":"Invalid dependency found, change reverted"},DurationColumn:{Duration:"Duration"},EffortColumn:{Effort:"Effort"},EndDateColumn:{Finish:"Finish"},EventModeColumn:{"Event mode":"Event mode",Manual:"Manual",Auto:"Auto"},ManuallyScheduledColumn:{"Manually scheduled":"Manually scheduled"},MilestoneColumn:{Milestone:"Milestone"},NameColumn:{Name:"Name"},NoteColumn:{Note:"Note"},PercentDoneColumn:{"% Done":"% Done"},PredecessorColumn:{Predecessors:"Predecessors"},ResourceAssignmentColumn:{"Assigned Resources":"Assigned Resources","more resources":"more resources"},RollupColumn:{Rollup:"Rollup"},SchedulingModeColumn:{"Scheduling Mode":"Scheduling Mode"},SequenceColumn:{Sequence:"Sequence"},ShowInTimelineColumn:{"Show in timeline":"Show in timeline"},StartDateColumn:{Start:"Start"},SuccessorColumn:{Successors:"Successors"},WBSColumn:{WBS:"WBS"},DependencyField:{invalidDependencyFormat:"Invalid dependency format"},ProjectLines:{"Project Start":"Project start","Project End":"Project end"},TaskTooltip:{Start:"Start",End:"End",Duration:"Duration",Complete:"Complete"},AssignmentGrid:{Name:"Resource name",Units:"Units",unitsTpl:function(e){var t=e.value;return t?t+"%":""}},GanttBase:{propagating:"Calculating project",storePopulation:"Loading data"},Gantt:{Edit:"Edit task",Indent:"Indent",Outdent:"Outdent","Convert to milestone":"Convert to milestone",Add:"Add...","New task":"New task","New milestone":"New milestone","Task above":"Task above","Task below":"Task below","Delete task":"Delete task",Milestone:"Milestone","Sub-task":"Subtask",Successor:"Successor",Predecessor:"Predecessor",changeRejected:"Scheduling engine rejected the changes"},Indicators:{earlyDates:"Early start/end",lateDates:"Late start/end",Start:"Start",End:"End",deadlineDate:"Deadline"},TaskEditor:{editorWidth:"44em"}});tt.trimLocale(Nj,{EventEdit:["Repeat"],RecurrenceCombo:{},RecurrenceConfirmationPopup:{},RecurrenceDaysCombo:{},RecurrenceEditor:{},RecurrenceFrequencyCombo:{},RecurrenceLegend:{},RecurrencePositionsCombo:{},RecurrenceStopConditionCombo:{}});function Vj(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}rt.registerLocale("En",{desc:"English",locale:Nj});var zj=function(e){fe()(n,e);var t=Vj(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(){we()(pe()(n.prototype),"construct",this).apply(this,arguments),this.on("selectionchange",(function(e){var t=e.selected,n=e.deselected;t.forEach((function(e){return e.assigned=!0})),n.forEach((function(e){return e.assigned=!1}))}))}},{key:"projectEvent",get:function(){var e=this.store,t=this._projectEvent;return e&&t!==e.projectEvent&&(t=this._projectEvent=e.projectEvent),t},set:function(e){this._projectEvent=e,this.store.projectEvent=e,this.selectedRecords=this.store.originalAssignmentManipulationRecords}},{key:"store",get:function(){return we()(pe()(n.prototype),"store",this)},set:function(e){this.store!==e&&(e instanceof $j||(e=new $j(Object.assign({projectEvent:this._projectEvent},e))),sc()(pe()(n.prototype),"store",e,this,!0))}},{key:"columns",set:function(e){e&&e.unshift(F.clone(this.resourceColumn),F.clone(this.unitsColumn)),sc()(pe()(n.prototype),"columns",e,this,!0)},get:function(){return we()(pe()(n.prototype),"columns",this)}}],[{key:"$name",get:function(){return"AssignmentGrid"}},{key:"type",get:function(){return"assignmentgrid"}},{key:"configurable",get:function(){var e=this;return{resourceColumn:{cls:"b-assignmentgrid-resource-column",field:"resourceId",flex:1,editor:null,renderer:function(e){var t;return null===(t=e.record.resource)||void 0===t?void 0:t.name},filterable:{filterField:{placeholder:"L{Name}",localeClass:this,triggers:{filter:{align:"start",cls:"b-icon b-icon-filter"}}},filterFn:function(e){var t=e.value;return-1!==e.record.name.toLowerCase().indexOf(t.toLowerCase())}},sortable:function(e,t){return e.name<t.name?-1:e.name>t.name?1:0}},unitsColumn:{field:"units",type:Gh.type,text:"L{Units}",localeClass:this,width:70,min:0,max:100,step:10,unit:"%",renderer:function(t){var n=t.value;return e.L("L{unitsTpl}",{value:n})},filterable:!1}}}},{key:"defaultConfig",get:function(){return{selectionMode:{rowCheckboxSelection:!0,multiSelect:!0,showCheckAll:!0},features:{group:!1,filterBar:!0,contextMenu:!1},disableGridRowModelWarning:!0,projectEvent:null}}}]),n}(Ty);function Wj(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}zj.initClass(),zj._$name="AssignmentGrid";var Gj=function(e){fe()(n,e);var t=Wj(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"configure",value:function(e){var t=e.grid;t&&(y.a.deprecate("Gantt","5.0.0","The `grid` config is deprecated, you can now set the config properties directly on this AssignmentPicker since it *is* the Grid"),t.columns&&(e.columns=t.columns||[],delete(t=Object.assign({},t)).columns),an.merge(e,t)),e.selectedRecordCollection=e.assignments,we()(pe()(n.prototype),"configure",this).call(this,e)}},{key:"afterConfigure",value:function(){var e,t,r=this;we()(pe()(n.prototype),"afterConfigure",this).call(this),null===(e=r.bbar.widgetMap.saveBtn)||void 0===e||e.on("click",r.onSaveClick,r),null===(t=r.bbar.widgetMap.cancelBtn)||void 0===t||t.on("click",r.onCancelClick,r)}},{key:"onSaveClick",value:function(){this.store.applyChanges(),this.hide()}},{key:"onCancelClick",value:function(){this.hide()}},{key:"focusElement",get:function(){return this.element.querySelector(".b-filter-bar-field-input")}}],[{key:"$name",get:function(){return"AssignmentPicker"}},{key:"type",get:function(){return"assignmentpicker"}},{key:"defaultConfig",get:function(){return{focusable:!0,trapFocus:!0,height:"20em",minWidth:"25em",bbar:[{type:"button",text:this.L("L{Object.Save}"),localeClass:this,ref:"saveBtn",color:"b-green"},{type:"button",text:this.L("L{Object.Cancel}"),localeClass:this,ref:"cancelBtn",color:"b-gray"}],projectEvent:null,store:null}}}]),n}(zj);function Yj(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Gj.initClass(),Gj._$name="AssignmentPicker";var Uj=function(e){fe()(n,e);var t=Yj(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"onChipClose",value:function(e){var t=this;this.showPicker(),e.forEach((function(e){return t.picker.deselectRow(e)}))}},{key:"syncInputFieldValue",value:function(){we()(pe()(n.prototype),"syncInputFieldValue",this).call(this),this.store&&(this.tooltip=this.store.toValueString())}},{key:"onTriggerClick",value:function(e){this.pickerVisible?this.hidePicker():Lf.prototype.showPicker.call(this,e&&"key"in e)}},{key:"focusPicker",value:function(){this.picker.focus()}},{key:"changePicker",value:function(e,t){var n=this;return Gj.reconfigure(t,e,{owner:n,defaults:{projectEvent:n.projectEvent,store:n.store,readOnly:n.readOnly,owner:n,forElement:n[n.pickerAlignElement],assignments:n.valueCollection,align:{anchor:n.overlayAnchor,target:n[n.pickerAlignElement]}}})}},{key:"changeProjectEvent",value:function(e){var t=this.picker,n=this.store;return this._projectEvent=e,this._projectEventGeneration=e.generation,n&&(n.projectEvent=e),t&&(t.projectEvent=e),e}},{key:"changeStore",value:function(e){return!e||e instanceof $j||(e=new $j(e)),e}},{key:"updateStore",value:function(e){if(this.detachListeners("storeMutation"),e instanceof $j){var t=e.projectEvent;t?this.projectEvent=t:e.projectEvent=this.projectEvent}e.on({name:"storeMutation",change:"syncInputFieldValue",thisObj:this})}},{key:"onPickerKeyDown",value:function(e){var t=this.picker;"ArrowDown"===e.key&&e.target.compareDocumentPosition(t.bodyContainer)===document.DOCUMENT_POSITION_FOLLOWING&&t.element.focus()}},{key:"value",get:function(){},set:function(e){}}],[{key:"$name",get:function(){return"AssignmentField"}},{key:"type",get:function(){return"assignmentfield"}},{key:"configurable",get:function(){return{chipView:{cls:"b-assignment-chipview",itemTpl:function(e,t){return"".concat(e.name," ").concat(e.units,"%")},scrollable:{overflowX:"hidden-scroll"}},triggers:{expand:{cls:"b-icon-down",handler:"onTriggerClick"}},multiSelect:!0,clearable:!1,editable:!1,value:null,picker:{type:Gj.type,floating:!0,scrollAction:"realign"},pickerWidth:null,projectEvent:null,store:{}}}}]),n}(Xf);function qj(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Uj.initClass(),Uj._$name="AssignmentField";var Kj="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADwAAAA3CAYAAABQOymxAAAAAXNSR0IArs4c6QAAAAlwSFlzAAALEwAACxMBAJqcGAAABCJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDUuNC4wIj4KICAgPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICAgICAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOmV4aWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vZXhpZi8xLjAvIgogICAgICAgICAgICB4bWxuczpkYz0iaHR0cDovL3B1cmwub3JnL2RjL2VsZW1lbnRzLzEuMS8iCiAgICAgICAgICAgIHhtbG5zOnhtcD0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wLyI+CiAgICAgICAgIDx0aWZmOlJlc29sdXRpb25Vbml0PjI8L3RpZmY6UmVzb2x1dGlvblVuaXQ+CiAgICAgICAgIDx0aWZmOkNvbXByZXNzaW9uPjU8L3RpZmY6Q29tcHJlc3Npb24+CiAgICAgICAgIDx0aWZmOlhSZXNvbHV0aW9uPjcyPC90aWZmOlhSZXNvbHV0aW9uPgogICAgICAgICA8dGlmZjpPcmllbnRhdGlvbj4xPC90aWZmOk9yaWVudGF0aW9uPgogICAgICAgICA8dGlmZjpZUmVzb2x1dGlvbj43MjwvdGlmZjpZUmVzb2x1dGlvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxYRGltZW5zaW9uPjYwPC9leGlmOlBpeGVsWERpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6Q29sb3JTcGFjZT4xPC9leGlmOkNvbG9yU3BhY2U+CiAgICAgICAgIDxleGlmOlBpeGVsWURpbWVuc2lvbj41NTwvZXhpZjpQaXhlbFlEaW1lbnNpb24+CiAgICAgICAgIDxkYzpzdWJqZWN0PgogICAgICAgICAgICA8cmRmOkJhZy8+CiAgICAgICAgIDwvZGM6c3ViamVjdD4KICAgICAgICAgPHhtcDpNb2RpZnlEYXRlPjIwMTgtMDMtMTBUMTE6MDM6NTc8L3htcDpNb2RpZnlEYXRlPgogICAgICAgICA8eG1wOkNyZWF0b3JUb29sPlBpeGVsbWF0b3IgMy43PC94bXA6Q3JlYXRvclRvb2w+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgpEgCIGAAADbUlEQVRoBe2aW08TQRTH/yVchVCg3Kyl1EAEg6VBjdpoor74ZUz8Nn4UIyHGy4NGLtEHoiLhBQpUkWAIt8itnkMt3SVud2b3DL0xSdPZnTNzzm8uZ87ubCCTyTwD8JR+1+hXyWme4J4HCPg7ZSodNjeQ8wycyV1Vw39NNUBaGWutF6bzh6Rg5XdeC8+t+nog3JK/ZzpnHDi9A0xNAUdH7ijt7cDjW+5yfiSMruHxD8Durr550Shw25AbNQL8hxhfvNIHtdZooWn+5J71jkzeiNMaf+PfuO1tYJo3TOEkDvx1WW29qnCkUsCBiqCGjDjw3JyGdgXRt5MKQhoiosA/PDgoN1u3ttwk9MpFgWdm9JSrSv/cU5V0lxMF3t93V+hFYpn8glQSBZYy6mw7ktF+WQCf7QA/1xfAfnovEPBT27lurWDEXxYjHAo5d4ZuSVkAR4K6WM7yZQHsbL5+yQWwfp/la5hyWpIv3URHOCi41vLdCEgaKdkWhoetZpZmXhT4crM8ZEODbJuiwGxaT4+sgfG4bHviwPcFDawh66JtJQ7M5tXVyRg5OCjTjrUV8RHmxmMxqwrv+Rv0ulY6GQGO92dPFPwY293tp7ZzXSPArK6vz1mpWwkHMA9G3aS8lRsDTlwFvD7W9fZ6g1GpZQyYlScSKibYZbiTkiP2e5JXRoH76XAsEtEzN5nUk9eVNgrMxjRrRl9twpHV2Q4xcpjGSn7RidrSErC+DuzQkalq6uwE+CGEt7YgOS/pJArMZ8Hz9OkIH4TxO2o/r1c5yuI4urUVGKPo7ZIQuW/ghTUgnc6OpB9ANx7uAN6bh4aAkI9IzjNwahNYXATWCPg8E3tx3rYGBryBawMz6MICsEn/x8fniWrXxeC81u+OAY32ooJXysB8MPh5Njt1Vb7XKKhVsJDXeVcXcEfx5YMrMB/cfSFHxOv0QPp0WhC8kYaZ9/zRWOFGCwJ/oqm7upr1uIWbKZ3SpiZ6hqanrBGHWP6/wLPkjHhEeXsp18TrOxwGrl+xE9iAD6ns3XTWIdnFyveKj2kekmPLJRvwy/fAnuBpe05Jsf87OoBHN7NWnMbSEx8rE5YxNzaA1/8+xzgZ4clv9A3kSrHHwbx+js9PRrgaYLk7OTI8ndLm+7f4GjjWrypg7vIL4OJPPLMWVN0I/wWcn9aXj4AzhgAAAABJRU5ErkJggg==",Xj=function(e){fe()(n,e);var t=qj(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(){var e=this;if(we()(pe()(n.prototype),"construct",this).apply(this,arguments),e.showAvatars){if(nu.on({element:e.grid.element,error:e.onError,thisObj:e,capture:!0}),Object.assign(e,{repaintOnResize:!0,htmlEncode:!1}),!e.grid.resourceImageFolderPath)throw new Error("Must provide a resourceImageFolderPath where resource images are located");e.renderer=e.rendererWithAvatars}e.grid.on({startCellEdit:e.onStartCellEdit,finishCellEdit:e.onDoneCellEdit,cancelCellEdit:e.onDoneCellEdit,thisObj:e}),e.grid.resourceStore.on({name:"resourceStore",update:e.onResourceUpdate,thisObj:e})}},{key:"onStartCellEdit",value:function(e){var t=e.editorContext,n=t.record,r=this;t.column===r&&(r.editor.projectEvent=n,this.detachListeners("editorStore"),r.editor.store.on({name:"editorStore",changesApplied:r.onEditorChangesApplied,thisObj:r}))}},{key:"onDoneCellEdit",value:function(){this.detachListeners("editorStore")}},{key:"onEditorChangesApplied",value:function(){var e=this,t=e.grid.getCell({id:e.editor.projectEvent.id,columnId:e.id});t&&e.renderer({value:e.editor.projectEvent.assignments,cellElement:t})}},{key:"onResourceUpdate",value:function(e){var t;(null===(t=e.source.project)||void 0===t?void 0:t.propagatingLoadChanges)||this.grid.refreshColumn(this)}},{key:"itemTpl",value:function(e,t){return e.toString()}},{key:"renderer",value:function(e){var t=e.cellElement,n=e.value,r=e.isExport;if(n=n.filter((function(e){return e.resource})).sort((function(e,t){return e.resourceName.localeCompare(t.resourceName)})),r)return n.map(this.itemTpl).join(",");var i=this.chipView;i.store.storage.replaceValues({values:n,silent:!0}),i.refresh();var o=i.element.cloneNode(!0);o.removeAttribute("id"),t.innerHTML='<div class="b-assignment-chipview-wrap"></div>',t.firstElementChild.appendChild(o)}},{key:"rendererWithAvatars",value:function(e){var t=e.value,n=e.isExport,r=this,i=Math.floor((r.width-r.sideMargin)/(r.imageSize+2)),o=t.length>i?t.length-i:0;return t=t.filter((function(e){return e.resource})).sort((function(e,t){return e.resourceName.localeCompare(t.resourceName)})),n?t.map(this.itemTpl).join(","):{className:"b-resource-avatar-container",children:t.map((function(e,t){var n=e.resource;if(t<i){var a=o>0&&t===i-1,s=r.renderImage({resource:n,assignment:e,overflowCount:a?o:0});return a?{className:"b-overflow-img",children:[s,{tag:"span",className:"b-overflow-count",html:"+".concat(o)}]}:s}}))}}},{key:"renderImage",value:function(e){var t=e.resource,n=e.assignment,r=e.overflowCount;return{tag:"img",className:"b-resource-avatar",dataset:{btipScrollAction:"realign",btip:"".concat(n.toString()).concat(r?" (+".concat(r," ").concat(this.L("L{more resources}"),")"):"")},src:t.image?this.grid.resourceImageFolderPath+t.image:this.defaultAvatar}}},{key:"onError",value:function(e){var t=e.target;t.classList.contains("b-resource-avatar")&&(t.getAttribute("src").endsWith(this.defaultAvatar)?t.src=Kj:t.src=this.defaultAvatar)}},{key:"defaultEditor",get:function(){return{type:Uj.type}}},{key:"chipView",get:function(){var e=this;return e._chipView||(e._chipView=new Uf({cls:"b-assignment-chipview",itemsFocusable:!1,closable:!1,itemTpl:e.itemTpl,store:{},scrollable:{overflowX:"hidden-scroll"}}),Object.defineProperty(e.chipView,"isVisible",{get:function(){return!0}})),e._chipView}},{key:"defaultAvatar",get:function(){var e=this.grid;return e.defaultResourceImageName?e.resourceImageFolderPath+e.defaultResourceImageName:Kj}}],[{key:"$name",get:function(){return"ResourceAssignmentColumn"}},{key:"type",get:function(){return"resourceassignment"}},{key:"isGanttColumn",get:function(){return!0}},{key:"fields",get:function(){return["showAvatars","sideMargin","imageSize"]}},{key:"defaults",get:function(){return{field:"assignments",instantUpdate:!1,text:"L{Assigned Resources}",width:250,cellCls:"b-resourceassignment-cell",showAvatars:!1,imageSize:30,sideMargin:20,sortable:function(e,t){var n=e.assignments.join(""),r=t.assignments.join("");return n===r?0:n<r?-1:1},filterable:function(e){var t=e.value,n=e.record,r=new RegExp(t,"gi");return n.assignments.some((function(e){return r.test(e.resourceName)}))}}}}]),n}(Dh);function Zj(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Th.registerColumnType(Xj),Xj._$name="ResourceAssignmentColumn";var Jj=function(e){fe()(n,e);var t=Zj(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"$name",get:function(){return"RollupColumn"}},{key:"type",get:function(){return"rollup"}},{key:"isGanttColumn",get:function(){return!0}},{key:"defaults",get:function(){return{field:"rollup",text:"L{Rollup}"}}}]),n}(Hh);function Qj(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Th.registerColumnType(Jj),Jj._$name="RollupColumn";var e_=function(e){fe()(n,e);var t=Qj(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"afterConstruct",value:function(){we()(pe()(n.prototype),"afterConstruct",this).call(this),xe.createSequence(this.editor.updateLocalization,this.onEditorLocaleChange,this)}},{key:"renderer",value:function(e){var t=e.value,n=this.editor.store.getById(t);return n&&n.text||""}},{key:"onEditorLocaleChange",value:function(){this.grid.refreshColumn(this)}}],[{key:"$name",get:function(){return"SchedulingModeColumn"}},{key:"type",get:function(){return"schedulingmodecolumn"}},{key:"isGanttColumn",get:function(){return!0}},{key:"defaults",get:function(){return{field:"schedulingMode",text:"L{Scheduling Mode}",editor:{type:LF.type,allowInvalid:!1,picker:{minWidth:"8.5em"}}}}}]),n}(Dh);function t_(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Th.registerColumnType(e_),e_._$name="SchedulingModeColumn";var n_=function(e){fe()(n,e);var t=t_(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"$name",get:function(){return"SequenceColumn"}},{key:"type",get:function(){return"sequence"}},{key:"isGanttColumn",get:function(){return!0}},{key:"defaults",get:function(){return{field:"sequenceNumber",text:"L{Sequence}",sortable:!1,groupable:!1,filterable:!1,width:70,editor:null}}}]),n}(Dh);function r_(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Th.registerColumnType(n_),n_._$name="SequenceColumn";var i_=function(e){fe()(n,e);var t=r_(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"$name",get:function(){return"ShowInTimelineColumn"}},{key:"type",get:function(){return"showintimeline"}},{key:"isGanttColumn",get:function(){return!0}},{key:"defaults",get:function(){return{field:"showInTimeline",text:"L{Show in timeline}"}}}]),n}(Hh);function o_(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Th.registerColumnType(i_),i_._$name="ShowInTimelineColumn";var a_=function(e){fe()(n,e);var t=o_(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"defaultEditor",get:function(){var e=we()(pe()(n.prototype),"defaultEditor",this);return e.type="startdate",e}},{key:"editor",get:function(){var e=this.data.editor,t=e&&!(e instanceof oc);return(e=we()(pe()(n.prototype),"editor",this))&&t&&(e.project=this.gantt.project),e}}],[{key:"$name",get:function(){return"StartDateColumn"}},{key:"type",get:function(){return"startdate"}},{key:"defaults",get:function(){return{field:"startDate",text:"L{Start}"}}}]),n}(ML);function s_(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Th.registerColumnType(a_),a_._$name="StartDateColumn";var u_=function(e){fe()(n,e);var t=s_(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"$name",get:function(){return"SuccessorColumn"}},{key:"type",get:function(){return"successor"}},{key:"isGanttColumn",get:function(){return!0}},{key:"defaults",get:function(){return{text:"L{Successors}",field:"successors"}}}]),n}(vj);function c_(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Th.registerColumnType(u_),u_._$name="SuccessorColumn";var l_=function(e){fe()(n,e);var t=c_(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"canEdit",value:function(e){return!1}},{key:"durationUnitField",get:function(){return"slackUnit"}}],[{key:"$name",get:function(){return"TotalSlackColumn"}},{key:"type",get:function(){return"totalslack"}},{key:"isGanttColumn",get:function(){return!0}},{key:"defaults",get:function(){return{field:"totalSlack",text:"L{Total Slack}"}}}]),n}(zO);function f_(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Th.registerColumnType(l_),l_._$name="TotalSlackColumn";var d_=function(e){fe()(n,e);var t=f_(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"$name",get:function(){return"WBSColumn"}},{key:"type",get:function(){return"wbs"}},{key:"isGanttColumn",get:function(){return!0}},{key:"defaults",get:function(){return{field:"wbsIndex",text:"L{WBS}",width:70,editor:null}}}]),n}(Dh);Th.registerColumnType(d_),d_._$name="WBSColumn";var h_={AddNewColumn:SL,CalendarColumn:EL,ConstraintDateColumn:PL,ConstraintTypeColumn:OL,DeadlineDateColumn:LL,DurationColumn:zO,EarlyEndDateColumn:_L,EarlyStartDateColumn:HL,EffortColumn:NL,EndDateColumn:zL,LateEndDateColumn:GL,LateStartDateColumn:UL,ManuallyScheduledColumn:KL,MilestoneColumn:ZL,NameColumn:QL,NoteColumn:tj,PercentDoneColumn:rj,PredecessorColumn:gj,ResourceAssignmentColumn:Xj,RollupColumn:Jj,SchedulingModeColumn:e_,SequenceColumn:n_,ShowInTimelineColumn:i_,StartDateColumn:a_,SuccessorColumn:u_,TotalSlackColumn:l_,WBSColumn:d_};function v_(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var p_=function(e){fe()(n,e);var t=v_(n);function n(e,r){var i;return v()(this,n),(i=t.apply(this,arguments)).internalCellCls="b-eventmode-cell",i}return g()(n,null,[{key:"$name",get:function(){return"EventModeColumn"}},{key:"type",get:function(){return"eventmode"}},{key:"isGanttColumn",get:function(){return!0}},{key:"defaults",get:function(){return{field:"manuallyScheduled",align:"left",text:"L{Event mode}"}}}]),g()(n,[{key:"renderer",value:function(e){var t=e.value,r=e.cellElement,i=(e.column,e.isExport);if(we()(pe()(n.prototype),"renderer",this).apply(this,arguments),i)return this.renderText(t);r.widget&&(r.widget.text=this.renderText(t))}},{key:"onCheckboxChange",value:function(e){var t=e.source,r=e.checked;we()(pe()(n.prototype),"onCheckboxChange",this).apply(this,arguments),t.text=this.renderText(r)}},{key:"renderText",value:function(e){return e?this.L("L{Manual}"):this.L("L{Auto}")}}]),n}(Hh);function g_(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Th.registerColumnType(p_),p_._$name="EventModeColumn";var y_=function(e){fe()(n,e);var t=g_(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"defaults",get:function(){return{enableCellContextMenu:!0}}}]),n}(PA);function m_(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}Th.registerColumnType(y_),y_._$name="TimeAxisColumn";var k_=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":l()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},b_=function(e){fe()(n,e);var t=m_(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([vI],(function(e){e.prototype;var t=function(e){fe()(n,e);var t=m_(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"calculateUnits",value:Vr.a.mark((function e(){var t;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.event;case 2:if(!(t=e.sent)){e.next=6;break}return e.delegateYield(t.calculateAssignmentUnits(this),"t0",5);case 5:return e.abrupt("return",e.t0);case 6:return e.next=8,vk;case 8:return e.abrupt("return",e.sent);case 9:case"end":return e.stop()}}),e,this)}))}]),n}(e);return k_([fw("units")],t.prototype,"calculateUnits",null),t})));function w_(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var C_=function(e){fe()(n,e);var t=w_(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"fields",get:function(){return[{name:"event",persist:!0,serialize:function(e){return null==e?void 0:e.id},isEqual:Aw},{name:"resource",persist:!0,serialize:function(e){return null==e?void 0:e.id},isEqual:Aw},"eventId","resourceId"]}}]),n}(b_.mix(kI));function S_(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}C_._$name="AssignmentModel";var D_=function(e){fe()(n,e);var t=S_(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"defaultConfig",get:function(){return{modelClass:C_,loadPriority:500,syncPriority:400}}}]),n}(wI);function R_(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}D_._$name="AssignmentStore";var x_=function(e){fe()(n,e);var t=R_(n);function n(){v()(this,n);for(var e=arguments.length,r=new Array(e),i=0;i<e;i++)r[i]=arguments[i];var o=r[0];return o&&o.fromTask&&(o.fromEvent=o.fromTask),o&&o.toTask&&(o.toEvent=o.toTask),t.call.apply(t,[this].concat(r))}return g()(n,[{key:"from",get:function(){var e;return null===(e=this.fromEvent)||void 0===e?void 0:e.id}},{key:"fromTask",get:function(){return this.fromEvent},set:function(e){this.fromEvent=e}},{key:"to",get:function(){var e;return null===(e=this.toEvent)||void 0===e?void 0:e.id}},{key:"toTask",get:function(){return this.toEvent},set:function(e){this.toEvent=e}}]),n}(II);function E_(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}x_._$name="DependencyModel";var T_=function(e){fe()(n,e);var t=E_(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"defaultConfig",get:function(){return{modelClass:x_,loadPriority:300,syncPriority:500}}}]),n}(FI);function M_(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}T_._$name="DependencyStore";var A_=function(e){fe()(n,e);var t=M_(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(IO);function P_(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}A_._$name="ResourceModel";var I_=function(e){fe()(n,e);var t=P_(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"defaultConfig",get:function(){return{modelClass:A_,loadPriority:400,syncPriority:200}}}]),n}(FO);function O_(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}I_._$name="ResourceStore";var F_=function(e){fe()(n,e);var t=O_(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"compare",value:function(e,t){if(e===t)return 0;if(!e||!t)return e?1:t?-1:0;e=n.parseValue(e),t=n.parseValue(t);for(var r,i=e.length,o=t.length,a=i<o?i:o,s=0;s<a;++s)if(r=e[s]-t[s])return r;return i-o}},{key:"printValue",value:function(e){return"string"==typeof e?e:e.join(".")}}],[{key:"parseValue",value:function(e){if("string"==typeof e)for(var t=(e=e.split(".")).length;t-- >0;)e[t]=parseInt(e[t],10);return e}},{key:"type",get:function(){return"wbs"}}]),n}(gi);F_.initClass(),F_._$name="WbsField";function L_(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var j_=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":l()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},__=function(e){fe()(n,e);var t=L_(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([TR,XI,UI],(function(e){var t=e.prototype,n=function(e){fe()(r,e);var n=L_(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"maybeSkipNonWorkingTime",value:Vr.a.mark((function e(n){var r,i=arguments;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r=!(i.length>1&&void 0!==i[1])||i[1],e.next=3,this.$.childEvents;case 3:if(!(e.sent.size>0)){e.next=6;break}return e.abrupt("return",n);case 6:return e.delegateYield(t.maybeSkipNonWorkingTime.call(this,n,r),"t0",7);case 7:return e.abrupt("return",e.t0);case 8:case"end":return e.stop()}}),e,this)}))},{key:"calculateStartDateConstraintIntervals",value:Vr.a.mark((function e(){var n,r,i;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(t.calculateStartDateConstraintIntervals.call(this),"t0",1);case 1:return n=e.t0,e.next=4,this.$.parentEvent;case 4:if(!(r=e.sent)){e.next=10;break}return e.next=8,r.$.startDateConstraintIntervals;case 8:i=e.sent,n.push.apply(n,i);case 10:return e.abrupt("return",n);case 11:case"end":return e.stop()}}),e,this)}))},{key:"calculateEndDateConstraintIntervals",value:Vr.a.mark((function e(){var n,r,i;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(t.calculateEndDateConstraintIntervals.call(this),"t0",1);case 1:return n=e.t0,e.next=4,this.$.parentEvent;case 4:if(!(r=e.sent)){e.next=10;break}return e.next=8,r.$.endDateConstraintIntervals;case 8:i=e.sent,n.push.apply(n,i);case 10:return e.abrupt("return",n);case 11:case"end":return e.stop()}}),e,this)}))},{key:"calculateEarlyStartDateConstraintIntervals",value:Vr.a.mark((function e(){var n,r,i;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(t.calculateEarlyStartDateConstraintIntervals.call(this),"t0",1);case 1:return n=e.t0,e.next=4,this.$.parentEvent;case 4:if(!(r=e.sent)){e.next=28;break}return e.next=8,r.$.earlyStartDateConstraintIntervals;case 8:return i=e.sent,n.push.apply(n,i),e.next=12,r.$.manuallyScheduled;case 12:if(e.t1=e.sent,!e.t1){e.next=19;break}return e.next=16,this.$.direction;case 16:e.t2=e.sent,e.t3=nS.Forward,e.t1=e.t2===e.t3;case 19:if(!e.t1){e.next=28;break}return e.t4=n,e.t5=BI,e.next=24,r.$.startDate;case 24:e.t6=e.sent,e.t7={startDate:e.t6},e.t8=e.t5.new.call(e.t5,e.t7),e.t4.push.call(e.t4,e.t8);case 28:return e.abrupt("return",n);case 29:case"end":return e.stop()}}),e,this)}))},{key:"calculateEarlyEndDateConstraintIntervals",value:Vr.a.mark((function e(){var n,r,i;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(t.calculateEarlyEndDateConstraintIntervals.call(this),"t0",1);case 1:return n=e.t0,e.next=4,this.$.parentEvent;case 4:if(!(r=e.sent)){e.next=10;break}return e.next=8,r.$.earlyEndDateConstraintIntervals;case 8:i=e.sent,n.push.apply(n,i);case 10:return e.abrupt("return",n);case 11:case"end":return e.stop()}}),e,this)}))}]),r}(e);return j_([fw("startDateConstraintIntervals")],n.prototype,"calculateStartDateConstraintIntervals",null),j_([fw("endDateConstraintIntervals")],n.prototype,"calculateEndDateConstraintIntervals",null),j_([fw("earlyStartDateConstraintIntervals")],n.prototype,"calculateEarlyStartDateConstraintIntervals",null),j_([fw("earlyEndDateConstraintIntervals")],n.prototype,"calculateEarlyEndDateConstraintIntervals",null),n})));function B_(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return H_(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return H_(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function H_(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function $_(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var N_=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":l()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},V_=function(e){fe()(n,e);var t=$_(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([UI,XI],(function(e){var t=e.prototype,n=function(e){fe()(r,e);var n=$_(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"calculateLateStartDateConstraintIntervals",value:Vr.a.mark((function e(){var t,n,r;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.next=3,this.$.parentEvent;case 3:if(!(n=e.sent)){e.next=9;break}return e.next=7,n.$.lateStartDateConstraintIntervals;case 7:r=e.sent,t.push.apply(t,r);case 9:return e.abrupt("return",t);case 10:case"end":return e.stop()}}),e,this)}))},{key:"calculateLateEndDateConstraintIntervals",value:Vr.a.mark((function e(){var t,n,r;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],e.next=3,this.$.parentEvent;case 3:if(!(n=e.sent)){e.next=27;break}return e.next=7,n.$.lateEndDateConstraintIntervals;case 7:return r=e.sent,t.push.apply(t,r),e.next=11,n.$.manuallyScheduled;case 11:if(e.t0=e.sent,!e.t0){e.next=18;break}return e.next=15,this.$.direction;case 15:e.t1=e.sent,e.t2=nS.Backward,e.t0=e.t1===e.t2;case 18:if(!e.t0){e.next=27;break}return e.t3=t,e.t4=BI,e.next=23,n.$.endDate;case 23:e.t5=e.sent,e.t6={endDate:e.t5},e.t7=e.t4.new.call(e.t4,e.t6),e.t3.push.call(e.t3,e.t7);case 27:return e.abrupt("return",t);case 28:case"end":return e.stop()}}),e,this)}))},{key:"calculateLateStartDateRaw",value:Vr.a.mark((function e(){var t,n,r,i,o,a,s,u,c,l;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.childEvents;case 2:if(!(t=e.sent).size){e.next=27;break}n=sS,r=B_(t),e.prev=6,r.s();case 8:if((i=r.n()).done){e.next=16;break}return o=i.value,e.next=12,o.$.lateStartDate;case 12:(a=e.sent)&&a<n&&(n=a);case 14:e.next=8;break;case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(6),r.e(e.t0);case 21:return e.prev=21,r.f(),e.finish(21);case 24:n=n.getTime()-sS.getTime()?n:null,e.next=74;break;case 27:return e.next=29,this.$.manuallyScheduled;case 29:if(!e.sent){e.next=33;break}return e.next=32,this.$.startDate;case 32:return e.abrupt("return",e.sent);case 33:return e.delegateYield(this.isConstrainedLate(),"t1",34);case 34:if(e.t1){e.next=38;break}return e.next=37,this.$.startDate;case 37:return e.abrupt("return",e.sent);case 38:return e.next=40,this.$.lateStartDateConstraintIntervals;case 40:return s=e.sent,e.next=43,this.$.lateEndDateConstraintIntervals;case 43:return u=e.sent,e.t2=this,e.t3=s,e.next=48,this.$.startDateConstraintIntervals;case 48:return e.t4=e.sent,e.t5=e.t3.concat.call(e.t3,e.t4),e.t6=u,e.next=53,this.$.endDateConstraintIntervals;case 53:return e.t7=e.sent,e.t8=e.t6.concat.call(e.t6,e.t7),e.delegateYield(e.t2.calculateEffectiveConstraintInterval.call(e.t2,!0,e.t5,e.t8),"t9",56);case 56:if(null!==(c=e.t9)){e.next=61;break}return e.abrupt("return",null);case 61:if(!c.isIntervalEmpty()){e.next=73;break}return l=QT.new(),e.next=65,l;case 65:if(e.t10=e.sent,e.t11=XT.Cancel,e.t10!==e.t11){e.next=72;break}return e.next=70,yk(l);case 70:e.next=73;break;case 72:return e.abrupt("return",null);case 73:return e.abrupt("return",uS(c.endDate)?c.endDate:null);case 74:return e.abrupt("return",n);case 75:case"end":return e.stop()}}),e,this,[[6,18,21,24]])}))},{key:"calculateLateStartDate",value:Vr.a.mark((function e(){var t;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.lateStartDateRaw;case 2:return t=e.sent,e.delegateYield(this.maybeSkipNonWorkingTime(t,!0),"t0",4);case 4:return e.abrupt("return",e.t0);case 5:case"end":return e.stop()}}),e,this)}))},{key:"calculateLateEndDateRaw",value:Vr.a.mark((function e(){var t,n,r,i,o,a,s,u,c,l;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.childEvents;case 2:if(!(t=e.sent).size){e.next=27;break}n=aS,r=B_(t),e.prev=6,r.s();case 8:if((i=r.n()).done){e.next=16;break}return o=i.value,e.next=12,o.$.lateEndDate;case 12:(a=e.sent)&&a>n&&(n=a);case 14:e.next=8;break;case 16:e.next=21;break;case 18:e.prev=18,e.t0=e.catch(6),r.e(e.t0);case 21:return e.prev=21,r.f(),e.finish(21);case 24:n=n.getTime()-aS.getTime()?n:null,e.next=74;break;case 27:return e.next=29,this.$.manuallyScheduled;case 29:if(!e.sent){e.next=33;break}return e.next=32,this.$.endDate;case 32:return e.abrupt("return",e.sent);case 33:return e.delegateYield(this.isConstrainedLate(),"t1",34);case 34:if(e.t1){e.next=38;break}return e.next=37,this.$.endDate;case 37:return e.abrupt("return",e.sent);case 38:return e.next=40,this.$.lateStartDateConstraintIntervals;case 40:return s=e.sent,e.next=43,this.$.lateEndDateConstraintIntervals;case 43:return u=e.sent,e.t2=this,e.t3=s,e.next=48,this.$.startDateConstraintIntervals;case 48:return e.t4=e.sent,e.t5=e.t3.concat.call(e.t3,e.t4),e.t6=u,e.next=53,this.$.endDateConstraintIntervals;case 53:return e.t7=e.sent,e.t8=e.t6.concat.call(e.t6,e.t7),e.delegateYield(e.t2.calculateEffectiveConstraintInterval.call(e.t2,!1,e.t5,e.t8),"t9",56);case 56:if(null!==(c=e.t9)){e.next=61;break}return e.abrupt("return",null);case 61:if(!c.isIntervalEmpty()){e.next=73;break}return l=QT.new(),e.next=65,l;case 65:if(e.t10=e.sent,e.t11=XT.Cancel,e.t10!==e.t11){e.next=72;break}return e.next=70,yk(l);case 70:e.next=73;break;case 72:return e.abrupt("return",null);case 73:return e.abrupt("return",uS(c.endDate)?c.endDate:null);case 74:return e.abrupt("return",n);case 75:case"end":return e.stop()}}),e,this,[[6,18,21,24]])}))},{key:"calculateLateEndDate",value:Vr.a.mark((function e(){var t;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.lateEndDateRaw;case 2:return t=e.sent,e.delegateYield(this.maybeSkipNonWorkingTime(t,!1),"t0",4);case 4:return e.abrupt("return",e.t0);case 5:case"end":return e.stop()}}),e,this)}))},{key:"calculateTotalSlack",value:Vr.a.mark((function e(){var t,n,r,i,o,a,s;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.earlyStartDateRaw;case 2:return t=e.sent,e.next=5,this.$.lateStartDateRaw;case 5:return n=e.sent,e.next=8,this.$.earlyEndDateRaw;case 8:return r=e.sent,e.next=11,this.$.lateEndDateRaw;case 11:return i=e.sent,e.next=14,this.$.slackUnit;case 14:if(o=e.sent,!(t&&n||r&&i)){e.next=28;break}if(!t||!n){e.next=25;break}return e.delegateYield(this.calculateProjectedDuration(t,n,o),"t0",18);case 18:if(s=e.t0,!r||!i){e.next=23;break}return e.delegateYield(this.calculateProjectedDuration(r,i,o),"t1",21);case 21:(a=e.t1)<s&&(s=a);case 23:e.next=28;break;case 25:if(!r||!i){e.next=28;break}return e.delegateYield(this.calculateProjectedDuration(r,i,o),"t2",27);case 27:s=e.t2;case 28:return e.abrupt("return",s);case 29:case"end":return e.stop()}}),e,this)}))},{key:"calculateCritical",value:Vr.a.mark((function e(){var t;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.totalSlack;case 2:return t=e.sent,e.abrupt("return",t<=0);case 4:case"end":return e.stop()}}),e,this)}))},{key:"isConstrainedLate",value:Vr.a.mark((function e(){var t,n,r,i;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.startDateConstraintIntervals;case 2:return t=e.sent,e.next=5,this.$.endDateConstraintIntervals;case 5:return n=e.sent,e.next=8,this.$.lateStartDateConstraintIntervals;case 8:return r=e.sent,e.next=11,this.$.lateEndDateConstraintIntervals;case 11:return i=e.sent,e.abrupt("return",Boolean((null==t?void 0:t.length)||(null==n?void 0:n.length)||(null==r?void 0:r.length)||(null==i?void 0:i.length)));case 13:case"end":return e.stop()}}),e,this)}))},{key:"calculateStartDatePure",value:Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.direction;case 2:if(e.sent!==nS.Backward){e.next=22;break}return e.delegateYield(this.isConstrainedLate(),"t2",5);case 5:if(e.t1=!e.t2,e.t1){e.next=10;break}return e.next=9,this.$.manuallyScheduled;case 9:e.t1=e.sent;case 10:if(e.t0=e.t1,e.t0){e.next=14;break}return e.delegateYield(this.hasSubEvents(),"t3",13);case 13:e.t0=e.t3;case 14:if(!e.t0){e.next=17;break}return e.delegateYield(t.calculateStartDatePure.call(this),"t4",16);case 16:return e.abrupt("return",e.t4);case 17:return e.next=19,this.$.lateStartDate;case 19:return e.abrupt("return",e.sent);case 22:return e.delegateYield(t.calculateStartDatePure.call(this),"t5",23);case 23:return e.abrupt("return",e.t5);case 24:case"end":return e.stop()}}),e,this)}))},{key:"calculateStartDateProposed",value:Vr.a.mark((function e(){var n;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.direction;case 2:n=e.sent,e.t0=n,e.next=e.t0===nS.Backward?6:26;break;case 6:return e.delegateYield(this.isConstrainedLate(),"t3",7);case 7:if(e.t2=!e.t3,e.t2){e.next=12;break}return e.next=11,this.$.manuallyScheduled;case 11:e.t2=e.sent;case 12:if(e.t1=e.t2,e.t1){e.next=16;break}return e.delegateYield(this.hasSubEvents(),"t4",15);case 15:e.t1=e.t4;case 16:if(!e.t1){e.next=19;break}return e.delegateYield(t.calculateStartDateProposed.call(this),"t5",18);case 18:return e.abrupt("return",e.t5);case 19:return e.next=21,this.$.lateStartDate;case 21:if(e.t6=e.sent,e.t6){e.next=25;break}return e.delegateYield(t.calculateStartDateProposed.call(this),"t7",24);case 24:e.t6=e.t7;case 25:return e.abrupt("return",e.t6);case 26:return e.delegateYield(t.calculateStartDateProposed.call(this),"t8",27);case 27:return e.abrupt("return",e.t8);case 28:case"end":return e.stop()}}),e,this)}))},{key:"calculateEndDatePure",value:Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.direction;case 2:if(e.sent!==nS.Backward){e.next=22;break}return e.delegateYield(this.isConstrainedLate(),"t2",5);case 5:if(e.t1=!e.t2,e.t1){e.next=10;break}return e.next=9,this.$.manuallyScheduled;case 9:e.t1=e.sent;case 10:if(e.t0=e.t1,e.t0){e.next=14;break}return e.delegateYield(this.hasSubEvents(),"t3",13);case 13:e.t0=e.t3;case 14:if(!e.t0){e.next=17;break}return e.delegateYield(t.calculateEndDatePure.call(this),"t4",16);case 16:return e.abrupt("return",e.t4);case 17:return e.next=19,this.$.lateEndDate;case 19:return e.abrupt("return",e.sent);case 22:return e.delegateYield(t.calculateEndDatePure.call(this),"t5",23);case 23:return e.abrupt("return",e.t5);case 24:case"end":return e.stop()}}),e,this)}))},{key:"calculateEndDateProposed",value:Vr.a.mark((function e(){var n;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.direction;case 2:n=e.sent,e.t0=n,e.next=e.t0===nS.Backward?6:26;break;case 6:return e.delegateYield(this.isConstrainedLate(),"t3",7);case 7:if(e.t2=!e.t3,e.t2){e.next=12;break}return e.next=11,this.$.manuallyScheduled;case 11:e.t2=e.sent;case 12:if(e.t1=e.t2,e.t1){e.next=16;break}return e.delegateYield(this.hasSubEvents(),"t4",15);case 15:e.t1=e.t4;case 16:if(!e.t1){e.next=19;break}return e.delegateYield(t.calculateEndDateProposed.call(this),"t5",18);case 18:return e.abrupt("return",e.t5);case 19:return e.next=21,this.$.lateEndDate;case 21:if(e.t6=e.sent,e.t6){e.next=25;break}return e.delegateYield(t.calculateEndDateProposed.call(this),"t7",24);case 24:e.t6=e.t7;case 25:return e.abrupt("return",e.t6);case 26:return e.delegateYield(t.calculateEndDateProposed.call(this),"t8",27);case 27:return e.abrupt("return",e.t8);case 28:case"end":return e.stop()}}),e,this)}))}]),r}(e);return N_([lw({lazy:!0})],n.prototype,"lateStartDateRaw",void 0),N_([Vw({type:"date",persist:!1},{lazy:!0,converter:Gw,persistent:!1})],n.prototype,"lateStartDate",void 0),N_([lw({lazy:!0})],n.prototype,"lateEndDateRaw",void 0),N_([Vw({type:"date",persist:!1},{lazy:!0,converter:Gw,persistent:!1})],n.prototype,"lateEndDate",void 0),N_([lw({lazy:!0})],n.prototype,"lateStartDateConstraintIntervals",void 0),N_([lw({lazy:!0})],n.prototype,"lateEndDateConstraintIntervals",void 0),N_([Vw({type:"number",persist:!1},{lazy:!0,persistent:!1})],n.prototype,"totalSlack",void 0),N_([Vw({type:"string",defaultValue:KC.Day,persist:!1},{lazy:!0,converter:Zt.normalizeUnit,persistent:!1})],n.prototype,"slackUnit",void 0),N_([Vw({type:"boolean",defaultValue:!1,persist:!1},{persistent:!1,lazy:!0})],n.prototype,"critical",void 0),N_([fw("lateStartDateConstraintIntervals")],n.prototype,"calculateLateStartDateConstraintIntervals",null),N_([fw("lateEndDateConstraintIntervals")],n.prototype,"calculateLateEndDateConstraintIntervals",null),N_([fw("lateStartDateRaw")],n.prototype,"calculateLateStartDateRaw",null),N_([fw("lateStartDate")],n.prototype,"calculateLateStartDate",null),N_([fw("lateEndDateRaw")],n.prototype,"calculateLateEndDateRaw",null),N_([fw("lateEndDate")],n.prototype,"calculateLateEndDate",null),N_([fw("totalSlack")],n.prototype,"calculateTotalSlack",null),N_([fw("critical")],n.prototype,"calculateCritical",null),n})));function z_(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return W_(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return W_(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function W_(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function G_(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var Y_=function(e){fe()(n,e);var t=G_(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([vO],(function(e){e.prototype;return function(e){fe()(n,e);var t=G_(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"hasProposedValueForUnits",value:Vr.a.mark((function e(){var t,n,r,i,o;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.assigned;case 2:t=e.sent,n=z_(t),e.prev=4,n.s();case 6:if((r=n.n()).done){e.next=20;break}return i=r.value,e.next=10,i.$.resource;case 10:if(o=e.sent,e.t0=o,!e.t0){e.next=16;break}return e.next=15,Pk(i.$.units);case 15:e.t0=e.sent;case 16:if(!e.t0){e.next=18;break}return e.abrupt("return",!0);case 18:e.next=6;break;case 20:e.next=25;break;case 22:e.prev=22,e.t1=e.catch(4),n.e(e.t1);case 25:return e.prev=25,n.f(),e.finish(25);case 28:return e.abrupt("return",!1);case 29:case"end":return e.stop()}}),e,this,[[4,22,25,28]])}))}]),n}(e)})));function U_(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return q_(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return q_(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function q_(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function K_(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var X_=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":l()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},Z_=function(e){fe()(n,e);var t=K_(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([Y_,XI],(function(e){e.prototype;var t=function(e){fe()(n,e);var t=K_(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"getEffort",value:function(e){var t=this.effort;return void 0!==e?this.getProject().convertDuration(t,this.effortUnit,e):t}},{key:"writeEffort",value:function(e,t,n,r,i){r<0&&(r=0),(t.baseRevision.hasIdentifier(e)||null!=r)&&(null!=i&&i!==this.effortUnit&&this.$.effortUnit.write.call(this,this.$.effortUnit,t,null,i),e.constructor.prototype.write(e,t,n,r))}},{key:"setEffortUnit",value:function(e){throw new Error("Use `setEffort` instead")}},{key:"calculateTotalChildrenEffort",value:Vr.a.mark((function e(){var t,n,r,i,o,a,s;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.childEvents;case 2:t=e.sent,n=this.getProject(),r=0,i=U_(t),e.prev=6,i.s();case 8:if((o=i.n()).done){e.next=24;break}return a=o.value,e.next=12,a.$.effortUnit;case 12:return s=e.sent,e.t0=r,e.t1=n,e.next=17,a.$.effort;case 17:return e.t2=e.sent,e.t3=s,e.t4=KC.Millisecond,e.delegateYield(e.t1.$convertDuration.call(e.t1,e.t2,e.t3,e.t4),"t5",21);case 21:r=e.t0+=e.t5;case 22:e.next=8;break;case 24:e.next=29;break;case 26:e.prev=26,e.t6=e.catch(6),i.e(e.t6);case 29:return e.prev=29,i.f(),e.finish(29);case 32:return e.t7=n,e.t8=r,e.t9=KC.Millisecond,e.next=37,this.$.effortUnit;case 37:return e.t10=e.sent,e.delegateYield(e.t7.$convertDuration.call(e.t7,e.t8,e.t9,e.t10),"t11",39);case 39:return e.abrupt("return",e.t11);case 40:case"end":return e.stop()}}),e,this,[[6,26,29,32]])}))},{key:"calculateEffort",value:Vr.a.mark((function e(){var t;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.childEvents;case 2:if(!(e.sent.size>0)){e.next=8;break}return e.delegateYield(this.calculateTotalChildrenEffort(),"t0",5);case 5:return e.abrupt("return",e.t0);case 8:return e.next=10,vk;case 10:if(void 0===(t=e.sent)){e.next=15;break}e.t1=t,e.next=17;break;case 15:return e.delegateYield(this.calculateEffortPure(),"t2",16);case 16:e.t1=e.t2;case 17:return e.abrupt("return",e.t1);case 18:case"end":return e.stop()}}),e,this)}))},{key:"calculateEffortPure",value:Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.childEvents;case 2:if(!(e.sent.size>0)){e.next=8;break}return e.delegateYield(this.calculateTotalChildrenEffort(),"t0",5);case 5:return e.abrupt("return",e.t0);case 8:return e.t1=this,e.next=11,this.$.startDate;case 11:return e.t2=e.sent,e.next=14,this.$.endDate;case 14:return e.t3=e.sent,e.delegateYield(e.t1.calculateProjectedEffort.call(e.t1,e.t2,e.t3),"t4",16);case 16:return e.abrupt("return",e.t4);case 17:case"end":return e.stop()}}),e,this)}))},{key:"calculateEffortProposed",value:Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,vk;case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))},{key:"calculateAssignmentUnits",value:Vr.a.mark((function e(t){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this.calculateAssignmentUnitsProposed(t),"t0",1);case 1:return e.abrupt("return",e.t0);case 2:case"end":return e.stop()}}),e,this)}))},{key:"calculateAssignmentUnitsPure",value:Vr.a.mark((function e(t){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this.calculateUnitsByStartEndAndEffort(t),"t0",1);case 1:return e.abrupt("return",e.t0);case 2:case"end":return e.stop()}}),e,this)}))},{key:"calculateAssignmentUnitsProposed",value:Vr.a.mark((function e(t){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,vk;case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))},{key:"getBaseOptionsForEffortCalculations",value:Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{ignoreResourceCalendars:!1});case 1:case"end":return e.stop()}}),e)}))},{key:"calculateProjectedEffort",value:Vr.a.mark((function e(t,n){var r,i,o,a,s,u,c,l,f,d,h,v,p;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(null==t||null==n||t>n)){e.next=2;break}return e.abrupt("return",null);case 2:return e.next=4,this.$.assignmentsByCalendar;case 4:r=e.sent,i=new Map,o=U_(r),e.prev=7,o.s();case 9:if((a=o.n()).done){e.next=34;break}s=ye()(a.value,2),u=s[0],c=s[1],l=0,f=U_(c),e.prev=13,f.s();case 15:if((d=f.n()).done){e.next=23;break}return h=d.value,e.t0=l,e.next=20,h.$.units;case 20:l=e.t0+=e.sent;case 21:e.next=15;break;case 23:e.next=28;break;case 25:e.prev=25,e.t1=e.catch(13),f.e(e.t1);case 28:return e.prev=28,f.f(),e.finish(28);case 31:i.set(u,l);case 32:e.next=9;break;case 34:e.next=39;break;case 36:e.prev=36,e.t2=e.catch(7),o.e(e.t2);case 39:return e.prev=39,o.f(),e.finish(39);case 42:return v=0,e.t3=Object,e.delegateYield(this.getBaseOptionsForEffortCalculations(),"t4",45);case 45:if(e.t5=e.t4,e.t6={startDate:t,endDate:n},p=e.t3.assign.call(e.t3,e.t5,e.t6),0!==i.size){e.next=55;break}return e.t7=i,e.next=52,this.$.effectiveCalendar;case 52:e.t8=e.sent,e.t7.set.call(e.t7,e.t8,100),p.ignoreResourceCalendars=!0;case 55:return e.delegateYield(this.forEachAvailabilityInterval(p,(function(e,t,n){var r,o=n.getCalendarsWorking(),a=e.getTime(),s=t.getTime()-a,u=0,c=U_(o);try{for(c.s();!(r=c.n()).done;){var l=r.value;u+=i.get(l)||0}}catch(e){c.e(e)}finally{c.f()}v+=u*s*.01})),"t9",56);case 56:return e.t10=this.getProject(),e.t11=v,e.t12=KC.Millisecond,e.next=61,this.$.effortUnit;case 61:return e.t13=e.sent,e.delegateYield(e.t10.$convertDuration.call(e.t10,e.t11,e.t12,e.t13),"t14",63);case 63:return e.abrupt("return",e.t14);case 64:case"end":return e.stop()}}),e,this,[[7,36,39,42],[13,25,28,31]])}))},{key:"calculateUnitsByStartEndAndEffort",value:Vr.a.mark((function e(t){var n,r,i,o,a,s;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.effort;case 2:return n=e.sent,e.next=5,this.$.effortUnit;case 5:return r=e.sent,e.delegateYield(this.getProject().$convertDuration(n,r,KC.Millisecond),"t0",7);case 7:return i=e.t0,o=0,e.t1=Object,e.delegateYield(this.getBaseOptionsForEffortCalculations(),"t2",11);case 11:return e.t3=e.t2,e.next=14,this.$.startDate;case 14:return e.t4=e.sent,e.next=17,this.$.endDate;case 17:return e.t5=e.sent,e.t6={startDate:e.t4,endDate:e.t5},a=e.t1.assign.call(e.t1,e.t3,e.t6),e.next=22,this.$.assignmentsByCalendar;case 22:return s=e.sent,e.delegateYield(this.forEachAvailabilityInterval(a,(function(e,t,n){var r,i=n.getCalendarsWorking(),a=e.getTime(),u=t.getTime()-a,c=U_(i);try{for(c.s();!(r=c.n()).done;){var l=r.value;o+=(s.has(l)?s.get(l).length:0)*u}}catch(e){c.e(e)}finally{c.f()}})),"t7",24);case 24:return e.abrupt("return",o?100*i/o:100);case 25:case"end":return e.stop()}}),e,this)}))},{key:"calculateProjectedXDateByEffort",value:Vr.a.mark((function e(t){var n,r,i,o,a,s,u,c,l,f,d,h,v,p,g,y,m,k,b,w=arguments;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=!(w.length>1&&void 0!==w[1])||w[1],e.next=3,this.$.effort;case 3:return r=e.sent,e.next=6,this.$.effortUnit;case 6:return i=e.sent,e.delegateYield(this.getProject().$convertDuration(r,i,KC.Millisecond),"t0",8);case 8:if(o=e.t0,null!=t&&null!=r){e.next=11;break}return e.abrupt("return",null);case 11:return a=t.getTime(),s=o,e.next=15,this.$.effectiveCalendar;case 15:return u=e.sent,e.next=18,this.$.assignmentsByCalendar;case 18:c=e.sent,l=new Map,f=U_(c),e.prev=21,f.s();case 23:if((d=f.n()).done){e.next=48;break}h=ye()(d.value,2),v=h[0],p=h[1],g=0,y=U_(p),e.prev=27,y.s();case 29:if((m=y.n()).done){e.next=37;break}return k=m.value,e.t1=g,e.next=34,k.$.units;case 34:g=e.t1+=e.sent;case 35:e.next=29;break;case 37:e.next=42;break;case 39:e.prev=39,e.t2=e.catch(27),y.e(e.t2);case 42:return e.prev=42,y.f(),e.finish(42);case 45:l.set(v,g);case 46:e.next=23;break;case 48:e.next=53;break;case 50:e.prev=50,e.t3=e.catch(21),f.e(e.t3);case 53:return e.prev=53,f.f(),e.finish(53);case 56:if(!(c.size>0)){e.next=66;break}return e.t4=Object,e.delegateYield(this.getBaseOptionsForDurationCalculations(),"t5",59);case 59:return e.t6=e.t5,e.t7=n?{startDate:t,isForward:n}:{endDate:t,isForward:n},b=e.t4.assign.call(e.t4,e.t6,e.t7),e.delegateYield(this.forEachAvailabilityInterval(b,(function(e,t,r){var i,o=r.getCalendarsWorking(),u=e.getTime(),c=t.getTime(),f=c-u,d=0,h=U_(o);try{for(h.s();!(i=h.n()).done;){var v=i.value;d+=l.get(v)||0}}catch(e){h.e(e)}finally{h.f()}var p=d*f*.01;if(p>=s)return a=n?u+s/(.01*d):c-s/(.01*d),!1;s-=p})),"t8",63);case 63:return e.abrupt("return",new Date(a));case 66:return e.abrupt("return",u.accumulateWorkingTime(t,o,n).finalDate);case 67:case"end":return e.stop()}}),e,this,[[21,50,53,56],[27,39,42,45]])}))}]),n}(e);return X_([Vw({type:"number"})],t.prototype,"effort",void 0),X_([Vw({type:"string",defaultValue:KC.Hour},{converter:Zt.normalizeUnit})],t.prototype,"effortUnit",void 0),X_([dw("effort")],t.prototype,"writeEffort",null),X_([fw("effort")],t.prototype,"calculateEffort",null),t})));function J_(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var Q_=Symbol("EffortVar"),eB=Symbol("UnitsVar"),tB=iR.new({output:Q_,inputs:new Set([pR,gR,eB])}),nB=iR.new({output:eB,inputs:new Set([pR,gR,Q_])}),rB=iR.new({output:gR,inputs:new Set([pR,Q_,eB])}),iB=iR.new({output:pR,inputs:new Set([gR,Q_,eB])}),oB=function(e){fe()(n,e);var t=J_(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(DR),aB=function(e){fe()(n,e);var t=J_(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"equality",value:function(e,t){var r=e.resolution,i=t.resolution;return r.get(Q_)===i.get(Q_)&&r.get(eB)===i.get(eB)&&we()(pe()(n.prototype),"equality",this).call(this,e,t)}}]),n}(RR);function sB(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var uB=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":l()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},cB=function(e){fe()(n,e);var t=sB(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([Z_],(function(e){var t=e.prototype,n=function(e){fe()(r,e);var n=sB(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"calculateSchedulingMode",value:Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,vk;case 2:if(e.t0=e.sent,e.t0){e.next=5;break}e.t0=ZC.Normal;case 5:return e.abrupt("return",e.t0);case 6:case"end":return e.stop()}}),e)}))},{key:"effectiveSchedulingMode",value:Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.assignmentsByCalendar;case 2:if(!(e.sent.size>0)){e.next=9;break}return e.next=6,this.$.schedulingMode;case 6:e.t0=e.sent,e.next=10;break;case 9:e.t0=ZC.Normal;case 10:return e.abrupt("return",e.t0);case 11:case"end":return e.stop()}}),e,this)}))},{key:"effectiveSchedulingModeSync",value:function(e){return e(this.$.assignmentsByCalendar).size>0?e(this.$.schedulingMode):ZC.Normal}},{key:"prepareDispatcher",value:Vr.a.mark((function e(n){var r;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this.effectiveSchedulingMode(),"t0",1);case 1:if(e.t0===ZC.Normal){e.next=13;break}return e.delegateYield(t.prepareDispatcher.call(this,n),"t1",4);case 4:return(r=e.t1).collectInfo(n,this.$.effort,Q_),e.delegateYield(this.hasProposedValueForUnits(),"t2",7);case 7:if(!e.t2){e.next=9;break}r.addProposedValueFlag(eB);case 9:return r.addPreviousValueFlag(eB),e.abrupt("return",r);case 13:return e.delegateYield(t.prepareDispatcher.call(this,n),"t3",14);case 14:return e.abrupt("return",e.t3);case 15:case"end":return e.stop()}}),e,this)}))},{key:"dispatcherClass",value:function(e){return this.effectiveSchedulingModeSync(e)!==ZC.Normal?oB:t.dispatcherClass.call(this,e)}},{key:"buildProposedDispatcher",value:function(e,n,r){var i=t.buildProposedDispatcher.call(this,e,n,r);return i.addPreviousValueFlag(Q_),i.addPreviousValueFlag(eB),i}},{key:"calculateAssignmentUnits",value:Vr.a.mark((function e(n){var r,i;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this.effectiveSchedulingMode(),"t0",1);case 1:if(e.t0===ZC.Normal){e.next=20;break}return e.next=5,this.$.dispatcher;case 5:if(r=e.sent,(i=r.resolution.get(eB))!==rR){e.next=12;break}return e.delegateYield(this.calculateAssignmentUnitsProposed(n),"t1",9);case 9:return e.abrupt("return",e.t1);case 12:if(i!==nB.formulaId){e.next=17;break}return e.delegateYield(this.calculateAssignmentUnitsPure(n),"t2",14);case 14:return e.abrupt("return",e.t2);case 17:throw new Error("Unknown formula for `units`");case 18:e.next=22;break;case 20:return e.delegateYield(t.calculateAssignmentUnits.call(this,n),"t3",21);case 21:return e.abrupt("return",e.t3);case 22:case"end":return e.stop()}}),e,this)}))},{key:"calculateEffort",value:Vr.a.mark((function e(){var n,r;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this.effectiveSchedulingMode(),"t0",1);case 1:if(e.t0===ZC.Normal){e.next=20;break}return e.next=5,this.$.dispatcher;case 5:if(n=e.sent,(r=n.resolution.get(Q_))!==rR){e.next=12;break}return e.delegateYield(this.calculateEffortProposed(),"t1",9);case 9:return e.abrupt("return",e.t1);case 12:if(r!==tB.formulaId){e.next=17;break}return e.delegateYield(this.calculateEffortPure(),"t2",14);case 14:return e.abrupt("return",e.t2);case 17:throw new Error("Unknown formula for `effort`");case 18:e.next=22;break;case 20:return e.delegateYield(t.calculateEffort.call(this),"t3",21);case 21:return e.abrupt("return",e.t3);case 22:case"end":return e.stop()}}),e,this)}))},{key:"calculateStartDate",value:Vr.a.mark((function e(){var n;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this.effectiveSchedulingMode(),"t0",1);case 1:if(e.t0===ZC.Normal){e.next=20;break}return e.next=5,this.$.dispatcher;case 5:if(n=e.sent,n.resolution.get(pR)!==iB.formulaId){e.next=16;break}return e.t1=this,e.next=11,this.$.endDate;case 11:return e.t2=e.sent,e.delegateYield(e.t1.calculateProjectedXDateByEffort.call(e.t1,e.t2,!1),"t3",13);case 13:return e.abrupt("return",e.t3);case 16:return e.delegateYield(t.calculateStartDate.call(this),"t4",17);case 17:return e.abrupt("return",e.t4);case 18:e.next=22;break;case 20:return e.delegateYield(t.calculateStartDate.call(this),"t5",21);case 21:return e.abrupt("return",e.t5);case 22:case"end":return e.stop()}}),e,this)}))},{key:"calculateEndDate",value:Vr.a.mark((function e(){var n;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this.effectiveSchedulingMode(),"t0",1);case 1:if(e.t0===ZC.Normal){e.next=20;break}return e.next=5,this.$.dispatcher;case 5:if(n=e.sent,n.resolution.get(gR)!==rB.formulaId){e.next=16;break}return e.t1=this,e.next=11,this.$.startDate;case 11:return e.t2=e.sent,e.delegateYield(e.t1.calculateProjectedXDateByEffort.call(e.t1,e.t2,!0),"t3",13);case 13:return e.abrupt("return",e.t3);case 16:return e.delegateYield(t.calculateEndDate.call(this),"t4",17);case 17:return e.abrupt("return",e.t4);case 18:e.next=22;break;case 20:return e.delegateYield(t.calculateEndDate.call(this),"t5",21);case 21:return e.abrupt("return",e.t5);case 22:case"end":return e.stop()}}),e,this)}))},{key:"calculateEffectiveDuration",value:Vr.a.mark((function e(){var n,r,i,o,a,s,u,c;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.dispatcher;case 2:return n=e.sent,e.delegateYield(this.effectiveSchedulingMode(),"t0",4);case 4:if(r=e.t0,i=n.resolution.get(yR),n.resolution.get(Q_),i!==bR.formulaId||r==ZC.Normal){e.next=42;break}return e.next=10,Fk(this.$.startDate);case 10:return a=e.sent,e.next=13,Fk(this.$.endDate);case 13:return s=e.sent,u=n.resolution.get(pR),c=n.resolution.get(gR),e.next=18,this.$.effortDriven;case 18:if(e.sent,!s||u!==iB.formulaId){e.next=28;break}return e.t1=this,e.delegateYield(this.calculateProjectedXDateByEffort(s,!1),"t2",22);case 22:return e.t3=e.t2,e.t4=s,e.delegateYield(e.t1.calculateProjectedDuration.call(e.t1,e.t3,e.t4),"t5",25);case 25:o=e.t5,e.next=40;break;case 28:if(!a||c!==rB.formulaId){e.next=37;break}return e.t6=this,e.t7=a,e.delegateYield(this.calculateProjectedXDateByEffort(a,!0),"t8",32);case 32:return e.t9=e.t8,e.delegateYield(e.t6.calculateProjectedDuration.call(e.t6,e.t7,e.t9),"t10",34);case 34:o=e.t10,e.next=40;break;case 37:if(!(a&&s||!a&&!s)){e.next=40;break}return e.delegateYield(t.calculateEffectiveDuration.call(this),"t11",39);case 39:o=e.t11;case 40:e.next=44;break;case 42:return e.delegateYield(t.calculateEffectiveDuration.call(this),"t12",43);case 43:o=e.t12;case 44:return e.abrupt("return",o);case 45:case"end":return e.stop()}}),e,this)}))}]),r}(e);return uB([Vw({type:"boolean",defaultValue:!1})],n.prototype,"effortDriven",void 0),uB([Vw({type:"string",defaultValue:ZC.Normal},{sync:!0})],n.prototype,"schedulingMode",void 0),uB([lw({identifierCls:aB})],n.prototype,"dispatcher",void 0),uB([fw("schedulingMode")],n.prototype,"calculateSchedulingMode",null),uB([fw("effort")],n.prototype,"calculateEffort",null),uB([fw("startDate")],n.prototype,"calculateStartDate",null),uB([fw("endDate")],n.prototype,"calculateEndDate",null),n})));function lB(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return fB(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return fB(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function fB(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function dB(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var hB=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":l()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},vB=function(e){fe()(n,e);var t=dB(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([cO,V_],(function(e){var t=e.prototype,n=function(e){fe()(r,e);var n=dB(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"calculateLateStartDateConstraintIntervals",value:Vr.a.mark((function e(){var n,r,i,o,a,s,u,c,l,f,d,h,v,p,g;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(t.calculateLateStartDateConstraintIntervals.call(this),"t0",1);case 1:return n=e.t0,r=this.getProject(),e.t1=lB,e.next=6,this.$.outgoingDeps;case 6:e.t2=e.sent,o=(0,e.t1)(e.t2),e.prev=8,o.s();case 10:if((a=o.n()).done){e.next=70;break}return i=a.value,e.next=14,i.$.toEvent;case 14:if(null!=(s=e.sent)&&!ek(s)){e.next=17;break}return e.abrupt("continue",68);case 17:return u=void 0,e.next=20,i.$.type;case 20:e.t3=e.sent,e.next=e.t3===QC.StartToStart?23:e.t3===QC.StartToEnd?45:67;break;case 23:return e.next=25,s.$.lateStartDateRaw;case 25:if(!(c=e.sent)){e.next=44;break}return e.next=29,i.$.lag;case 29:return l=e.sent,e.next=32,i.$.lagUnit;case 32:return f=e.sent,e.next=35,i.$.calendar;case 35:return d=e.sent,e.t4=BI,e.t5=d,e.t6=c,e.delegateYield(r.$convertDuration(l,f,KC.Millisecond),"t7",40);case 40:e.t8=e.t7,e.t9=e.t5.calculateStartDate.call(e.t5,e.t6,e.t8),e.t10={startDate:null,endDate:e.t9},u=e.t4.new.call(e.t4,e.t10);case 44:return e.abrupt("break",67);case 45:return e.next=47,s.$.lateEndDateRaw;case 47:if(!(h=e.sent)){e.next=66;break}return e.next=51,i.$.lag;case 51:return v=e.sent,e.next=54,i.$.lagUnit;case 54:return p=e.sent,e.next=57,i.$.calendar;case 57:return g=e.sent,e.t11=BI,e.t12=g,e.t13=h,e.delegateYield(r.$convertDuration(v,p,KC.Millisecond),"t14",62);case 62:e.t15=e.t14,e.t16=e.t12.calculateStartDate.call(e.t12,e.t13,e.t15),e.t17={startDate:null,endDate:e.t16},u=e.t11.new.call(e.t11,e.t17);case 66:return e.abrupt("break",67);case 67:u&&n.unshift(u);case 68:e.next=10;break;case 70:e.next=75;break;case 72:e.prev=72,e.t18=e.catch(8),o.e(e.t18);case 75:return e.prev=75,o.f(),e.finish(75);case 78:return e.abrupt("return",n);case 79:case"end":return e.stop()}}),e,this,[[8,72,75,78]])}))},{key:"calculateLateEndDateConstraintIntervals",value:Vr.a.mark((function e(){var n,r,i,o,a,s,u,c,l,f,d,h,v,p,g;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(t.calculateLateEndDateConstraintIntervals.call(this),"t0",1);case 1:return n=e.t0,r=this.getProject(),e.t1=lB,e.next=6,this.$.outgoingDeps;case 6:e.t2=e.sent,o=(0,e.t1)(e.t2),e.prev=8,o.s();case 10:if((a=o.n()).done){e.next=70;break}return i=a.value,e.next=14,i.$.toEvent;case 14:if(null!=(s=e.sent)&&!ek(s)){e.next=17;break}return e.abrupt("continue",68);case 17:return u=void 0,e.next=20,i.$.type;case 20:e.t3=e.sent,e.next=e.t3===QC.EndToEnd?23:e.t3===QC.EndToStart?45:67;break;case 23:return e.next=25,s.$.lateEndDateRaw;case 25:if(!(c=e.sent)){e.next=44;break}return e.next=29,i.$.lag;case 29:return l=e.sent,e.next=32,i.$.lagUnit;case 32:return f=e.sent,e.next=35,i.$.calendar;case 35:return d=e.sent,e.t4=BI,e.t5=d,e.t6=c,e.delegateYield(r.$convertDuration(l,f,KC.Millisecond),"t7",40);case 40:e.t8=e.t7,e.t9=e.t5.calculateStartDate.call(e.t5,e.t6,e.t8),e.t10={startDate:null,endDate:e.t9},u=e.t4.new.call(e.t4,e.t10);case 44:return e.abrupt("break",67);case 45:return e.next=47,s.$.lateStartDateRaw;case 47:if(!(h=e.sent)){e.next=66;break}return e.next=51,i.$.lag;case 51:return v=e.sent,e.next=54,i.$.lagUnit;case 54:return p=e.sent,e.next=57,i.$.calendar;case 57:return g=e.sent,e.t11=BI,e.t12=g,e.t13=h,e.delegateYield(r.$convertDuration(v,p,KC.Millisecond),"t14",62);case 62:e.t15=e.t14,e.t16=e.t12.calculateStartDate.call(e.t12,e.t13,e.t15),e.t17={startDate:null,endDate:e.t16},u=e.t11.new.call(e.t11,e.t17);case 66:return e.abrupt("break",67);case 67:u&&n.unshift(u);case 68:e.next=10;break;case 70:e.next=75;break;case 72:e.prev=72,e.t18=e.catch(8),o.e(e.t18);case 75:return e.prev=75,o.f(),e.finish(75);case 78:return e.abrupt("return",n);case 79:case"end":return e.stop()}}),e,this,[[8,72,75,78]])}))}]),r}(e);return hB([fw("lateStartDateIntervals")],n.prototype,"calculateLateStartDateConstraintIntervals",null),hB([fw("lateEndDateIntervals")],n.prototype,"calculateLateEndDateConstraintIntervals",null),n}))),pB=sR.new({variables:new Set([pR,gR,yR,Q_,eB]),formulas:new Set([mR,kR,bR,nB,tB])}),gB=uR.new({description:pB,defaultResolutionFormulas:new Set([kR,tB])}),yB=uR.new({description:pB,defaultResolutionFormulas:new Set([kR,nB])}),mB=uR.new({description:pB,defaultResolutionFormulas:new Set([mR,tB])}),kB=uR.new({description:pB,defaultResolutionFormulas:new Set([mR,nB])});function bB(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var wB=function(e){fe()(n,e);var t=bB(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([cB],(function(e){var t=e.prototype;return function(e){fe()(r,e);var n=bB(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"prepareDispatcher",value:Vr.a.mark((function e(n){var r,i;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this.effectiveSchedulingMode(),"t0",1);case 1:if(e.t0!==ZC.FixedDuration){e.next=16;break}return e.delegateYield(t.prepareDispatcher.call(this,n),"t1",4);case 4:return r=e.t1,e.next=7,this.$.effortDriven;case 7:return(i=e.sent)&&r.addKeepIfPossibleFlag(Q_),e.next=11,Pk(this.$.assigned);case 11:if(!e.sent){e.next=13;break}i?r.addProposedValueFlag(Q_):r.addProposedValueFlag(eB);case 13:return e.abrupt("return",r);case 16:return e.delegateYield(t.prepareDispatcher.call(this,n),"t2",17);case 17:return e.abrupt("return",e.t2);case 18:case"end":return e.stop()}}),e,this)}))},{key:"cycleResolutionContext",value:function(e){if(this.effectiveSchedulingModeSync(e)===ZC.FixedDuration){var n=e(this.$.direction),r=e(this.$.effortDriven);return n===nS.Forward||n===nS.None?r?yB:gB:r?kB:mB}return t.cycleResolutionContext.call(this,e)}},{key:"getBaseOptionsForDurationCalculations",value:Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this.effectiveSchedulingMode(),"t0",1);case 1:if(e.t0!==ZC.FixedDuration){e.next=6;break}return e.abrupt("return",{ignoreResourceCalendars:!0});case 6:return e.delegateYield(t.getBaseOptionsForDurationCalculations.call(this),"t1",7);case 7:return e.abrupt("return",e.t1);case 8:case"end":return e.stop()}}),e,this)}))}]),r}(e)}))),CB=sR.new({variables:new Set([pR,gR,yR,Q_,eB]),formulas:new Set([rB,bR,nB,tB,iB,mR,kR])}),SB=uR.new({description:CB,defaultResolutionFormulas:new Set([rB,bR])}),DB=uR.new({description:CB,defaultResolutionFormulas:new Set([iB,bR])});function RB(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var xB=function(e){fe()(n,e);var t=RB(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([cB],(function(e){var t=e.prototype;return function(e){fe()(r,e);var n=RB(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"prepareDispatcher",value:Vr.a.mark((function e(n){var r;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this.effectiveSchedulingMode(),"t0",1);case 1:if(e.t0!==ZC.FixedEffort){e.next=13;break}return e.delegateYield(t.prepareDispatcher.call(this,n),"t1",4);case 4:return r=e.t1,e.next=7,Pk(this.$.assigned);case 7:if(!e.sent){e.next=9;break}r.addProposedValueFlag(eB);case 9:return r.addKeepIfPossibleFlag(Q_),e.abrupt("return",r);case 13:return e.delegateYield(t.prepareDispatcher.call(this,n),"t2",14);case 14:return e.abrupt("return",e.t2);case 15:case"end":return e.stop()}}),e,this)}))},{key:"cycleResolutionContext",value:function(e){if(this.effectiveSchedulingModeSync(e)===ZC.FixedEffort){var n=e(this.$.direction);return n===nS.Forward||n===nS.None?SB:DB}return t.cycleResolutionContext.call(this,e)}}]),r}(e)}))),EB=sR.new({variables:new Set([pR,gR,yR,Q_,eB]),formulas:new Set([rB,bR,tB,nB,iB,mR,kR])}),TB=uR.new({description:EB,defaultResolutionFormulas:new Set([rB,kR,tB])}),MB=uR.new({description:EB,defaultResolutionFormulas:new Set([rB,kR,bR])}),AB=uR.new({description:EB,defaultResolutionFormulas:new Set([iB,mR,tB])}),PB=uR.new({description:EB,defaultResolutionFormulas:new Set([iB,mR,bR])});function IB(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var OB=function(e){fe()(n,e);var t=IB(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([cB],(function(e){var t=e.prototype;return function(e){fe()(r,e);var n=IB(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"prepareDispatcher",value:Vr.a.mark((function e(n){var r;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this.effectiveSchedulingMode(),"t0",1);case 1:if(e.t0!==ZC.FixedUnits){e.next=17;break}return e.delegateYield(t.prepareDispatcher.call(this,n),"t1",4);case 4:return r=e.t1,e.next=7,Pk(this.$.assigned);case 7:if(!e.sent){e.next=9;break}r.addProposedValueFlag(eB);case 9:return e.next=11,this.$.effortDriven;case 11:if(!e.sent){e.next=13;break}r.addKeepIfPossibleFlag(Q_);case 13:return r.addKeepIfPossibleFlag(eB),e.abrupt("return",r);case 17:return e.delegateYield(t.prepareDispatcher.call(this,n),"t2",18);case 18:return e.abrupt("return",e.t2);case 19:case"end":return e.stop()}}),e,this)}))},{key:"cycleResolutionContext",value:function(e){if(this.effectiveSchedulingModeSync(e)===ZC.FixedUnits){var n=e(this.$.direction),r=e(this.$.effortDriven);return n===nS.Forward||n===nS.None?r?MB:TB:r?PB:AB}return t.cycleResolutionContext.call(this,e)}}]),r}(e)})));function FB(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var LB=function(e){fe()(n,e);var t=FB(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Um([gO,__,V_,vB,Y_,Z_,cB,wB,xB,OB],(function(e){e.prototype;return function(e){fe()(n,e);var t=FB(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(e)})));function jB(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var _B=function(e){fe()(o,e);var t,n,r,i=jB(o);function o(){return v()(this,o),i.apply(this,arguments)}return g()(o,[{key:"setMilestone",value:(r=Wr()(Vr.a.mark((function e(t){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t?this.convertToMilestone():this.convertToRegular());case 1:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"convertToMilestone",value:(n=Wr()(Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.setDuration(0,this.durationUnit,!1));case 1:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"convertToRegular",value:(t=Wr()(Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.milestone){e.next=2;break}return e.abrupt("return",this.setDuration(1,this.durationUnit,!1));case 2:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"isBaseline",get:function(){return!0}},{key:"milestone",get:function(){if(!this.isLeaf){var e=this.startDate,t=this.endDate;if(e&&t)return t.getTime()===e.getTime()}return 0===this.duration},set:function(e){e?this.convertToMilestone():this.convertToRegular()}}],[{key:"fields",get:function(){return[{name:"task",persist:!1}]}}]),o}(Qy);function BB(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}_B._$name="Baseline";var HB=function(e,t){var n=e.startDate,r=e.durationUnit,i=e.endDate;return t?t.map((function(t){return Object.assign({task:e,startDate:n,durationUnit:r,endDate:i},t)})):[]},$B=function(e){return"wbsIndex"===e.field&&!e.ascending},NB=Object.freeze([]),VB=F_.prototype.compare,zB={deep:!0,silent:!0},WB=function(e){fe()(a,e);var t,n,r,i,o=BB(a);function a(){return v()(this,a),o.apply(this,arguments)}return g()(a,[{key:"copy",value:function(){for(var e,t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var i=(e=we()(pe()(a.prototype),"copy",this)).call.apply(e,[this].concat(n));return i.setData("wbsIndex",null),i}},{key:"setBaseline",value:function(e){var t=this.baselines;if(e>t.count+1)throw new Error("Attempt to set baseline ".concat(e," when there are only ").concat(t.count," baselines"));if(e===t.count+1)return t.add(HB(this,[{}]));t.getAt(e-1).set(HB(this,[{}])[0])}},{key:"setSuccessors",value:function(e){var t=this,n=t.project.dependencyStore,r=new Set,i=new Set,o=[];return e.forEach((function(e){t.incomingDeps.has(e)?r.add(e):i.add(e)})),t.incomingDeps.forEach((function(e){r.has(e)||o.push(e)})),o.forEach((function(e){return n.remove(e)})),i.forEach((function(e){e.fromEvent=t,n.add(e)})),t.commitAsync()}},{key:"setPredecessors",value:function(e){var t=this,n=t.project.dependencyStore,r=new Set,i=new Set,o=[];return e.forEach((function(e){t.incomingDeps.has(e)?r.add(e):i.add(e)})),t.incomingDeps.forEach((function(e){r.has(e)||o.push(e)})),o.forEach((function(e){return n.remove(e)})),i.forEach((function(e){e.toEvent=t,n.add(e)})),t.commitAsync()}},{key:"setMilestone",value:(i=Wr()(Vr.a.mark((function e(t){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",t?this.convertToMilestone():this.convertToRegular());case 1:case"end":return e.stop()}}),e,this)}))),function(e){return i.apply(this,arguments)})},{key:"convertToMilestone",value:(r=Wr()(Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.setDuration(0,this.durationUnit,!1));case 1:case"end":return e.stop()}}),e,this)}))),function(){return r.apply(this,arguments)})},{key:"convertToRegular",value:(n=Wr()(Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this.milestone){e.next=2;break}return e.abrupt("return",this.setDuration(1,this.durationUnit,!1));case 2:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"normalize",value:function(){}},{key:"inSetNormalize",value:function(e){}},{key:"setStartEndDate",value:function(){throw new Error("Not supported")}},{key:"joinStore",value:function(e){var t,n,r,i=this;i.wbsIndex||((null===(t=i.taskStore)||void 0===t?void 0:t.isLoadingData)||!(null===(n=i.nextSibling)||void 0===n?void 0:n.wbsIndex)&&!(null===(r=i.previousSibling)||void 0===r?void 0:r.wbsIndex)?i.refreshWbs(zB):i.parent.refreshWbs(zB,-1));we()(pe()(a.prototype),"joinStore",this).call(this,e)}},{key:"refreshWbs",value:function(e,t){var n,r=this,i=r.parent;if(i&&-1!==t&&r.fieldMap.wbsIndex){var o,a;t=null!==(o=null!==(a=t)&&void 0!==a?a:r.unfilteredIndex)&&void 0!==o?o:r.parentIndex;var s=(i.isRoot?NB:i.wbsIndex).concat(t+1);(null==e?void 0:e.silent)?r.setData("wbsIndex",s):r.set("wbsIndex",s)}if(null===(n=null==e?void 0:e.deep)||void 0===n||n){var u,c=null!==(u=r.unfilteredChildren)&&void 0!==u?u:r.children,l=(null==c?void 0:c.length)||0;if(l)for(var f,d,h=function(e){for(var t,n,r=0,i=e.length;r<i;++r)if(n=e[r].wbsIndex){if(t)return VB(n,t)<0;t=n}return!1}(c)&&0===(null===(f=r.taskStore)||void 0===f||null===(d=f.sorters)||void 0===d?void 0:d.findIndex($B)),v=0;v<l;++v)c[v].refreshWbs(e,h?l-v-1:v)}}},{key:"tryInsertChild",value:(t=Wr()(Vr.a.mark((function e(){var t=arguments,n=this;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.getProject().tryPropagateWithChanges((function(){n.insertChild.apply(n,d()(t))})));case 1:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"isTask",get:function(){return!0}},{key:"isEvent",get:function(){return!0}},{key:"wbsCode",get:function(){var e;return null===(e=this.wbsIndex)||void 0===e?void 0:e.join(".")},set:function(e){this.wbsIndex=F_.parseValue(e)}},{key:"hasBaselines",get:function(){var e;return(null===(e=this.baselinesStore)||void 0===e?void 0:e.count)||Boolean(this.originalData.baselines)}},{key:"baselines",get:function(){var e=this;return e.baselinesStore||(e.baselinesStore=new No({modelClass:e.constructor.getDefaultConfiguration().baselineModelClass,data:HB(e,e.originalData.baselines)})),e.baselinesStore}},{key:"successors",get:function(){return Array.from(this.outgoingDeps||[])},set:function(e){this.outgoingDeps=e}},{key:"predecessors",get:function(){return Array.from(this.incomingDeps||[])},set:function(e){this.incomingDeps=e}},{key:"isDraggable",get:function(){return this.draggable}},{key:"isResizable",get:function(){return this.resizable&&!this.milestone&&!this.isParent}},{key:"milestone",get:function(){if(!this.isLeaf){var e=this.startDate,t=this.endDate;if(e&&t)return t.getTime()===e.getTime()}return 0===this.duration},set:function(e){e?this.convertToMilestone():this.convertToRegular()}},{key:"isMilestone",get:function(){return this.milestone}},{key:"allDependencies",get:function(){return this.dependencies}},{key:"dependencies",get:function(){return[].concat(d()(this.incomingDeps||[]),d()(this.outgoingDeps||[]))}},{key:"predecessorTasks",get:function(){return d()(this.incomingDeps||[]).map((function(e){return e.fromEvent}))}},{key:"successorTasks",get:function(){return d()(this.outgoingDeps||[]).map((function(e){return e.toEvent}))}},{key:"previousSiblingsTotalCount",get:function(){for(var e=this.previousSibling,t=this.parentIndex;e;)t+=e.descendantCount,e=e.previousSibling;return t}},{key:"sequenceNumber",get:function(){for(var e=0,t=this;t.parent;)e+=t.previousSiblingsTotalCount+1,t=t.parent;return e}},{key:"isSubProject",get:function(){return!1}},{key:"subProject",get:function(){var e=null;return this.isProject?e=this:this.bubbleWhile((function(t){return t.isProject&&(e=t),!e})),e}},{key:"fullEffort",get:function(){return new Ko({unit:this.effortUnit,magnitude:this.effort})},set:function(e){this.setEffort(e.magnitude,e.unit)}},{key:"resources",get:function(){return this.assignments.reduce((function(e,t){return t.resource&&e.push(t.resource),e}),[])}}],[{key:"fields",get:function(){return[{name:"cls",serialize:function(e){return e.isDomClassList?e.toString():e},persist:!0},{name:"fullEffort",persist:!1},{name:"baselines"},{name:"note",type:"string"},{name:"parentId",serialize:function(e,t){var n=t.getEventStore(),r=t.getProject();return n&&n.getById(e)===r&&(e=null),e}},{name:"children",persist:!1},{name:"showInTimeline",type:"boolean"},{name:"rollup",type:"boolean"},{name:"wbsIndex",type:"wbs",persist:!1},{name:"deadlineDate",type:"date"},{name:"parentIndex",type:"number",persist:!0},"iconCls","taskIconCls",{name:"draggable",type:"boolean",persist:!1,defaultValue:!0},{name:"resizable",persist:!1,defaultValue:!0}]}},{key:"defaultConfig",get:function(){return{baselineModelClass:_B}}}]),a}(LB.derive(Qy).mixin(yI,jI));function GB(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return YB(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return YB(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function YB(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function UB(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}WB.convertEmptyParentToLeaf=!0,WB._$name="TaskModel";var qB=function(e){return e.replace(/(\d+)/g,(function(e){return+e+1e5}))},KB=function(e){fe()(i,e);var t,n,r=UB(i);function i(){return v()(this,i),r.apply(this,arguments)}return g()(i,[{key:"setBaseline",value:function(e){var t=this.storage.values;this.forEach((function(t){return t.setBaseline(e)})),this.trigger("refresh",{action:"batch",records:t,data:t})}},{key:"indent",value:(n=Wr()(Vr.a.mark((function e(t){var n,r,i,o;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(n=this).taskStore,i=n.project,o=!1,!(t=(t=(t=Array.isArray(t)?t.slice():[t]).filter((function(e){return!e.isProjectModel&&!1!==i.trigger("beforeIndent",{task:e})}))).filter((function(e){var n;for(n=Boolean(e.previousSibling);n&&!e.isRoot;)n=!t.includes(e.parent),e=e.parent;return n}))).length){e.next=13;break}return t.sort((function(e,t){var n=qB(e.wbsCode),r=qB(t.wbsCode);return n<r?-1:n>r?1:0})),r.beginBatch(),e.next=10,i.tryPropagateWithChanges((function(){var e,r=GB(t);try{for(r.s();!(e=r.n()).done;){var i=e.value,o=i.previousSibling;o.appendChild(i),n.toggleCollapse(o,!1)}}catch(e){r.e(e)}finally{r.f()}}));case 10:o=e.sent,r.endBatch(),o&&(n.trigger("indent",{records:t}),n.trigger("change",{action:"indent",records:t}));case 13:return e.abrupt("return",o);case 14:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"outdent",value:(t=Wr()(Vr.a.mark((function e(t){var n,r,i,o;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=(n=this).taskStore,i=n.project,o=!1,!(t=(t=(t=Array.isArray(t)?t.slice():[t]).filter((function(e){return!e.isProjectModel&&!1!==i.trigger("beforeOutdent",{task:e})}))).filter((function(e){var n;for(n=e.parent&&!e.parent.isRoot;n&&!e.isRoot;)n=!t.includes(e.parent),e=e.parent;return n}))).length){e.next=13;break}return t.sort((function(e,t){var n=qB(e.wbsCode),r=qB(t.wbsCode);return n<r?1:n>r?-1:0})),r.beginBatch(),e.next=10,i.tryPropagateWithChanges((function(){var e,r=GB(t);try{for(r.s();!(e=r.n()).done;){var i=e.value,o=i.parent.children.slice(i.parent.children.indexOf(i)+1);i.parent.parent.insertChild(i,i.parent.nextSibling),i.appendChild(o),n.toggleCollapse(i,!1)}}catch(e){r.e(e)}finally{r.f()}}));case 10:o=e.sent,r.endBatch(),o&&(n.trigger("outdent",{records:t}),n.trigger("change",{action:"outdent",records:t}));case 13:return e.abrupt("return",o);case 14:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"getTotalTimeSpan",value:function(){return{startDate:this.getProject().startDate,endDate:this.getProject().endDate}}},{key:"getEvents",value:function(e){var t=e.filter,n=e.resourceRecord,r=e.startDate,i=e.endDate,o=this;if(!o.count)return[];var a=o.isFiltered?function(e){return o.indexOf(e)>-1}:null,s=o.getEventsForResource(n);return a&&(s=s.filter(a)),s=s.filter((function(e){return e.startDate&&Zt.intersectSpans(e.startDate,e.endDate||e.startDate,r,i)})),t?s.filter(t):s}},{key:"getEventsForResource",value:function(e){var t=this,n=this.resourceStore.getById(e);return((null==n?void 0:n.assignments.filter((function(e){return e.isPartOfStore(t.assignmentStore)})))||[]).map((function(e){return e.event}))}}],[{key:"defaultConfig",get:function(){return{modelClass:WB,loadPriority:200,syncPriority:300,storeId:"tasks",tree:!0}}}]),i}(nx.derive(Uo).mixin(yI));function XB(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}KB._$name="TaskStore";var ZB=function(e){fe()(n,e);var t=XB(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e,t){this.tipId="".concat(e.id,"-baselines-tip"),this.gantt=e,we()(pe()(n.prototype),"construct",this).call(this,e,t)}},{key:"doDisable",value:function(e){var t=this.client,r=t.features.dependencies;t.refreshWithTransition(),r&&t.setTimeout((function(){return r.scheduleDraw(!0)}),300),we()(pe()(n.prototype),"doDisable",this).call(this,e)}},{key:"resolveTimeSpanRecord",value:function(e){var t=e.closest(".b-task-baseline");return null==t?void 0:t.elementData.baseline}},{key:"template",value:function(e){var t=e.baseline,n=t.task,r=this.client.formatDuration(t.duration);return'\n            <div class="b-gantt-task-title">'.concat(n.name," (baseline ").concat(t.parentIndex+1,")</div>\n            <table>\n            <tr><td>").concat(this.L("L{TaskTooltip.Start}"),":</td><td>").concat(e.startClockHtml,"</td></tr>\n            ").concat(t.milestone?"":"\n                <tr><td>".concat(this.L("L{TaskTooltip.End}"),":</td><td>").concat(e.endClockHtml,"</td></tr>\n                <tr><td>").concat(this.L("L{TaskTooltip.Duration}"),':</td><td class="b-right">').concat(r+" "+Zt.getLocalizedNameOfUnit(t.durationUnit,1!==t.duration),"</td></tr>\n            "),"\n            </table>\n            ")}},{key:"getTaskDOMConfig",value:function(e,t){var n=this,r=e.baselines.allRecords;return{className:{"b-baseline-wrap":!0,"b-baseline-milestone":e.milestone},style:{transform:"translateY(".concat(t,"px)")},dataset:{taskId:"baselinesFor".concat(e.id)},children:r.map((function(e,t){var r=n.gantt.taskRendering.getTaskBox(e);return r?{className:e.cls+"b-task-baseline",style:{width:r.width,left:r.left},dataset:{index:t},elementData:{baseline:e}}:null})),syncOptions:{syncIdField:"index"}}}},{key:"onTaskDataGenerated",value:function(e){var t=e.taskRecord,n=e.top,r=e.extraConfigs;!this.disabled&&t.hasBaselines&&r.push(this.getTaskDOMConfig(t,n))}}],[{key:"$name",get:function(){return"Baselines"}},{key:"defaultConfig",get:function(){return{cls:"b-gantt-task-tooltip",align:"t-b",forSelector:".b-task-baseline",recordType:"baseline"}}},{key:"pluginConfig",get:function(){return{chain:["onTaskDataGenerated","render"]}}}]),n}(sT);function JB(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}ZB._$name="Baselines",fv.registerFeature(ZB,!1,"Gantt");var QB=function(e){fe()(r,e);var t,n=JB(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"doAddNewAtEnd",value:(t=Wr()(Vr.a.mark((function e(){var t,n,r,i;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.grid,n=this.addNewAtEnd,r=t.taskStore,i=r.rootNode.appendChild(Object.assign({name:"New task",startDate:r.getProject().startDate},n)),e.next=3,r.getProject().commitAsync();case 3:return t.rowManager.getRowFor(i)||t.rowManager.displayRecordAtBottom(),e.abrupt("return",i);case 5:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}],[{key:"$name",get:function(){return"CellEdit"}}]),r}(xy);function eH(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return tH(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return tH(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function tH(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function nH(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}QB._$name="CellEdit",fv.registerFeature(QB,!0,"Gantt");var rH=function(e){fe()(n,e);var t=nH(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"doDisable",value:function(e){e?this.unhighlightCriticalPaths():this.highlightCriticalPaths(),we()(pe()(n.prototype),"doDisable",this).call(this,e)}},{key:"getDependenciesFeature",value:function(){return this.client.foregroundCanvas&&this.client.features.dependencies}},{key:"setupObserver",value:function(){var e=this,t=e.client.project,n=e.getDependenciesFeature();e.destroyObserver(),e.criticalPathObserver=t.getGraph().observe(Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.$.criticalPaths;case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})),(function(t){if(!e.disabled){e.removeCriticalCls();var r,i=eH(t);try{for(i.s();!(r=i.n()).done;){var o,a=eH(r.value);try{for(a.s();!(o=a.n()).done;){var s=o.value;n&&s.dependency&&n.highlight(s.dependency,e.criticalDependencyCls)}}catch(e){a.e(e)}finally{a.f()}}}catch(e){i.e(e)}finally{i.f()}e.client.trigger("criticalPathsHighlighted")}}))}},{key:"destroyObserver",value:function(){this.criticalPathObserver&&(this.client.project.getGraph().removeIdentifier(this.criticalPathObserver),this.criticalPathObserver=null)}},{key:"doDestroy",value:function(){this.destroyObserver()}},{key:"highlightCriticalPaths",value:function(){var e=this,t=e.client.element;t.classList.contains(e.cls)&&e.unhighlightCriticalPaths(),e.setupObserver(),t.classList.add(e.cls)}},{key:"removeCriticalCls",value:function(){var e=this,t=this.client.project,n=this.getDependenciesFeature();n&&t.dependencyStore.forEach((function(t){return n.unhighlight(t,e.criticalDependencyCls)}))}},{key:"unhighlightCriticalPaths",value:function(){var e=this.client;this.destroyObserver(),this.removeCriticalCls(),e.element.classList.remove(this.cls),e.trigger("criticalPathsUnhighlighted")}},{key:"onTaskDataGenerated",value:function(e){this.disabled||(e.cls["b-critical"]=e.taskRecord.critical)}}],[{key:"$name",get:function(){return"CriticalPaths"}},{key:"defaultConfig",get:function(){return{cls:"b-gantt-critical-paths",criticalDependencyCls:"b-critical",disabled:!0}}},{key:"pluginConfig",get:function(){return{chain:["onTaskDataGenerated"]}}}]),n}(_a(qr));function iH(){var e=El()(['\n             <table class="b-sch-dependency-tooltip">\n                <tr>\n                    <td>',": </td>\n                    <td>"," ",'</td>\n                    <td><div class="b-sch-box b-','"></div></td>\n                </tr>\n                <tr>\n                    <td>',": </td>\n                    <td>"," ",'</td>\n                    <td><div class="b-sch-box b-','"></div></td>\n                </tr>\n            </table>\n        ']);return iH=function(){return e},e}function oH(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return aH(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return aH(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function aH(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function sH(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}rH._$name="CriticalPaths",fv.registerFeature(rH,!0,"Gantt");var uH=["left","left","right","right"],cH=["left","right","left","right"],lH=function(e){fe()(n,e);var t=sH(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this;e.isGantt&&(r.gantt=e),Object.prototype.hasOwnProperty.call(t,"pathFinderConfig")?(Object.prototype.hasOwnProperty.call(t.pathFinderConfig,"otherHorizontalMargin")||(t.pathFinderConfig.otherHorizontalMargin=0),Object.prototype.hasOwnProperty.call(t.pathFinderConfig,"otherVerticalMargin")||(t.pathFinderConfig.otherVerticalMargin=0)):t.pathFinderConfig={otherHorizontalMargin:0,otherVerticalMargin:0},e.on({projectRefresh:"onProjectRefresh",thisObj:r}),r.added=new Set,we()(pe()(n.prototype),"construct",this).call(this,e,t)}},{key:"attachToEventStore",value:function(e){we()(pe()(n.prototype),"attachToEventStore",this).call(this,e),this.detachListeners("taskStore"),e&&e.on({name:"taskStore",refreshPreCommit:"onTaskStoreRefresh",thisObj:this})}},{key:"onDependencyChange",value:function(e){var t=this,r=e.action,i=(e.record,e.records);if(!this.client.project.propagatingLoadChanges){switch(r){case"add":return void i.forEach((function(e){return t.added.add(e)}))}we()(pe()(n.prototype),"onDependencyChange",this).apply(this,arguments)}}},{key:"onTaskStoreRefresh",value:function(e){switch(e.action){case"sort":this.scheduleDraw(!0)}}},{key:"getIteratableDependencyAssignments",value:function(e){return[null]}},{key:"isDependencyVisible",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=this.client,i=e.fromEvent,o=e.toEvent;if(i&&o&&Object(i)===i&&Object(o)===o)return i instanceof WB&&!t?!i.placeHolder&&r.store.isAvailable(i)&&!o.placeHolder&&r.store.isAvailable(o):we()(pe()(n.prototype),"isDependencyVisible",this).call(this,e,t)}},{key:"getBox",value:function(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=this.getTimeSpanRecordFromDependency(e,t);return this.gantt?this.gantt.getTaskBox(i,!0,!0):i.isEvent||r?we()(pe()(n.prototype),"getBox",this).call(this,e,t,r):i.assignments.length?this.client.getResourceEventBox(i,i.assignments[0].resource,!0):null}},{key:"getRowRecordFromDependency",value:function(e,t){if(!this.gantt){var r=this.getTimeSpanRecordFromDependency(e,t);return r.isEvent?we()(pe()(n.prototype),"getRowRecordFromDependency",this).call(this,e,t):r.assignments.length?r.assignments[0].resource:null}return this.getTimeSpanRecordFromDependency(e,t)}},{key:"onProjectRefresh",value:function(){var e=this.added;if(e.size){var t,r=oH(e);try{for(r.s();!(t=r.n()).done;){var i=t.value;this.addToGridCache(i)}}catch(e){r.e(e)}finally{r.f()}e.clear()}we()(pe()(n.prototype),"onProjectRefresh",this).call(this),this.scheduleDraw()}},{key:"drawLine",value:function(e,t,r){var i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,o=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];we()(pe()(n.prototype),"drawLine",this).call(this,e,t,r,i);var a=we()(pe()(n.prototype),"drawLine",this).call(this,e,t,r,i,o),s=this.client,u=t.toEvent;(!u.milestone&&(u.endDate<=s.startDate||s.endDate<=u.startDate)||u.milestone&&(u.endDate<s.startDate||s.endDate<u.startDate))&&a.classList.add("b-sch-dependency-ends-outside")}},{key:"prepareLineDef",value:function(e,t){var n=this,r=n.getTimeSpanRecordFromDependency(e,!0),i=n.getTimeSpanRecordFromDependency(e,!1),o=e.type,a=this.pathFinder.startArrowMargin,s=e.fromSide,u=e.toSide;if(!s)switch(!0){case o===QC.StartToEnd:case o===QC.StartToStart:s=n.getConnectorStartSide(r);break;case o===QC.EndToStart:case o===QC.EndToEnd:s=n.getConnectorEndSide(r);break;default:throw new Error("Invalid dependency type: "+o)}if(!u)switch(!0){case o===QC.StartToEnd:u=n.getConnectorEndSide(i);break;case o===QC.StartToStart:case o===QC.EndToStart:u=n.getConnectorStartSide(i);break;case o===QC.EndToEnd:u=n.getConnectorEndSide(i);break;default:throw new Error("Invalid dependency type: "+o)}var c=t.startRectangle,l=t.endRectangle;o===QC.EndToStart&&c.bottom<l.y&&Math.round(c.right)-Math.round(l.x)<=0&&(u="top",e.toEvent.milestone||(l.right=l.x+2*a));var f=n.client.getRecordCoords(r,!0),d=n.client.getRecordCoords(i,!0),h=[{start:c.x,end:c.right,top:f.y,bottom:f.y+f.height},{start:l.x,end:l.right,top:d.y,bottom:d.y+d.height}];return{endBox:{start:c.x,end:c.right,top:c.y,bottom:c.bottom},startBox:{start:l.x,end:l.right,top:l.y,bottom:l.bottom},endSide:s,startSide:u,boxesReversed:!0,otherBoxes:h}}},{key:"drawForTask",value:function(e){this.drawForTimeSpan(e)}},{key:"getSortedDependenciesToRefresh",value:function(){var e=this.client.features.criticalPaths;return e&&!e.disabled?new Map(d()(this.dependenciesToRefresh).sort((function(e,t){var n=ye()(e,1)[0].fromTask,r=ye()(t,1)[0].fromTask;return(null==n?void 0:n.critical)===(null==r?void 0:r.critical)?0:(null==n?void 0:n.critical)?1:-1}))):this.dependenciesToRefresh}},{key:"getHoverTipHtml",value:function(e){var t=e.activeTarget,n=this.resolveDependencyRecord(t);if(!n)return null;var r=n.fromEvent,i=n.toEvent;return Iu.tpl(iH(),this.L("L{Dependencies.from}"),r.name,r.id,uH[n.type],this.L("L{Dependencies.to}"),i.name,i.id,cH[n.type])}},{key:"createDependency",value:function(e){var t=e.source,n=e.target,r=e.sourceTerminal.dataset.side,i=e.targetTerminal.dataset.side,o=("left"===r?0:2)+("right"===i?1:0);this.dependencyStore.add({fromEvent:t,toEvent:n,type:o,fromSide:r,toSide:i}),this.dependencyStore.project.propagateAsync()}},{key:"createMarkers",value:function(){we()(pe()(n.prototype),"createMarkers",this).call(this);var e=(this.startMarker||this.endMarker).cloneNode(!0);e.setAttribute("id","arrowEndCritical"),this.client.svgCanvas.appendChild(e)}}],[{key:"$name",get:function(){return"Dependencies"}},{key:"defaultConfig",get:function(){return{terminalSides:["left","right"],storeClass:T_,highlightDependenciesOnEventHover:!0}}}]),n}(pP);function fH(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}lH._$name="Dependencies",fv.registerFeature(lH,!0,"Gantt");var dH=function(e){fe()(n,e);var t=fH(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"$name",get:function(){return"DependencyEdit"}},{key:"defaultConfig",get:function(){return{showLagField:!0}}}]),n}(kP);function hH(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}dH._$name="DependencyEdit",fv.registerFeature(dH,!1);var vH=function(e){fe()(n,e);var t=hH(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"onTaskDataGenerated",value:function(e){this.onEventDataGenerated(e)}}],[{key:"$name",get:function(){return"Labels"}},{key:"pluginConfig",get:function(){return{chain:["onTaskDataGenerated"]}}}]),n}(xP);function pH(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}vH._$name="Labels",fv.registerFeature(vH,!1,"Gantt");var gH=function(e){fe()(n,e);var t=pH(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.tipId="".concat(e.id,"-indicators-tip"),this.gantt=e;var r=t.items;delete t.items,we()(pe()(n.prototype),"construct",this).call(this,e,t),this.items=r}},{key:"createIndicatorDOMConfig",value:function(e,t){var n=this.gantt,r=this.renderData,i=r.taskRecord,o=e.cls,a=e.iconCls,s=n.getCoordinateFromDate(e.startDate),u=e.endDate?n.getCoordinateFromDate(e.endDate)-s:null,c=o&&o.isDomClassList?o:new An(o),l=r.top||n.taskStore.indexOf(i)*n.rowManager.rowOffsetHeight+n.resourceMargin,f=r.height||n.rowHeight-2*n.resourceMargin;return{className:Object.assign(c,{"b-indicator":1,"b-has-icon":e.iconCls}),style:{transform:"translate(".concat(s,"px, ").concat(l,"px)"),height:f,width:u,style:e.style},dataset:{taskId:"".concat(r.taskId,"-indicator-").concat(t),title:e.name},children:[a?{tag:"i",className:a}:null],elementData:e}}},{key:"onTaskDataGenerated",value:function(e){var t,n=this.items,r=[];for(var i in n){var o=n[i];if(this._indicatorStatus[i]&&"function"==typeof o){var a=o(e.taskRecord);a&&this.gantt.timeAxis.timeSpanInAxis(a.startDate,a.endDate)&&r.push(a)}}(t=e.extraConfigs).push.apply(t,d()(r.map(this.createIndicatorDOMConfig,{gantt:this.gantt,renderData:e})))}},{key:"resolveTimeSpanRecord",value:function(e){return e.lastDomConfig.elementData}},{key:"template",value:function(e){var t=e.indicator;return e.endDate?"\n                ".concat(t.name?'<div class="b-gantt-task-title">'.concat(t.name,"</div>"):"",'\n                <table border="0" cellspacing="0" cellpadding="0">\n                    <tr><td>').concat(this.L("L{Start}"),":</td><td>").concat(e.startClockHtml,"</td></tr>\n                    <tr><td>").concat(this.L("L{End}"),":</td><td>").concat(e.endClockHtml,"</td></tr>\n                </table>\n            "):"\n            ".concat(t.name?'<div class="b-gantt-task-title">'.concat(t.name,"</div>"):"","\n            ").concat(e.startText,"\n        ")}},{key:"items",set:function(e){var t=this;t._indicators=an.assign({},t.defaultIndicators,e),t._indicatorAccessors={},t._indicatorStatus={};var n=function(e){t._indicatorStatus[e]=Boolean(t._indicators[e]),"function"!=typeof t._indicators[e]&&(t._indicators[e]=t.defaultIndicators[e]),Object.defineProperty(t._indicatorAccessors,e,{enumerable:!0,get:function(){return!!t._indicatorStatus[e]&&t._indicators[e]},set:function(n){t._indicatorStatus[e]=n,t.gantt.refresh()}})};for(var r in t._indicators)n(r)},get:function(){return this._indicatorAccessors}}],[{key:"$name",get:function(){return"Indicators"}},{key:"defaultConfig",get:function(){var e=this;return{cls:"b-gantt-task-tooltip",forSelector:".b-indicator",recordType:"indicator",hoverDelay:500,defaultIndicators:{earlyDates:function(t){return t.earlyStartDate&&!t.isMilestone?{startDate:t.earlyStartDate,endDate:t.earlyEndDate,cls:"b-bottom b-early-dates",name:e.L("L{earlyDates}")}:null},lateDates:function(t){return t.lateStartDate&&!t.isMilestone?{startDate:t.lateStartDate,endDate:t.lateEndDate,cls:"b-bottom b-late-dates",name:e.L("L{lateDates}")}:null},constraintDate:function(t){return t.constraintDate?{startDate:t.constraintDate,cls:"b-bottom b-constraint-date b-constraint-type-".concat(t.constraintType),name:e.L("L{ConstraintTypePicker.".concat(t.constraintType,"}"))}:null},deadlineDate:function(t){return t.deadlineDate?{startDate:t.deadlineDate,cls:"b-bottom b-deadline-date",name:e.L("L{deadlineDate}")}:null}},items:{}}}},{key:"pluginConfig",get:function(){return{chain:["onTaskDataGenerated","render"]}}}]),n}(sT);function yH(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}gH._$name="Indicators",fv.registerFeature(gH,!1);var mH=function(e){fe()(n,e);var t=yH(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=this;r.scheduleDraw=r.createOnFrame("draw",[],r,!0),we()(pe()(n.prototype),"construct",this).call(this,e,t),this.lineSegments=[]}},{key:"doDisable",value:function(e){this.attachToClient(e?null:this.client),this.client.rendered&&this.draw(),we()(pe()(n.prototype),"doDisable",this).call(this,e)}},{key:"getSVGCanvas",value:function(){var e=this,t=e.client;if(!e._svgCanvas){var n=e._svgCanvas=document.createElementNS("http://www.w3.org/2000/svg","svg");n.retainElement=!0,n.classList.add(e.containerCls),t.foregroundCanvas.appendChild(n)}return e._svgCanvas}},{key:"attachToProject",value:function(e){this.detachListeners("project"),e&&e.on({name:"project",refresh:this.onProjectRefresh,thisObj:this})}},{key:"attachToRowManager",value:function(e){var t=this;t.detachListeners("rowManager"),e&&e.on({name:"rowManager",translaterow:t.onTranslateRow,refresh:t.scheduleDraw,rerender:t.scheduleDraw,changetotalheight:t.scheduleDraw,thisObj:t})}},{key:"attachToClient",value:function(e){var t=this;t.detachListeners("client"),e&&e.on({name:"client",horizontalscroll:t.scheduleDraw,togglenode:t.scheduleDraw,taskdrag:t.onTaskDrag,taskdragabort:t.scheduleDraw,aftertaskdrop:t.scheduleDraw,timelineviewportresize:t.scheduleDraw,thisObj:t}),t.attachToProject(null==e?void 0:e.project),t.attachToRowManager(null==e?void 0:e.rowManager)}},{key:"onPaint",value:function(){this.attachToProject(this.disabled?null:this.client.project)}},{key:"onProjectRefresh",value:function(){this.scheduleDraw()}},{key:"onTranslateRow",value:function(e){var t=e.row;t.lastTop>=0&&t.top!==t.lastTop&&this.scheduleDraw()}},{key:"onTaskDrag",value:function(e){var t=this,n=e.taskRecords,r=e.dragData;n.forEach((function(e){t.updateLineForTask(e,ke()({},e.id,Zt.add(e.startDate,r.timeDiff)))}))}},{key:"shouldDrawProgressLine",value:function(){return!this.client.timeAxisSubGrid.collapsed&&!this.disabled&&(!this.drawLineOnlyWhenStatusDateVisible||this.client.timeAxis.dateInAxis(this.statusDate))}},{key:"getStatusDateX",value:function(){var e=this.statusDate,t=this.client;return t.timeAxis.dateInAxis(e)||(e=e<t.timeAxis.startDate?t.timeAxis.startDate:t.timeAxis.endDate),t.getCoordinateFromDate(e)}},{key:"getRenderData",value:function(){var e=this.getStatusDateX(),t=this.client.timeAxisSubGridElement.getBoundingClientRect();return{statusDateX:e,viewXY:[this.client.scrollLeft-t.left,-t.top]}}},{key:"draw",value:function(){var e=this,t=e.client;if(e.lineSegments.forEach((function(e){return e.remove()})),e.lineSegments=[],e.shouldDrawProgressLine())if(t.isAnimating)t.on({transitionend:function(){e.scheduleDraw()},once:!0});else{var n=e.getRenderData(),r=[];t.rowManager.forEach((function(t){r.push.apply(r,d()(e.getLineSegmentRenderData(t,n)))})),r.forEach((function(t){return e.drawLineSegment(t)})),t.trigger("progressLineDrawn")}}},{key:"segmentBelongsToTask",value:function(e,t){return e.dataset.taskId==t.id}},{key:"updateLineForTask",value:function(e,t){var n=this;if(!n.disabled){var r=n.client.getRowFor(e);if(r){var i=[];n.lineSegments.forEach((function(t){n.segmentBelongsToTask(t,e)&&(i.push(t),t.remove())})),De.remove.apply(De,[n.lineSegments].concat(i)),n.getLineSegmentRenderData(r,n.getRenderData(),t).forEach((function(e){return n.drawLineSegment(e)}))}}}},{key:"getLineSegmentRenderData",value:function(e,t){var n,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this,o=t.statusDateX,a=t.viewXY,s=i.client.getRecordFromElement(e.elements.normal),u=s.id,c=[];return i.isStatusLineTask(s,r[s.id])&&(n=i.calculateCoordinateForTask(s,a))&&c.push({dataset:{taskId:u},x1:o,y1:e.top,x2:n.x,y2:n.y},{dataset:{taskId:u},x1:n.x,y1:n.y,x2:o,y2:e.bottom}),n||c.push({dataset:{taskId:u},x1:o,y1:e.top,x2:o,y2:e.bottom}),c}},{key:"drawLineSegment",value:function(e){this.lineSegments.push(Cr.createElement(Object.assign({tag:"line",ns:"http://www.w3.org/2000/svg",class:this.lineCls,parent:this.getSVGCanvas()},e)))}},{key:"isStatusLineTask",value:function(e,t){var n=this.statusDate;return t=t||e.startDate,e&&this.client.timeAxis.isTimeSpanInAxis(e)&&!e.milestone&&(e.isInProgress||!e.isStarted&&t<n||e.isCompleted&&t>n)}},{key:"calculateCoordinateForTask",value:function(e,t){var n=this.client,r=n.getElementFromTaskRecord(e),i=null==r?void 0:r.querySelector(".b-task-percent-bar");if(i){var o=i.getBoundingClientRect(),a=n.timeAxisViewModel.totalSize;return{x:Math.min(o.right+t[0],a),y:o.top+o.height/2+t[1]}}}},{key:"statusDate",get:function(){return this._statusDate},set:function(e){e instanceof Date&&(this._statusDate=e,this.disabled||this.scheduleDraw())}}],[{key:"$name",get:function(){return"ProgressLine"}},{key:"defaultConfig",get:function(){return{statusDate:new Date,drawLineOnlyWhenStatusDateVisible:!1,lineCls:"b-gantt-progress-line",containerCls:"b-progress-line-canvas"}}},{key:"pluginConfig",get:function(){return{chain:["onPaint"]}}}]),n}(_a(qr));function kH(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}mH._$name="ProgressLine",fv.registerFeature(mH);var bH=function(e){fe()(n,e);var t=kH(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"startConfigure",value:function(){}},{key:"onPaint",value:function(){var e=this,t=e.store.add([{name:e.L("L{Project Start}")},{name:e.L("L{Project End}")}]),r=ye()(t,2);e.startDateLine=r[0],e.endDateLine=r[1],e.updateDateFromProject(),e.client.project.on({name:"project",refresh:e.onProjectRefresh,thisObj:e}),we()(pe()(n.prototype),"onPaint",this).call(this)}},{key:"updateLocalization",value:function(){var e=this;e.client.rendered&&(e.startDateLine.name=e.L("L{Project Start}"),e.endDateLine.name=e.L("L{Project End}"))}},{key:"updateDateFromProject",value:function(){var e=this.client.project;this.startDateLine.startDate=e.startDate,this.endDateLine.startDate=e.endDate}},{key:"onProjectRefresh",value:function(){this.updateDateFromProject()}}],[{key:"$name",get:function(){return"ProjectLines"}},{key:"defaultConfig",get:function(){return{showHeaderElements:!0,cls:"b-gantt-project-line"}}}]),n}(qA);function wH(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return CH(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return CH(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function CH(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function SH(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}bH._$name="ProjectLines",fv.registerFeature(bH,!0,"Gantt");var DH=".".concat("b-task-rollup"),RH=function(e){fe()(n,e);var t=SH(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e,t){this.tipId="".concat(e.id,"-rollups-tip"),we()(pe()(n.prototype),"construct",this).call(this,e,t)}},{key:"attachToTaskStore",value:function(e){this.detachListeners("taskStore"),e&&e.on({name:"taskStore",update:"onStoreUpdateRecord",thisObj:this})}},{key:"doDestroy",value:function(){this.attachToTaskStore(null),we()(pe()(n.prototype),"doDestroy",this).call(this)}},{key:"doDisable",value:function(e){var t=this,r=t.client.features.dependencies;t.tooltip&&(t.tooltip.disabled=e),t.attachToTaskStore(e?null:t.client.taskStore),t.client.refresh(),r&&t.client.setTimeout((function(){return r.scheduleDraw(!0)}),300),we()(pe()(n.prototype),"doDisable",this).call(this,e)}},{key:"getTipHtml",value:function(e){var t,n=e.activeTarget,r=e.event,i=this.client.resolveTaskRecord(n),o=j.a.isEdge||j.a.isIE11,a=document[o?"msElementsFromPoint":"elementsFromPoint"](r.pageX+window.pageXOffset,r.pageY+window.pageYOffset),s=[],u=wH(Array.from(a).filter((function(e){return e.classList.contains("b-task-rollup")})).sort((function(e,t){return parseInt(e.dataset.index,10)-parseInt(t.dataset.index,10)})));try{for(u.s();!(t=u.n()).done;){var c=t.value;s.push(i.children[parseInt(c.dataset.index,10)])}}catch(e){u.e(e)}finally{u.f()}return this.template({task:i,children:s})}},{key:"template",value:function(e){var t=e.children,n=this,r=n.client,i=[];return t.map((function(e,t){var o=e.startDate,a=e.endDate,s=r.getFormattedDate(o),u=r.getDisplayEndDate(a,o),c=r.getFormattedDate(u);i.push('<div class="b-gantt-task-title '.concat(t?"b-follow-on":"",'">').concat(e.name,"</div><table>"),"<tr><td>".concat(n.L("L{TaskTooltip.Start}"),":</td><td>").concat(n.clockTemplate.template({date:o,text:s,cls:"b-sch-tooltip-startdate"}),"</td></tr>"),"<tr><td>".concat(n.L("L{TaskTooltip.End}"),":</td><td>").concat(e.isMilestone?"":n.clockTemplate.template({date:u,text:c,cls:"b-sch-tooltip-enddate"}),"</td></tr></table>"))})),i.join("")}},{key:"onStoreUpdateRecord",value:function(e){var t=e.record,n=e.changes;this.client.project.propagatingLoadChanges||t.parent&&(n.rollup||n.startDate||n.endDate)&&this.client.taskRendering.redraw(t.parent)}},{key:"onTaskDataGenerated",value:function(e){var t=this,n=e.taskRecord,r=e.left,i=e.wrapperChildren;if(!this.disabled&&n.isParent){var o=n.children.slice().sort((function(e,t){return t.durationMS-e.durationMS}));i.push({className:"".concat("b-task-rollup","-wrap"),dataset:{taskFeature:"rollups"},children:o.map((function(e){if(e.rollup){var n=t.client.getSizeAndPosition(e);if(!n)return null;var i=n.position,o=n.width;return{dataset:{index:e.parentIndex,rollupTaskId:e.id},className:"".concat("b-task-rollup"," ").concat(e.isMilestone?"b-milestone":""," ").concat(e.cls),style:{width:e.isMilestone?null:o,left:i-r}}}return null})),syncOptions:{syncIdField:"rollupTaskId"}})}}}],[{key:"$name",get:function(){return"Rollups"}},{key:"defaultConfig",get:function(){return{cls:"b-gantt-task-tooltip",align:"t-b",forSelector:DH}}},{key:"pluginConfig",get:function(){return{chain:["onTaskDataGenerated","render"]}}}]),n}(sT);function xH(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}RH._$name="Rollups",fv.registerFeature(RH,!1,"Gantt");var EH=function(e){fe()(n,e);var t=xH(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"afterConfigure",value:function(){we()(pe()(n.prototype),"afterConfigure",this).call(this),"durationDecimalPrecision"in this&&y.a.deprecate("gantt","5.0.0","`durationDecimalPrecision` is deprecated, in favor of `durationDisplayPrecision`")}}],[{key:"type",get:function(){return"taskeditor"}},{key:"$name",get:function(){return"TaskEditor"}},{key:"defaultConfig",get:function(){return{cls:"b-gantt-taskeditor b-schedulerpro-taskeditor"}}}]),n}(NF);function TH(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}EH.initClass(),EH._$name="TaskEditor";var MH=function(e){fe()(n,e);var t=TH(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"editTask",value:function(e,t){return this.editEvent(e,null,t)}},{key:"onActivateEditor",value:function(e){var t=e.taskRecord,n=e.taskElement;this.editTask(t,n)}},{key:"getElementFromTaskRecord",value:function(e){return this.client.getElementFromTaskRecord(e)}},{key:"onTaskEnterKey",value:function(e){var t=e.taskRecord;this.editTask(t)}},{key:"populateTaskMenu",value:function(e){var t=this,n=e.taskRecord,r=e.selection,i=e.items;!this.client.readOnly&&r.length<=1&&(i.editTask={text:"L{Gantt.Edit}",localeClass:this.client,cls:"b-separator",icon:"b-icon b-icon-edit",weight:100,disabled:this.disabled,onItem:function(){return t.editTask(n)}})}},{key:"onEventEnterKey",value:function(e){var t=e.taskRecord;e.target;this.editTask(t)}},{key:"scrollTaskIntoView",value:function(e){this.scrollEventIntoView(e)}},{key:"scrollEventIntoView",value:function(e){this.client.scrollTaskIntoView(e)}}],[{key:"$name",get:function(){return"TaskEdit"}},{key:"defaultConfig",get:function(){return{triggerEvent:"taskdblclick",saveAndCloseOnEnter:!0,tabsConfig:null,editorClass:EH}}},{key:"pluginConfig",get:function(){return{chain:["populateTaskMenu","onTaskEnterKey"],assign:["editTask"]}}}]),n}(fL);function AH(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}MH._$name="TaskEdit",fv.registerFeature(MH,!0,"Gantt");var PH=function(e){fe()(n,e);var t=AH(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e,t){we()(pe()(n.prototype),"construct",this).apply(this,arguments),this.gantt=e,e.features.cellMenu&&(console.warn("`CellMenu` feature is ignored, when `TaskMenu` feature is enabled. If you need cell specific menu items, please configure `TaskMenu` feature items instead."),e.features.cellMenu.disabled=!0)}},{key:"getDataFromEvent",value:function(e){var t=this.client,n=this.getTargetElementFromEvent(e),r=t.resolveTaskRecord(n)||t.getRecordFromElement(n),i=r&&t.getElementFromTaskRecord(r,!1),o=t.getCellDataFromEvent(e);return an.assign({event:e,targetElement:n,taskElement:i,taskRecord:r},o)}},{key:"callChainablePopulateMenuMethod",value:function(e){e.cellData&&this.client.populateCellMenu&&this.client.populateCellMenu(e),we()(pe()(n.prototype),"callChainablePopulateMenuMethod",this).apply(this,arguments)}},{key:"shouldShowMenu",value:function(e){var t=e.column;return e.taskRecord&&(!t||!1!==t.enableCellContextMenu)}},{key:"getElementFromRecord",value:function(e){return this.client.getElementFromTaskRecord(e)}},{key:"populateTaskMenu",value:function(e){var t=e.items,n=e.column,r=e.selection,i=e.taskRecord,o=this.client,a=r.includes(i)&&r.length>1;Object.assign(t,{add:{text:"L{Gantt.Add}",cls:"b-separator",icon:"b-icon-add",hidden:a,weight:500,menu:{addTaskAbove:{text:"L{Gantt.Task above}",weight:510,icon:"b-icon-up",onItem:function(e){var t=e.taskRecord;o.addTaskAbove(t)}},addTaskBelow:{text:"L{Gantt.Task below}",weight:520,icon:"b-icon-down",onItem:function(e){var t=e.taskRecord;o.addTaskBelow(t)}},milestone:{text:"L{Gantt.Milestone}",weight:530,icon:"b-fa-flag",name:"milestone",onItem:function(e){var t=e.taskRecord;o.addMilestonBelow(t)}},subtask:{text:"L{Gantt.Sub-task}",weight:540,name:"subtask",onItem:function(e){var t=e.taskRecord;o.addSubtask(t)}},successor:{text:"L{Gantt.Successor}",weight:550,onItem:function(e){var t=e.taskRecord;o.addSuccessor(t)}},predecessor:{text:"L{Gantt.Predecessor}",weight:560,name:"predecessor",onItem:function(e){var t=e.taskRecord;o.addPredecessor(t)}}}},convertToMilestone:{icon:"b-icon-milestone",text:"L{Gantt.Convert to milestone}",weight:600,hidden:i.isParent||i.milestone,onItem:function(e){e.taskRecord.convertToMilestone()}},indent:{text:"L{Gantt.Indent}",icon:"b-fa-indent",disabled:!i.previousSibling,weight:700,onItem:function(e){var t=e.selection,n=e.taskRecord;o.indent(t.includes(n)?t:n)}},outdent:{text:"L{Gantt.Outdent}",icon:"b-fa-outdent",disabled:i.parent===o.taskStore.rootNode,weight:800,onItem:function(e){var t=e.selection,n=e.taskRecord;o.outdent(t.includes(n)?t:n)}},deleteTask:{text:"L{Gantt.Delete task}",icon:"b-icon-trash",name:"deleteTask",cls:"b-separator",weight:900,onItem:function(e){var t=e.selection,n=e.taskRecord;o.taskStore.remove(t.includes(n)?t:n)}}}),(null==n?void 0:n.cellMenuItems)&&an.merge(t,n.cellMenuItems)}}],[{key:"$name",get:function(){return"TaskMenu"}},{key:"defaultConfig",get:function(){return{type:"task"}}},{key:"pluginConfig",get:function(){var e=we()(pe()(n),"pluginConfig",this);return e.chain.push("populateTaskMenu"),e}}]),n}(Xx);function IH(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}PH.featureClass="",PH._$name="TaskMenu",fv.registerFeature(PH,!0,"Gantt");var OH=function(e){fe()(n,e);var t=IH(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e,t){we()(pe()(n.prototype),"construct",this).apply(this,arguments),y.a.deprecate("Gantt","5.0.0","`TaskContextMenu` feature is deprecated, in favor of `TaskMenu` feature. Please see https://bryntum.com/docs/gantt/#guides/upgrades/4.0.0.md#context-menu for more information."),e.features.taskMenu&&(e.features.taskMenu.disabled=!0),e.features.contextMenu&&(e.showRemoveRowInContextMenu=!1,e.features.contextMenu.disableCellContextMenu=!0)}},{key:"resolveRecord",value:function(e){return this.client.resolveTaskRecord(e)||this.client.getRecordFromElement(e)}},{key:"showContextMenuFor",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.targetElement,r=t.eventElement,i=t.event,o=this.client;if(e&&(n||(n=o.getElementFromTaskRecord(e)))){if(i){var a=o.getEventData(i);if(!a)return;var s=o.columns.getById(a.columnId);if(!r&&s&&!s.enableCellContextMenu)return}this.showContextMenu({menuType:"task",taskElement:n,targetElement:n,taskRecord:e,event:i})}}}],[{key:"$name",get:function(){return"TaskContextMenu"}}]),n}(PH);function FH(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}OH.featureClass="",OH._$name="TaskContextMenu",fv.registerFeature(OH);var LH=function(e){fe()(n,e);var t=FH(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"$name",get:function(){return"TaskTooltip"}},{key:"defaultConfig",get:function(){return{template:function(e){var t=this,n=e.taskRecord,r=t.client.formatDuration(n.duration,t.decimalPrecision);return"\n                    ".concat(n.name?'<div class="b-gantt-task-title">'.concat(n.name,"</div>"):"",'\n                    <table border="0" cellspacing="0" cellpadding="0">\n                    <tr><td>').concat(t.L("L{Start}"),":</td><td>").concat(e.startClockHtml,"</td></tr>\n                    ").concat(n.milestone?"":"\n                        <tr><td>".concat(t.L("L{End}"),":</td><td>").concat(e.endClockHtml,"</td></tr>\n                        <tr><td>").concat(t.L("L{Duration}"),':</td><td class="b-right">').concat(r+" "+Zt.getLocalizedNameOfUnit(n.durationUnit,1!==n.duration),"</td></tr>\n                        <tr><td>").concat(t.L("L{Complete}"),':</td><td class="b-right">').concat(n.renderedPercentDone,"%</td></tr>\n                    "),"\n                    </table>\n                ")},decimalPrecision:null,cls:"b-gantt-task-tooltip"}}}]),n}(sT);function jH(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}LH._$name="TaskTooltip",fv.registerFeature(LH,!0,"Gantt");var _H=function(e){return function(e){fe()(r,e);var t,n=jH(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"prepareComponent",value:(t=Wr()(Vr.a.mark((function e(t){var n;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,we()(pe()(r.prototype),"prepareComponent",this).call(this,t);case 2:n=this.element.querySelector(".b-sch-foreground-canvas"),Cr.removeEachSelector(n,".b-gantt-task-wrap"),Cr.removeEachSelector(n,".b-released");case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"collectEvents",value:function(e,t){var n=e.length,r=t.client,i=this.exportMeta.subGrids.normal.rows;e.forEach((function(e,t){var o=i[i.length-n+t],a=r.store.getAt(e.dataIndex),s=o[3];if(a.isScheduled){var u=r.getElementFromTaskRecord(a,!1);u&&!s.has(a.id)&&s.set(a.id,[u.outerHTML,En.from(u.firstChild,u.offsetParent)])}}))}}]),r}(e)};function BH(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var HH=function(e){fe()(n,e);var t=BH(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"$name",get:function(){return"MultiPageExporter"}}]),n}(_H(qP));function $H(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}HH._$name="MultiPageExporter";var NH=function(e){fe()(n,e);var t=$H(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"$name",get:function(){return"MultiPageVerticalExporter"}}]),n}(_H(XP));function VH(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}NH._$name="MultiPageVerticalExporter";var zH=function(e){fe()(n,e);var t=VH(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"$name",get:function(){return"SinglePageExporter"}}]),n}(_H(JP));function WH(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}zH._$name="SinglePageExporter";var GH=function(e){fe()(n,e);var t=WH(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"$name",get:function(){return"PdfExport"}},{key:"defaultConfig",get:function(){return{exporters:[zH,HH,NH]}}}]),n}(eI);function YH(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}GH._$name="PdfExport",fv.registerFeature(GH,!1,"Gantt");var UH=function(e){fe()(n,e);var t=YH(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(SI);function qH(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}UH._$name="CalendarIntervalModel";var KH=function(e){fe()(n,e);var t=qH(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(RI);function XH(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return ZH(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return ZH(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function ZH(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function JH(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}KH._$name="CalendarModel";var QH=function(e,t,n,r){var i,o=arguments.length,a=o<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,n):r;if("object"===("undefined"==typeof Reflect?"undefined":l()(Reflect))&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,n,r);else for(var s=e.length-1;s>=0;s--)(i=e[s])&&(a=(o<3?i(a):o>3?i(t,n,a):i(t,n))||a);return o>3&&a&&Object.defineProperty(t,n,a),a},e$=function(e){fe()(n,e);var t=JH(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([XI],(function(e){e.prototype;var t=function(e){fe()(n,e);var t=JH(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"calculateCriticalPaths",value:Vr.a.mark((function e(){var t,n,r,i,o,a,s,u,c,l,f,h,v,p,g,y,m,k;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=[],n=[],e.next=4,this.$.childEvents;case 4:return r=e.sent,i=d()(r),e.next=8,this.$.endDate;case 8:o=e.sent;case 9:if(!(a=i.shift())){e.next=20;break}return e.next=12,a.$.childEvents;case 12:return s=e.sent,e.next=15,a.$.critical;case 15:u=e.sent,a.endDate-o==0&&u&&n.push([{event:a}]),i.push.apply(i,d()(s)),e.next=9;break;case 20:if(!(c=n.shift())){e.next=59;break}l=c.length-1,f=void 0;case 22:if(!(f=c[l])){e.next=56;break}return h=[],e.t0=XH,e.next=27,f.event.$.incomingDeps;case 27:e.t1=e.sent,v=(0,e.t0)(e.t1),e.prev=29,v.s();case 31:if((p=v.n()).done){e.next=45;break}return g=p.value,e.next=35,g.$.fromEvent;case 35:if(y=e.sent,e.t2=y,!e.t2){e.next=41;break}return e.next=40,y.$.critical;case 40:e.t2=e.sent;case 41:e.t2&&h.push({event:y,dependency:g});case 43:e.next=31;break;case 45:e.next=50;break;case 47:e.prev=47,e.t3=e.catch(29),v.e(e.t3);case 50:return e.prev=50,v.f(),e.finish(50);case 53:if(h.length){for(m=c.slice(),c.push(h[0]),k=1;k<h.length;k++)n.push(m.concat(h[k]));l++}else l=-1;e.next=22;break;case 56:t.push(c.reverse()),e.next=20;break;case 59:return e.abrupt("return",t);case 60:case"end":return e.stop()}}),e,this,[[29,47,50,53]])}))}]),n}(e);return QH([lw({lazy:!0})],t.prototype,"criticalPaths",void 0),QH([fw("criticalPaths")],t.prototype,"calculateCriticalPaths",null),t})));function t$(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var n$=function(e){fe()(n,e);var t=t$(n);function n(){return v()(this,n),t.apply(this,arguments)}return n}(Ym([HO,Z_,V_,e$],(function(e){var t=e.prototype;return function(e){fe()(r,e);var n=t$(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"calculateDirection",value:Vr.a.mark((function e(){return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,vk;case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)}))},{key:"calculateStartDate",value:Vr.a.mark((function e(){var t,n;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.direction;case 2:if((t=e.sent)!==nS.Forward){e.next=13;break}return e.next=6,vk;case 6:if(n=e.sent){e.next=10;break}return e.delegateYield(this.unsafeCalculateInitialMinChildrenStartDateDeep(),"t0",9);case 9:n=e.t0;case 10:return e.abrupt("return",n);case 13:if(t!==nS.Backward){e.next=16;break}return e.delegateYield(this.calculateMinChildrenStartDate(),"t1",15);case 15:return e.abrupt("return",e.t1);case 16:case"end":return e.stop()}}),e,this)}))},{key:"calculateEndDate",value:Vr.a.mark((function e(){var t,n;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.direction;case 2:if((t=e.sent)!==nS.Forward){e.next=8;break}return e.delegateYield(this.calculateMaxChildrenEndDate(),"t0",5);case 5:return e.abrupt("return",e.t0);case 8:if(t!==nS.Backward){e.next=16;break}return e.next=11,vk;case 11:if(n=e.sent){e.next=15;break}return e.delegateYield(this.unsafeCalculateInitialMaxChildrenEndDateDeep(),"t1",14);case 14:n=e.t1;case 15:return e.abrupt("return",n);case 16:case"end":return e.stop()}}),e,this)}))},{key:"calculateEarlyStartDateConstraintIntervals",value:Vr.a.mark((function e(){var n,r,i,o;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(t.calculateEarlyStartDateConstraintIntervals.call(this),"t0",1);case 1:return n=e.t0,e.next=4,this.$.direction;case 4:if((r=e.sent)!==nS.Forward){e.next=12;break}return e.next=8,this.$.startDate;case 8:(i=e.sent)&&n.push(BI.new({startDate:i})),e.next=17;break;case 12:if(r!==nS.Backward){e.next=17;break}return e.next=15,this.$.lateStartDate;case 15:(o=e.sent)&&n.push(BI.new({startDate:o}));case 17:return e.abrupt("return",n);case 18:case"end":return e.stop()}}),e,this)}))},{key:"calculateLateEndDateConstraintIntervals",value:Vr.a.mark((function e(){var n,r,i,o;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(t.calculateLateEndDateConstraintIntervals.call(this),"t0",1);case 1:return n=e.t0,e.next=4,this.$.direction;case 4:if((r=e.sent)!==nS.Forward){e.next=12;break}return e.next=8,this.$.earlyEndDate;case 8:(i=e.sent)&&n.push(BI.new({endDate:i})),e.next=17;break;case 12:if(r!==nS.Backward){e.next=17;break}return e.next=15,this.$.endDate;case 15:(o=e.sent)&&n.push(BI.new({endDate:o}));case 17:return e.abrupt("return",n);case 18:case"end":return e.stop()}}),e,this)}))},{key:"getDefaultEventModelClass",value:function(){return LB}},{key:"getDefaultAssignmentModelClass",value:function(){return b_}},{key:"getDefaultResourceModelClass",value:function(){return AO}},{key:"getDefaultEventStoreClass",value:function(){return nx}},{key:"getType",value:function(){return tS.Gantt}},{key:"unsafeCalculateInitialMinChildrenStartDateDeep",value:Vr.a.mark((function e(){var t,n,r,i,o;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.childEvents;case 2:if((t=e.sent).size){e.next=7;break}return e.next=6,$k(this.$.startDate);case 6:return e.abrupt("return",e.sent);case 7:n=sS,i=d()(t);case 9:if(!(r=i.shift())){e.next=24;break}return e.next=12,$k(r.$.startDate);case 12:return(o=e.sent)&&o<n&&(n=o),e.t0=i.push,e.t1=i,e.t2=d.a,e.next=19,r.$.childEvents;case 19:e.t3=e.sent,e.t4=(0,e.t2)(e.t3),e.t0.apply.call(e.t0,e.t1,e.t4),e.next=9;break;case 24:return e.abrupt("return",n.getTime()!==aS.getTime()&&n.getTime()!==sS.getTime()?n:null);case 25:case"end":return e.stop()}}),e,this)}))},{key:"unsafeCalculateInitialMaxChildrenEndDateDeep",value:Vr.a.mark((function e(){var t,n,r,i,o;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.$.childEvents;case 2:if((t=e.sent).size){e.next=7;break}return e.next=6,$k(this.$.endDate);case 6:return e.abrupt("return",e.sent);case 7:n=aS,i=d()(t);case 9:if(!(r=i.shift())){e.next=24;break}return e.next=12,$k(r.$.endDate);case 12:return(o=e.sent)&&o>n&&(n=o),e.t0=i.push,e.t1=i,e.t2=d.a,e.next=19,r.$.childEvents;case 19:e.t3=e.sent,e.t4=(0,e.t2)(e.t3),e.t0.apply.call(e.t0,e.t1,e.t4),e.next=9;break;case 24:return e.abrupt("return",n.getTime()!==aS.getTime()&&n.getTime()!==sS.getTime()?n:null);case 25:case"end":return e.stop()}}),e,this)}))}]),r}(e)})));function r$(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var i$=function(e){fe()(n,e);var t=r$(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"defaultConfig",get:function(){return{modelClass:KH}}}]),n}(EI);function o$(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}i$._$name="CalendarManagerStore";var a$=function(e){fe()(r,e);var t,n=o$(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"construct",value:function(){for(var e,t=arguments.length,n=new Array(t),i=0;i<t;i++)n[i]=arguments[i];var o=n[0]||{};n[0]=o,"tasksData"in o&&(o.eventsData=o.tasksData,delete o.tasksData),"taskStore"in o&&(o.eventStore=o.taskStore,delete o.taskStore),o.eventModelClass=o.taskModelClass||o.eventModelClass||this.defaultEventModelClass,o.eventStoreClass=o.taskStoreClass||o.eventStoreClass||this.defaultEventStoreClass,o.timeRangeStore||(o.timeRangeStore={modelClass:Qy,storeId:"timeRanges"}),(e=we()(pe()(r.prototype),"construct",this)).call.apply(e,[this].concat(n))}},{key:"tryInsertChild",value:(t=Wr()(Vr.a.mark((function e(){var t=arguments,n=this;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.tryPropagateWithChanges((function(){n.insertChild.apply(n,d()(t))})));case 1:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"toJSON",value:function(){return{eventsData:this.eventStore.toJSON(),resourcesData:this.resourceStore.toJSON(),dependenciesData:this.dependencyStore.toJSON(),assignmentsData:this.assignmentStore.toJSON()}}},{key:"afterChange",value:function(e,t){we()(pe()(r.prototype),"afterChange",this).apply(this,arguments),t.calendar&&this.trigger("calendarChange")}},{key:"refreshWbs",value:function(e){var t,n,r=null!==(t=this.unfilteredChildren)&&void 0!==t?t:this.children;r&&r.length&&(null===(n=r[0].refreshWbs)||void 0===n||n.call(this,e,-1))}},{key:"defaultEventModelClass",get:function(){return WB}},{key:"defaultEventStoreClass",get:function(){return KB}},{key:"taskStore",get:function(){return this.getEventStore()}},{key:"timeRangeStore",get:function(){return this._timeRangeStore},set:function(e){this._timeRangeStore=No.getStore(e,No),this._timeRangeStore.storeId||(this._timeRangeStore.storeId="timeRanges")}},{key:"json",get:function(){return we()(pe()(r.prototype),"json",this)},set:function(e){"string"==typeof e&&(e=E.safeJsonParse(e)),this.loadInlineData(e)}}],[{key:"defaults",get:function(){return{expanded:!0}}},{key:"defaultConfig",get:function(){return{eventModelClass:WB,taskModelClass:WB,dependencyModelClass:x_,resourceModelClass:A_,assignmentModelClass:C_,calendarModelClass:KH,eventStoreClass:KB,taskStoreClass:KB,dependencyStoreClass:T_,resourceStoreClass:I_,assignmentStoreClass:D_,calendarManagerStoreClass:i$,tasksData:null,eventsData:null,dependenciesData:null,resourcesData:null,assignmentsData:null,calendarsData:null,timeRangeStore:null,convertEmptyParentToLeaf:!1}}}]),r}(jO(n$.derive(Bi)));function s$(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return u$(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return u$(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function u$(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}a$.applyConfigs=!0,a$._$name="ProjectModel";var c$=new Date,l$=new Date(c$.getFullYear(),0,1),f$=new fc;function d$(e,t){return parseInt(""+e+t)}var h$=function(){function e(){v()(this,e)}var t;return g()(e,null,[{key:"generateAsync",value:(t=Wr()(Vr.a.mark((function e(t,n){var r,i,o,a,s,u,c,l,f,h,v,p,g,y,m,k,b=arguments;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:r=b.length>2&&void 0!==b[2]?b[2]:null,i=b.length>3&&void 0!==b[3]?b[3]:l$,o=!(b.length>4&&void 0!==b[4])||b[4],a={startDate:i,tasksData:[],dependenciesData:[]},s=Math.ceil(t/10),u=Math.ceil(n/10),c=this.generateBlocks(s,u,a.startDate),l=0,f=0,h=0,v=0,o&&console.time("generate"),p=s$(c),e.prev=7,p.s();case 9:if((g=p.n()).done){e.next=22;break}if(k=g.value,(y=a.tasksData).push.apply(y,d()(k.tasksData)),(m=a.dependenciesData).push.apply(m,d()(k.dependenciesData)),k.projectDuration&&(f=Math.max(k.projectDuration,f)),h+=k.taskCount,v+=k.dependencyCount,++l%1e3!=0){e.next=20;break}return null==r||r(h,v,!1),e.next=20,Ls.animationFrame();case 20:e.next=9;break;case 22:e.next=27;break;case 24:e.prev=24,e.t0=e.catch(7),p.e(e.t0);case 27:return e.prev=27,p.f(),e.finish(27);case 30:return null==r||r(h,v,!0),a.endDate=Zt.add(a.startDate,Math.max(f,30),"days"),o&&console.timeEnd("generate"),e.abrupt("return",a);case 34:case"end":return e.stop()}}),e,this,[[7,24,27,30]])}))),function(e,n){return t.apply(this,arguments)})},{key:"generateBlocks",value:Vr.a.mark((function e(t,n,r){var i,o,a,s,u,c,l,f;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:u=function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=f$.nextRandom(5)+2;return e&&(s+=t),t},i=1,o=1,a=0,s=0,c=0;case 3:if(!(c<t)){e.next=15;break}return l=i,f={tasksData:[{id:i++,name:"Parent "+l,startDate:r,expanded:!0,children:[{id:i++,name:"Sub-parent "+d$(l,1),startDate:r,expanded:!0,children:[{id:i++,name:"Task "+d$(l,11),startDate:r,duration:u(),percentDone:f$.nextRandom(100)},{id:i++,name:"Task "+d$(l,12),startDate:r,duration:u(),percentDone:f$.nextRandom(100)},{id:i++,name:"Task "+d$(l,13),startDate:r,duration:u(),percentDone:f$.nextRandom(100)},{id:i++,name:"Task "+d$(l,14),startDate:r,duration:u(),percentDone:f$.nextRandom(100)}]},{id:i++,name:"Sub-parent "+d$(l,2),startDate:r,expanded:!0,children:[{id:i++,name:"Task "+d$(l,21),startDate:r,duration:u(),percentDone:f$.nextRandom(100)},{id:i++,name:"Task "+d$(l,22),startDate:r,duration:u(),percentDone:f$.nextRandom(100)},{id:i++,name:"Task "+d$(l,23),startDate:r,duration:u(),percentDone:f$.nextRandom(100)}]}]}],dependenciesData:[{id:o++,fromEvent:l+2,toEvent:l+3},{id:o++,fromEvent:l+3,toEvent:l+4},{id:o++,fromEvent:l+4,toEvent:l+5},{id:o++,fromEvent:l+5,toEvent:l+7},{id:o++,fromEvent:l+7,toEvent:l+8},{id:o++,fromEvent:l+8,toEvent:l+9}],taskCount:10,dependencyCount:5},a+=s,s=0,f.projectDuration=a,c%n!=0?(f.dependenciesData.push({id:o++,fromEvent:l-2,toEvent:l+2,type:2,lag:0,lagUnit:"d"}),f.dependencyCount++):a=0,i++,e.next=12,f;case 12:c++,e.next=3;break;case 15:case"end":return e.stop()}}),e)}))}]),e}();function v$(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}h$._$name="ProjectGenerator";var p$={releaseElement:1,reuseElement:1},g$={newElement:1,reuseOwnElement:1,reuseElement:1},y$=function(e){fe()(n,e);var t=v$(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(e){this.gantt=e,e.rowManager.on({renderDone:"onRenderDone",removeRows:"onRemoveRows",beforeRowHeight:"onBeforeRowHeightChange",thisObj:this}),we()(pe()(n.prototype),"construct",this).call(this,{})}},{key:"init",value:function(){}},{key:"bindTaskStore",value:function(){}},{key:"refreshRows",value:function(){}},{key:"onTimeAxisViewModelUpdate",value:function(){this.updateFromHorizontalScroll(this.gantt.timeAxisSubGrid.scrollable.x)}},{key:"onViewportResize",value:function(){}},{key:"onDragAbort",value:function(){}},{key:"onBeforeRowHeightChange",value:function(e){var t,n=this.gantt;n.foregroundCanvas&&(n.foregroundCanvas.style.fontSize="".concat((null!==(t=null==e?void 0:e.height)&&void 0!==t?t:n.rowHeight)-2*n.resourceMargin,"px"))}},{key:"getTaskBox",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.gantt;if(n){var i=this.getElementFromTaskRecord(e);if(i)return En.from(i,r.timeAxisSubGridElement)}if(!e.startDate||!e.endDate||e.isTask&&(r.taskStore.isDestroyed||!r.taskStore.isAvailable(e)))return null;var o=this.getSizeAndPosition(e,t,n);if(!o)return null;var a=o.position,s=o.width,u=r.taskStore.indexOf(e)*r.rowManager.rowOffsetHeight+r.resourceMargin,c=r.rowHeight-2*r.resourceMargin;return new En(a,u,s,c)}},{key:"getSizeAndPosition",value:function(e,t,n){var r,i,o=this.gantt,a=o.timeAxis,s=a.startDate,u=a.endDate,c=e.startDate,l=e.endDate||(null!=e.duration?Zt.add(c,e.duration,e.durationUnit):null),f=e.milestone,d=f?o.features.dependencies.pathFinder.startArrowMargin:0;if(!t&&(l<s||c>u))return null;if(t&&c<s)r=o.getCoordinateFromDate(s)-d;else if(t&&c>u)r=o.getCoordinateFromDate(u)+d;else if(c<s){var h=o.timeAxisViewModel.getSingleUnitInPixels("second"),v=(a.startMS-e.startDateMS)/1e3*h;r=o.getCoordinateFromDate(s)-v}else r=o.getCoordinateFromDate(c);if(!f)if(t&&l<s)i=o.getCoordinateFromDate(s)-d;else if(t&&l>u)i=o.getCoordinateFromDate(u)+d;else if(l>u){var p=o.timeAxisViewModel.getSingleUnitInPixels("second"),g=(e.endDateMS-a.endMS)/1e3*p;i=o.getCoordinateFromDate(u)+g}else i=o.getCoordinateFromDate(l);var y=f?0:i-r;return n&&f&&c>s&&c<u&&(r-=(y=o.rowHeight-2*o.resourceMargin)/2),!t&&r+y<0?null:{position:r,width:y}}},{key:"getRowRegion",value:function(e,t,n){var r=this.gantt,i=r.getRowFor(e);if(!i)return null;var o=i.getElement(r.timeAxisSubGrid.region),a=r.timeAxis.startDate,s=r.timeAxis.endDate,u=t?Zt.max(a,t):a,c=n?Zt.min(s,n):s,l=r.getCoordinateFromDate(u),f=r.getCoordinateFromDate(c,!0,!0),d=i.top+r.scrollTop,h=Math.min(l,f),v=d+o.offsetHeight;return new En(h,d,Math.max(l,f)-h,v-d)}},{key:"getDateFromXY",value:function(e,t,n){var r=e[0];return n||(r=this.translateToScheduleCoordinate(r)),this.gantt.timeAxisViewModel.getDateFromPosition(r,t)}},{key:"translateToScheduleCoordinate",value:function(e){return e-Math.floor(this.gantt.timeAxisSubGridElement.getBoundingClientRect().left)+this.gantt.scrollLeft}},{key:"translateToPageCoordinate",value:function(e){var t=this.gantt.timeAxisSubGridElement;return e+t.getBoundingClientRect().left-t.scrollLeft}},{key:"getElementFromTaskRecord",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n=this.gantt.rowManager.getRowFor(e);if(n&&this.rowMap.has(n)){var r,i=null===(r=this.rowMap.get(n)[0])||void 0===r?void 0:r._element;if(i)return t?i.syncIdMap.task:i}return null}},{key:"getConnectorStartSide",value:function(e){return"left"}},{key:"getConnectorEndSide",value:function(e){return"right"}},{key:"onRemoveRows",value:function(e){var t=this;e.rows.forEach((function(e){return t.rowMap.delete(e)})),this.onRenderDone()}},{key:"updateFromHorizontalScroll",value:function(e){var t=this.gantt,n=t.timeAxisSubGrid.width,r=t.getDateFromCoordinate(Math.max(0,e-100)),i=t.getDateFromCoordinate(e+n+100)||t.endDate,o=t.getDateFromCoordinate(e)||t.startDate,a=t.getDateFromCoordinate(e+n)||t.endDate;this._visibleDateRange={startDate:o,endDate:a},t.timeView.range={startDate:r,endDate:i},t.trigger("visibleRangeChange",{startDate:r,endDate:i})}},{key:"populateTaskRenderData",value:function(e,t){var n=this.gantt,r=!(!n.features.baselines||!n.features.baselines.disabled),i={className:"b-gantt-task-content",dataset:{taskBarFeature:"content"},children:[]};if(e){var o,a,s=void 0===t.isResizable||t.isResizable;e.startsOutsideView&&(!0===s?s="end":"start"===s&&(s=!1)),e.endsOutsideView&&(!0===s?s="start":"end"===s&&(s=!1)),Object.assign(e,{iconCls:new An(t.taskIconCls),id:n.getEventRenderId(t),style:t.style||"",taskId:t.id,wrapperCls:new An((o={},ke()(o,n.eventCls+"-wrap",1),ke()(o,"".concat(n.eventCls,"-parent"),t.isParent),ke()(o,"b-milestone-wrap",t.milestone),ke()(o,"b-has-baselines",t.hasBaselines&&!r),o)),cls:t.isResourceTimeRange?new An:t.cls.clone(),extraConfigs:[]}),Object.assign(e.cls,(a={},ke()(a,n.eventCls,1),ke()(a,n.generatedIdCls,t.hasGeneratedId),ke()(a,n.dirtyCls,t.modifications),ke()(a,n.committingCls,t.isCommitting),ke()(a,n.endsOutsideViewCls,e.endsOutsideView),ke()(a,n.startsOutsideViewCls,e.startsOutsideView),ke()(a,n.fixedEventCls,!1===t.isDraggable),ke()(a,"b-sch-event-resizable-".concat(s),1),ke()(a,"b-milestone",t.milestone),ke()(a,"b-task-started",t.percentDone>0),ke()(a,"b-task-finished",t.isCompleted),ke()(a,"b-task-selected",n.selectedRecords.includes(t)),a));var u=t.eventStyle||n.eventStyle,c=t.eventColor||n.eventColor;if(e.eventColor=c,e.eventStyle=u,n.taskRenderer){var f=n.taskRenderer.call(n.taskRendererThisObj||n,{taskRecord:t,tplData:e,renderData:e});"string"==typeof e.cls&&(e.cls=new An(e.cls)),"string"==typeof e.iconCls&&(e.iconCls=new An(e.iconCls)),"string"==typeof e.wrapperCls&&(e.wrapperCls=new An(e.wrapperCls));var h=null;if("string"==typeof f&&f.includes("<")?h={html:f}:"string"==typeof f||"object"===l()(f)?h=f:null!=f&&(h=String(f)),h){var v;if(Array.isArray(h))(v=i.children).push.apply(v,d()(h));else i.children.push(h);e.cls.add("b-has-content")}}e.cls["b-sch-event-withicon"]=e.iconCls.length,e.wrapperCls["b-sch-style-".concat(e.eventStyle)]=e.eventStyle,e.eventColor&&e.eventColor.startsWith("#")?e.style="background-color:".concat(e.eventColor,";")+e.style:e.wrapperCls["b-sch-color-".concat(e.eventColor)]=e.eventColor,e.iconCls&&e.iconCls.length&&i.children.unshift({tag:"i",className:e.iconCls}),(i.children.length||t.milestone)&&e.children.push(i)}e.taskContent=i,e.wrapperChildren=[],n.onTaskDataGenerated(e)}},{key:"renderer",value:function(e){var t,n=e.row,r=e.record,i=this,o=i.getTaskBox(r),a={taskRecord:r,task:r,row:n,children:[]};o?(Object.assign(a,{isTask:!0,top:o.top,left:o.left,width:o.width,height:o.height}),i.populateTaskRenderData(a,r),t={className:a.wrapperCls,tabIndex:"0",children:[{className:a.cls,style:(a.internalStyle||"")+(a.style||""),children:a.children,dataset:{taskFeature:"task"},syncOptions:{syncIdField:"taskBarFeature"}}].concat(d()(a.wrapperChildren)),style:{transform:"translate(".concat(a.left,"px, ").concat(a.top,"px)"),width:a.width,zIndex:a.zIndex},dataset:{taskId:a.taskId},elementData:a,syncOptions:{syncIdField:"taskFeature",releaseThreshold:0}},i.gantt.trigger("beforeRenderTask",{renderData:a,domConfig:t})):i.populateTaskRenderData(a,r),o||0!==a.extraConfigs.length?i.rowMap.set(n,[t].concat(d()(a.extraConfigs))):i.rowMap.delete(n)}},{key:"onRenderDone",value:function(){var e=this.gantt,t=Array.from(this.rowMap.values()).flat();Gs.sync({domConfig:{onlyChildren:!0,children:t},targetElement:e.foregroundCanvas,syncIdField:"taskId",callback:function(t){var n=t.action,r=t.domConfig,i=t.lastDomConfig,o=t.targetElement;if("none"!==n&&r&&r.className&&r.className[e.eventCls+"-wrap"]){var a,s,u=g$[n];if(p$[n]&&(null==i||null===(a=i.elementData)||void 0===a?void 0:a.isTask)){var c={renderData:i.elementData,taskRecord:i.elementData.taskRecord,element:o};e.trigger("releaseTask",c)}if(u&&(null==r||null===(s=r.elementData)||void 0===s?void 0:s.isTask)){var l={renderData:r.elementData,taskRecord:r.elementData.taskRecord,element:o};l.reusingElement="reuseElement"===n,e.trigger("renderTask",l)}}}})}},{key:"redraw",value:function(e){this.gantt.rowManager.refreshCell(e,this.gantt.timeAxisColumn.id)&&this.onRenderDone()}},{key:"visibleDateRange",get:function(){return this._visibleDateRange}}],[{key:"properties",get:function(){return{rowMap:new Map}}}]),n}(ue);function m$(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}y$._$name="NewTaskRendering";var k$=/-/g;function b$(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}function w$(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var C$={block:"nearest",edgeOffset:20};function S$(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var D$=["barMargin"];function R$(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}function x$(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}function E$(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}function T$(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}var M$=Object.freeze({}),A$=0,P$=function(e){fe()(o,e);var t,n,r,i=T$(o);function o(){return v()(this,o),i.apply(this,arguments)}return g()(o,[{key:"construct",value:function(e){var t=this,n=Boolean(e.calendars||e.taskStore||e.dependencyStore||e.resourceStore||e.assignmentStore),r=Boolean(e.calendars||e.tasks||e.dependencies||e.resources||e.assignments);e.features||(e.features={}),"tree"in e.features||(e.features.tree=!0),"group"in e.features||(e.features.group=!1);var i=e.project;if(i&&(n||r))throw new Error("Providing both project and inline data is not supported");(null==i?void 0:i.isModel)||(e.project=an.assign({calendarsData:e.calendars,eventsData:e.tasks,dependenciesData:e.dependencies,resourcesData:e.resources,assignmentsData:e.assignments,resourceStore:e.resourceStore,eventStore:e.taskStore,assignmentStore:e.assignmentStore,dependencyStore:e.dependencyStore,timeRangeStore:e.timeRangeStore},i),delete e.resourceStore,delete e.taskStore,delete e.assignmentStore,delete e.dependencyStore,delete e.timeRangeStore,delete e.calendars,delete e.resources,delete e.tasks,delete e.assignments,delete e.dependencies),we()(pe()(o.prototype),"construct",this).call(this,e),t.features.cellEdit&&(t.features.cellEdit.addNewAtEnd={name:t.L("L{Gantt.New task}"),startDate:t.project.startDate,duration:1,durationUnit:t.timeAxis.unit}),t.toggleParentTasksOnClick&&t.on("taskclick",t.onTaskBarClick)}},{key:"resumeRefresh",value:function(e){we()(pe()(o.prototype),"resumeRefresh",this).call(this,!1),!this.refreshSuspended&&e&&(this.rowManager.topRow?this.refreshWithTransition():this.rowManager.reinitialize())}},{key:"onStoreUpdateRecord",value:function(e){var t,n=this;if(!this.project.isBatchingChanges)return this.runWithTransition((function(){t=we()(pe()(o.prototype),"onStoreUpdateRecord",n).call(n,e)})),t}},{key:"onStoreDataChange",value:function(e){var t=this;this.runWithTransition((function(){we()(pe()(o.prototype),"onStoreDataChange",t).call(t,e)}),"batch"===e.action)}},{key:"onProjectProgress",value:function(e){var t=e.total,n=e.remaining,r=e.phase,i=void 0===r?"propagating":r,o=this;if(o.project.enableProgressNotifications){var a=o.L(i),s=t?"".concat(a," ").concat(t-n," / ").concat(t):a;o.masked||o.mask({maxProgress:t,useTransition:!1}),o.masked.text=s,t&&(o.masked.maxProgress=t,o.masked.progress=t-n)}}},{key:"onTaskDataGenerated",value:function(){}},{key:"onTaskBarClick",value:function(e){var t=e.taskRecord;t.isLeaf||this.toggleCollapse(t)}},{key:"triggerChangeEvent",value:function(e,t){we()(pe()(o.prototype),"triggerChangeEvent",this).call(this,e,t);var n=this;function r(e,t){var r=n.getElementFromTaskRecord(e);r&&r.classList[t?"add":"remove"]("b-task-selected")}"row"===e.mode&&(e.selected.map((function(e){return r(e,!0)})),e.deselected.map((function(e){return r(e,!1)})))}},{key:"toggleEmptyText",value:function(){this.bodyContainer&&Cr.toggleClasses(this.bodyContainer,"b-grid-empty",!(this.rowManager.rowCount||this.project.isLoadingOrSyncing))}},{key:"getTimeSpanMouseEventParams",value:function(e,t){var n=this.resolveTaskRecord(e);return n?{taskRecord:n,taskElement:e,event:t}:null}},{key:"getScheduleMouseEventParams",value:function(e){return{taskRecord:this.store.getById(e.id)}}},{key:"resolveTimeSpanRecord",value:function(e){return this.resolveTaskRecord(e)}},{key:"repaintEventsForResource",value:function(e){this.taskRendering.redraw(e)}},{key:"populateTaskMenu",value:function(){}},{key:"addTask",value:(r=Wr()(Vr.a.mark((function e(t){var n,r,i,o,a,s,u,c,l,f,d=arguments;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=d.length>1&&void 0!==d[1]?d[1]:M$,r=this,i=n.milestone,o=n.above,a=n.asChild,s=n.asPredecessor,u=n.asSuccessor,c=r.project,l=t.parent,(f=t.copy()).name=i?"".concat(r.L("L{Gantt.New milestone}")," ").concat(++A$):"".concat(r.L("L{Gantt.New task}")," ").concat(++A$),a?t.insertChild(f,t.firstChild):o?t.parent.insertChild(f,t):l.insertChild(f,t.nextSibling),!i){e.next=11;break}return e.next=7,c.commitAsync();case 7:return e.next=9,f.convertToMilestone();case 9:e.next=13;break;case 11:return e.next=13,c.commitAsync();case 13:if(u?r.dependencyStore.add({fromEvent:t,toEvent:f,type:QC.EndToStart,fromSide:"right",toSide:"left"}):s&&r.dependencyStore.add({fromEvent:f,toEvent:t,type:QC.EndToStart,fromSide:"right",toSide:"left"}),!u&&!s){e.next=17;break}return e.next=17,c.propagateAsync();case 17:return e.abrupt("return",f);case 18:case"end":return e.stop()}}),e,this)}))),function(e){return r.apply(this,arguments)})},{key:"addTaskAbove",value:function(e){return this.addTask(e,{above:!0})}},{key:"addTaskBelow",value:function(e){return this.addTask(e)}},{key:"addMilestonBelow",value:function(e){return this.addTask(e,{milestone:!0})}},{key:"addSubtask",value:function(e){var t=this.addTask(e,{asChild:!0});return this.toggleCollapse(e,!1),t}},{key:"addSuccessor",value:function(e){return this.addTask(e,{asSuccessor:!0})}},{key:"addPredecessor",value:function(e){return this.addTask(e,{above:!0,asPredecessor:!0})}},{key:"indent",value:(n=Wr()(Vr.a.mark((function e(t){var n,r;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this,e.next=3,n.taskStore.indent(t);case 3:return(r=e.sent)||cc.show(n.L("L{Gantt.changeRejected}")),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return n.apply(this,arguments)})},{key:"outdent",value:(t=Wr()(Vr.a.mark((function e(t){var n,r;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=this,e.next=3,n.taskStore.outdent(t);case 3:return(r=e.sent)||cc.show(n.L("L{Gantt.changeRejected}")),e.abrupt("return",r);case 6:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"isGantt",get:function(){return!0}},{key:"columns",get:function(){return we()(pe()(o.prototype),"columns",this)},set:function(e){if(e){var t=e;Array.isArray(e)||(t=e.data,this._thisIsAUsedExpression(this.taskStore)),t.some((function(e){var t=e instanceof Dh?e.constructor:Th.getColumnClass(e.type)||Dh;return t===QL||t.prototype instanceof QL}))||t.unshift({type:"name"})}sc()(pe()(o.prototype),"columns",e,this,!0)}},{key:"timeAxisViewModel",set:function(e){sc()(pe()(o.prototype),"timeAxisViewModel",e,this,!0),this.taskStore&&(this.timeAxisViewModel.store=this.taskStore)},get:function(){return we()(pe()(o.prototype),"timeAxisViewModel",this)}},{key:"currentOrientation",get:function(){var e=this;return e._currentOrientation||(e.taskRendering=e._currentOrientation=new y$(e)),e._currentOrientation}}],[{key:"$name",get:function(){return"GanttBase"}},{key:"type",get:function(){return"ganttbase"}},{key:"defaultConfig",get:function(){return{project:null,resourceImageFolderPath:null,defaultResourceImageName:null,toggleParentTasksOnClick:!0,calendars:null,resources:null,tasks:null,dependencies:null,assignments:null,eventCls:"b-gantt-task",eventBarTextField:null,eventLayout:"none",eventSelectionDisable:!0,eventColor:null,eventStyle:null,rowHeight:45,scheduledEventName:"task",eventScrollMode:"move",overScheduledEventClass:"b-gantt-task-hover",mode:"horizontal",timeCellCls:"b-sch-timeaxis-cell",timeCellSelector:".b-sch-timeaxis-cell",focusCls:"b-active",taskRenderer:null}}},{key:"deprecatedEvents",get:function(){return{taskContextMenuBeforeShow:{product:"Gantt",invalidAsOfVersion:"5.0.0",message:"`taskContextMenuBeforeShow` event is deprecated, in favor of `taskMenuBeforeShow` event. Please see https://bryntum.com/docs/gantt/#guides/upgrades/4.0.0.md for more information."},taskContextMenuShow:{product:"Gantt",invalidAsOfVersion:"5.0.0",message:"`taskContextMenuShow` event is deprecated, in favor of `taskMenuShow` event. Please see https://bryntum.com/docs/gantt/#guides/upgrades/4.0.0.md for more information."},taskContextMenuItem:{product:"Gantt",invalidAsOfVersion:"5.0.0",message:"`taskContextMenuItem` event is deprecated, in favor of `taskMenuItem` event. Please see https://bryntum.com/docs/gantt/#guides/upgrades/4.0.0.md for more information."}}}}]),o}(ET.mixin(Gy,(function(e){return function(e){fe()(n,e);var t=m$(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"resolveEventRecord",value:function(e){return this.resolveTaskRecord(e)}},{key:"resolveTaskRecord",value:function(e){return(e=Cr.up(e,this.eventSelector))?this.taskStore.getById(e.dataset.taskId):null}},{key:"getElementFromTaskRecord",value:function(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return this.taskRendering.getElementFromTaskRecord(e,t)}},{key:"getElementFromEventRecord",value:function(e){return this.getElementFromTaskRecord(e)}},{key:"getEventRenderId",value:function(e){return"".concat(this.id.toString().replace(k$,"_"),"-").concat(e.id)}},{key:"getEventData",value:function(e){var t=this.resolveTimeSpanRecord(e.target);if(t){var r=this.getCell({record:t,column:this.timeAxisColumn}),i=qo.get(r),o=i.id,a=i.columnId;return{cellElement:r,cellData:i,columnId:a,id:o,record:t,cellSelector:{id:o,columnId:a}}}return we()(pe()(n.prototype),"getEventData",this).call(this,e)}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"GanttDom"}}]),n}(e||ue)}),(function(e){return function(e){fe()(n,e);var t=b$(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"getScheduleRegion",value:function(e,t){var n,r=this,i=r.timeAxisSubGridElement;if(e){var o=r.getElementFromTaskRecord(e);if(n=En.from(r.getRowById(e.id).getElement("locked")),o){var a=En.from(o,i);n.y=a.y,n.bottom=a.bottom}else n.y=n.y+r.barMargin,n.bottom=n.bottom-r.barMargin}else(n=En.from(i).moveTo(null,0)).width=i.scrollWidth,n.y=n.y+r.barMargin,n.bottom=n.bottom-r.barMargin;var s=r.timeAxis.startDate,u=r.timeAxis.endDate,c=r.getDateConstraints(e)||{start:s,end:u},l=n.y,f=n.bottom,d=r.getCoordinateFromDate(Zt.max(s,c.start)),h=r.getCoordinateFromDate(Zt.min(u,c.end));return t||(d=r.translateToPageCoordinate(d),h=r.translateToPageCoordinate(h)),{top:l,right:Math.max(d,h),bottom:f,left:Math.min(d,h)}}},{key:"translateToPageCoordinate",value:function(e){var t=this.timeAxisSubGridElement;return e+t.getBoundingClientRect().left-t.scrollLeft}},{key:"isRowVisible",value:function(e){return this.store.indexOf(e)>=0}},{key:"getTaskBox",value:function(e){var t;return(t=this.taskRendering).getTaskBox.apply(t,arguments)}},{key:"getSizeAndPosition",value:function(){var e;return(e=this.taskRendering).getSizeAndPosition.apply(e,arguments)}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"GanttRegions"}}]),n}(e||ue)}),(function(e){return function(e){fe()(n,e);var t=w$(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"scrollTaskIntoView",value:function(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:C$,r=e.startDate,i=e.endDate,o=this;if(null==n.edgeOffset&&(n.edgeOffset=20),!e.isScheduled)return this.scrollRowIntoView(e,n);r=r||i,i=i||r;var a=r<o.timeAxis.startDate|(i>o.timeAxis.endDate)<<1;if(a&&!1!==n.extendTimeAxis){var s,u,c=o.timeAxis.endDate-o.timeAxis.startDate;3===a?o.timeAxis.setTimeSpan(new Date(r.valueOf()-c/2),new Date(i.getTime()+c/2)):(s=o.getCoordinateFromDate(1&a?i:r),1&a?o.timeAxis.setTimeSpan(new Date(r),new Date(r.valueOf()+c)):o.timeAxis.setTimeSpan(new Date(i.valueOf()-c),new Date(i)),u=1&a?o.getCoordinateFromDate(i):o.getCoordinateFromDate(r),o.timeAxisSubGrid.scrollable.scrollBy(u-s))}if(t=o.getElementFromTaskRecord(e)){var l=o.timeAxisSubGrid.scrollable;return l.scrollIntoView(t,an.assign({silent:!0},n))}return o.scrollUnrenderedTaskIntoView(e,n)}},{key:"scrollUnrenderedTaskIntoView",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:C$;null==t.edgeOffset&&(t.edgeOffset=20);var n=this,r=n.timeAxisSubGrid.scrollable,i=n.getTaskBox(e),o=r.viewport,a=i.translate(o.x-r.x,o.y-r.y),s=r.scrollIntoView(a,Object.assign({},t,{highlight:!1}));if(t.highlight||t.focus)var u=n.on({renderTask:function(n){var r=n.taskRecord,i=n.element;r===e&&(u(),s=s.then((function(){t.highlight&&Cr.highlight(i),t.focus&&i.focus()})))}});else s=Promise.all([s,new Promise((function(t){var r=n.on({renderTask:function(n){n.taskRecord===e&&(r(),t())}})}))]);return s}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"GanttScroll"}}]),n}(e||ue)}),(function(e){return function(e){fe()(n,e);var t=S$(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"getState",value:function(){var e=this,t=an.copyProperties(we()(pe()(n.prototype),"getState",this).call(this),e,D$);return t.zoomLevel=e.zoomLevel,t.zoomLevelOptions={startDate:e.startDate,endDate:e.endDate,centerDate:e.viewportCenterDate,width:e.tickSize},t}},{key:"applyState",value:function(e){e.zoomLevel&&this.zoomToLevel(e.zoomLevel,e.zoomLevelOptions),an.copyProperties(this,e,D$),we()(pe()(n.prototype),"applyState",this).call(this,e)}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"GanttState"}}]),n}(e||ue)}),(function(e){return function(e){fe()(n,e);var t=R$(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"construct",value:function(){this.onRefreshCallsQueue=[],we()(pe()(n.prototype),"construct",this).apply(this,arguments)}},{key:"updateProject",value:function(e,t){we()(pe()(n.prototype),"updateProject",this).call(this,e,t),this.detachListeners("ganttStores"),e&&e.on({name:"ganttStores",startApplyResponse:"onProjectStartApplyResponse",refresh:"internalOnProjectRefresh",progress:"onProjectProgress",thisObj:this})}},{key:"onProjectStartApplyResponse",value:function(){this.suspendRefresh()}},{key:"internalOnProjectRefresh",value:function(){var e=this;e.project.enableProgressNotifications&&e.masked&&e.unmask(),e.appliedViewStartDate||"startDate"in e.initialConfig||!e.project.startDate||(e.setTimeSpan(e.project.startDate,e.project.endDate),e.appliedViewStartDate=!0),e.resumeRefresh(!0),e.suspendRendering||(e.refreshAfterProjectRefresh&&(e.refreshWithTransition(),e.refreshAfterProjectRefresh=!1),e.trigger("projectRefresh",{initial:!1}))}},{key:"changeTasks",value:function(e){var t=this.project;this.buildingProjectConfig?t.eventsData=e:t.eventStore.data=e}},{key:"changeTaskStore",value:function(e){var t=this.project;if(!this.buildingProjectConfig)return this.initializingProject||t.eventStore!==e&&(t.setEventStore(e),e=t.eventStore),e;t.eventStore=e}},{key:"updateEventStore",value:function(e){var t=this;e.metaMapId=t.id,t.taskStore=t.store=t.timeAxisViewModel.store=e,t.currentOrientation.bindTaskStore(e)}},{key:"replica",get:function(){return this.project.replica}},{key:"tasks",get:function(){return this.project.eventStore.records}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"GanttStores"}},{key:"projectStores",get:function(){return{calendarManagerStore:{},resourceStore:{dataName:"resources"},eventStore:{dataName:"events"},dependencyStore:{dataName:"dependencies"},assignmentStore:{dataName:"assignments"}}}},{key:"configurable",get:function(){return{projectModelClass:a$,tasks:null,taskStore:null}}}]),n}(zM(e||ue))}),(function(e){return function(e){fe()(n,e);var t=x$(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"getDisplayEndDate",value:function(e,t){return e}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"GanttTimelineDateMapper"}}]),n}(e||ue)}),tA,(function(e){return function(e){fe()(r,e);var t,n=E$(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"processEvent",value:function(e){var t=Cr.up(e.target,this.eventSelector);return!this.navigator.disabled&&t&&(e.taskRecord=e.eventRecord=this.resolveTaskRecord(t),"click"===e.type&&this.selectEvent(e.taskRecord,e.ctrlKey||e.metaKey)),e}},{key:"normalizeTarget",value:function(e){return e.taskRecord}},{key:"selectEvent",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];this.selectRow({record:e.id,column:!1,addToSelection:t})}},{key:"deselectEvent",value:function(e){this.deselectRow(e.id)}},{key:"getNext",value:function(e){for(var t=this.taskStore,n=t.indexOf(e)+1;n<t.count;n++){var r=t.getAt(n);if(this.isInTimeAxis(r))return r}}},{key:"getPrevious",value:function(e){for(var t=this.taskStore,n=t.indexOf(e)-1;n>=0;n--){var r=t.getAt(n);if(this.isInTimeAxis(r))return r}}},{key:"navigateTo",value:(t=Wr()(Vr.a.mark((function e(t){var n,r,i=arguments;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=i.length>1&&void 0!==i[1]?i[1]:{},r=this,!t){e.next=6;break}return r.navigator.disabled=!0,e.next=6,r.scrollTaskIntoView(t,{animate:100}).then((function(){r.navigator.disabled=!1,r.activeEvent=t,r.navigator.trigger("navigate",{event:n,item:r.getElementFromTaskRecord(t,!1)})}));case 6:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"clearEventSelection",value:function(){this.deselectAll()}},{key:"onTaskEnterKey",value:function(){}},{key:"onDeleteKey",value:function(e){var t=e.eventRecord;!this.readOnly&&this.enableDeleteKey&&t&&this.removeRecords([t])}},{key:"activeEvent",set:function(e){this.navigator.activeItem=this.getElementFromTaskRecord(e,!1)},get:function(){var e=this.navigator.activeItem;if(e)return this.resolveTaskRecord(e)}},{key:"widgetClass",get:function(){}}],[{key:"$name",get:function(){return"TaskNavigation"}},{key:"defaultConfig",get:function(){return{navigator:{inlineFlow:!1,prevKey:"ArrowUp",nextKey:"ArrowDown",keys:{ArrowLeft:function(){},ArrowRight:function(){},Enter:"onTaskEnterKey"}}}}}]),r}(e||ue)})));function I$(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}P$.initClass(),y.a.setVersion("gantt","4.0.3"),P$._$name="GanttBase";var O$=function(e){fe()(r,e);var t,n=I$(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"construct",value:function(e,t){this.gantt=e,we()(pe()(r.prototype),"construct",this).call(this,e,t)}},{key:"isElementDraggable",value:function(e,t){var n=this.gantt,r=Cr.up(e,n.eventSelector),i=n.features.taskResize;if(!r)return!1;if(e.matches('[class$="-handle"]'))return!1;var o=n.resolveTaskRecord(r);return!(!o||!o.isDraggable)&&(!(o.resizable&&!o.isMilestone&&(null==i?void 0:i.resize.overAnyHandle(t,r)))&&!1!==n.trigger("beforeTaskDrag",{taskRecord:o}))}},{key:"triggerEventDrag",value:function(e,t){this.gantt.trigger("taskDrag",{taskRecords:e.draggedEntities,startDate:e.startDate,endDate:e.endDate,dragData:e,changed:e.startDate-t!=0})}},{key:"triggerDragStart",value:function(e){this.gantt.trigger("taskDragStart",{taskRecords:e.draggedEntities,dragData:e})}},{key:"triggerDragAbort",value:function(e){this.gantt.trigger("taskDragAbort",{taskRecords:e.draggedEntities,context:e})}},{key:"triggerAfterDrop",value:function(e,t){this.currentOverClient.trigger("afterTaskDrop",{taskRecords:e.draggedEntities,context:e,valid:t})}},{key:"getProductDragContext",value:function(e){return{valid:!0}}},{key:"setupProductDragData",value:function(e){var t=this.gantt,n=e.element,r=t.resolveTaskRecord(n),i=En.from(n),o=this.getRelatedRecords(r)||[],a=t.getDateConstraints(r),s=[n];this.setupConstraints(t.getScheduleRegion(r),i,t.timeAxisViewModel.snapPixelAmount,Boolean(a)),o.forEach((function(e){De.include(s,t.getElementFromTaskRecord(e,!1))}));var u=[r].concat(d()(o));return{record:r,dateConstraints:a,eventBarEls:s,draggedEntities:u}}},{key:"getCoordinate",value:function(e,t,n){return n[0]}},{key:"checkDragValidity",value:function(e,t){return this.validatorFn.call(this.validatorFnThisObj||this,e.draggedEntities,e.startDate,e.duration,t)}},{key:"isValidDrop",value:function(e){return!0}},{key:"updateRecords",value:(t=Wr()(Vr.a.mark((function e(t){var n,r,i,o;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.draggedEntities[0],r=n.startDate,i=t.startDate,o=n.setStartDate(i,!0),e.next=3,o;case 3:return n.startDate-r?this.gantt.trigger("taskDrop",{taskRecords:t.draggedEntities}):this.dragData.valid=!1,e.abrupt("return",o);case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"getRecordElement",value:function(e){return this.gantt.getElementFromTaskRecord(e,!0)}},{key:"store",get:function(){return this.gantt.taskStore}}],[{key:"$name",get:function(){return"TaskDrag"}},{key:"defaultConfig",get:function(){return{validatorFn:function(e,t,n,r){return!0},validatorFnThisObj:null,tooltipCls:"b-gantt-taskdrag-tooltip"}}}]),r}(nE);function F$(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}O$._$name="TaskDrag",fv.registerFeature(O$,!0,"Gantt");var L$=function(e){fe()(r,e);var t,n=F$(r);function r(){return v()(this,r),n.apply(this,arguments)}return g()(r,[{key:"construct",value:function(e,t){this.gantt=e,we()(pe()(r.prototype),"construct",this).call(this,e,t)}},{key:"finalizeDragCreate",value:(t=Wr()(Vr.a.mark((function e(t){var n;return Vr.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(n=t.taskRecord).beginBatch(),n.setStartDate(t.startDate),n.setEndDate(t.endDate),n.endBatch(),e.next=7,this.gantt.project.commitAsync();case 7:this.gantt.trigger("dragCreateEnd",{taskRecord:n,event:t.event,proxyElement:this.proxy});case 8:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"handleBeforeDragCreate",value:function(e,t){var n=this,r=n.gantt.trigger("beforeDragCreate",{taskRecord:n.createContext.taskRecord,date:e,event:t});if(r){var i,o=n.gantt.features.scheduleTooltip;if(o)null===(i=o.hoverTip)||void 0===i||i.hide()}return n.dateConstraints=n.gantt.getDateConstraints(n.createContext.rowRecord,e),r}},{key:"checkValidity",value:function(e,t){return e.taskRecord=e.rowRecord,this.validatorFn.call(this.validatorFnThisObj||this,e,t)}},{key:"isRowEmpty",value:function(e){return!e.startDate||!e.endDate}},{key:"store",get:function(){return this.gantt.taskStore}}],[{key:"$name",get:function(){return"TaskDragCreate"}},{key:"defaultConfig",get:function(){return{preventMultiple:!0,validatorFn:function(){}}}}]),r}(aE);function j$(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}L$._$name="TaskDragCreate",fv.registerFeature(L$,!0,"Gantt");var _$=function(e){fe()(n,e);var t=j$(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,[{key:"getTimespanRecord",value:function(e){return e.taskRecord}},{key:"getRowRecord",value:function(e){return e.taskRecord}},{key:"setupProductResizeContext",value:function(e,t){var n=this.client,r=n.resolveTaskRecord(e.element);Object.assign(e,{taskRecord:r,dateConstraints:n.getDateConstraints(r)})}},{key:"internalUpdateRecord",value:function(e,t){var n=t.run("calculateProjectedDuration",e.startDate,e.endDate);return n===t.duration?(e.element.lastDomConfig.style.width=null,!1):(t.setDuration(n),!0)}},{key:"createResizeHelper",value:function(){var e=this,t=e.client;return new Su({name:e.constructor.name,isElementResizable:function(t,n){return e.isElementResizable(t,n)},targetSelector:t.eventSelector,resizingCls:"b-sch-event-resizing",allowResize:e.isElementResizable.bind(e),outerElement:t.timeAxisSubGridElement,scrollManager:t.scrollManager,leftHandle:!1,dragThreshold:0,dynamicHandleSize:!0,reservedSpace:5,listeners:{beforeresizestart:e.onBeforeResizeStart,resizestart:e.onResizeStart,resizing:e.onResizing,resize:e.onFinishResize,cancel:e.onCancelResize,thisObj:e},highlightHandle:function(){var e=Cr.up(this.currentElement,this.targetSelector),n=Cr.up(this.currentElement,t.eventInnerSelector);n&&(n.classList.add("b-resize-handle"),e.classList.add("b-over-resize-handle"))},unHighlightHandle:function(){var e=Cr.up(this.currentElement,this.targetSelector);e&&e.classList.remove("b-over-resize-handle");var n=Cr.up(this.currentElement,t.eventInnerSelector);n&&n.classList.remove("b-resize-handle"),this.currentElement=null}})}},{key:"store",get:function(){return this.client.taskStore}}],[{key:"$name",get:function(){return"TaskResize"}}]),n}(rT);function B$(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}_$._$name="TaskResize",fv.registerFeature(_$,!0,"Gantt");var H$=function(e){fe()(n,e);var t=B$(n);function n(){return v()(this,n),t.apply(this,arguments)}return g()(n,null,[{key:"$name",get:function(){return"Gantt"}},{key:"type",get:function(){return"gantt"}}]),n}(P$);function $$(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(!e)return;if("string"==typeof e)return N$(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return N$(e,t)}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,i=function(){};return{s:i,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:i}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,a=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==n.return||n.return()}finally{if(s)throw o}}}}function N$(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function V$(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=pe()(e);if(t){var i=pe()(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return he()(this,n)}}H$.initClass(),H$._$name="Gantt";var z$=function(e){fe()(n,e);var t=V$(n);function n(){var e;v()(this,n),e=t.call(this);var r,i,o=Lh()(e),a=[],s={},u=$$(o.children);try{for(u.s();!(i=u.n()).done;){var c=i.value;if("COLUMN"===c.tagName){var l=parseInt(c.dataset.width),f=parseInt(c.dataset.flex),d={field:c.dataset.field,text:c.innerHTML,type:c.dataset.type};l?d.width=l:d.flex=f||1,a.push(d)}else if("PROJECT"===c.tagName)r=new a$({transport:{load:{url:c.dataset.loadUrl}}});else if("FEATURE"===c.tagName){var h=c.dataset.name,p=Object.assign({},c.dataset);delete p.name,Object.keys(p).length?s[h]=p:s[h]="false"!==c.textContent}}}catch(e){u.e(e)}finally{u.f()}var g=Object.assign({},o.dataset),y=g.theme||"stockholm",m=e.attachShadow({mode:"open"}),k=document.createElement("link");return delete g.theme,k.rel="stylesheet",k.href="../../build/gantt.".concat(y,".css"),k.onload=function(){var e=document.createElement("div");e.id="container",e.style.width="100%",e.style.height="100%",m.appendChild(e),Hr(m,nu),Object.assign(g,{appendTo:e,columns:a,features:s,project:r});var t=new H$(g);r instanceof a$&&r.load(),window.gantt||(window.gantt=t)},m.appendChild(k),e}return n}(window.customElements?HTMLElement:Object);try{window.customElements&&window.customElements.define("bryntum-gantt",z$)}catch(e){}z$._$name="GanttTag";window.bryntum||(window.bryntum={})}])}));
//# sourceMappingURL=gantt.umd.min.js.map